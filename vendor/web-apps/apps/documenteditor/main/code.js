/* minified by terser */
if(void 0===Common)var Common={};void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],(function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}));const helper=function(){let t;const e=function(e){if(e){if(!t&&0==(t=$("div[aria-live]")).length){t=$('<div aria-live="assertive" class="sr-only" style=""></div>').appendTo($("body"))}}else t&&(t.remove(t),t=void 0)};return{setEnabled:e,disable:function(){e(!1)},speech:function(i){t||e(!0),t.text(""),setTimeout((function(e){t.text(i)}),0)}}};if(!window.Common&&(window.Common={}),!Common.Utils&&(Common.Utils={}),Common.Utils.ScreeenReaderHelper=new helper,define("common/main/lib/util/ScreenReaderHelper",(function(){})),void 0===Common)Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ScreenReaderFocusManager=new function(){var t,e,i,n,s=!1,o=!1,a=!1,l=0,r=0,c=document,d=document,h=[],p=!1,m=!1,u=!1,g=!1,b=function(t,e){d=c,e?c=e:"esc"!==t?c=$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):0===l?document:t&&t.closest(".hint-section")||document:0===l&&(c=document)},C=function(t){!e||!t&&Common.Utils.ModalWindow.isVisible()||(p=t,e.asc_enableKeyEvents(!t))},v=function(){if((0===h.length||$("#file-menu-panel").is(":visible")&&1===l)&&T(),o)if(l!==r&&(0===l||1===l&&$("#file-menu-panel").is(":visible"))){var e=$(d).prop("id");"toolbar"===e?w():"left-menu"===e||"right-menu"===e?S(e):"file-menu-panel"===e&&A()}else 1!==l||l===r||"left-menu"!==$(c).prop("id")&&"right-menu"!==$(c).prop("id")||P("left-menu"===$(c).prop("id"));else $("#file-menu-panel").is(":visible")?A():w();var i=h[t];i&&($(i).parent().hasClass("ribtab")&&!$(i).parent().hasClass("active")&&"file"!==$(i).data("tab")&&$(i).trigger(jQuery.Event("click",{which:1})),$(h[t]).focus()),h.length>0?(!p&&C(!0),o=!0):o=!1},f=function(){o=!1,a=!1,g=!1},x=function(e){r=l,t=0,h.length=0,void 0!==e?l=e:l++},y=function(){l=$("#file-menu-panel").is(":visible")?1:0,b(),h.length=0},w=function(){for(var e,i=0;i<h.length;i++){var n=$(h[i]).parent();if(n&&n.hasClass("ribtab")&&n.hasClass("active")){e=h[i];break}}e&&(t=i)},S=function(e){for(var i,n=0;n<h.length;n++){var s=$(h[n]);if($(s.closest(".hint-section")).prop("id")===e&&s.hasClass("btn-category")&&s.hasClass("active")){i=h[n];break}}i&&(t=n)},A=function(){for(var e,i=0;i<h.length;i++)if($(h[i]).parent().hasClass("active")){e=h[i];break}e&&(t=i)},P=function(e){var n,s=0;if(e&&(n=i.getController("LeftMenu").getView("LeftMenu").getFocusElement()),n)for(var o=0;o<h.length;o++)if($(h[o]).is($(n))){s=o;break}t=s},T=function(){h=[];var t=[];_.isArray(c)?c.forEach((function(e){t=t.concat($(e).find("[data-hint="+l+"]").toArray())})):t=$(c).find("[data-hint="+l+"]").toArray(),(h=t.filter((function(t){return $(t).is(":visible")&&!function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}($(t))}))).forEach((function(t){void 0===$(t).attr("tabindex")&&$(t).attr("tabindex",0)}))},I=function(){f(),y(),p&&C(!1)};return{init:function(d){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){e=d,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE,u=!0;var _=Common.localStorage.getKeysFilter();n=_&&_.length?_.split(",")[0]:"",Common.Utils.ScreeenReaderHelper||require(["common/main/lib/util/ScreenReaderHelper"],(function(){Common.Utils.ScreeenReaderHelper.setEnabled(!0)})),$("#editor_sdk").on("click",(function(){I()})),$(document).on("mousedown",(function(){I()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!s||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?m?(C(!1),m=!1):o&&t.preventDefault():(t.preventDefault(),o?I():($("input:focus").blur(),l=$("#file-menu-panel").is(":visible")?1:0,b(),v())),s=!1})),$(document).on("keydown.after.bs.dropdown",(function(e){if(o){var i=$(h[t]).prop("tagName"),n="INPUT"===i||"TEXTAREA"===i,s=e.keyCode==Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN,d=e.keyCode==Common.UI.Keys.ESC||e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE;if($(h[t]).data("move-focus-only-tab")&&e.keyCode!==Common.UI.Keys.TAB&&!d)return;if(!s&&!d||e.keyCode==Common.UI.Keys.SPACE&&n)return;s&&e.preventDefault(),Common.UI.Menu.Manager.hideAll();var u,_,C,w,S=!1,A=h[t]&&$(h[t]),P=$("#file-menu-panel").is(":visible"),T=A&&A.hasClass("btn-category"),k=e.keyCode==Common.UI.Keys.LEFT,V=e.keyCode==Common.UI.Keys.RIGHT,B=e.keyCode==Common.UI.Keys.UP,M=e.keyCode==Common.UI.Keys.DOWN,U=e.keyCode==Common.UI.Keys.TAB,D=e.shiftKey&&e.keyCode==Common.UI.Keys.TAB;if(P?(u=k||B,_=2===l?V||M||U&&!D:V||M,C=D,w=U&&!D):T?(u=B||D,_=M||U,C=!1,w=V||k):g?(u=D,_=U,C=!1,w=!1):(u=k||D,_=V||U&&!D,C=B,w=M),e.keyCode==Common.UI.Keys.ESC)return void I();if(e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE){if(A&&(A.attr("for")?e.keyCode==Common.UI.Keys.RETURN?$("#"+A.attr("for")).trigger(jQuery.Event("click",{which:1})):e.preventDefault():"file"===A.data("tab")||P&&1===l||T?A.trigger(jQuery.Event("click",{which:1})):setTimeout((function(){A.trigger(jQuery.Event("click",{which:1}))}),1),"dropdown"!==A.data("toggle")&&A.blur()),!(A&&"file"===A.data("tab")||P&&1===l||T&&A.hasClass("active")))return f(),y(),Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),A&&"dropdown"!==A.data("toggle")&&(m=!0),void(p=!1);T&&A.hasClass("active")&&(g=!0),x(),b(A)}else if(u)S=!0,r=l,--t<0&&(t=h.length-1);else if(_)S=!0,r=l,++t>h.length-1&&(t=0);else if(w){var L='[data-hint="'+(l+1)+'"]';if(0===$(c).find(L).length||A&&0===$(A.closest(".hint-section")).find(L).filter(":visible").length)return;S=!0,x(),b(A),T&&(g=!0)}else if(C){if(0===l)return;S=!0,r=l,h.length=0,l--,b(A)}!a&&S&&(a=!0,Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0)),v()}})),$(document).on("keydown",(function(t){s=Common.Utils.InternalSettings.get(n+"settings-show-alt-hints")&&t.keyCode==Common.UI.Keys.ALT&&!t.shiftKey&&!Common.Utils.ModalWindow.isVisible()&&u&&!(window.PE&&$("#pe-preview").is(":visible")),Common.localStorage.getBool("screen-reader-focus-mode",!1)?!$(document.body).hasClass("focus-mode")&&$(document.body).addClass("focus-mode"):$(document.body).hasClass("focus-mode")&&$(document.body).removeClass("focus-mode")}))}},isFocusMode:function(){return!!a},exitFocusMode:I}},define("common/main/lib/controller/ScreenReaderFocus",(function(){})),void 0===Common)Common={};if(define("common/main/lib/component/ComboBoxDataView",[],(function(){"use strict";Common.UI.ComboBoxDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,formTemplate:null,disabled:!1,menuCls:"",menuStyle:"",restoreHeight:0,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle <%= cls %>" data-toggle="dropdown" id="<%= id %>" style="<%= style %>">',"<%= formTemplate() %>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.dataViewStyle=e.options.dataViewStyle,this.dataViewCls=e.options.dataViewCls,this.template=e.options.template||e.template,this.itemTemplate=e.options.itemTemplate,this.disabled=e.options.disabled,this.groups=e.options.groups||null,this.store=e.options.store||new Common.UI.DataViewStore,this.updateFormControl=e.options.updateFormControl,this.options.data&&e.store.add(this.options.data),this.formTemplate=this.options.formTemplate||_.template(['<div class="form-control" style="width: 100px;" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),e.rendered=e.options.rendered||!1,e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},render:function(t){var e=this;if(e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,formTemplate:this.formTemplate,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;this._button=i.find(".btn"),this._formControl=i.find(".form-control"),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e))}return e.getMenu(),e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},getMenu:function(t){if("object"!=typeof this.menu){t=t||this.options;var e=Common.UI.getId(),i=this.$el||$(this.el),n=new Common.UI.Menu({id:e,cls:t.menuCls,style:t.menuStyle,additionalAlign:t.additionalAlign,items:(t.additionalItems?t.additionalItems:[]).concat([{template:_.template('<div id="'+e+'-data-menu" style="'+t.dataViewStyle+'" class="'+t.dataViewCls+'"></div>')}])}).render(i);this.dataPicker=new Common.UI.DataView({el:i.find("#"+e+"-data-menu"),parentMenu:n,outerMenu:{menu:n,index:t.additionalItems?t.additionalItems.length:0,focusOnShow:!t.additionalItems},groups:t.groups,store:t.store,itemTemplate:t.itemTemplate,restoreHeight:t.restoreHeight}),this.dataPicker.on("item:click",_.bind(this.onClickItem,this)),n.setInnerMenu([{menu:this.dataPicker,index:t.additionalItems?t.additionalItems.length:0}]);var s=this;n.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),n.on("show:after",(function(e){s.dataPicker&&_.delay((function(){!t.additionalItems&&s.dataPicker.focus()}),10)})).on("hide:after",(function(){s.options.takeFocusOnClose&&setTimeout((function(){s.focus()}),1)})),this.menu=n}return this.menu},getPicker:function(){return this.dataPicker},onClickItem:function(t,e,i){this.updateFormControl&&this.updateFormControl.call(this,i),this.disabled||this.isSuspendEvents||this.trigger("item:click",this,t,e,i)},selectRecord:function(t){this.rendered&&(this.dataPicker&&this.dataPicker.selectRecord(t,!0),this.updateFormControl&&this.updateFormControl.call(this,t))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),e.preventDefault(),e.stopPropagation(),!1},closeMenu:function(){(this.$el||$(this.el)).removeClass("open")},isMenuOpen:function(){return(this.$el||$(this.el)).hasClass("open")},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this._formControl.attr("tabindex",this.tabindex))},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(void 0!==this.tabindex&&(t&&(this.tabindex=this._formControl.attr("tabindex")),this._formControl.attr("tabindex",t?"-1":this.tabindex)),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t),this._formControl.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},focus:function(){this._formControl&&this._formControl.focus()}})})),define("common/main/lib/view/OptionsDialog",[],(function(){"use strict";Common.Views.OptionsDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",items:[],buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<% if (typeof label !== "undefined" && label !=="") { %>','<label style="margin-bottom: 10px;"><%= label %></label>',"<% } %>","<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div id="<%= item.id %>" style="margin-bottom: 10px;"></div>',"<% }) %>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.radio=[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=t.getChild(),i=this.options.items,n=!0;if(this.checkedIndex=-1,i){for(var s=0;s<i.length;s++){var o=i[s];this.radio.push(new Common.UI.RadioBox({el:e.find("#"+o.id),labelText:o.caption||"",name:"asc-radio-opt-dlg",value:o.value,disabled:!!o.disabled,checked:n&&!o.disabled}).on("change",(function(e,i,n){i&&(t.currentCell=e.options.value)}))),!n&&!o.checked||o.disabled||(n=!1,this.checkedIndex=s)}this.checkedIndex>=0&&(this.radio[this.checkedIndex].setValue(!0),this.currentCell=this.radio[this.checkedIndex].options.value)}e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return this.radio.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.checkedIndex>=0?this.radio[this.checkedIndex]:null},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.currentCell},onPrimary:function(){return this._handleInput("ok"),!1}},Common.Views.OptionsDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/InsertTableDialog",[],(function(){"use strict";Common.Views.InsertTableDialog=Common.UI.Window.extend(_.extend({options:{width:230,style:"min-width: 230px;",cls:"modal-dlg",id:"window-insert-table",split:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:t.split?this.txtTitleSplit:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="text columns-text" style="width: 130px;">'+this.txtColumns+'</label><div class="columns-val float-right"></div>',"</div>",'<div class="input-row" style="margin-top: 10px;">','<label class="text rows-text" style="width: 130px;">'+this.txtRows+'</label><div class="rows-val float-right"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.udColumns=new Common.UI.MetricSpinner({el:t.find(".columns-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}),this.udRows=new Common.UI.MetricSpinner({el:t.find(".rows-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1})},getFocusedComponents:function(){return[this.udColumns,this.udRows].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.udColumns},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close(),!1},txtTitle:"Table Size",txtTitleSplit:"Split Cell",txtColumns:"Number of Columns",txtRows:"Number of Rows",textInvalidRowsCols:"You need to specify valid rows and columns count.",txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},Common.Views.InsertTableDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout((function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),function(t,e){var i=1057,n=1124,s=1,o=2,a=3,l=4,r=5,c=6,d=7,h=8,p=9,m=10,u=11,g=12,b=13,_=14,C=15,v=16,f=17,x=18,y=19,w=20,S=21,A=22,P=23,T=24,I=25,k=26,V=27,B=28,M=29,U=30,D=31,L=32,F=33,R=34,E=35,H=36,N=37,O=38,W=39,z=40,$=41,G=42,j=43,q=44,K=45,Y=46,X=47,J=48,Q=49,Z=50,tt=51,et=52,it=53,nt=54,st=55,ot=56,at=57,lt=58,rt=59,ct=60,dt=61,ht=62,pt=63,mt=64,ut=65,gt=66,bt=67,_t=68,Ct=69,vt=70,ft=71,xt=72,yt=73,wt=74,St=75,At=76,Pt=77,Tt=78,It=79,kt=80,Vt=81,Bt=82,Mt=83,Ut=84,Dt=85,Lt=86,Ft=87,Rt=88,Et=89,Ht=90,Nt=91,Ot=92,Wt=93,zt=94,$t=95,Gt=96,jt=97,qt=98,Kt=99,Yt=100,Xt=101,Jt=102,Qt=103,Zt=104,te=105,ee=106,ie=107,ne=108,se=109,oe=110,ae=111,le=112,re=113,ce=114,de=115,he=116,pe=117,me=118,ue=119,ge=120,be=121,_e=122,Ce=123,ve=124,fe=125,xe=126,ye=127,we=128,Se=129,Ae=130,Pe=131,Te=132,Ie=133,ke=134,Ve=135,Be=136,Me=137,Ue=138,De=139,Le=140,Fe=141,Re=142,Ee=143,He=144,Ne=145,Oe=146,We=147,ze=148,$e=149,Ge=150,je=151,qe=152,Ke=153,Ye=154,Xe=155,Je=156,Qe=157,Ze=158,ti=159,ei=160,ii=161,ni=162,si=163,oi=164,ai=165,li=166,ri=167,ci=168,di=169,hi=170,pi=171,mi=172,ui=173,gi=174,bi=175,_i=176,Ci=177,vi=178,fi=179,xi=180,yi=181,wi=182,Si=183,Ai=184,Pi=185,Ti=186,Ii=187,ki=188,Vi=189,Bi=190,Mi=191,Ui=192,Di=193,Li=194,Fi=195,Ri=196,Ei=197,Hi=198,Ni=199,Oi=200,Wi=201,zi=202,$i=203,Gi=204,ji=205,qi=206,Ki=207,Yi=208,Xi=209,Ji=210,Qi=211,Zi=212,tn=213,en=214,nn=215,sn=216,on=217,an=218,ln=219,rn=220,cn=221,dn=222,hn=223,pn=224,mn=225,un=226,gn=227,bn=228,_n=229,Cn=230,vn=231,fn=232,xn=233,yn=234,wn=235,Sn=236,An=237,Pn=238,Tn=239,In=240,kn=241,Vn=242,Bn=243,Mn=244,Un=245,Dn=246,Ln=247,Fn=248,Rn=249,En=250,Hn=251,Nn=252,On=253,Wn=254,zn=255,$n=256,Gn=257,jn=258,qn=259,Kn=260,Yn=261,Xn=262,Jn=263,Qn=264,Zn=265,ts=266,es=267,is=268,ns=269,ss=270,os=271,as=272,ls=273,rs=0,cs=1,ds=2,hs=3,ps=4,ms=5,us=6,gs=7,bs=8,_s=16,Cs=17,vs=18,fs=19,xs=20,ys=30,ws=19,Ss=21,As=29,Ps={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},Ts={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},Is={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},ks=1,Vs=2,Bs=3,Ms=4,Us=5,Ds=6,Ls=7,Fs=8,Rs=9,Es=10,Hs=11,Ns=12,Os=14,Ws=16,zs=17,$s=18,Gs=19,js=20,qs=21,Ks=22,Ys=23,Xs=24,Js=25,Qs=26;function Zs(t,e,i,n,s){this.Start=t,this.End=e,this.Name=i,this.Lid=n,this.Param=s}var to=[new Zs(32,126,s,1033,[1<<Ps.Basic_Latin,0,0,0,1<<rs,0]),new Zs(160,255,o,0,[1<<Ps.Basic_Latin|1<<Ps.Latin_1_Supplement,0,0,0,1<<rs,0]),new Zs(256,383,a,0,[1<<Ps.Basic_Latin|1<<Ps.Latin_Extended_A,0,0,0,1<<rs|1<<cs|1<<ps|1<<gs,0]),new Zs(384,591,l,0,[1<<Ps.Basic_Latin|1<<Ps.Latin_Extended_B,0,0,0,1<<rs|1<<cs|1<<ps|1<<gs,0]),new Zs(592,687,r,0,[1<<Ps.IPA_Extensions,0,0,0,0,0]),new Zs(688,767,c,0,[1<<Ps.Spacing_Modifier_Letters,0,0,0,0,0]),new Zs(768,879,d,0,[1<<Ps.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(880,1023,h,1032,[1<<Ps.Greek_and_Coptic,0,0,0,1<<hs,0]),new Zs(1024,1279,p,1049,[1<<Ps.Cyrillic,0,0,0,1<<ds,0]),new Zs(1280,1327,m,0,[1<<Ps.Cyrillic,0,0,0,1<<ds,0]),new Zs(1328,1423,u,1067,[1<<Ps.Armenian,0,0,0,0,0]),new Zs(1424,1535,g,1037,[1<<Ps.Hebrew,0,0,0,1<<ms,1<<Ss]),new Zs(1536,1791,b,1,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1792,1871,_,1114,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1872,1919,C,1,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1920,1983,v,1125,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1984,2047,f,0,[1<<Ps.NKo,0,0,0,0,0]),new Zs(2048,2111,x,0,[1<<Ps.Hebrew,0,0,0,1<<ms,0]),new Zs(2112,2143,y,0,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(2208,2303,w,1,[1<<Ps.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(2304,2431,S,1081,[1<<Ps.Devanagari,0,0,0,0,0]),new Zs(2432,2559,A,1093,[1<<Ps.Bengali,0,0,0,0,0]),new Zs(2560,2687,P,1094,[1<<Ps.Gurmukhi,0,0,0,0,0]),new Zs(2688,2815,T,1095,[1<<Ps.Gujarati,0,0,0,0,0]),new Zs(2816,2943,I,1096,[1<<Ps.Oriya,0,0,0,0,0]),new Zs(2944,3071,k,1097,[1<<Ps.Tamil,0,0,0,0,0]),new Zs(3072,3199,V,1098,[1<<Ps.Telugu,0,0,0,0,0]),new Zs(3200,3327,B,1099,[1<<Ps.Kannada,0,0,0,0,0]),new Zs(3328,3455,M,1100,[1<<Ps.Malayalam,0,0,0,0,0]),new Zs(3456,3583,U,1115,[0,0,1<<Is.Sinhala,0,0,0]),new Zs(3584,3711,D,1054,[1<<Ps.Thai,0,0,0,1<<_s,0]),new Zs(3712,3839,L,1108,[1<<Ps.Lao,0,0,0,0,0]),new Zs(3840,4095,F,2129,[0,0,1<<Is.Tibetan,0,0,0]),new Zs(4096,4255,R,1109,[0,0,1<<Is.Myanmar,0,0,0]),new Zs(4256,4351,E,1079,[1<<Ps.Georgian,0,0,0,0,0]),new Zs(4352,4607,H,1042,[1<<Ps.Hangul_Jamo,0,0,0,1<<fs,0]),new Zs(4608,4991,N,1138,[0,0,1<<Is.Ethiopic,0,0,0]),new Zs(4992,5023,O,0,[0,0,1<<Is.Ethiopic,0,0,0]),new Zs(5024,5119,W,1116,[0,0,1<<Is.Cherokee,0,0,0]),new Zs(5120,5759,z,1117,[0,0,1<<Is.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zs(5760,5791,$,0,[0,0,1<<Is.Ogham,0,0,0]),new Zs(5792,5887,G,0,[0,0,1<<Is.Runic,0,0,0]),new Zs(5888,5919,j,n,[0,0,1<<Is.Tagalog,0,0,0]),new Zs(5920,5951,q,n,[0,0,1<<Is.Tagalog,0,0,0]),new Zs(5952,5983,K,n,[0,0,1<<Is.Tagalog,0,0,0]),new Zs(5984,6015,Y,n,[0,0,1<<Is.Tagalog,0,0,0]),new Zs(6016,6143,X,1107,[0,0,1<<Is.Khmer,0,0,0]),new Zs(6144,6319,J,1104,[0,0,1<<Is.Mongolian,0,0,0]),new Zs(6320,6399,Q,1117,[0,0,1<<Is.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zs(6400,6479,Z,0,[0,0,1<<Is.Limbu,0,0,0]),new Zs(6480,6527,tt,0,[0,0,1<<Is.Tai_Le,0,0,0]),new Zs(6528,6623,et,0,[0,0,1<<Is.New_Tai_Lue,0,0,0]),new Zs(6624,6655,it,1107,[0,0,1<<Is.Khmer,0,0,0]),new Zs(6656,6687,nt,0,[0,0,1<<Is.Buginese,0,0,0]),new Zs(6688,6831,st,1054,[0,0,1<<Is.Tai_Le,0,0,0]),new Zs(6832,6911,ot,0,[1<<Ps.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(6912,7039,at,i,[1<<Ps.Balinese,0,0,0,0,0]),new Zs(7040,7103,lt,i,[0,0,0,1<<Ws,0,0]),new Zs(7104,7167,rt,i,[]),new Zs(7168,7247,ct,0,[0,0,0,1<<zs,0,0]),new Zs(7248,7295,dt,0,[0,0,0,1<<$s,0,0]),new Zs(7296,7311,ht,0,[1<<Ps.Cyrillic,0,0,0,0,0]),new Zs(7360,7375,pt,0,[0,0,0,1<<Ws,0,0]),new Zs(7376,7423,mt,0,[]),new Zs(7424,7551,ut,0,[1<<Ps.IPA_Extensions,0,0,0,0,0]),new Zs(7552,7615,gt,0,[1<<Ps.IPA_Extensions,0,0,0,0,0]),new Zs(7616,7679,bt,0,[1<<Ps.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(7680,7935,_t,0,[1<<Ps.Latin_Extended_Additional,0,0,0,1<<bs,0]),new Zs(7936,8191,Ct,0,[1<<Ps.Greek_Extended,0,0,0,0,0]),new Zs(8192,8303,vt,0,[1<<Ps.Punctuation,0,0,0,0,0]),new Zs(8304,8351,ft,0,[0,1<<Ts.Superscripts_And_Subscripts,0,0,0,0]),new Zs(8352,8399,xt,0,[0,1<<Ts.Currency_Symbols,0,0,0,0]),new Zs(8400,8447,yt,0,[0,1<<Ts.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new Zs(8448,8527,wt,0,[0,1<<Ts.Letterlike_Symbols,0,0,0,0]),new Zs(8528,8591,St,0,[0,1<<Ts.Number_Forms,0,0,0,0]),new Zs(8592,8703,At,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(8704,8959,Pt,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(8960,9215,Tt,0,[0,1<<Ts.Miscellaneous_Technical,0,0,0,0]),new Zs(9216,9279,It,0,[0,1<<Ts.Control_Pictures,0,0,0,0]),new Zs(9280,9311,kt,0,[0,1<<Ts.Optical_Character_Recognition,0,0,0,0]),new Zs(9312,9471,Vt,0,[0,1<<Ts.Enclosed_Alphanumerics,0,0,0,0]),new Zs(9472,9599,Bt,0,[0,1<<Ts.Box_Drawing,0,0,0,0]),new Zs(9600,9631,Mt,0,[0,1<<Ts.Block_Elements,0,0,0,0]),new Zs(9632,9727,Ut,0,[0,1<<Ts.Geometric_Shapes,0,0,0,0]),new Zs(9728,9983,Dt,0,[0,1<<Ts.Miscellaneous_Symbols,0,0,0,0]),new Zs(9984,10175,Lt,0,[0,1<<Ts.Dingbats,0,0,0,0]),new Zs(10176,10223,Ft,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(10224,10239,Rt,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(10240,10495,Et,0,[0,0,1<<Is.Braille_Patterns,0,0,0]),new Zs(10496,10623,Ht,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(10624,10751,Nt,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(10752,11007,Ot,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(11008,11263,Wt,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(11264,11359,zt,0,[0,0,0,1<<Ts.Glagolitic,0,0]),new Zs(11360,11391,$t,0,[1<<Ps.Latin_Extended_Additional,0,0,0,0,0]),new Zs(11392,11519,Gt,0,[1<<Ps.Coptic,0,0,0,0,0]),new Zs(11520,11567,jt,0,[1<<Ps.Georgian,0,0,0,0,0]),new Zs(11568,11647,qt,0,[0,0,0,1<<Vs,0,0]),new Zs(11648,11743,Kt,0,[0,0,1<<Is.Ethiopic,0,0,0]),new Zs(11744,11775,Yt,0,[1<<Ps.Cyrillic,0,0,0,1<<ds,0]),new Zs(11776,11903,Xt,0,[1<<Ps.General_Punctuation,0,0,0,0,0]),new Zs(11904,12031,Jt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12032,12255,Qt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12272,12287,Zt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12288,12351,te,0,[0,1<<Ts.CJK_Symbols_And_Punctuation,0,0,1<<Cs|1<<ys,0]),new Zs(12352,12447,ee,1041,[0,1<<Ts.Hiragana,0,0,0,0]),new Zs(12448,12543,ie,1041,[0,1<<Ts.Katakana,0,0,0,0]),new Zs(12544,12591,ne,0,[0,1<<Ts.Bopomofo,0,0,0,0]),new Zs(12592,12687,se,0,[0,1<<Ts.Hangul_Compatibility_Jamo,0,0,1<<fs,0]),new Zs(12688,12703,oe,2052,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12704,12735,ae,0,[0,1<<Ts.Bopomofo,0,0,0,0]),new Zs(12736,12783,le,0,[0,1<<Ts.CJK_Strokes,0,0,0,0]),new Zs(12784,12799,re,0,[0,1<<Ts.Katakana,0,0,0,0]),new Zs(12800,13055,ce,0,[0,1<<Ts.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new Zs(13056,13311,de,0,[0,1<<Ts.CJK_Compatibility,0,0,0,0]),new Zs(13312,19903,he,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,1<<vs|1<<xs,0]),new Zs(19904,19967,pe,0,[0,0,0,1<<Bs,1<<vs|1<<xs,0]),new Zs(19968,40959,me,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,1<<vs|1<<xs|1<<Cs|1<<ys,0]),new Zs(40960,42127,ue,0,[0,0,1<<Is.Yi_Syllables,0,0,0]),new Zs(42128,42191,ge,0,[0,0,1<<Is.Yi_Radicals,0,0,0]),new Zs(42192,42239,be,0,[]),new Zs(42240,42559,_e,0,[1<<Ps.Vai,0,0,0,0,0]),new Zs(42560,42655,Ce,0,[1<<Ps.Cyrillic,0,0,0,1<<ds,0]),new Zs(42656,42751,ve,0,[]),new Zs(42752,42783,fe,0,[1<<Ps.Spacing_Modifier_Letters,0,0,0,0,0]),new Zs(42784,43007,xe,0,[1<<Ps.Latin_Extended_Additional,0,0,0,0,0]),new Zs(43008,43055,ye,0,[0,0,0,1<<Ms,0,0]),new Zs(43056,43071,we,0,[]),new Zs(43072,43135,Se,0,[0,1<<Ts.Phags_pa,0,0,0,0]),new Zs(43136,43231,Ae,0,[0,0,0,1<<Gs,0,0]),new Zs(43232,43263,Pe,0,[1<<Ps.Devanagari,0,0,0,0,0]),new Zs(43264,43311,Te,0,[0,0,0,1<<js,0,0]),new Zs(43312,43359,Ie,0,[0,0,0,1<<qs,0,0]),new Zs(43360,43391,ke,0,[1<<Ps.Hangul_Jamo,0,0,0,0,0]),new Zs(43392,43487,Ve,i,[]),new Zs(43488,43519,Be,0,[0,0,1<<Is.Myanmar,0,0,0]),new Zs(43520,43615,Me,0,[0,0,0,1<<Ks,0,0]),new Zs(43616,43647,Ue,0,[0,0,1<<Is.Myanmar,0,0,0]),new Zs(43648,43743,De,0,[]),new Zs(43744,43775,Le,0,[]),new Zs(43776,43823,Fe,0,[]),new Zs(43824,43887,Re,0,[1<<Ps.Latin_Extended_Additional,0,0,0,0,0]),new Zs(43888,43967,Ee,0,[]),new Zs(43968,44031,He,0,[]),new Zs(44032,55215,Ne,0,[0,1<<Ts.Hangul_Syllables,0,0,1<<fs,0]),new Zs(55216,55295,Oe,0,[1<<Ps.Hangul_Jamo,0,0,0,0,0]),new Zs(55296,56191,We,0,[]),new Zs(56192,56319,ze,0,[]),new Zs(56320,57343,$e,0,[]),new Zs(57344,63743,Ge,0,[0,1<<Ts.Private_Use_Area_plane_0,0,0,0,0]),new Zs(63744,64255,je,0,[0,1<<Ts.CJK_Compatibility_Ideographs,0,0,1<<vs|1<<xs,0]),new Zs(64256,64335,qe,0,[0,1<<Ts.Alphabetic_Presentation_Forms,0,0,0,0]),new Zs(64336,65023,Ke,0,[0,1<<Ts.Arabic_Presentation_Forms_A,0,0,1<<us,1<<ws|1<<As]),new Zs(65024,65039,Ye,0,[0,0,1<<Is.Variation_Selectors,0,0,0]),new Zs(65040,65055,Xe,0,[0,0,1<<Is.Vertical_Forms,0,0,0]),new Zs(65056,65071,Je,0,[0,0,1<<Is.Combining_Half_Marks,0,0,0]),new Zs(65072,65103,Qe,0,[0,0,1<<Is.Vertical_Forms,0,0,0]),new Zs(65104,65135,Ze,0,[0,0,1<<Is.Small_Form_Variants,0,0,0]),new Zs(65136,65279,ti,0,[0,0,1<<Is.Arabic_Presentation_Forms_B,0,1<<us,1<<ws|1<<As]),new Zs(65280,65519,ei,0,[0,0,1<<Is.Halfwidth_And_Fullwidth_Forms,0,1<<fs|1<<vs|1<<xs|1<<Cs|1<<ys,0]),new Zs(65520,65535,ii,0,[0,0,1<<Is.Specials,0,0,0]),new Zs(65536,65663,ni,0,[0,0,0,1<<Us,0,0]),new Zs(65664,65791,si,0,[0,0,0,1<<Us,0,0]),new Zs(65792,65855,oi,0,[0,0,0,1<<Us,0,0]),new Zs(65856,65935,ai,0,[0,0,0,1<<Ds,0,0]),new Zs(65936,65999,li,0,[0,0,0,1<<Ys,0,0]),new Zs(66e3,66047,ri,0,[0,0,0,1<<Xs,0,0]),new Zs(66176,66207,ci,0,[0,0,0,1<<Js,0,0]),new Zs(66208,66271,di,0,[0,0,0,1<<Js,0,0]),new Zs(66272,66303,hi,0,[1<<Ps.Coptic,0,0,0,0,0]),new Zs(66304,66351,pi,0,[0,0,1<<Is.Old_Italic,0,0,0]),new Zs(66352,66383,mi,0,[0,0,1<<Is.Gothic,0,0,0]),new Zs(66384,66431,ui,0,[]),new Zs(66432,66463,gi,0,[0,0,0,1<<Ls,0,0]),new Zs(66464,66527,bi,0,[0,0,0,1<<Fs,0,0]),new Zs(66560,66639,_i,0,[0,0,1<<Is.Deseret,0,0,0]),new Zs(66640,66687,Ci,0,[0,0,0,1<<Rs,0,0]),new Zs(66688,66735,vi,0,[0,0,0,1<<Es,0,0]),new Zs(66736,66815,fi,0,[]),new Zs(66816,66863,xi,0,[]),new Zs(66864,66927,yi,0,[]),new Zs(67072,67455,wi,0,[]),new Zs(67584,67647,Si,0,[0,0,0,1<<Hs,0,0]),new Zs(67648,67679,Ai,0,[]),new Zs(67680,67711,Pi,0,[]),new Zs(67712,67759,Ti,0,[]),new Zs(67808,67839,Ii,0,[]),new Zs(67840,67871,ki,0,[0,1<<Ts.Phoenician,0,0,0,0]),new Zs(67872,67903,Vi,0,[0,0,0,1<<Js,0,0]),new Zs(67968,67999,Bi,0,[]),new Zs(68e3,68095,Mi,0,[]),new Zs(68096,68191,Ui,0,[0,0,0,1<<Ns,0,0]),new Zs(68192,68223,Di,0,[]),new Zs(68224,68255,Li,0,[]),new Zs(68288,68351,Fi,0,[]),new Zs(68352,68415,Ri,0,[]),new Zs(68416,68447,Ei,0,[]),new Zs(68448,68479,Hi,0,[]),new Zs(68480,68527,Ni,0,[]),new Zs(68608,68687,Oi,0,[]),new Zs(68736,68863,Wi,0,[]),new Zs(69216,69247,zi,0,[]),new Zs(69632,69759,$i,0,[]),new Zs(69760,69839,Gi,0,[]),new Zs(69840,69887,ji,0,[]),new Zs(69888,69967,qi,0,[]),new Zs(69968,70015,Ki,0,[]),new Zs(70016,70111,Yi,0,[]),new Zs(70112,70143,Xi,0,[0,0,1<<Is.Sinhala,0,0,0]),new Zs(70144,70223,Ji,0,[]),new Zs(70272,70319,Qi,0,[]),new Zs(70320,70399,Zi,0,[]),new Zs(70400,70527,tn,0,[]),new Zs(70656,70783,en,0,[]),new Zs(70784,70879,nn,0,[]),new Zs(71040,71167,sn,0,[]),new Zs(71168,71263,on,0,[]),new Zs(71264,71295,an,0,[0,0,1<<Is.Mongolian,0,0,0]),new Zs(71296,71375,ln,0,[]),new Zs(71424,71487,rn,0,[]),new Zs(71840,71935,cn,0,[]),new Zs(72384,72447,dn,0,[]),new Zs(72704,72815,hn,0,[]),new Zs(72816,72895,pn,0,[]),new Zs(73728,74751,mn,0,[0,0,0,1<<Os,0,0]),new Zs(74752,74879,un,0,[0,0,0,1<<Os,0,0]),new Zs(74880,75087,gn,0,[]),new Zs(77824,78895,bn,0,[]),new Zs(82944,83583,_n,0,[]),new Zs(92160,92735,Cn,0,[]),new Zs(92736,92783,vn,0,[]),new Zs(92880,92927,fn,0,[]),new Zs(92928,93071,xn,0,[]),new Zs(93952,94111,yn,2052,[]),new Zs(94176,94207,wn,0,[]),new Zs(94208,100351,Sn,0,[]),new Zs(100352,101119,An,0,[]),new Zs(110592,110847,Pn,0,[]),new Zs(113664,113823,Tn,0,[]),new Zs(113824,113839,In,0,[]),new Zs(118784,119039,kn,0,[0,0,1<<Is.Byzantine_Musical_Symbols,0,0,0]),new Zs(119040,119295,Vn,0,[0,0,1<<Is.Byzantine_Musical_Symbols,0,0,0]),new Zs(119296,119375,Bn,0,[0,0,1<<Is.Byzantine_Musical_Symbols,0,0,0]),new Zs(119552,119647,Mn,0,[]),new Zs(119648,119679,Un,0,[]),new Zs(119808,120831,Dn,0,[0,0,1<<Is.Mathematical_Alphanumeric_Symbols,0,0,0]),new Zs(120832,121519,Ln,0,[]),new Zs(122880,122927,Fn,0,[0,0,0,1<<ks,0,0]),new Zs(124928,125151,Rn,0,[]),new Zs(125184,125279,En,0,[]),new Zs(126464,126719,Hn,0,[]),new Zs(126976,127023,Nn,0,[0,0,0,1<<Qs,0,0]),new Zs(127024,127135,On,0,[0,0,0,1<<Qs,0,0]),new Zs(127136,127231,Wn,0,[]),new Zs(127232,127487,zn,0,[]),new Zs(127488,127743,$n,0,[]),new Zs(127744,128511,Gn,0,[]),new Zs(128512,128591,jn,0,[]),new Zs(128592,128639,qn,0,[]),new Zs(128640,128767,Kn,0,[]),new Zs(128768,128895,Yn,0,[]),new Zs(128896,129023,Xn,0,[0,1<<Ts.Geometric_Shapes,0,0,0,0]),new Zs(129024,129279,Jn,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(129280,129535,Qn,0,[]),new Zs(131072,173791,Zn,0,[0,0,1<<Is.CJK_Unified_Ideographs,0,1<<vs|1<<xs,0]),new Zs(173824,177983,ts,0,[0,0,1<<Is.CJK_Unified_Ideographs,0,1<<vs|1<<xs,0]),new Zs(177984,178207,es,0,[0,0,1<<Is.CJK_Unified_Ideographs,0,1<<vs|1<<xs,0]),new Zs(178208,183983,is,0,[0,0,1<<Is.CJK_Unified_Ideographs,0,1<<vs|1<<xs,0]),new Zs(194560,195103,ns,0,[0,0,1<<Is.CJK_Strokes,0,1<<vs|1<<xs,0]),new Zs(917504,917631,ss,0,[0,0,1<<Is.Tags,0,0,0]),new Zs(917760,917999,os,0,[0,0,1<<Is.Variation_Selectors,0,0,0]),new Zs(983040,1048575,as,0,[0,0,1<<Is.Private_Use_plane_15,0,0,0]),new Zs(1048576,1114111,ls,0,[0,0,1<<Is.Private_Use_plane_15,0,0,0])];t.getSupportedFonts=function(e){var i=function(t,e){var i=0,n=e.length-1,s=0,o=null;if(i>=n)return null;for(;i<n;)if((o=e[s=i+n>>1]).Start>t)n=s-1;else{if(!(o.End<t))return e[s];i=s+1}return i>n||(o=e[i]).Start>t||o.End<t?null:e[i]}(e,to);return t.getSupportedFontsByRange(i)},t.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,n=[],s=0;s<i;s++){var o=e[s],a=t.Param;if(a[0]==(o.m_ulUnicodeRange1&a[0])&&(a[1]==(o.m_ulUnicodeRange2&a[1])&&a[2]==(o.m_ulUnicodeRange3&a[2])&&a[3]==(o.m_ulUnicodeRange4&a[3]))){if(t.Name==me){if(0==(o.m_ulCodePageRange1&a[4]))continue}else if(a[4]!=(o.m_ulCodePageRange1&a[4]))continue;a[5]==(o.m_ulCodePageRange2&a[5])&&n.push(o.m_wsFontName)}}return n},t.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<to.length;++i){var n=to[i],a=n.Param;a[0]==(t.m_ulUnicodeRange1&a[0])&&(a[1]==(t.m_ulUnicodeRange2&a[1])&&a[2]==(t.m_ulUnicodeRange3&a[2])&&a[3]==(t.m_ulUnicodeRange4&a[3])&&a[4]==(t.m_ulCodePageRange1&a[4])&&a[5]==(t.m_ulCodePageRange2&a[5])&&e.push(n))}return 0===e.length&&(e.push(new Zs(32,126,s,1033,[1<<Ps.Basic_Latin,0,0,0,1<<rs,0])),e.push(new Zs(160,255,o,0,[1<<Ps.Basic_Latin|1<<Ps.Latin_1_Supplement,0,0,0,1<<rs,0]))),e}}(window),define("common/main/lib/util/character",(function(){})),void 0===Common)Common={};if(define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/character"],(function(){"use strict";var t={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},e=33,i=[],n=[],s=[],o=-1,a=-1,l=!0,r=-1,c="",d=-1e3,h="",p=-1e3,m=-1,u=-1,g=20,b=20;Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(e){var r=Common.localStorage.getKeysFilter();this.appPrefix=r&&r.length?r.split(",")[0]:"";var c=this.appPrefix+"settings-size-symbol-table",d=Common.Utils.InternalSettings.get(c);null!=d&&null!=d||(d=Common.localStorage.getItem(c)||"",Common.Utils.InternalSettings.set(c,d)),d=d?JSON.parse(d):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:d[0]||448,height:d[1]||420},e||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special&&(this.options.height+=38),this.special&&(this.options.minheight+=38),this.template=['<div class="box">','<div id="symbol-table-switcher" style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>","<td>",'<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304-38*(this.special?1:0))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;padding-top: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label id="symbol-table-lbl-char">'+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157)+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options);var h,p,m,u=i.length<1;if(u&&this.initFonts(),this.fillRecentSymbols(),e.font?h=e.font:s.length>0&&(h=s[0].font),h)for(var g=0;g<i.length;++g)if(i[g].displayValue===h){o=g;break}if(o<0&&(o=0),n=this.getArrRangesByFont(o),-1===a&&(a=n[0].Start),e.code?a=e.code:e.symbol?a=this.fixedCharCodeAt(e.symbol,0):s.length>0&&(a=s[0].symbol),u&&this.options.lang&&"en"!=this.options.lang){var b=this;p=this.options.lang,m=function(){b.updateRangeSelector()},p=p.split(/[\-_]/)[0].toLocaleLowerCase(),Common.Utils.loadConfig("resources/symboltable/"+p+".json",(function(e){for(var i=1;i<274;i++){var n=t[i];t[i]=e[n]||n}m&&m()}))}Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){var t,e,n=this.api.pluginMethod_GetFontList();n.sort((function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}));for(var s,a=[],l={},r=0;r<n.length;++r)(e=l[s=(t=n[r]).m_wsFontName])?e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold?l[s]=t:!e.m_bItalic||t.m_bBold||t.m_bItalic||(l[s]=t):l[s]=t;delete l.ASCW3;r=0;for(var d in l)l.hasOwnProperty(d)&&(a.push(l[d]),a[a.length-1].displayValue=l[d].m_wsFontName);for((i=a).sort((function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1})),r=0;r<i.length;++r)i[r].value=r;if(l[c]||(l["Cambria Math"]?c="Cambria Math":l["Asana-Math"]&&(c="Asana-Math")),l[c])for(r=0;r<i.length;++r)if(i[r].displayValue===c){o=r;break}},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.btnSymbols=new Common.UI.Button({el:e.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:e.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),Common.UI.GroupedButtons([this.btnSymbols,this.btnSpecial]),this.cmbFonts=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:i,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var s=t.getRangeBySymbol(n,a);if(o=i.value,n=t.getArrRangesByFont(o),s){for(var r=0;r<n.length&&s.Name!==n[r].Name;++r);r===n.length&&(a=n[0].Start)}else a=n[0].Start;l=!0,t.updateView(),setTimeout((function(){t.previewPanel.focus()}),1)})),this.cmbFonts.setValue(o),this.cmbRange=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var s=t.getRangeByName(n,parseInt(i.value));a=s.Start,l=!0,t.updateView(void 0,void 0,void 0,void 0,!1),setTimeout((function(){t.previewPanel.focus()}),1)})),this.updateRangeSelector(),t.inputCode=new Common.UI.InputField({el:e.find("#symbol-table-text-code"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",(function(i,s,o){var r=parseInt(s,16);if(!isNaN(r)&&r>31&&t.getRangeBySymbol(n,r)){var c=0===e.find("#c"+r).length;a=r,l=!0,t.updateView(c,void 0,!1)}})).on("change:after",(function(e,i,n){t.updateInput()})),this.symbolTablePanel=e.find("#symbol-table-scrollable-div"),this.previewPanel=e.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=e.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=e.find("#symbol-table-recent"),this.fontLabel=e.find("#symbol-table-label-font"),this.boxPanel=e.find(".box"),this.updateView(void 0,void 0,void 0,!0);var s=[{symbol:"",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"",description:this.textDCQuote,shortcutKey:"",code:"201D"}];this.specialList=new Common.UI.ListView({el:e.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(s),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=e.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=e.find("#symbol-table-pnl-symbols"),this.specialPanel=e.find("#symbol-table-pnl-special")},calcControlsHeight:function(){var t=this.$window,e=this.symbolsPanel.find("> table"),i=t.find("#symbol-table-switcher"),n=t.find(".body");this.hfHeight=parseInt(t.find(".header").css("height"))+parseInt(t.find(".footer").css("height"))+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(t.css("border-bottom-width"))+parseInt(t.css("border-top-width")),this.switcherHeight=this.special?i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSpecialHeight=this.special&&this.btnSpecial.isActive()?t.find("#symbol-table-lbl-char").height()+i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSymbolsHeight=this.special&&this.btnSpecial.isActive()?0:e.eq(0).height()+e.eq(2).height()+e.eq(3).height()+(this.special?i.height()+parseInt(i.css("margin-bottom")):0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");t?this.btnSpecial.toggle(!0):this.btnSymbols.toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,n=!1;if(t&&t.length>0)if(n="c"===t[0])e=i[o].displayValue;else{var s=parseInt(t.split("_")[2]);e=i[s].displayValue}return{font:e,symbol:this.encodeSurrogateChar(a),code:a,updateRecents:n}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){if(e||!document.activeElement||"textarea"!=document.activeElement.localName||!/area_id/.test(document.activeElement.id)){var i=this.btnSpecial.isActive(),n="ok"==t?i?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{};this.options.handler&&this.options.handler.call(this,this,t,n),"ok"==t&&(!i&&this.checkRecent(a,n.font),!i&&n.updateRecents&&this.updateRecents(),this.type)||this.close()}},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedCharCodeAt:function(t,e){e=e||0;var i,n,s=t.charCodeAt(e);if(55296<=s&&s<=56319){if(i=s,n=t.charCodeAt(e+1),isNaN(n))throw"        fixedCharCodeAt()";return 1024*(i-55296)+(n-56320)+65536}return!(56320<=s&&s<=57343)&&s},getArrRangesByFont:function(t){var e=getSupportedRangesByFont(i[t]);return 0===e.length&&e.push({Start:32,End:255}),e[0].Start<32&&(e[0].Start=32),e},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,n=0,s=0;s<t.length;++s){if((i=t[s]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return n+(e-i.Start);n+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(e<0)return-1;for(var i,n=0,s=t[0],o=0;o<t.length;++o){if(n+(i=(s=t[o]).End-s.Start+1)>e)return s.Start+e-n;n+=i}return-1},createTable:function(t,e,i){for(var n,s=e*i,o=0,a="",l=0;l<s;++l)n=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?a+='<div dir="ltr" class="cell" '+n+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":a+='<div dir="ltr" class="cell"'+n+"></div>",++o>=i&&(a+='<br class="noselect">',o=0);this.previewPanel.html(a)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(s=t)},saveRecent:function(){var t=JSON.stringify(s);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===s.length)return s.push({symbol:t,font:e}),void this.saveRecent();for(var i=0;i<s.length;++i)if(s[i].symbol===t&&s[i].font===e){s.splice(i,1);break}s.splice(0,0,{symbol:t,font:e}),s.length>36&&s.splice(36,s.length-36),this.saveRecent()},createCell:function(t,e){var n="",s="";if(e){for(var o=0,a=0;a<i.length;++a)if(i[a].displayValue===e){o=a;break}n="r_"+t+"_"+o,s="&#"+t.toString()}else void 0!==t&&(n="r"+t,s="&#"+t.toString());var l=$('<div dir="ltr" id="'+n+'">'+s+"</div>");return l.addClass("cell"),l.addClass("noselect"),l.mousedown(_.bind(this.cellClickHandler,this)),e&&l.css("font-family","'"+e+"'"),l},cellClickHandler:function(t){var e=$(t.target).attr("id");if(e){var i=(new Date).getTime();if(e===h&&i-p<300)this.cellDblClickHandler(t);else{if("c"===e[0])a=parseInt(e.slice(1,e.length)),l=!0;else{var n=e.split("_");a=parseInt(n[1]),r=parseInt(n[2]),l=!1}this.updateView(!1)}h=t.target.id,p=i}},cellDblClickHandler:function(t){if(this.type){var e=this.getPasteSymbol($(t.target).attr("id"));this.checkRecent(a,e.font),e.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},onDblClickSpecialItem:function(t){if(this.type){var e=this.getSpecialSymbol();this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel;t.empty();var e=this.getColsCount(),i=s.length;t.width(31*e);for(var n=0;n<e;++n){var o=n<i?this.createCell(s[n].symbol,s[n].font):this.createCell();o.css("border-bottom","none"),t.append(o),n===e-1&&o.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.width()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.height()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/e>>0)},getAllSymbolsCount:function(t){for(var e,i=0,n=0;n<t.length;++n)i+=(e=t[n]).End-e.Start+1;return i},setTable:function(t){for(var e,s=this.getColsCount(),a=this.getRowsCount(),l=this.getLinearIndexByCode(n,t),r=this.getAllSymbolsCount(n),c=Math.ceil(r/s),d=Math.max(0,Math.min(c-a,l/s>>0)),h=d*s,p=a*s,m=[],u=0;u<p&&-1!==(e=this.getCodeByLinearIndex(n,h+u));++u)m.push(e);return this.previewPanel.css("font-family","'"+i[o].displayValue+"'"),this.createTable(m,a,s),d},updateView:function(t,s,c,d,h){l&&!1!==h&&this.updateRangeSelector(),l?this.fontLabel.text(i[o]?i[o].displayValue:""):this.fontLabel.text(i[r]?i[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(o);var p=this.getRowsCount()*e;if(!1,!1!==t){var m=null!=s?s:a,u=this.setTable(m),C=this.getAllSymbolsCount(n),v=Math.ceil(C/this.getColsCount())*e;this.previewInner.height(v),this.previewPanel.height(p),this.previewScrolled.height(p),this.scrollerY||(g=Math.max(22,p/8+.5>>0),b=Math.min(Math.floor(this.previewPanel.height()/e)*e/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:g,alwaysVisibleY:!0,wheelSpeed:b,useKeyboard:!1,onChange:_.bind((function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(p),this.previewParent.css({top:this.scrollerY.getScrollTop()}))}),this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:g,wheelSpeed:b}),this.scrollerY.scrollTop(u*e));var f=this.previewPanel.find(".cell");f.off("mousedown"),f.mousedown(_.bind(this.cellClickHandler,this))}d&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),l?this.$window.find("#c"+a).addClass("cell-selected"):this.$window.find("#r_"+a+"_"+r).addClass("cell-selected"),!1!==c&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==d){var t=this.getAllSymbolsCount(n),i=this.getColsCount(),s=this.getRowsCount(),o=Math.ceil(t/i),r=o*e,c=Math.max(0,Math.min(o-s,o*this.scrollerY.getScrollTop()/r+.5>>0));if(d=this.scrollerY.getScrollTop(),l){var h=this.previewPanel.children()[0];if(h){var p=h.id;if(p){var m=parseInt(p.slice(1,p.length)),u=this.getLinearIndexByCode(n,m),g=c*i+(this.getLinearIndexByCode(n,a)-u);a=this.getCodeByLinearIndex(n,g);var b=c*i;for(g-=i;-1===a&&g>=b;)a=this.getCodeByLinearIndex(n,g),g-=i;-1===a&&(a=this.getCodeByLinearIndex(n,b))}else a=this.getCodeByLinearIndex(n,c*i)}}else a=this.getCodeByLinearIndex(n,c*i),l=!0;this.updateView(!0,this.getCodeByLinearIndex(n,c*i))}},updateInput:function(){for(var t=a.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var e=this.getRangeBySymbol(n,a);if(e&&e.Name){this.cmbRange.setDisabled(!1);var i,s=[];for(i=0;i<n.length;++i)s.push({value:n[i].Name,displayValue:t[n[i].Name]});this.cmbRange.setData(s),this.cmbRange.setValue(e.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0,i=!0;if(l){var s=-1;if(e===Common.UI.Keys.LEFT?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,a)-1):e===Common.UI.Keys.UP?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,a)-this.getColsCount()):e===Common.UI.Keys.RIGHT?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,a)+1):e===Common.UI.Keys.DOWN?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,a)+this.getColsCount()):e===Common.UI.Keys.HOME?n.length>0&&(s=n[0].Start):e===Common.UI.Keys.END?n.length>0&&(s=n[n.length-1].End):i=!1,s>-1){a=s;var o=0===this.$window.find("#c"+a).length;this.updateView(o)}}else{var c,d;if(e===Common.UI.Keys.LEFT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var h=this.$window.find(c).prev();h.length>0&&(d=this.$window.find(h).attr("id").split("_"),a=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.RIGHT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var p=this.$window.find(c).next();p.length>0&&(d=this.$window.find(p).attr("id").split("_"),a=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.HOME){var g=this.$window.find("#recent-table").children()[0];g&&(d=g.id.split("_"),a=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else if(e===Common.UI.Keys.END){var b=this.recentPanel.children(),_=b[b.length-1];_&&(d=_.id.split("_"),a=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else i=!1}i&&(u=e,m=(new Date).getTime())}},onKeyPress:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0;if(!(u===e&&Math.abs(m-(new Date).getTime())<1e3)){if(!isNaN(e)&&e>31)if(this.getRangeBySymbol(n,e)){var i=0===this.$window.find("#c"+e).length;a=e,l=!0,this.updateView(i,void 0,!0)}t.preventDefault&&t.preventDefault()}}},onWindowResize:function(t){var e=this.getSize();if(t&&"start"==t[1])this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]};else if(this.curSize.resize){this._preventUpdateScroll=!1,this.scrollerY=null,this.curSize.height=e[1],this.curSize.width=e[0],this.applyInnerSize(e[1]),this.special&&(e[1]-=this.switcherHeight);var i=JSON.stringify(e);Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",i),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",i)}},onWindowResizing:function(){if(this.curSize){var t=this.getSize();t[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1],this.applyInnerSize(t[1]))}},applyInnerSize:function(t){var i=t-this.hfHeight;this.controlsSymbolsHeight?(i-=this.controlsSymbolsHeight,this.symbolTablePanel.css({height:i+"px"}),i=Math.max(1,(i-2)/e>>0)*e,this.previewPanel.css({height:i+"px"}),this.previewScrolled.css({height:i+"px"}),this.updateView(void 0,void 0,void 0,!0)):this.specialList.cmpEl.height(i-this.controlsSpecialHeight)},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]);var e=this;_.delay((function(){t?e.specialList.focus():e.previewPanel.focus()}),50)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]))},textTitle:"Symbol",textFont:"Font",textRange:"Range",textRecent:"Recently used symbols",textCode:"Unicode HEX value",textSymbols:"Symbols",textSpecial:"Special characters",textCharacter:"Character",textShortcut:"Shortcut key",textEmDash:"Em Dash",textEnDash:"En Dash",textNBHyphen:"Non-breaking Hyphen",textSHyphen:"Soft Hyphen",textEmSpace:"Em Space",textEnSpace:"En Space",textQEmSpace:"1/4 Em Space",textNBSpace:"No-break Space",textCopyright:"Copyright Sign",textRegistered:"Registered Sign",textTradeMark:"Trade Mark Sign",textSection:"Section Sign",textPilcrow:"Pilcrow Sign",textEllipsis:"Horizontal Ellipsis",textSOQuote:"Single Opening Quote",textSCQuote:"Single Closing Quote",textDOQuote:"Double Opening Quote",textDCQuote:"Double Closing Quote"},Common.Views.SymbolTableDialog||{}))})),define("common/main/lib/view/PasswordDialog",[],(function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{width:395,header:!0,cls:"modal-dlg",contentTemplate:"",title:e.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+e.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+e.txtPassword+(e.passwordOptional?" ("+e.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1})}},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()},txtTitle:"Set Password",txtPassword:"Password",txtDescription:"A Password is required to open this document",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place."},Common.Views.PasswordDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/SignDialog",[],(function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(t.onChangeName,t)),t.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 230px;",menuCls:"scrollable-menu",menuStyle:"min-width: 230px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:t.tipFontName}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),i.name,t.font.size,t.font.italic,t.font.bold),t.font.name=i.name})),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 50px;",menuCls:"scrollable-menu",menuStyle:"min-width: 50px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,i.value,t.font.italic,t.font.bold),t.font.size=i.value})),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:t.textBold}),t.btnBold.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,t.font.italic,e.pressed),t.font.bold=e.pressed})),t.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:t.textItalic}),t.btnItalic.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,e.pressed,t.font.bold),t.font.italic=e.pressed})),t.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),t.btnSelectImage.on("click",_.bind(t.onSelectImage,t)),t.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),t.btnChangeCertificate.on("click",_.bind(t.onChangeCertificate,t)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),t.btnOk.setDisabled(!0),t.cntCertificate=$("#id-dlg-sign-certificate"),t.cntVisibleSign=$("#id-dlg-sign-visible"),t.cntInvisibleSign=$("#id-dlg-sign-invisible"),"visible"==t.signType?t.cntInvisibleSign.addClass("hidden"):t.cntVisibleSign.addClass("hidden"),e.find(".dlg-btn").on("click",_.bind(t.onBtnClick,t)),t.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate].concat(this.getFooterButtons())},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()}),500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,i="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",i[0]).replace("%2",i[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,n){var s;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(s=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return s=e.getValue(),e.setRawValue(s),n.preventDefault(),!1}else{var o="sse-"==this.appPrefix?409:300;s=(s=Common.Utils.String.parseFloat(i.value))>o?o:s<1?1:Math.floor(2*(s+.4))/2,e.setRawValue(s),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,s,this.font.italic,this.font.bold),this.font.size=s}},textTitle:"Sign Document",textPurpose:"Purpose for signing this document",textCertificate:"Certificate",textValid:"Valid from %1 to %2",textChange:"Change",textInputName:"Input signer name",textUseImage:"or click 'Select Image' to use a picture as signature",textSelectImage:"Select Image",textSignature:"Signature looks as",tipFontName:"Font Name",tipFontSize:"Font Size",textBold:"Bold",textItalic:"Italic",textSelect:"Select",textNameError:"Signer name must not be empty."},Common.Views.SignDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/SignSettingsDialog",[],(function(){"use strict";Common.Views.SignSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 350px;",cls:"modal-dlg",type:"edit"},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"].concat("edit"===(t.type||this.options.type)?["cancel"]:[])},t||{}),this.template=['<div class="box" style="height: 250px;">','<div class="input-row">',"<label>"+this.textInfoName+"</label>","</div>",'<div id="id-dlg-sign-settings-name" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoTitle+"</label>","</div>",'<div id="id-dlg-sign-settings-title" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoEmail+"</label>","</div>",'<div id="id-dlg-sign-settings-email" class="input-row" style="margin-bottom: 10px;"></div>','<div class="input-row">',"<label>"+this.textInstructions+"</label>","</div>",'<div id="id-dlg-sign-settings-instructions"></div>','<div id="id-dlg-sign-settings-date"></div>',"</div>"].join(""),this.api=this.options.api,this.type=this.options.type||"edit",this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-settings-name"),style:"width: 100%;",disabled:"view"==this.type}),t.inputTitle=new Common.UI.InputField({el:$("#id-dlg-sign-settings-title"),style:"width: 100%;",disabled:"view"==this.type}),t.inputEmail=new Common.UI.InputField({el:$("#id-dlg-sign-settings-email"),style:"width: 100%;",disabled:"view"==this.type}),t.textareaInstructions=new Common.UI.TextareaField({el:e.find("#id-dlg-sign-settings-instructions"),style:"width: 100%; height: 35px;margin-bottom: 10px;",value:this.textDefInstruction,disabled:"view"==this.type}),this.chDate=new Common.UI.CheckBox({el:$("#id-dlg-sign-settings-date"),labelText:this.textShowDate,disabled:"view"==this.type,value:"checked"}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputTitle,this.inputEmail,this.textareaInstructions,this.chDate].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},setSettings:function(t){if(t){var e=this,i=t.asc_getSigner1();e.inputName.setValue(i||""),i=t.asc_getSigner2(),e.inputTitle.setValue(i||""),i=t.asc_getEmail(),e.inputEmail.setValue(i||""),i=t.asc_getInstructions(),e.textareaInstructions.setValue(i||""),e.chDate.setValue(t.asc_getShowDate()),e._currentGuid=t.asc_getGuid()}},getSettings:function(){var t=this,e=new AscCommon.asc_CSignatureLine;return e.asc_setSigner1(t.inputName.getValue()),e.asc_setSigner2(t.inputTitle.getValue()),e.asc_setEmail(t.inputEmail.getValue()),e.asc_setInstructions(t.textareaInstructions.getValue()),e.asc_setShowDate("checked"==t.chDate.getValue()),void 0!==t._currentGuid&&e.asc_setGuid(t._currentGuid),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},textInfo:"Signer Info",textInfoName:"Suggested signer",textInfoTitle:"Suggested signer's title",textInfoEmail:"Suggested signer's e-mail",textInstructions:"Instructions for signer",txtEmpty:"This field is required",textAllowComment:"Allow signer to add comment in the signature dialog",textShowDate:"Show sign date in signature line",textTitle:"Signature Setup",textDefInstruction:"Before signing this document, verify that the content you are signing is correct."},Common.Views.SignSettingsDialog||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),define("text",["module"],(function(t){"use strict";var e,i,n,s,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,p=c&&(location.port||void 0),m={},u=t.config&&t.config()||{};function g(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(r);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=a[e];try{t=new ActiveXObject(i)}catch(t){}if(t){a=[i];break}}return t},parseName:function(t){var e,i,n,s=!1,o=t.lastIndexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!a||o>1)?(e=t.substring(0,o),i=t.substring(o+1)):e=t,-1!==(o=(n=i||e).indexOf("!"))&&(s="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:e=n),{moduleName:e,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,s){var o,a,l,r=e.xdRegExp.exec(t);return!r||(o=r[2],l=(a=(a=r[3]).split(":"))[1],a=a[0],(!o||o===i)&&(!a||a.toLowerCase()===n.toLowerCase())&&(!l&&!a||function(t,e,i,n){if(e===n)return!0;if(t===i){if("http"===t)return g(e,"80")===g(n,"80");if("https"===t)return g(e,"443")===g(n,"443")}return!1}(o,l,i,s)))},finishLoad:function(t,i,n,s){n=i?e.strip(n):n,u.isBuild&&(m[t]=n),s(n)},load:function(t,i,n,s){if(s&&s.isBuild&&!s.inlineText)n();else{u.isBuild=s&&s.isBuild;var o=e.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),l=i.toUrl(a),r=u.useXhr||e.useXhr;0!==l.indexOf("empty:")?!c||r(l,d,h,p)?e.get(l,(function(i){e.finishLoad(t,o.strip,i,n)}),(function(t){n.error&&n.error(t)})):i([a],(function(t){e.finishLoad(o.moduleName+"."+o.ext,o.strip,t,n)}),(function(t){n.error&&n.error(t)})):n()}},write:function(t,i,n,s){if(m.hasOwnProperty(i)){var o=e.jsEscape(m[i]);n.asModule(t+"!"+i,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,i,n,s,o){var a=e.parseName(i),l=a.ext?"."+a.ext:"",r=a.moduleName+l,c=n.toUrl(a.moduleName+l)+".js";e.load(r,n,(function(i){var n=function(t){return s(c,t)};n.asModule=function(t,e){return s.asModule(t,c,e)},e.write(t,r,n,o)}),o)}},"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var s=i.readFileSync(t,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),e(s)}catch(t){n&&n(t)}}):"xhr"===u.env||!u.env&&e.createXhr()?e.get=function(t,i,n,s){var o,a=e.createXhr();if(a.open("GET",t,!0),s)for(o in s)s.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),s[o]);u.onXhr&&u.onXhr(a,t),a.onreadystatechange=function(e){var s,o;4===a.readyState&&((s=a.status||0)>399&&s<600?((o=new Error(t+" HTTP status: "+s)).xhr=a,n&&n(o)):i(a.responseText),u.onXhrComplete&&u.onXhrComplete(a,t))},a.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,s=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),"utf-8")),l="";try{for(i=new java.lang.StringBuffer,(n=a.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(o),i.append(n);l=String(i.toString())}finally{a.close()}e(l)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,a,l,r={};o&&(t=t.replace(/\//g,"\\")),l=new FileUtils.File(t);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(l,1,0,!1),(a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),r),a.close(),i.close(),e(r.value)}catch(t){throw new Error((l&&l.path||"")+": "+t)}}),e})),define("text!common/main/lib/template/AutoCorrectDialog.template",[],(function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-very-small">\n                <div id="auto-correct-replace" class="margin-right-2" style="width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-chk-sentence" class="padding-small"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),define("common/main/lib/view/AdvancedSettingsWindow",[],(function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach((function(i,n){var s=new Common.UI.Button({parentEl:e.find("#slot-category-"+i.panelId),cls:"btn-category "+(i.categoryCls||""),caption:i.panelCaption,iconCls:i.categoryIcon||"",enableToggle:!0,toggleGroup:t.toggleGroup,allowDepress:!1,contentTarget:i.panelId});s.cmpEl.attr("content-target",i.panelId),s.on("click",_.bind(t.onCategoryClick,t,s,n)),t.btnsCategory.push(s)}));let i=e.find(".menu-panel");if(this.content_panel=e.find(".content-panel"),this.content_panel.width(this.contentWidth),e.width((i.length>0?i.outerWidth():0)+this.content_panel.outerWidth()+2),this.options.contentHeight)e.find(".body > .box").css("height",this.options.contentHeight);else if("number"==typeof this.options.height){var n=e.find(".body"),s=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));e.find(".body > .box").css("height",this.options.height-s)}this.content_panels=e.find(".settings-panel"),this.btnsCategory.length>0&&this.btnsCategory[0].toggle(!0,!0);var o=function(){e.width((i.length>0?i.outerWidth():0)+t.content_panel.outerWidth()+2)};$(window).on("resize",o),this.on("close",(function(){$(window).off("resize",o)}))},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"));e.find(".body > .box").css("height",parseInt(i.css("height"))-n)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));void 0===t&&(t=parseInt(e.find(".body > .box").css("height"))),Common.UI.Window.prototype.setHeight.call(this,t+n),e.find(".body > .box").css("height",t)},fixHeight:function(){let t=this.content_panels.filter(".active").height()-this.content_panel.height();t>0&&this.setInnerHeight(parseInt(this.$window.find(".body > .box").css("height"))+t)},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active"),this.fixHeight()},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=t>=0&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var n=this.btnsCategory[i];if(n.isVisible()&&!n.isDisabled()){e=n,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var t=-1;return this.btnsCategory.forEach((function(e,i){e.pressed&&(t=i)})),t},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.fixHeight())},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";var e=new Common.UI.DataViewStore,i=new Common.UI.DataViewStore,n=new Common.UI.DataViewStore,s=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,contentHeight:355,buttons:["close"],toggleGroup:"autocorrect-dialog-group"},initialize:function(e){var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"";var n=[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}];"de-"==this.appPrefix||"pe-"==this.appPrefix?(n.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),n.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&n.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:n,contentTemplate:_.template(t)({scope:this})},e||{}),this.api=this.options.api;var s=this.appPrefix+"settings-math-correct",o=Common.Utils.InternalSettings.get(s+"-add");this.arrAdd=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRem=o?JSON.parse(o):[],s=this.appPrefix+"settings-rec-functions",o=Common.Utils.InternalSettings.get(s+"-add"),this.arrAddRec=o?JSON.parse(o):[],o=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRemRec=o?JSON.parse(o):[],this.arrAddExceptions={},this.arrRemExceptions={},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),o=this,a=t.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");if(this.chReplaceType=new Common.UI.CheckBox({el:t.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-math-correct-replace-type",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-math-correct-replace-type",s),o.api.asc_updateFlagAutoCorrectMathSymbols(s)})),this.onInitList(),this.mathList=new Common.UI.ListView({el:t.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(e.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(replaced) %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(by) %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:t.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=o.mathList.store.find((function(t){if(0==t.get("replaced").indexOf(e))return!0})))&&(o.mathList.scrollToRecord(i,!0),i.get("replaced")==e?o.mathList.selectRecord(i,!0):i=null));!i&&o.mathList.deselectAll(),o.updateControls(i)})),this.inputReplace.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=o.mathList.getSelectedRec()||o.mathList.store.at(0);e&&(o.mathList.selectRecord(e),o.mathList.scrollToRecord(e)),_.delay((function(){o.mathList.focus()}),10)}})),this.inputBy=new Common.UI.InputField({el:t.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){o.updateControls()})),this.btnReset=new Common.UI.Button({el:t.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:t.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:t.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:t.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(i.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:t.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=o.mathRecList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(o.mathRecList.scrollToRecord(i,!0),i.get("value")==e?o.mathRecList.selectRecord(i,!0):i=null));!i&&o.mathRecList.deselectAll(),o.updateRecControls(i)})),this.inputRecFind.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=o.mathRecList.getSelectedRec()||o.mathRecList.store.at(0);e&&(o.mathRecList.selectRecord(e),o.mathRecList.scrollToRecord(e)),_.delay((function(){o.mathRecList.focus()}),10)}})),this.btnResetRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix){this.chQuotes=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-smart-quotes",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-smart-quotes",s),o.api.asc_SetAutoCorrectSmartQuotes(s)})),this.chHyphens=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyphens",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyphens",s),o.api.asc_SetAutoCorrectHyphensWithDash(s)})),this.chBulleted=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-bulleted",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-bulleted",s),o.api.asc_SetAutomaticBulletedLists(s)})),this.chNumbered=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-numbered",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-numbered",s),o.api.asc_SetAutomaticNumberedLists(s)})),this.chDoubleSpaces=new Common.UI.CheckBox({el:a.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-double-space",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-double-space",s),o.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(s)})),this.api&&(s=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultLangs()||[]),s.forEach((function(t){var e=o.appPrefix+"settings-letter-exception",i=Common.Utils.InternalSettings.get(e+"-add-"+t);o.arrAddExceptions[t]=i?JSON.parse(i):[],i=Common.Utils.InternalSettings.get(e+"-rem-"+t),o.arrRemExceptions[t]=i?JSON.parse(i):[]}));var l=Common.Utils.InternalSettings.get("settings-letter-exception-lang");if(this.exceptionsLangCmb=new Common.UI.ComboBox({el:t.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHintDirection:"bottom",data:s.map((function(t){t=parseInt(t);var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}}))}).on("selected",(function(t,e){l!=e.value&&(l=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",l),o.onInitExceptionsList(!0),o.onChangeInputException(o.exceptionsFindInput,o.exceptionsFindInput.getValue()))})),!l){var r=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()});if(!r){var c=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0];r=this.exceptionsLangCmb.store.find((function(t){return 0==t.get("shortName").indexOf(c)}))}r&&(l=r.get("value"))}this.exceptionsLangCmb.setValue(l||s[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:t.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(n.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:t.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=o.exceptionsList.getSelectedRec()||o.exceptionsList.store.at(0);e&&(o.exceptionsList.selectRecord(e),o.exceptionsList.scrollToRecord(e)),_.delay((function(){o.exceptionsList.focus()}),10)}})),this.btnResetExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-sentence",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-sentence",s),o.api.asc_SetAutoCorrectFirstLetterOfSentences&&o.api.asc_SetAutoCorrectFirstLetterOfSentences(s)})),this.chkSentenceCells=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-letter-exception-cells",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-letter-exception-cells",s),o.api.asc_SetAutoCorrectFirstLetterOfCells&&o.api.asc_SetAutoCorrectFirstLetterOfCells(s)})),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))}else"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-new-rows",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-new-rows",s),o.api.asc_setIncludeNewRowColTable(s)})));this.chHyperlink=new Common.UI.CheckBox({el:a.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(o.appPrefix+"settings-autoformat-hyperlink",s),Common.Utils.InternalSettings.set(o.appPrefix+"settings-autoformat-hyperlink",s),o.api.asc_SetAutoCorrectHyperlinks(s)})),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){if(this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){var t=this.btnsCategory.concat([this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec]);return t=(t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])).concat(this.getFooterButtons())},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){if(this.mathList){t=t||this.mathList.getSelectedRec();var e=this.inputBy.getValue(),i=this.inputReplace.getValue();if(t){var n=t.get("defaultDisabled"),s=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by");this.btnDelete.setCaption(n?this.textRestore:this.textDelete),this.btnEdit.setDisabled(n||e===t.get("by")&&!s||!e||!i),this.btnEdit.setCaption(s&&e===t.get("by")?this.textReset:this.textReplace)}else this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd);this.btnDelete.setDisabled(!t)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var i=this;_.delay((function(){$("input",i.inputReplace.cmpEl).select().focus()}),t?50:0),i.mathList.store.length<e.length&&_.delay((function(){i.mathList.setStore(e),i.mathList.onResetItems()}),t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay((function(){"sse-"==e.appPrefix?e.chHyperlink.focus():e.chQuotes.focus()}),t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()}),t?50:0),e.exceptionsList.store.length<n.length&&_.delay((function(){e.exceptionsList.setStore(n),e.exceptionsList.onResetItems()}),t?100:10)},onDelete:function(){var t,i=this.mathList.getSelectedRec(),n="";if(i){if(i.get("defaultValue")){n=this.appPrefix+"settings-math-correct-rem";var s=!i.get("defaultDisabled");i.set("defaultDisabled",s),s?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.btnDelete.setCaption(s?this.textRestore:this.textDelete),s?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))}else e.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),n=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"));this.updateControls()}},onEdit:function(){var t=this.mathList.getSelectedRec(),i="",n=this,s=function(t,e){var i=n.appPrefix+"settings-math-correct-add",s=JSON.stringify(n.arrAdd);Common.Utils.InternalSettings.set(i,s),Common.localStorage.setItem(i,s),n.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),n.mathList.selectRecord(t),n.mathList.scrollToRecord(t)};if(t||(t=e.findWhere({replaced:this.inputReplace.getValue()})),t){var o=_.findIndex(this.arrAdd,(function(e){return e[0]==t.get("replaced")})),a=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by")&&this.inputBy.getValue()===t.get("by");Common.UI.warning({maxwidth:500,msg:a?this.warnRestore.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))):this.warnReplace.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))),buttons:["yes","no"],primary:"yes",callback:_.bind((function(e,n){"yes"==e&&(a?(i=t.get("defaultValue"),t.set("by",t.get("defaultValueStr")),o>=0&&this.arrAdd.splice(o,1)):(i=this.inputBy.getValue(),t.set("by",i),o<0?this.arrAdd.push([t.get("replaced"),i]):this.arrAdd[o][1]=i),s(t,i))}),this)})}else t=e.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),i=t.get("by"),this.arrAdd.push([t.get("replaced"),i]),s(t,i)},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())}),this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",i),Common.localStorage.setItem(t+"-add",i),Common.Utils.InternalSettings.set(t+"-rem",i),Common.localStorage.setItem(t+"-rem",i),this.arrAdd=[],this.arrRem=[],e.remove(e.where({defaultValue:void 0})),e.each((function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)})),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){if(!(e.length>0)){e.comparator=function(t,e){var i=t.get("replaced").toLowerCase(),n=e.get("replaced").toLowerCase();return i==n?0:i<n?-1:1};var t=this.arrAdd,i=this.arrRem,n=this.api?this.api.asc_getAutoCorrectMathSymbols():[],s=[];_.each(n,(function(t,e){var n={replaced:t[0],defaultValue:t[1],defaultDisabled:i.indexOf(t[0])>-1};"object"==typeof t[1]?(n.defaultValueStr="",_.each(t[1],(function(t){n.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)})),n.by=n.defaultValueStr):n.by=n.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),s.push(n)}));var o=[];_.each(t,(function(t,e){var i=_.findIndex(s,{replaced:t[0]});i<0?o.push({replaced:t[0],by:t[1],defaultDisabled:!1}):s[i].by=t[1]})),e.reset(s.concat(o)),this.updateControls()}},onInitRecList:function(){if(!(i.length>0)){i.comparator=function(t,e){var i=t.get("value").toLowerCase(),n=e.get("value").toLowerCase();return i==n?0:i<n?-1:1};var t=this.arrAddRec,e=this.arrRemRec,n=this.api?this.api.asc_getAutoCorrectMathFunctions():[],s=[];_.each(n,(function(t,i){s.push({value:t,defaultValue:!0,defaultDisabled:e.indexOf(t)>-1})}));var o=[];_.each(t,(function(t,e){_.findIndex(s,{value:t})<0&&o.push({value:t,defaultValue:!1,defaultDisabled:!1})})),i.reset(s.concat(o)),this.updateRecControls()}},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())}),this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],i.remove(i.where({defaultValue:!1})),i.each((function(t,e){t.set("defaultDisabled",!1)})),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.inputRecFind.cmpEl).select().focus()}),t?50:0),e.mathRecList.store.length<i.length&&_.delay((function(){e.mathRecList.setStore(i),e.mathRecList.onResetItems()}),t?100:10)},onDeleteRec:function(){var t,e,n=this.mathRecList.getSelectedRec();if(n){if(n.get("defaultValue")){t=this.appPrefix+"settings-rec-functions-rem";var s=!n.get("defaultDisabled");n.set("defaultDisabled",s),s?this.arrRemRec.push(n.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(n.get("value")),1),e=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.btnDeleteRec.setCaption(s?this.textRestore:this.textDelete),s?this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(n.get("value"))}else i.remove(n),this.arrAddRec.splice(this.arrAddRec.indexOf(n.get("value")),1),t=this.appPrefix+"settings-rec-functions-add",e=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value"));this.updateRecControls()}},onAddRec:function(){var t,e,n,s=this.mathRecList.getSelectedRec(),o=this;s||(s=i.findWhere({value:this.inputRecFind.getValue()})),s?(o.mathRecList.selectRecord(s),o.mathRecList.scrollToRecord(s)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(s=i.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(s.get("value")),t=s,e=o.appPrefix+"settings-rec-functions-add",n=JSON.stringify(o.arrAddRec),Common.Utils.InternalSettings.set(e,n),Common.localStorage.setItem(e,n),o.api.asc_AddFromAutoCorrectMathFunctions(t.get("value")),o.mathRecList.selectRecord(t),o.mathRecList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){if(this.mathRecList){t=t||this.mathRecList.getSelectedRec();var e=this.inputRecFind.getValue();this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e)}},onInitExceptionsList:function(t){if(!(n.length>0)||t){n.comparator=function(t,e){var i=t.get("value").toLowerCase(),n=e.get("value").toLowerCase();return i==n?0:i<n?-1:1};var e=this.exceptionsLangCmb.getValue(),i=this.arrAddExceptions[e]?this.arrAddExceptions[e]:[],s=this.arrRemExceptions[e]?this.arrRemExceptions[e]:[],o=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(e):[],a=[];_.each(o,(function(t,e){a.push({value:t,defaultValue:!0,defaultDisabled:s.indexOf(t)>-1})}));var l=[];_.each(i,(function(t,e){_.findIndex(a,{value:t})<0&&l.push({value:t,defaultValue:!1,defaultDisabled:!1})})),n.reset(a.concat(l)),this.updateExceptionsControls()}},onResetExceptionsToDefault:function(){var t=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),e=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind((function(i,n){"yes"==i&&(t.put_Exceptions(t.get_DefaultExceptions(e),e),this.onResetExceptionsList())}),this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],n.remove(n.where({defaultValue:!1})),n.each((function(t,e){t.set("defaultDisabled",!1)})),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t=this.exceptionsList.getSelectedRec(),e=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),i=this.exceptionsLangCmb.getValue();if(t){var s,o="";if(t.get("defaultValue")){var a=!t.get("defaultDisabled");o=this.appPrefix+"settings-letter-exception-rem-"+i,t.set("defaultDisabled",a),a?this.arrRemExceptions[i].push(t.get("value")):this.arrRemExceptions[i].splice(this.arrRemExceptions[i].indexOf(t.get("value")),1),s=JSON.stringify(this.arrRemExceptions[i]),Common.Utils.InternalSettings.set(o,s),Common.localStorage.setItem(o,s),this.btnDeleteExceptions.setCaption(a?this.textRestore:this.textDelete),a?e.remove_Exception(t.get("value"),i):e.add_Exception(t.get("value"),i)}else n.remove(t),this.arrAddExceptions[i].splice(this.arrAddExceptions[i].indexOf(t.get("value")),1),o=this.appPrefix+"settings-letter-exception-add-"+i,s=JSON.stringify(this.arrAddExceptions[i]),Common.Utils.InternalSettings.set(o,s),Common.localStorage.setItem(o,s),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),e.remove_Exception(t.get("value"),i);this.updateExceptionsControls()}},onAddException:function(){var t,e,i,s=this.exceptionsList.getSelectedRec(),o=this.exceptionsLangCmb.getValue(),a=this,l=this.exceptionsFindInput.getValue().trim();s||(s=n.findWhere({value:l})),s?(a.exceptionsList.selectRecord(s),a.exceptionsList.scrollToRecord(s)):("."===l[l.length-1]&&(l=l.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(l)?(s=n.add({value:l,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[o].push(s.get("value")),t=s,e=a.appPrefix+"settings-letter-exception-add-"+o,i=JSON.stringify(a.arrAddExceptions[o]),Common.Utils.InternalSettings.set(e,i),Common.localStorage.setItem(e,i),a.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(t.get("value"),o),a.exceptionsList.selectRecord(t),a.exceptionsList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null));!i&&this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){if(this.exceptionsList){t=t||this.exceptionsList.getSelectedRec();var e=this.exceptionsFindInput.getValue();this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e)}},textTitle:"AutoCorrect",textMathCorrect:"Math AutoCorrect",textReplace:"Replace",textBy:"By",textResetAll:"Reset to default",textAdd:"Add",textDelete:"Delete",textRestore:"Restore",textReset:"Reset",textReplaceType:"Replace text as you type",warnReset:"Any autocorrect you added will be removed and the changed ones will be restored to their original values. Do you want to continue?",warnReplace:"The autocorrect entry for %1 already exists. Do you want to replace it?",warnRestore:"The autocorrect entry for %1 will be reset to its original value. Do you want to continue?",textRecognized:"Recognized Functions",textRecognizedDesc:"The following expressions are recognized math expressions. They will not be automatically italicized.",textWarnAddRec:"Recognized functions must contain only the letters A through Z, uppercase or lowercase.",textWarnResetRec:"Any expression you added will be removed and the removed ones will be restored. Do you want to continue?",textAutoFormat:"AutoFormat As You Type",textReplaceText:"Replace As You Type",textApplyText:"Apply As You Type",textQuotes:'"Straight quotes" with "smart quotes"',textHyphens:"Hyphens (--) with dash ()",textBulleted:"Automatic bulleted lists",textNumbered:"Automatic numbered lists",textApplyAsWork:"Apply as you work",textNewRowCol:"Include new rows and columns in table",textAutoCorrect:"AutoCorrect",textFLSentence:"Capitalize first letter of sentences",textWarnResetFL:"Any exceptions you added will be removed and the removed ones will be restored. Do you want to continue?",textWarnAddFL:"Exceptions must contain only the letters, uppercase or lowercase.",textForLangFL:"Exceptions for the language:",textHyperlink:"Internet and network paths with hyperlinks",textFLCells:"Capitalize first letter of table cells",textFLDont:"Don`t capitalize after",textDoubleSpaces:"Add period with double-space"},Common.Views.AutoCorrectDialog||{}))})),define("common/main/lib/view/DocumentAccessDialog",[],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("common/main/lib/view/SearchDialog",[],(function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach((function(t){this.btnOptions.menu.addItem(t)}),this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),!this.mode&&!t&&(t="search"),t&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout((function(){e.focus(),e.select()}),10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){if(!$(".asc-loadmask").length){var i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked};this.fireEvent("search:"+t,[this,i])}},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer((function(){"replace"==e.mode?e.txtReplace.focus():e.txtSearch.focus()}),300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}},textTitle:"Search & Replace",textTitle2:"Search",txtBtnReplace:"Replace",txtBtnReplaceAll:"Replace All",textMatchCase:"Case sensitive",textWholeWords:"Whole words only",textHighlight:"Highlight results",textReplaceDef:"Enter the replacement text",textSearchStart:"Enter text for search",txtBtnHideReplace:"Hide Replace"},Common.UI.SearchDialog||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.cls+=" advanced-settings-dlg invisible-borders",(!e.buttons||_.size(e.buttons)<1)&&(e.cls+=" no-footer"),e.contentHeight=e.height,e.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+e.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var e=document.createElement("iframe");e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this);var i=this,n=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:n}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())}),500),e.src=this.url,n.append(e),this.frame=e,this.on("resizing",(function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)}));var s=function(){i.onWindowResize()};$(window).on("resize",s),this.on("close",(function(){$(window).off("resize",s)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),s=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),o=2*this.bordersOffset;i-o<e+this._headerFooterHeight&&(e=i-o-this._headerFooterHeight),n-o<t+s&&(t=n-o-s),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+s),this.$window.css("left",(n-t-s)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),n=this.getHeight(),s=this.resizable?0:this.bordersOffset;if(n<e-2*s+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var o=Math.max(Math.min(this._restoreHeight,e-2*s),this.initConfig.minheight);this.setHeight(o),this.boxEl.css("height",o-this._headerFooterHeight)}var a=this.getTop();a<s?this.$window.css("top",s):a+n>e-s&&this.$window.css("top",e-s-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(e-2*s,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*s,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",s);if(i<t-2*s+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*s),this.initConfig.minwidth));var l=this.getLeft();l<s?this.$window.css("left",s):l+i>t-s&&this.$window.css("left",t-s-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*s,this.initConfig.minwidth)),this.$window.css("left",s)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),e="id-plugindlg-docked",i=t.find("#"+e);if(i.length<1){(i=$('<div id="'+e+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=i.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(i),i.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}i.show(),t.removeClass("hidden")},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),n=i.find("#id-plugindlg-"+t);if(n.length<1){var s="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+s+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(n)}n.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginPanel",[],(function(){"use strict";Common.Views.PluginPanel=Common.UI.BaseView.extend(_.extend({template:_.template(['<div class="current-plugin-box layout-ct vbox">','<div class="current-plugin-frame">',"</div>",'<div class="current-plugin-header">','<div class="tools">','<div class="plugin-close close"></div>','<div class="plugin-hide"></div>',"</div>","<label></label>","</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._state={},this.menu||(this.menu="left"),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$(".current-plugin-header label",this.$el),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$(".current-plugin-box",this.$el),this.currentPluginFrame=$(".current-plugin-frame",this.$el),this.pluginClose=new Common.UI.Button({parentEl:this.$el.find(".plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.sideMenuButton&&(this.pluginHide=new Common.UI.Button({parentEl:this.$el.find(".plugin-hide"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-panel-left-collapse",hint:this.textHidePanel})),this.isCanDocked&&this.showDockedButton(),this.trigger("render:after",this),this},showDockedButton:function(){var t=this.$el.find(".current-plugin-header .tools"),e="plugin-undock",i=t.find("."+e);i.length<1&&(i=$('<div class="'+e+'"></div>'),this.$el.find(".plugin-close").after(i),new Common.UI.Button({parentEl:this.$el.find("."+e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-unpin",hint:this.textUndock}).on("click",_.bind((function(){this.fireEvent("docked",this.iframePlugin.id)}),this)));i.show(),t.removeClass("hidden")},openInsideMode:function(t,e,i,n){return this.pluginName||this.render(),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=n,!0},closeInsideMode:function(){this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this._state.insidePlugin=void 0},_onLoad:function(){this.loadMask&&this.loadMask.hide()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},enablePointerEvents:function(t){this.iframePlugin&&(this.iframePlugin.style.pointerEvents=t?"":"none")},textClosePanel:"Close plugin",textLoading:"Loading",textUndock:"Unpin plugin",textHidePanel:"Collapse plugin"},Common.Views.PluginPanel||{}))})),define("common/main/lib/view/RenameDialog",[],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},getFocusedComponents:function(){return[this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),define("common/main/lib/view/ExternalEditor",[],(function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=e&&e.length?e.split(",")[0]:"";this.storageName=i+(t.storageName||"external-editor");var n={},s=t.initwidth||900,o=t.initheight||700,a=Common.localStorage.getItem(this.storageName+"-width");a&&(s=parseInt(a)),(a=Common.localStorage.getItem(this.storageName+"-height"))&&(o=parseInt(a)),_.extend(n,{width:s,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0},t),n.contentHeight=o,this.template=['<div id="id-editor-container" class="box" style="height:'+n.contentHeight+'px; padding: 0 5px;">','<div id="'+(n.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary auto" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>"].join(""),n.tpl=_.template(this.template)(n),this.handler=n.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,n)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box");var t=this.$window.find("> .body");this._headerFooterHeight=this.initConfig.header?parseInt(this.$window.find(".header").css("height")):0,this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width"));var e=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");e<this.initConfig.contentHeight+this._headerFooterHeight&&(this.initConfig.contentHeight=e-this._headerFooterHeight,this.boxEl.css("height",this.initConfig.contentHeight)),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),this.$window.height(t);var i=this.initConfig.header?parseInt(this.$window.find("> .header").css("height")):0;this.$window.find("> .body").css("height",t-i),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight)}},setInCenter:function(){var t=this.$window.height(),e=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,i=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",i),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+e)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),s=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),o=parseInt(this.boxEl.css("padding-left"))+parseInt(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),n<t+o+s&&(t=n-o-s),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+o+s),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){if(t&&"end"==t[1]){var e=this.getSize();Common.localStorage.setItem(this.storageName+"-width",e[0]),Common.localStorage.setItem(this.storageName+"-height",e[1])}},textSave:"Save & Exit",textClose:"Close"},Common.Views.ExternalEditor||{}))})),define("common/main/lib/view/ExternalDiagramEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalDiagramEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-diagram-editor",title:this.textTitle,storageName:"diagram-editor",sdkplaceholder:"id-diagram-editor-placeholder",initwidth:900,initheight:700,minwidth:730,minheight:275},t),this._chartData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},show:function(){this.setPlaceholder(),Common.Views.ExternalEditor.prototype.show.apply(this,arguments)},setChartData:function(t){this._chartData=t,this._isExternalDocReady&&this.fireEvent("setchartdata",this)},setPlaceholder:function(t){this._placeholder=t},getPlaceholder:function(){return this._placeholder},textTitle:"Chart Editor"},Common.Views.ExternalDiagramEditor||{}))})),define("common/main/lib/view/ExternalMergeEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalMergeEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-merge-editor",title:this.textTitle,storageName:"merge-editor",sdkplaceholder:"id-merge-editor-placeholder",initwidth:900,initheight:700,minwidth:370,minheight:275},t),this._mergeData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setMergeData:function(t){this._mergeData=t,this._isExternalDocReady&&this.fireEvent("setmergedata",this)},textTitle:"Mail Merge Recipients"},Common.Views.ExternalMergeEditor||{}))})),define("common/main/lib/view/ExternalOleEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalOleEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-ole-editor",title:this.textTitle,storageName:"ole-editor",sdkplaceholder:"id-ole-editor-placeholder",initwidth:1030,initheight:700,minwidth:1030,minheight:275},t),this._oleData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setOleData:function(t){this._oleData=t,this._isExternalDocReady&&this.fireEvent("setoledata",this)},textTitle:"Spreadsheet Editor"},Common.Views.ExternalOleEditor||{}))})),define("common/main/lib/view/ShapeShadowDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShapeShadowDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ShapeShadowDialog",contentWidth:230,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px;",contentTemplate:['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="header">'+e.txtTransparency+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-transparency-slider" style="display: inline-block"></div>','<div id="shape-shadow-transparency-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtSize+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-size-slider" style="display: inline-block"></div>','<div id="shape-shadow-size-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtAngle+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-angle-slider" style="display: inline-block"></div>','<div id="shape-shadow-angle-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtDistance+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-distance-slider" style="display: inline-block"></div>','<div id="shape-shadow-distance-spin"></div>',"</div>","</td>","</tr>","</table>","</div>","</div>"].join("")},t),this.handler=t.handler,this.api=t.api,this.shadowProps=t.shadowProps,this.methodApplySettings=t.methodApplySettings,this.isShadowEmpty=!this.shadowProps,this.shadowProps||(this.shadowProps=new Asc.asc_CShadowProperty,this.shadowProps.putPreset("t")),this.oldTransparency=this.shadowProps.getTransparency(),this.oldSize=this.shadowProps.getSize(),this.oldAngle=this.shadowProps.getAngle(),this.oldDistance=this._mm2pt(this.shadowProps.getDistance()),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){if(Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.api.setStartPointHistory(),this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,t)}this.sldrTransparency=new Common.UI.SingleSlider({el:$("#shape-shadow-transparency-slider"),width:128,minValue:0,maxValue:100,value:this.oldTransparency}),this.sldrTransparency.on("change",_.bind(this.onSliderTransparencyChange,this)),this.spinTransparency=new Common.UI.MetricSpinner({el:$("#shape-shadow-transparency-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinTransparency.setValue(this.oldTransparency,!0),this.spinTransparency.on("change",_.bind(this.onSpinnerTransparencyChange,this)),this.sldrSize=new Common.UI.SingleSlider({el:$("#shape-shadow-size-slider"),width:128,minValue:1,maxValue:200,value:this.oldSize}),this.sldrSize.on("change",_.bind(this.onSliderSizeChange,this)),this.spinSize=new Common.UI.MetricSpinner({el:$("#shape-shadow-size-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:200,minValue:1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinSize.setValue(this.oldSize,!0),this.spinSize.on("change",_.bind(this.onSpinnerSizeChange,this)),this.sldrAngle=new Common.UI.SingleSlider({el:$("#shape-shadow-angle-slider"),width:128,minValue:0,maxValue:359,value:this.oldAngle}),this.sldrAngle.on("change",_.bind(this.onSliderAngleChange,this)),this.spinAngle=new Common.UI.MetricSpinner({el:$("#shape-shadow-angle-spin"),step:1,width:62,allowDecimal:!1,value:"0 ",defaultUnit:"",maxValue:359,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinAngle.setValue(this.oldAngle,!0),this.spinAngle.on("change",_.bind(this.onSpinnerAngleChange,this)),this.sldrDistance=new Common.UI.SingleSlider({el:$("#shape-shadow-distance-slider"),width:128,minValue:0,maxValue:200,value:this.oldDistance}),this.sldrDistance.on("change",_.bind(this.onSliderDistanceChange,this));var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt);this.spinDistance=new Common.UI.MetricSpinner({el:$("#shape-shadow-distance-spin"),step:1,width:62,allowDecimal:!1,value:"0 "+e,defaultUnit:e,maxValue:200,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinDistance.setValue(this.oldDistance,!0),this.spinDistance.on("change",_.bind(this.onSpinnerDistanceChange,this)),this.on("close",_.bind(this.handleCancelClose,this))},onSliderTransparencyChange:function(t,e,i){this.spinTransparency.setValue(e,!0),this.setTransparency(e)},onSpinnerTransparencyChange:function(t,e,i){var n=t.getNumberValue();this.sldrTransparency.setValue(n,!0),this.setTransparency(n)},setTransparency:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderSizeChange:function(t,e,i){this.spinSize.setValue(e,!0),this.setSize(e)},onSpinnerSizeChange:function(t,e,i){var n=t.getNumberValue();this.sldrSize.setValue(n,!0),this.setSize(n)},setSize:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putSize(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderAngleChange:function(t,e,i){this.spinAngle.setValue(e,!0),this.setAngle(e)},onSpinnerAngleChange:function(t,e,i){var n=t.getNumberValue();this.sldrAngle.setValue(n,!0),this.setAngle(n)},setAngle:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putAngle(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderDistanceChange:function(t,e,i){this.spinDistance.setValue(e,!0),this.setDistance(e)},onSpinnerDistanceChange:function(t,e,i){var n=t.getNumberValue();this.sldrDistance.setValue(n,!0),this.setDistance(n)},setDistance:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putDistance(this._pt2mm(t)),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},setAllProperties:function(t,e,i,n){var s=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),this.shadowProps.putSize(e),this.shadowProps.putAngle(i),this.shadowProps.putDistance(this._pt2mm(n)),s.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,s)},getFocusedComponents:function(){return[this.spinTransparency,this.spinSize,this.spinAngle,this.spinDistance].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spinTransparency},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},onPrimary:function(){return this.handleOkClose(),this.close(!0),!1},onDlgBtnClick:function(t){"ok"==t.currentTarget.attributes.result.value?this.handleOkClose():this.handleCancelClose(),this.close(!0)},onDblClickFunction:function(){this.handleOkClose(),this.close(!0)},handleOkClose:function(){this.api.setEndPointHistory(),this.setAllProperties(parseInt(this.spinTransparency.getValue()),parseInt(this.spinSize.getValue()),parseInt(this.spinAngle.getValue()),parseInt(this.spinDistance.getValue())),this.handler&&this.handler.call(this,"ok")},handleCancelClose:function(){if(this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(null),this.methodApplySettings&&this.methodApplySettings.call(this,t)}else this.setAllProperties(this.oldTransparency,this.oldSize,this.oldAngle,this.oldDistance);this.api.setEndPointHistory(),this.handler&&this.handler.call(this,"cancel")},txtTitle:"Adjust Shadow",txtTransparency:"Transparency",txtSize:"Size",txtAngle:"Angle",txtDistance:"Distance"},Common.Views.ShapeShadowDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CustomizeQuickAccessDialog",[],(function(){"use strict";Common.Views.CustomizeQuickAccessDialog=Common.UI.Window.extend(_.extend({options:{width:296,style:"min-width: 296px;",cls:"modal-dlg quick-access-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<label class="padding-medium">'+this.textMsg+"</label>",'<div class="padding-small" id="quick-access-chb-save"></div>','<div class="padding-small" id="quick-access-chb-print"></div>','<div class="padding-small" id="quick-access-chb-quick-print" style="display:none;"></div>','<div class="padding-small" id="quick-access-chb-undo"></div>','<div class="padding-small" id="quick-access-chb-redo"></div>','<div class="padding-small" id="quick-access-chb-start-over" style="display:none;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.focusedComponents=[],this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.showSave&&(this.chSave=new Common.UI.CheckBox({el:$("#quick-access-chb-save"),labelText:this.options.mode&&(this.options.mode.canSaveToFile||this.options.mode.isDesktopApp&&this.options.mode.isOffline)?this.textSave:this.textDownload,value:this.props.save}),this.focusedComponents.push(this.chSave)),this.options.showPrint&&(this.chPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-print"),labelText:this.textPrint,value:this.props.print}),this.focusedComponents.push(this.chPrint)),this.options.showQuickPrint&&(this.chQuickPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-quick-print"),labelText:this.textQuickPrint,value:this.props.quickPrint}),this.focusedComponents.push(this.chQuickPrint),this.chQuickPrint.show()),this.chUndo=new Common.UI.CheckBox({el:$("#quick-access-chb-undo"),labelText:this.textUndo,value:this.props.undo}),this.focusedComponents.push(this.chUndo),this.chRedo=new Common.UI.CheckBox({el:$("#quick-access-chb-redo"),labelText:this.textRedo,value:this.props.redo}),this.focusedComponents.push(this.chRedo),window.PE&&(this.chStartOver=new Common.UI.CheckBox({el:$("#quick-access-chb-start-over"),labelText:this.textStartOver,value:this.props.startOver}),this.focusedComponents.push(this.chStartOver),this.chStartOver.show())},getFocusedComponents:function(){return this.focusedComponents.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.focusedComponents[0]},onBtnClick:function(t){"ok"===t.currentTarget.attributes.result.value&&Common.NotificationCenter.trigger("quickaccess:changed",{save:this.chSave?"checked"===this.chSave.getValue():void 0,print:this.chPrint?"checked"===this.chPrint.getValue():void 0,quickPrint:this.chQuickPrint?"checked"===this.chQuickPrint.getValue():void 0,undo:"checked"===this.chUndo.getValue(),redo:"checked"===this.chRedo.getValue(),startOver:this.chStartOver?"checked"===this.chStartOver.getValue():void 0}),this.close()},textTitle:"Customize quick access",textMsg:"Check the commands that will be displayed on the Quick Access Toolbar",textSave:"Save",textPrint:"Print",textQuickPrint:"Quick Print",textUndo:"Undo",textRedo:"Redo",textDownload:"Download file"},Common.Views.CustomizeQuickAccessDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/LanguageDialog",[],(function(){"use strict";Common.Views.LanguageDialog=Common.UI.Window.extend(_.extend({options:{header:!1,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-document-language"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var e="app-settings-recent-langs";this.cmbLanguage=new Common.UI.ComboBoxRecent({el:t.find("#id-document-language"),cls:"input-group-nr",menuCls:"shifted-right",menuStyle:"min-width: 318px; max-height: 285px;",editable:!1,recent:{count:Common.Utils.InternalSettings.get(e+"-count")||5,offset:Common.Utils.InternalSettings.get(e+"-offset")||0,key:e,valueField:"value"},template:_.template(['<span class="input-group combobox <%= cls %> combo-langs" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control">','<span class="icon input-icon spellcheck-lang toolbar__icon btn-ic-docspell"></span>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret" />',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"</ul>","</span>"].join("")),itemTemplate:_.template(['<li id="<%= id %>" data-value="<%= value %>">','<a tabindex="-1" type="menuitem" langval="<%= value %>">',"<div>",'<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= displayValue %>","</div>",'<label style="opacity: 0.6"><%= displayValueEn %></label>',"</a>","</li>"].join("")),data:this.options.languages,takeFocusOnClose:!0,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLanguage.scroller&&this.cmbLanguage.scroller.update({alwaysVisibleY:!0}),this.cmbLanguage.on("selected",_.bind(this.onLangSelect,this));var i=Common.util.LanguageInfo.getLocalLanguageName(this.options.current);this.cmbLanguage.setValue(i[0],i[1]),this.onLangSelect(this.cmbLanguage,this.cmbLanguage.getSelectedRecord());var n=this;setTimeout((function(){n.cmbLanguage.focus()}),100)},getFocusedComponents:function(){return[this.cmbLanguage].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbLanguage},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbLanguage.getValue()),this.close()},onLangSelect:function(t,e,i){t.$el.find(".input-icon").toggleClass("spellcheck-lang",e&&e.spellcheck),t._input.css(Common.UI.isRTL()?"padding-right":"padding-left",e&&e.spellcheck?25:3)},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbLanguage.getValue()),this.close(),!1},labelSelect:"Select document language"},Common.Views.LanguageDialog||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var e={},i=this;_.extend(e,{header:!1,label:t.label||i.textUrl,inputConfig:{allowBlank:!1,blankError:i.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||i.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,e)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/DocumentHolderExt",[],(function(){"use strict";let t=window.DE||window.PDFE||window.PDFE||window.PE||window.SSE||window.VE;if(t&&t.Views&&t.Views.DocumentHolder){let e=t.Views.DocumentHolder.prototype;e.addEquationMenu=function(t,e){if(t){var i=this;i.clearEquationMenu(t,e);var n=i.initEquationMenu();return n.length>0&&_.each(n,(function(n,s){n.menu?_.each(n.menu.items,(function(t){t.on("click",_.bind(i.equationCallback,i,t.options.equationProps))})):n.on("click",_.bind(i.equationCallback,i,n.options.equationProps)),t.insertItem(e,n),e++})),n.length}},e.clearEquationMenu=function(t,e){for(var i=e;i<t.items.length&&t.items[i].options.equation;i++)t.items[i].menu?_.each(t.items[i].menu.items,(function(t){t.off("click")})):t.items[i].off("click"),t.removeItem(t.items[i]),i--},e.equationCallback=function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&e[t.callback](t.value)}this.fireEvent("equation:callback",[e])},e.initEquationMenu=function(){var t=this._currentTranslateObj;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),n=t._currentMathObj,s=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:n.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!n.get_HideTop()}},{caption:n.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!n.get_HideBottom()}},{caption:n.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!n.get_HideLeft()}},{caption:n.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!n.get_HideRight()}},{caption:n.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!n.get_HideHor()}},{caption:n.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!n.get_HideVer()}},{caption:n.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!n.get_HideTopLTR()}},{caption:n.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!n.get_HideTopRTL()}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var o=n.get_ScriptType();o==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)):(o==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),s.push(e)),o!=Asc.c_oAscMathInterfaceScript.SubSup&&o!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:o==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)),o!=Asc.c_oAscMathInterfaceScript.SubSup&&o!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:o==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:var a=n.get_FractionType();a!=Asc.c_oAscMathInterfaceFraction.Skewed&&a!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),s.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),s.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),s.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:a==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:a==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:n.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!n.get_HidePlaceholder()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),s.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:n.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),s.push(e),void 0!==n.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:n.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!n.get_HideUpper()}}),s.push(e)),void 0!==n.get_HideLower()&&(e=new Common.UI.MenuItem({caption:n.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!n.get_HideLower()}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),s.push(e),n.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),s.push(e)),e=new Common.UI.MenuItem({caption:n.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!n.get_HideOpeningBracket()}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!n.get_HideClosingBracket()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!n.get_StretchBrackets()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!n.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets()&&n.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!n.get_MatchBrackets()}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:n.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==n.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:n.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!n.get_HideDegree()}}),s.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),s.push(e)}return n.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),s.push(e)),n.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),s.push(e)),n.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),s.push(e)),n.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),s.push(e)),n.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),s.push(e)),s}},e.updateCustomItems=function(t,e){if(t&&e&&!(e.length<1)){var i=this,n=i.mode&&i.mode.lang?i.mode.lang.split(/[\-_]/)[0]:"en";i._preventCustomClick&&clearTimeout(i._preventCustomClick),i._hasCustomItems&&(i._preventCustomClick=setTimeout((function(){i._preventCustomClick=null}),500)),i._hasCustomItems=!0;var s,o=function(e,i){if(t&&t.items.length>0)for(var n=t.items.length-1;n>=0;n--)if(t.items[n].isCustomItem&&(void 0===i&&t.items[n].options.guid===e||t.items[n].options.guid===e&&t.items[n].value===i))return t.items[n]},a=function(t,e,s){var o=!1;return s?s.removeAll():((s=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,n){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),s.on("menu:click",(function(t,e){i._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&s.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&s.addItem(new Common.UI.MenuItemCustom({caption:("object"==typeof t.text?t.text[n]||t.text.en:t.text)||"",value:t.id,guid:e,menu:!!t.items&&a(t.items,e),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled})),o=o||!!t.icons})),o&&(s.cmpEl?s.cmpEl.toggleClass("shifted-right",!0):s.options.cls="shifted-right"),s};if(e.forEach((function(e){var l=!o(e.guid);e&&e.items&&e.items.length>0&&e.items.forEach((function(r){if(r.separator&&l&&t.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e.guid})),r.text){var c=o(e.guid,r.id),d=("object"==typeof r.text?r.text[n]||r.text.en:r.text)||"";if(c)c.setCaption(d),c.setDisabled(!!r.disabled),r.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,s=c.cmpEl),a(r.items,e.guid,c.menu)):c.setMenu(a(r.items,e.guid)));else{c=new Common.UI.MenuItemCustom({caption:d,value:r.id,guid:e.guid,menu:!!(r.items&&r.items.length>=0)&&a(r.items,e.guid),iconsSet:r.icons,baseUrl:"",disabled:!!r.disabled}).on("click",(function(t,e){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));t.addItem(c)}}}))})),s){var l=$("> [role=menu]",s).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}t.alignPosition()}},e.clearCustomItems=function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}}})),define("common/main/lib/view/PdfSignDialog",[],(function(){"use strict";Common.Views.PdfSignDialog=Common.UI.Window.extend(_.extend({options:{width:535,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"],id:"window-pdf-sign"},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.api=this.options.api,this.props=this.options.props,this.fontStore=this.options.fontStore,this.mode=0,this.storage=!!this.options.storage,this.fontName="Arial",this.isImageLoaded=!1,this.template=['<div class="box">','<label style="display: block; margin-bottom: 10px;">'+this.textBefore+"</label>",'<div class="input-row" style="margin-bottom: 15px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-pdf-btn-upload" style="border-radius: 0;">'+this.txtUpload+"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-pdf-btn-draw" style="border-radius: 0;">'+this.txtDraw+"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-pdf-btn-type" style="border-radius: 0;">'+this.txtType+"</button>","</div>",'<label style="display: block; margin-bottom: 3px;">'+this.textLooksAs+"</label>",'<div style="outline: 1px solid #cbcbcb;width: 500px; height: 150px;">','<div class="img-upload" style="width: 100%; height: 100%;">','<div id="pdf-sign-img-upload" style="width: 100%; height: 100%; display: flex; flex-direction:column; align-items: center;">','<table style="height: 100%; width: 60%;text-align: center;">',"<tr>",'<td><div id="id-dlg-pdf-select-image"></div><div><label class="light" style="margin-top:10px;">'+this.txtUploadDesc+"</div></label></div>","</tr>","</table>","</div>",'<div id="pdf-sign-img-upload-preview" class="hidden" style="width: 100%; height: 100%; position: relative; margin: 0 auto;"></div>',"</div>",'<div id="pdf-sign-img-draw-preview" class="img-draw hidden" style="width: 100%; height: 100%; position: relative; margin: 0 auto;"></div>','<div id="pdf-sign-img-type-preview" class="img-type hidden" style="width: 100%; height: 100%; position: relative; margin: 0 auto;"></div>',"</div>",'<div class="input-row" style="margin: 10px 0;">','<div id="pdf-sign-ch-back" class="input-row img-upload" style="display: inline-block; vertical-align: middle;"></div>','<div id="pdf-sign-fonts" class="input-row img-type hidden" style="display: inline-block; vertical-align: middle;"></div>','<div id="pdf-sign-line-size" class="input-row img-draw margin-right-8 hidden" style="display: inline-block; vertical-align: middle;"></div>','<div id="pdf-sign-line-color" class="input-row img-draw hidden" style="display: inline-block;"></div>','<button type="button" class="input-row btn btn-text-default auto float-right" id="pdf-sign-btn-clear">'+this.textClear+"</button>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.btnUpload=new Common.UI.Button({el:e.find("#id-dlg-pdf-btn-upload"),enableToggle:!0,toggleGroup:"pdf-img-type",allowDepress:!1,pressed:!0}),this.btnUpload.on("click",_.bind(this.onImgModeClick,this,0)),this.btnDraw=new Common.UI.Button({el:e.find("#id-dlg-pdf-btn-draw"),enableToggle:!0,toggleGroup:"pdf-img-type",allowDepress:!1}),this.btnDraw.on("click",_.bind(this.onImgModeClick,this,1)),this.btnType=new Common.UI.Button({el:e.find("#id-dlg-pdf-btn-type"),enableToggle:!0,toggleGroup:"pdf-img-type",allowDepress:!1}),this.btnType.on("click",_.bind(this.onImgModeClick,this,2)),this.btnSelectImage=new Common.UI.Button({parentEl:e.find("#id-dlg-pdf-select-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 142px;",menu:new Common.UI.Menu({style:"min-width: 142px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),takeFocusOnClose:!0}),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnSelectImage.menu.items[1].setDisabled(this.options.disableNetworkFunctionality),this.btnSelectImage.menu.items[2].setDisabled(this.options.disableNetworkFunctionality),this.chRemBack=new Common.UI.CheckBox({el:e.find("#pdf-sign-ch-back"),labelText:this.txtRemBack}),this.chRemBack.on("change",(function(e,i,n,s){t.props&&t.props.put_RemoveBackground("checked"===e.getValue())})),this.cmbFonts=new Common.UI.ComboBoxFonts({el:e.find("#pdf-sign-fonts"),cls:"input-group-nr",style:"width: 142px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0}).on("selected",(function(e,i){t.fontName=i.name,t.props&&t.props.put_TypeFont(i.name)})),this.btnLineColor=new Common.UI.ColorButton({parentEl:e.find("#pdf-sign-line-color"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,takeFocusOnClose:!0}),this.colorsLine=this.btnLineColor.getPicker(),this.btnLineColor.on("color:select",_.bind(this.onColorsLineSelect,this)),this.btnLineColor.on("auto:select",_.bind(this.onColorsAutoSelect,this));for(var i=[],n=1;n<6;n++)i.push({value:n,displayValue:n+" px"});this.cmbLineSize=new Common.UI.ComboBox({el:e.find("#pdf-sign-line-size"),cls:"input-group-nr",style:"width: 50px;",menuCls:"scrollable-menu",menuStyle:"min-width: 50px;max-height: 270px;",data:i,takeFocusOnClose:!0}),this.cmbLineSize.setValue(2),this.cmbLineSize.on("selected",(function(e,i){t.props&&t.props.put_LineSize(i.value)})),this.btnClear=new Common.UI.Button({el:e.find("#pdf-sign-btn-clear")}),this.btnClear.on("click",_.bind(this.onClear,this)),this.imgUploadPnl=e.find(".img-upload"),this.imgDrawPnl=e.find(".img-draw"),this.imgTypePnl=e.find(".img-type"),this.uploadEmptyPnl=e.find("#pdf-sign-img-upload"),this.uploadPreviewPnl=e.find("#pdf-sign-img-upload-preview"),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.btnOk.setDisabled(!0),this.afterRender()},getFocusedComponents:function(){return[this.btnUpload,this.btnDraw,this.btnType,this.btnSelectImage,this.chRemBack,this.cmbLineSize,this.btnLineColor,this.cmbFonts,this.btnClear].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){},afterRender:function(){this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.fontName})),this.updateThemeColors(),this._setDefaults(this.props);var t=this,e=function(){t.isImageLoaded=!0,t.uploadEmptyPnl.toggleClass("hidden",!0),t.uploadPreviewPnl.toggleClass("hidden",!1),t.btnOk.setDisabled(!t.mode)};this.api.asc_registerCallback("asc_onSignatureImageLoaded",e);var i=function(e){e&&e._urls&&"signature"===e.c&&t.props.put_ImageUrl(e._urls[0],e.token)};Common.NotificationCenter.on("storage:image-insert",i),this.on("close",(function(n){t.api.asc_unregisterCallback("asc_onSignatureImageLoaded",e),Common.NotificationCenter.off("storage:image-insert",i)}))},updateThemeColors:function(){this.colorsLine.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onImgModeClick:function(t,e){this.mode=t,this.ShowHideElem(t)},ShowHideElem:function(t){this.imgUploadPnl.toggleClass("hidden",!!t),this.imgDrawPnl.toggleClass("hidden",1!==t),this.imgTypePnl.toggleClass("hidden",2!==t),this.btnOk.setDisabled(!t&&!this.isImageLoaded);var e=this;_.delay((function(){1===t?e.cmbLineSize.focus():2===t?e.cmbFonts.focus():e.btnSelectImage.focus()}),50)},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t){var n=e.replace(/ /g,"");_.isEmpty(n)||i.props.put_ImageUrl(n)}}}).on("close",(function(){})).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","signature"):this.props.showFileDialog()},onColorsLineSelect:function(t,e){this.isAutoColor=!1,this.props&&this.props.put_LineColor(Common.Utils.ThemeColor.getRgbColor(e))},onColorsAutoSelect:function(t){this.isAutoColor=!0,this.props&&this.props.put_LineColor("#000000")},_setDefaults:function(t){},getSettings:function(){},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.btnOk.isDisabled())return;this.handler.call(this,t,this.getSettings())}this.close()},onClear:function(){switch(this.mode){case 0:this.props.clearImg(),this.isImageLoaded=!1,this.uploadEmptyPnl.toggleClass("hidden",!1),this.uploadPreviewPnl.toggleClass("hidden",!0),this.btnOk.setDisabled(!0);break;case 1:this.props.clearDraw();break;case 2:this.props.clearType()}},txtTitle:"Signature",txtUpload:"Upload",txtDraw:"Draw",txtType:"Type",textLooksAs:"Signature looks as",textClear:"Clear",textSelect:"Select Image",txtUploadDesc:"You can upload images in JPEG, JPG, GIF and PNG formats with a max size of 30 Mb",textBefore:"Before signing this document, verify that the content you are signing is correct",txtRemBack:"Remove white background",textFromUrl:"From URL",textFromFile:"From File",textFromStorage:"From Storage"},Common.Views.PdfSignDialog||{}))})),define("common/main/lib/view/DocumentPropertyDialog",[],(function(){"use strict";Common.Views.DocumentPropertyDialog=Common.UI.Window.extend(_.extend({options:{width:320,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,defaultValue:{}},t),this.template=['<div style="display: flex; flex-direction: column; margin: 0 20px;">','<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTitleLabel+"</label>",'<div id="id-dlg-title"></div>',"</div>",'<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTypeLabel+"</label>",'<div id="id-dlg-type"></div>',"</div>",'<div style="flex-shrink:0;">',"<label>"+this.txtPropertyValueLabel+"</label>",'<div id="id-dlg-value-input"></div>','<div id="id-dlg-value-date"></div>','<div id="id-dlg-value-boolean"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.asc2type=function(t){return t===AscCommon.c_oVariantTypes.vtLpwstr?"text":t===AscCommon.c_oVariantTypes.vtI4||t===AscCommon.c_oVariantTypes.vtR8?"number":t===AscCommon.c_oVariantTypes.vtBool?"boolean":t===AscCommon.c_oVariantTypes.vtFiletime?"date":void 0},Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.inputTitle=new Common.UI.InputField({el:$("#id-dlg-title"),allowBlank:!1,blankError:this.txtPropertyTitleBlankError,validateOnBlur:!1,hideErrorOnInput:!0,validation:function(e){if(void 0!==t.options.nameValidator)return t.options.nameValidator(e)}}),this.options.defaultValue.name&&this.inputTitle.setValue(this.options.defaultValue.name),this.comboboxType=new Common.UI.ComboBox({el:$("#id-dlg-type"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyTypeText,value:"text"},{displayValue:this.txtPropertyTypeNumber,value:"number"},{displayValue:this.txtPropertyTypeDate,value:"date"},{displayValue:this.txtPropertyTypeBoolean,value:"boolean"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0});var e=this.options.defaultValue.type?this.asc2type(this.options.defaultValue.type):"text";this.comboboxType.setValue(e),this.comboboxType.on("selected",_.bind((function(t,e){this.inputTextOrNumber.setVisible("text"===e.value||"number"===e.value),this.comboboxBoolean.setVisible("boolean"===e.value),this.datepicker.setVisible("date"===e.value)}),this)),this.inputTextOrNumber=new Common.UI.InputField({el:$("#id-dlg-value-input"),style:"width: 100%;",validateOnBlur:!1,hideErrorOnInput:!0,allowBlank:!1,blankError:this.txtPropertyValueBlankError,validation:function(t){return"number"!==this.comboboxType.getValue()||"number"==typeof t||!isNaN(t.replace(",","."))||this.txtPropertyTypeNumberInvalid}.bind(this)}),!this.options.defaultValue.value||"text"!==e&&"number"!==e||this.inputTextOrNumber.setValue(this.options.defaultValue.value),this.inputTextOrNumber.setVisible(this.options.defaultValue.type?this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtFiletime&&this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtBool:"text"===e||"number"===e),this.comboboxBoolean=new Common.UI.ComboBox({el:$("#id-dlg-value-boolean"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyBooleanTrue,value:1},{displayValue:this.txtPropertyBooleanFalse,value:0}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0}),this.comboboxBoolean.setValue(void 0!==this.options.defaultValue.value&&"boolean"===e?this.options.defaultValue.value?1:0:1),this.comboboxBoolean.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtBool:"boolean"===e),this.datepicker=new Common.UI.InputFieldBtnCalendar({el:$("#id-dlg-value-date"),allowBlank:!1,blankError:this.txtPropertyValueBlankError,validateOnBlur:!1,value:"",hideErrorOnInput:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.options.defaultValue.value&&"date"===e&&(this.datepicker.setDate(this.options.defaultValue.value),this.datepicker.setValue(this.dateToString(this.options.defaultValue.value))),this.datepicker.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtFiletime:"date"===e),this.datepicker.on("date:click",function(t,e){t.setValue(this.dateToString(e))}.bind(this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputTitle,this.comboboxType,this.inputTextOrNumber,this.comboboxBoolean,this.datepicker].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputTitle},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.inputTitle.focus()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler&&"ok"===t){if(!0!==this.inputTitle.checkValidate())return void this.inputTitle.focus();var e,i,n=this.inputTitle.getValue(),s=this.comboboxType.getValue();if("boolean"===s)e=1===this.comboboxBoolean.getValue(),i=AscCommon.c_oVariantTypes.vtBool;else if("date"===s){if(!0!==this.datepicker.checkValidate())return void this.datepicker.focus();if((e=this.datepicker.getDate())||(e=new Date(this.datepicker.getValue()))&&e instanceof Date&&!isNaN(e)||(e=void 0),!e){var o=this;return void Common.UI.warning({msg:o.errorDate,buttons:["ok","cancel"],callback:function(e){"ok"===e?(o.options.handler.call(this,t,n,AscCommon.c_oVariantTypes.vtLpwstr,o.datepicker.getValue()),o.close()):o.datepicker.focus()}})}i=AscCommon.c_oVariantTypes.vtFiletime}else{if(!0!==this.inputTextOrNumber.checkValidate())return void this.inputTextOrNumber.focus();var a=this.inputTextOrNumber.getValue();"text"===s?(i=AscCommon.c_oVariantTypes.vtLpwstr,e=a):("number"!=typeof a&&(a=a.replace(",",".")),a%1==0?(i=AscCommon.c_oVariantTypes.vtI4,e=parseInt(a)):(i=AscCommon.c_oVariantTypes.vtR8,e=parseFloat(a)))}this.options.handler.call(this,t,n,i,e)}this.close()},dateToString:function(t){var e="";if(t){t=new Date(t);var i=(this.options.lang||"en").replace("_","-").toLowerCase();try{i=="ar-SA".toLowerCase()&&(i+="-u-nu-latn-ca-gregory"),e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}catch(n){i="en",e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}}return e},txtTitle:"New Document Property",txtPropertyTitleLabel:"Title",txtPropertyTitleBlankError:"Property should have a title",txtPropertyTypeLabel:"Type",txtPropertyValueLabel:"Value",txtPropertyValueBlankError:"Property should have a value",txtPropertyTypeText:"Text",txtPropertyTypeNumber:"Number",txtPropertyTypeNumberInvalid:"Provide a valid number",txtPropertyTypeDate:"Date",txtPropertyTypeBoolean:'"Yes" or "no"',txtPropertyBooleanTrue:"Yes",txtPropertyBooleanFalse:"No",errorDate:"You can choose a value from the calendar to store the value as Date.<br>If you enter a value manually, it will be stored as Text."},Common.Views.DocumentPropertyDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/MacrosDialog",[],(function(){"use strict";Common.Views.MacrosDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=Math.max(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top"),350),n=Math.max(Common.Utils.innerWidth(),600);_.extend(e,{id:"macros-dialog",title:this.textTitle,header:!0,help:!0,width:Math.min(810,n),height:Math.min(512,i),minwidth:750,minheight:350,resizable:!0,cls:"modal-dlg invisible-borders",buttons:[{value:"ok",caption:this.textSave},"cancel"]},t||{}),this.api=t.api,this.ItemTypes={CustomFunction:0,Macros:1},this._state={isFunctionsSupport:!!window.SSE,selectedItem:{record:null,type:null},currentValue:"",currentPos:{row:3,column:0}},this.template=['<div id="macros-dialog-content"><div id="macros-dialog-left" class="noselect"><div id="macros-menu" <% if(!isFunctionsSupport){%> style="height: 100%;" <% } %>><div class="menu-header"><label>'+this.textMacros+'</label><div id="btn-ai-macros-add"></div><div id="btn-macros-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-list"></div></div><div class="separator horizontal" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ></div><div id="functions-menu" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ><div class="menu-header"><label id="macros-dialog-functions-label">'+this.textCustomFunctions+'</label><div id="btn-function-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="functions-list"></div></div></div><div class="separator vertical" style="position: relative"></div><div id="macros-dialog-right"><div class="menu-header"><div id="btn-macros-undo"></div><div id="btn-macros-redo"></div><div id="btn-macros-run" class="lock-for-function"></div><div id="btn-macros-debug" class="lock-for-function"></div><div id="btn-macros-copy"></div><div id="btn-macros-rename"></div><div id="btn-macros-delete"></div><div id="ch-macros-autostart" class="lock-for-function"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-code-editor" class="invisible"></div></div></div><div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)({isFunctionsSupport:this._state.isFunctionsSupport}),this.on({help:this.onHelp,drag:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])},resize:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])}}),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.aceContainer=e.find("#macros-code-editor"),t.createCodeEditor(),t.renderAfterAceLoaded(),t.calcHeaderBreakpoints(),t.collapseHeaderItems(),t.updateCustomFunctionLabel();var i=_.throttle(_.bind(this.collapseHeaderItems,this),100);this.on("resizing",(function(){i()}))},renderAfterAceLoaded:function(){this.btnUndo=new Common.UI.Button({parentEl:$("#btn-macros-undo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo icon-rtl",hint:this.tipUndo}).on("click",_.bind(this.onUndo,this)),this.btnRedo=new Common.UI.Button({parentEl:$("#btn-macros-redo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo icon-rtl",hint:this.tipRedo}).on("click",_.bind(this.onRedo,this)),this.btnRun=new Common.UI.Button({parentEl:$("#btn-macros-run"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-run",caption:this.textRun,hint:this.tipMacrosRun}).on("click",_.bind(this.onRunMacros,this,!1)),this.btnDebug=new Common.UI.Button({parentEl:$("#btn-macros-debug"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-debug",caption:this.textDebug,hint:this.tipMacrosDebug}).on("click",_.bind(this.onRunMacros,this,!0)),this.btnCopy=new Common.UI.Button({parentEl:$("#btn-macros-copy"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",caption:this.textCopy,hint:this.tipMacrosCopy}).on("click",_.bind(this.onCopyItem,this)),this.btnRename=new Common.UI.Button({parentEl:$("#btn-macros-rename"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rename",caption:this.textRename,hint:this.tipMacrosRename}).on("click",_.bind(this.onRenameItem,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#btn-macros-delete"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",caption:this.textDelete,hint:this.tipMacrosDelete}).on("click",_.bind(this.onDeleteItem,this)),this.chAutostart=new Common.UI.CheckBox({el:$("#ch-macros-autostart"),labelText:this.textAutostart}).on("change",_.bind(this.onChangeAutostart,this));var t=this.api.checkAI();this.btnAiMacrosAdd=new Common.UI.Button({parentEl:$("#btn-ai-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-general-ai",menu:new Common.UI.Menu({additionalAlign:this.menuAddAlign,items:[{caption:this.textCreateFromDesc,value:"create",disabled:!t},{caption:this.textConvertFromVBA,value:"convert",disabled:!t}]}),hint:this.tipAi}),this.btnAiMacrosAdd.menu.on("item:click",_.bind(this.onAiMenu,this)),this.btnMacrosAdd=new Common.UI.Button({parentEl:$("#btn-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipMacrosAdd}).on("click",_.bind(this.onCreateMacros,this,"")),this.listMacros=new Common.UI.ListView({el:$("#macros-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,itemTemplate:_.template(['<div class="listitem-autostart">',"<% if (autostart) { %>","<span>(A)</span>","<% } %>","</div>",'<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listMacros.on("item:add",_.bind(this.onAddListItem,this)),this.listMacros.on("item:select",_.bind(this.onSelectListMacrosItem,this)),this.setListMacros(),this._state.isFunctionsSupport&&(this.btnFunctionAdd=new Common.UI.Button({parentEl:$("#btn-function-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipFunctionAdd}).on("click",_.bind(this.onCreateFunction,this)),this.listFunctions=new Common.UI.ListView({el:$("#functions-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template(['<div class="listitem-autostart"></div>','<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listFunctions.on("item:add",_.bind(this.onAddListItem,this)),this.listFunctions.on("item:select",_.bind(this.onSelectListFunctionItem,this)),this.setListFunctions()),this.makeDragable()},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-code-editor"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue(t._state.currentValue,t._state.currentPos),setTimeout((function(){t.aceContainer.removeClass("invisible")}),10)})),this.codeEditor.on("change",(function(e,i){t._state.selectedItem.record&&(t._state.currentValue=e,t._state.currentPos=i,t._state.selectedItem.record.set("value",e),t._state.selectedItem.record.set("currentPos",i))}))},calcHeaderBreakpoints:function(){this.breakpoints=[];var t=this,e=10,i=[{btn:this.btnUndo,collapsible:!1},{btn:this.btnRedo,collapsible:!1},{btn:this.btnRun,collapsible:!0},{btn:this.btnDebug,collapsible:!0},{btn:this.btnCopy,collapsible:!0},{btn:this.btnRename,collapsible:!0},{btn:this.btnDelete,collapsible:!0},{btn:this.chAutostart,collapsible:!1,withoutMargin:!0}];this.collapsibleHeaderItems=i.filter((function(t){return t.collapsible})),i.forEach((function(t){var i=t.btn.$el.find(".caption"),n=i.hasClass("hide");i.removeClass("hide"),t.expandedWidth=t.btn.$el.outerWidth(!t.withoutMargin),t.collapsedWidth=t.collapsible?t.expandedWidth-i.outerWidth(!0):t.expandedWidth,e+=t.expandedWidth,n&&i.addClass("hide")})),this.collapsibleHeaderItems.forEach((function(i,n){if(0==n)t.breakpoints.push({width:e,collapseItems:[i]});else{var s=t.breakpoints[n-1],o=t.collapsibleHeaderItems[n-1];t.breakpoints.push({width:s.width-(o.expandedWidth-o.collapsedWidth),collapseItems:[i].concat(s.collapseItems)})}}))},collapseHeaderItems:function(){var t=this.getChild().find("#macros-dialog-right .menu-header").width(),e=null;for(let i=this.breakpoints.length-1;i>=0;i--)if(t<this.breakpoints[i].width){e=this.breakpoints[i];break}this.collapsibleHeaderItems.forEach((function(t){var i=e&&-1!==e.collapseItems.indexOf(t);t.btn.$el.find(".caption").toggleClass("hide",!!i)}))},updateCustomFunctionLabel:function(){var t=this.getChild(),e=t.find("#macros-dialog-left"),i=t.find("#functions-menu .menu-header"),n=t.find("#btn-function-add"),s=t.find("#macros-dialog-functions-label"),o=(parseFloat(e.css("min-width"))||0)-((parseFloat(i.css("padding-left"))||0)+(parseFloat(i.css("padding-right"))||0))-(n.outerWidth(!0)||0);s.width()>o&&s.text(this.textFunctions)},setListMacros:function(){var t=this,e=this.parseDataFromApi(this.api.pluginMethod_GetMacros()),i=e.macrosArray,n=this.api.pluginMethod_GetVBAMacros();n&&"string"==typeof n&&n.includes("<Module")&&n.split("<Module ").filter((function(t){return t.includes('Type="Procedural"')||t.includes('Type="Class"')})).forEach((function(e){var n=e.indexOf("<SourceCode>")+12,s=e.indexOf("</SourceCode>",n),o=e.slice(n,s);n=e.indexOf('Name="')+6,s=e.indexOf('"',n);var a=e.slice(n,s);-1==i.findIndex((function(t){return t.name==a}))&&(o=(o=(o=(o=(o=(o=o.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')).replace(/Attribute [^\r\n]*\r\n/g,""),i.push({guid:t.createGuid(),name:a,autostart:!1,value:"(function()\n{\n\t/* Enter your code here. */\n})();\n\n/*\nExecution of VBA commands does not support.\n"+o+"*/"}))}));if(i.length>0){i.forEach((function(t){t.autostart=!!t.autostart,t.currentPos={row:3,column:0}})),this.listMacros.store.reset(i);var s=this.listMacros.store.at(e.current);s&&this.listMacros.selectRecord(s)}else this.onCreateMacros()},setListFunctions:function(){var t=this.parseDataFromApi(this.api.pluginMethod_GetCustomFunctions()).macrosArray;this.listFunctions.store.reset(t)},makeDragable:function(){var t,e,i=this,n=0,s=document.getElementById("macros-list"),o=document.getElementById("functions-list");function a(t,e){i.codeEditor.disableDrop(!0);var s=$(e.target).children(".list-item").attr("id");e.dataTransfer.setData("text/plain",s),e.dataTransfer.effectAllowed="move",e.target.classList.add("dragged"),n=t.store.indexOf(t.store.findWhere({id:s})),e.target.click()}function l(t,s){if(i.codeEditor.disableDrop(!1),s.target.classList.remove("dragged"),$(".dragHovered").removeClass("dragHovered"),n===e||null==e)return;-1===e&&(e=t.store.length),n<e&&e--;var o=t.store.models.slice();let a=o.splice(n,1)[0];o.splice(e,0,a),t.store.reset(o),n=0}function r(n,s,o){o.preventDefault(),t=o.target;let a=i._state.selectedItem.type===s;o.dataTransfer.dropEffect=a?"move":"none";t.classList.contains("draggable")&&a&&(e=function(t,e,i){var n=i.index(e),s=Common.Utils.getBoundingClientRect(e);return t>s.y+.45*s.height&&(n+=1),n}(o.clientY,t,$(n).find(".item")),$(".dragHovered").removeClass("dragHovered"),e<$(n).find(".item").length?($(n).find(".item").last().removeClass(["dragHovered","last"]),$(n).find(".item")[e].classList.add("dragHovered")):$(n).find(".item").last().addClass(["dragHovered","last"]))}function c(t){if(t.fromElement){if("list"==$(t.fromElement).attr("role")||"listitem"==$(t.fromElement).attr("role")||$(t.fromElement).parents('[role="listitem"]').length)return;$(".dragHovered").removeClass("dragHovered"),e=null}}s.addEventListener("dragstart",(function(t){a(i.listMacros,t)})),o.addEventListener("dragstart",(function(t){a(i.listFunctions,t)})),s.addEventListener("dragend",(function(t){l(i.listMacros,t)})),o.addEventListener("dragend",(function(t){l(i.listFunctions,t)})),s.addEventListener("dragover",(function(t){r(s,i.ItemTypes.Macros,t)})),o.addEventListener("dragover",(function(t){r(o,i.ItemTypes.CustomFunction,t)})),s.addEventListener("dragleave",(function(t){c(t)})),o.addEventListener("dragleave",(function(t){c(t)}))},selectItem:function(t,e){this._state.selectedItem.record=t,this._state.selectedItem.type=e,this.codeEditor.setValue(t.get("value"),void 0!==t.get("currentPos")?t.get("currentPos"):{row:3,column:0}),this.codeEditor.revealPositionInCenter(),this._state.currentValue=t.get("value"),this._state.currentPos=t.get("currentPos"),this.chAutostart.setValue(t.get("autostart")),this.getChild().find(".lock-for-function").toggleClass("hidden",e==this.ItemTypes.CustomFunction),e==this.ItemTypes.Macros&&this.listFunctions&&this.listFunctions.deselectAll(),e==this.ItemTypes.CustomFunction&&this.listMacros&&this.listMacros.deselectAll(),this.updateHintButtons(),this.setDisableButtons(!1)},updateHintButtons:function(){var t=this._state.selectedItem.type==this.ItemTypes.Macros?"Macros":"Function";this.btnCopy.updateHint(this["tip"+t+"Copy"]),this.btnRename.updateHint(this["tip"+t+"Rename"]),this.btnDelete.updateHint(this["tip"+t+"Delete"])},setDisableButtons:function(t){this.btnUndo.setDisabled(t),this.btnRedo.setDisabled(t),this.btnRun.setDisabled(t),this.btnDebug.setDisabled(t),this.btnCopy.setDisabled(t),this.btnRename.setDisabled(t),this.btnDelete.setDisabled(t),this.chAutostart.setDisabled(t)},parseDataFromApi:function(t){var e={macrosArray:[],current:-1};if(t)try{e=JSON.parse(t)}catch(t){e={macrosArray:[],current:-1}}return e},createGuid:function(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"");return e},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){},close:function(t){this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),"ok"===t&&(this.api.pluginMethod_SetMacros(JSON.stringify({macrosArray:this.listMacros.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),autostart:t.get("autostart"),value:t.get("value")}})),current:this.listMacros.store.indexOf(this.listMacros.getSelectedRec())})),this._state.isFunctionsSupport&&this.api.pluginMethod_SetCustomFunctions(JSON.stringify({macrosArray:this.listFunctions.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),value:t.get("value")}}))}))),this.close()},onAddListItem:function(t,e){e.$el.attr("draggable",!0),e.$el.addClass("draggable")},onCopyItem:function(){if(!this._state.selectedItem.record)return;let t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record;t.store.add({guid:this.createGuid(),name:e.get("name")+"_copy",value:e.get("value"),autostart:e.get("autostart")}),t.selectRecord(t.store.at(-1))},onRenameItem:function(){if(this._state.selectedItem.record){var t=this,e=300,i=90,n=Common.Utils.getBoundingClientRect(this.$window[0]);new Common.Views.TextInputDialog({value:t._state.selectedItem.record.get("name"),width:e,height:i,inputConfig:{allowBlank:!1,validation:function(t){return t.trim().length>0||""}},handler:function(e,i){"ok"==e&&t._state.selectedItem.record.set("name",i.trim())}}).show(n.left+(n.width-e)/2,n.top+(n.height-i)/2)}},onCreateMacros:function(t){var e=0,i="Macro",n=this.textMacro;this.listMacros.store.each((function(t,s){var o=t.get("name");if(0==o.indexOf(i)){s=parseInt(o.substr(5));!isNaN(s)&&e<s&&(e=s)}else if(0==o.indexOf(n)){s=parseInt(o.substr(n.length));!isNaN(s)&&e<s&&(e=s)}})),e++,this.listMacros.store.add({guid:this.createGuid(),name:n+" "+e,value:t||"(function()\n{\n    \n})();",autostart:!1,currentPos:{row:3,column:5}}),this.listMacros.selectRecord(this.listMacros.store.at(-1))},onSelectListMacrosItem:function(t,e,i){this.selectItem(i,this.ItemTypes.Macros)},onUndo:function(){this.codeEditor.undo()},onRedo:function(){this.codeEditor.redo()},onAiMenu:function(t,e){var i=this,n="",s="",o="Generate JavaScript code as an Immediately Invoked Function Expression (IIFE), in the format (function(){ ... })();, that [describe what the code should do]. The code should be self-contained and execute immediately. ",a=Common.Locale.getCurrentLanguage(),l=Common.util.LanguageInfo.getLocalLanguageName(Common.util.LanguageInfo.getLocalLanguageCode(a));l=l&&"string"==typeof l[1]?l[1]:null;var r="Document Editor";(window.PE&&(r="Presentation Editor"),window.SSE&&(r="Spreadsheet Editor"),"create"==e.value?(n=this.textCreateMacrosFromDesc,s="Create a macro for OnlyOffice. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The format of the code is JavaScript. Write comments in the same language as the user prompt. The description of what the macro should do is also described in the user message. "+o):"convert"==e.value&&(n=this.textConvertMacrosFromVBA,s="Convert macro for OnlyOffice from VBA. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The code format is JavaScript. Write comments in "+a+(l?"("+l+")":"")+" language. The code of the macro in VBA should be presented in the user message. "+o),"create"==e.value||"convert"==e.value)&&new Common.Views.MacrosAiDialog({title:n,api:this.api,instruction:s,inputType:"create"==e.value?"textarea":"codeEditor",handler:function(t,e){"ok"==t&&i.onCreateMacros(e)}}).show()},onRunMacros:function(t){this.api.callCommand(t?"debugger;\n"+this._state.currentValue:this._state.currentValue)},onChangeAutostart:function(t,e){this._state.selectedItem.record&&this._state.selectedItem.record.set("autostart","checked"==e)},onDeleteItem:function(){if(!this._state.selectedItem.record)return;let t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record;var i=t.store.indexOf(e);if(t.store.remove(e),t.store.length>0){var n=i<t.store.length?i:t.store.length-1;t.selectByIndex(n)}else this.codeEditor.setValue("",{row:0,column:0},!0),this.setDisableButtons(!0)},onCreateFunction:function(){var t=0,e=this.textCustomFunction;this.listFunctions.store.each((function(i,n){var s=i.get("name");if(0==s.indexOf("Custom function")){n=parseInt(s.substr(15));!isNaN(n)&&t<n&&(t=n)}else if(0==s.indexOf(e)){n=parseInt(s.substr(e.length));!isNaN(n)&&t<n&&(t=n)}})),t++,this.listFunctions.store.add({guid:this.createGuid(),name:e+" "+t,value:"(function()\n{\n\t/**\n\t * Function that returns the argument\n\t * @customfunction\n\t * @param {any} arg Any data.\n     * @returns {any} The argumet of the function.\n\t*/\n\tfunction myFunction(arg) {\n\t\t\n\t    return arg;\n\t}\n\tApi.AddCustomFunction(myFunction);\n})();",currentPos:{row:10,column:3}}),this.listFunctions.selectRecord(this.listFunctions.store.at(-1))},onSelectListFunctionItem:function(t,e,i){this.selectItem(i,this.ItemTypes.CustomFunction)},onThemeChanged:function(){this.calcHeaderBreakpoints(),this.collapseHeaderItems(),Common.UI.Window.prototype.onThemeChanged.call(this)},onHelp:function(){window.open("https://api.onlyoffice.com/docs/plugin-and-macros/macros/getting-started/","_blank")},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},textTitle:"Macros",textSave:"Save",textMacro:"Macro",textMacros:"Macros",textRun:"Run",textDebug:"Debug",textAutostart:"Autostart",textRename:"Rename",textDelete:"Delete",textCopy:"Copy",textCustomFunction:"Custom function",textCustomFunctions:"Custom functions",textFunctions:"Functions",textLoading:"Loading...",textCreateFromDesc:"Create from description",textCreateMacrosFromDesc:"Create macros from description",textConvertFromVBA:"Convert from VBA",textConvertMacrosFromVBA:"Convert macros from VBA",tipUndo:"Undo",tipRedo:"Redo",tipMacrosRename:"Rename macros",tipMacrosDelete:"Delete macros",tipMacrosCopy:"Copy macros",tipMacrosRun:"Run macros",tipMacrosDebug:"Debug macros",tipMacrosAdd:"Add macros",tipFunctionRename:"Rename custom function",tipFunctionDelete:"Delete custom function",tipFunctionCopy:"Copy custom function",tipFunctionAdd:"Add custom function",tipAi:"AI"},Common.Views.MacrosDialog||{}))})),define("common/main/lib/view/MacrosAiDialog",[],(function(){"use strict";Common.Views.MacrosAiDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i={width:{init:400,min:400,max:800},height:{init:200,min:200,max:400}},n="modal-dlg invisible-borders";"codeEditor"==t.inputType&&(i={width:{init:600,min:600,max:1e3},height:{init:400,min:400,max:600}},n+=" padding-none"),_.extend(e,{id:"macros-ai-dialog",title:t.title,width:i.width.init,height:i.height.init,minwidth:i.width.min,minheight:i.height.min,maxwidth:i.width.max,maxheight:i.height.max,resizable:!0,cls:n,buttons:[{caption:this.textCreate,value:"ok",primary:!0},"cancel"]},t||{}),this.api=t.api,this.instruction=t.instruction,this.inputType=t.inputType||"textarea",this._state={codeEditorValue:""},"textarea"==this.inputType?this.template=['<div class="box">','<div id="macros-ai-dialog-textarea"></div>',"</div>"].join(""):this.template=['<div id="macros-ai-dialog-code-editor"></div>','<div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();"textarea"==this.inputType?this.textareaPrompt=new Common.UI.TextareaField({el:t.find("#macros-ai-dialog-textarea"),placeHolder:this.textAreaPlaceholder}):this.createCodeEditor(),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-ai-dialog-code-editor",language:"vba"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue("",{row:0,column:0})})),this.codeEditor.on("change",(function(e,i){t._state.codeEditorValue=e}))},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},show:function(){if(Common.UI.Window.prototype.show.apply(this,arguments),this.textareaPrompt){var t=this;_.delay((function(){t.textareaPrompt.focus()}),50)}},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},close:function(t){this.codeEditor&&this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){if(this.options.handler)if("ok"==t){var e=this,i="textarea"==this.inputType?this.textareaPrompt.getValue():this._state.codeEditorValue;e.api.AI({type:"text",data:[{role:"system",content:this.instruction},{role:"user",content:i}]},(function(i){if(i.error){if("no-engine"===i.type)return e._handleInput("cancel");console.log(i.error)}else{if(!i||!i.text)return e._handleInput("cancel");function s(t,e,i){let n=e||0;if(-1!=n){let e=['"',"'","\n","\r"];for(!0===i&&e.push(" ");n<t.length&&e.includes(t[n]);)n++;let s=t.length-1;for(;s>0&&e.includes(t[s]);)s--;if(s>n)return t.substring(n,s+1)}return t}var n=i.text.replace(/```javascript|```/g,"");n=s(n,0,!0),e.close(),e.options.handler.call(e,t,n)}}))}else this.close(),this.options.handler.call(this,t)},textCreate:"Create",textAreaPlaceholder:"Input a prompt for the query"},Common.Views.MacrosAiDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/component/MonacoEditor",[],(function(){"use strict";Common.UI.MonacoEditor=Common.UI.BaseView.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=_.uniqueId(),this.parentEl=t.parentEl,this.language=t.language||"javascript",this.parentEl&&this.render(this.parentEl)},render:function(t){this.parentEl="string"==typeof t?$(t):t,this.iframe=document.createElement("iframe"),this.iframe.width="100%",this.iframe.height="100%",this.iframe.align="top",this.iframe.frameBorder=0,this.iframe.scrolling="no",this.iframe.onload=_.bind(this._onLoad,this),this.parentEl.append(this.iframe),this.loadMask=new Common.UI.LoadMask({owner:this.parentEl}),this.loadMask.show();var e="../../../vendor/monaco/MonacoEditor.html";e+="?editorType="+(window.SSE?"cell":window.PE?"slide":"word"),e+="&language="+this.language,e+="&id="+this.id,this.iframe.src=e;var i=this;this._eventfunc=function(t){i._onMessage(t)},this._updatebind=function(){i.updateTheme()},this._bindWindowEvents.call(this)},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc),Common.NotificationCenter.on("uitheme:changed",this._updatebind)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc),Common.NotificationCenter.off("uitheme:changed",this._updatebind)},_postMessage:function(t,e){t&&t.postMessage&&window.JSON&&(e.referer="monaco-editor-"+this.id,t.postMessage(window.JSON.stringify(e),"*"))},_onMessage:function(t){var e=t.data;if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var i;try{i=window.JSON.parse(e)}catch(t){i=""}if(i&&i.referer=="monaco-editor-"+this.id)switch(i.command){case"changeValue":e=i.data||{},this.fireEvent("change",e.value,e.pos);break;case"monacoEditorReady":this.fireEvent("ready",i.data)}}},_onLoad:function(){this.updateTheme(),this.loadMask&&this.loadMask.hide()},setValue:function(t,e,i){this._postMessage(this.iframe.contentWindow,{command:"setValue",data:{value:t,readonly:i,currentPos:e}})},updateTheme:function(){this._postMessage(this.iframe.contentWindow,{command:"setTheme",data:Common.UI.Themes.getThemeColors()})},disableDrop:function(t){this._postMessage(this.iframe.contentWindow,{command:"disableDrop",data:t})},revealPositionInCenter:function(){this._postMessage(this.iframe.contentWindow,{command:"revealPositionInCenter",data:{}})},undo:function(){this._postMessage(this.iframe.contentWindow,{command:"undo",data:{}})},redo:function(){this._postMessage(this.iframe.contentWindow,{command:"redo",data:{}})},enablePointerEvents:function(t){this.iframe&&(this.iframe.style.pointerEvents=t?"":"none")},destroyEditor:function(){this._unbindWindowEvents()}})})),define("documenteditor/main/app/controller/DocumentHolderExt",[],(function(){"use strict";if(window.DE&&window.DE.Controllers&&window.DE.Controllers.DocumentHolder){let t=window.DE.Controllers.DocumentHolder.prototype;t.setEvents=function(){this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements,"equation:callback":this.equationCallback}}),this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onHyperlinkClick,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onMouseMove,this)),!0===this.mode.isEdit&&(this.api.asc_registerCallback("asc_onImgWrapStyleChanged",_.bind(this.onImgWrapStyleChanged,this)),this.api.asc_registerCallback("asc_onDialogAddHyperlink",_.bind(this.onDialogAddHyperlink,this)),this.api.asc_registerCallback("asc_doubleClickOnChart",_.bind(this.onDoubleClickOnChart,this)),this.api.asc_registerCallback("asc_doubleClickOnTableOleObject",_.bind(this.onDoubleClickOnTableOleObject,this)),this.api.asc_registerCallback("asc_onSpellCheckVariantsFound",_.bind(this.onSpellCheckVariantsFound,this)),this.api.asc_registerCallback("asc_onRulerDblClick",_.bind(this.onRulerDblClick,this)),this.api.asc_registerCallback("asc_ChangeCropState",_.bind(this.onChangeCropState,this)),this.api.asc_registerCallback("asc_onShowMathTrack",_.bind(this.onShowMathTrack,this)),this.api.asc_registerCallback("asc_onHideMathTrack",_.bind(this.onHideMathTrack,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(this.onInsertImage,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(this.onInsertImageUrl,this)),this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropper,this)),this.api.asc_SetMathInputType(Common.localStorage.getBool("de-equation-input-latex")?Asc.c_oAscMathInputType.LaTeX:Asc.c_oAscMathInputType.Unicode)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onFocusObject,this)),this.api.asc_registerCallback("asc_onShowSpecialPasteOptions",_.bind(this.onShowSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onHideSpecialPasteOptions",_.bind(this.onHideSpecialPasteOptions,this)),(this.mode.isEdit||this.mode.isRestrictedEdit&&this.mode.canFillForms)&&(this.api.asc_registerCallback("asc_onShowContentControlsActions",_.bind(this.onShowContentControlsActions,this)),this.api.asc_registerCallback("asc_onHideContentControlsActions",_.bind(this.onHideContentControlsActions,this)),Common.NotificationCenter.on("storage:image-insert",_.bind(this.insertImageFromStorage,this)),Common.NotificationCenter.on("forms:image-select",_.bind(this.selectFormImage,this))),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)))},t.initExternalEditors=function(){var t=this,e=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");e&&(e.on("internalmessage",_.bind((function(t,i){i.data.command;var n=i.data.data;this.api&&(e.isEditMode()?this.api.asc_editChartDrawingObject(n):this.api.asc_addChartDrawingObject(n))}),this)),e.on("hide",_.bind((function(e,i){this.api&&(this.api.asc_onCloseChartFrame(),this.api.asc_enableKeyEvents(!0)),setTimeout((function(){t.editComplete()}),10)}),this)));var i=this.getApplication().getController("Common.Controllers.ExternalMergeEditor").getView("Common.Views.ExternalMergeEditor");i&&(i.on("internalmessage",_.bind((function(t,e){e.data.command;var i=e.data.data;this.api&&this.api.asc_setMailMergeData(i)}),this)),i.on("hide",_.bind((function(e,i){this.api&&this.api.asc_enableKeyEvents(!0),setTimeout((function(){t.editComplete()}),10)}),this)));var n=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");n&&(n.on("internalmessage",_.bind((function(t,e){e.data.command;var i=e.data.data;this.api&&(n.isEditMode()?this.api.asc_editTableOleObject(i):this.api.asc_addTableOleObject(i))}),this)),n.on("hide",_.bind((function(e,i){this.api&&(this.api.asc_enableKeyEvents(!0),this.api.asc_onCloseChartFrame()),setTimeout((function(){t.editComplete()}),10)}),this)))},t.createDelayedElements=function(t,e){var i=this;t=i.documentHolder;if("view"===e)return t.menuViewCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuViewPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuViewCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuViewUndo.on("click",_.bind(i.onUndo,i)),t.menuViewAddComment.on("click",_.bind(i.addComment,i)),t.menuSignatureViewSign.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureDetails.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureViewSetup.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureRemove.on("click",_.bind(i.onSignatureClick,i)),void t.menuViewPrint.on("click",_.bind(i.onPrintSelection,i));if("pdf"!==e){if("forms"===e)return t.menuPDFFormsUndo.on("click",_.bind(i.onUndo,i)),t.menuPDFFormsRedo.on("click",_.bind(i.onRedo,i)),t.menuPDFFormsClear.on("click",_.bind(i.onClear,i)),t.menuPDFFormsCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuPDFFormsCopy.on("click",_.bind(i.onCutCopyPaste,i)),void t.menuPDFFormsPaste.on("click",_.bind(i.onCutCopyPaste,i));t.menuEditObject.on("click",_.bind(i.onEditObject,i)),t.menuInsertCaption.on("click",_.bind(i.onInsertCaption,i)),t.menuEquationInsertCaption.on("click",_.bind(i.onInsertCaption,i)),t.menuTableInsertCaption.on("click",_.bind(i.onInsertCaption,i)),t.menuChartEdit.on("click",_.bind(i.editChartClick,i)),t.menuImgCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTablePaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgAccept.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuImgReject.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuTableAccept.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuTableReject.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuParaAccept.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuParaReject.on("click",_.bind(i.onAcceptRejectChange,i)),t.menuImgPrint.on("click",_.bind(i.onPrintSelection,i)),t.menuTablePrint.on("click",_.bind(i.onPrintSelection,i)),t.menuParaPrint.on("click",_.bind(i.onPrintSelection,i)),t.menuSignatureEditSign.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureEditSetup.on("click",_.bind(i.onSignatureClick,i)),t.menuImgRotate.menu.items[0].on("click",_.bind(i.onImgRotate,i)),t.menuImgRotate.menu.items[1].on("click",_.bind(i.onImgRotate,i)),t.menuImgRotate.menu.items[3].on("click",_.bind(i.onImgFlip,i)),t.menuImgRotate.menu.items[4].on("click",_.bind(i.onImgFlip,i)),t.menuImgCrop.menu.on("item:click",_.bind(i.onImgCrop,i)),t.menuImgResetCrop.on("click",_.bind(i.onImgResetCrop,i)),t.menuImgRemoveControl.on("click",_.bind(i.onControlsSelect,i)),t.menuImgControlSettings.on("click",_.bind(i.onControlsSelect,i)),t.menuTableRemoveForm.on("click",_.bind(i.onControlsSelect,i)),t.menuTableRemoveControl.on("click",_.bind(i.onControlsSelect,i)),t.menuTableControlSettings.on("click",_.bind(i.onControlsSelect,i)),t.menuParaRemoveControl.on("click",_.bind(i.onControlsSelect,i)),t.menuParaControlSettings.on("click",_.bind(i.onControlsSelect,i)),t.menuTableCellAlign.menu.on("item:click",_.bind(i.tableCellsVAlign,i)),t.menuTableAdvanced.on("click",_.bind(i.advancedTableClick,i)),t.menuParagraphAdvancedInTable.on("click",_.bind(i.advancedParagraphClick,i)),t.menuParagraphAdvanced.on("click",_.bind(i.advancedParagraphClick,i)),t.menuEditHyperlinkTable.on("click",_.bind(i.editHyperlink,i)),t.menuEditHyperlinkPara.on("click",_.bind(i.editHyperlink,i)),t.menuRemoveHyperlinkTable.on("click",_.bind(i.onRemoveHyperlink,i)),t.menuRemoveHyperlinkPara.on("click",_.bind(i.onRemoveHyperlink,i)),t.menuAddHyperlinkTable.on("click",_.bind(i.addHyperlink,i)),t.menuAddHyperlinkPara.on("click",_.bind(i.addHyperlink,i)),t.menuAddCommentTable.on("click",_.bind(i.addComment,i)),t.menuAddCommentPara.on("click",_.bind(i.addComment,i)),t.menuTableFollow.on("click",_.bind(i.onFollowMove,i)),t.menuParaFollow.on("click",_.bind(i.onFollowMove,i)),t.menuTableStartNewList.on("click",_.bind(i.onStartNumbering,i,1)),t.menuParaStartNewList.on("click",_.bind(i.onStartNumbering,i,1)),t.menuTableStartNumberingFrom.on("click",_.bind(i.onStartNumbering,i,"advanced")),t.menuParaStartNumberingFrom.on("click",_.bind(i.onStartNumbering,i,"advanced")),t.menuTableContinueNumbering.on("click",_.bind(i.onContinueNumbering,i)),t.menuParaContinueNumbering.on("click",_.bind(i.onContinueNumbering,i)),t.menuFrameAdvanced.on("click",_.bind(i.advancedFrameClick,i,!0)),t.menuDropCapAdvanced.on("click",_.bind(i.advancedFrameClick,i,!1)),t.menuStyleSave.on("click",_.bind(i.onMenuSaveStyle,i)),t.menuStyleUpdate.on("click",_.bind(i.onMenuUpdateStyle,i)),t.menuTableSelectText.menu.on("item:click",_.bind(i.tableSelectText,i)),t.menuTableInsertText.menu.on("item:click",_.bind(i.tableInsertText,i)),t.menuTableDeleteText.menu.on("item:click",_.bind(i.tableDeleteText,i)),t.menuImageAlign.menu.on("item:click",_.bind(i.onImgAlign,i)),t.menuShapesMerge.menu.on("item:click",_.bind(i.onShapesMerge,i)),t.menuImageArrange.menu.on("item:click",_.bind(i.onImgArrange,i)),t.mnuGroup.on("click",_.bind(i.onImgGroup,i)),t.mnuUnGroup.on("click",_.bind(i.onImgUnGroup,i)),t.menuWrapPolygon.on("click",_.bind(i.onImgWrapPolygon,i)),t.menuImageWrap.menu.on("item:click",_.bind(i.onImgWrap,i)),t.menuImageAdvanced.on("click",_.bind(i.onImgAdvanced,i)),t.menuOriginalSize.on("click",_.bind(i.onImgOriginalSize,i)),t.menuImgReplace.menu.on("item:click",_.bind(i.onImgReplace,i)),t.menuImgEditPoints.on("click",_.bind(i.onImgEditPoints,i)),t.mnuTableMerge.on("click",_.bind(i.onTableMerge,i)),t.mnuTableSplit.on("click",_.bind(i.onTableSplit,i)),t.menuIgnoreSpellTable.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreSpellPara.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreAllSpellTable.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreAllSpellPara.on("click",_.bind(i.onIgnoreSpell,i)),t.menuToDictionaryTable.on("click",_.bind(i.onToDictionary,i)),t.menuToDictionaryPara.on("click",_.bind(i.onToDictionary,i)),t.menuTableDistRows.on("click",_.bind(i.onTableDist,i)),t.menuTableDistCols.on("click",_.bind(i.onTableDist,i)),t.menuTableDirection.menu.on("item:click",_.bind(i.tableDirection,i)),t.menuTableRefreshField.on("click",_.bind(i.onRefreshField,i)),t.menuParaRefreshField.on("click",_.bind(i.onRefreshField,i)),t.menuTableEditField.on("click",_.bind(i.onEditField,i)),t.menuParaEditField.on("click",_.bind(i.onEditField,i)),t.menuTableFieldCodes.on("click",_.bind(i.onFieldCodes,i)),t.menuParaFieldCodes.on("click",_.bind(i.onFieldCodes,i)),t.menuParagraphBreakBefore.on("click",_.bind(i.onParagraphBreakBefore,i)),t.menuParagraphKeepLines.on("click",_.bind(i.onParagraphKeepLines,i)),t.menuParagraphVAlign.menu.on("item:click",_.bind(i.paragraphVAlign,i)),t.menuParagraphDirection.menu.on("item:click",_.bind(i.paragraphDirection,i)),t.langParaMenu.menu.on("item:click",_.bind(i.onLangMenu,i,"para")),t.langTableMenu.menu.on("item:click",_.bind(i.onLangMenu,i,"table")),t.menuTableTOC.menu.on("item:click",_.bind(i.onTOCMenu,i)),t.menuParaTOCRefresh.menu.on("item:click",_.bind(i.onTOCMenu,i)),t.menuParaTOCSettings.on("click",_.bind(i.onParaTOCSettings,i)),t.menuTableEquation.menu.on("item:click",_.bind(i.convertEquation,i)),t.menuParagraphEquation.menu.on("item:click",_.bind(i.convertEquation,i)),t.menuTableListIndents.on("click",_.bind(i.onListIndents,i)),t.menuParaListIndents.on("click",_.bind(i.onListIndents,i)),t.menuSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),i.onChangeProtectDocument()}else t.menuPDFViewCopy.on("click",_.bind(i.onCutCopyPaste,i))},t.fillMenuProps=function(t){if(t&&_.isArray(t)){for(var e=this.documentHolder,i={},n=e.textMenu,s=!0,o=0;o<t.length;o++){var a=t[o].get_ObjectType(),l=t[o].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Image==a){n=e.pictureMenu,void 0===i.imgProps&&(i.imgProps={});var r=l.get_ShapeProperties(),c=l.get_ChartProperties();if(r?r.get_FromChart()?i.imgProps.isChart=!0:r.get_FromImage()?i.imgProps.isOnlyImg=!0:(r.get_FromSmartArt()&&(i.imgProps.isSmartArt=!0),r.get_FromSmartArtInternal()&&(i.imgProps.isSmartArtInternal=!0),i.imgProps.isShape=!0):c?i.imgProps.isChart=!0:i.imgProps.isImg=!0,i.imgProps.value=l,i.imgProps.locked=!!l&&l.get_Locked(),s=!1,null==r&&null==c)break}else Asc.c_oAscTypeSelectElement.Table==a?(n=e.tableMenu,i.tableProps={},i.tableProps.value=l,i.tableProps.locked=!!l&&l.get_Locked(),s=!1):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=l,i.paraProps.locked=!!l&&l.get_Locked(),i.imgProps&&(i.imgProps.isChart||i.imgProps.isShape)&&void 0===i.tableProps&&(n=e.textMenu),s=!1):Asc.c_oAscTypeSelectElement.Hyperlink==a?(i.hyperProps?i.hyperProps.isSeveralLinks=!0:i.hyperProps={},i.hyperProps.value=l):Asc.c_oAscTypeSelectElement.Header==a?(i.headerProps={},i.headerProps.locked=!!l&&l.get_Locked()):Asc.c_oAscTypeSelectElement.SpellCheck==a?(i.spellProps={},i.spellProps.value=l,this.documentHolder._currentSpellObj=l):Asc.c_oAscTypeSelectElement.Math==a&&(i.mathProps={},i.mathProps.value=l,this.documentHolder._currentMathObj=l)}return s?null:{menu_to_show:n,menu_props:i}}},t.fillViewMenuProps=function(t){if(t&&_.isArray(t)){var e=this.documentHolder;e.viewModeMenu||e.createDelayedElementsViewer();for(var i={},n=e.viewModeMenu,s=!0,o=0;o<t.length;o++){var a=t[o].get_ObjectType(),l=t[o].get_ObjectValue();Asc.c_oAscTypeSelectElement.Image==a?(i.imgProps={},i.imgProps.value=l,s=!1):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=l,i.paraProps.locked=!!l&&l.get_Locked(),s=!1):Asc.c_oAscTypeSelectElement.Text==a&&(e.viewPDFModeMenu||e.createDelayedElementsPDFViewer(),n=e.viewPDFModeMenu,s=!1)}return s?null:{menu_to_show:n,menu_props:i}}},t.fillFormsMenuProps=function(t){if(t&&_.isArray(t)){var e=this.documentHolder;e.formsPDFMenu||e.createDelayedElementsPDFForms();for(var i={},n=e.formsPDFMenu,s=!0,o=0;o<t.length;o++){var a=t[o].get_ObjectType(),l=t[o].get_ObjectValue();if(Asc.c_oAscTypeSelectElement.Image==a){i.imgProps={},i.imgProps.value=l,i.imgProps.locked=!!l&&l.get_Locked();var r=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,c=r?r.get_Lock():Asc.c_oAscSdtLockType.Unlocked;i.imgProps.content_locked=c==Asc.c_oAscSdtLockType.SdtContentLocked||c==Asc.c_oAscSdtLockType.ContentLocked,s=!1}else Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=l,i.paraProps.locked=!!l&&l.get_Locked(),s=!1):Asc.c_oAscTypeSelectElement.Header==a?(i.headerProps={},i.headerProps.locked=!!l&&l.get_Locked()):Asc.c_oAscTypeSelectElement.ContentControl==a&&(i.controlProps={},i.controlProps.formPr=l?l.get_FormPr():null)}return s?null:{menu_to_show:n,menu_props:i}}},t.onHyperlinkClick=function(t){if(t){var e=this.api.asc_getUrlType(t);if(e===AscCommon.c_oAscUrlType.Http||e===AscCommon.c_oAscUrlType.Email)window.open(t);else{var i=this;setTimeout((function(){Common.UI.warning({msg:i.documentHolder.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(e){try{"yes"==e&&window.open(t)}catch(t){t&&console.log(t.stack)}}})}),1)}}},t.onDialogAddHyperlink=function(){var t,e,i,n=this,s=n.documentHolder._docProtection;if(n.api&&n.mode.isEdit&&!(n._isDisabled||s.isReadOnly||s.isFormsOnly||s.isCommentsOnly)&&!n.getApplication().getController("LeftMenu").leftMenu.menuFile.isVisible()){var o=function(t,s){"ok"==s&&(e=t.getSettings(),!1!==i?n.api.add_Hyperlink(e):n.api.change_Hyperlink(e)),n.editComplete()};if(!1!==(i=n.api.can_AddHyperlink()))t=new DE.Views.HyperlinkSettingsDialog({api:n.api,appOptions:n.mode,handler:o}),(e=new Asc.CHyperlinkProperty).put_Text(i),t.show(),t.setSettings(e);else{var a=n.api.getSelectedElements();a&&_.isArray(a)&&_.each(a,(function(t,i){a[i].get_ObjectType()==Asc.c_oAscTypeSelectElement.Hyperlink&&(e=a[i].get_ObjectValue())})),e&&((t=new DE.Views.HyperlinkSettingsDialog({api:n.api,appOptions:n.mode,handler:o})).show(),t.setSettings(e))}Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")}},t.onShowForeignCursorLabel=function(t,e,i,n){if(this.isUserVisible(t)){for(var s,o=this,a=0;a<o.fastcoauthtips.length;a++)if(o.fastcoauthtips[a].attr("userid")==t){s=o.fastcoauthtips[a];break}s||((s=$(document.createElement("div"))).addClass("username-tip"),s.attr("userid",t),s.css({height:o._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}),s.text(o.getUserName(t)),$("#id_main_view").append(s),o.fastcoauthtips.push(s),s.fadeIn(150)),s.css({top:i-o._TtHeight+"px",left:e+"px"})}},t.onHideForeignCursorLabel=function(t){for(var e=this,i=0;i<e.fastcoauthtips.length;i++)if(e.fastcoauthtips[i].attr("userid")==t){var n=e.fastcoauthtips[i];e.fastcoauthtips[i].fadeOut(150,(function(){n.remove()})),e.fastcoauthtips.splice(i,1);break}},t.onMouseMove=function(t){var e=this,i=e.documentHolder.cmpEl,n=e.screenTip;if(void 0===e._XY&&(e._XY=[Common.Utils.getOffset(i).left-$(window).scrollLeft(),Common.Utils.getOffset(i).top-$(window).scrollTop()],e._Height=i.height(),e._Width=i.width(),e._BodyWidth=$("body").width()),t){var s,o,a=t.get_Type();if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink||a==Asc.c_oAscMouseMoveDataTypes.Footnote||a==Asc.c_oAscMouseMoveDataTypes.Form||a==Asc.c_oAscMouseMoveDataTypes.Review&&e.mode.reviewHoverMode||a==Asc.c_oAscMouseMoveDataTypes.Eyedropper||a===Asc.c_oAscMouseMoveDataTypes.Placeholder){if(e.isTooltipHiding)return void(e.mouseMoveData=t);if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink){var l=t.get_Hyperlink();if(!l)return;(o=_.isEmpty(l.get_ToolTip())?l.get_Value():l.get_ToolTip()).length>256&&(o=o.substr(0,256)+"...")}else if(a==Asc.c_oAscMouseMoveDataTypes.Footnote)(o=t.get_FootnoteText()).length>1e3&&(o=o.substr(0,1e3)+"...");else if(a==Asc.c_oAscMouseMoveDataTypes.Form)(o=t.get_FormHelpText()).length>1e3&&(o=o.substr(0,1e3)+"...");else if(a==Asc.c_oAscMouseMoveDataTypes.Review&&t.get_ReviewChange()){var r=e.getApplication().getController("Common.Controllers.ReviewChanges").readSDKChange([t.get_ReviewChange()]);r&&r.length>0&&(r=r[0]),r&&(o="<b>"+Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(r.get("username")))+"  </b>",o+='<span class="review-date">'+r.get("date")+"</span><br>",(o+=r.get("changetext")).length>1e3&&(o=o.substr(0,1e3)+"..."))}else if(a===Asc.c_oAscMouseMoveDataTypes.Placeholder)switch(t.get_PlaceholderType()){case AscCommon.PlaceholderButtonType.Image:o=e.documentHolder.txtInsImage;break;case AscCommon.PlaceholderButtonType.ImageUrl:o=e.documentHolder.txtInsImageUrl}else if(a==Asc.c_oAscMouseMoveDataTypes.Eyedropper){if(e.eyedropperTip.isTipVisible&&(e.eyedropperTip.isTipVisible=!1,e.eyedropperTip.toolTip.hide()),!e.eyedropperTip.toolTip){var c=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>');e.documentHolder.cmpEl.append(c),e.eyedropperTip.toolTip=new Common.UI.Tooltip({owner:c,html:!0,cls:"eyedropper-tooltip"})}var d=t.get_EyedropperColor().asc_getColor(),h=d.get_r(),p=d.get_g(),m=d.get_b(),u=Common.Utils.ThemeColor.getHexColor(h,p,m);if(!e.eyedropperTip.eyedropperColor){var g=$(document.createElement("div"));g.addClass("eyedropper-color"),g.appendTo(document.body),e.eyedropperTip.eyedropperColor=g,$("#id_main_view").on("mouseleave",_.bind(e.hideEyedropper,e))}return e.eyedropperTip.eyedropperColor.css({backgroundColor:"#"+u,left:t.get_X()+e._XY[0]+23+"px",top:t.get_Y()+e._XY[1]-53+"px"}),e.eyedropperTip.isVisible=!0,e.eyedropperTip.tipInterval&&clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.tipInterval=setInterval((function(){clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.isVisible&&(o="<div>RGB ("+h+","+p+","+m+")</div><div>"+t.get_EyedropperColor().asc_getName()+"</div>",e.eyedropperTip.toolTip.setTitle(o),e.eyedropperTip.isTipVisible=!0,e.eyedropperTip.toolTip.show([-1e4,-1e4]),e.eyedropperTip.tipWidth=e.eyedropperTip.toolTip.getBSTip().$tip.width(),(s=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-57,s[0]+=e._XY[0]+58,s[0]+e.eyedropperTip.tipWidth>e._BodyWidth&&(s[0]=s[0]-e.eyedropperTip.tipWidth-40),e.eyedropperTip.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"}))}),800),void(e.eyedropperTip.isHidden=!1)}var b=!1;n.isHidden=!1,e.screenTip.toolTip||(e.screenTip.toolTip=new Common.UI.Tooltip({owner:e,html:!0,title:"<br><b>Press Ctrl and click link</b>",cls:"link-tooltip"}),e.screenTip.toolTip.on("tooltip:show",(function(){$("#id_main_view").on("mouseleave",e.wrapEvents.onMouseLeave)})),e.screenTip.toolTip.on("tooltip:hide",(function(){$("#id_main_view").off("mouseleave",e.wrapEvents.onMouseLeave)}))),a!==Asc.c_oAscMouseMoveDataTypes.Review&&a!==Asc.c_oAscMouseMoveDataTypes.Placeholder&&(o=Common.Utils.String.htmlEncode(o)),(n.tipType!==a||n.tipLength!==o.length||n.strTip.indexOf(o)<0)&&(n.toolTip.setTitle(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink?o+"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>":o),n.tipLength=o.length,n.strTip=o,n.tipType=a,b=!0),(s=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-15,s[0]+=e._XY[0]+5,n.isVisible&&!b||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),b&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),b=!1,s[0]+n.tipWidth>e._BodyWidth&&(s[0]=e._BodyWidth-n.tipWidth,b=!0),s[1]-n.tipHeight<0?s[1]=b?s[1]+30:0:s[1]-=n.tipHeight,n.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"})}else if(t.get_Type()==Asc.c_oAscMouseMoveDataTypes.LockedObject&&e.mode.isEdit&&e.isUserVisible(t.get_UserId())){var C;e.usertipcount>=e.usertips.length&&((C=$(document.createElement("div"))).addClass("username-tip"),C.css({height:e._TtHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(C),e.userTooltip&&(C.on("mouseover",e.wrapEvents.userTipMousover),C.on("mouseout",e.wrapEvents.userTipMousout)),e.usertips.push(C)),C=e.usertips[e.usertipcount],e.usertipcount++,o=e.getUserName(t.get_UserId());var v=(s=[t.get_X()+e._XY[0],t.get_Y()+e._XY[1]])[0];s[0]=e._BodyWidth-s[0],s[1]-=2==t.get_LockedObjectType()?e._TtHeight:0,s[1]>e._XY[1]&&s[1]+e._TtHeight<e._XY[1]+e._Height?(C.text(o),C.css({visibility:"visible",top:s[1]+"px",right:s[0]+"px","max-width":v+"px"})):C.css({visibility:"hidden"})}}},t.onShowSpecialPasteOptions=function(t){if(!this.mode||this.mode.isEdit){var e=this,i=e.documentHolder,n=t.asc_getCellCoord(),s=i.cmpEl.find("#special-paste-container"),o=t.asc_getOptions();if(o){if(s.length<1&&(e._arrSpecialPaste=[],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.paste]=i.textPaste,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.sourceformatting]=i.txtPasteSourceFormat,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.keepTextOnly]=i.txtKeepTextOnly,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.insertAsNestedTable]=i.textNest,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.overwriteCells]=i.txtOverwriteCells,s=$('<div id="special-paste-container" style="position: absolute;"><div id="id-document-holder-btn-special-paste"></div></div>'),i.cmpEl.find("#id_main_view").append(s),e.btnSpecialPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-special-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",caption:Common.Utils.String.format("({0})",Common.Utils.String.textCtrl),menu:new Common.UI.Menu({items:[]})}),e.initSpecialPasteEvents()),o.length>0){for(var a=e.btnSpecialPaste.menu,l=0;l<a.items.length;l++)a.removeItem(a.items[l]),l--;_.each(o,(function(t,i){var n=new Common.UI.MenuItem({caption:e._arrSpecialPaste[t]+" ("+e.hkSpecPaste[t]+")",value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(e.onSpecialPasteItemClick,e));a.addItem(n)})),a.items.length>0&&a.items[0].setChecked(!0,!0)}var r=[n.asc_getX()+n.asc_getWidth()+3,n.asc_getY()+n.asc_getHeight()+3];if(n.asc_getX()<0||n.asc_getY()<0||r[0]>e._Width||r[1]>e._Height)return s.is(":visible")&&s.hide(),void $(document).off("keyup",this.wrapEvents.onKeyUp);r[1]+s.height()>e._Height&&(r[1]=e._Height-s.height()),r[0]+s.width()>e._Width&&(r[0]=e._Width-s.width()),Common.Utils.InternalSettings.get("de-hidden-rulers")||(r=[r[0]-19,r[1]-26]),s.css({left:r[0],top:r[1]}),s.show(),setTimeout((function(){$(document).on("keyup",e.wrapEvents.onKeyUp)}),10),this.disableSpecialPaste()}}},t.onHideSpecialPasteOptions=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#special-paste-container");t.is(":visible")&&(t.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp))}},t.disableSpecialPaste=function(){var t=this.documentHolder.cmpEl.find("#special-paste-container"),e=this.documentHolder._docProtection,i=this.documentHolder._unprotectedRegion,n=this._isDisabled||e.isReadOnly&&!i.canInsObject||e.isCommentsOnly&&!i.canInsObject;t.length>0&&t.is(":visible")&&this.btnSpecialPaste.setDisabled(!!n)},t.initSpecialPasteEvents=function(){var t=this;for(var e in t.hkSpecPaste=[],t.hkSpecPaste[Asc.c_oSpecialPasteProps.paste]="P",t.hkSpecPaste[Asc.c_oSpecialPasteProps.sourceformatting]="K",t.hkSpecPaste[Asc.c_oSpecialPasteProps.keepTextOnly]="T",t.hkSpecPaste[Asc.c_oSpecialPasteProps.insertAsNestedTable]="N",t.hkSpecPaste[Asc.c_oSpecialPasteProps.overwriteCells]="O",t.hkSpecPaste)if(t.hkSpecPaste.hasOwnProperty(e)){var i={};i[t.hkSpecPaste[e]]=_.bind(t.onSpecialPasteItemClick,t,{value:parseInt(e)}),Common.util.Shortcuts.delegateShortcuts({shortcuts:i}),Common.util.Shortcuts.suspendEvents(t.hkSpecPaste[e],void 0,!0)}t.btnSpecialPaste.menu.on("show:after",(function(e){for(var i=0;i<e.items.length;i++)t.hkSpecPaste[e.items[i].value]&&Common.util.Shortcuts.resumeEvents(t.hkSpecPaste[e.items[i].value])})).on("hide:after",(function(e){for(var i=0;i<e.items.length;i++)t.hkSpecPaste[e.items[i].value]&&Common.util.Shortcuts.suspendEvents(t.hkSpecPaste[e.items[i].value],void 0,!0)}))},t.onEditObject=function(){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.api){var t=this.api.asc_canEditTableOleObject(!0);if(t){var e=DE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}else this.api.asc_startEditCurrentOleObject()}},t.onDoubleClickOnChart=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()){var e=this.documentHolder._docProtection;if(this.mode.isEdit&&!(this._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly)){var i=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");i&&t&&(i.setEditMode(!0),i.show(),i.setChartData(new Asc.asc_CChartBinary(t)))}}},t.onDoubleClickOnTableOleObject=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()){var e=this.documentHolder._docProtection;if(this.mode.isEdit&&!(this._isDisabled||e.isReadOnly||e.isFormsOnly||e.isCommentsOnly)){var i=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");i&&t&&(i.setEditMode(!0),i.show(),i.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}}},t.onImgWrapStyleChanged=function(t){var e=this.documentHolder.menuImageWrap;switch(t){case Asc.c_oAscWrapStyle2.Inline:e.menu.items[0].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Square:e.menu.items[2].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Tight:e.menu.items[3].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Through:e.menu.items[4].setChecked(!0);break;case Asc.c_oAscWrapStyle2.TopAndBottom:e.menu.items[5].setChecked(!0);break;case Asc.c_oAscWrapStyle2.Behind:e.menu.items[8].setChecked(!0);break;case Asc.c_oAscWrapStyle2.InFront:e.menu.items[7].setChecked(!0)}},t.onChangeCropState=function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},t.onRulerDblClick=function(t){Common.UI.Menu.Manager.hideAll();var e,i=this;if("tables"==t)(e=this.advancedTableClick())&&e.setActiveCategory(4);else if("indents"==t||"tabs"==t)(e=this.advancedParagraphClick({isChart:!1}))&&e.setActiveCategory("indents"==t?0:4);else if("margins"==t){if(i._state.lock_doc)return;(e=new DE.Views.PageMarginsDialog({api:i.api,handler:function(t,e){if("ok"==e){var n=t.getSettings();Common.localStorage.setItem("de-pgmargins-top",n.get_TopMargin()),Common.localStorage.setItem("de-pgmargins-left",n.get_LeftMargin()),Common.localStorage.setItem("de-pgmargins-bottom",n.get_BottomMargin()),Common.localStorage.setItem("de-pgmargins-right",n.get_RightMargin()),Common.NotificationCenter.trigger("margins:update",n),i.api.asc_SetSectionProps(n),i.editComplete()}}})).show(),e.setSettings(i.api.asc_GetSectionProps())}else"columns"==t&&((e=new DE.Views.CustomColumnsDialog({handler:function(t,e){"ok"==e&&(i.api.asc_SetColumnsProps(t.getSettings()),i.editComplete())}})).show(),e.setSettings(i.api.asc_GetColumnsProps()))},t.onHideContentControlsActions=function(){this.listControlMenu&&this.listControlMenu.isVisible()&&this.listControlMenu.hide(),this.imageControlMenu&&this.imageControlMenu.isVisible()&&this.imageControlMenu.hide();var t=this.documentHolder.cmpEl.find("#calendar-control-container");t.is(":visible")&&t.hide()},t.onShowDateActions=function(t,e,i){var n=t.pr,s=n.get_DateTimePr(),o=this.documentHolder.cmpEl,a=o.find("#calendar-control-container"),l=this;this._dateObj=n,a.length<1&&(a=$('<div id="calendar-control-container" style="position: absolute;z-index: 1000;"><div id="id-document-calendar-control" style="position: fixed; left: -1000px; top: -1000px;"></div></div>'),o.append(a)),Common.UI.Menu.Manager.hideAll(),a.css({left:e,top:i}),a.show(),this.cmpCalendar||(this.cmpCalendar=new Common.UI.Calendar({el:o.find("#id-document-calendar-control"),enableKeyEvents:!0,firstday:1}),this.cmpCalendar.on("date:click",(function(t,e){var i=l._dateObj.get_DateTimePr();i.put_FullDate(new Date(e)),l.api.asc_SetContentControlDatePickerDate(i),a.hide(),l.api.asc_UncheckContentControlButtons(),l.editComplete()})),this.cmpCalendar.on("calendar:keydown",(function(t,e){e.keyCode==Common.UI.Keys.ESC&&(a.hide(),l.api.asc_UncheckContentControlButtons())})),$(document).on("mousedown",(function(t){"canvas"!==t.target.localName&&a.is(":visible")&&0==a.find(t.target).length&&(a.hide(),l.api.asc_UncheckContentControlButtons())})));var r=s?s.get_FullDate():void 0;this.cmpCalendar.setDate(r?new Date(r):new Date);var c=Common.Utils.getOffset(a),d=Common.Utils.innerWidth(),h=Common.Utils.innerHeight()-10,p=this.cmpCalendar.cmpEl.outerWidth(),m=this.cmpCalendar.cmpEl.outerHeight(),u=c.left-p,g=c.top;g+m>h&&(g=h-m,u-=22),g<0&&(g=0),u+p>d&&(u=d-p),this.cmpCalendar.cmpEl.css({left:u,top:g}),this._preventClick=!0},t.onShowListActions=function(t,e,i){var n=t.type,s=t.pr,o=n==Asc.c_oAscContentControlSpecificType.ComboBox?s.get_ComboBoxPr():s.get_DropDownListPr(),a=s.get_FormPr(),l=this.documentHolder.cmpEl,r=this.listControlMenu,c=r?l.find(Common.Utils.String.format("#menu-container-{0}",r.id)):null,d=this;if(this._listObj=s,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),r||(this.listControlMenu=r=new Common.UI.Menu({maxHeight:207,menuAlign:"tr-bl",items:[]}),r.on("item:click",(function(t,e){setTimeout((function(){-1!==e.value&&d.api.asc_SelectContentControlListItem(e.value,d._listObj.get_InternalId())}),1)})),(!c||c.length<1)&&(c=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',r.id)),l.append(c)),r.render(c),r.cmpEl.attr({tabindex:"-1"}),r.on("hide:after",(function(){d.listControlMenu.removeAll(),d._fromShowContentControls||d.api.asc_UncheckContentControlButtons()}))),o){var h=o.get_ItemsCount();if(a&&(!a.get_Required()||h<1)){var p=s.get_PlaceholderText();r.addItem(new Common.UI.MenuItem({caption:""!==p.trim()?p:this.documentHolder.txtEmpty,value:"",template:_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="<% if (options.value=="") { %> opacity: 0.6 <% } %>">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}))}for(var m=0;m<h;m++)(""!==o.get_ItemValue(m)||!a)&&r.addItem(new Common.UI.MenuItem({caption:o.get_ItemDisplayText(m),value:o.get_ItemValue(m),template:_.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem">',"<%= Common.Utils.String.htmlEncode(caption) %>","</a>"].join(""))}));!a&&r.items.length<1&&r.addItem(new Common.UI.MenuItem({caption:this.documentHolder.txtEmpty,value:-1}))}c.css({left:e,top:i}),c.attr("data-value","prevent-canvas-click"),this._preventClick=!0,r.show(),_.delay((function(){r.cmpEl.focus()}),10),this._fromShowContentControls=!1},t.onShowContentControlsActions=function(t,e,i){var n=t.type,s=this;switch(n){case Asc.c_oAscContentControlSpecificType.DateTime:setTimeout((function(){s.onShowDateActions(t,e,i)}),1);break;case Asc.c_oAscContentControlSpecificType.Picture:if(t.pr&&t.pr.get_Lock)if((o=t.pr.get_Lock())==Asc.c_oAscSdtLockType.SdtContentLocked||o==Asc.c_oAscSdtLockType.ContentLocked)return;s.mode.canSaveToFile?setTimeout((function(){s.onShowImageActions(t,e,i)}),1):(this.api.asc_addImage(t.pr),setTimeout((function(){s.api.asc_UncheckContentControlButtons()}),500));break;case Asc.c_oAscContentControlSpecificType.Signature:var o;if(t.pr&&t.pr.get_Lock)if((o=t.pr.get_Lock())==Asc.c_oAscSdtLockType.SdtContentLocked||o==Asc.c_oAscSdtLockType.ContentLocked)return;this.api.asc_addImage(t.pr),setTimeout((function(){s.api.asc_UncheckContentControlButtons()}),500);break;case Asc.c_oAscContentControlSpecificType.DropDownList:case Asc.c_oAscContentControlSpecificType.ComboBox:setTimeout((function(){s.onShowListActions(t,e,i)}),1)}},t.onShowImageActions=function(t,e,i){var n=this.documentHolder.cmpEl,s=this.imageControlMenu,o=s?n.find(Common.Utils.String.format("#menu-container-{0}",s.id)):null,a=this;this.internalFormObj=t?t.pr:null,this._fromShowContentControls=!0,Common.UI.Menu.Manager.hideAll(),s||(this.imageControlMenu=s=new Common.UI.Menu({maxHeight:207,menuAlign:"tl-bl",items:[{caption:this.documentHolder.mniImageFromFile,value:0},{caption:this.documentHolder.mniImageFromUrl,value:1},{caption:this.documentHolder.mniImageFromStorage,value:2,visible:this.mode.canRequestInsertImage||this.mode.fileChoiceUrl&&this.mode.fileChoiceUrl.indexOf("{documentType}")>-1}]}),s.on("item:click",(function(t,e){setTimeout((function(){a.onImageSelect(t,e)}),1),setTimeout((function(){a.api.asc_UncheckContentControlButtons()}),500)})),(!o||o.length<1)&&(o=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id)),n.append(o)),s.render(o),s.cmpEl.attr({tabindex:"-1"}),s.on("hide:after",(function(){a._fromShowContentControls||a.api.asc_UncheckContentControlButtons()}))),o.css({left:e,top:i}),o.attr("data-value","prevent-canvas-click"),this._preventClick=!0,s.show(),_.delay((function(){s.cmpEl.focus()}),10),this._fromShowContentControls=!1},t.selectFormImage=function(t,e){this.internalFormObj=e,this.onImageSelect(null,t)},t.onImageSelect=function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&i.api){var n=e.replace(/ /g,"");_.isEmpty(n)||i.setImageUrl(n)}i.fireEvent("editcomplete",i)}}).show()}else if(2==e.value)Common.NotificationCenter.trigger("storage:image-load","control");else{if(this._isFromFile)return;this._isFromFile=!0,this.api.asc_addImage(this.internalFormObj),this._isFromFile=!1}},t.setImageUrl=function(t,e){this.api&&this.api.asc_SetContentControlPictureUrl(t,this.internalFormObj?this.internalFormObj.get_InternalId():null,e)},t.insertImageFromStorage=function(t){t&&t._urls&&"control"==t.c&&this.setImageUrl(t._urls[0],t.token)},t.onSpellCheckVariantsFound=function(){var t,e=this,i=e.api.getSelectedElements(!0);if(i&&_.isArray(i))for(var n=0;n<i.length;n++)if(i[n].get_ObjectType()==Asc.c_oAscTypeSelectElement.SpellCheck){t=i[n].get_ObjectValue(),e.documentHolder._currentSpellObj=t;break}t&&!1===t.get_Checked()&&null!==t.get_Variants()&&void 0!==t.get_Variants()&&(e.documentHolder.addWordVariants(),e.documentHolder.textMenu&&e.documentHolder.textMenu.isVisible()&&e.documentHolder.textMenu.alignPosition())},t.equationCallback=function(t){t&&this.api.asc_SetMathProps(t),this.editComplete()},t.addHyperlink=function(t,e,i){var n,s=this;s.api&&((n=new DE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:function(t,e){"ok"==e&&s.api.add_Hyperlink(t.getSettings()),s.editComplete()}})).show(),n.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink"))},t.editHyperlink=function(t,e,i){var n,s=this;s.api&&((n=new DE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:function(t,e){"ok"==e&&s.api.change_Hyperlink(n.getSettings()),s.editComplete()}})).show(),n.setSettings(t.hyperProps.value))},t.onRemoveHyperlink=function(t,e){this.api&&this.api.remove_Hyperlink(t.hyperProps.value),this.editComplete()},t.editChartClick=function(){if(Common.Controllers.LaunchController.isScriptLoaded()){var t=DE.getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");if(t){t.setEditMode(!0),t.show();var e=this.api.asc_getChartObject();e&&t.setChartData(new Asc.asc_CChartBinary(e))}}},t.advancedParagraphClick=function(t,e,i){var n,s=this;if(s.api){var o=s.api.getSelectedElements();if(o&&_.isArray(o))for(var a=o.length-1;a>=0;a--){var l,r;if(l=o[a].get_ObjectType(),r=o[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Paragraph==l){n=new DE.Views.ParagraphSettingsAdvanced({tableStylerRows:2,tableStylerColumns:1,paragraphProps:r,borderProps:s.borderAdvancedProps,isChart:!0===t.isChart,isSmartArtInternal:!0===t.isSmartArtInternal,api:s.api,handler:function(t,e){"ok"==t&&s.api&&(s.borderAdvancedProps=e.borderProps,s.api.paraApply(e.paragraphProps)),s.editComplete()}});break}}}if(n)return n.show(),n},t.advancedFrameClick=function(t,e,i,n){Common.NotificationCenter.trigger("dropcap:settings",t)},t.advancedTableClick=function(t,e,i){var n,s=this;if(s.api){var o=s.api.getSelectedElements();if(o&&_.isArray(o))for(var a=o.length-1;a>=0;a--){var l,r;if(l=o[a].get_ObjectType(),r=o[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Table==l){n=new DE.Views.TableSettingsAdvanced({tableStylerRows:null===r.get_CellBorders().get_InsideH()&&1==r.get_CellSelect()?1:2,tableStylerColumns:null===r.get_CellBorders().get_InsideV()&&1==r.get_CellSelect()?1:2,tableProps:r,borderProps:s.borderAdvancedProps,sectionProps:s.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&s.api&&(s.borderAdvancedProps=e.borderProps,s.api.tblApply(e.tableProps)),s.editComplete()}});break}}}if(n)return n.show(),n},t.onMenuSaveStyle=function(t,e,i){this.api&&Common.NotificationCenter.trigger("style:commitsave",this.api.asc_GetStyleFromFormatting())},t.onMenuUpdateStyle=function(t,e,i){this.api&&Common.NotificationCenter.trigger("style:commitchange",this.api.asc_GetStyleFromFormatting())},t.onCutCopyPaste=function(t,e){var i=this;i.api&&(("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste())||Common.localStorage.getBool("de-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("de-hide-copywarning",1),i.editComplete()}}).show());i.editComplete()},t.onUndo=function(){this.api&&this.api.Undo()},t.onRedo=function(){this.api&&this.api.Redo()},t.onClear=function(){if(this.api){var t=this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null;t&&this.api.asc_ClearContentControl(t.get_InternalId())}},t.onAcceptRejectChange=function(t,e){this.api&&("accept"==t.value?this.api.asc_AcceptChangesBySelection(!1):"reject"==t.value&&this.api.asc_RejectChangesBySelection(!1)),this.editComplete()},t.onPrintSelection=function(t){if(this.api){var e=new Asc.asc_CAdjustPrint;e.asc_setPrintType(Asc.c_oAscPrintType.Selection);var i=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86);i.asc_setAdvancedOptions(e),this.api.asc_Print(i),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Print Selection")}},t.onControlsSelect=function(t,e){var i=this,n=this.api.asc_GetContentControlProperties();n&&("settings"==t.value?new DE.Views.ControlSettingsDialog({props:n,api:i.api,handler:function(t,e){"ok"==t&&i.api.asc_SetContentControlProperties(e,n.get_InternalId()),i.editComplete()}}).show():"remove"==t.value&&(n.get_FormPr()?this.api.asc_RemoveContentControl(n.get_InternalId()):this.api.asc_RemoveContentControlWrapper(n.get_InternalId()))),i.editComplete()},t.onInsertCaption=function(){this.documentHolder.fireEvent("links:caption")},t.onContinueNumbering=function(t,e){this.api.asc_ContinueNumbering(),this.editComplete()},t.onStartNumbering=function(t,e,i){if(1==t)this.api.asc_RestartNumbering(e.value.start);else{var n=this;new DE.Views.NumberingValueDialog({title:n.documentHolder.textNumberingValue,props:e.value,handler:function(t,e){"ok"==t&&n.api.asc_RestartNumbering(e),n.editComplete()}}).show()}this.editComplete()},t.onCellsRemove=function(){var t=this;new Common.Views.OptionsDialog({title:t.documentHolder.textTitleCellsRemove,items:[{caption:this.documentHolder.textLeft,value:"left"},{caption:this.documentHolder.textRow,value:"row"},{caption:this.documentHolder.textCol,value:"col"}],handler:function(e,i){if("ok"==i){var n=e.getSettings();"row"==n?t.api.remRow():"col"==n?t.api.remColumn():t.api.asc_RemoveTableCells()}t.editComplete()}}).show(),this.editComplete()},t.onCellsAdd=function(){var t=this;new DE.Views.CellsAddDialog({handler:function(e,i){"ok"==e&&(i.row?i.before?t.api.addRowAbove(i.count):t.api.addRowBelow(i.count):i.before?t.api.addColumnLeft(i.count):t.api.addColumnRight(i.count)),t.editComplete()}}).show(),this.editComplete()},t.onSignatureClick=function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:var i=this.documentHolder._docProtection;Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled||i.isReadOnly||i.isFormsOnly||i.isCommentsOnly,e);break;case 3:var n=this;Common.UI.warning({title:this.documentHolder.notcriticalErrorTitle,msg:this.documentHolder.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&n.api.asc_RemoveSignature(e)}})}},t.onImgRotate=function(t){var e=new Asc.asc_CImgProperty;e.asc_putRotAdd(3.14159265358979*(1==t.value?90:270)/180),this.api.ImgApply(e),this.editComplete()},t.onImgFlip=function(t){var e=new Asc.asc_CImgProperty;1==t.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ImgApply(e),this.editComplete()},t.onImgCrop=function(t,e){1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop(),this.editComplete()},t.onImgResetCrop=function(){if(this.api){var t=new Asc.asc_CImgProperty;t.put_ResetCrop(!0)}this.api.ImgApply(t),this.editComplete()},t.onFollowMove=function(t){this.api&&this.api.asc_FollowRevisionMove(t.value),this.editComplete()},t.tableCellsVAlign=function(t,e,i){if(this.api){var n=new Asc.CTableProp;n.put_CellsVAlign(e.options.valign),this.api.tblApply(n)}},t.tableSelectText=function(t,e,i){if(this.api)switch(e.value){case 0:this.api.selectRow();break;case 1:this.api.selectColumn();break;case 2:this.api.selectCell();break;case 3:this.api.selectTable()}},t.tableInsertText=function(t,e,i){if(this.api)switch(e.value){case 0:this.api.addColumnLeft();break;case 1:this.api.addColumnRight();break;case 2:this.api.addRowAbove();break;case 3:this.api.addRowBelow();break;case 4:this.onCellsAdd()}},t.tableDeleteText=function(t,e,i){if(this.api)switch(e.value){case 0:this.api.remRow();break;case 1:this.api.remColumn();break;case 2:this.api.remTable();break;case 3:this.onCellsRemove()}},t.onImgAlign=function(t,e,i){var n=this;if(n.api){var s=Common.Utils.InternalSettings.get("de-img-align-to"),o=1==s?Asc.c_oAscObjectsAlignType.Page:n.api.asc_getSelectedDrawingObjectsCount()<2&&!s||2==s?Asc.c_oAscObjectsAlignType.Margin:Asc.c_oAscObjectsAlignType.Selected;e.value<6?(n.api.put_ShapesAlign(e.value,o),Common.component.Analytics.trackEvent("DocumentHolder","Shape Align")):6==e.value?(n.api.DistributeHorizontally(o),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Horizontally")):7==e.value&&(n.api.DistributeVertically(o),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Vertically"))}n.editComplete()},t.onShapesMerge=function(t,e,i){e&&e.value&&(this.api.asc_mergeSelectedShapes(e.value),Common.component.Analytics.trackEvent("DocumentHolder","Shapes Merge")),this.editComplete()},t.onImgArrange=function(t,e,i){var n=this;if(n.api&&void 0!==e.options.valign){var s=new Asc.asc_CImgProperty;s.put_ChangeLevel(e.options.valign),n.api.ImgApply(s)}n.editComplete()},t.onImgGroup=function(t){var e=this;if(e.api){var i=new Asc.asc_CImgProperty;i.put_Group(1),e.api.ImgApply(i)}e.editComplete()},t.onImgUnGroup=function(t){var e=this;if(e.api){var i=new Asc.asc_CImgProperty;i.put_Group(-1),e.api.ImgApply(i)}e.editComplete()},t.onImgWrapPolygon=function(t){this.api&&this.api.StartChangeWrapPolygon(),this.editComplete()},t.onImgWrap=function(t,e,i){var n=this;if(n.api&&void 0!==e.options.wrapType){var s=new Asc.asc_CImgProperty;if(s.put_WrappingStyle(e.options.wrapType),n.documentHolder.menuImageWrap._originalProps.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline&&e.wrapType!==Asc.c_oAscWrapStyle2.Inline){s.put_PositionH(new Asc.CImagePositionH),s.get_PositionH().put_UseAlign(!1),s.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column);var o=n.documentHolder.menuImageWrap._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column);s.get_PositionH().put_Value(o),s.put_PositionV(new Asc.CImagePositionV),s.get_PositionV().put_UseAlign(!1),s.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),o=n.documentHolder.menuImageWrap._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),s.get_PositionV().put_Value(o)}n.api.ImgApply(s)}n.editComplete()},t.onImgAdvanced=function(t,e){var i,n,s=this;if(s.api){var o=s.api.getSelectedElements();if(o&&_.isArray(o))for(var a=o.length-1;a>=0;a--)if(i=o[a].get_ObjectType(),n=o[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==i){var l;n.get_ChartProperties()||n.get_ShapeProperties()||s.documentHolder.menuOriginalSize.isDisabled()||!s.documentHolder.menuOriginalSize.isVisible()||(l=s.api.asc_getCropOriginalImageSize())&&(l={width:l.get_ImageWidth(),height:l.get_ImageHeight()});var r=new DE.Views.ImageSettingsAdvanced({imageProps:n,sizeOriginal:l,api:s.api,sectionProps:s.api.asc_GetSectionProps(),handler:function(t,e){"ok"==t&&s.api&&s.api.ImgApply(e.imageProps),s.editComplete()}});r.show(),r.btnOriginalSize.setVisible(s.documentHolder.menuOriginalSize.isVisible());break}}},t.onImgOriginalSize=function(t,e){var i=this;if(i.api){var n=i.api.asc_getCropOriginalImageSize(),s=new Asc.asc_CImgProperty;s.put_Width(n.get_ImageWidth()),s.put_Height(n.get_ImageHeight()),s.put_Rot(0),i.api.ImgApply(s),i.editComplete()}},t.onImgReplace=function(t,e,i){var n=this;1==e.value?new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&n.api){var i=e.replace(/ /g,"");if(!_.isEmpty(i)){var s=new Asc.asc_CImgProperty;s.put_ImageUrl(i),n.api.ImgApply(s)}}n.editComplete()}}).show():2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):setTimeout((function(){n.api&&n.api.ChangeImageFromFile(),n.editComplete()}),10)},t.onImgEditPoints=function(t){this.api&&this.api.asc_editPointsGeometry()},t.onTableMerge=function(t){this.api&&this.api.MergeCells()},t.onTableSplit=function(t){var e=this;e.api&&new Common.Views.InsertTableDialog({split:!0,handler:function(t,i){"ok"==t&&(e.api&&e.api.SplitCell(i.columns,i.rows),Common.component.Analytics.trackEvent("DocumentHolder","Table")),e.editComplete()}}).show()},t.onIgnoreSpell=function(t,e){this.api&&this.api.asc_ignoreMisspelledWord(this.documentHolder._currentSpellObj,!!t.value),this.editComplete()},t.onToDictionary=function(t,e){this.api&&this.api.asc_spellCheckAddToDictionary(this.documentHolder._currentSpellObj),this.editComplete()},t.onTableDist=function(t,e){this.api&&this.api.asc_DistributeTableCells(!!t.value),this.editComplete()},t.tableDirection=function(t,e,i){if(this.api){var n=new Asc.CTableProp;n.put_CellsTextDirection(e.options.direction),this.api.tblApply(n)}},t.onRefreshField=function(t,e){this.api&&this.api.asc_UpdateFields(!0),this.editComplete()},t.onEditField=function(t,e){this.documentHolder.fireEvent("field:edit",["edit"])},t.onFieldCodes=function(t,e){this.api&&this.api.asc_ToggleComplexFieldCodes(),this.editComplete()},t.onParagraphBreakBefore=function(t,e){this.api&&this.api.put_PageBreak(t.checked)},t.onParagraphKeepLines=function(t,e){this.api&&this.api.put_KeepLines(t.checked)},t.paragraphVAlign=function(t,e,i){if(this.api){var n=new Asc.asc_CImgProperty;n.put_VerticalTextAlign(e.options.valign),this.api.ImgApply(n)}},t.paragraphDirection=function(t,e,i){if(this.api){var n=new Asc.asc_CImgProperty;n.put_Vert(e.options.direction),this.api.ImgApply(n)}},t.onLangMenu=function(t,e,i){var n=this;n.api&&(_.isUndefined(i.langid)||n.api.put_TextPrLang(i.langid),"para"===t?n.documentHolder._currLang.paraid=i.langid:n.documentHolder._currLang.tableid=i.langid,n.editComplete())},t.onTOCMenu=function(t,e,i){this.documentHolder.fireEvent("settings"===e.value?"links:contents":"links:update",[e.value,!0])},t.onParaTOCSettings=function(t,e){this.documentHolder.fireEvent("links:contents",[t.value,!0])},t.onSpecialPasteItemClick=function(t,e){if(this.api){this.api.asc_SpecialPaste(t.value);var i=this.btnSpecialPaste.menu;if(!t.cmpEl)for(var n=0;n<i.items.length;n++)i.items[n].setChecked(i.items[n].value===t.value,!0);setTimeout((function(){i.hide()}),100)}return!1},t.onShowMathTrack=function(t){if(!this.mode||this.mode.isEdit)if(this.lastMathTrackBounds=t,Common.Controllers.LaunchController.isScriptLoaded())if(t[3]<0||Common.Utils.InternalSettings.get("de-equation-toolbar-hide"))this.onHideMathTrack();else{var e=this,i=e.documentHolder,n=i.cmpEl.find("#equation-container");if(n.length<1){var s=e.getApplication().getCollection("EquationGroups"),o='<div id="equation-container" style="position: absolute;">';e.getApplication().getController("Toolbar").onMathTypes(),e.equationBtns=[];for(var a=0;a<s.length;++a)o+='<span id="id-document-holder-btn-equation-'+a+'"></span>';o+='<div class="separator"></div>',o+='<span id="id-document-holder-btn-equation-settings"></span>',o+="</div>",n=$(o),i.cmpEl.find("#id_main_view").append(n);var l=function(t){var i=t.options.value,n=s.at(i);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+i,t.cmpEl),parentMenu:t,store:n.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",(function(t,i,n,s){e.api&&n&&e.api.asc_AddMath(n.get("data").equationType)})),t.off("show:before",l)},r=function(t){n.addClass("has-open-menu")},c=function(t){n.removeClass("has-open-menu")};for(a=0;a<s.length;++a){var d=s.at(a),h=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+a,i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({value:a,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+a+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});h.menu.on("show:before",l),h.menu.on("show:before",r),h.menu.on("hide:after",c),e.equationBtns.push(h)}e.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:e.documentHolder.advancedEquationText,menu:e.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),e.equationSettingsBtn.menu.options.initMenu=function(){var t=e.api.asc_GetMathInputType(),i=e.equationSettingsBtn.menu,n=e.api.asc_IsInlineMath(),s=Common.Utils.InternalSettings.get("de-equation-toolbar-hide");i.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),i.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),i.items[8].options.isEquationInline=n,i.items[8].setCaption(n?e.documentHolder.eqToDisplayText:e.documentHolder.eqToInlineText,!0),i.items[9].options.isToolbarHide=s,i.items[9].setCaption(s?e.documentHolder.showEqToolbar:e.documentHolder.hideEqToolbar,!0)},e.equationSettingsBtn.menu.on("item:click",_.bind(e.convertEquation,e)),e.equationSettingsBtn.menu.on("show:before",(function(t){r(),t.options.initMenu()})),e.equationSettingsBtn.menu.on("hide:after",c)}var p=[(t[0]+t[2])/2-n.outerWidth()/2,t[1]-n.outerHeight()-10];Common.Utils.InternalSettings.get("de-hidden-rulers")||(p=[p[0]-19,p[1]-26]),p[0]<0&&(p[0]=0),p[1]<0&&(p[1]=t[3]+10,!Common.Utils.InternalSettings.get("de-hidden-rulers")&&(p[1]-=26)),p[1]=Math.min(e._Height-n.outerHeight(),Math.max(0,p[1])),n.css({left:p[0],top:p[1]}),void 0===e._XY&&(e._XY=[Common.Utils.getOffset(i.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(i.cmpEl).top-$(window).scrollTop()],e._Height=i.cmpEl.height(),e._Width=i.cmpEl.width(),e._BodyWidth=$("body").width());var m=e._Height-p[1]-n.outerHeight(),u=e._XY[1]+(Common.Utils.InternalSettings.get("de-hidden-rulers")?0:26)+p[1],g=m<220&&m<.9*u?"bl-tl":"tl-bl";Common.UI.isRTL()&&(g="bl-tl"===g?"br-tr":"tr-br"),e.equationBtns.forEach((function(t){t&&(t.menu.menuAlign=g)})),e.equationSettingsBtn.menu.menuAlign=g,n.is(":visible")?e.equationSettingsBtn.menu.isVisible()&&(e.equationSettingsBtn.menu.options.initMenu(),e.equationSettingsBtn.menu.alignPosition()):n.show(),e.disableEquationBar()}else this.showMathTrackOnLoad=!0},t.onHideMathTrack=function(){if(this.documentHolder&&this.documentHolder.cmpEl)if(Common.Controllers.LaunchController.isScriptLoaded()){var t=this.documentHolder.cmpEl.find("#equation-container");t.is(":visible")&&t.hide()}else this.showMathTrackOnLoad=!1},t.disableEquationBar=function(){var t=this.documentHolder.cmpEl.find("#equation-container"),e=this.documentHolder._docProtection,i=this.documentHolder._unprotectedRegion,n=this._isDisabled||this._state.equationLocked||e.isReadOnly&&!i.canInsObject||e.isFormsOnly||e.isCommentsOnly&&!i.canInsObject;t.length>0&&t.is(":visible")&&(this.equationBtns.forEach((function(t){t&&t.setDisabled(!!n)})),this.equationSettingsBtn.setDisabled(!!n))},t.convertEquation=function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("de-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"mode"==e.options.type?(e.options.isEquationInline=!e.options.isEquationInline,this.api.asc_ConvertMathDisplayMode(e.options.isEquationInline)):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("de-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("de-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},t.onListIndents=function(t,e){if(!this.api||this.api.asc_IsShowListIndentsSettings()){var i=this;i.api&&new DE.Views.ListIndentsDialog({api:i.api,props:t.value.props,isBullet:t.value.format===Asc.c_oAscNumberingFormat.Bullet,handler:function(e,n){"ok"==e&&i.api&&i.api.asc_ChangeNumberingLvl(t.value.listId,n,t.value.level),i.editComplete()}}).show()}else this.documentHolder.fireEvent("list:settings",[2])},t.saveAsPicture=function(){this.api&&this.api.asc_SaveDrawingAsPicture()},t.onInsertImage=function(t,e,i){!this.documentHolder||this.documentHolder._docProtection.isReadOnly||this.documentHolder._docProtection.isFormsOnly||this.documentHolder._docProtection.isCommentsOnly||(this.api&&this.api.asc_addImage(t),this.editComplete())},t.onInsertImageUrl=function(t,e,i){if(this.documentHolder&&!this.documentHolder._docProtection.isReadOnly&&!this.documentHolder._docProtection.isFormsOnly&&!this.documentHolder._docProtection.isCommentsOnly){var n=this;new Common.Views.ImageFromUrlDialog({handler:function(e,i){if("ok"==e&&n.api){var s=i.replace(/ /g,"");_.isEmpty(s)||n.api.AddImageUrl([s],void 0,void 0,t)}n.editComplete()}}).show()}},t.onPluginContextMenu=function(t){t&&t.length>0&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)}}})),define("documenteditor/main/app/view/FileMenuPanels",[],(function(){"use strict";!DE.Views.FileMenuPanels&&(DE.Views.FileMenuPanels={}),DE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX},{name:"DOCM",imgCls:"docm",type:Asc.c_oAscFileType.DOCM},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.DOCM || fileType=="docm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?this.mode&&this.mode.isPDFForm||(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:""}),this.formats[1].splice(2,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:""}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:""},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"DE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0])},textDownloadAs:"Download as"}),DE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"DOCX",imgCls:"docx",type:Asc.c_oAscFileType.DOCX,ext:".docx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"ODT",imgCls:"odt",type:Asc.c_oAscFileType.ODT,ext:".odt"}],[{name:"DOTX",imgCls:"dotx",type:Asc.c_oAscFileType.DOTX,ext:".dotx"},{name:"DOCM",imgCls:"docm",type:Asc.c_oAscFileType.DOCM,ext:".docm"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"},{name:"OTT",imgCls:"ott",type:Asc.c_oAscFileType.OTT,ext:".ott"}],[{name:"RTF",imgCls:"rtf",type:Asc.c_oAscFileType.RTF,ext:".rtf"},{name:"TXT",imgCls:"txt",type:Asc.c_oAscFileType.TXT,ext:".txt"},{name:"FB2",imgCls:"fb2",type:Asc.c_oAscFileType.FB2,ext:".fb2"},{name:"EPUB",imgCls:"epub",type:Asc.c_oAscFileType.EPUB,ext:".epub"},{name:"HTML (Zipped)",imgCls:"html",type:Asc.c_oAscFileType.HTML,ext:".html"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.DOCM || fileType=="docm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,this.mode=t.mode,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){/^pdf$/.test(this.fileType)?this.mode&&this.mode.isPDFForm||(this.formats[0].splice(1,1,{name:"PDF",imgCls:"pdf",type:"",ext:!0}),this.formats[1].splice(2,1)):/^xps|oxps$/.test(this.fileType)?this.formats[0].push({name:this.fileType.toUpperCase(),imgCls:this.fileType,type:"",ext:!0}):/^djvu$/.test(this.fileType)&&(this.formats=[[{name:"DJVU",imgCls:"djvu",type:"",ext:!0},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}]]),this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"docx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"DE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("saveas:format",[this.menu,e.value?parseInt(e.value):void 0,i.value])},textSaveCopyAs:"Save Copy as"}),DE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="editsave">','<td colspan="2" class="group-name top"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan="2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-paste-settings"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-smart-selection"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-compatible"></span></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="collaboration">','<td colspan="2" class="group-name"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2" class="subgroup-name"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;" role="radiogroup" aria-owns="fms-rb-coauth-mode-strict"><div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span></div>',"</td>","</tr>",'<tr class="coauth changes-mode">','<td colspan="2"><div style="display: flex;"><div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</tr>",'<tr class ="divider-subgroup coauth changes-mode"></tr>','<tr class="view-review">','<td colspan="2" class="subgroup-name"><label><%= scope.txtShowTrackChanges %></label></td>',"</tr>",'<tr class="view-review">','<td colspan="2" role="radiogroup" aria-owns="fms-rb-show-track-tooltips"><div id="fms-rb-show-track-ballons"></div></td>',"</tr>",'<tr class="view-review">','<td colspan="2"><div id="fms-rb-show-track-tooltips"></div></td>',"</tr>",'<tr class ="divider-subgroup  view-review"></tr>','<tr class="coauth changes-show">','<td colspan="2" class="subgroup-name"><label><%= scope.strShowChanges %></label></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2" role="radiogroup" aria-owns="fms-rb-show-changes-all"><div id="fms-rb-show-changes-none"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-all"></div></td>',"</tr>",'<tr class="coauth changes-show">','<td colspan="2"><div id="fms-rb-show-changes-last"></div></td>',"</tr>",'<tr class="divider coauth changes-show"></tr>','<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class="divider live-viewer"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>','<tr class ="edit">','<td colspan="2" class="group-name proofing"><label><%= scope.txtProofing %></label></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><div id="fms-chb-spell-check"></div></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-uppercase-words"></span></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-numbers-words"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-auto-correct" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtAutoCorrect %></button></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>',"<tr>",'<td class="group-name" colspan="2"><label><%= scope.strDocContent %></label></td>',"</tr>",'<tr class="">',"<td><label><%= scope.strNumeral %></label></td>",'<td><div id="fms-cmb-numeral"></div></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="appearance">','<td colspan="2" class="group-name"><label><%= scope.txtAppearance %></label></td>',"</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>","<td>",'<div><div id="fms-cmb-theme"></div>','<div id="fms-chb-dark-mode"></div></div></td>',"</tr>",'<tr class="tab-style">',"<td><label><%= scope.strTabStyle %></label></td>",'<td><div id="fms-cmb-tab-style"></div></td>',"</tr>",'<tr class="tab-background">','<td colspan="2"><div id="fms-chb-tab-background"></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-scrn-reader"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-align-guides"></span></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="edit quick-access">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-customize-quick-access" style="width:auto;display:inline-block;padding-right:10px;padding-left:10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomizeQuickAccess %></button></div></td>',"</tr>",'<tr class="edit">',"<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class="macros">',"<td><label><%= scope.strMacrosSettings %></label></td>","<td>",'<div><div id="fms-cmb-macros"></div>',"</tr>","<tr>","<td><label><%= scope.strFontSizeType %></label></td>",'<td><span id="fms-cmb-font-size-type"></span></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chTabBack=new Common.UI.CheckBox({el:i.findById("#fms-chb-tab-background"),labelText:this.txtTabBack,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chScreenReader=new Common.UI.CheckBox({el:i.findById("#fms-chb-scrn-reader"),labelText:this.txtScreenReader,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chLiveComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,s){e.chResolvedComment.setDisabled("checked"!==t.getValue())})),this.chResolvedComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chSpell=new Common.UI.CheckBox({el:i.findById("#fms-chb-spell-check"),labelText:this.txtSpellCheck,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,s){e.chIgnoreUppercase.setDisabled("checked"!==t.getValue()),e.chIgnoreNumbers.setDisabled("checked"!==t.getValue())})),this.chIgnoreUppercase=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-uppercase-words"),labelText:this.strIgnoreWordsInUPPERCASE,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chIgnoreNumbers=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-numbers-words"),labelText:this.strIgnoreWordsWithNumbers,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chCompatible=new Common.UI.CheckBox({el:i.findById("#fms-chb-compatible"),labelText:this.textOldVersions,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chSmartSelection=new Common.UI.CheckBox({el:i.findById("#fms-chb-smart-selection"),labelText:this.textSmartSelection,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,s){"checked"!==t.getValue()&&e.rbCoAuthModeFast.getValue()&&(e.rbCoAuthModeStrict.setValue(!0),e.onChangeCoAuthMode(e.rbCoAuthModeFast.getValue()?1:0))})),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAlignGuides=new Common.UI.CheckBox({el:i.findById("#fms-chb-align-guides"),labelText:this.textAlignGuides,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitPage},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strFast+" "+this.txtFastTip}),this.rbCoAuthModeFast.on("change",(function(t,i,n){i&&(e.chAutosave.setValue(1),e.onChangeCoAuthMode(1))})),this.rbCoAuthModeFast.$el.parent().on("click",(function(){e.rbCoAuthModeFast.setValue(!0)})),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strStrict+" "+this.txtStrictTip}),this.rbCoAuthModeStrict.on("change",(function(t,i,n){i&&e.onChangeCoAuthMode(0)})),this.rbCoAuthModeStrict.$el.parent().on("click",(function(){e.rbCoAuthModeStrict.setValue(!0)})),this.rbChangesBallons=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-track-ballons"),name:"show-track-changes",labelText:this.txtChangesBalloons,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbChangesTip=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-track-tooltips"),name:"show-track-changes",labelText:this.txtChangesTip,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesNone=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-none"),name:"show-changes",labelText:this.txtNone,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesAll=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-all"),name:"show-changes",labelText:this.txtAll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbShowChangesLast=new Common.UI.RadioBox({el:i.findById("#fms-rb-show-changes-last"),name:"show-changes",labelText:this.txtLast,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chLiveViewer=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"});var n=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));return this.cmbFontRender=new Common.UI.ComboBox({el:i.find("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:n,data:[{value:0,displayValue:this.txtWin},{value:1,displayValue:this.txtMac},{value:2,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.cmbUnit=new Common.UI.ComboBox({el:i.findById("#fms-cmb-unit"),style:"width: 160px;",restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",editable:!1,cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbMacros=new Common.UI.ComboBox({el:i.findById("#fms-cmb-macros"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:2,displayValue:this.txtStopMacros,descValue:this.txtStopMacrosDesc},{value:0,displayValue:this.txtWarnMacros,descValue:this.txtWarnMacrosDesc},{value:1,displayValue:this.txtRunMacros,descValue:this.txtRunMacrosDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontSizeType=new Common.UI.ComboBox({el:i.find("#fms-cmb-font-size-type"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:!1,displayValue:this.strChinese},{value:!0,displayValue:this.strWestern}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPaste=new Common.UI.CheckBox({el:i.findById("#fms-chb-paste-settings"),labelText:this.strPasteButton,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnAutoCorrect=new Common.UI.Button({el:i.findById("#fms-btn-auto-correct")}),this.btnAutoCorrect.on("click",_.bind(this.autoCorrect,this)),this.btnCustomizeQuickAccess=new Common.UI.Button({el:i.findById("#fms-btn-customize-quick-access")}),this.btnCustomizeQuickAccess.on("click",_.bind(this.customizeQuickAccess,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme(i.value))})),this.chDarkMode=new Common.UI.CheckBox({el:i.findById("#fms-chb-dark-mode"),labelText:this.txtDarkMode,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.cmbTabStyle=new Common.UI.ComboBox({el:i.findById("#fms-cmb-tab-style"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",data:[{value:"fill",displayValue:this.textFill},{value:"line",displayValue:this.textLine}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbNumeral=new Common.UI.ComboBox({el:i.findById("#fms-cmb-numeral"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%;",data:[{value:Asc.c_oNumeralType.arabic,displayValue:this.txtArabic},{value:Asc.c_oNumeralType.hindi,displayValue:this.txtHindi}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()),this.cmbZoom.options.menuAlignEl=t?this.pnlSettings:null,this.cmbUnit.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFontRender.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTheme.options.menuAlignEl=t?this.pnlSettings:null,this.cmbMacros.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTabStyle.options.menuAlignEl=t?this.pnlSettings:null,this.cmbNumeral.options.menuAlignEl=t?this.pnlSettings:null}},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("de-settings-coauthmode");$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[!t.isEdit||!t.canChangeCoAuthoring&&e?"hide":"show"](),$("tr.forcesave",this.el)[t.canForcesave?"show":"hide"](),$("tr.editsave",this.el)[t.isEdit||t.canForcesave?"show":"hide"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.collaboration",this.el)[t.canCoAuthoring||t.canViewReview?"show":"hide"](),$("tr.coauth",this.el)[t.isEdit&&t.canCoAuthoring?"show":"hide"](),$("tr.coauth.changes-mode",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.coauth.changes-show",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.view-review",this.el)[t.canViewReview?"show":"hide"](),$("tr.spellcheck",this.el)[t.isEdit&&Common.UI.FeaturesManager.canChange("spellcheck")?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.compactHeader&&t.isEdit?"hide":"show"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.tab-background",this.el)[!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)?"show":"hide"](),$("tr.tab-style",this.el)[Common.Utils.isIE||Common.Controllers.Desktop.isWinXp()||!Common.UI.FeaturesManager.canChange("tabStyle",!0)?"hide":"show"](),$("tr.appearance",this.el)[Common.Utils.isIE?"hide":"show"](),t.compactHeader&&$("tr.quick-access",this.el).hide(),void 0===Common.Utils.InternalSettings.get("de-settings-western-font-size")&&this.cmbFontSizeType.cmpEl&&this.cmbFontSizeType.cmpEl.closest("tr").hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("de-settings-show-alt-hints")),this.chScreenReader.setValue(Common.Utils.InternalSettings.get("app-settings-screen-reader"));var t=Common.Utils.InternalSettings.get("de-settings-zoom");t=null!==t?parseInt(t):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100;var e=this.cmbZoom.store.findWhere({value:t});this.cmbZoom.setValue(e?parseInt(e.get("value")):t>0?t+"%":100),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("de-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("de-settings-resolvedcomment"));var i=Common.Utils.InternalSettings.get("de-settings-coauthmode");this.rbCoAuthModeFast.setValue(i),this.rbCoAuthModeStrict.setValue(!i),this.fillShowChanges(i),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("de-settings-coauthmode")),t=Common.Utils.InternalSettings.get(i?"de-settings-showchanges-fast":"de-settings-showchanges-strict"),this.rbShowChangesNone.setValue("none"==t),this.rbShowChangesLast.setValue("last"==t),this.rbShowChangesAll.setValue("all"==t),t=Common.Utils.InternalSettings.get("de-settings-fontrender"),e=this.cmbFontRender.store.findWhere({value:parseInt(t)}),this.cmbFontRender.setValue(e?e.get("value"):0),this._fontRender=this.cmbFontRender.getValue(),t=Common.Utils.InternalSettings.get("de-settings-cachemode"),(e=this.cmbFontRender.store.findWhere({value:"custom"}))&&t&&e.set("checked",!!t),e&&t&&this.cmbFontRender.cmpEl.find("#"+e.get("id")+" a").addClass("checked"),t=Common.Utils.InternalSettings.get("de-settings-unit"),e=this.cmbUnit.store.findWhere({value:t}),this.cmbUnit.setValue(e?parseInt(e.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),t=Common.Utils.InternalSettings.get("de-settings-autosave"),this.chAutosave.setValue(1==t),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("de-settings-forcesave")),Common.UI.FeaturesManager.canChange("spellcheck")&&(this.chSpell.setValue(Common.Utils.InternalSettings.get("de-settings-spellcheck")),this.chIgnoreUppercase.setValue(Common.Utils.InternalSettings.get("de-spellcheck-ignore-uppercase-words")),this.chIgnoreNumbers.setValue(Common.Utils.InternalSettings.get("de-spellcheck-ignore-numbers-words"))),this.chAlignGuides.setValue(Common.Utils.InternalSettings.get("de-settings-showsnaplines")),this.chCompatible.setValue(Common.Utils.InternalSettings.get("de-settings-compatible")),e=this.cmbMacros.store.findWhere({value:Common.Utils.InternalSettings.get("de-macros-mode")}),this.cmbMacros.setValue(e?e.get("value"):0),this.chPaste.setValue(Common.Utils.InternalSettings.get("de-settings-paste-button")),this.chSmartSelection.setValue(Common.Utils.InternalSettings.get("de-settings-smart-selection"));var n=[];for(var s in Common.UI.Themes.map())n.push({value:s,displayValue:Common.UI.Themes.get(s).text,themeType:Common.UI.Themes.get(s).type});n.length&&(this.cmbTheme.setData(n),e=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(e?e.get("value"):Common.UI.Themes.defaultThemeId())),this.chDarkMode.setValue(Common.UI.Themes.isContentThemeDark()),this.chDarkMode.setDisabled(!Common.UI.Themes.isDarkTheme()),this.mode.canViewReview&&(t=Common.Utils.InternalSettings.get("de-settings-review-hover-mode"),this.rbChangesTip.setValue(t),this.rbChangesBallons.setValue(!t)),this.chTabBack.setValue("toolbar"===Common.Utils.InternalSettings.get("settings-tab-background")),t=Common.Utils.InternalSettings.get("settings-tab-style"),e=this.cmbTabStyle.store.findWhere({value:t}),this.cmbTabStyle.setValue(e?e.get("value"):"fill"),void 0!==Common.Utils.InternalSettings.get("de-settings-western-font-size")&&this.cmbFontSizeType.setValue(Common.Utils.InternalSettings.get("de-settings-western-font-size")),t=Common.Utils.InternalSettings.get("de-settings-numeral"),e=this.cmbNumeral.store.findWhere({value:t}),this.cmbNumeral.setValue(e?e.get("value"):Asc.c_oNumeralType.arabic)},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),this.chDarkMode.isDisabled()||this.chDarkMode.isChecked()===Common.UI.Themes.isContentThemeDark()||Common.UI.Themes.toggleContentTheme(),Common.localStorage.setItem("de-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-show-alt-hints",Common.localStorage.getBool("de-settings-show-alt-hints")),Common.localStorage.setItem("de-settings-zoom",this.cmbZoom.getValue()),Common.localStorage.setItem("app-settings-screen-reader",this.chScreenReader.isChecked()?1:0),Common.localStorage.setItem("de-settings-livecomment",this.chLiveComment.isChecked()?1:0),Common.localStorage.setItem("de-settings-resolvedcomment",this.chResolvedComment.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring?(this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("de-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0),Common.localStorage.setItem(this.rbCoAuthModeFast.getValue()?"de-settings-showchanges-fast":"de-settings-showchanges-strict",this.rbShowChangesNone.getValue()?"none":this.rbShowChangesLast.getValue()?"last":"all")):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("de-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("de-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});if(Common.localStorage.setItem("de-settings-cachemode",t&&!t.get("checked")?0:1),Common.localStorage.setItem("de-settings-unit",this.cmbUnit.getValue()),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("de-settings-coauthmode")||Common.localStorage.setItem("de-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("de-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit&&(Common.localStorage.setItem("de-settings-spellcheck",this.chSpell.isChecked()?1:0),Common.localStorage.setBool("de-spellcheck-ignore-uppercase-words",this.chIgnoreUppercase.isChecked()),Common.localStorage.setBool("de-spellcheck-ignore-numbers-words",this.chIgnoreNumbers.isChecked())),Common.localStorage.setItem("de-settings-compatible",this.chCompatible.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-compatible",this.chCompatible.isChecked()?1:0),Common.Utils.InternalSettings.set("de-settings-showsnaplines",this.chAlignGuides.isChecked()),Common.localStorage.setItem("de-macros-mode",this.cmbMacros.getValue()),Common.Utils.InternalSettings.set("de-macros-mode",this.cmbMacros.getValue()),this.mode.canViewReview){var e=this.rbChangesTip.getValue();Common.localStorage.setBool("de-settings-review-hover-mode",e),Common.Utils.InternalSettings.set("de-settings-review-hover-mode",e),this.mode.reviewHoverMode=e}if(Common.localStorage.setItem("de-settings-paste-button",this.chPaste.isChecked()?1:0),Common.localStorage.setItem("de-settings-smart-selection",this.chSmartSelection.isChecked()?1:0),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)&&Common.UI.TabStyler.setBackground(this.chTabBack.isChecked()?"toolbar":"header"),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabStyle",!0)&&Common.UI.TabStyler.setStyle(this.cmbTabStyle.getValue()),void 0!==Common.Utils.InternalSettings.get("de-settings-western-font-size")){e=this.cmbFontSizeType.getValue();Common.localStorage.setBool("de-settings-western-font-size",e),Common.Utils.InternalSettings.set("de-settings-western-font-size",e)}Common.localStorage.setItem("de-settings-numeral",this.cmbNumeral.getValue()),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this))},fillShowChanges:function(t){t?this.rbShowChangesLast.$el.parent().hide():this.rbShowChangesLast.$el.parent().show()},onChangeCoAuthMode:function(t){this.fillShowChanges(1==t),this.rbShowChangesNone.setValue(1==t),this.rbShowChangesLast.setValue(0==t)},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},autoCorrect:function(){this.dlgAutoCorrect&&this.dlgAutoCorrect.isVisible()||(this.dlgAutoCorrect=new Common.Views.AutoCorrectDialog({api:this.api}),this.dlgAutoCorrect.show())},customizeQuickAccess:function(){this.dlgQuickAccess&&this.dlgQuickAccess.isVisible()||(this.dlgQuickAccess=new Common.Views.CustomizeQuickAccessDialog({showSave:this.mode.showSaveButton&&Common.UI.LayoutManager.isElementVisible("header-save"),showPrint:this.mode.canPrint&&this.mode.twoLevelHeader,showQuickPrint:this.mode.canQuickPrint&&this.mode.twoLevelHeader,mode:this.mode,props:{save:Common.localStorage.getBool("de-quick-access-save",!0),print:Common.localStorage.getBool("de-quick-access-print",!0),quickPrint:Common.localStorage.getBool("de-quick-access-quick-print",!0),undo:Common.localStorage.getBool("de-quick-access-undo",!0),redo:Common.localStorage.getBool("de-quick-access-redo",!0)}}),this.dlgQuickAccess.show())},strZoom:"Default Zoom Value",strShowChanges:"Real-time Collaboration Changes",txtAll:"View All",txtNone:"View Nothing",txtLast:"View Last",okButtonText:"Apply",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",strUnit:"Unit of Measurement",txtCm:"Centimeter",txtPt:"Point",textAutoSave:"Autosave",txtSpellCheck:"Spell Checking",textAlignGuides:"Alignment Guides",strCoAuthMode:"Co-editing mode",strFast:"Fast",strStrict:"Strict",textAutoRecover:"Autorecover",txtInch:"Inch",txtFitPage:"Fit to Page",txtFitWidth:"Fit to Width",textForceSave:"Save to Server",textOldVersions:"Make the files compatible with older MS Word versions when saved as DOCX, DOTX",txtCacheMode:"Default cache mode",strMacrosSettings:"Macros Settings",txtWarnMacros:"Show Notification",txtRunMacros:"Enable All",txtStopMacros:"Disable All",txtWarnMacrosDesc:"Disable all macros with notification",txtRunMacrosDesc:"Enable all macros without notification",txtStopMacrosDesc:"Disable all macros without notification",strPasteButton:"Show Paste Options button when content is pasted",txtProofing:"Proofing",strTheme:"Theme",txtAutoCorrect:"AutoCorrect options...",txtChangesTip:"Show by hover in tooltips",txtChangesBalloons:"Show by click in balloons",txtDarkMode:"Turn on document dark mode",txtEditingSaving:"Editing and saving",txtCollaboration:"Collaboration",txtShowTrackChanges:"Show track changes",txtWorkspace:"Workspace",txtHieroglyphs:"Hieroglyphs",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use Option key to navigate the user interface using the keyboard",strShowComments:"Show comments in text",strShowResolvedComments:"Show resolved comments",txtFastTip:"Real-time co-editing. All changes are saved automatically",txtStrictTip:"Use the 'Save' button to sync the changes you and others make",strIgnoreWordsInUPPERCASE:"Ignore words in UPPERCASE",strIgnoreWordsWithNumbers:"Ignore words with numbers",strShowOthersChanges:"Show changes from other users",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtLastUsed:"Last used",textSmartSelection:"Use smart paragraph selection",txtScreenReader:"Turn on screen reader support",txtCustomizeQuickAccess:"Customize quick access",txtTabBack:"Use toolbar color as tabs background",strTabStyle:"Tab style",textFill:"Fill",textLine:"Line",txtAppearance:"Appearance"},DE.Views.FileMenuPanels.Settings||{})),DE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="blank-document-btn">','<div class="btn-blank-format"><div class ="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="14, 22">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank document",txtCreateNew:"Create New"},DE.Views.FileMenuPanels.CreateNew||{})),DE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<table class="main">','<tbody><td class="header">'+this.txtDocumentInfo+"</td></tbody>","<tbody>","<tr>",'<td class="title"><label>'+this.txtCommon+"</label></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>","<tr></tr>","<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><label id="id-lbl-info-title"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><label id="id-lbl-info-subject"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><label id="id-lbl-info-author"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfProducer+"</label></td>",'<td class="right"><label id="id-info-pdf-produce"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfVer+"</label></td>",'<td class="right"><label id="id-info-pdf-ver"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPdfTagged+"</label></td>",'<td class="right"><label id="id-info-pdf-tagged"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtFastWV+"</label></td>",'<td class="right"><label id="id-info-fast-wv"></label></td>',"</tr>","</tbody>","<tbody>","<tr>",'<td class="title"><label>'+this.txtStatistics+"</label></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtPages+"</label></td>",'<td class="right"><label id="id-info-pages"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtParagraphs+"</label></td>",'<td class="right"><label id="id-info-paragraphs"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtWords+"</label></td>",'<td class="right"><label id="id-info-words"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSymbols+"</label></td>",'<td class="right"><label id="id-info-symbols"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSpaces+"</label></td>",'<td class="right"><label id="id-info-spaces"></label></td>',"</tr>",'<tr class="pdf-info">','<td class="left"><label>'+this.txtPageSize+"</label></td>",'<td class="right"><label id="id-info-page-size"></label></td>',"</tr>","</tbody>",'<tbody class="properties-tab">',"<tr>",'<td class="title"><label>'+this.txtProperties+"</label></td>","</tr>",'<tr class="docx-info author-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>",'<tr class="docx-info">','<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>","</tbody>","<tbody>","<tr>",'<td class="left"></td>','<td class="right">','<button id="fminfo-btn-add-property" class="btn" data-hint="2" data-hint-direction="bottom" data-hint-offset="big">',"<span>"+this.txtAddProperty+"</span>","</button>","</td>","</tr>","</tbody>","</table>"].join("")),this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.menu=t.menu,this.coreProps=null,this.authors=[],this._state={_locked:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1},disableEditing:!1}},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded"),this.lblStatPages=i.findById("#id-info-pages"),this.lblStatWords=i.findById("#id-info-words"),this.lblStatParagraphs=i.findById("#id-info-paragraphs"),this.lblStatSymbols=i.findById("#id-info-symbols"),this.lblStatSpaces=i.findById("#id-info-spaces"),this.lblPageSize=i.findById("#id-info-pages-size");var n=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),n=t.getValue();i!==n&&(t.setValue(n),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.txtTitle}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putTitle(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.txtTags}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putKeywords(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.txtSubject}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putSubject(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.txtComment}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putDescription(i),e.api.asc_setCoreProps(e.coreProps)})),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}"></div><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var n=i.find(t.target);if(n.hasClass("close")&&!n.hasClass("disabled")){var s=n.closest("tr"),o=e.tblAuthor.find("tr").index(s);s.remove(),e.authors.splice(o,1),e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.txtAuthor}).on("changed:after",(function(t,i,n,s){if(i!=n){var o=i.trim();if(o&&o!==n.trim()){var a=s&&s.relatedTarget&&"fminfo-btn-apply"==s.relatedTarget.id;o.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!a)){var n=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(n),e.updateScroller()}})),!a&&e.inputAuthor.setValue("")}e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps)}})).on("keydown:before",n),this.lblPageSize=i.findById("#id-info-page-size"),this.lblPdfTitle=i.findById("#id-lbl-info-title"),this.lblPdfSubject=i.findById("#id-lbl-info-subject"),this.lblPdfAuthor=i.findById("#id-lbl-info-author"),this.lblPdfVer=i.findById("#id-info-pdf-ver"),this.lblPdfTagged=i.findById("#id-info-pdf-tagged"),this.lblPdfProducer=i.findById("#id-info-pdf-produce"),this.lblFastWV=i.findById("#id-info-fast-wv"),this.btnAddProperty=new Common.UI.Button({el:i.findById("#fminfo-btn-add-property")}),this.btnAddProperty.on("click",_.bind(this.onAddPropertyClick,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateStatisticInfo(),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.stopUpdatingStatisticInfo()},updateScroller:function(t){this.scroller&&this.scroller.update(t?{}:void 0)},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(s=t.info.owner)&&this.lblOwner.text(s),e=this._ShowHideInfoItem(this.lblOwner,!!s)||e,(s=t.info.uploaded)&&this.lblUploaded.text(s),e=this._ShowHideInfoItem(this.lblUploaded,!!s)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getPdfProps():null,n=this.api?this.api.asc_getAppProps():null;if(n?($(".pdf-info",this.el).hide(),n=(n.asc_getApplication()||"")+(n.asc_getAppVersion()?" ":"")+(n.asc_getAppVersion()||""),this.lblApplication.text(n)):i&&($(".docx-info",this.el).hide(),n=i&&i.Creator||"",this.lblApplication.text(n)),this._ShowHideInfoItem(this.lblApplication,!!n),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){var s=this.coreProps.asc_getCreated();this.lblDate.text(this.dateToString(s)),this._ShowHideInfoItem(this.lblDate,!!s)}else i&&this.updatePdfInfo(i)}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=i,i){var n=!1;t=i.asc_getModified(),this.lblModifyDate.text(this.dateToString(t)),n=this._ShowHideInfoItem(this.lblModifyDate,!!t)||n,(t=i.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),n=this._ShowHideInfoItem(this.lblModifyBy,!!t)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),t=i.asc_getTitle(),this.inputTitle.setValue(t||""),t=i.asc_getKeywords(),this.inputTags.setValue(t||""),t=i.asc_getSubject(),this.inputSubject.setValue(t||""),t=i.asc_getDescription(),this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i.asc_getCreator())&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),this._ShowHideInfoItem(this.tblAuthor,this.mode.isEdit||!!this.authors.length)}this.renderCustomProperties(),this.SetDisabled()}},updatePdfInfo:function(t){if(this.rendered){var e;if(t){(e=t.CreationDate)&&(e=new Date(e)),this.lblDate.text(this.dateToString(e)),this._ShowHideInfoItem(this.lblDate,!!e);var i=!1;if((e=t.ModDate)&&(e=new Date(e)),this.lblModifyDate.text(this.dateToString(e)),i=this._ShowHideInfoItem(this.lblModifyDate,!!e)||i,i=this._ShowHideInfoItem(this.lblModifyBy,!1)||i,$("tr.divider.modify",this.el)[i?"show":"hide"](),t.PageWidth&&t.PageHeight&&"number"==typeof t.PageWidth&&"number"==typeof t.PageHeight){var n=t.PageWidth,s=t.PageHeight;switch(Common.Utils.Metric.getCurrentMetric()){case Common.Utils.Metric.c_MetricUnits.cm:n=parseFloat((25.4*n/72e3).toFixed(2)),s=parseFloat((25.4*s/72e3).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.pt:n=parseFloat((n/100).toFixed(2)),s=parseFloat((s/100).toFixed(2));break;case Common.Utils.Metric.c_MetricUnits.inch:n=parseFloat((n/7200).toFixed(2)),s=parseFloat((s/7200).toFixed(2))}this.lblPageSize.text(n+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+s+" "+Common.Utils.Metric.getCurrentMetricName()),this._ShowHideInfoItem(this.lblPageSize,!0)}else this._ShowHideInfoItem(this.lblPageSize,!1);(e=t.Title)&&this.lblPdfTitle.text(e),i=this._ShowHideInfoItem(this.lblPdfTitle,!!e),(e=t.Subject)&&this.lblPdfSubject.text(e),i=this._ShowHideInfoItem(this.lblPdfSubject,!!e)||i,$("tr.divider.pdf-title",this.el)[i?"show":"hide"](),(e=t.Author)&&this.lblPdfAuthor.text(e),this._ShowHideInfoItem(this.lblPdfAuthor,!!e),(e=t.Version)&&this.lblPdfVer.text(e),this._ShowHideInfoItem(this.lblPdfVer,!!e),void 0!==(e=t.Tagged)&&this.lblPdfTagged.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblPdfTagged,void 0!==e),(e=t.Producer)&&this.lblPdfProducer.text(e),this._ShowHideInfoItem(this.lblPdfProducer,!!e),void 0!==(e=t.FastWebView)&&this.lblFastWV.text(!0===e?this.txtYes:this.txtNo),this._ShowHideInfoItem(this.lblFastWV,void 0!==e)}}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},updateStatisticInfo:function(){this.api&&this.doc&&this.api.startGetDocInfo()},stopUpdatingStatisticInfo:function(){this.api&&this.api.stopGetDocInfo()},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onGetDocInfoStart",_.bind(this._onGetDocInfoStart,this)),this.api.asc_registerCallback("asc_onGetDocInfoStop",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onDocInfo",_.bind(this._onDocInfo,this)),this.api.asc_registerCallback("asc_onGetDocInfoEnd",_.bind(this._onGetDocInfoEnd,this)),this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),Common.NotificationCenter.on("protect:doclock",_.bind(this.onChangeProtectDocument,this)),this.onChangeProtectDocument(),this.updateInfo(this.doc),this},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.btnAddProperty.setVisible(t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),this.inputTitle._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputTags._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputSubject._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputComment._input.attr("placeholder",t.isEdit?this.txtAddText:""),this.inputAuthor._input.attr("placeholder",t.isEdit?this.txtAddAuthor:""),this.SetDisabled(),this},setPreviewMode:function(t){this._state.disableEditing=t},_onGetDocInfoStart:function(){var t=this;this.infoObj={PageCount:0,WordsCount:0,ParagraphCount:0,SymbolsCount:0,SymbolsWSCount:0},this.timerLoading=setTimeout((function(){t.lblStatPages.text(t.txtLoading),t.lblStatWords.text(t.txtLoading),t.lblStatParagraphs.text(t.txtLoading),t.lblStatSymbols.text(t.txtLoading),t.lblStatSpaces.text(t.txtLoading)}),2e3)},_onDocInfo:function(t){if(t&&(clearTimeout(this.timerLoading),t.get_PageCount()>-1&&(this.infoObj.PageCount=t.get_PageCount()),t.get_WordsCount()>-1&&(this.infoObj.WordsCount=t.get_WordsCount()),t.get_ParagraphCount()>-1&&(this.infoObj.ParagraphCount=t.get_ParagraphCount()),t.get_SymbolsCount()>-1&&(this.infoObj.SymbolsCount=t.get_SymbolsCount()),t.get_SymbolsWSCount()>-1&&(this.infoObj.SymbolsWSCount=t.get_SymbolsWSCount()),!this.timerDocInfo)){var e=this;this.timerDocInfo=setInterval((function(){e.fillDocInfo()}),300),this.fillDocInfo()}},_onGetDocInfoEnd:function(){clearTimeout(this.timerLoading),clearInterval(this.timerDocInfo),this.timerLoading=this.timerDocInfo=void 0,this.fillDocInfo()},tplCustomProperty:function(t,e,i){return e===AscCommon.c_oVariantTypes.vtBool?i=i?this.txtYes:this.txtNo:e===AscCommon.c_oVariantTypes.vtFiletime&&(i=this.dateToString(new Date(i),!0)),'<tr data-custom-property><td class="left"><label>'+Common.Utils.String.htmlEncode(t)+'</label></td><td class="right"><div class="custom-property-wrapper"><input type="text" spellcheck="false" class="form-control" readonly style="width: 200px;" value="'+i+'"><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></div></td></tr>'},dateToString:function(t,e){var i="";if(t){var n=(this.mode.lang||"en").replace("_","-").toLowerCase();try{n=="ar-SA".toLowerCase()&&(n+="-u-nu-latn-ca-gregory"),i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}catch(s){n="en",i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}}return i},renderCustomProperties:function(){if(this.api){$("tr[data-custom-property]").remove();var t=this.api.asc_getAllCustomProperties();_.each(t,_.bind((function(e,i){var n=this,s=e.asc_getName(),o=e.asc_getType(),a=e.asc_getValue(),l=$(this.tplCustomProperty(s,o,a));$("tbody.properties-tab").append(l),l.on("click",(function(e){if(!l.find("div.disabled").length){var r=l.find(e.target);r.hasClass("close")?(n.api.asc_removeCustomProperty(i),n.renderCustomProperties()):r.hasClass("form-control")&&new Common.Views.DocumentPropertyDialog({title:n.txtDocumentPropertyUpdateTitle,lang:n.mode.lang,defaultValue:{name:s,type:o,value:a},nameValidator:function(e){return e===s||!_.some(t,(function(t){return t.asc_getName()===e}))||n.txtPropertyTitleConflictError},handler:function(t,e,s,o){"ok"===t&&(n.api.asc_modifyCustomProperty(i,e,s,o),n.renderCustomProperties())}}).show()}}))}),this))}},setDisabledCustomProperties:function(t){_.each($("tr[data-custom-property]"),(function(e){$(e).find("div.custom-property-wrapper")[t?"addClass":"removeClass"]("disabled"),$(e).find("div.close")[t?"hide":"show"]()}))},fillDocInfo:function(){this.lblStatPages.text(this.infoObj.PageCount),this.lblStatWords.text(this.infoObj.WordsCount),this.lblStatParagraphs.text(this.infoObj.ParagraphCount),this.lblStatSymbols.text(this.infoObj.SymbolsCount),this.lblStatSpaces.text(this.infoObj.SymbolsWSCount)},onDocumentName:function(t){},onLockCore:function(t){this._state._locked=t,this.updateFileInfo()},onChangeProtectDocument:function(t){if(!t){var e=DE.getController("DocProtection");t=e?e.getDocProps():null}t&&(this._state.docProtection=t)},SetDisabled:function(){var t=this._state.docProtection.isReadOnly||this._state.docProtection.isFormsOnly||this._state.docProtection.isCommentsOnly,e=!this.mode.isEdit||this._state._locked||t||this._state.disableEditing;this.inputTitle.setDisabled(e),this.inputTags.setDisabled(e),this.inputSubject.setDisabled(e),this.inputComment.setDisabled(e),this.inputAuthor.setDisabled(e),this.tblAuthor.find(".close").toggleClass("disabled",this._state._locked),this.tblAuthor.toggleClass("disabled",e),this.btnAddProperty.setDisabled(e),this.setDisabledCustomProperties(e)},onAddPropertyClick:function(){var t=this;new Common.Views.DocumentPropertyDialog({lang:t.mode.lang,nameValidator:function(e){var i=t.api.asc_getAllCustomProperties();return!_.some(i,(function(t){return t.asc_getName()===e}))||t.txtPropertyTitleConflictError},handler:function(e,i,n,s){"ok"===e&&(t.api.asc_addCustomProperty(i,n,s),t.renderCustomProperties())}}).show()},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtPages:"Pages",txtWords:"Words",txtParagraphs:"Paragraphs",txtSymbols:"Symbols",txtSpaces:"Symbols with spaces",txtLoading:"Loading...",txtAppName:"Application",txtEditTime:"Total Editing time",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtPageSize:"Page Size",txtPdfVer:"PDF Version",txtPdfTagged:"Tagged PDF",txtFastWV:"Fast Web View",txtYes:"Yes",txtNo:"No",txtPdfProducer:"PDF Producer",txtCommon:"Common",txtStatistics:"Statistics",txtProperties:"Properties",txtDocumentInfo:"Document Info",txtDocumentPropertyUpdateTitle:"Document Property",txtPropertyTitleConflictError:"Property with this title already exists",txtAddProperty:"Add property"},DE.Views.FileMenuPanels.DocumentInfo||{})),DE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary auto margin-right-10">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl  <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.elementById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},DE.Views.FileMenuPanels.DocumentRights||{})),DE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Document Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/LayoutTab.htm",name:"Layout tab"},{src:"ProgramInterface/ReviewTab.htm",name:"Review tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/ChangeColorScheme.htm",name:"Change color scheme",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteUndoRedo.htm",name:"Copy/paste text passages, undo/redo your actions"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new document or open an existing one"},{src:"UsageInstructions/SetPageParameters.htm",name:"Set page parameters",headername:"Page formatting"},{src:"UsageInstructions/NonprintingCharacters.htm",name:"Show/hide nonprinting characters"},{src:"UsageInstructions/SectionBreaks.htm",name:"Insert section breaks"},{src:"UsageInstructions/InsertHeadersFooters.htm",name:"Insert headers and footers"},{src:"UsageInstructions/InsertPageNumbers.htm",name:"Insert page numbers"},{src:"UsageInstructions/InsertFootnotes.htm",name:"Insert footnotes"},{src:"UsageInstructions/AlignText.htm",name:"Align your text in a paragraph",headername:"Paragraph formatting"},{src:"UsageInstructions/BackgroundColor.htm",name:"Select background color for a paragraph"},{src:"UsageInstructions/ParagraphIndents.htm",name:"Change paragraph indents"},{src:"UsageInstructions/LineSpacing.htm",name:"Set paragraph line spacing"},{src:"UsageInstructions/PageBreaks.htm",name:"Insert page breaks"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders"},{src:"UsageInstructions/SetTabStops.htm",name:"Set tab stops"},{src:"UsageInstructions/CreateLists.htm",name:"Create lists"},{src:"UsageInstructions/FormattingPresets.htm",name:"Apply formatting styles",headername:"Text formatting"},{src:"UsageInstructions/FontTypeSizeColor.htm",name:"Set font type, size, and color"},{src:"UsageInstructions/DecorationStyles.htm",name:"Apply font decoration styles"},{src:"UsageInstructions/CopyClearFormatting.htm",name:"Copy/clear text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/InsertDropCap.htm",name:"Insert a drop cap"},{src:"UsageInstructions/InsertTables.htm",name:"Insert tables",headername:"Operations on objects"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert autoshapes"},{src:"UsageInstructions/InsertCharts.htm",name:"Insert charts"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/AlignArrangeObjects.htm",name:"Align and arrange objects on a page"},{src:"UsageInstructions/ChangeWrappingStyle.htm",name:"Change wrapping style"},{src:"UsageInstructions/UseMailMerge.htm",name:"Use mail merge",headername:"Mail Merge"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative document editing",headername:"Document co-editing"},{src:"HelpfulHints/Review.htm",name:"Document Review"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View document information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/download/print your document"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Document Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace function"},{src:"HelpfulHints/SpellChecking.htm",name:"Spell-checking"},{src:"HelpfulHints/About.htm",name:"About Document Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic documents"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,n){t.onSelectItem(n.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var n={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(n)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(n)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(n),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}}),DE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectDocument %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasRequested && !hasSigned) { %>hidden<% } %>">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</tr>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=DE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var t=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e&&t.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide(),DE.getController("RightMenu").rightmenu.SetActivePane(Common.Utils.documentSettingsType.Signature,!0)},updateSignatures:function(){var t=this.api.asc_getRequestSignatures(),e=this.api.asc_getSignatures(),i=t&&t.length>0,n=!1,s=!1;_.each(e,(function(t,e){0==t.asc_getValid()?n=!0:s=!0}));var o=s?this.txtSignedInvalid:n?this.txtSigned:"";i&&(o=this.txtRequestedSignatures+(""!=o?"<br><br>":"")+o),this.cntSignatureView.html(this.templateSignature({tipText:o,hasSigned:n||s,hasRequested:i}));var a=this.btnAddInvisibleSign.$el.find("button").hasClass("hidden");this.cntAddSignature.toggleClass("hidden",a),this.cntAddedSignature.toggleClass("hidden",!a)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)},strProtect:"Protect Document",strSignature:"With Signature",txtView:"View signatures",txtEdit:"Edit document",txtSigned:"Valid signatures has been added to the document. The document is protected from editing.",txtSignedInvalid:"Some of the digital signatures in document are invalid or could not be verified. The document is protected from editing.",txtRequestedSignatures:"This document needs to be signed.",notcriticalErrorTitle:"Warning",txtEditWarning:"Editing will remove the signatures from the document.<br>Are you sure you want to continue?",strEncrypt:"With Password",txtProtectDocument:"Encrypt this document with a password",txtEncrypted:"A password is required to open this document",txtAddSignature:"Ensure the integrity of the document by adding an<br>invisible digital signature",txtAddedSignature:"Valid signatures have been added to the document.<br>The document is protected from editing."},DE.Views.FileMenuPanels.ProtectDoc||{})),DE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrinter %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-printer" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table style="width: 100%;"><tbody>','<tr><td class="padding-large"><%= scope.txtPages %>:</td><td class="padding-large" style="width: 100%;"><div id="print-txt-pages" class="padding-left-5" style="width: 100%;"></div></td></tr>','<tr><td><%= scope.txtCopies %>:</td><td style="width: 100%;"><div id="print-txt-copies" class="padding-left-5" style="width: 60px;"></div></td></tr>',"</tbody></table>","</td></tr>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 150px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr class="header-settings"><td class="padding-large"><label class="link" id="print-btn-system-dialog" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtPrintUsingSystemDialog %></label></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print" class="btn normal dlg-btn primary margin-right-8" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-print-pdf" class="btn normal dlg-btn" result="pdf" style="min-width: 96px;width: auto;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintPdf %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>","</div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._defaultPaperSizeList=[{value:0,displayValue:["US Letter","21,59","27,94","cm"],caption:"US Letter",size:[215.9,279.4]},{value:1,displayValue:["US Legal","21,59","35,56","cm"],caption:"US Legal",size:[215.9,355.6]},{value:2,displayValue:["A4","21","29,7","cm"],caption:"A4",size:[210,297]},{value:3,displayValue:["A5","14,8","21","cm"],caption:"A5",size:[148,210]},{value:4,displayValue:["B5","17,6","25","cm"],caption:"B5",size:[176,250]},{value:5,displayValue:["Envelope #10","10,48","24,13","cm"],caption:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:["Envelope DL","11","22","cm"],caption:"Envelope DL",size:[110,220]},{value:7,displayValue:["Tabloid","27,94","43,18","cm"],caption:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:["A3","29,7","42","cm"],caption:"A3",size:[297,420]},{value:9,displayValue:["Tabloid Oversize","29,69","45,72","cm"],caption:"Tabloid Oversize",size:[296.9,457.2]},{value:10,displayValue:["ROC 16K","19,68","27,3","cm"],caption:"ROC 16K",size:[196.8,273]},{value:11,displayValue:["Envelope Choukei 3","12","23,5","cm"],caption:"Envelope Choukei 3",size:[120,235]},{value:12,displayValue:["Super B/A3","30,5","48,7","cm"],caption:"Super B/A3",size:[305,487]},{value:13,displayValue:["A4","84,1","118,9","cm"],caption:"A0",size:[841,1189]},{value:14,displayValue:["A4","59,4","84,1","cm"],caption:"A1",size:[594,841]},{value:16,displayValue:["A4","42","59,4","cm"],caption:"A2",size:[420,594]},{value:17,displayValue:["A4","10,5","14,8","cm"],caption:"A6",size:[105,148]}],this._initSettings=!0,this._originalPageSize=void 0},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));this.cmbPrinter=new Common.UI.ComboBox({el:i.findById("#print-combo-printer"),menuStyle:"width: 248px; max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",placeHolder:this.txtPrinterNotSelected,itemsTemplate:_.template(["<% if (items.length > 0) { %>","<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","<% } else { %>",'<li><a style="background:none; cursor: default;" onclick="event.stopPropagation();">'+this.txtPrintersNotFound+"</a></li>","<% } %>"].join("")),data:[],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPrinter.on("selected",_.bind(this.onPrinterSelected,this)),this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"all",displayValue:this.txtAllPages},{value:"current",displayValue:this.txtCurrentPage},{value:-1,displayValue:this.txtCustomPages}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.setValue("all"),this.inputPages=new Common.UI.InputField({el:i.findById("#print-txt-pages"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one");var n=Common.UI.isRTL()?_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" dir="ltr">','<% if (typeof item.displayValue === "string") { %>',"<%= item.displayValue %>","<% } else { %>",'(<span dir="rtl"><%= item.displayValue[2] %> <%= item.displayValue[3] %></span>',"<span> x </span>",'<span dir="rtl"><%= item.displayValue[1] %> <%= item.displayValue[3] %></span>)',"<span> <%= item.displayValue[0] %></span>","<% } %>","</a></li>","<% }); %>"].join("")):_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">','<% if (typeof item.displayValue === "string") { %>',"<%= item.displayValue %>","<% } else { %>","<%= item.displayValue[0] %>"," (<%= item.displayValue[1] %> <%= item.displayValue[3] %> x"," <%= item.displayValue[2] %> <%= item.displayValue[3] %>)","<% } %>","</a></li>","<% }); %>"].join("")),s=_.template(['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; width: 248px; <%= style %>"',Common.UI.isRTL()?'dir="rtl"':"","></div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(n).concat(["</ul>","</div>"]).join(""));return this.cmbPaperSize=new Common.UI.ComboBoxCustom({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; width: 248px;",editable:!1,takeFocusOnClose:!0,template:s,itemsTemplate:n,data:[].concat(this._defaultPaperSizeList,[{value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]}]),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t,e){var i=$(this.el).find(".form-control");if(t||e){var n=e||t.get("displayValue");"string"==typeof n?i[0].innerHTML=n:Common.UI.isRTL()?i[0].innerHTML='<span dir="ltr">(<span dir="rtl">'+n[2]+" "+n[3]+'</span><span> x </span><span dir="rtl">'+n[1]+" "+n[3]+"</span>)<span> "+n[0]+"</span></span>":i[0].innerHTML=n[0]+" ("+n[1]+" "+n[3]+" x "+n[2]+" "+n[3]+")"}else i[0].innerHTML=""}}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:/^(ca|us)$/i.test(Common.Utils.InternalSettings.get("de-config-region"))?[25.4,25.4,25.4,25.4]:[20,30,20,15]},{value:2,displayValue:this.textMarginsNarrow,size:[12.7,12.7,12.7,12.7]},{value:3,displayValue:this.textMarginsModerate,size:[25.4,19.1,25.4,19.1]},{value:4,displayValue:this.textMarginsWide,size:[25.4,50.8,25.4,50.8]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div class="margin-right-20" style="display: inline-block;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrintSystemDialog=i.findById("#print-btn-system-dialog"),this.btnPrint=new Common.UI.Button({el:i.findById("#print-btn-print"),disabled:!0}),this.btnPrintPdf=new Common.UI.Button({el:i.findById("#print-btn-print-pdf")}),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.$el=$(t).html(i),this.$previewBox=$("#print-preview-box"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateCmbPrinter:function(t,e){var i;e=e||[],t&&!_.some(e,(function(e){return e.name==t}))&&e.push({name:t,duplex_supported:!0,paperSupported:this._defaultPaperSizeList}),i=e.map((function(t){return{value:t.name,displayValue:t.name,paperSupported:t.paper_supported,isDuplexSupported:t.duplex_supported}})),this.cmbPrinter.setData(i),this.cmbPrinter.setValue(t),this.cmbPrinter.trigger("selected",this,this.cmbPrinter.getSelectedRecord())},setCmbSidesOptions:function(t){var e=this.cmbSides.getValue(),i=[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc}];t?i.push({value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}):"one"!=e&&(e="one"),this.cmbSides.setData(i),this.cmbSides.setValue(e)},setCmbPaperSizeOptions:function(t){var e=[];(e=t&&t.length>0?t.map((function(t,e){return{value:e,displayValue:[t.name,t.width/10,t.height/10,"cm"],caption:t.name,size:[t.width,t.height]}})):[].concat(this._defaultPaperSizeList)).push({value:-1,displayValue:this.txtCustom,caption:this.txtCustom,size:[]});var i=this.cmbPaperSize.store.findWhere({value:this.cmbPaperSize.getValue()}),n=null;function s(t,e,i){return _.find(t,(function(t){return Math.abs(t.size[0]-e)<.1&&Math.abs(t.size[1]-i)<.1}))}if(i&&(n=s(e,Math.round(i.get("size")[0]),Math.round(i.get("size")[1]))),!n)if(i)n={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[0]).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[1]).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]};else{const t=this._originalPageSize?this._originalPageSize.w:210,i=this._originalPageSize?this._originalPageSize.h:297;n||(n=s(e,t,i)),n||(n={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(t).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]}),!n&&e[0]&&(n=e[0])}this.cmbPaperSize.setData(e),this.updatePaperSizeMetricUnit(),n?n.custom?this.cmbPaperSize.setValue(void 0,n.value):this.cmbPaperSize.setValue(n.value):this.cmbPaperSize.setValue(null)},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.height()+25+this.$el.find(".main-header").outerHeight(!0);this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update()}},setMode:function(t){this.mode=t},setApi:function(t){},onPrinterSelected:function(t,e){this.setCmbSidesOptions(!e||e.isDuplexSupported),this.setCmbPaperSizeOptions(e?e.paperSupported:null),this.btnPrint.setDisabled(!e)},updateMetricUnit:function(){this.updatePaperSizeMetricUnit(),this.cmbPaperMargins.onResetItems()},updatePaperSizeMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length-1;e++){var i=t.at(e),n=i.get("size"),s=n[0],o=n[1];i.set("displayValue",[i.get("caption"),parseFloat(Common.Utils.Metric.fnRecalcFromMM(s).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()])}this.cmbPaperSize.onResetItems()}},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},setOriginalPageSize:function(t,e){this._originalPageSize={w:t,h:e}},txtPrint:"Print",txtPrintPdf:"Print to PDF",txtPrinter:"Printer",txtPrinterNotSelected:"Printer not selected",txtPrintersNotFound:"Printers not found",txtPrintUsingSystemDialog:"Print using the system dialog",txtPrintRange:"Print range",txtCurrentPage:"Current page",txtAllPages:"All pages",txtSelection:"Selection",txtCustomPages:"Custom print",txtPageSize:"Page size",txtPageOrientation:"Page orientation",txtPortrait:"Portrait",txtLandscape:"Landscape",txtCustom:"Custom",txtMargins:"Margins",txtTop:"Top",txtBottom:"Bottom",txtLeft:"Left",txtRight:"Right",txtPage:"Page",txtOf:"of {0}",txtPageNumInvalid:"Page number invalid",txtPages:"Pages",textMarginsLast:"Last Custom",textMarginsNormal:"Normal",textMarginsNarrow:"Narrow",textMarginsModerate:"Moderate",textMarginsWide:"Wide",txtCopies:"Copies",txtPrintSides:"Print sides",txtOneSide:"Print one sided",txtOneSideDesc:"Only print on one side of the page",txtBothSides:"Print on both sides",txtBothSidesLongDesc:"Flip pages on long edge",txtBothSidesShortDesc:"Flip pages on short edge"},DE.Views.PrintWithPreview||{}))})),define("documenteditor/main/app/view/DocumentHolderExt",[],(function(){"use strict";if(window.DE&&window.DE.Views&&window.DE.Views.DocumentHolder){let t=window.DE.Views.DocumentHolder.prototype;t.createDelayedElements=function(){var t=this;if(!t.menuInsertCaption&&window.document_content_ready){t.menuInsertCaption=new Common.UI.MenuItem({caption:t.txtInsertCaption});var e=new Common.UI.MenuItem({caption:"--"});t.menuSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var i=new Common.UI.MenuItem({caption:"--"});t.menuEquationInsertCaption=new Common.UI.MenuItem({caption:t.txtInsertCaption});var n=new Common.UI.MenuItem({caption:"--"});t.menuImageAlign=new Common.UI.MenuItem({caption:t.textAlign,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:Asc.c_oAscAlignShapeType.ALIGN_LEFT}),new Common.UI.MenuItem({caption:t.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:Asc.c_oAscAlignShapeType.ALIGN_CENTER}),new Common.UI.MenuItem({caption:t.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:Asc.c_oAscAlignShapeType.ALIGN_RIGHT}),new Common.UI.MenuItem({caption:t.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:Asc.c_oAscAlignShapeType.ALIGN_TOP}),new Common.UI.MenuItem({caption:t.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:Asc.c_oAscAlignShapeType.ALIGN_MIDDLE}),new Common.UI.MenuItem({caption:t.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:Asc.c_oAscAlignShapeType.ALIGN_BOTTOM}),{caption:"--"},new Common.UI.MenuItem({caption:t.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6}),new Common.UI.MenuItem({caption:t.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7})]})});var s=DE.getController("Toolbar").getView();t.menuShapesMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-combine-shapes",caption:t.textShapesMerge,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:s.textShapesUnion,iconCls:"menu__icon btn-union-shapes",value:"unite"}),new Common.UI.MenuItem({caption:s.textShapesCombine,iconCls:"menu__icon btn-combine-shapes",value:"exclude"}),new Common.UI.MenuItem({caption:s.textShapesFragment,iconCls:"menu__icon btn-fragment-shapes",value:"divide"}),new Common.UI.MenuItem({caption:s.textShapesIntersect,iconCls:"menu__icon btn-intersect-shapes",value:"intersect"}),new Common.UI.MenuItem({caption:s.textShapesSubstract,iconCls:"menu__icon btn-substract-shapes",value:"subtract"})]})}),t.mnuGroup=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group"}),t.mnuUnGroup=new Common.UI.MenuItem({iconCls:"menu__icon btn-shape-ungroup",caption:this.txtUngroup}),t.menuImageArrange=new Common.UI.MenuItem({caption:t.textArrange,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textArrangeFront,iconCls:"menu__icon btn-arrange-front",valign:Asc.c_oAscChangeLevel.BringToFront}),new Common.UI.MenuItem({caption:t.textArrangeBack,iconCls:"menu__icon btn-arrange-back",valign:Asc.c_oAscChangeLevel.SendToBack}),new Common.UI.MenuItem({caption:t.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",valign:Asc.c_oAscChangeLevel.BringForward}),new Common.UI.MenuItem({caption:t.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",valign:Asc.c_oAscChangeLevel.BringBackward}),{caption:"--"},t.mnuGroup,t.mnuUnGroup]})}),t.menuWrapPolygon=new Common.UI.MenuItem({caption:t.textEditWrapBoundary,cls:"no-icon-wrap-item"}),t.menuImageWrap=new Common.UI.MenuItem({iconCls:"menu__icon btn-small-wrap-inline",caption:t.textWrap,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.txtInline,iconCls:"menu__icon btn-small-wrap-inline",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Inline,checkmark:!1,checkable:!0}),{caption:"--"},new Common.UI.MenuItem({caption:t.txtSquare,iconCls:"menu__icon btn-small-wrap-square",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Square,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:t.txtTight,iconCls:"menu__icon btn-small-wrap-tight",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Tight,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:t.txtThrough,iconCls:"menu__icon btn-small-wrap-through",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Through,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:t.txtTopAndBottom,iconCls:"menu__icon btn-small-wrap-topandbottom",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.TopAndBottom,checkmark:!1,checkable:!0}),{caption:"--"},new Common.UI.MenuItem({caption:t.txtInFront,iconCls:"menu__icon btn-small-wrap-infront",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.InFront,checkmark:!1,checkable:!0}),new Common.UI.MenuItem({caption:t.txtBehind,iconCls:"menu__icon btn-small-wrap-behind",toggleGroup:"popuppicturewrapping",wrapType:Asc.c_oAscWrapStyle2.Behind,checkmark:!1,checkable:!0}),{caption:"--"},t.menuWrapPolygon]})}),t.menuImageAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:t.advancedText}),t.menuChartEdit=new Common.UI.MenuItem({caption:t.editChartText}),t.menuOriginalSize=new Common.UI.MenuItem({caption:t.originalSizeText}),t.menuImgReplace=new Common.UI.MenuItem({caption:t.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:0}),new Common.UI.MenuItem({caption:this.textFromUrl,value:1}),new Common.UI.MenuItem({caption:this.textFromStorage,value:2})]})}),t.menuImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuImgAccept=new Common.UI.MenuItem({caption:t.textAccept,value:"accept"}),t.menuImgReject=new Common.UI.MenuItem({caption:t.textReject,value:"reject"});var o=new Common.UI.MenuItem({caption:"--"});t.menuImgPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection}),t.menuSignatureEditSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),t.menuSignatureEditSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2});var a=new Common.UI.MenuItem({caption:"--"});t.menuImgRotate=new Common.UI.MenuItem({caption:t.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:this.textRotate90,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:this.textRotate270,value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:this.textFlipH,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:this.textFlipV,value:0})]})}),t.menuImgCrop=new Common.UI.MenuItem({caption:t.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:t.textCropFill,value:1}),new Common.UI.MenuItem({caption:t.textCropFit,value:2})]})}),t.menuImgResetCrop=new Common.UI.MenuItem({caption:t.textResetCrop,iconCls:"menu__icon btn-reset"}),t.menuImgRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.textRemoveControl,value:"remove"}),t.menuImgControlSettings=new Common.UI.MenuItem({caption:t.textEditControls,value:"settings"});var l=new Common.UI.MenuItem({caption:"--"});t.menuImgEditPoints=new Common.UI.MenuItem({iconCls:"menu__icon btn-edit-points",caption:t.textEditPoints}),t.menuEditObjectSeparator=new Common.UI.MenuItem({caption:"--"}),t.menuEditObject=new Common.UI.MenuItem({caption:t.textEditObject}),this.pictureMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){if(!_.isUndefined(e.imgProps)){var i=!e.imgProps.value.get_CanBeFlow(),n=e.imgProps.value.get_WrappingStyle();t.menuImageWrap._originalProps=e.imgProps.value;var s="menu__icon ";if(i){for(var r=0;r<8;r++)t.menuImageWrap.menu.items[r].setChecked(!1);s+="btn-small-wrap-inline"}else switch(n){case Asc.c_oAscWrapStyle2.Inline:t.menuImageWrap.menu.items[0].setChecked(!0),s+="btn-small-wrap-inline";break;case Asc.c_oAscWrapStyle2.Square:t.menuImageWrap.menu.items[2].setChecked(!0),s+="btn-small-wrap-square";break;case Asc.c_oAscWrapStyle2.Tight:t.menuImageWrap.menu.items[3].setChecked(!0),s+="btn-small-wrap-tight";break;case Asc.c_oAscWrapStyle2.Through:t.menuImageWrap.menu.items[4].setChecked(!0),s+="btn-small-wrap-through";break;case Asc.c_oAscWrapStyle2.TopAndBottom:t.menuImageWrap.menu.items[5].setChecked(!0),s+="btn-small-wrap-topandbottom";break;case Asc.c_oAscWrapStyle2.Behind:t.menuImageWrap.menu.items[8].setChecked(!0),s+="btn-small-wrap-behind";break;case Asc.c_oAscWrapStyle2.InFront:t.menuImageWrap.menu.items[7].setChecked(!0),s+="btn-small-wrap-infront";break;default:for(r=0;r<8;r++)t.menuImageWrap.menu.items[r].setChecked(!1);s+="btn-small-wrap-infront"}t.menuImageWrap.setIconCls(s),_.each(t.menuImageWrap.menu.items,(function(t){t.setDisabled(i)}));var c=e.imgProps.isImg&&e.imgProps.isChart||e.imgProps.isImg&&e.imgProps.isShape||e.imgProps.isShape&&e.imgProps.isChart;c?(t.menuImageAdvanced.setCaption(t.advancedText),t.menuImageAdvanced.setIconCls("menu__icon btn-menu-image")):(t.menuImageAdvanced.setCaption(e.imgProps.isImg?t.imageText:e.imgProps.isChart?t.chartText:t.shapeText),t.menuImageAdvanced.setIconCls("menu__icon "+(e.imgProps.isImg?"btn-menu-image":e.imgProps.isChart?"btn-menu-chart":"btn-menu-shape"))),t.menuChartEdit.setVisible(!_.isNull(e.imgProps.value.get_ChartProperties())&&!c),t.menuOriginalSize.setVisible(e.imgProps.isOnlyImg||!e.imgProps.isChart&&!e.imgProps.isShape);var d=t.api.asc_IsContentControl(),h=d?t.api.asc_GetContentControlProperties():null,p=h?h.get_Lock():Asc.c_oAscSdtLockType.Unlocked,m=p==Asc.c_oAscSdtLockType.SdtContentLocked||p==Asc.c_oAscSdtLockType.ContentLocked,u=h&&h.get_FormPr();t.menuImgRemoveControl.setVisible(d),t.menuImgControlSettings.setVisible(d&&t.mode.canEditContentControl&&!u),l.setVisible(d),d&&(t.menuImgRemoveControl.setDisabled(p==Asc.c_oAscSdtLockType.SdtContentLocked||p==Asc.c_oAscSdtLockType.SdtLocked),t.menuImgRemoveControl.setCaption(u?t.getControlLabel(h):t.textRemoveControl));var g=e.imgProps.locked||void 0!==e.headerProps&&e.headerProps.locked||m,b=e.imgProps.value.asc_getPluginGuid();t.menuImgReplace.setVisible(e.imgProps.isOnlyImg&&null==b),t.menuImgReplace.isVisible()&&t.menuImgReplace.setDisabled(g||null===b);var C=null!=b;if(t.menuEditObject.setVisible(C),t.menuEditObjectSeparator.setVisible(C),C){var v=DE.getCollection("Common.Collections.Plugins").findWhere({guid:b});t.menuEditObject.setDisabled(!t.api.asc_canEditTableOleObject()&&null==v||g)}if(t.menuImgReplace.menu.items[2].setVisible(t.mode.canRequestInsertImage||t.mode.fileChoiceUrl&&t.mode.fileChoiceUrl.indexOf("{documentType}")>-1),t.menuImgRotate.setVisible(!e.imgProps.isChart&&null==b),t.menuImgRotate.isVisible()&&(t.menuImgRotate.setDisabled(g||e.imgProps.isSmartArt),t.menuImgRotate.menu.items[3].setDisabled(e.imgProps.isSmartArtInternal),t.menuImgRotate.menu.items[4].setDisabled(e.imgProps.isSmartArtInternal)),t.menuImgCrop.setVisible(t.api.asc_canEditCrop()),t.menuImgCrop.isVisible()&&t.menuImgCrop.setDisabled(g),t.menuImgResetCrop.setVisible(e.imgProps.value.asc_getIsCrop()),t.menuImgResetCrop.isVisible()&&t.menuImgResetCrop.setDisabled(g),t.menuChartEdit.isVisible()&&t.menuChartEdit.setDisabled(g||e.imgProps.value.get_SeveralCharts()),t.menuOriginalSize.setDisabled(g||null===e.imgProps.value.get_ImageUrl()||void 0===e.imgProps.value.get_ImageUrl()),t.menuImageAdvanced.setDisabled(g),t.menuImageAlign.setDisabled(g||n==Asc.c_oAscWrapStyle2.Inline),!g&&n!=Asc.c_oAscWrapStyle2.Inline){var f=t.api.asc_getSelectedDrawingObjectsCount(),x=Common.Utils.InternalSettings.get("de-img-align-to");t.menuImageAlign.menu.items[7].setDisabled(2==f&&(!x||3==x)),t.menuImageAlign.menu.items[8].setDisabled(2==f&&(!x||3==x))}t.menuShapesMerge.setDisabled(g||!t.api.asc_canMergeSelectedShapes()),t.menuShapesMerge.isDisabled()||t.menuShapesMerge.menu.items.forEach((function(e){e.setDisabled(!t.api.asc_canMergeSelectedShapes(e.value))})),t.menuImageArrange.setDisabled(n==Asc.c_oAscWrapStyle2.Inline&&!e.imgProps.value.get_FromGroup()||m||t.api&&!t.api.CanUnGroup()&&!t.api.CanGroup()&&e.imgProps.isSmartArtInternal),t.menuImageArrange.menu.items[0].setDisabled(e.imgProps.isSmartArtInternal),t.menuImageArrange.menu.items[1].setDisabled(e.imgProps.isSmartArtInternal),t.menuImageArrange.menu.items[2].setDisabled(e.imgProps.isSmartArtInternal),t.menuImageArrange.menu.items[3].setDisabled(e.imgProps.isSmartArtInternal),t.api&&(t.mnuUnGroup.setDisabled(g||!t.api.CanUnGroup()),t.mnuGroup.setDisabled(g||!t.api.CanGroup()),t.menuWrapPolygon.setDisabled(g||!t.api.CanChangeWrapPolygon())),t.menuImageWrap.setDisabled(g||e.imgProps.value.get_FromGroup()||i&&t.menuWrapPolygon.isDisabled()||!!h&&h.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!h.get_FormPr());var y=t.api&&t.api.can_CopyCut();t.menuImgCopy.setDisabled(!y),t.menuImgCut.setDisabled(g||!y),t.menuImgPaste.setDisabled(g),t.menuImgPrint.setVisible(t.mode.canPrint),t.menuImgPrint.setDisabled(!y);var w=Common.Utils.InternalSettings.get("de-accept-reject-lock");t.menuImgAccept.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!w),t.menuImgReject.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!w),o.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!w);var S=e.imgProps&&e.imgProps.value&&t.mode.isSignatureSupport?e.imgProps.value.asc_getSignatureId():void 0,A=!!S;t.menuSignatureEditSign.setVisible(A),t.menuSignatureEditSetup.setVisible(A),a.setVisible(A),A&&(t.menuSignatureEditSign.cmpEl.attr("data-value",S),t.menuSignatureEditSetup.cmpEl.attr("data-value",S));var P=t.api&&t.api.asc_canEditGeometry();t.menuImgEditPoints.setVisible(P),P&&t.menuImgEditPoints.setDisabled(g)}},items:[t.menuImgCut,t.menuImgCopy,t.menuImgPaste,t.menuImgPrint,t.menuEditObjectSeparator,t.menuEditObject,{caption:"--"},t.menuImgAccept,t.menuImgReject,o,t.menuSignatureEditSign,t.menuSignatureEditSetup,a,t.menuImgRemoveControl,t.menuImgControlSettings,l,t.menuImageArrange,t.menuImageAlign,t.menuShapesMerge,t.menuImageWrap,t.menuImgRotate,{caption:"--"},t.menuInsertCaption,e,t.menuSaveAsPicture,i,t.menuImgCrop,t.menuImgResetCrop,t.menuOriginalSize,t.menuImgReplace,t.menuChartEdit,t.menuImgEditPoints,t.menuImageAdvanced]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),n||t.fireEvent("editcomplete",t),t.currentMenu=null})),t.menuTableInsertCaption=new Common.UI.MenuItem({caption:t.txtInsertCaption}),t.mnuTableMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-merge-cells",caption:t.mergeCellsText}),t.mnuTableSplit=new Common.UI.MenuItem({caption:t.splitCellsText}),t.menuTableCellAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.cellAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuTableCellTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Top}),t.menuTableCellCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Center}),t.menuTableCellBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,toggleGroup:"popuptablecellalign",checkmark:!1,checkable:!0,checked:!1,valign:Asc.c_oAscVertAlignJc.Bottom})]})}),t.menuTableAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-table",caption:t.advancedTableText}),t.menuParagraphAdvancedInTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:t.advancedParagraphText});var r=new Common.UI.MenuItem({caption:"--"});t.menuEditHyperlinkTable=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkTable=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var c=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkTable,t.menuRemoveHyperlinkTable]})});t.menuTableRemoveForm=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.textRemove,value:"remove"}),t.menuTableRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.textRemoveControl,value:"remove"}),t.menuTableControlSettings=new Common.UI.MenuItem({caption:t.textSettings,value:"settings"});var d=new Common.UI.MenuItem({caption:t.textContentControls,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuTableRemoveControl,t.menuTableControlSettings]})});t.menuTableTOC=new Common.UI.MenuItem({caption:t.textTOC,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textSettings,value:"settings"},{caption:t.textUpdateAll,value:"all"},{caption:t.textUpdatePages,value:"pages"}]})}),t.menuAddCommentTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddHyperlinkTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuTableFollow=new Common.UI.MenuItem({caption:t.textFollow}),t.menuSpellTable=new Common.UI.MenuItem({caption:t.loadSpellText,disabled:!0}),t.menuSpellMoreTable=new Common.UI.MenuItem({caption:t.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})});var h=_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" langval="<%= value %>" class="<% if (checked) { %> checked <% } %>">',"<div>",'<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= caption %>","</div>",'<label style="opacity: 0.6"><%= captionEn %></label>',"</a>"].join(""));t.langTableMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:t.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu shifted-right",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:h,search:!0,searchFields:["caption","captionEn"],focusToCheckedItem:!0})}),t.menuIgnoreSpellTable=new Common.UI.MenuItem({caption:t.ignoreSpellText,value:!1}),t.menuIgnoreAllSpellTable=new Common.UI.MenuItem({caption:t.ignoreAllSpellText,value:!0}),t.menuToDictionaryTable=new Common.UI.MenuItem({caption:t.toDictionaryText});var p=new Common.UI.MenuItem({caption:"--"}),m=new Common.UI.MenuItem({caption:"--"});t.menuSpellCheckTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-docspell",caption:t.spellcheckText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuSpellTable,t.menuSpellMoreTable,p,t.menuIgnoreSpellTable,t.menuIgnoreAllSpellTable,t.menuToDictionaryTable,{caption:"--"},t.langTableMenu]})}),t.menuTableCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuTablePaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuTableCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuTableAccept=new Common.UI.MenuItem({caption:t.textAccept,value:"accept"}),t.menuTableReject=new Common.UI.MenuItem({caption:t.textReject,value:"reject"});var u=new Common.UI.MenuItem({caption:"--"});t.menuTablePrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection});var g=new Common.UI.MenuItem({caption:"--"});t.menuTableDistRows=new Common.UI.MenuItem({caption:t.textDistributeRows,value:!1}),t.menuTableDistCols=new Common.UI.MenuItem({caption:t.textDistributeCols,value:!0}),t.menuTableDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:t.directionText,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[t.menuTableDirectH=new Common.UI.MenuItem({caption:t.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.LRTB}),t.menuTableDirect90=new Common.UI.MenuItem({caption:t.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.TBRL}),t.menuTableDirect270=new Common.UI.MenuItem({caption:t.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popuptabledirect",direction:Asc.c_oAscCellTextDirection.BTLR})]})}),t.menuTableStartNewList=new Common.UI.MenuItem({caption:t.textStartNewList}),t.menuTableStartNumberingFrom=new Common.UI.MenuItem({caption:t.textStartNumberingFrom}),t.menuTableContinueNumbering=new Common.UI.MenuItem({caption:t.textContinueNumbering}),t.menuTableListIndents=new Common.UI.MenuItem({caption:t.textIndents});var b=new Common.UI.MenuItem({caption:t.bulletsText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuTableStartNewList,t.menuTableStartNumberingFrom,t.menuTableContinueNumbering,t.menuTableListIndents]})});t.menuTableRefreshField=new Common.UI.MenuItem({caption:t.textRefreshField}),t.menuTableEditField=new Common.UI.MenuItem({caption:t.textEditField}),t.menuTableFieldCodes=new Common.UI.MenuItem({caption:t.textFieldCodes});var C=new Common.UI.MenuItem({caption:"--"});t.menuTableEquation=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popuptableeqinput","tl-tr")}),t.menuTableSelectText=new Common.UI.MenuItem({caption:t.selectText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.cellText,value:2}),new Common.UI.MenuItem({caption:t.tableText,value:3})]})}),t.menuTableInsertText=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:t.insertText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.insertColumnLeftText,value:0}),new Common.UI.MenuItem({caption:t.insertColumnRightText,value:1}),new Common.UI.MenuItem({caption:t.insertRowAboveText,value:2}),new Common.UI.MenuItem({caption:t.insertRowBelowText,value:3}),new Common.UI.MenuItem({caption:t.textSeveral,value:4})]})}),t.menuTableDeleteText=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:t.deleteText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.tableText,value:2}),new Common.UI.MenuItem({caption:t.textCells,value:3})]})}),this.tableMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){if(!_.isUndefined(e.tableProps)){for(var i=e.mathProps&&e.mathProps.value,n=11;n<32;n++)t.tableMenu.items[n].setVisible(!i);var s=e.tableProps.value.get_CellsVAlign(),o="";switch(s){case Asc.c_oAscVertAlignJc.Top:o="menu__icon btn-align-top";break;case Asc.c_oAscVertAlignJc.Center:o="menu__icon btn-align-middle";break;case Asc.c_oAscVertAlignJc.Bottom:o="menu__icon btn-align-bottom"}t.menuTableCellAlign.setIconCls(o),t.menuTableCellTop.setChecked(s==Asc.c_oAscVertAlignJc.Top),t.menuTableCellCenter.setChecked(s==Asc.c_oAscVertAlignJc.Center),t.menuTableCellBottom.setChecked(s==Asc.c_oAscVertAlignJc.Bottom);var a=e.tableProps.value.get_CellsTextDirection();switch(o="",a){case Asc.c_oAscCellTextDirection.LRTB:o="menu__icon btn-text-orient-hor";break;case Asc.c_oAscCellTextDirection.TBRL:o="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscCellTextDirection.BTLR:o="menu__icon btn-text-orient-rup"}t.menuTableDirection.setIconCls(o),t.menuTableDirectH.setChecked(a==Asc.c_oAscCellTextDirection.LRTB),t.menuTableDirect90.setChecked(a==Asc.c_oAscCellTextDirection.TBRL),t.menuTableDirect270.setChecked(a==Asc.c_oAscCellTextDirection.BTLR);var l=!!e.paraProps&&!e.paraProps.value.can_EditBlockContentControl(),h=e.tableProps.locked||void 0!==e.headerProps&&e.headerProps.locked;t.menuTableInsertText.setDisabled(h),t.menuTableDeleteText.setDisabled(h),t.api&&(t.mnuTableMerge.setDisabled(h||!t.api.CheckBeforeMergeCells()),t.mnuTableSplit.setDisabled(h||!t.api.CheckBeforeSplitCells())),t.menuTableDistRows.setDisabled(h),t.menuTableDistCols.setDisabled(h),t.menuTableCellAlign.setDisabled(h),t.menuTableDirection.setDisabled(h),t.menuTableAdvanced.setDisabled(h);var p=t.api&&t.api.can_CopyCut();t.menuTableCopy.setDisabled(!p),t.menuTableCut.setDisabled(h||!p),t.menuTablePaste.setDisabled(h),t.menuTablePrint.setVisible(t.mode.canPrint),t.menuTablePrint.setDisabled(!p);var v=Common.Utils.InternalSettings.get("de-accept-reject-lock");t.menuTableAccept.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!v),t.menuTableReject.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!v),u.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!v);var f=t.api.asc_GetCurrentNumberingId(),x=null!==f;if(b.setVisible(x),x){var y=t.api.asc_GetNumberingPr(f).get_Lvl(t.api.asc_GetCurrentNumberingLvl()),w=y.get_Format(),S=t.api.asc_GetCalculatedNumberingValue();t.menuTableStartNewList.setVisible(y.get_Start()!=S),t.menuTableStartNewList.value={start:y.get_Start()},t.menuTableStartNumberingFrom.setVisible(w!=Asc.c_oAscNumberingFormat.Bullet),t.menuTableStartNumberingFrom.value={format:w,start:S},t.menuTableStartNewList.setCaption(w==Asc.c_oAscNumberingFormat.Bullet?t.textSeparateList:t.textStartNewList),t.menuTableContinueNumbering.setCaption(w==Asc.c_oAscNumberingFormat.Bullet?t.textJoinList:t.textContinueNumbering),t.menuTableListIndents.value={format:w,props:y}}var A=null;t.api&&(A=t.api.can_AddHyperlink()),t.menuAddHyperlinkTable.setVisible(void 0===e.hyperProps&&!1!==A),c.setVisible(void 0!==e.hyperProps),t.menuEditHyperlinkTable.hyperProps=e.hyperProps,t.menuRemoveHyperlinkTable.hyperProps=e.hyperProps,!1!==A&&(t.menuAddHyperlinkTable.hyperProps={},t.menuAddHyperlinkTable.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkTable.hyperProps.value.put_Text(A));var P=t.api.asc_GetRevisionsChangesStack(),T=!1;t.menuTableFollow.value=null,_.each(P,(function(e){e.get_Type()!=Asc.c_oAscRevisionsChangeType.TextAdd&&e.get_Type()!=Asc.c_oAscRevisionsChangeType.TextRem||e.get_MoveType()==Asc.c_oAscRevisionsMove.NoMove||(t.menuTableFollow.value=e,T=!0)})),t.menuTableFollow.setVisible(T),r.setVisible(t.menuAddHyperlinkTable.isVisible()||c.isVisible()||b.isVisible()||t.menuTableFollow.isVisible()),t.menuParagraphAdvancedInTable.setVisible(void 0!==e.paraProps),t._currentParaObjDisabled=h=e.paraProps.locked||void 0!==e.headerProps&&e.headerProps.locked,t.menuAddHyperlinkTable.setDisabled(h),c.setDisabled(h||void 0!==e.hyperProps&&!0===e.hyperProps.isSeveralLinks),t.menuParagraphAdvancedInTable.setDisabled(h||l),t.menuSpellCheckTable.setVisible(void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()),t.menuToDictionaryTable.setVisible(t.mode.isDesktopApp),m.setVisible(void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()),t.langTableMenu.setDisabled(h),void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()&&null!==e.spellProps.value.get_Variants()&&void 0!==e.spellProps.value.get_Variants()?t.addWordVariants(!1):(t.menuSpellTable.setCaption(t.loadSpellText),t.clearWordVariants(!1),t.menuSpellMoreTable.setVisible(!1)),t.menuSpellCheckTable.isVisible()&&t._currLang.id!==t._currLang.tableid&&(t.changeLanguageMenu(t.langTableMenu.menu),t._currLang.tableid=t._currLang.id);var I=0;if(i?I=t.addEquationMenu(t.tableMenu,10):t.clearEquationMenu(t.tableMenu,10),g.setVisible(i&&I>0),t.menuTableEquation.setVisible(i),t.menuTableEquation.setDisabled(h),i){var k=t.api.asc_GetMathInputType(),V=t.api.asc_IsInlineMath(),B=Common.Utils.InternalSettings.get("de-equation-toolbar-hide");t.menuTableEquation.menu.items[5].setChecked(k===Asc.c_oAscMathInputType.Unicode),t.menuTableEquation.menu.items[6].setChecked(k===Asc.c_oAscMathInputType.LaTeX),t.menuTableEquation.menu.items[8].options.isEquationInline=V,t.menuTableEquation.menu.items[8].setCaption(V?t.eqToDisplayText:t.eqToInlineText),t.menuTableEquation.menu.items[9].options.isToolbarHide=B,t.menuTableEquation.menu.items[9].setCaption(B?t.showEqToolbar:t.hideEqToolbar)}var M=!!e.paraProps&&!(e.paraProps.value.can_DeleteBlockContentControl()&&e.paraProps.value.can_EditBlockContentControl()&&e.paraProps.value.can_DeleteInlineContentControl()&&e.paraProps.value.can_EditInlineContentControl()),U=t.api.asc_GetTableOfContentsPr(!0),D=!U&&t.api.asc_IsContentControl();if(D){var L=t.api.asc_GetContentControlProperties(),F=L?L.get_Lock():Asc.c_oAscSdtLockType.Unlocked,R=L&&L.get_FormPr();t.menuTableRemoveForm.setVisible(R),d.setVisible(!R),R?(t.menuTableRemoveForm.setDisabled(F==Asc.c_oAscSdtLockType.SdtContentLocked||F==Asc.c_oAscSdtLockType.SdtLocked),t.menuTableRemoveForm.setCaption(t.getControlLabel(L))):(t.menuTableRemoveControl.setDisabled(F==Asc.c_oAscSdtLockType.SdtContentLocked||F==Asc.c_oAscSdtLockType.SdtLocked),t.menuTableControlSettings.setVisible(t.mode.canEditContentControl));var E=L?L.get_SpecificType():Asc.c_oAscContentControlSpecificType.None;M=M||E==Asc.c_oAscContentControlSpecificType.CheckBox||E==Asc.c_oAscContentControlSpecificType.Picture||E==Asc.c_oAscContentControlSpecificType.Signature||E==Asc.c_oAscContentControlSpecificType.ComboBox||E==Asc.c_oAscContentControlSpecificType.DropDownList||E==Asc.c_oAscContentControlSpecificType.DateTime}else d.setVisible(D),t.menuTableRemoveForm.setVisible(D);t.menuTableTOC.setVisible(U),t.menuAddCommentTable.setVisible(!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments&&!M),t.menuAddCommentTable.setDisabled(void 0!==e.paraProps&&!0===e.paraProps.locked);var H=t.api.asc_HaveFields(!0);t.menuTableRefreshField.setVisible(!!H),t.menuTableRefreshField.setDisabled(h),t.menuTableEditField.setVisible(!!H),t.menuTableEditField.setDisabled(h),t.menuTableFieldCodes.setVisible(!!H),t.menuTableFieldCodes.setDisabled(h),C.setVisible(!!H)}},items:[t.menuSpellCheckTable,m,t.menuTableCut,t.menuTableCopy,t.menuTablePaste,t.menuTablePrint,{caption:"--"},t.menuTableAccept,t.menuTableReject,u,g,t.menuTableRefreshField,t.menuTableEditField,t.menuTableFieldCodes,C,t.menuTableSelectText,t.menuTableInsertText,t.menuTableDeleteText,{caption:"--"},t.mnuTableMerge,t.mnuTableSplit,{caption:"--"},t.menuTableDistRows,t.menuTableDistCols,{caption:"--"},t.menuTableCellAlign,t.menuTableDirection,{caption:"--"},t.menuTableInsertCaption,{caption:"--"},t.menuTableAdvanced,{caption:"--"},t.menuAddCommentTable,b,t.menuAddHyperlinkTable,c,t.menuTableFollow,r,t.menuTableRemoveForm,d,t.menuTableTOC,t.menuParagraphAdvancedInTable,t.menuTableEquation]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),t.menuParagraphBreakBefore=new Common.UI.MenuItem({caption:t.breakBeforeText,checkable:!0}),t.menuParagraphKeepLines=new Common.UI.MenuItem({caption:t.keepLinesText,checkable:!0}),t.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Top}),t.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Center}),t.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,checkmark:!1,checkable:!0,checked:!1,toggleGroup:"popupparagraphvalign",valign:Asc.c_oAscVAlign.Bottom})]})}),t.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:t.directionText,menu:new Common.UI.Menu({cls:"ppm-toolbar shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphDirectH=new Common.UI.MenuItem({caption:t.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),t.menuParagraphDirect90=new Common.UI.MenuItem({caption:t.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),t.menuParagraphDirect270=new Common.UI.MenuItem({caption:t.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})}),t.menuParagraphAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:t.advancedParagraphText}),t.menuFrameAdvanced=new Common.UI.MenuItem({caption:t.advancedFrameText}),t.menuDropCapAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-dropcap-intext icon-rtl",caption:t.advancedDropCapText}),t.menuParagraphEquation=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popupparaeqinput","tl-tr")});var v=new Common.UI.MenuItem({caption:"--"});t.menuAddCommentPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText});var f=new Common.UI.MenuItem({caption:"--"});t.menuAddHyperlinkPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuEditHyperlinkPara=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkPara=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var x=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkPara,t.menuRemoveHyperlinkPara]})}),y=new Common.UI.MenuItemSeparator,w=new Common.UI.MenuItem({caption:t.styleText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuStyleSave=new Common.UI.MenuItem({caption:t.saveStyleText}),t.menuStyleUpdate=new Common.UI.MenuItem({caption:t.updateStyleText.replace("%1",window.currentStyleName)})]})});t.menuSpellPara=new Common.UI.MenuItem({caption:t.loadSpellText,disabled:!0}),t.menuSpellMorePara=new Common.UI.MenuItem({caption:t.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})}),t.langParaMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:t.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu shifted-right",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:h,search:!0,searchFields:["caption","captionEn"],focusToCheckedItem:!0})}),t.menuIgnoreSpellPara=new Common.UI.MenuItem({caption:t.ignoreSpellText,value:!1}),t.menuIgnoreAllSpellPara=new Common.UI.MenuItem({caption:t.ignoreAllSpellText,value:!0}),t.menuToDictionaryPara=new Common.UI.MenuItem({caption:t.toDictionaryText});var S=new Common.UI.MenuItem({caption:"--"}),A=new Common.UI.MenuItem({caption:"--"});t.menuParaCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuParaPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuParaCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuParaAccept=new Common.UI.MenuItem({caption:t.textAccept,value:"accept"}),t.menuParaReject=new Common.UI.MenuItem({caption:t.textReject,value:"reject"});var P=new Common.UI.MenuItem({caption:"--"});t.menuParaPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection});var T=new Common.UI.MenuItem({caption:"--"});t.menuParaRemoveControl=new Common.UI.MenuItem({iconCls:"menu__icon btn-cc-remove",caption:t.textRemoveControl,value:"remove"}),t.menuParaControlSettings=new Common.UI.MenuItem({caption:t.textEditControls,value:"settings"});var I=new Common.UI.MenuItem({caption:"--"});t.menuParaTOCSettings=new Common.UI.MenuItem({caption:t.textTOCSettings,value:"settings"}),t.menuParaTOCRefresh=new Common.UI.MenuItem({caption:t.textUpdateTOC,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textUpdateAll,value:"all"},{caption:t.textUpdatePages,value:"pages"}]})});var k=new Common.UI.MenuItem({caption:"--"});t.menuParaRefreshField=new Common.UI.MenuItem({caption:t.textRefreshField}),t.menuParaEditField=new Common.UI.MenuItem({caption:t.textEditField}),t.menuParaFieldCodes=new Common.UI.MenuItem({caption:t.textFieldCodes});var V=new Common.UI.MenuItem({caption:"--"});t.menuParaStartNewList=new Common.UI.MenuItem({caption:t.textStartNewList}),t.menuParaStartNumberingFrom=new Common.UI.MenuItem({caption:t.textStartNumberingFrom}),t.menuParaContinueNumbering=new Common.UI.MenuItem({caption:t.textContinueNumbering}),t.menuParaListIndents=new Common.UI.MenuItem({caption:t.textIndents});var B=new Common.UI.MenuItem({caption:"--"});t.menuParaFollow=new Common.UI.MenuItem({caption:t.textFollow});var M=new Common.UI.MenuItem({caption:"--"});this.textMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){var i=e.imgProps&&e.imgProps.value&&!_.isNull(e.imgProps.value.get_ShapeProperties()),s=e.imgProps&&e.imgProps.value&&!_.isNull(e.imgProps.value.get_ChartProperties()),o=e.mathProps&&e.mathProps.value,a=t.api.asc_GetTableOfContentsPr(!0),l=!a&&t.api.asc_IsContentControl(),r=l?t.api.asc_GetContentControlProperties():null,c=!!e.paraProps&&!e.paraProps.value.can_EditBlockContentControl(),d=r&&r.get_FormPr();if(t.menuParagraphVAlign.setVisible(i&&!s&&!o&&!(d&&r.get_FormPr().get_Fixed())),t.menuParagraphDirection.setVisible(i&&!s&&!o&&!(d&&r.get_FormPr().get_Fixed())),i||s){var h=e.imgProps.value.get_VerticalTextAlign(),p="";switch(h){case Asc.c_oAscVAlign.Top:p="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:p="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:p="menu__icon btn-align-bottom"}t.menuParagraphVAlign.setIconCls(p),t.menuParagraphTop.setChecked(h==Asc.c_oAscVAlign.Top),t.menuParagraphCenter.setChecked(h==Asc.c_oAscVAlign.Center),t.menuParagraphBottom.setChecked(h==Asc.c_oAscVAlign.Bottom);var m=e.imgProps.value.get_Vert();switch(p="",m){case Asc.c_oAscVertDrawingText.normal:p="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:p="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:p="menu__icon btn-text-orient-rup"}t.menuParagraphDirection.setIconCls(p),t.menuParagraphDirectH.setChecked(m==Asc.c_oAscVertDrawingText.normal),t.menuParagraphDirect90.setChecked(m==Asc.c_oAscVertDrawingText.vert),t.menuParagraphDirect270.setChecked(m==Asc.c_oAscVertDrawingText.vert270)}t.menuParagraphAdvanced.isChart=e.imgProps&&e.imgProps.isChart,t.menuParagraphAdvanced.isSmartArtInternal=e.imgProps&&e.imgProps.isSmartArtInternal,t.menuParagraphBreakBefore.setVisible(!i&&!s&&!o),t.menuParagraphKeepLines.setVisible(!i&&!s&&!o),e.paraProps&&(t.menuParagraphBreakBefore.setChecked(e.paraProps.value.get_PageBreakBefore()),t.menuParagraphKeepLines.setChecked(e.paraProps.value.get_KeepLines()));var u=null;t.api&&(u=t.api.can_AddHyperlink()),t.menuAddHyperlinkPara.setVisible(void 0===e.hyperProps&&!1!==u),x.setVisible(void 0!==e.hyperProps),f.setVisible(t.menuAddHyperlinkPara.isVisible()||x.isVisible()),t.menuEditHyperlinkPara.hyperProps=e.hyperProps,t.menuRemoveHyperlinkPara.hyperProps=e.hyperProps,!1!==u&&(t.menuAddHyperlinkPara.hyperProps={},t.menuAddHyperlinkPara.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkPara.hyperProps.value.put_Text(u));var g=e.paraProps.locked||void 0!==e.headerProps&&e.headerProps.locked;t._currentParaObjDisabled=g,t.menuAddHyperlinkPara.setDisabled(g),x.setDisabled(g||void 0!==e.hyperProps&&!0===e.hyperProps.isSeveralLinks);var b=t.api.asc_GetRevisionsChangesStack(),C=!1;t.menuParaFollow.value=null,_.each(b,(function(e){e.get_Type()!=Asc.c_oAscRevisionsChangeType.TextAdd&&e.get_Type()!=Asc.c_oAscRevisionsChangeType.TextRem||e.get_MoveType()==Asc.c_oAscRevisionsMove.NoMove||(t.menuParaFollow.value=e,C=!0)})),t.menuParaFollow.setVisible(C),M.setVisible(C),t.menuParagraphBreakBefore.setDisabled(g||c||!_.isUndefined(e.headerProps)||!_.isUndefined(e.imgProps)),t.menuParagraphKeepLines.setDisabled(g||c),t.menuParagraphAdvanced.setDisabled(g||c||d&&d.get_Fixed()),t.menuFrameAdvanced.setDisabled(g),t.menuDropCapAdvanced.setDisabled(g),t.menuParagraphVAlign.setDisabled(g),t.menuParagraphDirection.setDisabled(g);var U=t.api&&t.api.can_CopyCut();t.menuParaCopy.setDisabled(!U),t.menuParaCut.setDisabled(g||!U),t.menuParaPaste.setDisabled(g),t.menuParaPrint.setVisible(t.mode.canPrint),t.menuParaPrint.setDisabled(!U);var D=Common.Utils.InternalSettings.get("de-accept-reject-lock");t.menuParaAccept.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!D),t.menuParaReject.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!D),P.setVisible(t.mode.canReview&&!t.mode.isReviewOnly&&!D);var L=void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked();t.menuSpellPara.setVisible(L),A.setVisible(L),t.menuIgnoreSpellPara.setVisible(L),t.menuIgnoreAllSpellPara.setVisible(L),t.menuToDictionaryPara.setVisible(L&&t.mode.isDesktopApp),t.langParaMenu.setVisible(L),t.langParaMenu.setDisabled(g),S.setVisible(L),L&&null!==e.spellProps.value.get_Variants()&&void 0!==e.spellProps.value.get_Variants()?t.addWordVariants(!0):(t.menuSpellPara.setCaption(t.loadSpellText),t.clearWordVariants(!0),t.menuSpellMorePara.setVisible(!1)),t.langParaMenu.isVisible()&&t._currLang.id!==t._currLang.paraid&&(t.changeLanguageMenu(t.langParaMenu.menu),t._currLang.paraid=t._currLang.id);var F=0;if(o?F=t.addEquationMenu(t.textMenu,18):t.clearEquationMenu(t.textMenu,18),T.setVisible(o&&F>0),t.menuEquationInsertCaption.setVisible(o),n.setVisible(o),t.menuParagraphEquation.setVisible(o),t.menuParagraphEquation.setDisabled(g),o){var R=t.api.asc_GetMathInputType(),E=t.api.asc_IsInlineMath(),H=Common.Utils.InternalSettings.get("de-equation-toolbar-hide");t.menuParagraphEquation.menu.items[5].setChecked(R===Asc.c_oAscMathInputType.Unicode),t.menuParagraphEquation.menu.items[6].setChecked(R===Asc.c_oAscMathInputType.LaTeX),t.menuParagraphEquation.menu.items[8].options.isEquationInline=E,t.menuParagraphEquation.menu.items[8].setCaption(E?t.eqToDisplayText:t.eqToInlineText),t.menuParagraphEquation.menu.items[9].options.isToolbarHide=H,t.menuParagraphEquation.menu.items[9].setCaption(H?t.showEqToolbar:t.hideEqToolbar)}var N=e.paraProps.value.get_FramePr();t.menuFrameAdvanced.setVisible(void 0!==N),t.menuDropCapAdvanced.setVisible(void 0!==N),N&&t.menuDropCapAdvanced.setIconCls((N.get_DropCap()===Asc.c_oAscDropCap.Drop?"menu__icon btn-dropcap-intext":"menu__icon btn-dropcap-inmargin")+" icon-rtl");var O=t.mode.canEditStyles&&!s&&!(e.imgProps&&e.imgProps.isSmartArtInternal);y.setVisible(O),w.setVisible(O),O&&(t.menuStyleUpdate.setCaption(t.updateStyleText.replace("%1",DE.getController("Main").translationTable[window.currentStyleName]||window.currentStyleName)),t.menuStyleSave.setDisabled(!window.styles_loaded));var W=!!e.paraProps&&!(e.paraProps.value.can_DeleteBlockContentControl()&&e.paraProps.value.can_EditBlockContentControl()&&e.paraProps.value.can_DeleteInlineContentControl()&&e.paraProps.value.can_EditInlineContentControl());if(t.menuParaRemoveControl.setVisible(l),t.menuParaControlSettings.setVisible(l&&t.mode.canEditContentControl&&!d),I.setVisible(l),l){var z=r?r.get_Lock():Asc.c_oAscSdtLockType.Unlocked;t.menuParaRemoveControl.setDisabled(z==Asc.c_oAscSdtLockType.SdtContentLocked||z==Asc.c_oAscSdtLockType.SdtLocked),t.menuParaRemoveControl.setCaption(d?t.getControlLabel(r):t.textRemoveControl);var $=r?r.get_SpecificType():Asc.c_oAscContentControlSpecificType.None;W=W||$==Asc.c_oAscContentControlSpecificType.CheckBox||$==Asc.c_oAscContentControlSpecificType.Picture||$==Asc.c_oAscContentControlSpecificType.Signature||$==Asc.c_oAscContentControlSpecificType.ComboBox||$==Asc.c_oAscContentControlSpecificType.DropDownList||$==Asc.c_oAscContentControlSpecificType.DateTime}t.menuParaTOCSettings.setVisible(a),t.menuParaTOCRefresh.setVisible(a),k.setVisible(a);var G=!s&&!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments&&!W;t.mode.compatibleFeatures&&(G=G&&!i),v.setVisible(G),t.menuAddCommentPara.setVisible(G),t.menuAddCommentPara.setDisabled(e.paraProps&&!0===e.paraProps.locked);var j=t.api.asc_HaveFields(!0);t.menuParaRefreshField.setVisible(!!j),t.menuParaRefreshField.setDisabled(g),t.menuParaEditField.setVisible(!!j),t.menuParaEditField.setDisabled(g),t.menuParaFieldCodes.setVisible(!!j),t.menuParaFieldCodes.setDisabled(g),V.setVisible(!!j);var q=t.api.asc_GetCurrentNumberingId(),K=null!==q;if(B.setVisible(K),t.menuParaStartNewList.setVisible(K),t.menuParaStartNumberingFrom.setVisible(K),t.menuParaContinueNumbering.setVisible(K),t.menuParaListIndents.setVisible(K),K){var Y=t.api.asc_GetCurrentNumberingLvl(),X=t.api.asc_GetNumberingPr(q).get_Lvl(Y),J=X.get_Format(),Q=t.api.asc_GetCalculatedNumberingValue();t.menuParaStartNewList.setVisible(X.get_Start()!=Q),t.menuParaStartNewList.value={start:X.get_Start()},t.menuParaStartNumberingFrom.setVisible(J!=Asc.c_oAscNumberingFormat.Bullet),t.menuParaStartNumberingFrom.value={format:J,start:Q},t.menuParaStartNewList.setCaption(J==Asc.c_oAscNumberingFormat.Bullet?t.textSeparateList:t.textStartNewList),t.menuParaContinueNumbering.setCaption(J==Asc.c_oAscNumberingFormat.Bullet?t.textJoinList:t.textContinueNumbering),t.menuParaListIndents.value={listId:q,level:Y,format:J,props:X}}},items:[t.menuSpellPara,t.menuSpellMorePara,A,t.menuIgnoreSpellPara,t.menuIgnoreAllSpellPara,t.menuToDictionaryPara,t.langParaMenu,S,t.menuParaCut,t.menuParaCopy,t.menuParaPaste,t.menuParaPrint,P,t.menuParaAccept,t.menuParaReject,n,t.menuEquationInsertCaption,{caption:"--"},T,t.menuParaRemoveControl,t.menuParaControlSettings,I,t.menuParaRefreshField,t.menuParaEditField,t.menuParaFieldCodes,V,t.menuParaTOCSettings,t.menuParaTOCRefresh,k,t.menuParagraphBreakBefore,t.menuParagraphKeepLines,t.menuParagraphVAlign,t.menuParagraphDirection,t.menuParagraphAdvanced,t.menuFrameAdvanced,t.menuDropCapAdvanced,t.menuParagraphEquation,v,t.menuAddCommentPara,f,t.menuAddHyperlinkPara,x,M,t.menuParaFollow,B,t.menuParaStartNewList,t.menuParaStartNumberingFrom,t.menuParaContinueNumbering,t.menuParaListIndents,y,w]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)}));var U=new Common.UI.MenuItem({caption:t.editHeaderText});this.hdrMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){U.setCaption(e.Header?t.editHeaderText:t.editFooterText),U.off("click").on("click",(function(i){t.api&&(e.Header?t.api.GoToHeader(e.PageNum):t.api.GoToFooter(e.PageNum),t.fireEvent("editcomplete",t))}))},items:[U]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),n||t.fireEvent("editcomplete",t),t.currentMenu=null}));var D=$("#id_buttonNextPage");D.attr("data-toggle","tooltip"),D.tooltip({title:t.textNextPage+Common.Utils.String.platformKey("Alt+PgDn"),placement:"top-right"});var L=$("#id_buttonPrevPage");L.attr("data-toggle","tooltip"),L.tooltip({title:t.textPrevPage+Common.Utils.String.platformKey("Alt+PgUp"),placement:"top-right"}),this.fireEvent("createdelayedelements",[this,"edit"])}},t.createDelayedElementsViewer=function(){var t=this;t.menuViewCopy||(t.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuViewPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuViewCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuViewUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo icon-rtl",caption:t.textUndo}),t.menuViewCopySeparator=new Common.UI.MenuItem({caption:"--"}),t.menuViewAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuSignatureViewSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),t.menuSignatureDetails=new Common.UI.MenuItem({caption:this.strDetails,value:1}),t.menuSignatureViewSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),t.menuSignatureRemove=new Common.UI.MenuItem({caption:this.strDelete,value:3}),t.menuViewSignSeparator=new Common.UI.MenuItem({caption:"--"}),t.menuViewPrint=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){var i=e.imgProps&&e.imgProps.value&&!_.isNull(e.imgProps.value.get_ChartProperties()),n=e.imgProps&&e.imgProps.value&&!_.isNull(e.imgProps.value.get_ShapeProperties()),s=e.imgProps&&e.imgProps.value&&t.mode.isSignatureSupport?e.imgProps.value.asc_getSignatureId():void 0,o=s?t.api.asc_getSignatureSetup(s):null,a=!!o&&t._canProtect,l=!!e.paraProps&&!(e.paraProps.value.can_DeleteBlockContentControl()&&e.paraProps.value.can_EditBlockContentControl()&&e.paraProps.value.can_DeleteInlineContentControl()&&e.paraProps.value.can_EditInlineContentControl()),r=!i&&!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments&&!t._isDisabled&&!l,c=!1;if(t.mode.compatibleFeatures&&(r=r&&!n),t.api.asc_IsContentControl()){var d=t.api.asc_GetContentControlProperties(),h=d?d.get_SpecificType():Asc.c_oAscContentControlSpecificType.None;r=r&&!(h==Asc.c_oAscContentControlSpecificType.CheckBox||h==Asc.c_oAscContentControlSpecificType.Picture||h==Asc.c_oAscContentControlSpecificType.Signature||h==Asc.c_oAscContentControlSpecificType.ComboBox||h==Asc.c_oAscContentControlSpecificType.DropDownList||h==Asc.c_oAscContentControlSpecificType.DateTime),c=void 0!==h&&(h===Asc.c_oAscContentControlSpecificType.None||h===Asc.c_oAscContentControlSpecificType.ComboBox||h===Asc.c_oAscContentControlSpecificType.Complex)&&!l}t.menuViewUndo.setVisible(t.mode.canCoAuthoring&&t.mode.canComments&&!t._isDisabled),t.menuViewUndo.setDisabled(!t.api.asc_getCanUndo()),t.menuViewCopySeparator.setVisible(a);var p=!!o&&o.asc_getRequested();t.menuSignatureViewSign.setVisible(a&&p),t.menuSignatureDetails.setVisible(a&&!p),t.menuSignatureViewSetup.setVisible(a),t.menuSignatureRemove.setVisible(a&&!p),t.menuViewSignSeparator.setVisible(r),a&&(t.menuSignatureViewSign.cmpEl.attr("data-value",s),t.menuSignatureDetails.cmpEl.attr("data-value",o.asc_getId()),t.menuSignatureViewSetup.cmpEl.attr("data-value",s),t.menuSignatureRemove.cmpEl.attr("data-value",s)),t.menuViewAddComment.setVisible(r),t.menuViewAddComment.setDisabled(e.paraProps&&!0===e.paraProps.locked||t._docProtection.isReadOnly||t._docProtection.isFormsOnly);var m=e.paraProps&&!0===e.paraProps.locked,u=t.api&&t.api.can_CopyCut();t.menuViewCopy.setDisabled(!u),t.menuViewCut.setVisible(t._fillFormMode&&c),t.menuViewCut.setDisabled(m||!u||t._docProtection.isReadOnly||t._docProtection.isCommentsOnly),t.menuViewPaste.setVisible(t._fillFormMode&&c),t.menuViewPaste.setDisabled(m||t._docProtection.isReadOnly||t._docProtection.isCommentsOnly),t.menuViewPrint.setVisible(t.mode.canPrint&&!t._fillFormMode),t.menuViewPrint.setDisabled(!u)},items:[t.menuViewCut,t.menuViewCopy,t.menuViewPaste,t.menuViewUndo,t.menuViewPrint,t.menuViewCopySeparator,t.menuSignatureViewSign,t.menuSignatureDetails,t.menuSignatureViewSetup,t.menuSignatureRemove,t.menuViewSignSeparator,t.menuViewAddComment]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"view"]))},t.createDelayedElementsPDFViewer=function(){var t=this;t.menuPDFViewCopy||(t.menuPDFViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),this.viewPDFModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){t.menuPDFViewCopy.setDisabled(!(t.api&&t.api.can_CopyCut()))},items:[t.menuPDFViewCopy]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"pdf"]))},t.createDelayedElementsPDFForms=function(){var t=this;t.menuPDFFormsCopy||(t.menuPDFFormsCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuPDFFormsPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuPDFFormsCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuPDFFormsUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo icon-rtl",caption:t.textUndo}),t.menuPDFFormsRedo=new Common.UI.MenuItem({iconCls:"menu__icon btn-redo",caption:t.textRedo}),t.menuPDFFormsClear=new Common.UI.MenuItem({iconCls:"menu__icon btn-clearstyle",caption:t.textClearField}),t.formsPDFMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){var i=t.api.can_CopyCut(),n=e.paraProps&&e.paraProps.locked||e.headerProps&&e.headerProps.locked||e.imgProps&&(e.imgProps.locked||e.imgProps.content_locked)||t._isDisabled,s=!0;if(e.controlProps&&e.controlProps.formPr){var o=t.api.asc_GetOForm();o&&!o.asc_canFillRole(e.controlProps.formPr.get_Role())&&(s=!1)}t.menuPDFFormsUndo.setDisabled(n||!t.api.asc_getCanUndo()),t.menuPDFFormsRedo.setDisabled(n||!t.api.asc_getCanRedo()),t.menuPDFFormsClear.setDisabled(n||!t.api.asc_IsContentControl()||!s),t.menuPDFFormsCut.setDisabled(n||!i||!s),t.menuPDFFormsCopy.setDisabled(!i),t.menuPDFFormsPaste.setDisabled(n||!t.api.asc_IsContentControl()||!s)},items:[t.menuPDFFormsUndo,t.menuPDFFormsRedo,{caption:"--"},t.menuPDFFormsClear,{caption:"--"},t.menuPDFFormsCut,t.menuPDFFormsCopy,t.menuPDFFormsPaste]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"forms"]))}}})),define("text!documenteditor/main/app/template/ParagraphSettingsAdvanced.template",[],(function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\r\n    <div class="inner-content">\r\n            <div>\r\n                <div class="padding-large" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textAlign %></label>\r\n                    <div id="paragraphadv-spin-text-alignment"></div>\r\n                </div>\r\n                <div class="padding-large text-only float-right">\r\n                    <label class="input-label"><%= scope.strIndentsOutlinelevel %></label>\r\n                    <div id="paragraphadv-spin-outline-level"></div>\r\n                </div>\r\n            </div>\r\n            <div><label class="header padding-very-small"><%= scope.strIndent %></label></div>\r\n            <div>\r\n                <div class="padding-large margin-right-3" style="display: inline-block;">\r\n                 <label id="paragraphadv-lbl-indent-left" class="input-label"><%= scope.strIndentsLeftText %></label>\r\n                    <div id="paragraphadv-spin-indent-left"></div>\r\n                </div>\x3c!--\r\n             --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\r\n                    <label id="paragraphadv-lbl-indent-right" class="input-label"><%= scope.strIndentsRightText %></label>\r\n                    <div id="paragraphadv-spin-indent-right"></div>\r\n                </div>\x3c!--\r\n             --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\r\n                    <div>\r\n                        <label class="input-label"><%= scope.strIndentsSpecial %></label>\r\n                    </div>\r\n                <div>\r\n                        <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                     --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div><label class="header padding-very-small"><%= scope.strSpacing %></label></div>\r\n            <div>\r\n                <div class="margin-right-3" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\r\n                    <div id="paragraphadv-spin-spacing-before"></div>\r\n                </div>\x3c!--\r\n             --\x3e<div class="margin-right-3" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\r\n                    <div id="paragraphadv-spin-spacing-after"></div>\r\n                </div>\x3c!--\r\n             --\x3e<div style="display: inline-block;vertical-align: top">\r\n                    <div>\r\n                        <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\r\n                    </div>\r\n                    <div>\r\n                        <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                     --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="text-only" style="padding-top: 8px;">\r\n                <div id="paragraphadv-checkbox-add-interval"></div>\r\n            </div>\r\n            <div style="padding-top: 16px;"><label class="header padding-very-small"><%= scope.strDirection %></label></div>\r\n            <div>\r\n                <div id="paragraphadv-dir-ltr" class="margin-right-20" style="display: inline-block;"></div><div id="paragraphadv-dir-rtl" class="margin-left-20" style="display: inline-block;"></div>\r\n            </div>\r\n            <div class="padding-large" style="padding-top: 16px; display: none;">\r\n                <div style="border: 1px solid #cbcbcb; width: 350px;">\r\n                    <div id="paragraphadv-indent-preview" style="height: 58px; position: relative;"></div>\r\n                </div>\r\n            </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-line" class="settings-panel">\r\n    <div class="inner-content text-only padding-left-10" >\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-break-before"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-keep-lines"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-orphan"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-keep-next"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" colspan="2">\r\n                    <div id="paragraphadv-checkbox-suppress-line-numbers"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-borders" class="settings-panel">\r\n    <div class="inner-content">\r\n        <div class="settings-wrap padding-small">\r\n            <label class="input-label"><%= scope.textBorderWidth %></label>\r\n            <div id="paragraphadv-combo-border-size" class="margin-left-3"></div>\r\n            <div class="border-color">\r\n                <label class="input-label" ><%= scope.textBorderColor %></label>\r\n                <div id="paragraphadv-border-color-btn" class="margin-left-3"></div>\r\n            </div>\r\n        </div>\r\n        <label class="input-label padding-small" style="width: 100%;"><%= scope.textBorderDesc %></label>\r\n        <div style="width: 100%;" class="padding-large">\r\n            <div id="id-deparagraphstyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 170px;outline: 1px solid #ccc; margin-top: 2px;"></div>\r\n            <div class="border-types margin-left-9" style="display: inline-block; vertical-align: top; width: 76px; height: 170px; padding-top: 0px;">\r\n                <div id="paragraphadv-button-border-top" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-inner-hor" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-bottom" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-outer" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-left" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-all" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-right" style="display: inline-block;"></div>\r\n                <div id="paragraphadv-button-border-none" style="display: inline-block;"></div>\r\n            </div>\r\n        </div>\r\n        <div class="color-btn-wrap" class="padding-small">\r\n            <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\r\n            <div id="paragraphadv-back-color-btn"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-font" class="settings-panel">\r\n    <div class="inner-content" style="width: 100%;">\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textEffects %></label>\r\n        </div>\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-subscript"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-double-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-small-caps"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="paragraphadv-checkbox-superscript"></div>\r\n                </td>\r\n                <td class="padding-large padding-left-40">\r\n                    <div id="paragraphadv-checkbox-all-caps"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textCharacterSpacing %></label>\r\n        </div>\r\n        <div class="padding-large">\r\n            <div style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textSpacing %></label>\r\n                <div id="paragraphadv-spin-spacing"></div>\r\n            </div>\r\n            <div class="text-only margin-left-15" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textPosition %></label>\r\n                <div id="paragraphadv-spin-position"></div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textOpenType %></label>\r\n        </div>\r\n        <div class="padding-small">\r\n            <label class="input-label vertical-align-baseline"><%= scope.textLigatures %></label>\r\n            <div id="paragraphadv-cmb-ligatures" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\r\n        </div>\r\n        <div class="doc-content-color" style="outline: 1px solid #cbcbcb;">\r\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-tabs" class="settings-panel">\r\n    <div class="inner-content">\r\n            <div class="padding-large">\r\n                <label class="input-label"><%= scope.textDefault %></label>\r\n                <div id="paraadv-spin-default-tab"></div>\r\n\r\n            </div>\r\n            <div>\r\n                <div class="padding-large margin-right-8 vertical-align-middle" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textTabPosition %></label>\r\n                    <div id="paraadv-spin-tab"></div>\r\n                </div>\r\n                <div class="padding-large margin-right-9 vertical-align-middle" style=" display: inline-block;">\r\n                    <label class="input-label"><%= scope.textAlign %></label>\r\n                    <div id="paraadv-cmb-align"></div>\r\n                </div>\r\n                <div class="padding-large text-only vertical-align-middle" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textLeader %></label>\r\n                    <div id="paraadv-cmb-leader"></div>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <div colspan=3 class="padding-large">\r\n                     <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width: 108px; display: inline-block;"><%= scope.textSet %></button>\r\n                <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\r\n                <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\r\n            </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-margins" class="settings-panel">\r\n    <div class="inner-content">\r\n            <div>\r\n                <div class="padding-small" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="paraadv-number-margin-top"></div>\r\n                </div>\r\n                <div class="padding-small padding-left-15" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="paraadv-number-margin-left"></div>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <div class="padding-small" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="paraadv-number-margin-bottom"></div>\r\n                </div>\r\n                <div class="padding-small padding-left-15" style="display: inline-block;">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="paraadv-number-margin-right"></div>\r\n                </div>\r\n            </div>\r\n    </div>\r\n</div>'})),void 0===Common)Common={};define("common/main/lib/component/TableStyler",[],(function(){"use strict";Common.UI.CellBorder=function(t){var e,i,n,s,o,a=this;a.overwriteStyle=void 0===t.overwriteStyle||t.overwriteStyle,a.maxBorderSize=t.maxBorderSize?t.maxBorderSize:8,a.defaultBorderSize=void 0!==t.defaultBorderSize?t.defaultBorderSize:1,a.defaultBorderColor=t.defaultBorderColor?t.defaultBorderColor:"#ccc",a.col=void 0!==t.col?t.col:-1,a.row=void 0!==t.row?t.row:-1,a.cellPadding=void 0!==t.cellPadding?t.cellPadding:10,a.tablePadding=void 0!==t.tablePadding?t.tablePadding:10,a.X1=void 0!==t.x1?t.x1:0,a.Y1=void 0!==t.y1?t.y1:0,a.X2=void 0!==t.x2?t.x2:0,a.Y2=void 0!==t.y2?t.y2:0,a.numInCell=void 0!==t.numInCell?t.numInCell:-1,a.scale=void 0!==t.scale?t.scale:2,a.rows=void 0!==t.rows?t.rows:2,a.columns=void 0!==t.columns?t.columns:2,a.context=t.context,e=a.defaultBorderSize,i=new Common.Utils.RGBColor(a.defaultBorderColor),n=e,s=i,o=1,a.setBordersSize=function(t){n=t>this.maxBorderSize?this.maxBorderSize:t,o=t<1?.3:1},a.setBordersColor=function(t){var e=t;"string"==typeof t&&(e=new Common.Utils.RGBColor(t)),s=e},a.getBorderSize=function(){return n},a.getBorderColor=function(){return s.toHex()},a.setVirtualBorderSize=function(t){e=t>this.maxBorderSize?this.maxBorderSize:t},a.setVirtualBorderColor=function(t){i=t},a.getVirtualBorderSize=function(){return e},a.getVirtualBorderColor=function(){return i.toHex()},a.scaleBorderSize=function(t){return t*a.scale+.5>>0},a.getLine=function(){var t=a.scaleBorderSize(n);if(a.numInCell<0)return a.Y1==a.Y2?{X1:a.X1>>0,Y1:(a.Y1+t/2>>0)-t/2,X2:a.X2>>0,Y2:(a.Y2+t/2>>0)-t/2}:{X1:(a.X1+t/2>>0)-t/2,Y1:a.Y1>>0,X2:(a.X2+t/2>>0)-t/2,Y2:a.Y2>>0};var e,i=[],s=a.cellPadding*a.scale;if(t*=0===a.numInCell?1:-1,a.Y1==a.Y2){e=(a.X2-a.X1)/a.columns;for(var o=0;o<a.columns;o++)i.push({X1:a.X1+o*e+(o>0|0)*s/2>>0,Y1:(a.Y1>>0)+t/2,X2:a.X1+(o+1)*e-(o<a.columns-1|0)*s/2>>0,Y2:(a.Y1>>0)+t/2})}else{e=(a.Y2-a.Y1)/a.rows;for(var l=0;l<a.rows;l++)i.push({X1:(a.X1>>0)+t/2,Y1:a.Y1+l*e+(l>0|0)*s/2>>0,X2:(a.X1>>0)+t/2,Y2:a.Y1+(l+1)*e-(l<a.rows-1|0)*s/2>>0})}return i},a.inRect=function(t,e){var i=a.scale*a.tablePadding/2,n=a.getLine(),s=t*a.scale,o=e*a.scale;if(a.numInCell<0)return n.Y1==n.Y2?s>n.X1&&s<n.X2&&o>n.Y1-i&&o<n.Y1+i:o>n.Y1&&o<n.Y2&&s>n.X1-i&&s<n.X1+i;if(a.Y1==a.Y2){for(var l=0;l<n.length;l++)if(s>n[l].X1&&s<n[l].X2&&o>n[l].Y1-i&&o<n[l].Y1+i)return!0}else for(l=0;l<n.length;l++)if(o>n[l].Y1&&o<n[l].Y2&&s>n[l].X1-i&&s<n[l].X1+i)return!0;return!1},a.drawBorder=function(){if(0!=n){var t=a.getLine();a.context.beginPath(),a.context.globalAlpha=o,a.context.lineWidth=a.scaleBorderSize(n),a.context.strokeStyle=a.getBorderColor(),a.numInCell<0?(a.context.moveTo(t.X1,t.Y1),a.context.lineTo(t.X2,t.Y2)):_.each(t,(function(t){a.context.moveTo(t.X1,t.Y1),a.context.lineTo(t.X2,t.Y2)})),a.context.stroke(),a.context.globalAlpha=1}},a.setBorderParams=function(){n==e&&i.isEqual(s)&&a.overwriteStyle?a.setBordersSize(0):(a.setBordersSize(e),a.setBordersColor(i))}},Common.UI.TableStyler=Common.UI.BaseView.extend({options:{width:200,height:200,sizeCorner:10,scale:2,row:-1,col:-1,rows:2,columns:2,cellPadding:10,tablePadding:10,overwriteStyle:!0,maxBorderSize:8,spacingMode:!1,defaultBorderSize:1,defaultBorderColor:"#ccc"},template:_.template(['<div id="<%=scope.id%>" class="table-styler" style="position: relative; width: <%=scope.width%>px; height:<%=scope.height%>px;">','<canvas id="<%=scope.id%>-table-canvas"  width ="<%=scope.width * scope.scale%>" height="<%=scope.height * scope.scale%>" style="left: 0; top: 0; width: 100%; height: 100%;">',"</canvas>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e,i,n=this;n.id=n.options.id||Common.UI.getId(),n.scale=Common.Utils.applicationPixelRatio(),n.scale=n.scale>=1?n.scale:1,n.width=(n.options.width*n.scale>>0)/n.scale,n.height=(n.options.height*n.scale>>0)/n.scale,n.rows=n.options.rows,n.columns=n.options.columns,n.cellPadding=n.options.cellPadding,n.tablePadding=n.options.tablePadding,n.overwriteStyle=n.options.overwriteStyle,n.maxBorderSize=n.options.maxBorderSize,n.spacingMode=n.options.spacingMode,n.twoModes=n.options.twoModes,n.defaultBorderSize=n.options.defaultBorderSize,n.defaultBorderColor=n.options.defaultBorderColor,n.sizeCorner=n.options.sizeCorner,n.backgroundColor="transparent",n.backgroundCellColor="transparent",e=n.defaultBorderSize>n.maxBorderSize?n.maxBorderSize:n.defaultBorderSize,i=new Common.Utils.RGBColor(n.defaultBorderColor);var s={top:e,right:e,bottom:e,left:e},o={top:i,right:i,bottom:i,left:i};n.rendered=!1,n.on("render:after",(function(t){n.canv.addEventListener("click",(function(t){var e,i;void 0!==t.offsetX?(e=parseInt(t.offsetX*Common.Utils.zoom()),i=parseInt(t.offsetY*Common.Utils.zoom())):t.layerX&&(e=t.layerX,i=t.layerY);var a=!1;if(n.inRect("t",e,i))n.setBorderParams("t"),a=!0,n.fireEvent("borderclick",n,"t",s.top,o.top.toHex());else if(n.inRect("b",e,i))n.setBorderParams("b"),a=!0,n.fireEvent("borderclick",n,"b",s.bottom,o.bottom.toHex());else if(n.inRect("l",e,i))n.setBorderParams("l"),a=!0,n.fireEvent("borderclick",n,"l",s.left,o.left.toHex());else if(n.inRect("r",e,i))n.setBorderParams("r"),a=!0,n.fireEvent("borderclick",n,"r",s.right,o.right.toHex());else for(var l=0;l<n._cellBorders.length;l++)if(n._cellBorders[l].inRect(e,i)){if(a=!0,n._cellBorders[l].setBorderParams(),n.fireEvent("borderclick:cellborder",n,n._cellBorders[l],n._cellBorders[l].getBorderSize(),n._cellBorders[l].getBorderColor()),n.spacingMode){var r=void 0;n._cellBorders[l].col>0&&0===n._cellBorders[l].numInCell?r=n.getCellBorder(-1,n._cellBorders[l].col-1,1):n._cellBorders[l].row>0&&0===n._cellBorders[l].numInCell?r=n.getCellBorder(n._cellBorders[l].row-1,-1,1):n._cellBorders[l].col>-1&&n._cellBorders[l].col<n.columns-1&&1===n._cellBorders[l].numInCell?r=n.getCellBorder(-1,n._cellBorders[l].col+1,0):n._cellBorders[l].row>-1&&n._cellBorders[l].row<n.rows-1&&1===n._cellBorders[l].numInCell&&(r=n.getCellBorder(n._cellBorders[l].row+1,-1,0)),r&&r.setBorderParams()}break}a&&n.redrawTable()})),$(window).resize(n.resizeTable)})),n.resizeTable=function(){n.context.clearRect(0,0,n.width*n.scale,n.height*n.scale),n.scale=Common.Utils.applicationPixelRatio(),n.scale=n.scale>=1?n.scale:1,n.width=(n.options.width*n.scale>>0)/n.scale,n.height=(n.options.height*n.scale>>0)/n.scale,n.cmpEl.css({width:n.width,height:n.height}),n.cmpEl.parent().css({width:n.width,height:n.height}),n._cellBorders.forEach((function(t){t.scale=n.scale}));var t,e=n.sizeCorner*n.scale,i=n.width*n.scale,s=n.height*n.scale,o=(i-2*e)/n.columns,a=(s-2*e)/n.rows;if(n.spacingMode){var l=n.cellPadding*n.scale;o=(i-2*(e+=l))/n.columns,a=(s-2*e)/n.rows,t=0;for(d=0;d<n.columns;d++)for(var r=0;r<2;r++)n._cellBorders[t].Y1=e,n._cellBorders[t].Y2=s-e,n._cellBorders[t].X1=0==r?d*(o+l/2)+e:n.width*n.scale-e-(n.columns-d-1)*(o+l/2),n._cellBorders[t].X2=n._cellBorders[t].X1,t++;for(c=0;c<n.rows;c++)for(r=0;r<2;r++)n._cellBorders[t].Y1=0==r?c*(a+l/2)+e:n.height*n.scale-e-(n.rows-c-1)*(a+l/2),n._cellBorders[t].Y2=n._cellBorders[t].Y1,n._cellBorders[t].X1=e,n._cellBorders[t].X2=i-e,t++}else{t=0;for(var c=0;c<n.rows-1;c++)n._cellBorders[t].Y1=(c+1)*a+e,n._cellBorders[t].Y2=n._cellBorders[t].Y1,n._cellBorders[t].X1=e,n._cellBorders[t].X2=i-e,t++;for(var d=0;d<n.columns-1;d++)n._cellBorders[t].Y1=e,n._cellBorders[t].Y2=s-e,n._cellBorders[t].X1=(d+1)*o+e,n._cellBorders[t].X2=n._cellBorders[t].X1,t++}n.canv.width=n.width*n.scale,n.canv.height=n.height*n.scale,n.drawTable()},n.getVirtualBorderSize=function(){return e},n.getVirtualBorderColor=function(){return i.toHex()},n.setVirtualBorderSize=function(t){e=t>n.maxBorderSize?n.maxBorderSize:t;for(var i=0;i<n._cellBorders.length;i++)n._cellBorders[i].setVirtualBorderSize(t)},n.setVirtualBorderColor=function(t){var e=new Common.Utils.RGBColor(t);if(!i.isEqual(e)){i=e;for(var s=0;s<n._cellBorders.length;s++)n._cellBorders[s].setVirtualBorderColor(e)}},n.setBordersSize=function(t,e){e=e>n.maxBorderSize?n.maxBorderSize:e,t.indexOf("t")>-1&&(s.top=e),t.indexOf("r")>-1&&(s.right=e),t.indexOf("b")>-1&&(s.bottom=e),t.indexOf("l")>-1&&(s.left=e)},n.scaleBorderSize=function(t){return t*n.scale+.5>>0},n.setBordersColor=function(t,e){var i=new Common.Utils.RGBColor(e);t.indexOf("t")>-1&&(o.top=i),t.indexOf("r")>-1&&(o.right=i),t.indexOf("b")>-1&&(o.bottom=i),t.indexOf("l")>-1&&(o.left=i)},n.getBorderSize=function(t){switch(t){case"t":return s.top;case"r":return s.right;case"b":return s.bottom;case"l":return s.left}return null},n.getBorderColor=function(t){switch(t){case"t":return o.top.toHex();case"r":return o.right.toHex();case"b":return o.bottom.toHex();case"l":return o.left.toHex()}return null},n.getBorderAlpha=function(t){return n.getBorderSize(t)<1?.2:1},n.setBorderParams=function(t){var s=new Common.Utils.RGBColor(n.getBorderColor(t));n.getBorderSize(t)==e&&i.isEqual(s)&&n.overwriteStyle?n.setBordersSize(t,0):(n.setBordersSize(t,n.getVirtualBorderSize()),n.setBordersColor(t,n.getVirtualBorderColor()))},n.getLine=function(t,e){var i=n.sizeCorner*n.scale,s=n.scaleBorderSize(t),o={},a=n.width*n.scale,l=n.height*n.scale;switch(e){case"t":o.X1=i>>0,o.Y1=(i>>0)+s/2,o.X2=a-i>>0,o.Y2=o.Y1;break;case"b":o.X1=i>>0,o.Y1=(l-i>>0)-s/2,o.X2=a-i>>0,o.Y2=o.Y1;break;case"l":o.X1=(i>>0)+s/2,o.Y1=i>>0,o.X2=o.X1,o.Y2=l-i>>0;break;case"r":o.X1=(a-i>>0)-s/2,o.Y1=i>>0,o.X2=o.X1,o.Y2=l-i>>0}return o},n.inRect=function(t,e,i){var s=n.tablePadding/2,o=n.getBorderSize(t),a=n.getLine(o,t);return(a={X1:a.X1/n.scale,Y1:a.Y1/n.scale,X2:a.X2/n.scale,Y2:a.Y2/n.scale}).Y1==a.Y2?e>a.X1&&e<a.X2&&i>a.Y1-s&&i<a.Y1+s:i>a.Y1&&i<a.Y2&&e>a.X1-s&&e<a.X1+s},n.setTableColor=function(t){n.backgroundColor="transparent"==t?t:"#"+t},n.setCellsColor=function(t){n.backgroundCellColor="transparent"==t?t:"#"+t},n.options.el&&n.render(null,{borderSize:s,borderColor:o,virtualBorderSize:e,virtualBorderColor:i})},render:function(t){var e=arguments[1];this.trigger("render:before",this),this.rendered?this.cmpEl=$(this.el):(this.cmpEl=$(this.template(_.extend({scope:this},e))),t?(this.setElement(t,!1),this.setElement(t,!1),t.html(this.cmpEl)):$(this.el).html(this.cmpEl),this.cmpEl.parent().css({width:this.width,height:this.height})),this.canv=$("#"+this.id+"-table-canvas")[0],this.context=this.canv.getContext("2d");var i=this.sizeCorner*this.scale;if(i+=this.spacingMode?this.cellPadding*this.scale:0,!this.rendered){this._cellBorders=[];var n={scale:this.scale,context:this.context,cellPadding:this.cellPadding,tablePadding:this.tablePadding,rows:this.rows,columns:this.columns};!this.spacingMode&&this.createHorizontalBorders(n,i),this.createVerticaLBorders(n,i),this.spacingMode&&this.createHorizontalBorders(n,i),this.drawTable()}return this.rendered=!0,this.trigger("render:after",this),this},createHorizontalBorders:function(t,e){var i=t,n=this.width*this.scale,s=(this.height*this.scale-2*e)/this.rows,o=this.cellPadding*this.scale;if(this.spacingMode)for(l=0;l<this.rows;l++)for(var a=0;a<2;a++)i.numInCell=a,i.y1=0==a?l*(s+o/2)+e:this.height*this.scale-e-(this.rows-l-1)*(s+o/2),i.y2=i.y1,i.x1=e,i.x2=n-e,i.row=l,i.col=-1,this._cellBorders.push(new Common.UI.CellBorder(i));else for(var l=0;l<this.rows-1;l++)i.y1=(l+1)*s+e,i.y2=i.y1,i.x1=e,i.x2=n-e,i.row=l,i.col=-1,this._cellBorders.push(new Common.UI.CellBorder(i))},createVerticaLBorders:function(t,e){var i=t,n=this.height*this.scale,s=(this.width*this.scale-2*e)/this.columns,o=this.cellPadding*this.scale;if(this.spacingMode)for(l=0;l<this.columns;l++)for(var a=0;a<2;a++)i.numInCell=a,i.y1=e,i.y2=n-e,i.x1=0==a?l*(s+o/2)+e:this.width*this.scale-e-(this.columns-l-1)*(s+o/2),i.x2=i.x1,i.col=l,i.row=-1,this._cellBorders.push(new Common.UI.CellBorder(i));else for(var l=0;l<this.columns-1;l++)i.y1=e,i.y2=n-e,i.x1=(l+1)*s+e,i.x2=i.x1,i.row=-1,i.col=l,this._cellBorders.push(new Common.UI.CellBorder(i))},drawCorners:function(){var t=.5*this.scale+.5>>0,e=this.sizeCorner*this.scale,i=this.width*this.scale,n=this.height*this.scale,s=t/2;this.context.setLineDash([t,t]),this.context.lineWidth=t,this.context.strokeStyle="grey",this.context.beginPath(),this.context.moveTo((e>>0)-s,0),this.context.lineTo((e>>0)-s,(e>>0)-s),this.context.moveTo(e>>0,(e>>0)-s),this.context.lineTo(0,(e>>0)-s),this.context.moveTo((i-e>>0)+s,0),this.context.lineTo((i-e>>0)+s,e>>0),this.context.moveTo(i-e>>0,(e>>0)-s),this.context.lineTo(i>>0,(e>>0)-s),this.context.moveTo((i-e>>0)+s,n>>0),this.context.lineTo((i-e>>0)+s,n-e>>0),this.context.moveTo(i-e>>0,(n-e>>0)+s),this.context.lineTo(i>>0,(n-e>>0)+s),this.context.moveTo((e>>0)-s,n>>0),this.context.lineTo((e>>0)-s,n-e>>0),this.context.moveTo(e>>0,(n-e>>0)+s),this.context.lineTo(0,(n-e>>0)+s),this.context.stroke(),this.context.setLineDash([])},fillCells:function(){if(this.spacingMode&&"transparent"!=this.backgroundCellColor){var t=(this.sizeCorner+this.cellPadding)*this.scale,e=this.cellPadding*this.scale,i=(this.width*this.scale-2*t)/this.columns,n=(this.height*this.scale-2*t)/this.rows;this.context.beginPath(),this.context.fillStyle=this.backgroundCellColor;for(var s=0;s<this.rows;s++)for(var o=0;o<this.columns;o++)this.context.fillRect(t+o*i+(o>0|0)*e/2>>0,t+s*n+(s>0|0)*e/2>>0,i-((o>0|0)+(o<this.columns-1|0))*e/2>>0,n-((s>0|0)+(s<this.rows-1|0))*e/2>>0);this.context.stroke()}},drawBorder:function(t){var e=this.getBorderSize(t);if(e){var i=this.getLine(e,t);this.context.imageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1,this.context.msImageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.lineWidth=this.scaleBorderSize(e),this.context.globalAlpha=this.getBorderAlpha(t),this.context.beginPath(),this.context.strokeStyle=this.getBorderColor(t),this.context.moveTo(i.X1,i.Y1),this.context.lineTo(i.X2,i.Y2),this.context.stroke(),this.context.globalAlpha=1}},fillWithLines:function(){var t,e,i,n,s,o,a,l,r,c=this.maxBorderSize+4,d=2*this.scale+.5>>0;if(this.context.setLineDash([d,d]),this.context.strokeStyle="#c0c0c0",this.spacingMode){var h=(this.sizeCorner+this.cellPadding)*this.scale,p=this.cellPadding*this.scale;t=(this.width*this.scale-2*h)/this.columns,e=(this.height*this.scale-2*h)/this.rows,c*=this.scale,this.context.beginPath(),this.context.fillStyle=this.backgroundCellColor;for(m=0;m<this.rows;m++)for(u=0;u<this.columns;u++)a=t-((u>0|0)+(u<this.columns-1|0))*p/2-2*c+.5>>0,r=2*((r=e-((m>0|0)+(m<this.rows-1|0))*p/2-2*c)/(2*d)>>0)*d+d,o=h+u*t+(u>0|0)*p/2+c>>0,l=h+m*e+(m>0|0)*p/2+c,this.context.beginPath(),this.context.lineWidth=a,this.context.moveTo(o+a/2,l>>0),this.context.lineTo(o+a/2,l+r>>0),this.context.stroke()}else{t=(this.width-2*this.sizeCorner)/this.columns,e=(this.height-2*this.sizeCorner)/this.rows,n=this.sizeCorner,s=this.sizeCorner;for(var m=0;m<this.rows;m++){i=s;for(var u=0;u<this.columns;u++)o=(i+c)*this.scale>>0,l=(n+c)*this.scale,a=(t-2*c)*this.scale+.5>>0,r=2*((r=(e-2*c)*this.scale)/(2*d)>>0)*d+d,this.context.lineWidth=a,this.context.beginPath(),this.context.moveTo(o+a/2,l>>0),this.context.lineTo(o+a/2,l+r>>0),this.context.stroke(),i+=t;n+=e}}this.context.setLineDash([])},drawTable:function(){this.drawCorners();var t=this.sizeCorner*this.scale,e=this.width*this.scale-2*t>>0,i=this.height*this.scale-2*t>>0;this.context.fillStyle=this.backgroundColor,"transparent"!=this.backgroundColor&&(this.context.beginPath(),this.context.fillRect(t>>0,t>>0,e,i),this.context.stroke()),this.fillCells(),this._cellBorders.forEach((function(t){t.drawBorder()})),this.drawBorder("l"),this.drawBorder("r"),this.drawBorder("t"),this.drawBorder("b"),this.fillWithLines(),this.context.lineWidth=0},redrawTable:function(){this.context.clearRect(0,0,this.canv.width,this.canv.height),this.drawTable()},getCellBorder:function(t,e,i){return t=void 0===t?-1:t,e=void 0===e?-1:e,i=void 0===i?-1:i,_.findWhere(this._cellBorders,{row:t,col:e,numInCell:i})}})})),define("documenteditor/main/app/view/ParagraphSettingsAdvanced",["text!documenteditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/component/TableStyler","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,contentHeight:340,toggleGroup:"paragraph-adv-settings-group",storageName:"de-para-settings-adv-category"},initialize:function(e){var i=this;_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-line",panelCaption:this.strParagraphLine},{panelId:"id-adv-paragraph-borders",panelCaption:this.strBorders},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs},{panelId:"id-adv-paragraph-margins",panelCaption:this.strMargins}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.Borders={},this.BorderSize={ptValue:0,pxValue:0},this.paragraphShade="transparent",this._changedProps=null,this.ChangedBorders=void 0,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.Margins=void 0,this.FirstLine=void 0,this.LeftIndent=void 0,this.Spacing=null,this.spinners=[],this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.borderProps=this.options.borderProps,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this.isChart=this.options.isChart,this.isSmartArtInternal=this.options.isSmartArtInternal,this.CurLineRuleIdx=this._originalProps.get_Spacing().get_LineRule(),this._arrLineRule=[{displayValue:this.textAtLeast,defaultValue:5,value:c_paragraphLinerule.LINERULE_LEAST,minValue:.03,step:.01,defaultUnit:"cm"},{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this.CurSpecial=void 0,this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrOutlinelevel=[{displayValue:this.textBodyText,value:-1}];for(var n=0;n<9;n++)this._arrOutlinelevel.push({displayValue:this.textLevel+" "+(n+1),value:n});this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach((function(t){i._arrKeyTabAlign[t.value]=t.displayValue})),this._arrTabLeader=[{value:Asc.c_oAscTabLeader.None,cls:"",displayValue:this.textNone},{value:Asc.c_oAscTabLeader.Dot,cls:"font-sans-serif",displayValue:"...................."},{value:Asc.c_oAscTabLeader.Hyphen,cls:"font-sans-serif",displayValue:"-----------------"},{value:Asc.c_oAscTabLeader.MiddleDot,cls:"font-sans-serif",displayValue:""},{value:Asc.c_oAscTabLeader.Underscore,cls:"font-sans-serif",displayValue:"__________"}],this._arrKeyTabLeader=[],this._arrTabLeader.forEach((function(t){i._arrKeyTabLeader[t.value]=t.displayValue}))},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numIndentsLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numIndentsRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numIndentsRight),this.lblIndentsLeft=$("#paragraphadv-lbl-indent-left"),this.lblIndentsRight=$("#paragraphadv-lbl-indent-right"),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind((function(t,e,i,n){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}var o=t.getNumberValue();this.Spacing.put_Before(o<0?-1:Common.Utils.Metric.fnRecalcToMM(o))}),this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind((function(t,e,i,n){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}var o=t.getNumberValue();this.Spacing.put_After(o<0?-1:Common.Utils.Metric.fnRecalcToMM(o))}),this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.chAddInterval=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-add-interval"),labelText:this.strSomeParagraphSpace}),this.chAddInterval.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.asc_putContextualSpacing("checked"==t.getValue())}),this)),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.cmbTextAlignment.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putJc(e.value>-1?e.value:null)}),this)),this.cmbOutlinelevel=new Common.UI.ComboBox({el:$("#paragraphadv-spin-outline-level"),cls:"input-group-nr",editable:!1,data:this._arrOutlinelevel,style:"width: 174px;",menuStyle:"min-width: 174px;",takeFocusOnClose:!0}),this.cmbOutlinelevel.setValue(-1),this.cmbOutlinelevel.on("selected",_.bind(this.onOutlinelevelSelect,this)),this.rbDirLtr=new Common.UI.RadioBox({el:$("#paragraphadv-dir-ltr"),name:"text-dir",labelText:this.textDirLtr,value:!1}),this.rbDirLtr.on("change",_.bind(this.onTextDirChange,this)),this.rbDirRtl=new Common.UI.RadioBox({el:$("#paragraphadv-dir-rtl"),name:"text-dir",labelText:this.textDirRtl,value:!0}),this.rbDirRtl.on("change",_.bind(this.onTextDirChange,this)),this.chBreakBefore=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-break-before"),labelText:this.strBreakBefore}),this.chBreakBefore.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_PageBreakBefore("checked"==t.getValue())}),this)),this.chKeepLines=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-keep-lines"),labelText:this.strKeepLines}),this.chKeepLines.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_KeepLines("checked"==t.getValue())}),this)),this.chOrphan=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-orphan"),labelText:this.strOrphan}),this.chOrphan.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_WidowControl("checked"==t.getValue())}),this)),this.chKeepNext=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-keep-next"),labelText:this.strKeepNext}),this.chKeepNext.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_KeepNext("checked"==t.getValue())}),this)),this.chLineNumbers=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-suppress-line-numbers"),labelText:this.strSuppressLineNumbers}),this.chLineNumbers.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_SuppressLineNumbers("checked"==t.getValue())}),this)),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#paragraphadv-combo-border-size"),style:"width: 93px;",takeFocusOnClose:!0});var e=this.cmbBorderSize.store.at(2);this.BorderSize={ptValue:e.get("value"),pxValue:e.get("pxValue")},this.cmbBorderSize.setValue(this.BorderSize.ptValue),this.cmbBorderSize.on("selected",_.bind(this.onBorderSizeSelect,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#paragraphadv-border-color-btn"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,takeFocusOnClose:!0}),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBorderColor.on("color:select",_.bind(this.onColorsBorderSelect,this)),this.btnBorderColor.on("auto:select",_.bind(this.onColorsBorderSelect,this)),this.BordersImage=new Common.UI.TableStyler({el:$("#id-deparagraphstyler"),width:200,height:170,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1});var i=[["lrtb","toolbar__icon toolbar__icon-big btn-paragraph-borders-outer","paragraphadv-button-border-outer",this.tipOuter],["lrtbm","toolbar__icon toolbar__icon-big btn-paragraph-borders-all","paragraphadv-button-border-all",this.tipAll],["","toolbar__icon toolbar__icon-big btn-paragraph-borders-none","paragraphadv-button-border-none",this.tipNone],["l","toolbar__icon toolbar__icon-big btn-paragraph-borders-left","paragraphadv-button-border-left",this.tipLeft],["r","toolbar__icon toolbar__icon-big btn-paragraph-borders-right","paragraphadv-button-border-right",this.tipRight],["t","toolbar__icon toolbar__icon-big btn-paragraph-borders-top","paragraphadv-button-border-top",this.tipTop],["m","toolbar__icon toolbar__icon-big btn-paragraph-borders-inner","paragraphadv-button-border-inner-hor",this.tipInner],["b","toolbar__icon toolbar__icon-big btn-paragraph-borders-bottom","paragraphadv-button-border-bottom",this.tipBottom]];this._btnsBorderPosition=[],_.each(i,(function(t,e,i){var n=new Common.UI.Button({parentEl:$("#"+t[2]),cls:"btn-options large border-off",iconCls:t[1],strId:t[0],hint:t[3]});n.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsBorderPosition.push(n)}),this),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#paragraphadv-back-color-btn"),transparent:!0,additionalAlign:this.menuAddAlign,takeFocusOnClose:!0}),this.colorsBack=this.btnBackColor.getPicker(),this.btnBackColor.on("color:select",_.bind(this.onColorsBackSelect,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:90,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind((function(t,e,i,n){if(this._changedProps&&this._changedProps.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}}),this)),this.spinners.push(this.numSpacing),this.numPosition=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-position"),step:.01,width:90,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numPosition.on("change",_.bind((function(t,e,i,n){if(this._changedProps&&this._changedProps.put_Position(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Position(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}}),this)),this.spinners.push(this.numPosition),this._arrLigatures=[{displayValue:this.textNone,value:Asc.LigaturesType.None},{displayValue:this.textStandard,value:Asc.LigaturesType.Standard},{displayValue:this.textContext,value:Asc.LigaturesType.Contextual},{displayValue:this.textHistorical,value:Asc.LigaturesType.Historical},{displayValue:this.textDiscret,value:Asc.LigaturesType.Discretional},{displayValue:this.textStandardContext,value:Asc.LigaturesType.StandardContextual},{displayValue:this.textStandardHistorical,value:Asc.LigaturesType.StandardHistorical},{displayValue:this.textContextHistorical,value:Asc.LigaturesType.ContextualHistorical},{displayValue:this.textStandardDiscret,value:Asc.LigaturesType.StandardDiscretional},{displayValue:this.textContextDiscret,value:Asc.LigaturesType.ContextualDiscretional},{displayValue:this.textHistoricalDiscret,value:Asc.LigaturesType.HistoricalDiscretional},{displayValue:this.textStandardContextHist,value:Asc.LigaturesType.StandardContextualHistorical},{displayValue:this.textStandardContextDiscret,value:Asc.LigaturesType.StandardContextualDiscretional},{displayValue:this.textStandardHistDiscret,value:Asc.LigaturesType.StandardHistoricalDiscretional},{displayValue:this.textContextHistDiscret,value:Asc.LigaturesType.ContextualHistoricalDiscretional},{displayValue:this.textAll,value:Asc.LigaturesType.All}],this.cmbLigatures=new Common.UI.ComboBox({el:$("#paragraphadv-cmb-ligatures"),cls:"input-group-nr",editable:!1,data:this._arrLigatures,style:"width: 210px;",menuStyle:"min-width: 210px;max-height:135px;",takeFocusOnClose:!0}),this.cmbLigatures.setValue(Asc.LigaturesType.None),this.cmbLigatures.on("selected",_.bind(this.onLigaturesSelect,this)),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_DefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))}),this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width:117px;display: inline-block;"><%= value %></div>','<div style="width:121px;display: inline-block;"><%= displayTabAlign %></div>',this.isChart||this.isSmartArtInternal?"":'<div style="width:96px;display: inline-block;"><%= displayTabLeader %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));var n=function(){t._noApply||(t._tabListChanged=!0)};this.listenTo(this.tabList.store,"add",n),this.listenTo(this.tabList.store,"remove",n),this.listenTo(this.tabList.store,"reset",n),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.cmbLeader=new Common.UI.ComboBoxCustom({el:$("#paraadv-cmb-leader"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabLeader,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>" class="<%= item.cls %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join("")),updateFormControl:function(t){this._input&&this._input.toggleClass("font-sans-serif",t.get("value")!==Asc.c_oAscTabLeader.None)},takeFocusOnClose:!0}),this.cmbLeader.setValue(Asc.c_oAscTabLeader.None),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Top=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Bottom=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Left=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#paraadv-number-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,i,n){this._noApply||(void 0===this.Margins&&(this.Margins={}),this.Margins.Right=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnMarginRight),this.TextOnlySettings=$(".text-only"),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.cmbTextAlignment,this.cmbOutlinelevel,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.chAddInterval,this.rbDirLtr,this.rbDirRtl,this.chBreakBefore,this.chKeepLines,this.chOrphan,this.chKeepNext,this.chLineNumbers,this.cmbBorderSize,this.btnBorderColor]).concat(this._btnsBorderPosition).concat([this.btnBackColor,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numPosition,this.numDefaultTab,this.numTab,this.cmbAlign,this.cmbLeader,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight]).concat(this.getFooterButtons())},onCategoryClick:function(t,e,i,n){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var s=this;setTimeout((function(){switch(e){case 0:s.cmbTextAlignment.focus();break;case 1:s.chBreakBefore.focus();break;case 2:s.cmbBorderSize.focus();break;case 3:s.chStrike.focus(),n&&n instanceof jQuery.Event&&s.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s._originalProps||new Asc.asc_CParagraphProperty);break;case 4:s.numDefaultTab.focus();break;case 5:s.spnMarginTop.focus()}}),10)},onAnimateAfter:function(){3==this.getActiveCategory()&&this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){if(null===this.ChangedBorders?this._changedProps.put_Borders(this.Borders):void 0!==this.ChangedBorders&&this._changedProps.put_Borders(this.ChangedBorders),this.Margins){var t=this._changedProps.get_Borders();null==t&&(this._changedProps.put_Borders(new Asc.asc_CParagraphBorders),t=this._changedProps.get_Borders()),void 0!==this.Margins.Left&&(void 0!==t.get_Left()&&null!==t.get_Left()||t.put_Left(new Asc.asc_CTextBorder(this.Borders.get_Left())),t.get_Left().put_Space(this.Margins.Left)),void 0!==this.Margins.Top&&(void 0!==t.get_Top()&&null!==t.get_Top()||t.put_Top(new Asc.asc_CTextBorder(this.Borders.get_Top())),t.get_Top().put_Space(this.Margins.Top)),void 0!==this.Margins.Right&&(void 0!==t.get_Right()&&null!==t.get_Right()||t.put_Right(new Asc.asc_CTextBorder(this.Borders.get_Right())),t.get_Right().put_Space(this.Margins.Right)),void 0!==this.Margins.Bottom&&(void 0!==t.get_Bottom()&&null!==t.get_Bottom()||t.put_Bottom(new Asc.asc_CTextBorder(this.Borders.get_Bottom())),t.get_Bottom().put_Space(this.Margins.Bottom),void 0!==t.get_Between()&&null!==t.get_Between()||t.put_Between(new Asc.asc_CTextBorder(this.Borders.get_Between())),t.get_Between().put_Space(this.Margins.Bottom))}if(this._tabListChanged&&(null!==this._changedProps.get_Tabs()&&void 0!==this._changedProps.get_Tabs()||this._changedProps.put_Tabs(new Asc.asc_CParagraphTabs),this.tabList.store.each((function(t,e){var i=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"),t.get("tabLeader"));this._changedProps.get_Tabs().add_Tab(i)}),this)),null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()){var e=this._changedProps.get_Ind().get_Left(),i=this._changedProps.get_Ind().get_FirstLine();void 0===e&&void 0===i||!(i<0||this.FirstLine<0)||(i<0||null==i?(null==i&&(i=this.FirstLine),null==e&&(e=this.LeftIndent),null!=e&&this._changedProps.get_Ind().put_Left(e-i)):(null==e&&(e=this.LeftIndent),null!=e&&this._changedProps.get_Ind().put_Left(e)))}return null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing),{paragraphProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.hideTextOnlySettings(this.isChart||this.isSmartArtInternal),this.FirstLine=null!==t.get_Ind()?t.get_Ind().get_FirstLine():null,this.LeftIndent=null!==t.get_Ind()?t.get_Ind().get_Left():null,this.FirstLine<0&&null!==this.LeftIndent&&(this.LeftIndent=this.LeftIndent+this.FirstLine),this.numIndentsLeft.setValue(null!==this.LeftIndent?Common.Utils.Metric.fnRecalcFromMM(this.LeftIndent):"",!0),this.numIndentsRight.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Right()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Right()):"",!0);var e=t.get_Spacing()?t.get_Spacing().get_Before():null;this.numSpacingBefore.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0),e=t.get_Spacing()?t.get_Spacing().get_After():null,this.numSpacingAfter.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0);var i=t.get_Spacing().get_LineRule();if(this.cmbLineRule.setValue(null!==i?i:""),null!==t.get_Spacing()&&null!==t.get_Spacing().get_Line()?this.numLineHeight.setValue(i==c_paragraphLinerule.LINERULE_AUTO?t.get_Spacing().get_Line():Common.Utils.Metric.fnRecalcFromMM(t.get_Spacing().get_Line()),!0):this.numLineHeight.setValue("",!0),this.chAddInterval.setValue(null!==t.get_ContextualSpacing()&&void 0!==t.get_ContextualSpacing()?t.get_ContextualSpacing():"indeterminate",!0),void 0===this.CurSpecial&&(this.CurSpecial=0===t.get_Ind().get_FirstLine()?c_paragraphSpecial.NONE_SPECIAL:t.get_Ind().get_FirstLine()>0?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0),void 0!==(e=t.asc_getRtlDirection())&&(this.rbDirRtl.setValue(e,!0),this.rbDirLtr.setValue(!e,!0)),this.lblIndentsLeft.text(e?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(e?this.strIndentsSpacingAfter:this.strIndentsRightText),this.cmbTextAlignment.setValue(void 0!==t.get_Jc()&&null!==t.get_Jc()?t.get_Jc():""),this.chKeepLines.setValue(null!==t.get_KeepLines()&&void 0!==t.get_KeepLines()?t.get_KeepLines():"indeterminate",!0),this.chBreakBefore.setValue(null!==t.get_PageBreakBefore()&&void 0!==t.get_PageBreakBefore()?t.get_PageBreakBefore():"indeterminate",!0),this.chKeepNext.setValue(null!==t.get_KeepNext()&&void 0!==t.get_KeepNext()?t.get_KeepNext():"indeterminate",!0),this.chOrphan.setValue(null!==t.get_WidowControl()&&void 0!==t.get_WidowControl()?t.get_WidowControl():"indeterminate",!0),this.chLineNumbers.setValue(null!==t.get_SuppressLineNumbers()&&void 0!==t.get_SuppressLineNumbers()?t.get_SuppressLineNumbers():"indeterminate",!0),this.Borders=new Asc.asc_CParagraphBorders(t.get_Borders()),this.Borders){var n=this.Borders.get_Left(),s=null!=n&&null!==n.get_Space()&&void 0!==n.get_Space()?Common.Utils.Metric.fnRecalcFromMM(n.get_Space()):"";this.spnMarginLeft.setValue(s,!0),s=null!=(n=this.Borders.get_Top())&&null!==n.get_Space()&&void 0!==n.get_Space()?Common.Utils.Metric.fnRecalcFromMM(n.get_Space()):"",this.spnMarginTop.setValue(s,!0),s=null!=(n=this.Borders.get_Right())&&null!==n.get_Space()&&void 0!==n.get_Space()?Common.Utils.Metric.fnRecalcFromMM(n.get_Space()):"",this.spnMarginRight.setValue(s,!0),s=null!=(n=this.Borders.get_Bottom())&&null!==n.get_Space()&&void 0!==n.get_Space()?Common.Utils.Metric.fnRecalcFromMM(n.get_Space()):"",this.spnMarginBottom.setValue(s,!0)}var o=t.get_Shade();if(null!=o&&o.get_Value()===Asc.c_oAscShdClear){var a=o.get_Color();a?a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.paragraphShade={color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}:this.paragraphShade=Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()):this.paragraphShade="transparent"}else this.paragraphShade="transparent";this.btnBackColor.setColor(this.paragraphShade),Common.Utils.ThemeColor.selectPickerColorByEffect(this.paragraphShade,this.colorsBack),this._UpdateBorders(),this._noApply=!0,this.chStrike.setValue(null!==t.get_Strikeout()&&void 0!==t.get_Strikeout()?t.get_Strikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.get_DStrikeout()&&void 0!==t.get_DStrikeout()?t.get_DStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.get_Subscript()&&void 0!==t.get_Subscript()?t.get_Subscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.get_Superscript()&&void 0!==t.get_Superscript()?t.get_Superscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.get_SmallCaps()&&void 0!==t.get_SmallCaps()?t.get_SmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.get_AllCaps()&&void 0!==t.get_AllCaps()?t.get_AllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.get_TextSpacing()&&void 0!==t.get_TextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.get_TextSpacing()):"",!0),this.numPosition.setValue(null!==t.get_Position()&&void 0!==t.get_Position()?Common.Utils.Metric.fnRecalcFromMM(t.get_Position()):"",!0),this.numDefaultTab.setValue(null!==t.get_DefaultTab()&&void 0!==t.get_DefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.get_DefaultTab().toFixed(1))):"",!0);var l=this.tabList.store,r=t.get_Tabs();if(r){for(var c=[],d=r.get_Count(),h=0;h<d;h++){var p=r.get_Tab(h),m=Common.Utils.Metric.fnRecalcFromMM(parseFloat(p.get_Pos().toFixed(1))),u=new Common.UI.DataViewModel;u.set({tabPos:m,value:parseFloat(m.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:p.get_Value(),tabLeader:p.get_Leader(),displayTabLeader:this._arrKeyTabLeader[p.get_Leader()],displayTabAlign:this._arrKeyTabAlign[p.get_Value()]}),c.push(u)}l.reset(c,{silent:!1}),this.tabList.selectByIndex(0)}this.cmbOutlinelevel.setValue(void 0===t.get_OutlineLvl()||null===t.get_OutlineLvl()?-1:t.get_OutlineLvl()),this.cmbOutlinelevel.setDisabled(!!t.get_OutlineLvlStyle()),this.cmbLigatures.setValue(void 0===t.get_Ligatures()||null===t.get_Ligatures()?"":t.get_Ligatures()),this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty,this.ChangedBorders=void 0}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-position"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}if(this._arrLineRule[2].defaultUnit=this._arrLineRule[0].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[2].minValue=this._arrLineRule[0].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[2].step=this._arrLineRule[0].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx){var i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0];this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step)}},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this._originalProps);var t="object"==typeof this.paragraphShade?this.paragraphShade.color:this.paragraphShade;if(this.BordersImage.setTableColor(t),"transparent"!=t&&this.BordersImage.redrawTable(),void 0!==this.borderProps){this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor),this.BordersImage.setVirtualBorderColor("object"==typeof this.btnBorderColor.color?this.btnBorderColor.color.color:this.btnBorderColor.color),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue);var e=this.cmbBorderSize.getSelectedRecord();e&&this.onBorderSizeSelect(this.cmbBorderSize,e)}if(this.BordersImage.on("borderclick:cellborder",(function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateCellBordersStyle(t,e,i,n,this.Borders)}),this),this.BordersImage.on("borderclick",(function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateTableBordersStyle(t,e,i,n,this.Borders)}),this),this.storageName){var i=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==i?parseInt(i):0)}},onStrikeChange:function(t,e,i,n){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_Strikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.put_DStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Strikeout("checked"==t.getValue()),s.put_DStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onDoubleStrikeChange:function(t,e,i,n){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_DStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.put_Strikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_DStrikeout("checked"==t.getValue()),s.put_Strikeout("checked"==this.chStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSuperscriptChange:function(t,e,i,n){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Superscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.put_Subscript(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Superscript("checked"==t.getValue()),s.put_Subscript("checked"==this.chSubscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSubscriptChange:function(t,e,i,n){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Subscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.put_Superscript(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Subscript("checked"==t.getValue()),s.put_Superscript("checked"==this.chSuperscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSmallCapsChange:function(t,e,i,n){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_SmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.put_AllCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_SmallCaps("checked"==t.getValue()),s.put_AllCaps("checked"==this.chAllCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onAllCapsChange:function(t,e,i,n){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_AllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.put_SmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_AllCaps("checked"==t.getValue()),s.put_SmallCaps("checked"==this.chSmallCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onBorderSizeSelect:function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.BordersImage.setVirtualBorderSize(this.BorderSize.pxValue)},onColorsBorderSelect:function(t,e){this.BordersImage.setVirtualBorderColor("object"==typeof e?e.color:e)},onColorsBackSelect:function(t,e){this.paragraphShade=e,this._changedProps&&(void 0!==this._changedProps.get_Shade()&&null!==this._changedProps.get_Shade()||this._changedProps.put_Shade(new Asc.asc_CParagraphShd),"transparent"==this.paragraphShade?this._changedProps.get_Shade().put_Value(Asc.c_oAscShdNil):(this._changedProps.get_Shade().put_Value(Asc.c_oAscShdClear),this._changedProps.get_Shade().put_Color(Common.Utils.ThemeColor.getRgbColor(this.paragraphShade))));var i="object"==typeof e?e.color:e;this.BordersImage.setTableColor(i),this.BordersImage.redrawTable()},_ApplyBorderPreset:function(t){var e=t.options.strId;this.ChangedBorders=null,this.Borders.put_Left(this._UpdateBorderStyle(this.Borders.get_Left(),e.indexOf("l")>-1)),this.Borders.put_Top(this._UpdateBorderStyle(this.Borders.get_Top(),e.indexOf("t")>-1)),this.Borders.put_Right(this._UpdateBorderStyle(this.Borders.get_Right(),e.indexOf("r")>-1)),this.Borders.put_Bottom(this._UpdateBorderStyle(this.Borders.get_Bottom(),e.indexOf("b")>-1)),this.Borders.put_Between(this._UpdateBorderStyle(this.Borders.get_Between(),e.indexOf("m")>-1)),this._UpdateBorders()},_UpdateBorderStyle:function(t,e){if(null==t&&(t=new Asc.asc_CTextBorder),e&&this.BorderSize.ptValue>0){var i,n=parseFloat(this.BorderSize.ptValue);t.put_Value(1),t.put_Size(25.4*n/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)}else t.put_Color(new Asc.asc_CColor),t.put_Value(0);return t},_UpdateCellBordersStyle:function(t,e,i,n,s){var o=s;o.put_Between(this._UpdateBorderStyle(o.get_Between(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Between(new Asc.asc_CTextBorder(o.get_Between()))},_UpdateTableBordersStyle:function(t,e,i,n,s){var o=s;e.indexOf("l")>-1&&(o.put_Left(this._UpdateBorderStyle(o.get_Left(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Left(new Asc.asc_CTextBorder(o.get_Left()))),e.indexOf("t")>-1&&(o.put_Top(this._UpdateBorderStyle(o.get_Top(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Top(new Asc.asc_CTextBorder(o.get_Top()))),e.indexOf("r")>-1&&(o.put_Right(this._UpdateBorderStyle(o.get_Right(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Right(new Asc.asc_CTextBorder(o.get_Right()))),e.indexOf("b")>-1&&(o.put_Bottom(this._UpdateBorderStyle(o.get_Bottom(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom())))},_UpdateBorders:function(){var t=this.BorderSize,e=this.btnBorderColor.color;if(this._UpdateBorder(this.Borders.get_Left(),"l"),this._UpdateBorder(this.Borders.get_Top(),"t"),this._UpdateBorder(this.Borders.get_Right(),"r"),this._UpdateBorder(this.Borders.get_Bottom(),"b"),null!==this.Borders.get_Between())for(var i=0;i<this.BordersImage.rows-1;i++)this._UpdateCellBorder(this.Borders.get_Between(),this.BordersImage.getCellBorder(i,-1));this.BordersImage.setVirtualBorderSize(t.pxValue),this.BordersImage.setVirtualBorderColor("object"==typeof e?e.color:e),this.BordersImage.redrawTable()},_UpdateCellBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor(new Common.Utils.RGBColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")"))):e.setBordersSize(0)},_UpdateBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(this.BordersImage.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.BordersImage.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.BordersImage.setBordersSize(e,0)},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},addTab:function(t,e){var i=this.numTab.getNumberValue(),n=this.cmbAlign.getValue(),s=this.cmbLeader.getValue(),o=this._arrKeyTabAlign[n],a=this._arrKeyTabLeader[s],l=this.tabList.store,r=l.find((function(t){return Math.abs(t.get("tabPos")-i)<.001}));r?(r.set("tabAlign",n),r.set("tabLeader",s),r.set("displayTabAlign",o),r.set("displayTabLeader",a),this._tabListChanged=!0):((r=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:n,tabLeader:s,displayTabLeader:a,displayTabAlign:o}),l.add(r)),this.tabList.selectRecord(r),this.tabList.scrollToRecord(r)},removeTab:function(t,e){var i=this.tabList.getSelectedRec();if(i){var n=this.tabList.store,s=_.indexOf(n.models,i);n.remove(i),s>n.length-1&&(s=n.length-1),n.length>0&&(this.tabList.selectByIndex(s),this.tabList.scrollToRecord(n.at(s)))}},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var n={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;n=i.toJSON()}else n=i;this.numTab.setValue(n.tabPos),this.cmbAlign.setValue(n.tabAlign),this.cmbLeader.setValue(n.tabLeader)}},hideTextOnlySettings:function(t){this.TextOnlySettings.toggleClass("hidden",1==t),this.btnsCategory[1].setVisible(!t),this.btnsCategory[2].setVisible(!t),this.btnsCategory[5].setVisible(!t)},onLineRuleSelect:function(t,e){if(null===this.Spacing){var i=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=i.get_Spacing()}if(this.Spacing.put_LineRule(e.value),this.CurLineRuleIdx!==this.Spacing.get_LineRule()){this.numLineHeight.setDefaultUnit(this._arrLineRule[e.value].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[e.value].minValue),this.numLineHeight.setStep(this._arrLineRule[e.value].step);var n=this.numLineHeight.getNumberValue();this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[e.value].defaultValue):this.CurLineRuleIdx===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[e.value].defaultValue)):this.numLineHeight.setValue(n),this.CurLineRuleIdx=e.value}},onNumLineHeightChange:function(t,e,i,n){if(""!==this.cmbLineRule.getRawValue()){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}},onSpecialSelect:function(t,e){if(this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue());0===i&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.get_Ind().put_FirstLine(i)}},onFirstLineChange:function(t,e,i,n){if(this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var s=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue());this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&s>0?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===s?(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)):this.CurSpecial===c_paragraphSpecial.HANGING&&(s=-s),this._changedProps.get_Ind().put_FirstLine(s)}},onOutlinelevelSelect:function(t,e){this._changedProps&&this._changedProps.put_OutlineLvl(e.value>-1?e.value:null)},onLigaturesSelect:function(t,e){this._changedProps&&this._changedProps.put_Ligatures(e.value)},onTextDirChange:function(t,e,i){e&&this._changedProps&&(this._changedProps.asc_putRtlDirection(t.options.value),this.lblIndentsLeft.text(t.options.value?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(t.options.value?this.strIndentsSpacingAfter:this.strIndentsRightText))},textTitle:"Paragraph - Advanced Settings",strIndentsLeftText:"Left",strIndentsRightText:"Right",strParagraphIndents:"Indents & Spacing",strParagraphPosition:"Placement",strParagraphFont:"Font",strBreakBefore:"Page break before",strKeepLines:"Keep lines together",strBorders:"Borders & Fill",textBorderWidth:"Border Size",textBorderColor:"Border Color",textBackColor:"Background Color",textBorderDesc:"Click on diagramm or use buttons to select borders",txtNoBorders:"No borders",textEffects:"Effects",textCharacterSpacing:"Character Spacing",textSpacing:"Spacing",textPosition:"Position",strDoubleStrike:"Double strikethrough",strStrike:"Strikethrough",strSuperscript:"Superscript",strSubscript:"Subscript",strSmallCaps:"Small caps",strAllCaps:"All caps",strOrphan:"Orphan control",strKeepNext:"Keep with next",strTabs:"Tab",textSet:"Specify",textRemove:"Remove",textRemoveAll:"Remove All",textTabLeft:"Left",textTabRight:"Right",textTabCenter:"Center",textAlign:"Alignment",textTabPosition:"Tab Position",textDefault:"Default Tab",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",strMargins:"Margins",tipTop:"Set Top Border Only",tipLeft:"Set Left Border Only",tipBottom:"Set Bottom Border Only",tipRight:"Set Right Border Only",tipAll:"Set Outer Border and All Inner Lines",tipNone:"Set No Borders",tipInner:"Set Horizontal Inner Lines Only",tipOuter:"Set Outer Border Only",noTabs:"The specified tabs will appear in this field",textLeader:"Leader",textNone:"None",strParagraphLine:"Line & Page Breaks",strIndentsSpacingBefore:"Before",strIndentsSpacingAfter:"After",strIndentsLineSpacing:"Line Spacing",txtAutoText:"Auto",textAuto:"Multiple",textAtLeast:"At least",textExact:"Exactly",strSomeParagraphSpace:"Don't add interval between paragraphs of the same style",strIndentsSpecial:"Special",textNoneSpecial:"(none)",textFirstLine:"First line",textHanging:"Hanging",textJustified:"Justified",textBodyText:"Basic Text",textLevel:"Level",strIndentsOutlinelevel:"Outline level",strIndent:"Indents",strSpacing:"Spacing",strSuppressLineNumbers:"Suppress line numbers",textOpenType:"OpenType Features",textLigatures:"Ligatures",textStandard:"Standard only",textContext:"Contextual",textHistorical:"Historical",textDiscret:"Discretionary",textStandardContext:"Standard and Contextual",textStandardHistorical:"Standard and Historical",textStandardDiscret:"Standard and Discretionary",textContextHistorical:"Contextual and Historical",textContextDiscret:"Contextual and Discretionary",textHistoricalDiscret:"Historical and Discretionary",textStandardContextHist:"Standard, Contextual and Historical",textStandardContextDiscret:"Standard, Contextual and Discretionary",textStandardHistDiscret:"Standard, Historical and Discretionary",textContextHistDiscret:"Contextual, Historical and Discretionary",textAll:"All"},DE.Views.ParagraphSettingsAdvanced||{}))})),define("text!documenteditor/main/app/template/ImageSettingsAdvanced.template",[],(function(){return'<div id="id-adv-image-width" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="4" width="100%" role="presentation">\r\n        <tr>\r\n            <td width="78px">\r\n                <label class="input-label"><%= scope.textWidth %></label>\r\n                <div id="image-advanced-spin-width"></div>\r\n            </td>\r\n            <td width="28px" style="vertical-align: bottom;">\r\n                <div id="image-advanced-button-ratio"></div>\r\n            </td>\r\n            <td width="78px">\r\n                <label class="input-label"><%= scope.textHeight %></label>\r\n                <div id="image-advanced-spin-height"></div>\r\n            </td>\r\n            <td style="vertical-align: bottom;">\r\n                <button type="button" class="btn btn-text-default auto" id="image-advanced-button-original-size" style="min-width:100px;"><%= scope.textOriginalSize %></button>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-size" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="3" role="presentation">\r\n        <tr>\r\n            <td colspan="3">\r\n                <label class="header"><%= scope.textWidth %></label>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td style="vertical-align: bottom; padding-bottom: 12px;" role="radiogroup" aria-owns="shape-radio-hsizepc">\r\n                <div id="shape-radio-hsize"></div>\r\n            </td>\r\n            <td class="padding-small">\r\n                <label class="input-label"><%= scope.textAbsoluteWH %></label>\r\n                <div id="shape-advanced-spin-width"></div>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                <div id="shape-radio-hsizepc"></div>\r\n            </td>\r\n            <td class="padding-large padding-right-15">\r\n                <label class="input-label"><%= scope.textRelativeWH %></label>\r\n                <div id="shape-advanced-spin-width-rel"></div>\r\n            </td>\r\n            <td class="padding-large">\r\n                <label class="input-label"><%= scope.textRelative %></label>\r\n                <div id="shape-combo-width-rel" style="width: 115px;"></div>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td colspan="3">\r\n                <label class="header"><%= scope.textHeight %></label>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td style="vertical-align: bottom; padding-bottom: 12px;" role="radiogroup" aria-owns="shape-radio-vsizepc">\r\n                <div id="shape-radio-vsize"></div>\r\n            </td>\r\n            <td class="padding-small">\r\n                <label class="input-label"><%= scope.textAbsoluteWH %></label>\r\n                <div id="shape-advanced-spin-height"></div>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                <div id="shape-radio-vsizepc"></div>\r\n            </td>\r\n            <td class="padding-large padding-right-15">\r\n                <label class="input-label"><%= scope.textRelativeWH %></label>\r\n                <div id="shape-advanced-spin-height-rel"></div>\r\n            </td>\r\n            <td class="padding-large">\r\n                <label class="input-label"><%= scope.textRelative %></label>\r\n                <div id="shape-combo-height-rel" style="width: 115px;"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td>\r\n                    <div id="shape-checkbox-ratio"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-rotate" class="settings-panel active">\r\n    <div class="inner-content  padding-large">\r\n        <div style="width: 100%;">\r\n            <label class="input-label vertical-align-baseline"><%= scope.textAngle %></label>\r\n            <div id="image-advanced-spin-angle" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content  padding-large">\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\r\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="image-advanced-checkbox-hor"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="image-advanced-checkbox-vert"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-wrap" class="settings-panel">\r\n    <div class="inner-content padding-large">\r\n        <label class="header padding-small"><%= scope.textWrap %></label>\r\n        <div class="padding-small">\r\n            <div id="image-advanced-button-wrap-inline" class="margin-right-7" style="display: inline-block;"></div>\r\n            <div id="image-advanced-button-wrap-square" class="margin-right-7" style="display: inline-block;"></div>\r\n            <div id="image-advanced-button-wrap-tight" class="margin-right-7" style="display: inline-block;"></div>\r\n            <div id="image-advanced-button-wrap-through" class="margin-right-7" style="display: inline-block;"></div>\r\n        </div>\r\n        <div class="padding-small">\r\n            <div id="image-advanced-button-wrap-topbottom" class="margin-right-7" style="display: inline-block;"></div>\r\n            <div id="image-advanced-button-wrap-infront" class="margin-right-7" style="display: inline-block;"></div>\r\n            <div id="image-advanced-button-wrap-behind" style="display: inline-block;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textDistance %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="image-advanced-distance-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="image-advanced-distance-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="image-advanced-distance-bottom"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="image-advanced-distance-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-position" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="3" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="3">\r\n                    <label class="header"><%= scope.textHorizontal %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;" role="radiogroup" aria-owns="image-radio-hposition image-radio-hpositionpc">\r\n                    <div id="image-radio-halign"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textAlignment %></label>\r\n                    <div id="image-combo-halign" style="width: 115px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="image-combo-hrelative" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\r\n                    <div id="image-radio-hposition"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textPosition %></label>\r\n                    <div id="image-spin-x"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRightOf %></label>\r\n                    <div id="image-combo-hposition" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                    <div id="image-radio-hpositionpc"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textPositionPc %></label>\r\n                    <div id="image-spin-xpc"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="image-combo-hpositionpc" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="3">\r\n                    <label class="header"><%= scope.textVertical %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;" role="radiogroup" aria-owns="image-radio-vposition image-radio-vpositionpc">\r\n                    <div id="image-radio-valign"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textAlignment %></label>\r\n                    <div id="image-combo-valign" style="width: 115px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="image-combo-vrelative" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\r\n                    <div id="image-radio-vposition"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textPosition %></label>\r\n                    <div id="image-spin-y"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBelow %></label>\r\n                    <div id="image-combo-vposition" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                    <div id="image-radio-vpositionpc"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textPositionPc %></label>\r\n                    <div id="image-spin-ypc"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="image-combo-vpositionpc" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="separator horizontal padding-small"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="2">\r\n                    <label class="header"><%= scope.textOptions %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <div id="image-checkbox-move"></div>\r\n                </td>\r\n                <td>\r\n                    <div id="image-checkbox-overlap"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-shape" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textLineStyle %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large" width="125px">\r\n                    <label class="input-label"><%= scope.textCapType %></label>\r\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textJoinType %></label>\r\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textArrows %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\r\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndStyle %></label>\r\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBeginSize %></label>\r\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndSize %></label>\r\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-margins" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="header"><%= scope.textAutofit %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="shape-checkbox-autofit"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="separator horizontal padding-large"></div>\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.strMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="image-margin-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="image-margin-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="image-margin-bottom"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="image-margin-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="image-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("documenteditor/main/app/view/ImageSettingsAdvanced",["text!documenteditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:340,contentHeight:410,toggleGroup:"image-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"de-img-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-width",panelCaption:this.textSize},{panelId:"id-adv-shape-size",panelCaption:this.textSize},{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-wrap",panelCaption:this.textBtnWrap},{panelId:"id-adv-image-position",panelCaption:this.textPosition},{panelId:"id-adv-image-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-image-margins",panelCaption:this.textTextBox},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._state={HAlignType:Asc.c_oAscAlignH.Left,HAlignFrom:Asc.c_oAscRelativeFromH.Character,HPositionFrom:Asc.c_oAscRelativeFromH.Character,HPositionPcFrom:Asc.c_oAscRelativeFromH.Page,ShapeWidthPcFrom:Asc.c_oAscRelativeFromH.Margin,VAlignType:Asc.c_oAscAlignV.Top,VAlignFrom:Asc.c_oAscRelativeFromV.Paragraph,VPositionFrom:Asc.c_oAscRelativeFromV.Paragraph,VPositionPcFrom:Asc.c_oAscRelativeFromV.Page,ShapeHeightPcFrom:Asc.c_oAscRelativeFromV.Margin,spnXChanged:!1,spnYChanged:!1,spnXPcChanged:!1,spnYPcChanged:!1},this._objectType=Asc.c_oAscTypeSelectElement.Image,this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.imageProps,this.sectionProps=this.options.sectionProps,this.pageWidth=this.options.sectionProps?this.options.sectionProps.get_W():210,this.pageHeight=this.options.sectionProps?this.options.sectionProps.get_H():297,this.api=this.options.api,this._changedProps=null,this._changedShapeProps=null,this._isSmartArt=!1},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.spnWidth=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-width"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,n){if(this.btnRatio.pressed){var s=t.getNumberValue(),o=s/this._nRatio;o>this.sizeMax.height&&(s=(o=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(s,!0)),this.spnHeight.setValue(o,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),this._changedProps.put_ResetCrop(!1))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-height"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),o=null;this.btnRatio.pressed&&((o=s*this._nRatio)>this.sizeMax.width&&(s=(o=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(s,!0)),this.spnWidth.setValue(o,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_ResetCrop(!1))}),this)),this.spinners.push(this.spnHeight),this.btnOriginalSize=new Common.UI.Button({el:$("#image-advanced-button-original-size")}),this.btnOriginalSize.on("click",_.bind((function(t,e){this.spnAngle.setValue(0),this.spnWidth.setValue(this.sizeOriginal.width,!0),this.spnHeight.setValue(this.sizeOriginal.height,!0),this._nRatio=this.sizeOriginal.width/this.sizeOriginal.height,this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_Rot(0))}),this)),this.btnRatio=new Common.UI.Button({parentEl:$("#image-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.radioHSize=new Common.UI.RadioBox({el:$("#shape-radio-hsize"),name:"asc-radio-width",checked:!0,ariaLabel:this.textAbsoluteWH}),this.radioHSize.on("change",_.bind(this.onRadioHSizeChange,this)),this.radioHSizePc=new Common.UI.RadioBox({el:$("#shape-radio-hsizepc"),name:"asc-radio-width",ariaLabel:this.textRelativeWH}),this.radioHSizePc.on("change",_.bind(this.onRadioHSizePcChange,this)),this.radioVSize=new Common.UI.RadioBox({el:$("#shape-radio-vsize"),name:"asc-radio-height",checked:!0,ariaLabel:this.textAbsoluteWH}),this.radioVSize.on("change",_.bind(this.onRadioVSizeChange,this)),this.radioVSizePc=new Common.UI.RadioBox({el:$("#shape-radio-vsizepc"),name:"asc-radio-height",ariaLabel:this.textRelativeWH}),this.radioVSizePc.on("change",_.bind(this.onRadioVSizePcChange,this)),this.chRatio=new Common.UI.CheckBox({el:$("#shape-checkbox-ratio"),labelText:this.textAspectRatio}),this.chRatio.on("change",_.bind((function(t,e,i,n){"checked"==t.getValue()&&this.spnShapeHeight.getNumberValue()>0&&(this._nRatio=this.spnShapeWidth.getNumberValue()/this.spnShapeHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect("checked"==t.getValue())}),this)),this.spnShapeWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:80,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnShapeWidth.on("change",_.bind((function(t,e,i,n){if("checked"==this.chRatio.getValue()&&(!this.chRatio.isDisabled()||this._isSmartArt)){var s=t.getNumberValue(),o=s/this._nRatio;o>this.sizeMax.height&&(s=(o=this.sizeMax.height)*this._nRatio,this.spnShapeWidth.setValue(s,!0)),this.spnShapeHeight.setValue(o,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.fillShapeHeight())}),this)),this.spinners.push(this.spnShapeWidth),this.spnShapeHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:80,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnShapeHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),o=null;"checked"!=this.chRatio.getValue()||this.chRatio.isDisabled()&&!this._isSmartArt||((o=s*this._nRatio)>this.sizeMax.width&&(s=(o=this.sizeMax.width)/this._nRatio,this.spnShapeHeight.setValue(s,!0)),this.spnShapeWidth.setValue(o,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.fillShapeWidth())}),this)),this.spinners.push(this.spnShapeHeight),this.spnShapeWidthPc=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width-rel"),disabled:!0,step:1,width:80,defaultUnit:"%",value:"1 %",maxValue:1e3,minValue:1}),this.spnShapeWidthPc.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(t.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight())}),this)),this.spnShapeHeightPc=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height-rel"),disabled:!0,step:1,width:80,defaultUnit:"%",value:"1 %",maxValue:1e3,minValue:1}),this.spnShapeHeightPc.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(t.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth())}),this)),this._arrHRelativePc=[{displayValue:this.textLeftMargin,value:Asc.c_oAscRelativeFromH.LeftMargin,size:this.sectionProps.get_LeftMargin()},{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromH.Margin,size:this.sectionProps.get_W()-this.sectionProps.get_LeftMargin()-this.sectionProps.get_RightMargin()},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromH.Page,size:this.sectionProps.get_W()},{displayValue:this.textRightMargin,value:Asc.c_oAscRelativeFromH.RightMargin,size:this.sectionProps.get_RightMargin()}],this.cmbWidthPc=new Common.UI.ComboBox({el:$("#shape-combo-width-rel"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelativePc,takeFocusOnClose:!0}),this.cmbWidthPc.setDisabled(!0),this.cmbWidthPc.setValue(this._state.ShapeWidthPcFrom),this.cmbWidthPc.on("selected",_.bind(this.onCmbWidthPcSelect,this)),this._arrVRelativePc=[{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromV.Margin,size:this.sectionProps.get_H()-this.sectionProps.get_TopMargin()-this.sectionProps.get_BottomMargin()},{displayValue:this.textBottomMargin,value:Asc.c_oAscRelativeFromV.BottomMargin,size:this.sectionProps.get_BottomMargin()},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromV.Page,size:this.sectionProps.get_H()},{displayValue:this.textTopMargin,value:Asc.c_oAscRelativeFromV.TopMargin,size:this.sectionProps.get_TopMargin()}],this.cmbHeightPc=new Common.UI.ComboBox({el:$("#shape-combo-height-rel"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelativePc,takeFocusOnClose:!0}),this.cmbHeightPc.setDisabled(!0),this.cmbHeightPc.setValue(this._state.ShapeHeightPcFrom),this.cmbHeightPc.on("selected",_.bind(this.onCmbHeightPcSelect,this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.btnWrapInline=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-inline"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-inline",posId:Asc.c_oAscWrapStyle2.Inline,hint:this.textWrapInlineTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapInline.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapSquare=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-square"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-square",posId:Asc.c_oAscWrapStyle2.Square,hint:this.textWrapSquareTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapSquare.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapTight=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-tight"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-tight",posId:Asc.c_oAscWrapStyle2.Tight,hint:this.textWrapTightTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapTight.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapThrough=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-through"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-through",posId:Asc.c_oAscWrapStyle2.Through,hint:this.textWrapThroughTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapThrough.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapTopBottom=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-topbottom"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-topbottom",posId:Asc.c_oAscWrapStyle2.TopAndBottom,hint:this.textWrapTopbottomTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapTopBottom.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapBehind=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-behind"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-behind",posId:Asc.c_oAscWrapStyle2.Behind,hint:this.textWrapBehindTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapBehind.on("click",_.bind(this.onBtnWrapClick,this)),this.btnWrapInFront=new Common.UI.Button({parentEl:$("#image-advanced-button-wrap-infront"),cls:"btn-options huge-1",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-wrap-infront",posId:Asc.c_oAscWrapStyle2.InFront,hint:this.textWrapInFrontTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"imgAdvWrapGroup"}),this.btnWrapInFront.on("click",_.bind(this.onBtnWrapClick,this)),this.spnTop=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTop.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnBottom.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-left"),step:.1,width:85,defaultUnit:"cm",value:"0.32 cm",maxValue:55.87,minValue:0}),this.spnLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#image-advanced-distance-right"),step:.1,width:85,defaultUnit:"cm",value:"0.32 cm",maxValue:55.87,minValue:0}),this.spnRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Paddings()&&void 0!==this._changedProps.get_Paddings()||this._changedProps.put_Paddings(new Asc.asc_CPaddings),this._changedProps.get_Paddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnRight),this.spnX=new Common.UI.MetricSpinner({el:$("#image-spin-x"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spnX.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnXChanged=!0)}),this)),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#image-spin-y"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spnY.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnYChanged=!0)}),this)),this.spinners.push(this.spnY),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscAlignH.Left},{displayValue:this.textCenter,value:Asc.c_oAscAlignH.Center},{displayValue:this.textRight,value:Asc.c_oAscAlignH.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#image-combo-halign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHAlign,takeFocusOnClose:!0}),this.cmbHAlign.setValue(this._state.HAlignType),this.cmbHAlign.on("selected",_.bind(this.onHAlignSelect,this)),this._arrHRelative=[{displayValue:this.textCharacter,value:Asc.c_oAscRelativeFromH.Character},{displayValue:this.textColumn,value:Asc.c_oAscRelativeFromH.Column},{displayValue:this.textLeftMargin,value:Asc.c_oAscRelativeFromH.LeftMargin},{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromH.Margin},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromH.Page},{displayValue:this.textRightMargin,value:Asc.c_oAscRelativeFromH.RightMargin}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#image-combo-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHRelative.setValue(this._state.HAlignFrom),this.cmbHRelative.on("selected",_.bind(this.onHRelativeSelect,this)),this.cmbHPosition=new Common.UI.ComboBox({el:$("#image-combo-hposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHPosition.setDisabled(!0),this.cmbHPosition.setValue(this._state.HPositionFrom),this.cmbHPosition.on("selected",_.bind(this.onHPositionSelect,this)),this.spnXPc=new Common.UI.MetricSpinner({el:$("#image-spin-xpc"),step:1,width:115,disabled:!0,defaultUnit:"%",defaultValue:0,value:"0 %",maxValue:1e3,minValue:-1e3}),this.spnXPc.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom),this._changedProps.get_PositionH().put_Value(t.getNumberValue()),this._state.spnXPcChanged=!0)}),this)),this.cmbHPositionPc=new Common.UI.ComboBox({el:$("#image-combo-hpositionpc"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelativePc,takeFocusOnClose:!0}),this.cmbHPositionPc.setDisabled(!0),this.cmbHPositionPc.setValue(this._state.HPositionPcFrom),this.cmbHPositionPc.on("selected",_.bind(this.onHPositionPcSelect,this)),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscAlignV.Top},{displayValue:this.textCenter,value:Asc.c_oAscAlignV.Center},{displayValue:this.textBottom,value:Asc.c_oAscAlignV.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#image-combo-valign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVAlign,takeFocusOnClose:!0}),this.cmbVAlign.setValue(this._state.VAlignType),this.cmbVAlign.on("selected",_.bind(this.onVAlignSelect,this)),this._arrVRelative=[{displayValue:this.textLine,value:Asc.c_oAscRelativeFromV.Line},{displayValue:this.textMargin,value:Asc.c_oAscRelativeFromV.Margin},{displayValue:this.textBottomMargin,value:Asc.c_oAscRelativeFromV.BottomMargin},{displayValue:this.textParagraph,value:Asc.c_oAscRelativeFromV.Paragraph},{displayValue:this.textPage,value:Asc.c_oAscRelativeFromV.Page},{displayValue:this.textTopMargin,value:Asc.c_oAscRelativeFromV.TopMargin}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#image-combo-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVRelative.setValue(this._state.VAlignFrom),this.cmbVRelative.on("selected",_.bind(this.onVRelativeSelect,this)),this.cmbVPosition=new Common.UI.ComboBox({el:$("#image-combo-vposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVPosition.setDisabled(!0),this.cmbVPosition.setValue(this._state.VPositionFrom),this.cmbVPosition.on("selected",_.bind(this.onVPositionSelect,this)),this.spnYPc=new Common.UI.MetricSpinner({el:$("#image-spin-ypc"),step:1,width:115,disabled:!0,defaultUnit:"%",defaultValue:0,value:"0 %",maxValue:1e3,minValue:-1e3}),this.spnYPc.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom),this._changedProps.get_PositionV().put_Value(t.getNumberValue()),this._state.spnYPcChanged=!0)}),this)),this.cmbVPositionPc=new Common.UI.ComboBox({el:$("#image-combo-vpositionpc"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelativePc,takeFocusOnClose:!0}),this.cmbVPositionPc.setDisabled(!0),this.cmbVPositionPc.setValue(this._state.VPositionPcFrom),this.cmbVPositionPc.on("selected",_.bind(this.onVPositionPcSelect,this)),this.radioHAlign=new Common.UI.RadioBox({el:$("#image-radio-halign"),name:"asc-radio-horizontal",checked:!0,ariaLabel:this.textHorizontal+" "+this.textAlignment}),this.radioHAlign.on("change",_.bind(this.onRadioHAlignChange,this)),this.radioHPosition=new Common.UI.RadioBox({el:$("#image-radio-hposition"),name:"asc-radio-horizontal",ariaLabel:this.textHorizontal+" "+this.textPosition}),this.radioHPosition.on("change",_.bind(this.onRadioHPositionChange,this)),this.radioHPositionPc=new Common.UI.RadioBox({el:$("#image-radio-hpositionpc"),name:"asc-radio-horizontal",ariaLabel:this.textHorizontal+" "+this.textPositionPc}),this.radioHPositionPc.on("change",_.bind(this.onRadioHPositionPcChange,this)),this.radioVAlign=new Common.UI.RadioBox({el:$("#image-radio-valign"),name:"asc-radio-vertical",checked:!0,ariaLabel:this.textVertical+" "+this.textAlignment}),this.radioVAlign.on("change",_.bind(this.onRadioVAlignChange,this)),this.radioVPosition=new Common.UI.RadioBox({el:$("#image-radio-vposition"),name:"asc-radio-vertical",ariaLabel:this.textVertical+" "+this.textPosition}),this.radioVPosition.on("change",_.bind(this.onRadioVPositionChange,this)),this.radioVPositionPc=new Common.UI.RadioBox({el:$("#image-radio-vpositionpc"),name:"asc-radio-vertical",ariaLabel:this.textVertical+" "+this.textPositionPc}),this.radioVPositionPc.on("change",_.bind(this.onRadioVPositionPcChange,this)),this.chMove=new Common.UI.CheckBox({el:$("#image-checkbox-move"),labelText:this.textMove}),this.chMove.on("change",_.bind((function(t,e,i,n){if(this._changedProps){var s,o=this._arrVRelative["checked"==t.getValue()?3:4].value;if(this.cmbVRelative.isDisabled())this.cmbVPosition.setValue(o),(s=this.cmbVPosition.getSelectedRecord())&&this.onVPositionSelect(this.cmbVPosition,s);else this.cmbVRelative.setValue(o),(s=this.cmbVRelative.getSelectedRecord())&&this.onVRelativeSelect(this.cmbVRelative,s)}}),this)),this.chOverlap=new Common.UI.CheckBox({el:$("#image-checkbox-overlap"),labelText:this.textOverlap}),this.chOverlap.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_AllowOverlap("checked"==t.getValue())}),this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#image-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#image-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#image-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#image-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this.Margins&&(this.Margins=new Asc.asc_CPaddings),this.Margins.put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginRight),this.chAutofit=new Common.UI.CheckBox({el:$("#shape-checkbox-autofit"),labelText:this.textResizeFit}),this.chAutofit.on("change",_.bind((function(t,e,i,n){this._changedShapeProps&&this._changedShapeProps.asc_putTextFitType("checked"==t.getValue()?AscFormat.text_fit_Auto:AscFormat.text_fit_No)}),this)),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind((function(t,e){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linecap(e.value))}),this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind((function(t,e){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linejoin(e.value))}),this));var e=[],i=[];e.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),e.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),e.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),e.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),e.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),e.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var n=0;n<6;n++)e[n].value=n;for(n=0;n<9;n++)i.push({value:n,typearrow:""});i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginStyle.on("item:click",_.bind(this.onSelectBeginStyle,this)),this.mnuBeginStylePicker=this.btnBeginStyle.getPicker(),this.btnBeginStyle.updateFormControl(),this.btnBeginSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginSize.on("item:click",_.bind(this.onSelectBeginSize,this)),this.mnuBeginSizePicker=this.btnBeginSize.getPicker(),this.btnBeginSize.updateFormControl(),this.btnEndStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndStyle.on("item:click",_.bind(this.onSelectEndStyle,this)),this.mnuEndStylePicker=this.btnEndStyle.getPicker(),this.btnEndStyle.updateFormControl(),this.btnEndSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndSize.on("item:click",_.bind(this.onSelectEndSize,this)),this.mnuEndSizePicker=this.btnEndSize.getPicker(),this.btnEndSize.updateFormControl(),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.spnWidth,this.btnRatio,this.spnHeight,this.btnOriginalSize,this.radioHSize,this.spnShapeWidth,this.spnShapeWidthPc,this.radioHSizePc,this.cmbWidthPc,this.radioVSize,this.spnShapeHeight,this.spnShapeHeightPc,this.radioVSizePc,this.cmbHeightPc,this.chRatio,this.spnAngle,this.chFlipHor,this.chFlipVert,this.btnWrapInline,this.btnWrapSquare,this.btnWrapTight,this.btnWrapThrough,this.btnWrapTopBottom,this.btnWrapInFront,this.btnWrapBehind,this.spnTop,this.spnLeft,this.spnBottom,this.spnRight,this.radioHAlign,this.radioHPosition,this.radioHPositionPc,this.cmbHAlign,this.cmbHRelative,this.spnX,this.cmbHPosition,this.spnXPc,this.cmbHPositionPc,this.radioVAlign,this.radioVPosition,this.radioVPositionPc,this.cmbVAlign,this.cmbVRelative,this.spnY,this.cmbVPosition,this.spnYPc,this.cmbVPositionPc,this.chMove,this.chOverlap,this.cmbCapType,this.cmbJoinType,this.btnBeginStyle,this.btnEndStyle,this.btnBeginSize,this.btnEndSize,this.chAutofit,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.spnWidth.focus();break;case 1:i.spnShapeWidth.isDisabled()?i.spnShapeWidthPc.focus():i.spnShapeWidth.focus();break;case 2:i.spnAngle.focus();break;case 3:i.spnTop.isDisabled()?i.spnLeft.isDisabled()?i.btnWrapInline.isDisabled()||i.btnWrapInline.focus():i.spnLeft.focus():i.spnTop.focus();break;case 4:i.cmbHAlign.isDisabled()?i.spnX.isDisabled()?i.spnXPc.focus():i.spnX.focus():i.cmbHAlign.focus();break;case 5:i.cmbCapType.focus();break;case 6:i.chAutofit.focus();break;case 7:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.btnsCategory[this._objectType==Asc.c_oAscTypeSelectElement.Shape?0:1].setVisible(!1),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){this._objectType=Asc.c_oAscTypeSelectElement.Image;var e=t.get_WrappingStyle();if(t.get_CanBeFlow()){switch(e){case Asc.c_oAscWrapStyle2.Inline:this.btnWrapInline.toggle(!0);break;case Asc.c_oAscWrapStyle2.Square:this.btnWrapSquare.toggle(!0);break;case Asc.c_oAscWrapStyle2.Tight:this.btnWrapTight.toggle(!0);break;case Asc.c_oAscWrapStyle2.Through:this.btnWrapThrough.toggle(!0);break;case Asc.c_oAscWrapStyle2.TopAndBottom:this.btnWrapTopBottom.toggle(!0);break;case Asc.c_oAscWrapStyle2.Behind:this.btnWrapBehind.toggle(!0);break;case Asc.c_oAscWrapStyle2.InFront:this.btnWrapInFront.toggle(!0);break;default:this.btnWrapInline.toggle(!1),this.btnWrapSquare.toggle(!1),this.btnWrapTight.toggle(!1),this.btnWrapThrough.toggle(!1),this.btnWrapTopBottom.toggle(!1),this.btnWrapBehind.toggle(!1),this.btnWrapInFront.toggle(!1)}this._DisableElem(e)}else this.btnWrapInline.toggle(!0),this.btnWrapSquare.setDisabled(!0),this.btnWrapTight.setDisabled(!0),this.btnWrapThrough.setDisabled(!0),this.btnWrapTopBottom.setDisabled(!0),this.btnWrapBehind.setDisabled(!0),this.btnWrapInFront.setDisabled(!0),this._DisableElem(Asc.c_oAscWrapStyle2.Inline);if(t.get_Paddings()){var i={Top:t.get_Paddings().get_Top(),Right:t.get_Paddings().get_Right(),Bottom:t.get_Paddings().get_Bottom(),Left:t.get_Paddings().get_Left()};null!=i.Top&&this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Top),!0),null!=i.Left&&this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Left),!0),null!=i.Bottom&&this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Bottom),!0),null!=i.Right&&this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(i.Right),!0)}var n=t.get_PositionH();if(n)if(n.get_UseAlign()){e=n.get_Align();for(var s=0;s<this._arrHAlign.length;s++)if(e==this._arrHAlign[s].value){this.cmbHAlign.setValue(e),this._state.HAlignType=e;break}e=n.get_RelativeFrom();for(s=0;s<this._arrHRelative.length;s++)if(e==this._arrHRelative[s].value){this.cmbHRelative.setValue(e),this._state.HAlignFrom=e;break}}else if(n.get_Percent()){for(this.radioHPositionPc.setValue(!0),this.spnXPc.setValue(n.get_Value()),e=n.get_RelativeFrom(),s=0;s<this._arrHRelativePc.length;s++)if(e==this._arrHRelativePc[s].value){this.cmbHPositionPc.setValue(e),this._state.HPositionPcFrom=e;break}}else for(this.radioHPosition.setValue(!0),e=n.get_Value(),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e)),e=n.get_RelativeFrom(),s=0;s<this._arrHRelative.length;s++)if(e==this._arrHRelative[s].value){this.cmbHPosition.setValue(e),this._state.HPositionFrom=e;break}if(n=t.get_PositionV()){if(n.get_UseAlign()){for(e=n.get_Align(),s=0;s<this._arrVAlign.length;s++)if(e==this._arrVAlign[s].value){this.cmbVAlign.setValue(e),this._state.VAlignType=e;break}for(e=n.get_RelativeFrom(),s=0;s<this._arrVRelative.length;s++)if(e==this._arrVRelative[s].value){this.cmbVRelative.setValue(e),this._state.VAlignFrom=e;break}}else if(n.get_Percent()){for(this.radioVPositionPc.setValue(!0),this.spnYPc.setValue(n.get_Value()),e=n.get_RelativeFrom(),s=0;s<this._arrVRelativePc.length;s++)if(e==this._arrVRelativePc[s].value){this.cmbVPositionPc.setValue(e),this._state.VPositionPcFrom=e;break}}else for(this.radioVPosition.setValue(!0),e=n.get_Value(),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e)),e=n.get_RelativeFrom(),s=0;s<this._arrVRelative.length;s++)if(e==this._arrVRelative[s].value){this.cmbVPosition.setValue(e),this._state.VPositionFrom=e;break}this.chMove.setValue(e==Asc.c_oAscRelativeFromV.Line||e==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!n.get_UseAlign()&&n.get_Percent())}this.chOverlap.setValue(null!==t.get_AllowOverlap()&&void 0!==t.get_AllowOverlap()?t.get_AllowOverlap():"indeterminate",!0),t.get_Height()>0&&(this._nRatio=t.get_Width()/t.get_Height());var o=t.get_ShapeProperties(),a=t.get_ChartProperties(),l=t.asc_getPluginGuid(),r=this.api&&this.api.asc_IsContentControl()?this.api.asc_GetContentControlProperties():null,c=!1;if(r){var d=r.get_SpecificType();c=(d==Asc.c_oAscContentControlSpecificType.CheckBox||d==Asc.c_oAscContentControlSpecificType.ComboBox||d==Asc.c_oAscContentControlSpecificType.DropDownList||d==Asc.c_oAscContentControlSpecificType.None||d==Asc.c_oAscContentControlSpecificType.Picture||d==Asc.c_oAscContentControlSpecificType.Complex||d==Asc.c_oAscContentControlSpecificType.DateTime||d==Asc.c_oAscContentControlSpecificType.Signature)&&r.get_FormPr()&&r.get_FormPr().get_Fixed()}if(this.btnOriginalSize.setVisible(!(o||a)),this.btnOriginalSize.setDisabled(null===t.get_ImageUrl()||void 0===t.get_ImageUrl()),this.btnsCategory[5].setVisible(null!==o&&!o.get_FromChart()&&!c),this.btnsCategory[6].setVisible(null!==o&&!o.get_FromChart()&&!c),this.btnsCategory[7].setVisible(!c),this.btnsCategory[2].setVisible(!a&&null==l),this.btnsCategory[3].setDisabled(t.get_FromGroup()||!!r&&r.get_SpecificType()==Asc.c_oAscContentControlSpecificType.Picture&&!r.get_FormPr()),o){this._objectType=Asc.c_oAscTypeSelectElement.Shape,this._setShapeDefaults(o),this.setTitle(this.textTitleShape),e=t.asc_getLockAspect(),this.chRatio.setValue(e||this._isSmartArt,!0),this.spnShapeWidth.setMaxValue(this.sizeMax.width),this.spnShapeHeight.setMaxValue(this.sizeMax.height);var h=t.get_SizeRelH();if(h){for(this.radioHSizePc.setValue(!0),this.spnShapeWidthPc.setValue(h.get_Value()),e=h.get_RelativeFrom(),s=0;s<this._arrHRelativePc.length;s++)if(e==this._arrHRelativePc[s].value){this.cmbWidthPc.setValue(e),this.spnShapeWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrHRelativePc[s].size*h.get_Value()/100).toFixed(2),!0),this._state.ShapeWidthPcFrom=e;break}}else this.radioHSize.setValue(!0),e=t.get_Width(),this.spnShapeWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);var p=t.get_SizeRelV();if(p){for(this.radioVSizePc.setValue(!0),this.spnShapeHeightPc.setValue(p.get_Value()),e=p.get_RelativeFrom(),s=0;s<this._arrVRelativePc.length;s++)if(e==this._arrVRelativePc[s].value){this.cmbHeightPc.setValue(e),this.spnShapeHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrVRelativePc[s].size*p.get_Value()/100).toFixed(2),!0),this._state.ShapeHeightPcFrom=e;break}}else this.radioVSize.setValue(!0),e=t.get_Height(),this.spnShapeHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);this.chRatio.setDisabled(this.radioVSizePc.getValue()||this.radioHSizePc.getValue()||this._isSmartArt);var m=o.get_paddings();if(m){var u=m.get_Left();this.spnMarginLeft.setValue(null!=u?Common.Utils.Metric.fnRecalcFromMM(u):"",!0),u=m.get_Top(),this.spnMarginTop.setValue(null!=u?Common.Utils.Metric.fnRecalcFromMM(u):"",!0),u=m.get_Right(),this.spnMarginRight.setValue(null!=u?Common.Utils.Metric.fnRecalcFromMM(u):"",!0),u=m.get_Bottom(),this.spnMarginBottom.setValue(null!=u?Common.Utils.Metric.fnRecalcFromMM(u):"",!0)}this.chAutofit.setValue(o.asc_getTextFitType()==AscFormat.text_fit_Auto),this.btnsCategory[6].setDisabled(null===m),this.btnsCategory[5].setDisabled(o.get_stroke().get_type()==Asc.c_oAscStrokeType.STROKE_NONE)}else e=t.asc_getLockAspect(),a?(this._objectType=Asc.c_oAscTypeSelectElement.Chart,this.setTitle(this.textTitleChart)):this.setTitle(this.textTitle),this.btnRatio.toggle(e),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),e=t.get_Width(),this.spnWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.get_Height(),this.spnHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0);a||(e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV())),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){var t=this._changedProps;if(this._objectType==Asc.c_oAscTypeSelectElement.Shape&&(t.put_ShapeProperties(this._changedShapeProps),this.Margins&&(null!==t.get_ShapeProperties()&&void 0!==t.get_ShapeProperties()||t.put_ShapeProperties(new Asc.asc_CShapeProperty),t.get_ShapeProperties().put_paddings(this.Margins))),this._originalProps.get_WrappingStyle()===Asc.c_oAscWrapStyle2.Inline&&void 0!==t.get_WrappingStyle()&&t.get_WrappingStyle()!==Asc.c_oAscWrapStyle2.Inline){if(null===t.get_PositionH()||void 0===t.get_PositionH()){t.put_PositionH(new Asc.CImagePositionH),t.get_PositionH().put_UseAlign(!1),t.get_PositionH().put_Percent(!1),t.get_PositionH().put_RelativeFrom(Asc.c_oAscRelativeFromH.Column);var e=this._originalProps.get_Value_X(Asc.c_oAscRelativeFromH.Column);t.get_PositionH().put_Value(e)}null!==t.get_PositionV()&&void 0!==t.get_PositionV()||(t.put_PositionV(new Asc.CImagePositionV),t.get_PositionV().put_UseAlign(!1),t.get_PositionV().put_Percent(!1),t.get_PositionV().put_RelativeFrom(Asc.c_oAscRelativeFromV.Paragraph),e=this._originalProps.get_Value_Y(Asc.c_oAscRelativeFromV.Paragraph),t.get_PositionV().put_Value(e))}return this._objectType!=Asc.c_oAscTypeSelectElement.Chart&&(t.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),t.asc_putFlipH("checked"==this.chFlipHor.getValue()),t.asc_putFlipV("checked"==this.chFlipVert.getValue())),this.isAltTitleChanged&&t.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&t.asc_putDescription(this.textareaAltDescription.val()),{imageProps:t}},_setShapeDefaults:function(t){if(t){t.get_FromSmartArt()&&(this.radioHSizePc.setDisabled(!0),this.radioVSizePc.setDisabled(!0),this.btnsCategory[2].setDisabled(!0),this._isSmartArt=!0),t.get_FromSmartArtInternal()&&(this.chAutofit.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[1].setDisabled(!0));var e=t.get_stroke();if(e){for(var i=e.get_linejoin(),n=0;n<this._arrJoinType.length;n++)if(i==this._arrJoinType[n].value){this.cmbJoinType.setValue(i);break}for(i=e.get_linecap(),n=0;n<this._arrCapType.length;n++)if(i==this._arrCapType[n].value){this.cmbCapType.setValue(i);break}var s=e.get_canChangeArrows();if(this.btnBeginStyle.setDisabled(!s),this.btnEndStyle.setDisabled(!s),this.btnBeginSize.setDisabled(!s),this.btnEndSize.setDisabled(!s),s){i=e.get_linebeginsize();var o=this.mnuBeginSizePicker.store.findWhere({type:i});o?this._beginSizeIdx=o.get("value"):(this._beginSizeIdx=null,this.btnBeginSize.updateFormControl()),i=e.get_linebeginstyle(),o=this.mnuBeginStylePicker.store.findWhere({type:i}),this.btnBeginStyle.selectRecord(o),o&&this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,o,this._beginSizeIdx),i=e.get_lineendsize(),(o=this.mnuEndSizePicker.store.findWhere({type:i}))?this._endSizeIdx=o.get("value"):(this._endSizeIdx=null,this.btnEndSize.updateFormControl()),i=e.get_lineendstyle(),o=this.mnuEndStylePicker.store.findWhere({type:i}),this.btnEndStyle.selectRecord(o),o&&this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,o,this._endSizeIdx)}}}this._changedShapeProps=new Asc.asc_CShapeProperty},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},onBtnWrapClick:function(t,e){this._DisableElem(t.options.posId),this._changedProps&&this._changedProps.put_WrappingStyle(t.options.posId)},_DisableElem:function(t){var e=t==Asc.c_oAscWrapStyle2.Inline||t==Asc.c_oAscWrapStyle2.Behind||t==Asc.c_oAscWrapStyle2.InFront||t==Asc.c_oAscWrapStyle2.TopAndBottom,i=t==Asc.c_oAscWrapStyle2.Inline||t==Asc.c_oAscWrapStyle2.Behind||t==Asc.c_oAscWrapStyle2.InFront||t==Asc.c_oAscWrapStyle2.Tight||t==Asc.c_oAscWrapStyle2.Through;this.spnLeft.setDisabled(e),this.spnRight.setDisabled(e),this.spnTop.setDisabled(i),this.spnBottom.setDisabled(i),this.btnsCategory[4].setDisabled(t==Asc.c_oAscWrapStyle2.Inline)},onHAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HAlignType=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HAlignFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHPositionSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HPositionFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),!this._state.spnXChanged){var i=this._originalProps.get_Value_X(this._state.HPositionFrom);this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(i),!0)}this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue()))}},onHPositionPcSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._state.HPositionPcFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom),!this._state.spnXPcChanged){var i=this._originalProps.get_Value_X(this._state.HPositionPcFrom);this.spnXPc.setValue(parseFloat((100*i/this.pageWidth).toFixed(2)),!0)}this._changedProps.get_PositionH().put_Value(this.spnXPc.getNumberValue())}},onVAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VAlignType=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType))},onVRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VAlignFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Line||this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Paragraph,!0))},onVPositionSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VPositionFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),!this._state.spnYChanged){var i=this._originalProps.get_Value_Y(this._state.VPositionFrom);this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(i),!0)}this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Line||this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Paragraph,!0)}},onVPositionPcSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._state.VPositionPcFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom),!this._state.spnYPcChanged){var i=this._originalProps.get_Value_Y(this._state.VPositionPcFrom);this.spnYPc.setValue(parseFloat((100*i/this.pageHeight).toFixed(2)),!0)}this._changedProps.get_PositionV().put_Value(this.spnYPc.getNumberValue())}},onRadioHAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_UseAlign(e),e&&(this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom))),e&&(this.cmbHAlign.setDisabled(!1),this.cmbHAlign.focus(),this.cmbHRelative.setDisabled(!1),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this.spnXPc.setDisabled(!0),this.cmbHPositionPc.setDisabled(!0))},onRadioHPositionChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),e&&(this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Percent(!1),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom))),e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!1),this.spnX.focus(),this.cmbHPosition.setDisabled(!1),this.spnXPc.setDisabled(!0),this.cmbHPositionPc.setDisabled(!0))},onRadioHPositionPcChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CImagePositionH),this._changedProps.get_PositionH().put_Percent(e),e&&(this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_Value(this.spnXPc.getNumberValue()),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionPcFrom))),e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this.spnXPc.setDisabled(!1),this.spnXPc.focus(),this.cmbHPositionPc.setDisabled(!1))},onRadioVAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_UseAlign(e),e&&(this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom))),e&&(this.cmbVAlign.setDisabled(!1),this.cmbVAlign.focus(),this.cmbVRelative.setDisabled(!1),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Line||this._state.VAlignFrom==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!1),this.spnYPc.setDisabled(!0),this.cmbVPositionPc.setDisabled(!0))},onRadioVPositionChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),e&&(this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Percent(!1),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom))),e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!1),this.spnY.focus(),this.cmbVPosition.setDisabled(!1),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Line||this._state.VPositionFrom==Asc.c_oAscRelativeFromV.Paragraph,!0),this.chMove.setDisabled(!1),this.spnYPc.setDisabled(!0),this.cmbVPositionPc.setDisabled(!0))},onRadioVPositionPcChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CImagePositionV),this._changedProps.get_PositionV().put_Percent(e),e&&(this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_Value(this.spnYPc.getNumberValue()),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionPcFrom))),e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(!1,!0),this.chMove.setDisabled(!0),this.spnYPc.setDisabled(!1),this.spnYPc.focus(),this.cmbVPositionPc.setDisabled(!1))},onRadioHSizeChange:function(t,e,i){e&&(this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnShapeWidth.getNumberValue())),this._changedProps.put_SizeRelH(void 0),this.fillShapeHeight()),this.chRatio.setDisabled(this.radioVSizePc.getValue()),this.cmbWidthPc.setDisabled(!0),this.spnShapeWidthPc.setDisabled(!0),this.spnShapeWidth.setDisabled(!1),this.spnShapeWidth.focus())},onRadioHSizePcChange:function(t,e,i){e&&(this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight()),this.chRatio.setDisabled(!0),this.cmbWidthPc.setDisabled(!1),this.spnShapeWidthPc.setDisabled(!1),this.spnShapeWidthPc.focus(),this.spnShapeWidth.setDisabled(!0))},onRadioVSizeChange:function(t,e,i){e&&(this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnShapeHeight.getNumberValue())),this._changedProps.put_SizeRelV(void 0),this.fillShapeWidth()),this.chRatio.setDisabled(this.radioHSizePc.getValue()),this.cmbHeightPc.setDisabled(!0),this.spnShapeHeightPc.setDisabled(!0),this.spnShapeHeight.setDisabled(!1),this.spnShapeHeight.focus())},onRadioVSizePcChange:function(t,e,i){e&&(this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth()),this.chRatio.setDisabled(!0),this.cmbHeightPc.setDisabled(!1),this.spnShapeHeightPc.setDisabled(!1),this.spnShapeHeightPc.focus(),this.spnShapeHeight.setDisabled(!0))},onCmbWidthPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._state.ShapeWidthPcFrom=e.value,this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom),this.fillShapeHeight())},onCmbHeightPcSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._state.ShapeHeightPcFrom=e.value,this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom),this.fillShapeWidth())},fillShapeWidth:function(t,e){this.radioHSize.getValue()?this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnShapeWidth.getNumberValue())):(null!==this._changedProps.get_SizeRelH()&&void 0!==this._changedProps.get_SizeRelH()||this._changedProps.put_SizeRelH(new Asc.CImagePositionH),this._changedProps.get_SizeRelH().put_Value(this.spnShapeWidthPc.getNumberValue()),this._changedProps.get_SizeRelH().put_RelativeFrom(this._state.ShapeWidthPcFrom))},fillShapeHeight:function(t,e){this.radioVSize.getValue()?this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnShapeHeight.getNumberValue())):(null!==this._changedProps.get_SizeRelV()&&void 0!==this._changedProps.get_SizeRelV()||this._changedProps.put_SizeRelV(new Asc.CImagePositionV),this._changedProps.get_SizeRelV().put_Value(this.spnShapeHeightPc.getNumberValue()),this._changedProps.get_SizeRelV().put_RelativeFrom(this._state.ShapeHeightPcFrom))},_updateSizeArr:function(t,e,i,n){i.get("value")>0?(e.store.each((function(t){t.set({typearrow:i.get("idsvg")})}),this),t.setDisabled(!1),t.selectRecord(null!==n?e.store.at(n):null)):(t.updateFormControl(),t.setDisabled(!0))},updateFormControl:function(t){var e=$(this.el).find(".form-control > .img-arrows use");if(e.length){var i="";if(t){var n=t.get("idsvg");i=void 0!==n?n+"arrow-5":t.get("typearrow")+"arrow-"+(t.get("value")+1)}e[0].setAttribute("xlink:href","#"+i)}},onSelectBeginStyle:function(t,e,i,n,s){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linebeginstyle(n.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,n,this._beginSizeIdx)},onSelectBeginSize:function(t,e,i,n,s){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_linebeginsize(n.get("type"))),this._beginSizeIdx=n.get("value")},onSelectEndStyle:function(t,e,i,n,s){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_lineendstyle(n.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,n,this._endSizeIdx)},onSelectEndSize:function(t,e,i,n,s){this._changedShapeProps&&(null===this._changedShapeProps.get_stroke()&&this._changedShapeProps.put_stroke(new Asc.asc_CStroke),this._changedShapeProps.get_stroke().put_lineendsize(n.get("type"))),this._endSizeIdx=n.get("value")},textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textOriginalSize:"Actual Size",textPosition:"Position",textDistance:"Distance From Text",textSize:"Size",textWrap:"Wrapping Style",textWidth:"Width",textHeight:"Height",textWrapInlineTooltip:"Inline",textWrapSquareTooltip:"Square",textWrapTightTooltip:"Tight",textWrapThroughTooltip:"Through",textWrapTopbottomTooltip:"Top and Bottom",textWrapBehindTooltip:"Behind",textWrapInFrontTooltip:"In Front",textTitle:"Image - Advanced Settings",textKeepRatio:"Constant Proportions",textBtnWrap:"Text Wrapping",textCenter:"Center",textCharacter:"Character",textColumn:"Column",textLeftMargin:"Left Margin",textMargin:"Margin",textPage:"Page",textRightMargin:"Right Margin",textLine:"Line",textBottomMargin:"Bottom Margin",textParagraph:"Paragraph",textTopMargin:"Top Margin",textHorizontal:"Horizontal",textVertical:"Vertical",textAlignment:"Alignment",textRelative:"relative to",textRightOf:"to the right Of",textBelow:"below",textOverlap:"Allow overlap",textMove:"Move object with text",textOptions:"Options",textShape:"Shape Settings",textTitleShape:"Shape - Advanced Settings",textTitleChart:"Chart - Advanced Settings",strMargins:"Text Padding",textRound:"Round",textMiter:"Miter",textSquare:"Square",textFlat:"Flat",textBevel:"Bevel",textArrows:"Arrows",textLineStyle:"Line Style",textCapType:"Cap Type",textJoinType:"Join Type",textBeginStyle:"Begin Style",textBeginSize:"Begin Size",textEndStyle:"End Style",textEndSize:"End Size",textPositionPc:"Relative position",textAspectRatio:"Lock aspect ratio",textAbsoluteWH:"Absolute",textRelativeWH:"Relative",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textWeightArrows:"Weights & Arrows",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textTextBox:"Text Box",textAutofit:"AutoFit",textResizeFit:"Resize shape to fit text"},DE.Views.ImageSettingsAdvanced||{}))})),define("text!documenteditor/main/app/template/TableSettingsAdvanced.template",[],(function(){return'<div id="id-adv-table-width" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="3" role="presentation">\r\n            <tr>\r\n                <td colspan="3" class="padding-small">\r\n                    <label class="header"><%= scope.textTableSize %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 11px;">\r\n                    <div id="tableadv-checkbox-width"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textWidth %></label>\r\n                    <div id="tableadv-number-width" class="margin-right-10"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textMeasure %></label>\r\n                    <div id="tableadv-cmb-unit" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="3" class="padding-large">\r\n                    <div id="tableadv-checkbox-autofit"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-small"></div>\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textDefaultMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="tableadv-number-margin-table-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="tableadv-number-margin-table-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="tableadv-number-margin-table-bottom"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="tableadv-number-margin-table-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-small"></div>\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label class="header"><%= scope.textOptions %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                    <div id="tableadv-checkbox-spacing"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textAllowSpacing %></label>\r\n                    <div id="tableadv-number-spacing"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="inner-content">\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-cell-props" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="3" role="presentation">\r\n            <tr>\r\n                <td colspan="3" class="padding-small">\r\n                    <label class="header"><%= scope.textCellSize %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                    <div id="tableadv-checkbox-prefwidth"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label margin-right-10"><%= scope.textPrefWidth %></label>\r\n                    <div id="tableadv-number-prefwidth" class="margin-right-10"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textMeasure %></label>\r\n                    <div id="tableadv-combo-prefwidth-unit" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-small"></div>\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <div id="tableadv-checkbox-margins"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="tableadv-number-margin-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="tableadv-number-margin-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="tableadv-number-margin-bottom"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="tableadv-number-margin-right"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small"></td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textCellOptions %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <div id="tableadv-checkbox-wrap"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-wrap" class="settings-panel">\r\n    <div class="inner-content padding-large">\r\n        <label class="header padding-small" style="display: block;"><%= scope.textWrappingStyle %></label>\r\n        <div id="tableadv-button-wrap-none" class="margin-right-5" style="display: inline-block;"></div>\r\n        <div id="tableadv-button-wrap-parallel" class="margin-right-5" style="display: inline-block;"></div>\r\n    </div>\r\n    <div class="padding-small"></div>\r\n    <div class="inner-content">\r\n        <div id="tableadv-panel-align" style="width: 100%;">\r\n            <label class="header padding-small"><%= scope.textAlign %></label>\r\n            <div class="padding-large">\r\n                <div id="tableadv-button-align-left" class="margin-right-5" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-align-center" class="margin-right-5" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-align-right" class="margin-right-5" style="display: inline-block;"></div>\r\n                <div class="margin-left-20" style="display: inline-block; vertical-align: bottom; margin-bottom: 1px;">\r\n                    <label class="input-label" style="display: block;"><%= scope.textIndLeft %></label>\r\n                    <div id="tableadv-number-indent"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id="tableadv-panel-distance" class="settings-hidden" style="width: 100%;">\r\n            <table cols="2" style="width: 100%;" role="presentation">\r\n                <tr>\r\n                    <td colspan=2 class="padding-small">\r\n                        <label class="header"><%= scope.textDistance %></label>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td class="padding-small" width="125px">\r\n                        <label class="input-label"><%= scope.textTop %></label>\r\n                        <div id="tableadv-number-distance-top"></div>\r\n                    </td>\r\n                    <td class="padding-small">\r\n                        <label class="input-label"><%= scope.textLeft %></label>\r\n                        <div id="tableadv-number-distance-left"></div>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td class="padding-small">\r\n                        <label class="input-label"><%= scope.textBottom %></label>\r\n                        <div id="tableadv-number-distance-bottom"></div>\r\n                    </td>\r\n                    <td class="padding-small">\r\n                        <label class="input-label"><%= scope.textRight %></label>\r\n                        <div id="tableadv-number-distance-right"></div>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-borders" class="settings-panel">\r\n    <div class="inner-content padding-large">\r\n        <div class="settings-wrap">\r\n            <label class="input-label"><%= scope.textBorderWidth %></label>\r\n            <div id="tableadv-combo-border-size" class="margin-left-3"></div>\r\n            <div class="border-color">\r\n                <label class="input-label" ><%= scope.textBorderColor %></label>\r\n                <div id="tableadv-border-color-btn" class="margin-left-3"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="inner-content">\r\n        <label class="input-label padding-large" style="width: 100%;"><%= scope.textBorderDesc %></label>\r\n        <div id="tableadv-panel-borders" style="width: 100%;" class="padding-large">\r\n            <div id="id-detablestyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 200px;outline: 1px solid #ccc;"></div>\r\n            <div class="border-types" style="display: inline-block; vertical-align: middle; width: 76px; height: 200px; padding-top: 10px;">\r\n                <div id="tableadv-button-border-all"></div>\r\n                <div id="tableadv-button-border-none"></div>\r\n                <div id="tableadv-button-border-inner"></div>\r\n                <div id="tableadv-button-border-outer"></div>\r\n            </div>\r\n        </div>\r\n        <div id="tableadv-panel-borders-spacing" style="width: 100%;" class="padding-large settings-hidden">\r\n            <div id="id-detablestyler-spacing" style="display: inline-block; vertical-align: middle; width: 200px; height: 200px;outline: 1px solid #ccc;"></div>\r\n            <div style="display: inline-block; vertical-align: middle; width: 76px; height: 200px; padding-top: 10px;" class="float-right">\r\n                <div id="tableadv-button-border-all-none" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-all-table" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-none-none" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-none-table" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-inner-none" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-inner-table" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-outer-none" style="display: inline-block;"></div>\r\n                <div id="tableadv-button-border-outer-table" style="display: inline-block;"></div>\r\n            </div>\r\n        </div>\r\n        <div style="width: 100%;">\r\n            <div id="tableadv-panel-table-back">\r\n                <label class="input-label margin-right-5"><%= scope.textTableBackColor %></label>\r\n                <div id="tableadv-button-table-back-color"></div>\r\n            </div>\r\n            <div id="tableadv-panel-cell-back">\r\n                <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\r\n                <div id="tableadv-button-back-color"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-position" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="3" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="3" class="padding-small">\r\n                    <label class="header"><%= scope.textHorizontal %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\r\n                    <div id="tableadv-radio-halign"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textAlignment %></label>\r\n                    <div id="tableadv-combo-halign" style="width: 115px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="tableadv-combo-hrelative" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\r\n                    <div id="tableadv-radio-hposition"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textPosition %></label>\r\n                    <div id="tableadv-spin-x"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRightOf %></label>\r\n                    <div id="tableadv-combo-hposition" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="3" class="padding-small">\r\n                    <label class="header"><%= scope.textVertical %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 12px;">\r\n                    <div id="tableadv-radio-valign"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textAlignment %></label>\r\n                    <div id="tableadv-combo-valign" style="width: 115px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRelative %></label>\r\n                    <div id="tableadv-combo-vrelative" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td style="vertical-align: bottom; padding-bottom: 19px;">\r\n                    <div id="tableadv-radio-vposition"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textPosition %></label>\r\n                    <div id="tableadv-spin-y"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textBelow %></label>\r\n                    <div id="tableadv-combo-vposition" style="width: 115px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label class="header"><%= scope.textOptions %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <div id="tableadv-checkbox-move"></div>\r\n                </td>\r\n                <td>\r\n                    <div id="tableadv-checkbox-overlap"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="table-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="table-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("documenteditor/main/app/view/TableSettingsAdvanced",["text!documenteditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/component/TableStyler","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:340,contentHeight:351,toggleGroup:"table-adv-settings-group",storageName:"de-table-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-width",panelCaption:this.textTable},{panelId:"id-adv-table-cell-props",panelCaption:this.textCellProps},{panelId:"id-adv-table-borders",panelCaption:this.textBordersBackgroung},{panelId:"id-adv-table-position",panelCaption:this.textTablePosition},{panelId:"id-adv-table-wrap",panelCaption:this.textWrap},{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._changedProps=null,this._cellBackground=null,this._state={HAlignType:Asc.c_oAscXAlign.Left,HAlignFrom:Asc.c_oAscHAnchor.Margin,HPositionFrom:Asc.c_oAscHAnchor.Margin,VAlignType:Asc.c_oAscYAlign.Top,VAlignFrom:Asc.c_oAscVAnchor.Margin,VPositionFrom:Asc.c_oAscVAnchor.Margin,spnXChanged:!1,spnYChanged:!1,fromWrapInline:!1,verticalPropChanged:!1,horizontalPropChanged:!1,alignChanged:!1},this._allTable=!1,this.TableMargins={Left:.19,Right:.19,Top:0,Bottom:0},this.CellMargins={Left:.19,Right:.19,Top:null,Bottom:null,Flag:0},this.TableBorders={},this.CellBorders={},this.ChangedTableBorders=void 0,this.ChangedCellBorders=void 0,this.BorderSize={ptValue:0,pxValue:0},this.TableColor={Value:1,Color:"transparent"},this.CellColor={Value:1,Color:"transparent"},this.IndeterminateColor="#C8C8C8",this.IndeterminateSize=4.5,this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.borderProps=this.options.borderProps,this.pageWidth=210,this._originalProps=new Asc.CTableProp(this.options.tableProps)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this._marginsChange=function(t,e,i,n,s,o){"table"==s?this.TableMargins[o]=t.getNumberValue():this.CellMargins[o]=t.getNumberValue()},this.chWidth=new Common.UI.CheckBox({el:$("#tableadv-checkbox-width"),value:!0,labelText:""}),this.chWidth.on("change",_.bind((function(t,e,i,n){var s="checked"==e;this.nfWidth.setDisabled(!s),this.cmbUnit.setDisabled(!s),this._changedProps&&(s&&this.nfWidth.getNumberValue()>0?this._changedProps.put_Width(this.cmbUnit.getValue()?-this.nfWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfWidth.getNumberValue())):this._changedProps.put_Width(null))}),this)),this.nfWidth=new Common.UI.MetricSpinner({el:$("#tableadv-number-width"),step:.1,width:115,defaultUnit:"cm",value:"10 cm",maxValue:55.88,minValue:0}),this.nfWidth.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_Width(this.cmbUnit.getValue()?-t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this));var e=Common.Utils.Metric.getCurrentMetric();this.cmbUnit=new Common.UI.ComboBox({el:$("#tableadv-cmb-unit"),style:"width: 115px;",menuStyle:"min-width: 115px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:e==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:e==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm},{value:1,displayValue:this.txtPercent}],takeFocusOnClose:!0}),this.cmbUnit.on("selected",_.bind((function(t,e){if(this._changedProps){var i=Common.Utils.Metric.fnRecalcFromMM(558);this.nfWidth.setDefaultUnit(e.value?"%":Common.Utils.Metric.getCurrentMetricName()),this.nfWidth.setMaxValue(e.value?parseFloat((100*i/this.pageWidth).toFixed(2)):i),this.nfWidth.setStep(e.value||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),this.nfWidth.setValue(e.value?100*this.nfWidth.getNumberValue()/this.pageWidth:this.pageWidth*this.nfWidth.getNumberValue()/100),this._changedProps.put_Width(e.value?-this.nfWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfWidth.getNumberValue()))}}),this)),this.chAllowSpacing=new Common.UI.CheckBox({el:$("#tableadv-checkbox-spacing"),value:!0,labelText:""}),this.chAllowSpacing.on("change",_.bind((function(t,e,i,n){var s="checked"==e;this._changedProps&&(this.nfSpacing.setDisabled(!s),this.ShowHideSpacing(s),this._changedProps&&(s&&this.nfSpacing.getNumberValue()>0?this._changedProps.put_Spacing(Common.Utils.Metric.fnRecalcToMM(this.nfSpacing.getNumberValue())):this._changedProps.put_Spacing(null)))}),this)),this.nfSpacing=new Common.UI.MetricSpinner({el:$("#tableadv-number-spacing"),step:.1,width:115,defaultUnit:"cm",value:"0.5 cm",maxValue:2.14,minValue:0}),this.nfSpacing.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_Spacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.nfSpacing),this.chAutofit=new Common.UI.CheckBox({el:$("#tableadv-checkbox-autofit"),value:!0,labelText:this.textAutofit}),this.chAutofit.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_TableLayout("checked"==t.getValue()?Asc.c_oAscTableLayout.AutoFit:Asc.c_oAscTableLayout.Fixed)}),this)),this.spnTableMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginTop.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Top"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Top(null!==this.TableMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Top):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginTop),this.spnTableMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginBottom.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Bottom"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Bottom(null!==this.TableMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Bottom):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginBottom),this.spnTableMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnTableMarginLeft.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Left"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Left(null!==this.TableMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Left):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginLeft),this.spnTableMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnTableMarginRight.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Right"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Right(null!==this.TableMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Right):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginRight);var i=function(){"indeterminate"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(1):"checked"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(0):t._changedProps.get_CellMargins().put_Flag(2)};this.chCellMargins=new Common.UI.CheckBox({el:$("#tableadv-checkbox-margins"),value:!0,labelText:this.textCheckMargins}),this.chCellMargins.on("change",_.bind((function(t,e,n,s){"checked"==n&&this._originalProps&&1==this._originalProps.get_CellMargins().get_Flag()&&t.setValue("indeterminate",!0),this.fillMargins.call(this,t.getValue()),this.CellMargins.Flag=t.getValue(),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),i())}),this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,n,s){this._marginsChange(t,e,n,s,"cell","Top"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),i())}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,n,s){this._marginsChange(t,e,n,s,"cell","Bottom"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),i())}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,n,s){this._marginsChange(t,e,n,s,"cell","Left"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),i())}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,n,s){this._marginsChange(t,e,n,s,"cell","Right"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),i())}),this)),this.spinners.push(this.spnMarginRight),this.chPrefWidth=new Common.UI.CheckBox({el:$("#tableadv-checkbox-prefwidth"),value:!1,labelText:""}),this.chPrefWidth.on("change",_.bind((function(t,e,i,n){var s="checked"==e;this.nfPrefWidth.setDisabled(!s),this.cmbPrefWidthUnit.setDisabled(!s),this._changedProps&&(s&&this.nfPrefWidth.getNumberValue()>0?this._changedProps.put_CellsWidth(this.cmbPrefWidthUnit.getValue()?-this.nfPrefWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfPrefWidth.getNumberValue())):this._changedProps.put_CellsWidth(null))}),this)),this.nfPrefWidth=new Common.UI.MetricSpinner({el:$("#tableadv-number-prefwidth"),step:.1,width:115,defaultUnit:"cm",value:"10 cm",maxValue:55.88,minValue:0}),this.nfPrefWidth.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_CellsWidth(this.cmbPrefWidthUnit.getValue()?-t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.cmbPrefWidthUnit=new Common.UI.ComboBox({el:$("#tableadv-combo-prefwidth-unit"),style:"width: 115px;",menuStyle:"min-width: 115px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:e==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:e==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm},{value:1,displayValue:this.txtPercent}],takeFocusOnClose:!0}),this.cmbPrefWidthUnit.on("selected",_.bind((function(t,e){if(this._changedProps){var i=e.value?"%":Common.Utils.Metric.getCurrentMetricName();if(this.nfPrefWidth.getUnitValue()!==i){var n=Common.Utils.Metric.fnRecalcFromMM(558);this.nfPrefWidth.setDefaultUnit(i),this.nfPrefWidth.setMaxValue(e.value?parseFloat((100*n/this.pageWidth).toFixed(2)):n),this.nfPrefWidth.setStep(e.value||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),this.nfPrefWidth.setValue(e.value?100*this.nfPrefWidth.getNumberValue()/this.pageWidth:this.pageWidth*this.nfPrefWidth.getNumberValue()/100),this._changedProps.put_CellsWidth(e.value?-this.nfPrefWidth.getNumberValue():Common.Utils.Metric.fnRecalcToMM(this.nfPrefWidth.getNumberValue()))}}}),this)),this.chWrapText=new Common.UI.CheckBox({el:$("#tableadv-checkbox-wrap"),value:!1,labelText:this.textWrapText}),this.chWrapText.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_CellsNoWrap("checked"!=t.getValue())}),this)),this.btnWrapNone=new Common.UI.Button({parentEl:$("#tableadv-button-wrap-none"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-center",posId:c_tableWrap.TABLE_WRAP_NONE,hint:this.textWrapNoneTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablewrapGroup"}),this.btnWrapNone.on("click",_.bind(this.onBtnInlineWrapClick,this)),this.btnWrapParallel=new Common.UI.Button({parentEl:$("#tableadv-button-wrap-parallel"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-flow",posId:c_tableWrap.TABLE_WRAP_PARALLEL,hint:this.textWrapParallelTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablewrapGroup"}),this.btnWrapParallel.on("click",_.bind(this.onBtnFlowWrapClick,this)),this.btnAlignLeft=new Common.UI.Button({parentEl:$("#tableadv-button-align-left"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-left",posId:c_tableAlign.TABLE_ALIGN_LEFT,hint:this.textLeftTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignLeft.on("click",_.bind((function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(this.spnIndentLeft.getNumberValue())),this.spnIndentLeft.setDisabled(!t.pressed),this._state.alignChanged=!0)}),this)),this.btnAlignCenter=new Common.UI.Button({parentEl:$("#tableadv-button-align-center"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-center",posId:c_tableAlign.TABLE_ALIGN_CENTER,hint:this.textCenterTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignCenter.on("click",_.bind((function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(0),this.spnIndentLeft.setDisabled(t.pressed),this._state.alignChanged=!0)}),this)),this.btnAlignRight=new Common.UI.Button({parentEl:$("#tableadv-button-align-right"),cls:"btn-options huge-1",iconCls:"options__icon options__icon-huge btn-table-align-right",posId:c_tableAlign.TABLE_ALIGN_RIGHT,hint:this.textRightTooltip,enableToggle:!0,allowDepress:!1,toggleGroup:"advtablealignGroup"}),this.btnAlignRight.on("click",_.bind((function(t){this._changedProps&&t.pressed&&(this._changedProps.put_TableAlignment(t.options.posId),this._changedProps.put_TableIndent(0),this.spnIndentLeft.setDisabled(t.pressed),this._state.alignChanged=!0)}),this)),this.spnIndentLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-indent"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:38.09,minValue:-38.09}),this.spnIndentLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnIndentLeft),this.spnDistanceTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-top"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnDistanceTop.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnDistanceTop),this.spnDistanceBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-bottom"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnDistanceBottom.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnDistanceBottom),this.spnDistanceLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-left"),step:.1,width:85,defaultUnit:"cm",value:"1 cm",maxValue:9.34,minValue:0}),this.spnDistanceLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnDistanceLeft),this.spnDistanceRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-distance-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnDistanceRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(void 0===this._changedProps.get_TablePaddings()&&this._changedProps.put_TablePaddings(new Asc.asc_CPaddings),this._changedProps.get_TablePaddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnDistanceRight),this.spnX=new Common.UI.MetricSpinner({el:$("#tableadv-spin-x"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"1 cm",maxValue:55.87,minValue:-55.87}),this.spnX.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnXChanged=!0)}),this)),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#tableadv-spin-y"),step:.1,width:115,disabled:!0,defaultUnit:"cm",defaultValue:0,value:"1 cm",maxValue:55.87,minValue:-55.87}),this.spnY.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._state.spnYChanged=!0)}),this)),this.spinners.push(this.spnY),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscXAlign.Left},{displayValue:this.textCenter,value:Asc.c_oAscXAlign.Center},{displayValue:this.textRight,value:Asc.c_oAscXAlign.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#tableadv-combo-halign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHAlign,takeFocusOnClose:!0}),this.cmbHAlign.setValue(this._state.HAlignType),this.cmbHAlign.on("selected",_.bind(this.onHAlignSelect,this)),this._arrHRelative=[{displayValue:this.textMargin,value:Asc.c_oAscHAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscHAnchor.Page},{displayValue:this.textAnchorText,value:Asc.c_oAscHAnchor.Text}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#tableadv-combo-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHRelative.setValue(this._state.HAlignFrom),this.cmbHRelative.on("selected",_.bind(this.onHRelativeSelect,this)),this.cmbHPosition=new Common.UI.ComboBox({el:$("#tableadv-combo-hposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrHRelative,takeFocusOnClose:!0}),this.cmbHPosition.setDisabled(!0),this.cmbHPosition.setValue(this._state.HPositionFrom),this.cmbHPosition.on("selected",_.bind(this.onHPositionSelect,this)),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscYAlign.Top},{displayValue:this.textCenter,value:Asc.c_oAscYAlign.Center},{displayValue:this.textBottom,value:Asc.c_oAscYAlign.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#tableadv-combo-valign"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVAlign,takeFocusOnClose:!0}),this.cmbVAlign.setValue(this._state.VAlignType),this.cmbVAlign.on("selected",_.bind(this.onVAlignSelect,this)),this._arrVRelative=[{displayValue:this.textMargin,value:Asc.c_oAscVAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscVAnchor.Page},{displayValue:this.textAnchorText,value:Asc.c_oAscVAnchor.Text}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#tableadv-combo-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVRelative.setValue(this._state.VAlignFrom),this.cmbVRelative.on("selected",_.bind(this.onVRelativeSelect,this)),this.cmbVPosition=new Common.UI.ComboBox({el:$("#tableadv-combo-vposition"),cls:"input-group-nr",menuStyle:"min-width: 115px;",editable:!1,data:this._arrVRelative,takeFocusOnClose:!0}),this.cmbVPosition.setDisabled(!0),this.cmbVPosition.setValue(this._state.VPositionFrom),this.cmbVPosition.on("selected",_.bind(this.onVPositionSelect,this)),this.radioHAlign=new Common.UI.RadioBox({el:$("#tableadv-radio-halign"),name:"asc-radio-horizontal",checked:!0}),this.radioHAlign.on("change",_.bind(this.onRadioHAlignChange,this)),this.radioHPosition=new Common.UI.RadioBox({el:$("#tableadv-radio-hposition"),name:"asc-radio-horizontal"}),this.radioHPosition.on("change",_.bind(this.onRadioHPositionChange,this)),this.radioVAlign=new Common.UI.RadioBox({el:$("#tableadv-radio-valign"),name:"asc-radio-vertical",checked:!0}),this.radioVAlign.on("change",_.bind(this.onRadioVAlignChange,this)),this.radioVPosition=new Common.UI.RadioBox({el:$("#tableadv-radio-vposition"),name:"asc-radio-vertical"}),this.radioVPosition.on("change",_.bind(this.onRadioVPositionChange,this)),this.chMove=new Common.UI.CheckBox({el:$("#tableadv-checkbox-move"),labelText:this.textMove}),this.chMove.on("change",_.bind((function(t,e,i,n){if(this._changedProps){var s,o=this._arrVRelative["checked"==t.getValue()?2:1].value;if(this.cmbVRelative.isDisabled())this.cmbVPosition.setValue(o),(s=this.cmbVPosition.getSelectedRecord())&&this.onVPositionSelect(this.cmbVPosition,s);else this.cmbVRelative.setValue(o),(s=this.cmbVRelative.getSelectedRecord())&&this.onVRelativeSelect(this.cmbVRelative,s)}}),this)),this.chOverlap=new Common.UI.CheckBox({el:$("#tableadv-checkbox-overlap"),labelText:this.textOverlap}),this.chOverlap.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_AllowOverlap("checked"==t.getValue())}),this)),this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#tableadv-combo-border-size"),style:"width: 93px;",takeFocusOnClose:!0});var n=this.cmbBorderSize.store.at(1);this.BorderSize={ptValue:n.get("value"),pxValue:n.get("pxValue")},this.cmbBorderSize.setValue(this.BorderSize.ptValue),this.cmbBorderSize.on("selected",_.bind(this.onBorderSizeSelect,this)),this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#tableadv-border-color-btn"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,takeFocusOnClose:!0}),this.btnBorderColor.on("color:select",_.bind(t.onColorsBorderSelect,t)),this.btnBorderColor.on("auto:select",_.bind(t.onColorsBorderSelect,t)),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#tableadv-button-back-color"),additionalAlign:this.menuAddAlign,transparent:!0,takeFocusOnClose:!0}),this.btnBackColor.on("color:select",_.bind(this.onColorsBackSelect,this)),this.colorsBack=this.btnBackColor.getPicker(),this.btnTableBackColor=new Common.UI.ColorButton({parentEl:$("#tableadv-button-table-back-color"),additionalAlign:this.menuAddAlign,transparent:!0,takeFocusOnClose:!0}),this.btnTableBackColor.on("color:select",_.bind(this.onColorsTableBackSelect,this)),this.colorsTableBack=this.btnTableBackColor.getPicker(),this.tableBordersImageSpacing=new Common.UI.TableStyler({el:$("#id-detablestyler-spacing"),width:200,height:200,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!0}),this.tableBordersImage=new Common.UI.TableStyler({el:$("#id-detablestyler"),width:200,height:200,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1});var s=[["cm","toolbar__icon toolbar__icon-big btn-borders-inner-only","tableadv-button-border-inner",this.tipInner],["lrtb","toolbar__icon toolbar__icon-big btn-borders-outer-only","tableadv-button-border-outer",this.tipOuter],["lrtbcm","toolbar__icon toolbar__icon-big btn-borders-all","tableadv-button-border-all",this.tipAll],["","toolbar__icon toolbar__icon-big btn-borders-none","tableadv-button-border-none",this.tipNone]];this._btnsBorderPosition=[],_.each(s,(function(t,e,i){var n=new Common.UI.Button({parentEl:$("#"+t[2]),cls:"btn-options large border-off",iconCls:t[1],strId:t[0],hint:t[3]});n.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsBorderPosition.push(n)}),this);var o=[["cm","","toolbar__icon toolbar__icon-big btn-borders-twin-none-inner","tableadv-button-border-inner-none",this.tipCellInner],["lrtb","","toolbar__icon toolbar__icon-big btn-borders-twin-none-outer","tableadv-button-border-outer-none",this.tipCellOuter],["lrtbcm","","toolbar__icon toolbar__icon-big btn-borders-twin-none-all","tableadv-button-border-all-none",this.tipCellAll],["","","toolbar__icon toolbar__icon-big btn-borders-twin-none","tableadv-button-border-none-none",this.tipNone],["lrtbcm","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-all","tableadv-button-border-all-table",this.tipTableOuterCellAll],["","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-none","tableadv-button-border-none-table",this.tipOuter],["cm","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-inner","tableadv-button-border-inner-table",this.tipTableOuterCellInner],["lrtb","lrtb","toolbar__icon toolbar__icon-big btn-borders-twin-outer-outer","tableadv-button-border-outer-table",this.tipTableOuterCellOuter]];this._btnsTableBorderPosition=[],_.each(o,(function(t,e,i){var n=new Common.UI.Button({parentEl:$("#"+t[3]),style:"margin-bottom: 4px;",cls:"btn-options large border-off  margin-left-4",iconCls:t[2],strCellId:t[0],strTableId:t[1],hint:t[4]});n.on("click",_.bind(this._ApplyBorderPreset,this)),this._btnsTableBorderPosition.push(n)}),this),this.inputAltTitle=new Common.UI.InputField({el:$("#table-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.AlignContainer=$("#tableadv-panel-align"),this.DistanceContainer=$("#tableadv-panel-distance"),this.BordersContainer=$("#tableadv-panel-borders"),this.BordersSpacingContainer=$("#tableadv-panel-borders-spacing"),this.CellBackContainer=$("#tableadv-panel-cell-back"),this.TableBackContainer=$("#tableadv-panel-table-back"),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.chWidth,this.nfWidth,this.cmbUnit,this.chAutofit,this.spnTableMarginTop,this.spnTableMarginLeft,this.spnTableMarginBottom,this.spnTableMarginRight,this.chAllowSpacing,this.nfSpacing,this.chPrefWidth,this.nfPrefWidth,this.cmbPrefWidthUnit,this.chCellMargins,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.chWrapText,this.cmbBorderSize,this.btnBorderColor]).concat(this._btnsBorderPosition).concat(this._btnsTableBorderPosition).concat([this.btnBackColor,this.btnTableBackColor,this.radioHAlign,this.cmbHAlign,this.radioHPosition,this.cmbHRelative,this.spnX,this.cmbHPosition,this.radioVAlign,this.cmbVAlign,this.radioVPosition,this.cmbVRelative,this.spnY,this.cmbVPosition,this.chMove,this.chOverlap,this.btnWrapNone,this.btnWrapParallel,this.btnAlignLeft,this.btnAlignCenter,this.btnAlignRight,this.spnIndentLeft,this.spnDistanceTop,this.spnDistanceLeft,this.spnDistanceBottom,this.spnDistanceRight,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.nfWidth.isDisabled()?i.spnTableMarginTop.focus():i.nfWidth.focus();break;case 1:i.onCellCategoryClick(t),i.nfPrefWidth.isDisabled()?i.chPrefWidth.focus():i.nfPrefWidth.focus();break;case 2:i.cmbBorderSize.focus();break;case 3:i.cmbHAlign.isDisabled()?i.spnX.focus():i.cmbHAlign.focus();break;case 4:i.spnIndentLeft.isVisible()?i.spnIndentLeft.isDisabled()?i.btnWrapNone.focus():i.spnIndentLeft.focus():i.spnDistanceTop.focus();break;case 5:i.inputAltTitle.focus()}}),10)},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this._originalProps);var t="object"==typeof this.CellColor.Color?this.CellColor.Color.color:this.CellColor.Color,e="object"==typeof this.TableColor.Color?this.TableColor.Color.color:this.TableColor.Color;if(this.tableBordersImageSpacing.setTableColor(e),this.tableBordersImage.setTableColor(e),this.tableBordersImageSpacing.setCellsColor(t),this.tableBordersImage.setCellsColor(this._allTable?e:t),"transparent"!=i&&(this.tableBordersImage.redrawTable(),this.tableBordersImageSpacing.redrawTable()),void 0!==this.borderProps){this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor);var i="object"==typeof this.btnBorderColor.color?this.btnBorderColor.color.color:this.btnBorderColor.color;this.tableBordersImageSpacing.setVirtualBorderColor(i),this.tableBordersImage.setVirtualBorderColor(i),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue);var n=this.cmbBorderSize.getSelectedRecord();n&&this.onBorderSizeSelect(this.cmbBorderSize,n)}if(this.tableBordersImageSpacing.on("borderclick:cellborder",(function(t,e,i,n){void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateCellBordersStyle(t,e,i,n,this.CellBorders,this.ChangedCellBorders)}),this),this.tableBordersImageSpacing.on("borderclick",(function(t,e,i,n){void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders),this._UpdateTableBordersStyle(t,e,i,n,this.TableBorders,this.ChangedTableBorders)}),this),this.tableBordersImage.on("borderclick",(function(t,e,i,n){this._allTable?void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders):void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateTableBordersStyle(t,e,i,n,this._allTable?this.TableBorders:this.CellBorders,this._allTable?this.ChangedTableBorders:this.ChangedCellBorders)}),this),this.tableBordersImage.on("borderclick:cellborder",(function(t,e,i,n){this._allTable?void 0===this.ChangedTableBorders&&(this.ChangedTableBorders=new Asc.CBorders):void 0===this.ChangedCellBorders&&(this.ChangedCellBorders=new Asc.CBorders),this._UpdateCellBordersStyle(t,e,i,n,this._allTable?this.TableBorders:this.CellBorders,this._allTable?this.ChangedTableBorders:this.ChangedCellBorders)}),this),this.storageName){var s=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==s?parseInt(s):0)}},getSettings:function(){return this._cellBackground&&(this._allTable&&(null===this._changedProps.get_Spacing()||void 0===this._changedProps.get_Spacing()&&null===this._originalProps.get_Spacing())?this._changedProps.put_CellsBackground(null):this._changedProps.put_CellsBackground(this._cellBackground)),null===this.ChangedTableBorders?this._changedProps.put_TableBorders(this.TableBorders):void 0!==this.ChangedTableBorders&&this._changedProps.put_TableBorders(this.ChangedTableBorders),null===this.ChangedCellBorders?this._changedProps.put_CellBorders(this.CellBorders):void 0!==this.ChangedCellBorders&&this._changedProps.put_CellBorders(this.ChangedCellBorders),this.isAltTitleChanged&&this._changedProps.put_TableCaption(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.put_TableDescription(this.textareaAltDescription.val()),{tableProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},_setDefaults:function(t){if(t){this._allTable=!t.get_CellSelect(),this.pageWidth=Common.Utils.Metric.fnRecalcFromMM(t.get_PercentFullWidth());var e,i=t.get_Width(),n=Common.Utils.Metric.getCurrentMetric();this.cmbUnit.store.at(0).set("displayValue",n==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:n==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm),this.cmbUnit.setValue(i<0?1:0),this.nfWidth.setDefaultUnit(i<0?"%":Common.Utils.Metric.getCurrentMetricName()),i<0&&this.nfWidth.setMaxValue(parseFloat((100*Common.Utils.Metric.fnRecalcFromMM(558)/this.pageWidth).toFixed(2))),this.nfWidth.setStep(i<0||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),null!==i&&this.nfWidth.setValue(i>0?Common.Utils.Metric.fnRecalcFromMM(i):-i,!0),this.chWidth.setValue(null!==i,!0),e="checked"!==this.chWidth.getValue(),this.nfWidth.setDisabled(e),this.cmbUnit.setDisabled(e);var s=t.get_Spacing();null!==s&&this.nfSpacing.setValue(Common.Utils.Metric.fnRecalcFromMM(s),!0),this.chAllowSpacing.setValue(null!==s,!0),this.nfSpacing.setDisabled("checked"!==this.chAllowSpacing.getValue());var o=t.get_TableLayout();this.chAutofit.setDisabled(void 0===o),this.chAutofit.setValue(o===Asc.c_oAscTableLayout.AutoFit,!0);var a=t.get_DefaultMargins();a&&(this.TableMargins={Left:null!==a.get_Left()?Common.Utils.Metric.fnRecalcFromMM(a.get_Left()):null,Right:null!==a.get_Right()?Common.Utils.Metric.fnRecalcFromMM(a.get_Right()):null,Top:null!==a.get_Top()?Common.Utils.Metric.fnRecalcFromMM(a.get_Top()):null,Bottom:null!==a.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(a.get_Bottom()):null});var l=void 0;(a=t.get_CellMargins())&&(this.CellMargins={Left:null!==a.get_Left()?Common.Utils.Metric.fnRecalcFromMM(a.get_Left()):null,Right:null!==a.get_Right()?Common.Utils.Metric.fnRecalcFromMM(a.get_Right()):null,Top:null!==a.get_Top()?Common.Utils.Metric.fnRecalcFromMM(a.get_Top()):null,Bottom:null!==a.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(a.get_Bottom()):null},l=a.get_Flag(),this.CellMargins.Flag=1==l?"indeterminate":0==l?"checked":"unchecked",this.chCellMargins.setValue(this.CellMargins.Flag,!0)),0===l&&(null===this.CellMargins.Left&&(this.CellMargins.Left=this.TableMargins.Left),null===this.CellMargins.Top&&(this.CellMargins.Top=this.TableMargins.Top),null===this.CellMargins.Right&&(this.CellMargins.Right=this.TableMargins.Right),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=this.TableMargins.Bottom)),this.fillMargins(this.CellMargins.Flag);var r=t.get_CellsWidth();this.cmbPrefWidthUnit.store.at(0).set("displayValue",n==Common.Utils.Metric.c_MetricUnits.pt?this.txtPt:n==Common.Utils.Metric.c_MetricUnits.inch?this.txtInch:this.txtCm),this.cmbPrefWidthUnit.setValue(r<0?1:0),this.nfPrefWidth.setDefaultUnit(r<0?"%":Common.Utils.Metric.getCurrentMetricName()),r<0&&this.nfPrefWidth.setMaxValue(parseFloat((100*Common.Utils.Metric.fnRecalcFromMM(558)/this.pageWidth).toFixed(2))),this.nfPrefWidth.setStep(r<0||Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1),null!==r&&this.nfPrefWidth.setValue(r>0?Common.Utils.Metric.fnRecalcFromMM(r):-r,!0),this.chPrefWidth.setValue(t.get_CellsWidthNotEqual()?"indeterminate":null!==r,!0),e="checked"!==this.chPrefWidth.getValue(),this.nfPrefWidth.setDisabled(e),this.cmbPrefWidthUnit.setDisabled(e);var c=!t.get_CellsNoWrap();this.chWrapText.setValue(c,!0),this._TblWrapStyleChanged(t.get_TableWrap()),this.ShowHideWrap(t.get_TableWrap()===c_tableWrap.TABLE_WRAP_NONE),this.btnWrapParallel.setDisabled(!t.get_CanBeFlow());var d=t.get_TableAlignment();null!==d&&(this._TblAlignChanged(d),this.spnIndentLeft.setValue(d!==c_tableAlign.TABLE_ALIGN_LEFT?0:Common.Utils.Metric.fnRecalcFromMM(t.get_TableIndent()),!0),this.spnIndentLeft.setDisabled(d!==c_tableAlign.TABLE_ALIGN_LEFT)),this._state.alignChanged=!1;var h=t.get_TablePaddings();h&&(this.spnDistanceTop.setValue(Common.Utils.Metric.fnRecalcFromMM(h.get_Top()),!0),this.spnDistanceLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(h.get_Left()),!0),this.spnDistanceBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(h.get_Bottom()),!0),this.spnDistanceRight.setValue(Common.Utils.Metric.fnRecalcFromMM(h.get_Right()),!0));var p=t.get_PositionH();if(p){e=p.get_RelativeFrom();for(var m=0;m<this._arrHRelative.length;m++)if(e==this._arrHRelative[m].value){this.cmbHRelative.setValue(e),this.cmbHPosition.setValue(e),this._state.HPositionFrom=e,this._state.HAlignFrom=e;break}if(p.get_UseAlign()){e=p.get_Align();for(m=0;m<this._arrHAlign.length;m++)if(e==this._arrHAlign[m].value){this.cmbHAlign.setValue(e),this._state.HAlignType=e;break}e=this._originalProps.get_Value_X(this._state.HPositionFrom),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e))}else this.radioHPosition.setValue(!0),e=p.get_Value(),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e))}else e=this._originalProps.get_Value_X(this._state.HPositionFrom),this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(e));if(p=t.get_PositionV()){for(e=p.get_RelativeFrom(),m=0;m<this._arrVRelative.length;m++)if(e==this._arrVRelative[m].value){this.cmbVRelative.setValue(e),this.cmbVPosition.setValue(e),this._state.VAlignFrom=e,this._state.VPositionFrom=e;break}if(e==Asc.c_oAscVAnchor.Text&&this.chMove.setValue(!0,!0),p.get_UseAlign()){for(e=p.get_Align(),m=0;m<this._arrVAlign.length;m++)if(e==this._arrVAlign[m].value){this.cmbVAlign.setValue(e),this._state.VAlignType=e;break}e=t.get_Value_Y(this._state.VPositionFrom),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e))}else this.radioVPosition.setValue(!0),e=p.get_Value(),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e))}else e=t.get_Value_Y(this._state.VPositionFrom),this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(e));this.chOverlap.setValue(null!==t.get_AllowOverlap()?t.get_AllowOverlap():"indeterminate",!0),this._state.verticalPropChanged=!1,this._state.horizontalPropChanged=!1,this.TableBorders=new Asc.CBorders(t.get_TableBorders()),this.CellBorders=new Asc.CBorders(t.get_CellBorders()),this._UpdateBordersNoSpacing_(),this._UpdateBordersSpacing_();var u=null===this.CellBorders.get_InsideV()&&null===this.CellBorders.get_InsideH();this._btnsBorderPosition[0].setDisabled(u&&!this._allTable),this._btnsTableBorderPosition[0].setDisabled(u&&!this._allTable),this._btnsTableBorderPosition[6].setDisabled(u&&!this._allTable);var g,b=t.get_TableBackground();if(b&&0==b.get_Value())(g=b.get_Color())?g.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.TableColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(g.get_r(),g.get_g(),g.get_b()),effectValue:g.get_value()}}:this.TableColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(g.get_r(),g.get_g(),g.get_b())}:this.TableColor={Value:1,Color:"transparent"};else this.TableColor={Value:0,Color:"transparent"};if(b=t.get_CellsBackground())if(0==b.get_Value())(g=b.get_Color())?g.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.CellColor={Value:1,Color:{color:Common.Utils.ThemeColor.getHexColor(g.get_r(),g.get_g(),g.get_b()),effectValue:g.get_value()}}:this.CellColor={Value:1,Color:Common.Utils.ThemeColor.getHexColor(g.get_r(),g.get_g(),g.get_b())}:this.CellColor={Value:1,Color:"transparent"};else this.CellColor={Value:1,Color:"transparent"};else this.CellColor={Value:0,Color:"transparent"};this.btnBackColor.setColor(this.CellColor.Color),Common.Utils.ThemeColor.selectPickerColorByEffect(this.CellColor.Color,this.colorsBack),this.btnTableBackColor.setColor(this.TableColor.Color),Common.Utils.ThemeColor.selectPickerColorByEffect(this.TableColor.Color,this.colorsTableBack),this.ShowHideSpacing("checked"===this.chAllowSpacing.getValue()),e=t.get_TableCaption(),this.inputAltTitle.setValue(e||""),e=t.get_TableDescription(),this.textareaAltDescription.val(e||"")}this._changedProps=new Asc.CTableProp,this._changedProps.put_CellSelect(!this._allTable),this._cellBackground=null,this.ChangedTableBorders=void 0,this.ChangedCellBorders=void 0},fillMargins:function(t){this.spnMarginLeft.setValue(null!==this.CellMargins.Left?this.CellMargins.Left:"",!0),this.spnMarginTop.setValue(null!==this.CellMargins.Top?this.CellMargins.Top:"",!0),this.spnMarginRight.setValue(null!==this.CellMargins.Right?this.CellMargins.Right:"",!0),this.spnMarginBottom.setValue(null!==this.CellMargins.Bottom?this.CellMargins.Bottom:"",!0);var e="checked"==t;this.spnMarginTop.setDisabled(e),this.spnMarginBottom.setDisabled(e),this.spnMarginLeft.setDisabled(e),this.spnMarginRight.setDisabled(e),this.spnTableMarginLeft.setValue(null!==this.TableMargins.Left?this.TableMargins.Left:"",!0),this.spnTableMarginTop.setValue(null!==this.TableMargins.Top?this.TableMargins.Top:"",!0),this.spnTableMarginRight.setValue(null!==this.TableMargins.Right?this.TableMargins.Right:"",!0),this.spnTableMarginBottom.setValue(null!==this.TableMargins.Bottom?this.TableMargins.Bottom:"",!0)},_TblWrapStyleChanged:function(t){t==c_tableWrap.TABLE_WRAP_NONE?this.btnWrapNone.toggle(!0):this.btnWrapParallel.toggle(!0),this._state.fromWrapInline=t==c_tableWrap.TABLE_WRAP_NONE},_TblAlignChanged:function(t){t==c_tableAlign.TABLE_ALIGN_LEFT?this.btnAlignLeft.toggle(!0,!0):t==c_tableAlign.TABLE_ALIGN_CENTER?this.btnAlignCenter.toggle(!0,!0):this.btnAlignRight.toggle(!0,!0)},onBtnInlineWrapClick:function(t,e){this.ShowHideWrap(!0),this._changedProps&&t.pressed&&(this._state.alignChanged&&(this._state.HAlignType===Asc.c_oAscXAlign.Left?this.btnAlignLeft.toggle(!0):this._state.HAlignType==Asc.c_oAscXAlign.Center?this.btnAlignCenter.toggle(!0):this._state.HAlignType==Asc.c_oAscXAlign.Right&&this.btnAlignRight.toggle(!0),this._state.alignChanged=!1),this._changedProps.put_TableWrap(t.options.posId),this.btnAlignLeft.pressed?this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_LEFT):this.btnAlignCenter.pressed?this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_CENTER):this._changedProps.put_TableAlignment(c_tableAlign.TABLE_ALIGN_RIGHT),this.spnIndentLeft.setDisabled(!this.btnAlignLeft.pressed),this._changedProps.put_TableIndent(Common.Utils.Metric.fnRecalcToMM(this.spnIndentLeft.getNumberValue()))),!this.spnIndentLeft.isDisabled()&&this.spnIndentLeft.focus()},onBtnFlowWrapClick:function(t,e){this.ShowHideWrap(!1),this._changedProps&&t.pressed&&(this._changedProps.put_TableWrap(t.options.posId),this._changedProps.put_TableAlignment(null),this._changedProps.put_TableIndent(null),this._state.fromWrapInline&&!this._state.verticalPropChanged&&this.radioVPosition.setValue(!0),this._state.alignChanged?(this.btnAlignLeft.pressed?this._state.HAlignType=Asc.c_oAscXAlign.Left:this.btnAlignCenter.pressed?this._state.HAlignType=Asc.c_oAscXAlign.Center:this._state.HAlignType=Asc.c_oAscXAlign.Right,this.cmbHAlign.setValue(this._state.HAlignType),this.radioHAlign.setValue(!0),null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._state.alignChanged=!1,this._state.horizontalPropChanged=!0):this._state.fromWrapInline&&!this._state.horizontalPropChanged&&this.radioHPosition.setValue(!0)),this.spnDistanceTop.focus()},onHAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HAlignType=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._state.alignChanged=!0)},onHRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HAlignFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!0),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom),this._changedProps.get_PositionH().put_Align(this._state.HAlignType))},onHPositionSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._state.HPositionFrom=e.value,this._changedProps.get_PositionH().put_UseAlign(!1),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom),!this._state.spnXChanged){var i=this._originalProps.get_Value_X(this._state.HPositionFrom);this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(i),!0)}this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue()))}},onVAlignSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VAlignType=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType))},onVRelativeSelect:function(t,e){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VAlignFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!0),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscVAnchor.Text,!0))},onVPositionSelect:function(t,e){if(this._changedProps){if(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._state.VPositionFrom=e.value,this._changedProps.get_PositionV().put_UseAlign(!1),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom),!this._state.spnYChanged){var i=this._originalProps.get_Value_Y(this._state.VPositionFrom);this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(i),!0)}this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscVAnchor.Text,!0)}},onRadioHAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(e),e&&(this._changedProps.get_PositionH().put_Align(this._state.HAlignType),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HAlignFrom))),e&&(this.cmbHAlign.setDisabled(!1),this.cmbHAlign.focus(),this.cmbHRelative.setDisabled(!1),this.spnX.setDisabled(!0),this.cmbHPosition.setDisabled(!0),this._state.horizontalPropChanged=!0,this._state.alignChanged=!0)},onRadioHPositionChange:function(t,e,i){if(this._changedProps&&(null!==this._changedProps.get_PositionH()&&void 0!==this._changedProps.get_PositionH()||this._changedProps.put_PositionH(new Asc.CTablePositionH),this._changedProps.get_PositionH().put_UseAlign(!e),e)){if(!this._state.spnXChanged){var n=this._originalProps.get_Value_X(this._state.HPositionFrom);this.spnX.setValue(Common.Utils.Metric.fnRecalcFromMM(n))}this._changedProps.get_PositionH().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue())),this._changedProps.get_PositionH().put_RelativeFrom(this._state.HPositionFrom)}e&&(this.cmbHAlign.setDisabled(!0),this.cmbHRelative.setDisabled(!0),this.spnX.setDisabled(!1),this.spnX.focus(),this.cmbHPosition.setDisabled(!1),this._state.alignChanged=!1)},onRadioVAlignChange:function(t,e,i){this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(e),e&&(this._changedProps.get_PositionV().put_Align(this._state.VAlignType),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VAlignFrom),this._state.verticalPropChanged=!0)),e&&(this.cmbVAlign.setDisabled(!1),this.cmbVAlign.focus(),this.cmbVRelative.setDisabled(!1),this.spnY.setDisabled(!0),this.cmbVPosition.setDisabled(!0),this.chMove.setValue(this._state.VAlignFrom==Asc.c_oAscVAnchor.Text,!0))},onRadioVPositionChange:function(t,e,i){if(this._changedProps&&(null!==this._changedProps.get_PositionV()&&void 0!==this._changedProps.get_PositionV()||this._changedProps.put_PositionV(new Asc.CTablePositionV),this._changedProps.get_PositionV().put_UseAlign(!e),e)){if(!this._state.spnYChanged){var n=this._originalProps.get_Value_Y(this._state.VPositionFrom);this.spnY.setValue(Common.Utils.Metric.fnRecalcFromMM(n))}this._changedProps.get_PositionV().put_Value(Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue())),this._changedProps.get_PositionV().put_RelativeFrom(this._state.VPositionFrom)}e&&(this.cmbVAlign.setDisabled(!0),this.cmbVRelative.setDisabled(!0),this.spnY.setDisabled(!1),this.spnY.focus(),this.cmbVPosition.setDisabled(!1),this.chMove.setValue(this._state.VPositionFrom==Asc.c_oAscVAnchor.Text,!0))},onBorderSizeSelect:function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.tableBordersImage.setVirtualBorderSize(this.BorderSize.pxValue),this.tableBordersImageSpacing.setVirtualBorderSize(this.BorderSize.pxValue)},onColorsBorderSelect:function(t,e){var i="object"==typeof e?e.color:e;this.tableBordersImage.setVirtualBorderColor(i),this.tableBordersImageSpacing.setVirtualBorderColor(i)},onColorsBackSelect:function(t,e){this.CellColor={Value:1,Color:e},null===this._cellBackground&&(this._cellBackground=new Asc.CBackground),"transparent"==this.CellColor.Color?(this._cellBackground.put_Value(1),this._cellBackground.put_Color(new Asc.asc_CColor(0,0,0))):(this._cellBackground.put_Value(0),this._cellBackground.put_Color(Common.Utils.ThemeColor.getRgbColor(this.CellColor.Color)));var i="object"==typeof e?e.color:e;this.tableBordersImageSpacing.setCellsColor(i),this.tableBordersImageSpacing.redrawTable(),this._allTable||(this.tableBordersImage.setCellsColor(i),this.tableBordersImage.redrawTable())},onColorsTableBackSelect:function(t,e){if(this.TableColor.Color=e,this._changedProps){var i=this._changedProps.get_TableBackground();void 0===i&&(i=new Asc.CBackground,this._changedProps.put_TableBackground(i)),"transparent"==this.TableColor.Color?(i.put_Value(1),i.put_Color(new Asc.asc_CColor(0,0,0))):(i.put_Value(0),i.put_Color(Common.Utils.ThemeColor.getRgbColor(this.TableColor.Color)))}var n="object"==typeof e?e.color:e;this.tableBordersImageSpacing.setTableColor(n),this.tableBordersImage.setTableColor(n),this._allTable&&this.tableBordersImage.setCellsColor(n),this.tableBordersImage.redrawTable(),this.tableBordersImageSpacing.redrawTable()},_UpdateBordersSpacing_:function(){var t=this.TableBorders,e=this.BorderSize,i=this.btnBorderColor.color;if(this._UpdateTableBorderSpacing_(t.get_Left(),"l"),this._UpdateTableBorderSpacing_(t.get_Top(),"t"),this._UpdateTableBorderSpacing_(t.get_Right(),"r"),this._UpdateTableBorderSpacing_(t.get_Bottom(),"b"),t=this.CellBorders,this._UpdateCellBorderSpacing_(t.get_Top(),this.tableBordersImageSpacing.getCellBorder(0,-1,0)),this._UpdateCellBorderSpacing_(t.get_Left(),this.tableBordersImageSpacing.getCellBorder(-1,0,0)),this._UpdateCellBorderSpacing_(t.get_Bottom(),this.tableBordersImageSpacing.getCellBorder(this.tableBordersImageSpacing.rows-1,-1,1)),this._UpdateCellBorderSpacing_(t.get_Right(),this.tableBordersImageSpacing.getCellBorder(-1,this.tableBordersImageSpacing.columns-1,1)),this._allTable&&null===t.get_InsideV()&&t.put_InsideV(new Asc.asc_CTextBorder),null!==t.get_InsideV())for(var n=0;n<this.tableBordersImageSpacing.columns-1;n++)this._UpdateCellBorderSpacing_(t.get_InsideV(),this.tableBordersImageSpacing.getCellBorder(-1,n,1)),this._UpdateCellBorderSpacing_(t.get_InsideV(),this.tableBordersImageSpacing.getCellBorder(-1,n+1,0));if(this._allTable&&null===t.get_InsideH()&&t.put_InsideH(new Asc.asc_CTextBorder),null!==t.get_InsideH())for(n=0;n<this.tableBordersImageSpacing.rows-1;n++)this._UpdateCellBorderSpacing_(t.get_InsideH(),this.tableBordersImageSpacing.getCellBorder(n,-1,1)),this._UpdateCellBorderSpacing_(t.get_InsideH(),this.tableBordersImageSpacing.getCellBorder(n+1,-1,0));this.tableBordersImageSpacing.setVirtualBorderSize(e.pxValue),this.tableBordersImageSpacing.setVirtualBorderColor("object"==typeof i?i.color:i),this.tableBordersImageSpacing.redrawTable()},_UpdateCellBorderSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0):(e.setBordersSize(this.IndeterminateSize),e.setBordersColor(this.IndeterminateColor))},_UpdateTableBorderSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(this.tableBordersImageSpacing.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableBordersImageSpacing.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableBordersImageSpacing.setBordersSize(e,0):(this.tableBordersImageSpacing.setBordersSize(e,this.IndeterminateSize),this.tableBordersImageSpacing.setBordersColor(e,this.IndeterminateColor))},_UpdateBordersNoSpacing_:function(){var t=this._allTable?this.TableBorders:this.CellBorders,e=this.BorderSize,i=this.btnBorderColor.color;if(this._UpdateTableBorderNoSpacing_(t.get_Left(),"l"),this._UpdateTableBorderNoSpacing_(t.get_Top(),"t"),this._UpdateTableBorderNoSpacing_(t.get_Right(),"r"),this._UpdateTableBorderNoSpacing_(t.get_Bottom(),"b"),this._allTable&&null==t.get_InsideV()&&t.put_InsideV(new Asc.asc_CTextBorder),null!==t.get_InsideV())for(var n=0;n<this.tableBordersImage.columns-1;n++)this._UpdateCellBorderNoSpacing_(t.get_InsideV(),this.tableBordersImage.getCellBorder(-1,n));if(this._allTable&&null==t.get_InsideH()&&t.put_InsideH(new Asc.asc_CTextBorder),null!==t.get_InsideH())for(n=0;n<this.tableBordersImage.rows-1;n++)this._UpdateCellBorderNoSpacing_(t.get_InsideH(),this.tableBordersImage.getCellBorder(n,-1));this.tableBordersImage.setVirtualBorderSize(e.pxValue),this.tableBordersImage.setVirtualBorderColor("object"==typeof i?i.color:i)},_UpdateCellBorderNoSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0):(e.setBordersSize(this.IndeterminateSize),e.setBordersColor(this.IndeterminateColor))},_UpdateTableBorderNoSpacing_:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()?1==t.get_Value()?(this.tableBordersImage.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableBordersImage.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableBordersImage.setBordersSize(e,0):(this.tableBordersImage.setBordersSize(e,this.IndeterminateSize),this.tableBordersImage.setBordersColor(e,this.IndeterminateColor))},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},_ApplyBorderPreset:function(t){var e,i=void 0!==t.options.strId?t.options.strId:t.options.strCellId,n=t.options.strTableId;if(this._allTable&&void 0===n?(e=this.TableBorders,this.ChangedTableBorders=null):(e=this.CellBorders,this.ChangedCellBorders=null),this._UpdateBorderStyle(e.get_Left(),i.indexOf("l")>-1),this._UpdateBorderStyle(e.get_Top(),i.indexOf("t")>-1),this._UpdateBorderStyle(e.get_Right(),i.indexOf("r")>-1),this._UpdateBorderStyle(e.get_Bottom(),i.indexOf("b")>-1),this._UpdateBorderStyle(e.get_InsideV(),i.indexOf("c")>-1),this._UpdateBorderStyle(e.get_InsideH(),i.indexOf("m")>-1),void 0===n)return this._UpdateBordersNoSpacing_(),this._allTable&&(e=this.CellBorders,this.ChangedCellBorders=null,this._UpdateBorderStyle(e.get_Left(),i.indexOf("l")>-1),this._UpdateBorderStyle(e.get_Top(),i.indexOf("t")>-1),this._UpdateBorderStyle(e.get_Right(),i.indexOf("r")>-1),this._UpdateBorderStyle(e.get_Bottom(),i.indexOf("b")>-1),this._UpdateBorderStyle(e.get_InsideV(),i.indexOf("c")>-1),this._UpdateBorderStyle(e.get_InsideH(),i.indexOf("m")>-1)),this.tableBordersImageSpacing.redrawTable(),void this.tableBordersImage.redrawTable();e=this.TableBorders,this.ChangedTableBorders=null,this._UpdateBorderStyle(e.get_Left(),n.indexOf("l")>-1),this._UpdateBorderStyle(e.get_Top(),n.indexOf("t")>-1),this._UpdateBorderStyle(e.get_Right(),n.indexOf("r")>-1),this._UpdateBorderStyle(e.get_Bottom(),n.indexOf("b")>-1),this._UpdateBordersSpacing_()},_UpdateCellBordersStyle:function(t,e,i,n,s,o){var a=s;0==e.col&&0==e.numInCell?(this._UpdateBorderStyle(a.get_Left(),i>0),o&&o.put_Left(new Asc.asc_CTextBorder(a.get_Left()))):e.col==e.columns-1&&1==e.numInCell?(this._UpdateBorderStyle(a.get_Right(),i>0),o&&o.put_Right(new Asc.asc_CTextBorder(a.get_Right()))):0==e.row&&0==e.numInCell?(this._UpdateBorderStyle(a.get_Top(),i>0),o&&o.put_Top(new Asc.asc_CTextBorder(a.get_Top()))):e.row==e.rows-1&&1==e.numInCell?(this._UpdateBorderStyle(a.get_Bottom(),i>0),o&&o.put_Bottom(new Asc.asc_CTextBorder(a.get_Bottom()))):e.col>-1?(this._UpdateBorderStyle(a.get_InsideV(),i>0),o&&o.put_InsideV(new Asc.asc_CTextBorder(a.get_InsideV()))):e.row>-1&&(this._UpdateBorderStyle(a.get_InsideH(),i>0),o&&o.put_InsideH(new Asc.asc_CTextBorder(a.get_InsideH())))},_UpdateTableBordersStyle:function(t,e,i,n,s,o){var a=s;e.indexOf("l")>-1?(this._UpdateBorderStyle(a.get_Left(),i>0),o&&o.put_Left(new Asc.asc_CTextBorder(a.get_Left()))):e.indexOf("t")>-1?(this._UpdateBorderStyle(a.get_Top(),i>0),o&&o.put_Top(new Asc.asc_CTextBorder(a.get_Top()))):e.indexOf("r")>-1?(this._UpdateBorderStyle(a.get_Right(),i>0),o&&o.put_Right(new Asc.asc_CTextBorder(a.get_Right()))):e.indexOf("b")>-1&&(this._UpdateBorderStyle(a.get_Bottom(),i>0),o&&o.put_Bottom(new Asc.asc_CTextBorder(a.get_Bottom())))},_UpdateBorderStyle:function(t,e){if(null==t)return 0;if(e&&this.BorderSize.ptValue>0){var i,n=parseFloat(this.BorderSize.ptValue);t.put_Value(1),t.put_Size(25.4*n/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)}else t.put_Color(new Asc.asc_CColor),t.put_Value(0);return t.get_Value()},onCellCategoryClick:function(t){"checked"==this.CellMargins.Flag&&this.TableMargins.isChanged&&(this.CellMargins.Left=this.TableMargins.Left,this.CellMargins.Top=this.TableMargins.Top,this.CellMargins.Right=this.TableMargins.Right,this.CellMargins.Bottom=this.TableMargins.Bottom,this.spnMarginRight.setValue(this.CellMargins.Right,!0),this.spnMarginLeft.setValue(this.CellMargins.Left,!0),this.spnMarginBottom.setValue(this.CellMargins.Bottom,!0),this.spnMarginTop.setValue(this.CellMargins.Top,!0)),this.TableMargins.isChanged=!1},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsTableBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},ShowHideWrap:function(t){this.AlignContainer.toggleClass("settings-hidden",!t),this.DistanceContainer.toggleClass("settings-hidden",t),this.btnsCategory[3].setDisabled(t)},ShowHideSpacing:function(t){this.BordersContainer.toggleClass("settings-hidden",t),this.BordersSpacingContainer.toggleClass("settings-hidden",!t),this.TableBackContainer.css("display",t||this._allTable?"flex":"none"),this.CellBackContainer.css("display",!t&&this._allTable?"none":"flex"),this.TableBackContainer.toggleClass("float-right",t||!this._allTable),t?this._UpdateBordersSpacing_():this._UpdateBordersNoSpacing_()},textWidth:"Width",textAllowSpacing:"Spacing between cells",textAlign:"Alignment",textIndLeft:"Indent from Left",textWidthSpaces:"Width & Spaces",textWrap:"Text Wrapping",textMargins:"Cell Margins",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textDistance:"Distance From Text",textPosition:"Position",textWrapParallelTooltip:"Flow table",textWrapNoneTooltip:"Inline table",textLeftTooltip:"Left",textRightTooltip:"Right",textCenterTooltip:"Center",textTitle:"Table - Advanced Settings",textDefaultMargins:"Default Cell Margins",textCheckMargins:"Use default margins",textBordersBackgroung:"Borders & Background",textOnlyCells:"For selected cells only",textBorderWidth:"Border Size",textBorderColor:"Border Color",textBackColor:"Cell Background",textPreview:"Preview",textBorderDesc:"Click on diagramm or use buttons to select borders",textTableBackColor:"Table Background",txtNoBorders:"No borders",textCenter:"Center",textMargin:"Margin",textPage:"Page",textHorizontal:"Horizontal",textVertical:"Vertical",textAlignment:"Alignment",textRelative:"relative to",textRightOf:"to the right Of",textBelow:"below",textOverlap:"Allow overlap",textMove:"Move object with text",textOptions:"Options",textAnchorText:"Text",textAutofit:"Automatically resize to fit contents",textCellProps:"Cell",tipAll:"Set Outer Border and All Inner Lines",tipNone:"Set No Borders",tipInner:"Set Inner Lines Only",tipOuter:"Set Outer Border Only",tipCellAll:"Set Borders for Inner Cells Only",tipTableOuterCellAll:"Set Outer Border and Borders for All Inner Cells",tipCellInner:"Set Vertical and Horizontal Lines for Inner Cells Only",tipTableOuterCellInner:"Set Outer Border and Vertical and Horizontal Lines for Inner Cells",tipCellOuter:"Set Outer Borders for Inner Cells Only",tipTableOuterCellOuter:"Set Table Outer Border and Outer Borders for Inner Cells",txtPercent:"Percent",txtCm:"Centimeter",txtPt:"Point",txtInch:"Inch",textCellSize:"Cell Size",textPrefWidth:"Preferred width",textMeasure:"Measure in",textCellOptions:"Cell Options",textWrapText:"Wrap text",textTable:"Table",textTableSize:"Table Size",textTablePosition:"Table Position",textWrappingStyle:"Wrapping Style",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table."},DE.Views.TableSettingsAdvanced||{}))})),define("text!documenteditor/main/app/template/DropcapSettingsAdvanced.template",[],(function(){return'<div id="id-adv-dropcap-frame" class="settings-panel">\n    <div class="inner-content">\n        <table cols="3" style="width: 100%" role="presentation">\n            <tr>\n                <td colspan="3">\n                    <label class="header  padding-small"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3" class="settins-cell padding-large">\n                    <span id="frame-advanced-button-none" class="margin-right-5"></span>\n                    <span id="frame-advanced-button-inline" class="margin-right-5"></span>\n                    <span id="frame-advanced-button-flow"></span>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-widthtype"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-width"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-heighttype"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-height"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textHorizontal %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2"></td>\n                <td class="settins-cell">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-hposition"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-hrelative"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small padding-right-10" colspan="2">\n                    <label class="input-label float-right"><%= scope.textDistance %></label>\n                </td>\n                <td class="settins-cell padding-small">\n                    <div id="frame-advanced-input-hdist"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="3">\n                    <label class="header"><%= scope.textVertical %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2"></td>\n                <td class="settins-cell">\n                    <label class="input-label"><%= scope.textRelative %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small" width="80">\n                    <label class="input-label"><%= scope.textPosition %></label>\n                </td>\n                <td class="settins-cell padding-small padding-right-10" width="130">\n                    <div id="frame-advanced-input-vposition"></div>\n                </td>\n                <td class="settins-cell padding-small" width="95">\n                    <div id="frame-advanced-input-vrelative"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="settins-cell padding-small padding-right-10" colspan="2">\n                    <label class="input-label float-right"><%= scope.textDistance %></label>\n                </td>\n                <td class="settins-cell padding-small">\n                    <div id="frame-advanced-input-vdist"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="3">\n                    <div id="frame-advanced-checkbox-move"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-dropcap-dropcap" class="settings-panel">\n    <div class="inner-content">\n        <label class="header padding-small" style="width: 100%;"><%= scope.textPosition %></label>\n        <div class="padding-small" style="width: 100%">\n            <span id="drop-advanced-button-none" class="margin-right-5"></span>\n            <span id="drop-advanced-button-intext" class="margin-right-5"></span>\n            <span id="drop-advanced-button-inmargin" class="margin-right-5"></span>\n        </div>\n        <label class="header padding-small" style="width: 100%;"><%= scope.textParameters %></label>\n        <label class="input-label"><%= scope.textFont %></label>\n        <div id="drop-advanced-input-fonts" class="padding-small" style="width: 100%;"></div>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td width="50%">\n                    <label class="input-label"><%= scope.textRowHeight %></label>\n                    <div id="drop-advanced-input-rowheight"></div>\n                </td>\n                <td width="50%">\n                    <label class="input-label"><%= scope.textDistance %></label>\n                    <div id="drop-advanced-input-distance"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-dropcap-borders" class="settings-panel">\n    <div class="inner-content">\n        <div style="width: 100%;" class="padding-small">\n            <label class="input-label margin-right-5"><%= scope.textBorderWidth %></label>\n            <div id="drop-advanced-input-bordersize" style="display: inline-block; vertical-align: middle; width: 93px;"></div>\n            <div style="display: inline-block; vertical-align: middle;" class="float-right">\n                <label class="input-label margin-right-5"><%= scope.textBorderColor %></label>\n                <div id="drop-advanced-button-bordercolor" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <label class="input-label padding-small" style="width: 100%;"><%= scope.textBorderDesc %></label>\n        <div style="width: 100%;" class="padding-large">\n            <div id="drop-advanced-borderstyler" style="display: inline-block; vertical-align: middle; width: 200px; height: 170px;outline: 1px solid #ccc;"></div>\n            <div style="display: inline-block; vertical-align: middle; width: 80px; height: 170px; padding-top: 10px;" class="float-right padding-left-4">\n                <div id="drop-advanced-button-borderline-00" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-01" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-10" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-11" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-20" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-21" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-30" style="display: inline-block;"></div>\n                <div id="drop-advanced-button-borderline-31" style="display: inline-block;"></div>\n            </div>\n        </div>\n        <div style="width: 100%;" class="padding-small">\n            <label class="input-label margin-right-5"><%= scope.textBackColor %></label>\n            <div id="drop-advanced-button-color" style="display: inline-block;"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-dropcap-margins" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textTop %></label>\n                    <div id="drop-advanced-input-top"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textLeft %></label>\n                    <div id="drop-advanced-input-left"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textBottom %></label>\n                    <div id="drop-advanced-input-bottom"></div>\n                </td>\n                <td class="padding-small" width="50%">\n                    <label class="input-label"><%= scope.textRight %></label>\n                    <div id="drop-advanced-input-right"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'}));var c_oAscFrameWrap={None:-1,Inline:!1,Flow:!0};if(define("documenteditor/main/app/view/DropcapSettingsAdvanced",["text!documenteditor/main/app/template/DropcapSettingsAdvanced.template","common/main/lib/component/TableStyler","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.DropcapSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,contentHeight:295,toggleGroup:"dropcap-adv-settings-group",storageName:"de-dropcap-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,contentTemplate:_.template(t)({scope:this}),items:[{panelId:"id-adv-dropcap-frame",panelCaption:this.textFrame},{panelId:"id-adv-dropcap-dropcap",panelCaption:this.strDropcap},{panelId:"id-adv-dropcap-borders",panelCaption:this.strBorders},{panelId:"id-adv-dropcap-margins",panelCaption:this.strMargins}]},e),this.tableStylerRows=this.options.tableStylerRows,this.tableStylerColumns=this.options.tableStylerColumns,this.fontStore=this.options.fontStore,this.borderProps=this.options.borderProps,this.isFrame=this.options.isFrame,this.api=this.options.api,this.Borders={},this.BorderSize={ptValue:0,pxValue:0},this.paragraphShade="transparent",this._changedProps=null,this.ChangedBorders=void 0,this._noApply=!0,this.Margins=void 0,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){var t=this;Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.tableStyler=new Common.UI.TableStyler({el:$("#drop-advanced-borderstyler"),width:200,height:170,rows:this.tableStylerRows,columns:this.tableStylerColumns,spacingMode:!1}),this._btnsBorderPosition=[],_.each([[c_tableBorder.BORDER_HORIZONTAL_TOP,"t","toolbar__icon toolbar__icon-big btn-paragraph-borders-top","00"],[c_tableBorder.BORDER_HORIZONTAL_CENTER,"m","toolbar__icon toolbar__icon-big btn-paragraph-borders-inner","01"],[c_tableBorder.BORDER_HORIZONTAL_BOTTOM,"b","toolbar__icon toolbar__icon-big btn-paragraph-borders-bottom","10"],[c_tableBorder.BORDER_OUTER,"lrtb","toolbar__icon toolbar__icon-big btn-paragraph-borders-outer","11"],[c_tableBorder.BORDER_VERTICAL_LEFT,"l","toolbar__icon toolbar__icon-big btn-paragraph-borders-left","20"],[c_tableBorder.BORDER_ALL,"lrtbm","toolbar__icon toolbar__icon-big btn-paragraph-borders-all","21"],[c_tableBorder.BORDER_VERTICAL_RIGHT,"r","toolbar__icon toolbar__icon-big btn-paragraph-borders-right","30"],[c_tableBorder.BORDER_NONE,"","toolbar__icon toolbar__icon-big btn-paragraph-borders-none","31"]],(function(e,i){var n=new Common.UI.Button({parentEl:$("#drop-advanced-button-borderline-"+e[3]),posId:e[0],strId:e[1],iconCls:e[2],style:"margin-bottom: 4px;",cls:"btn-options large border-off margin-left-5"});n.on("click",(function(e){t._ApplyBorderPreset(e.options.strId)})),t._btnsBorderPosition.push(n)}),this);Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt);this.cmbBorderSize=new Common.UI.ComboBorderSize({el:$("#drop-advanced-input-bordersize"),style:"width: 90px;",takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.BorderSize={ptValue:e.value,pxValue:e.pxValue},this.tableStyler.setVirtualBorderSize(this.BorderSize.pxValue)}),this));var e=this.cmbBorderSize.store.at(2);this.cmbBorderSize.setValue(e.get("value")),this.BorderSize={ptValue:e.get("value"),pxValue:e.get("pxValue")},this.btnBorderColor=new Common.UI.ColorButton({parentEl:$("#drop-advanced-button-bordercolor"),additionalAlign:this.menuAddAlign,color:"auto",auto:!0,takeFocusOnClose:!0}),this.btnBorderColor.on("color:select",_.bind((function(t,e){this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e)}),this)),this.btnBorderColor.on("auto:select",_.bind((function(t,e){this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e)}),this)),this.colorsBorder=this.btnBorderColor.getPicker(),this.btnBackColor=new Common.UI.ColorButton({parentEl:$("#drop-advanced-button-color"),additionalAlign:this.menuAddAlign,transparent:!0,takeFocusOnClose:!0}),this.btnBackColor.on("color:select",_.bind((function(e,i){t.paragraphShade=i,t._changedProps&&(void 0!==t._changedProps.get_Shade()&&null!==t._changedProps.get_Shade()||t._changedProps.put_Shade(new Asc.asc_CParagraphShd),"transparent"==i?t._changedProps.get_Shade().put_Value(Asc.c_oAscShdNil):(t._changedProps.get_Shade().put_Value(Asc.c_oAscShdClear),t._changedProps.get_Shade().put_Color(Common.Utils.ThemeColor.getRgbColor(i))));var n="object"==typeof i?i.color:i;t.tableStyler.setTableColor(n),t.tableStyler.redrawTable()}),this)),this.colorsBack=this.btnBackColor.getPicker(),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-top"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind((function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Top=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),t)),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-left"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind((function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Left=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),t)),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-bottom"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind((function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Bottom=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),t)),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-right"),step:.1,width:100,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind((function(t,e,i){this._noApply||(_.isUndefined(this.Margins)&&(this.Margins={}),this.Margins.Right=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),t)),this.btnNone=new Common.UI.Button({parentEl:$("#drop-advanced-button-none"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-none",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textNone}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(Asc.c_oAscDropCap.None),t._changedProps.put_DropCap(Asc.c_oAscDropCap.None))}),t)),this.btnInText=new Common.UI.Button({parentEl:$("#drop-advanced-button-intext"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-text icon-rtl",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textInText}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(Asc.c_oAscDropCap.Drop),t._changedProps.put_DropCap(Asc.c_oAscDropCap.Drop))}),t)),this.btnInMargin=new Common.UI.Button({parentEl:$("#drop-advanced-button-inmargin"),cls:"btn huge-1 btn-options",iconCls:"icon-advanced-wrap options__icon options__icon-huge btn-drop-margin",enableToggle:!0,toggleGroup:"dropAdvGroup",allowDepress:!1,hint:this.textInMargin}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(Asc.c_oAscDropCap.Margin),t._changedProps.put_DropCap(Asc.c_oAscDropCap.Margin))}),t)),this.spnRowHeight=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-rowheight"),step:1,width:120,value:3,defaultUnit:"",maxValue:10,minValue:1,allowDecimal:!1}).on("change",_.bind((function(e,i,n){t._changedProps&&t._changedProps.put_Lines(e.getNumberValue())}),t)),this.numDistance=new Common.UI.MetricSpinner({el:$("#drop-advanced-input-distance"),step:.1,width:120,value:"0 cm",defaultUnit:"cm",maxValue:55.87,minValue:0}).on("change",_.bind((function(e,i,n){t._changedProps&&t._changedProps.put_HSpace(Common.Utils.Metric.fnRecalcToMM(e.getNumberValue()))}),t)),this.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#drop-advanced-input-fonts"),cls:"input-group-nr",style:"width: 290px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 236px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind((function(e,i){t._changedProps&&t._changedProps.put_FontFamily(i.name)}),t)),this.btnFrameNone=new Common.UI.Button({parentEl:$("#frame-advanced-button-none"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-none",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textNone}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(c_oAscFrameWrap.None),t._changedProps.put_Wrap(c_oAscFrameWrap.None))}),t)),this.btnFrameInline=new Common.UI.Button({parentEl:$("#frame-advanced-button-inline"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-table-align-center",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textInline}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(c_oAscFrameWrap.Inline),t._changedProps.put_Wrap(c_oAscFrameWrap.Inline))}),t)),this.btnFrameFlow=new Common.UI.Button({parentEl:$("#frame-advanced-button-flow"),cls:"btn huge-1 btn-options",iconCls:"options__icon options__icon-huge btn-table-flow",enableToggle:!0,toggleGroup:"frameAdvGroup",allowDepress:!1,hint:this.textFlow}).on("toggle",_.bind((function(e,i){t._changedProps&&i&&(t._DisableElem(c_oAscFrameWrap.Flow),t._changedProps.put_Wrap(c_oAscFrameWrap.Flow))}),t)),this._arrWidth=[{displayValue:this.textAuto,value:0},{displayValue:this.textExact,value:1}],this.cmbWidth=new Common.UI.ComboBox({el:$("#frame-advanced-input-widthtype"),cls:"input-group-nr",menuStyle:"min-width: 130px;",editable:!1,takeFocusOnClose:!0,data:this._arrWidth}).on("selected",_.bind((function(e,i){t._changedProps&&(t.spnWidth.suspendEvents(),t.spnWidth.setValue(0==i.value?"":1),t.spnWidth.resumeEvents(),t._changedProps.put_W(0==i.value?void 0:Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),t)),this.cmbWidth.setValue(this._arrWidth[0].value),this.spnWidth=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-width"),maxValue:55.88,minValue:.02,step:.1,defaultUnit:"cm",value:""}).on("change",_.bind((function(e,i,n){t._changedProps&&(t.cmbWidth.suspendEvents(),t.cmbWidth.setValue(this._arrWidth[1].value),t.cmbWidth.resumeEvents(),t._changedProps.put_W(Common.Utils.Metric.fnRecalcToMM(e.getNumberValue())))}),t)),this._arrHeight=[{displayValue:this.textAuto,value:0},{displayValue:this.textExact,value:1},{displayValue:this.textAtLeast,value:2}],this.cmbHeight=new Common.UI.ComboBox({el:$("#frame-advanced-input-heighttype"),cls:"input-group-nr",menuStyle:"min-width: 130px;",editable:!1,takeFocusOnClose:!0,data:this._arrHeight}).on("selected",_.bind((function(e,i){t._changedProps&&(t.spnHeight.suspendEvents(),t.spnHeight.setValue(0==i.value?"":1),t.spnHeight.resumeEvents(),t._changedProps.put_HRule(0==i.value?Asc.linerule_Auto:1==i.value?Asc.linerule_Exact:Asc.linerule_AtLeast),i.value>0&&this._changedProps.put_H(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),t)),this.cmbHeight.setValue(this._arrHeight[0].value),this.spnHeight=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-height"),maxValue:55.88,minValue:.02,step:.1,defaultUnit:"cm",value:""}).on("change",_.bind((function(e,i,n){if(t._changedProps){var s=Asc.linerule_Auto;t.cmbHeight.getValue()==t._arrHeight[1].value?s=Asc.linerule_Exact:t.cmbHeight.getValue()==t._arrHeight[2].value&&(s=Asc.linerule_AtLeast),s==Asc.linerule_Auto&&(t.cmbHeight.suspendEvents(),t.cmbHeight.setValue(t._arrHeight[2].value),s=Asc.linerule_AtLeast,t.cmbHeight.resumeEvents()),t._changedProps.put_HRule(s),t._changedProps.put_H(Common.Utils.Metric.fnRecalcToMM(e.getNumberValue()))}}),t)),this.spnX=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-hdist"),maxValue:55.87,minValue:0,step:.1,defaultUnit:"cm",value:"0 cm",width:"auto"}).on("change",_.bind((function(e,i,n){t._changedProps&&t._changedProps.put_HSpace(Common.Utils.Metric.fnRecalcToMM(e.getNumberValue()))}),t)),this.spnY=new Common.UI.MetricSpinner({el:$("#frame-advanced-input-vdist"),maxValue:55.87,minValue:0,step:.1,defaultUnit:"cm",value:"0 cm",width:"auto"}).on("change",_.bind((function(e,i,n){t._changedProps&&t._changedProps.put_VSpace(Common.Utils.Metric.fnRecalcToMM(e.getNumberValue()))}),t)),this._arrHAlign=[{displayValue:this.textLeft,value:Asc.c_oAscXAlign.Left},{displayValue:this.textCenter,value:Asc.c_oAscXAlign.Center},{displayValue:this.textRight,value:Asc.c_oAscXAlign.Right}],this.cmbHAlign=new Common.UI.ComboBox({el:$("#frame-advanced-input-hposition"),cls:"input-group-nr",menuStyle:"min-width: 130px;",data:this._arrHAlign,takeFocusOnClose:!0}).on("changed:after",_.bind((function(e,i){if(t._changedProps)if(e.getSelectedRecord())t._changedProps.put_XAlign(i.value);else{var n=Common.Utils.String.parseFloat(i.value);isNaN(n)||(t._changedProps.put_XAlign(void 0),t._changedProps.put_X(Common.Utils.Metric.fnRecalcToMM(n)))}}),t)).on("selected",_.bind((function(e,i){t._changedProps&&t._changedProps.put_XAlign(i.value)}),t)),this.cmbHAlign.setValue(this._arrHAlign[0].value),this._arrHRelative=[{displayValue:this.textMargin,value:Asc.c_oAscHAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscHAnchor.Page},{displayValue:this.textColumn,value:Asc.c_oAscHAnchor.Text}],this.cmbHRelative=new Common.UI.ComboBox({el:$("#frame-advanced-input-hrelative"),cls:"input-group-nr",menuStyle:"min-width: 95px;",data:this._arrHRelative,editable:!1,takeFocusOnClose:!0}).on("selected",_.bind((function(e,i){t._changedProps&&t._changedProps.put_HAnchor(i.value)}),t)),this.cmbHRelative.setValue(this._arrHRelative[1].value),this._arrVAlign=[{displayValue:this.textTop,value:Asc.c_oAscYAlign.Top},{displayValue:this.textCenter,value:Asc.c_oAscYAlign.Center},{displayValue:this.textBottom,value:Asc.c_oAscYAlign.Bottom}],this.cmbVAlign=new Common.UI.ComboBox({el:$("#frame-advanced-input-vposition"),cls:"input-group-nr",menuStyle:"min-width: 130px;",data:this._arrVAlign,takeFocusOnClose:!0}).on("changed:after",_.bind((function(e,i){if(t._changedProps)if(e.getSelectedRecord())t._changedProps.put_YAlign(i.value);else{var n=Common.Utils.String.parseFloat(i.value);isNaN(n)||(t._changedProps.put_YAlign(void 0),t._changedProps.put_Y(Common.Utils.Metric.fnRecalcToMM(Common.Utils.String.parseFloat(i.value))))}}),t)).on("selected",_.bind((function(e,i){t._changedProps&&t._changedProps.put_YAlign(i.value)}),t)),this.cmbVAlign.setValue(this._arrVAlign[0].value),this._arrVRelative=[{displayValue:this.textMargin,value:Asc.c_oAscVAnchor.Margin},{displayValue:this.textPage,value:Asc.c_oAscVAnchor.Page},{displayValue:this.textParagraph,value:Asc.c_oAscVAnchor.Text}],this.cmbVRelative=new Common.UI.ComboBox({el:$("#frame-advanced-input-vrelative"),cls:"input-group-nr",menuStyle:"min-width: 95px;",data:this._arrVRelative,editable:!1,takeFocusOnClose:!0}).on("selected",_.bind((function(e,i){t._changedProps&&(t._changedProps.put_VAnchor(i.value),this.chMove.setValue(i.value==Asc.c_oAscVAnchor.Text,!0))}),t)),this.cmbVRelative.setValue(this._arrVRelative[2].value),this.chMove=new Common.UI.CheckBox({el:$("#frame-advanced-checkbox-move"),labelText:this.textMove}).on("change",_.bind((function(e,i){if(t._changedProps){var n=this.cmbVRelative.store.at("checked"==i?2:1);t.cmbVRelative.setValue(n.get("value")),t._changedProps.put_VAnchor(n.get("value"))}}),t)),this.on("show",_.bind(this.onShowDialog,this)),this.afterRender()},afterRender:function(){this.updateMetricUnit(),this.updateThemeColors(),this.isFrame||this.cmbFonts.fillFonts(this.fontStore),this._setDefaults(this._originalProps);var t="object"==typeof this.paragraphShade?this.paragraphShade.color:this.paragraphShade;if(this.tableStyler.setTableColor(t),"transparent"!=t&&this.tableStyler.redrawTable(),void 0!==this.borderProps&&(this.btnBorderColor.setColor(this.borderProps.borderColor),this.btnBorderColor.setAutoColor("auto"==this.borderProps.borderColor),this.tableStyler.setVirtualBorderColor("object"==typeof this.btnBorderColor.color?this.btnBorderColor.color.color:this.btnBorderColor.color),"auto"==this.borderProps.borderColor?this.colorsBorder.clearSelection():this.colorsBorder.select(this.borderProps.borderColor,!0),this.cmbBorderSize.setValue(this.borderProps.borderSize.ptValue),this.BorderSize={ptValue:this.borderProps.borderSize.ptValue,pxValue:this.borderProps.borderSize.pxValue},this.tableStyler.setVirtualBorderSize(this.BorderSize.pxValue)),this.setTitle(this.isFrame?this.textTitleFrame:this.textTitle),this.tableStyler.on("borderclick:cellborder",(function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateCellBordersStyle(t,e,i,n,this.Borders)}),this),this.tableStyler.on("borderclick",(function(t,e,i,n){void 0===this.ChangedBorders&&(this.ChangedBorders=new Asc.asc_CParagraphBorders),this._UpdateTableBordersStyle(t,e,i,n,this.Borders)}),this),this.isFrame&&this.setInnerHeight(415),this.btnsCategory[this.isFrame?1:0].setVisible(!1),this.storageName){var e=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==e?parseInt(e):0)}},getFocusedComponents:function(){return this.btnsCategory.concat([this.btnFrameNone,this.btnFrameInline,this.btnFrameFlow,this.cmbWidth,this.spnWidth,this.cmbHeight,this.spnHeight,this.cmbHAlign,this.cmbHRelative,this.spnX,this.cmbVAlign,this.cmbVRelative,this.spnY,this.chMove,this.btnNone,this.btnInText,this.btnInMargin,this.cmbFonts,this.spnRowHeight,this.numDistance,this.cmbBorderSize,this.btnBorderColor]).concat(this._btnsBorderPosition).concat([this.btnBackColor,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.cmbWidth.focus();break;case 1:i.cmbFonts.focus();break;case 2:i.cmbBorderSize.focus();break;case 3:i.spnMarginTop.focus()}}),100)},getSettings:function(){if(null===this.ChangedBorders?this._changedProps.put_Borders(this.Borders):void 0!==this.ChangedBorders&&this._changedProps.put_Borders(this.ChangedBorders),this.Margins){var t=this._changedProps.get_Borders();null==t&&(this._changedProps.put_Borders(new Asc.asc_CParagraphBorders),t=this._changedProps.get_Borders()),void 0!==this.Margins.Left&&(void 0!==t.get_Left()&&null!==t.get_Left()||t.put_Left(new Asc.asc_CTextBorder(this.Borders.get_Left())),t.get_Left().put_Space(this.Margins.Left)),void 0!==this.Margins.Top&&(void 0!==t.get_Top()&&null!==t.get_Top()||t.put_Top(new Asc.asc_CTextBorder(this.Borders.get_Top())),t.get_Top().put_Space(this.Margins.Top)),void 0!==this.Margins.Right&&(void 0!==t.get_Right()&&null!==t.get_Right()||t.put_Right(new Asc.asc_CTextBorder(this.Borders.get_Right())),t.get_Right().put_Space(this.Margins.Right)),void 0!==this.Margins.Bottom&&(void 0!==t.get_Bottom()&&null!==t.get_Bottom()||t.put_Bottom(new Asc.asc_CTextBorder(this.Borders.get_Bottom())),t.get_Bottom().put_Space(this.Margins.Bottom),void 0!==t.get_Between()&&null!==t.get_Between()||t.put_Between(new Asc.asc_CTextBorder(this.Borders.get_Between())),t.get_Between().put_Space(this.Margins.Bottom))}return this._changedProps.put_FromDropCapMenu(!this.isFrame),{paragraphProps:this._changedProps,borderProps:{borderSize:this.BorderSize,borderColor:this.btnBorderColor.isAutoColor()?"auto":this.btnBorderColor.color}}},onShowDialog:function(t){!this.isFrame&&this.btnNone.pressed?this._DisableElem(Asc.c_oAscDropCap.None):this.isFrame&&this.btnFrameNone.pressed&&this._DisableElem(c_oAscFrameWrap.None)},onBtnBordersClick:function(t,e){if(this.updateBordersStyle(t.options.strId,!0),this.api){var i=new Asc.CTableProp;i.put_CellBorders(this.CellBorders),i.put_CellSelect(!0),this.api.tblApply(i)}this.fireEvent("editcomplete",this)},updateThemeColors:function(){this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},updateMetricUnit:function(){var t=this;_.each([t.spnMarginTop,t.spnMarginLeft,t.spnMarginBottom,t.spnMarginRight,t.numDistance,t.spnWidth,t.spnHeight,t.spnX,t.spnY],(function(t){t.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),t.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}))},_setDefaults:function(t){if(t){this._noApply=!0,this._originalProps=new Asc.asc_CParagraphProperty(t);var e=t.get_FramePr();if(e){var i;if(this.isFrame){i=e.get_W(),this.cmbWidth.setValue(void 0===i?this._arrWidth[0].value:this._arrWidth[1].value),this.spnWidth.setValue(void 0!==i?Common.Utils.Metric.fnRecalcFromMM(i):""),void 0!==(i=e.get_HRule())?(this.cmbHeight.setValue(i===Asc.linerule_Exact?this._arrHeight[1].value:this._arrHeight[2].value),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(e.get_H()))):(this.cmbHeight.setValue(this._arrHeight[0].value),this.spnHeight.setValue("")),i=e.get_HSpace(),this.spnX.setValue(void 0!==i?Common.Utils.Metric.fnRecalcFromMM(i):0),i=e.get_VSpace(),this.spnY.setValue(void 0!==i?Common.Utils.Metric.fnRecalcFromMM(i):0),i=e.get_HAnchor();for(var n=0;n<this._arrHRelative.length;n++)if(i==this._arrHRelative[n].value){this.cmbHRelative.setValue(this._arrHRelative[n].value);break}if(void 0!==(i=e.get_XAlign())){for(n=0;n<this._arrHAlign.length;n++)if(i==this._arrHAlign[n].value){this.cmbHAlign.setValue(this._arrHAlign[n].value);break}}else i=e.get_X(),this.cmbHAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(void 0!==i?i:0)+" "+Common.Utils.Metric.getCurrentMetricName());i=e.get_VAnchor();for(n=0;n<this._arrVRelative.length;n++)if(i==this._arrVRelative[n].value){this.cmbVRelative.setValue(this._arrVRelative[n].value);break}if(this.chMove.setValue(i==Asc.c_oAscVAnchor.Text),void 0!==(i=e.get_YAlign())){for(n=0;n<this._arrVAlign.length;n++)if(i==this._arrVAlign[n].value){this.cmbVAlign.setValue(this._arrVAlign[n].value);break}}else i=e.get_Y(),this.cmbVAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(void 0!==i?i:0)+" "+Common.Utils.Metric.getCurrentMetricName());!1===(i=e.get_Wrap())?this.btnFrameInline.toggle(!0,!1):this.btnFrameFlow.toggle(!0,!1)}else if(this.spnRowHeight.setValue(null!==e.get_Lines()?e.get_Lines():""),this.numDistance.setValue(null!==e.get_HSpace()?Common.Utils.Metric.fnRecalcFromMM(e.get_HSpace()):""),(i=e.get_DropCap())==Asc.c_oAscDropCap.Drop?this.btnInText.toggle(!0,!1):i==Asc.c_oAscDropCap.Margin?this.btnInMargin.toggle(!0,!1):this.btnNone.toggle(!0,!1),i=e.get_FontFamily()){var s=this.cmbFonts.store.findWhere({name:i.get_Name()});s?this.cmbFonts.setValue(s.get("name")):this.cmbFonts.setRawValue(i.get_Name())}if(this.Borders=new Asc.asc_CParagraphBorders(e.get_Borders()),this.Borders){var o=this.Borders.get_Left(),a=null!=o&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"";this.spnMarginLeft.setValue(a),a=null!=(o=this.Borders.get_Top())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginTop.setValue(a),a=null!=(o=this.Borders.get_Right())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginRight.setValue(a),a=null!=(o=this.Borders.get_Bottom())&&null!==o.get_Space()&&void 0!==o.get_Space()?Common.Utils.Metric.fnRecalcFromMM(o.get_Space()):"",this.spnMarginBottom.setValue(a)}var l=e.get_Shade();if(null!=l&&l.get_Value()===Asc.c_oAscShdClear){var r=l.get_Color();r?r.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?this.paragraphShade={color:Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()),effectValue:r.get_value()}:this.paragraphShade=Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()):this.paragraphShade="transparent"}else this.paragraphShade="transparent";this.btnBackColor.setColor(this.paragraphShade),Common.Utils.ThemeColor.selectPickerColorByEffect(this.paragraphShade,this.colorsBack),this._UpdateBorders()}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphFrame,this.isFrame&&e&&void 0!==e.get_W()&&this._changedProps.put_W(e.get_W()),this.ChangedBorders=void 0}},_DisableElem:function(t){var e=t===Asc.c_oAscDropCap.None||t===c_oAscFrameWrap.None;_.each(this.btnsCategory,(function(t){"id-adv-dropcap-borders"!=t.options.contentTarget&&"id-adv-dropcap-margins"!=t.options.contentTarget||t.setDisabled(e)})),this.isFrame?(e=t==c_oAscFrameWrap.None,this.cmbHAlign.setDisabled(e),this.cmbHRelative.setDisabled(e),this.spnX.setDisabled(e),this.cmbVAlign.setDisabled(e),this.cmbVRelative.setDisabled(e),this.spnY.setDisabled(e),this.chMove.setDisabled(e),this.cmbWidth.setDisabled(e),this.cmbHeight.setDisabled(e),this.spnWidth.setDisabled(e),this.spnHeight.setDisabled(e)):(e=t==Asc.c_oAscDropCap.None,this.spnRowHeight.setDisabled(e),this.numDistance.setDisabled(e),this.cmbFonts.setDisabled(e))},_UpdateBorders:function(){var t=this.BorderSize,e=this.btnBorderColor.color;if(this._UpdateBorder(this.Borders.get_Left(),"l"),this._UpdateBorder(this.Borders.get_Top(),"t"),this._UpdateBorder(this.Borders.get_Right(),"r"),this._UpdateBorder(this.Borders.get_Bottom(),"b"),null!==this.Borders.get_Between())for(var i=0;i<this.tableStyler.rows-1;i++)this._UpdateCellBorder(this.Borders.get_Between(),this.tableStyler.getCellBorder(i,-1));this.tableStyler.setVirtualBorderSize(t.pxValue),this.tableStyler.setVirtualBorderColor("object"==typeof e?e.color:e),this.tableStyler.redrawTable()},_UpdateCellBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(e.setBordersSize(this._BorderPt2Px(72*t.get_Size()/25.4)),e.setBordersColor("rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):e.setBordersSize(0)},_UpdateBorder:function(t,e){null!=t&&null!==t.get_Value()&&null!==t.get_Size()&&null!==t.get_Color()&&1==t.get_Value()?(this.tableStyler.setBordersSize(e,this._BorderPt2Px(72*t.get_Size()/25.4)),this.tableStyler.setBordersColor(e,"rgb("+t.get_Color().get_r()+","+t.get_Color().get_g()+","+t.get_Color().get_b()+")")):this.tableStyler.setBordersSize(e,0)},_BorderPt2Px:function(t){return 0==t?0:t<.6?.5:t<=1?1:t<=1.5?2:t<=2.25?3:t<=3?4:t<=4.5?6:8},_ApplyBorderPreset:function(t){this.ChangedBorders=null,this.Borders.put_Left(this._UpdateBorderStyle(this.Borders.get_Left(),t.indexOf("l")>-1)),this.Borders.put_Top(this._UpdateBorderStyle(this.Borders.get_Top(),t.indexOf("t")>-1)),this.Borders.put_Right(this._UpdateBorderStyle(this.Borders.get_Right(),t.indexOf("r")>-1)),this.Borders.put_Bottom(this._UpdateBorderStyle(this.Borders.get_Bottom(),t.indexOf("b")>-1)),this.Borders.put_Between(this._UpdateBorderStyle(this.Borders.get_Between(),t.indexOf("m")>-1)),this._UpdateBorders()},_UpdateBorderStyle:function(t,e){if(null==t&&(t=new Asc.asc_CTextBorder),e&&this.BorderSize.ptValue>0){var i,n=parseFloat(this.BorderSize.ptValue);t.put_Value(1),t.put_Size(25.4*n/72),this.btnBorderColor.isAutoColor()?(i=new Asc.asc_CColor).put_auto(!0):i=Common.Utils.ThemeColor.getRgbColor(this.btnBorderColor.color),t.put_Color(i)}else t.put_Color(new Asc.asc_CColor),t.put_Value(0);return t},_UpdateCellBordersStyle:function(t,e,i,n,s){var o=s;o.put_Between(this._UpdateBorderStyle(o.get_Between(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Between(new Asc.asc_CTextBorder(o.get_Between()))},_UpdateTableBordersStyle:function(t,e,i,n,s){var o=s;e.indexOf("l")>-1&&(o.put_Left(this._UpdateBorderStyle(o.get_Left(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Left(new Asc.asc_CTextBorder(o.get_Left()))),e.indexOf("t")>-1&&(o.put_Top(this._UpdateBorderStyle(o.get_Top(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Top(new Asc.asc_CTextBorder(o.get_Top()))),e.indexOf("r")>-1&&(o.put_Right(this._UpdateBorderStyle(o.get_Right(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Right(new Asc.asc_CTextBorder(o.get_Right()))),e.indexOf("b")>-1&&(o.put_Bottom(this._UpdateBorderStyle(o.get_Bottom(),i>0)),this.ChangedBorders&&this.ChangedBorders.put_Bottom(new Asc.asc_CTextBorder(o.get_Bottom())))},textTitle:"Drop Cap - Advanced Settings",strBorders:"Borders & Fill",textBorderWidth:"Border Size",textBorderColor:"Border Color",textBackColor:"Background Color",textBorderDesc:"Click on diagramm or use buttons to select borders",textPosition:"Position",textAlign:"Alignment",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textCenter:"Center",strMargins:"Margins",strDropcap:"Drop Cap",textNone:"None",textInText:"In text",textInMargin:"In margin",textParameters:"Parameters",textRowHeight:"Height in rows",textDistance:"Distance from text",textFont:"Font",textInline:"Inline frame",textFlow:"Flow frame",textFrame:"Frame",textWidth:"Width",textHeight:"Height",textAuto:"Auto",textExact:"Exactly",textAtLeast:"At least",textMove:"Move with text",textHorizontal:"Horizontal",textVertical:"Vertical",textRelative:"Relative to",textColumn:"Column",textMargin:"Margin",textPage:"Page",textParagraph:"Paragraph",tipFontName:"Font Name",textTitleFrame:"Frame - Advanced Settings"},DE.Views.DropcapSettingsAdvanced||{}))})),void 0===Common)Common={};if(define("documenteditor/main/app/view/StyleTitleDialog",[],(function(){"use strict";DE.Views.StyleTitleDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textHeader},t||{}),this.template=['<div class="box">','<label class="input-row" style="margin-bottom: -5px;">'+this.textTitle+" </label>",'<div id="id-dlg-style-title" class="input-row" style="margin-bottom: 5px;"></div>','<label class="input-row" style="margin-bottom: -5px; margin-top: 5px;">'+this.textNextStyle+"</label>",'<div id="id-dlg-style-next-par" class="input-group-nr" style="margin-bottom: 5px;" ></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.options.formats=this.options.formats||[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputTitle=new Common.UI.InputField({el:$("#id-dlg-style-title"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validation:function(e){return!!(""!=(e=e.trim()))||t.txtNotEmpty}}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.formats.unshift({value:-1,displayValue:this.txtSameAs}),this.cmbNextStyle=new Common.UI.ComboBox({el:$("#id-dlg-style-next-par"),style:"width: 100%;",menuStyle:"width: 100%; max-height: 210px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:this.options.formats,disabled:0==this.options.formats.length}),this.cmbNextStyle.setValue(-1)},getFocusedComponents:function(){return[this.inputTitle,this.cmbNextStyle].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputTitle},getTitle:function(){return this.inputTitle.getValue().trim()},getNextStyle:function(){var t=this.cmbNextStyle.getValue();return-1!=t?t:null},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t)if(!0!==this.inputTitle.checkValidate())return void this.inputTitle.focus();this.options.handler.call(this,this,t)}this.close()},textTitle:"Title",textHeader:"Create New Style",txtEmpty:"This field is required",txtNotEmpty:"Field must not be empty",textNextStyle:"Next paragraph style",txtSameAs:"Same as created new style"},DE.Views.StyleTitleDialog||{}))})),define("documenteditor/main/app/view/TableFormulaDialog",[],(function(){"use strict";DE.Views.TableFormulaDialog=Common.UI.Window.extend(_.extend({options:{width:300,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textFormula+"</label>","</div>",'<div id="id-dlg-formula-formula" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textFormat+"</label>","</div>",'<div id="id-dlg-formula-format" class="input-row" style="margin-bottom: 20px;"></div>','<div class="input-row" style="margin-bottom: 10px;">','<div id="id-dlg-formula-function" style="display: inline-block; width: 50%;" class="float-left padding-right-10"></div>','<div id="id-dlg-formula-bookmark" style="display: inline-block; width: 50%;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.bookmarks=this.options.bookmarks,this.api=this.options.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.inputFormula=new Common.UI.InputField({el:$("#id-dlg-formula-formula"),allowBlank:!0,validateOnChange:!0,style:"width: 100%;"}).on("changing",_.bind(this.checkFormulaInput,this)),this.cmbFormat=new Common.UI.ComboBox({el:$("#id-dlg-formula-format"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 200px;",takeFocusOnClose:!0}),this.cmbFunction=new Common.UI.ComboBox({el:$("#id-dlg-formula-function"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 150px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{displayValue:"ABS",value:1},{displayValue:"AND",value:1},{displayValue:"AVERAGE",value:1},{displayValue:"COUNT",value:1},{displayValue:"DEFINED",value:1},{displayValue:"FALSE",value:0},{displayValue:"IF",value:1},{displayValue:"INT",value:1},{displayValue:"MAX",value:1},{displayValue:"MIN",value:1},{displayValue:"MOD",value:1},{displayValue:"NOT",value:1},{displayValue:"OR",value:1},{displayValue:"PRODUCT",value:1},{displayValue:"ROUND",value:1},{displayValue:"SIGN",value:1},{displayValue:"SUM",value:1},{displayValue:"TRUE",value:0}]}),this.cmbFunction.on("selected",_.bind((function(e,i){e.setValue(this.textInsertFunction);var n=t.inputFormula._input,s=n[0].selectionEnd;n.val(n.val().substring(0,s)+i.displayValue+(i.value?"()":"")+n.val().substring(s)),n.focus(),n[0].selectionStart=n[0].selectionEnd=s+i.displayValue.length+i.value,this.btnOk.setDisabled(!1)}),this)),this.cmbFunction.setValue(this.textInsertFunction),this.cmbBookmark=new Common.UI.ComboBox({el:$("#id-dlg-formula-bookmark"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 150px;",editable:!1,takeFocusOnClose:!0}),this.cmbBookmark.on("selected",_.bind((function(e,i){e.setValue(this.textBookmark);var n=t.inputFormula._input,s=n[0].selectionEnd;n.val(n.val().substring(0,s)+i.displayValue+n.val().substring(s)),n.focus(),n[0].selectionStart=n[0].selectionEnd=s+i.displayValue.length,this.btnOk.setDisabled(!1)}),this)),this.cmbBookmark.setValue(this.textBookmark),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputFormula,this.cmbFormat,this.cmbFunction,this.cmbBookmark].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputFormula},onSelectItem:function(t,e,i,n){this.btnOk.setDisabled(0==i.get("level")&&i.get("index")>0)},afterRender:function(){this.refreshBookmarks(),this._setDefaults()},_setDefaults:function(){var t=[];_.each(this.api.asc_GetTableFormulaFormats(),(function(e){t.push({value:e,displayValue:e})})),this.cmbFormat.setData(t);var e=this.api.asc_ParseTableFormulaInstrLine(this.api.asc_GetTableFormula());this.inputFormula.setValue(e[0]),this.cmbFormat.setValue(e[1]),this.checkFormulaInput(this.inputFormula,this.inputFormula.getValue())},refreshBookmarks:function(){var t=[];if(this.bookmarks){for(var e=this.bookmarks.asc_GetCount(),i=0;i<e;i++){var n=this.bookmarks.asc_GetName(i);this.bookmarks.asc_IsInternalUseBookmark(n)||t.push({value:i,displayValue:n})}this.cmbBookmark.setData(t),this.cmbBookmark.setValue(this.textBookmark)}this.cmbBookmark.setDisabled(t.length<1)},checkFormulaInput:function(t,e){var i=e.trim();this.btnOk.setDisabled(""==i||"="==i)},getSettings:function(){return this.api.asc_CreateInstructionLine(this.inputFormula.getValue(),this.cmbFormat.getValue())},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},textFormula:"Formula",textFormat:"Number Format",textBookmark:"Paste Bookmark",textInsertFunction:"Paste Function",textTitle:"Formula Settings"},DE.Views.TableFormulaDialog||{}))})),define("documenteditor/main/app/view/TableToTextDialog",[],(function(){"use strict";DE.Views.TableToTextDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 240px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 8px;"><label class="font-weight-bold">'+this.textSeparator+"</label></div>",'<div id="id-table-text-radio-para" style="margin-bottom: 8px;"></div>','<div id="id-table-text-radio-tabs" style="margin-bottom: 8px;"></div>','<div id="id-table-text-radio-semi" style="margin-bottom: 5px;"></div>','<div style="margin-bottom: 24px;">','<div id="id-table-text-radio-other" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-table-text-txt-other" style="display: inline-block;vertical-align: middle;"></div>',"</div>",'<div id="id-table-text-check-nested"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.rbPara=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-para"),labelText:this.textPara,name:"asc-radio-table-text-separator",value:1}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbTabs=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-tabs"),labelText:this.textTab,name:"asc-radio-table-text-separator",value:2,checked:!0}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbSemi=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-semi"),labelText:this.textSemicolon,name:"asc-radio-table-text-separator",value:";"}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbOther=new Common.UI.RadioBox({el:t.find("#id-table-text-radio-other"),labelText:this.textOther,name:"asc-radio-table-text-separator",value:3}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.inputOther=new Common.UI.InputField({el:t.find("#id-table-text-txt-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:"-",disabled:!0}),this.chNested=new Common.UI.CheckBox({el:t.find("#id-table-text-check-nested"),labelText:this.textNested,value:!0,disabled:!0}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.rbPara,this.rbTabs,this.rbSemi,this.rbOther,this.inputOther,this.chNested].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rbTabs},setSettings:function(t){},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){return{type:this.rbPara.getValue()?1:this.rbTabs.getValue()?2:3,separator:this.rbSemi.getValue()?";".charCodeAt(0):this.rbOther.getValue()?this.inputOther.getValue().charCodeAt(0):void 0,nested:"checked"===this.chNested.getValue()}},onRadioSeparatorChange:function(t,e,i){var n=t.options.value,s=this;e&&(this.inputOther.setDisabled(3!==n),3==n&&setTimeout((function(){s.inputOther.focus()}),1),1!==n&&this.chNested.setValue(!0),this.chNested.setDisabled(1!==n))},isRangeValid:function(){if(this.rbOther.getValue()&&""==this.inputOther.getValue()){var t=this;return Common.UI.warning({msg:this.textEmpty,maxwidth:600,callback:function(e){t.inputOther.focus()}}),!1}return!0},textTitle:"Convert Table to Text",textSeparator:"Separate text with",textPara:"Paragraph marks",textTab:"Tabs",textSemicolon:"Semicolons",textOther:"Other",textNested:"Convert nested tables",textEmpty:"You must type a character for the custom separator."},DE.Views.TableToTextDialog||{}))})),define("documenteditor/main/app/view/TextToTableDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views.TextToTableDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="2" style="width: auto;">',"<tr>",'<td colspan="2" class="padding-small">','<label class="header">',e.textTableSize,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="margin-right-10">',e.textColumns,"</label>","</td>",'<td class="padding-small">','<div id="id-text-table-spn-columns"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="margin-right-10">',e.textRows,"</label>","</td>",'<td class="padding-large">','<div id="id-text-table-spn-rows"></div>',"</td>","</tr>","</table>",'<table cols="1">',"<tr>",'<td  style="padding-bottom: 5px;">','<label class="header">',e.textAutofit,"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<div id="id-text-table-radio-fixed" class="margin-right-10"></div>','<div id="id-text-table-spn-fixed"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-contents"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="id-text-table-radio-window"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textSeparator,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-para"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-tabs"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<div id="id-text-table-radio-semi"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="id-text-table-radio-other" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-text-table-txt-other" style="display: inline-block;vertical-align: middle;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,this.props=t.props,this.spinners=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),e=this;this.spnColumns=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-columns"),step:1,width:80,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}).on("change",(function(t,i,n,s){if(e.props){var o=e.props.put_ColsCount(t.getNumberValue(),!0);o&&e.spnRows.setValue(o[0],!0)}})),this.spnRows=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-rows"),step:1,width:80,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1,disabled:!0}),this.spnWidth=new Common.UI.MetricSpinner({el:t.find("#id-text-table-spn-fixed"),step:.1,width:80,defaultUnit:"cm",value:"Auto",autoText:this.txtAutoText,maxValue:55.87,minValue:.42,allowAuto:!0}),this.spinners.push(this.spnWidth),this.rbFixed=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-fixed"),labelText:this.textFixed,name:"asc-radio-text-table-autofit",value:1,checked:!0}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbContents=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-contents"),labelText:this.textContents,name:"asc-radio-text-table-autofit",value:2}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbWindow=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-window"),labelText:this.textWindow,name:"asc-radio-text-table-autofit",value:3}).on("change",_.bind(this.onRadioAutofitChange,this)),this.rbPara=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-para"),labelText:this.textPara,name:"asc-radio-text-table-separator",value:1,checked:!0}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbTabs=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-tabs"),labelText:this.textTab,name:"asc-radio-text-table-separator",value:2}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbSemi=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-semi"),labelText:this.textSemicolon,name:"asc-radio-text-table-separator",value:";"}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.rbOther=new Common.UI.RadioBox({el:t.find("#id-text-table-radio-other"),labelText:this.textOther,name:"asc-radio-text-table-separator",value:3}).on("change",_.bind(this.onRadioSeparatorChange,this)),this.inputOther=new Common.UI.InputField({el:t.find("#id-text-table-txt-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:Common.Utils.InternalSettings.get("de-text-to-table-separator")||"-"}).on("changing",(function(t,i){if(e.props&&i){e.props.put_SeparatorType(3,!0);var n=e.props.put_Separator(i.charCodeAt(0),!0);n&&(e.spnColumns.setValue(n[1],!0),e.spnRows.setValue(n[0],!0))}})),this.afterRender()},getFocusedComponents:function(){return[this.spnColumns,this.spnStartAt,this.spnWidth,this.rbFixed,this.rbContents,this.rbWindow,this.rbPara,this.rbTabs,this.rbSemi,this.rbOther,this.inputOther].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnColumns},afterRender:function(){this.updateMetricUnit(),this._setDefaults(this.props)},_setDefaults:function(t){if(t){var e=t.get_Size();switch(this.spnColumns.setValue(e[1],!0),this.spnRows.setValue(e[0],!0),1===(e=t.get_AutoFitType())?this.rbFixed.setValue(!0,!0):2===e?this.rbContents.setValue(!0,!0):this.rbWindow.setValue(!0,!0),1===e&&this.spnWidth.setValue(t.get_Fit()>-1?Common.Utils.Metric.fnRecalcFromMM(t.get_Fit()):-1,!0),this.spnWidth.setDisabled(1!==e),e=t.get_SeparatorType()){case 1:this.rbPara.setValue(!0,!0),this.inputOther.setDisabled(!0);break;case 2:this.rbTabs.setValue(!0,!0),this.inputOther.setDisabled(!0);break;case 3:";"==(e=String.fromCharCode(t.get_Separator()))?(this.rbSemi.setValue(!0,!0),this.inputOther.setDisabled(!0)):(this.rbOther.setValue(!0,!0),this.inputOther.setValue(e),this.inputOther.setDisabled(!1))}}},getSettings:function(){return this.props&&(this.props.put_AutoFitType(this.rbFixed.getValue()?1:this.rbContents.getValue()?2:3),this.rbFixed.getValue()&&this.props.put_Fit(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this.rbOther.getValue()&&Common.Utils.InternalSettings.set("de-text-to-table-separator",String.fromCharCode(this.props.get_Separator()))),this.props},onDlgBtnClick:function(t){var e="object"==typeof t?t.currentTarget.attributes.result.value:t;if("ok"==e){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)}this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},isRangeValid:function(){if(this.rbOther.getValue()&&""==this.inputOther.getValue()){var t=this;return Common.UI.warning({msg:this.textEmpty,maxwidth:600,callback:function(e){t.inputOther.focus()}}),!1}return!0},onRadioAutofitChange:function(t,e,i){var n=t.options.value,s=this;e&&this.props&&(s.spnWidth.setDisabled(1!==n),1==n&&setTimeout((function(){s.spnWidth.focus()}),1))},onRadioSeparatorChange:function(t,e,i){var n,s=t.options.value,o=this;e&&this.props&&(this.inputOther.setDisabled(3!==s),"string"==typeof s?n=this.props.put_Separator(s.charCodeAt(0),!0):3==s?(this.inputOther.getValue()&&(n=this.props.put_Separator(this.inputOther.getValue().charCodeAt(0),!0)),setTimeout((function(){o.inputOther.focus()}),1)):n=this.props.put_SeparatorType(s,!0),n&&(this.spnColumns.setValue(n[1],!0),this.spnRows.setValue(n[0],!0)))},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},textTitle:"Convert Text to Table",textTableSize:"Table Size",textColumns:"Columns",textRows:"Rows",textAutofit:"Autofit Behavior",textFixed:"Fixed column width",textContents:"Autofit to contents",textWindow:"Autofit to window",textSeparator:"Separate Text at",textPara:"Paragraphs",textTab:"Tabs",textSemicolon:"Semicolons",textOther:"Other",txtAutoText:"Auto",textEmpty:"You must type a character for the custom separator."},DE.Views.TextToTableDialog||{}))})),define("text!documenteditor/main/app/template/WatermarkSettings.template",[],(function(){return'<div class="settings-panel active">\n<div class="inner-content">\n<table cols="1" style="width: 100%;" role="presentation">\n    <tr><td class="padding-small">\n        <div id="watermark-radio-none"></div>\n    </td></tr>\n    <tr><td class="padding-small">\n        <div id="watermark-radio-text"></div>\n    </td></tr>\n    <tr><td class="padding-large">\n        <table id="watermark-tbl-text" class="margin-left-22" cols="2" role="presentation">\n            <tr>\n                <td class="language">\n                    <label class="input-label"><%= scope.textLanguage %></label>\n                </td>\n                <td>\n                    <label class="input-label"><%= scope.textText %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="language padding-small">\n                    <div id="watermark-combo-lang"></div>\n                </td>\n                <td class="padding-small">\n                    <div id="watermark-combo-text"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="input-label"><%= scope.textFont %></label>\n                </td>\n                <td>\n                    <label class="input-label"></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="watermark-fonts" class="display-inline-block-middle"></div>\n                </td>\n                <td class="padding-large">\n                    <div id="watermark-font-size" class="display-inline-block-middle"></div>\n                    <div id="watermark-textcolor" class="display-inline-block-middle margin-left-2"></div>\n                    <div id="watermark-bold" class="display-inline-block-middle margin-left-2"></div>\n                    <div id="watermark-italic" class="display-inline-block-middle margin-left-2"></div>\n                    <div id="watermark-underline" class="display-inline-block-middle margin-left-2"></div>\n                    <div id="watermark-strikeout" class="display-inline-block-middle"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="watermark-chb-transparency"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2">\n                    <label class="layout-label"><%= scope.textLayout %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2">\n                    <div id="watermark-radio-diag" class="display-inline-block-middle"></div>\n                    <div id="watermark-radio-hor" class="display-inline-block-middle margin-left-15"></div>\n                </td>\n            </tr>\n        </table>\n    </td></tr>\n    <tr><td class="padding-small">\n        <div id="watermark-radio-image"></div>\n    </td></tr>\n    <tr><td class="padding-small">\n        <table id="watermark-tbl-image" class="margin-left-22" cols="2" role="presentation">\n            <tr>\n                <td class="select-image">\n                    <div id="watermark-select-image"></div>\n                </td>\n                <td rowspan="2">\n                    <div class="texture-img">\n                        <div id="watermark-texture-img"></div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n                <td class="scale">\n                    <label class="input-label"><%= scope.textScale %></label>\n                    <div id="watermark-combo-scale"></div>\n                </td>\n            </tr>\n            </table>\n    </td></tr>\n</table>\n</div>\n</div>'})),define("documenteditor/main/app/view/WatermarkSettingsDialog",["text!documenteditor/main/app/template/WatermarkSettings.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.WatermarkText=new function(){var t;return{get:function(){return t},load:function(e){t=[],Common.Utils.loadConfig("resources/watermark/wm-text.json",(function(i){for(var n in i){var s=Common.util.LanguageInfo.getLocalLanguageCode(n);s&&t.push({code:s,name:Common.util.LanguageInfo.getLocalLanguageName(s)[1],shortname:Common.util.LanguageInfo.getLocalLanguageName(s)[0],text:i[n]})}t.sort((function(t,e){return t.shortname<e.shortname?-1:t.shortname>e.shortname?1:0})),e&&e(t)}))}}},DE.Views.WatermarkSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:405,separator:!1,id:"window-watermark"},initialize:function(e){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 10px 5px;",contentTemplate:_.template(t)({scope:this})},e),this.handler=e.handler,this.props=e.props,this.fontStore=e.fontStore,this.api=e.api,this.storage=!!e.storage,this.textControls=[],this.imageControls=[],this.fontName="Arial",this.text="",this.isAutoColor=!1,this.isImageLoaded=!1;var i=e.lang||"en",n=Common.util.LanguageInfo.getLocalLanguageCode(i);this.lang=n?{value:i,displayValue:Common.util.LanguageInfo.getLocalLanguageName(n)[1],default:!0}:{value:"en",displayValue:"English",default:!0},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.radioNone=new Common.UI.RadioBox({el:$("#watermark-radio-none"),name:"asc-radio-watermark-type",labelText:this.textNone,checked:!1}),this.radioNone.on("change",_.bind((function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.None),this.disableControls(Asc.c_oAscWatermarkType.None))}),this)),this.radioImage=new Common.UI.RadioBox({el:$("#watermark-radio-image"),name:"asc-radio-watermark-type",labelText:this.textImageW,checked:!1}),this.radioImage.on("change",_.bind((function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.Image),this.disableControls(Asc.c_oAscWatermarkType.Image),this.focusControls())}),this)),this.radioText=new Common.UI.RadioBox({el:$("#watermark-radio-text"),name:"asc-radio-watermark-type",labelText:this.textTextW,checked:!0}),this.radioText.on("change",_.bind((function(t,e,i){e&&(this.props.put_Type(Asc.c_oAscWatermarkType.Text),this.disableControls(Asc.c_oAscWatermarkType.Text),this.focusControls())}),this)),this.btnSelectImage=new Common.UI.Button({parentEl:$("#watermark-select-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 142px;",menu:new Common.UI.Menu({style:"min-width: 142px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),takeFocusOnClose:!0}),this.imageControls.push(this.btnSelectImage),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnSelectImage.menu.items[1].setDisabled(this.options.disableNetworkFunctionality),this.btnSelectImage.menu.items[2].setDisabled(this.options.disableNetworkFunctionality),this._arrScale=[{displayValue:this.textAuto,value:-1},{displayValue:"500%",value:500},{displayValue:"200%",value:200},{displayValue:"150%",value:150},{displayValue:"100%",value:100},{displayValue:"50%",value:50}],this.cmbScale=new Common.UI.ComboBox({el:$("#watermark-combo-scale"),cls:"input-group-nr",style:"width: 142px;",menuStyle:"min-width: 142px;",data:this._arrScale,takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){}),this)),this.cmbScale.setValue(this._arrScale[0].value),this.imageControls.push(this.cmbScale),this.cmbLang=new Common.UI.ComboBox({el:$("#watermark-combo-lang"),cls:"input-group-nr",style:"width: 142px;",editable:!1,menuStyle:"min-width: 100%;max-height: 210px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}).on("selected",_.bind(this.onSelectLang,this)),this.cmbLang.setValue(Common.util.LanguageInfo.getLocalLanguageName(9)[1]),this.textControls.push(this.cmbLang),this.cmbText=new Common.UI.ComboBox({el:$("#watermark-combo-text"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 210px;",scrollAlwaysVisible:!0,displayField:"value",focusWhenNoSelection:!1,data:[{value:"ASAP"},{value:"CONFIDENTIAL"},{value:"COPY"},{value:"DO NOT COPY"},{value:"DRAFT"},{value:"ORIGINAL"},{value:"PERSONAL"},{value:"SAMPLE"},{value:"TOP SECRET"},{value:"URGENT"}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){}),this)),this.cmbText.setValue(this.cmbText.options.data[0].value),this.textControls.push(this.cmbText),this.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#watermark-fonts"),cls:"input-group-nr",style:"width: 142px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.fontName=e.name}),this)),this.textControls.push(this.cmbFonts);var t=[{value:-1,displayValue:this.textAuto},{value:36,displayValue:"36"},{value:40,displayValue:"40"},{value:44,displayValue:"44"},{value:48,displayValue:"48"},{value:54,displayValue:"54"},{value:60,displayValue:"60"},{value:66,displayValue:"66"},{value:72,displayValue:"72"},{value:80,displayValue:"80"},{value:90,displayValue:"90"},{value:96,displayValue:"96"},{value:105,displayValue:"105"},{value:120,displayValue:"120"},{value:144,displayValue:"144"}];this.cmbFontSize=new Common.UI.ComboBox({el:$("#watermark-font-size"),cls:"input-group-nr",style:"width: 55px;",menuCls:"scrollable-menu",menuStyle:"min-width: 55px;max-height: 270px;",hint:this.tipFontSize,data:t,takeFocusOnClose:!0}),this.cmbFontSize.setValue(-1),this.textControls.push(this.cmbFontSize),this.btnBold=new Common.UI.Button({parentEl:$("#watermark-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.textControls.push(this.btnBold),this.btnItalic=new Common.UI.Button({parentEl:$("#watermark-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.textControls.push(this.btnItalic),this.btnUnderline=new Common.UI.Button({parentEl:$("#watermark-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline}),this.textControls.push(this.btnUnderline),this.btnStrikeout=new Common.UI.Button({parentEl:$("#watermark-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout}),this.textControls.push(this.btnStrikeout),this.btnTextColor=new Common.UI.ButtonColored({parentEl:$("#watermark-textcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,additionalAlign:this.menuAddAlign,auto:!0,color:"c0c0c0",menu:!0,takeFocusOnClose:!0}),this.btnTextColor.setMenu(),this.mnuTextColorPicker=this.btnTextColor.getPicker(),this.btnTextColor.currentColor="c0c0c0",this.textControls.push(this.btnTextColor),this.btnTextColor.on("color:select",_.bind(this.onColorSelect,this)),this.btnTextColor.on("auto:select",_.bind(this.onAutoColor,this)),this.chTransparency=new Common.UI.CheckBox({el:$("#watermark-chb-transparency"),labelText:this.textTransparency,value:!0}),this.textControls.push(this.chTransparency),this.radioDiag=new Common.UI.RadioBox({el:$("#watermark-radio-diag"),name:"asc-radio-watermark-layout",labelText:this.textDiagonal,checked:!0}),this.textControls.push(this.radioDiag),this.radioHor=new Common.UI.RadioBox({el:$("#watermark-radio-hor"),name:"asc-radio-watermark-layout",labelText:this.textHor}),this.textControls.push(this.radioHor),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.btnOk.setDisabled(!0),this.afterRender()},getFocusedComponents:function(){return[this.radioNone,this.radioText,this.cmbLang,this.cmbText,this.cmbFonts,this.cmbFontSize,this.btnTextColor,this.btnBold,this.btnItalic,this.btnUnderline,this.btnStrikeout,this.chTransparency,this.radioDiag,this.radioHor,this.radioImage,this.btnSelectImage,this.cmbScale].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbLang.isDisabled()?this.btnSelectImage.isDisabled()?this.radioNone:this.btnSelectImage:this.cmbLang},focusControls:function(){var t=this.getDefaultFocusableComponent();t&&setTimeout((function(){t.focus()}),10)},onColorSelect:function(t,e){this.isAutoColor=!1,this.btnTextColor.currentColor=e},updateThemeColors:function(){this.mnuTextColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onAutoColor:function(t){this.isAutoColor=!0,this.btnTextColor.currentColor="000"},afterRender:function(){this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.fontName})),this.updateThemeColors(),this._setDefaults(this.props);var t=this,e=function(){t.isImageLoaded=!0,t.btnOk.setDisabled(!1)};this.api.asc_registerCallback("asc_onWatermarkImageLoaded",e);var i=function(e){e&&e._urls&&"watermark"==e.c&&t.props.put_ImageUrl(e._urls[0],e.token)};Common.NotificationCenter.on("storage:image-insert",i),this.on("close",(function(n){t.api.asc_unregisterCallback("asc_onWatermarkImageLoaded",e),Common.NotificationCenter.off("storage:image-insert",i)}))},loadLanguages:function(){var t=this,e=!1,i=function(i){var n=[];if(t.languages=i,t.languages&&t.languages.forEach((function(t){n.push({displayValue:t.name,value:t.shortname,wmtext:t.text})})),n.length){t.cmbLang.setData(n);var s=t.loadWMText(t.lang.value);s&&(t.lang.default||s.foundSameLang)?t.cmbLang.setValue(s.value):t.cmbLang.setValue(t.lang.displayValue),t.cmbLang.setDisabled(!t.radioText.getValue()),t.text&&t.cmbText.setValue(t.text)}else t.cmbLang.setDisabled(!0);e&&t.focusControls()},n=DE.Views.WatermarkText.get();e=!n,n?i(n):DE.Views.WatermarkText.load(i)},onSelectLang:function(t,e){if(e){var i=[];e.wmtext.forEach((function(t){i.push({value:t})})),this.lang=e,i.length>0&&(this.cmbText.setData(i),this.cmbText.setValue(i[0].value))}},loadWMText:function(t){if(t){var e=[],i=!0,n=this.cmbLang.store.findWhere({value:t});return n||(n=this.cmbLang.store.findWhere({value:t.split(/[\-\_]/)[0]})),n||(i=!1,n=this.cmbLang.store.findWhere({value:"en"})),n||(n=this.cmbLang.store.at(0)),n&&n.get("wmtext").forEach((function(t){e.push({value:t})})),e.length>0&&(this.cmbText.setData(e),this.cmbText.setValue(e[0].value)),n?{value:n.get("value"),foundSameLang:i}:null}},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t){var n=e.replace(/ /g,"");_.isEmpty(n)||i.props.put_ImageUrl(n)}}}).on("close",(function(){i.btnSelectImage.focus()})).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","watermark"):this.props.showFileDialog()},_setDefaults:function(t){if(this.loadLanguages(),t){t.put_DivId("watermark-texture-img"),t.put_Api(this.api);var e,i=t.get_Type();if(i==Asc.c_oAscWatermarkType.None)this.radioNone.setValue(!0,!0);else if(i==Asc.c_oAscWatermarkType.Image)this.radioImage.setValue(!0,!0),this.isImageLoaded=!!t.get_ImageUrl(),e=t.get_Scale()||-1,this.cmbScale.setValue(e<0?-1:Math.round(100*e),Math.round(100*e)+" %");else{if(this.radioText.setValue(!0,!0),!t.get_IsDiagonal()&&this.radioHor.setValue(!0),this.chTransparency.setValue(t.get_Opacity()<255),e=t.get_TextPr()){var n=Common.util.LanguageInfo.getLocalLanguageName(e.get_Lang());this.lang={value:n[0],displayValue:n[1]};var s=n[0];this.cmbLang.store.findWhere({value:s})||(s=s.split(/[\-\_]/)[0]),this.cmbLang.setValue(s,n[1]),this.loadWMText(n[0]);var o=e.get_FontFamily().get_Name();if(o){var a=this.cmbFonts.store.findWhere({name:o});this.fontName=a?a.get("name"):o,this.cmbFonts.setValue(this.fontName)}this.cmbFontSize.setValue(e.get_FontSize()),this.btnBold.toggle(e.get_Bold()),this.btnItalic.toggle(e.get_Italic()),this.btnUnderline.toggle(e.get_Underline()),this.btnStrikeout.toggle(e.get_Strikeout());var l=e.get_Color(),r="c0c0c0";l.get_auto()?(r="000",this.isAutoColor=!0,this.mnuTextColorPicker.clearSelection(),this.btnTextColor.setAutoColor(!0)):(l&&(r=l.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(l.get_r(),l.get_g(),l.get_b()),effectValue:l.get_value()}:Common.Utils.ThemeColor.getHexColor(l.get_r(),l.get_g(),l.get_b())),Common.Utils.ThemeColor.selectPickerColorByEffect(r,this.mnuTextColorPicker)),this.btnTextColor.currentColor=r,this.btnTextColor.setColor(this.btnTextColor.currentColor)}(e=t.get_Text())&&this.cmbText.setValue(e),this.text=e||""}this.disableControls(i)}},getSettings:function(){var t=this.props,e=this.props.get_Type();if(e==Asc.c_oAscWatermarkType.Image)e=parseInt(this.cmbScale.getValue()),isNaN(e)&&(e=-1),t.put_Scale(e<0?e:e/100);else if(t.put_Text(this.cmbText.getValue()),t.put_IsDiagonal(this.radioDiag.getValue()),t.put_Opacity("checked"==this.chTransparency.getValue()?128:255),e=t.get_TextPr()||new Asc.CTextProp){e.put_FontSize(Math.min(this.cmbFontSize.getValue(),1638));var i=new AscCommon.asc_CTextFontFamily;i.put_Name(this.fontName),i.put_Index(-1),e.put_FontFamily(i),e.put_Bold(this.btnBold.pressed),e.put_Italic(this.btnItalic.pressed),e.put_Underline(this.btnUnderline.pressed),e.put_Strikeout(this.btnStrikeout.pressed),e.put_Lang(parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.lang.value)));var n=new Asc.asc_CColor;this.isAutoColor?n.put_auto(!0):n=Common.Utils.ThemeColor.getRgbColor(this.btnTextColor.currentColor),e.put_Color(n),t.put_TextPr(e)}return this.props},disableControls:function(t){var e=t!=Asc.c_oAscWatermarkType.Image;_.each(this.imageControls,(function(t){t.setDisabled(e)})),e=t!=Asc.c_oAscWatermarkType.Text,_.each(this.textControls,(function(t){t.setDisabled(e)})),this.cmbLang.setDisabled(e||!this.languages||this.languages.length<1),this.btnOk.setDisabled(t==Asc.c_oAscWatermarkType.Image&&!this.isImageLoaded)},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.btnOk.isDisabled())return;this.handler.call(this,t,this.getSettings())}this.close()},textTitle:"Watermark Settings",textNone:"None",textImageW:"Image watermark",textTextW:"Text watermark",textFromUrl:"From URL",textFromFile:"From File",textScale:"Scale",textAuto:"Auto",textText:"Text",textFont:"Font",tipFontName:"Font Name",tipFontSize:"Font Size",textBold:"Bold",textItalic:"Italic",textUnderline:"Underline",textStrikeout:"Strikeout",textTransparency:"Semitransparent",textLayout:"Layout",textDiagonal:"Diagonal",textHor:"Horizontal",textColor:"Text color",textLanguage:"Language",textFromStorage:"From Storage",textSelect:"Select Image"},DE.Views.WatermarkSettingsDialog||{}))})),define("documenteditor/main/app/view/RoleDeleteDlg",[],(function(){"use strict";DE.Views.RoleDeleteDlg=Common.UI.Window.extend(_.extend({options:{width:300,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="" style="margin-bottom: 10px;">',"<label>"+this.textLabel+"</label>","</div>",'<div class="input-row" style="">',"<label>"+this.textSelect+"</label>","</div>",'<div style="margin-bottom: 12px;">','<div id="id-role-del-remove" class="input-group-nr"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=t.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.cmbRole=new Common.UI.ComboBox({el:$("#id-role-del-remove",t),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 190px;max-width: 400px;",cls:"input-group-nr",data:[],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" style="overflow: hidden; text-overflow: ellipsis;"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join("")),editable:!1,takeFocusOnClose:!0}),this.afterRender()},getFocusedComponents:function(){return[this.cmbRole].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbRole},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){if(t){var e=[];t.roles.each((function(i,n){var s=i.get("name");s!==t.excludeName&&e.push({value:s,displayValue:s})})),this.cmbRole.setData(e),e.length>0&&this.cmbRole.setValue(e[0].value)}},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.cmbRole.getValue()),this.close()},textTitle:"Delete Role",textLabel:"To delete this role, you  need to move the fields associated with it to another role.",textSelect:"Select for field merger role"},DE.Views.RoleDeleteDlg||{}))})),define("documenteditor/main/app/view/RoleEditDlg",[],(function(){"use strict";DE.Views.RoleEditDlg=Common.UI.Window.extend(_.extend({options:{width:330,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">','<tr style="vertical-align: bottom;">','<td class="padding-right-10" style="width: 50px;">',"<label></label>",'<div id="id-dlg-role-color" style="margin-bottom: 10px;"></div>',"</td>","<td>","<label>"+this.textName+"</label>",'<div id="id-dlg-role-name" style="margin-bottom: 10px; "></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,this.colors=this.options.colors,this.lastColor="FFEFBF",this.oformManager=this.options.oformManager,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.inputName=new Common.UI.InputField({el:e.find("#id-dlg-role-name"),allowBlank:!1,blankError:t.textEmptyError,style:"width: 100%;",placeHolder:t.textNameEx,validateOnBlur:!1,validation:function(e){return e=e.trim(),_.isEmpty(e)?"":!((!t.props||e!==t.props.name)&&t.oformManager.asc_haveRole(e))||t.errNameExists}}),this.btnColor=new Common.UI.ColorButton({parentEl:e.find("#id-dlg-role-color"),additionalItemsBefore:[this.mnuNoFormsColor=new Common.UI.MenuItem({id:"id-dlg-role-menu-no-highlight",caption:this.textNoHighlight,checkable:!0,style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"}),{caption:"--"}],additionalAlign:this.menuAddAlign,colors:["FEF8E5","FFEFBF","E2EFD8","C6E0B3","EDEDED","DBDBDB","CDD6E4","A2B2CA","F2F2F2","D9D9D9","DDEBF6","C2DDF2","FBECE2","F7D9C6","D6E3EE","B9CAE7","F2DADA","F2C2C2","F0DDF6","E5C2F2","E6FBD6","CDF7AC","EED6D6","E7B9B9","CCE1FF","9AC4FF","E4CDDB","D9ADC7"],color:this.lastColor,themecolors:0,effects:0,colorHints:!1,takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.mnuNoFormsColor.on("click",_.bind(this.onNoColorClick,this)),this.mnuColorPicker=this.btnColor.getPicker(),this.afterRender()},afterRender:function(){this.setSettings(this.props),this.setTitle(this.options.isEdit?this.txtTitleEdit:this.txtTitleNew)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setSettings:function(t){if(t){var e=t.color;this.mnuNoFormsColor.setChecked(!e,!0),this.mnuColorPicker.clearSelection(),e&&(this.mnuColorPicker.selectByRGB(e,!0),this.lastColor=e),this.btnColor.setColor(e||"transparent"),this.inputName.setValue(t.name||"")}else{var i=_.difference(this.btnColor.options.colors,this.colors);if(i.length>0){var n=Math.floor(Math.random()*i.length);this.lastColor=i[n],this.mnuColorPicker.selectByRGB(this.lastColor,!0),this.btnColor.setColor(this.lastColor)}}},getSettings:function(){return{name:this.inputName.getValue(),color:this.mnuNoFormsColor.isChecked()?null:Common.Utils.ThemeColor.getRgbColor(this.lastColor)}},onColorsSelect:function(t,e){this.lastColor=e,this.mnuNoFormsColor.setChecked(!1,!0)},onNoColorClick:function(t){t.isChecked()?(this.btnColor.setColor("transparent"),this.mnuColorPicker.clearSelection()):(this.btnColor.setColor(this.lastColor),this.mnuColorPicker.selectByRGB(this.lastColor,!0))},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getFocusedComponents:function(){return[this.btnColor,this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputName.cmpEl.find("input").focus();this.options.handler.call(this,t,"ok"==t?this.getSettings():void 0)}this.close()},txtTitleEdit:"Edit Role",txtTitleNew:"Create New Role",textName:"Role name",textEmptyError:"Role name must not be empty.",textNoHighlight:"No highlighting",errNameExists:"Role with such a name already exists.",textNameEx:"Example: Applicant, Client, Sales Rep"},DE.Views.RoleEditDlg||{}))})),define("text!documenteditor/main/app/template/RolesManagerDlg.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label style="width: 415px;"><%= scope.textDescription %></label>\n                </td>\n                <td class="padding-small float-right padding-left-10">\n                    <div id="roles-manager-btn-up" style="display: inline-block;"></div>\n                    <div id="roles-manager-btn-down" style="display: inline-block;" class="margin-left-2"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <button type="button" class="btn btn-text-default margin-right-5" id="roles-manager-btn-new" style="min-width: 100px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default" id="roles-manager-btn-edit" style="min-width: 100px;"><%= scope.textEdit %></button>\n                    <button type="button" class="btn btn-text-default float-right" id="roles-manager-btn-delete" style="min-width: 100px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2>\n                    <div id="roles-manager-roles-list" class="roles-tableview no-borders" style="width:480px; height: 170px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("documenteditor/main/app/view/RolesManagerDlg",["text!documenteditor/main/app/template/RolesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views=DE.Views||{},DE.Views.RolesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"RolesManagerDlg",contentWidth:500,separator:!1,buttons:["close"]},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this.oformManager=this.api.asc_GetOForm(),this.wrapEvents={onRefreshRolesList:_.bind(this.onRefreshRolesList,this)},this.arrColors=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rolesList=new Common.UI.ListView({el:$("#roles-manager-roles-list",this.$window),store:new Common.UI.DataViewStore,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="">','<div class="listitem-icon" style="flex-shrink: 0;"><svg class=""><use xlink:href="#svg-icon-<%= scope.getIconCls(index) %>"></use></svg></div>','<div class="padding-right-5" style="width: 25px;text-align:center;flex-shrink: 0;"><%= index+1 %></div>','<div style="width: 25px;flex-shrink: 0;">','<span class="color" style="background: <% if (color) { %>#<%= color %><% } else { %> transparent <% } %>;"></span>',"</div>",'<div class="padding-right-5" style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="text-align-right" style="width: 25px;opacity: 0.8;flex-shrink: 0;"><%= fields %></div>',"</div>"].join("")),tabindex:1}),this.rolesList.on("item:select",_.bind(this.onSelectRoleItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRole=new Common.UI.Button({el:$("#roles-manager-btn-new",this.$window)}),this.btnNewRole.on("click",_.bind(this.onEditRole,this,!1)),this.btnEditRole=new Common.UI.Button({el:$("#roles-manager-btn-edit",this.$window)}),this.btnEditRole.on("click",_.bind(this.onEditRole,this,!0)),this.btnDeleteRole=new Common.UI.Button({el:$("#roles-manager-btn-delete",this.$window)}),this.btnDeleteRole.on("click",_.bind(this.onDeleteRole,this)),this.btnUp=new Common.UI.Button({parentEl:$("#roles-manager-btn-up",this.$window),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#roles-manager-btn-down",this.$window),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.afterRender()},getFocusedComponents:function(){return[this.btnUp,this.btnDown,this.btnNewRole,this.btnEditRole,this.btnDeleteRole,this.rolesList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rolesList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRolesList(this.oformManager.asc_getAllRoles(),0),this.api.asc_registerCallback("asc_onUpdateOFormRoles",this.wrapEvents.onRefreshRolesList)},onRefreshRolesList:function(t){this.refreshRolesList(t)},refreshRolesList:function(t,e){(void 0===e&&(e=this.lastSelectedRole),this.lastSelectedRole=void 0,void 0===e&&this.rolesList.store.length>0)&&((a=this.rolesList.getSelectedRec())&&(e=a.get("name")));if(this.arrColors=[],t){for(var i=[],n=0;n<t.length;n++){var s=t[n].asc_getSettings(),o=s.asc_getColor();o&&(o=Common.Utils.ThemeColor.getHexColor(o.get_r(),o.get_g(),o.get_b())),i.push({name:s.asc_getName()||this.textAnyone,color:o,fields:s.asc_getFieldCount()||0,index:n,scope:this}),o&&this.arrColors.push(o.toUpperCase())}this.rolesList.store.reset(i)}if(this.rolesList.store.length>0){var a,l=this;void 0===e&&(e=0),"string"==typeof e?(a=this.rolesList.store.findWhere({name:e}),this.rolesList.selectRecord(a)):(e=Math.min(e,this.rolesList.store.length-1),a=this.rolesList.selectByIndex(e)),setTimeout((function(){l.rolesList.scrollToRecord(a||l.rolesList.store.at(0))}),50)}this.updateButtons()},getIconCls:function(t){return 1===this.rolesList.store.length?"Point":0===t?"StartPoint":t===this.rolesList.store.length-1?"EndPoint":"MiddlePoint"},onEditRole:function(t){if(!this._isWarningVisible){var e=this,i=Common.Utils.getOffset(e.$window),n=this.rolesList.getSelectedRec(),s=new DE.Views.RoleEditDlg({oformManager:e.oformManager,props:t&&n?{name:n.get("name"),color:n.get("color")}:null,colors:e.arrColors,isEdit:t&&n,handler:function(i,s){if("ok"==i&&s){e.lastSelectedRole=s.name;var o=new AscCommon.CRoleSettings;o.asc_putName(s.name),o.asc_putColor(s.color),t&&n?e.oformManager.asc_editRole(n.get("name"),o):e.oformManager.asc_addRole(o)}}}).on("close",(function(){e.show(),setTimeout((function(){e.getDefaultFocusableComponent().focus()}),100)}));e.hide(),s.show(i.left+65,i.top+77)}},onDeleteRole:function(){var t=this,e=this.rolesList.store,i=this.rolesList.getSelectedRec();if(i){var n=function(n){t.lastSelectedRole=e.indexOf(i),t.oformManager.asc_removeRole(i.get("name"),n)};if(1===e.length||i.get("fields")<1)t._isWarningVisible=!0,Common.UI.warning({msg:Common.Utils.String.format(1===e.length?t.textDeleteLast:t.warnDelete,Common.Utils.String.htmlEncode(i.get("name"))),maxwidth:600,buttons:["ok","cancel"],callback:function(e){"ok"==e&&n(),setTimeout((function(){t.getDefaultFocusableComponent().focus()}),100),t._isWarningVisible=!1}});else{var s=Common.Utils.getOffset(t.$window),o=new DE.Views.RoleDeleteDlg({props:{roles:this.rolesList.store,excludeName:i.get("name")},handler:function(t,e){"ok"==t&&e&&n(e)}}).on("close",(function(){t.show(),setTimeout((function(){t.getDefaultFocusableComponent().focus()}),100)}));t.hide(),o.show(s.left+65,s.top+77)}}},getSettings:function(){},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},onSelectRoleItem:function(t,e,i){i&&(this.lastSelectedRole=void 0,this.updateMoveButtons())},onMoveClick:function(t){var e=this.rolesList.getSelectedRec();e&&(this.lastSelectedRole=e.get("name"),t?this.oformManager.asc_moveUpRole(e.get("name")):this.oformManager.asc_moveDownRole(e.get("name")))},updateButtons:function(){this.btnEditRole.setDisabled(this.rolesList.store.length<1),this.btnDeleteRole.setDisabled(this.rolesList.store.length<1),this.updateMoveButtons(),this.rolesList.scroller&&this.rolesList.scroller.update()},updateMoveButtons:function(){var t=this.rolesList.getSelectedRec(),e=t?this.rolesList.store.indexOf(t):-1;this.btnUp.setDisabled(e<1),this.btnDown.setDisabled(e<0||e==this.rolesList.store.length-1)},hide:function(){Common.UI.Window.prototype.hide.call(this)},close:function(){this.api.asc_unregisterCallback("asc_onUpdateOFormRoles",this.wrapEvents.onRefreshRolesList),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRole.isDisabled()||this.onDeleteRole()},onDblClickItem:function(t,e,i){this.btnEditRole.isDisabled()||this.onEditRole(!0)},txtTitle:"Manage Roles",textNew:"New",textEdit:"Edit",textDelete:"Delete",textEmpty:"No roles have been created yet.<br>Create at least one role and it will appear in this field.",warnDelete:"Are you sure you want to delete the role {0}?",warnCantDelete:"You cannot delete this role because it has associated fields.",textUp:"Move role up",textDown:"Move role down",textDescription:"Add roles and set the order in which the fillers receive and sign the document",textAnyone:"Anyone",textDeleteLast:"Are you sure you want to delete the role {0}?<br>Once deleted, the default role will be created."},DE.Views.RolesManagerDlg||{}))})),define("documenteditor/main/app/view/SaveFormDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views=DE.Views||{},DE.Views.SaveFormDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"SaveFormDlg",contentWidth:320,separator:!1},initialize:function(t){_.extend(this.options,{title:this.txtTitle,buttons:[{value:"ok",caption:this.saveButtonText},"cancel"],contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table style="width: 100%;">',"<tr>",'<td class="padding-small">',"<label>"+this.textDescription+"</label>","</td>","</tr>","<tr>","<td>","<label>"+this.textFill+"</label>","</td>","</tr>","<tr>","<td>",'<div id="save-form-roles-list" class="roles-tableview no-borders" style="width:300px; height: 116px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""))({scope:this})},t),this.handler=t.handler,this.roles=t.roles,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rolesList=new Common.UI.ListView({el:$("#save-form-roles-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,handleSelect:!1,enableKeyEvents:!1,showLast:!1,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="border-color: transparent;">','<div class="listitem-icon" style="flex-shrink: 0;"><svg class=""><use xlink:href="#svg-icon-<%= scope.getIconCls(index) %>"></use></svg></div>','<div class="padding-right-5" style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>"].join(""))}),this.afterRender()},getFocusedComponents:function(){return this.getFooterButtons()},getDefaultFocusableComponent:function(){return _.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))},afterRender:function(){this.refreshRolesList(this.roles)},refreshRolesList:function(t,e){if(t){this.roles=t;for(var i=[],n=0;n<this.roles.length;n++){var s=t[n].asc_getSettings(),o=s.asc_getFieldCount();o>0&&i.push({name:s.asc_getName()||this.textAnyone,color:s.asc_getColor(),fields:o,index:i.length,scope:this})}this.rolesList.store.reset(i)}},getIconCls:function(t){return 1===this.rolesList.store.length?"Point":0===t?"StartPoint":t===this.rolesList.store.length-1?"EndPoint":"MiddlePoint"},txtTitle:"Save as Form",saveButtonText:"Save",textEmpty:"There are no roles associated with fields.",textDescription:"When saving to the pdf, only roles with fields are added to the filling list",textFill:"Filling list",textAnyone:"Anyone"},DE.Views.SaveFormDlg||{}))})),define("documenteditor/main/app/view/CaptionDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views.CaptionDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:351,separator:!1,id:"window-caption"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="4" style="width: auto;">',"<tr>",'<td colspan="3" class="padding-small">','<label class="input-label">',e.textCaption,"</label>",'<div id="caption-txt-caption" class="margin-right-10"></div>',"</td>",'<td class="padding-small">','<label class="input-label">',e.textInsert,"</label>",'<div id="caption-combo-position" class="input-group-nr" style="width:75px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small">','<label class="input-label">',e.textLabel,"</label>",'<div id="caption-combo-label" class="input-group-nr margin-right-10" style="width:160px;"></div>',"</td>",'<td class="padding-small" style="vertical-align: bottom;">','<button type="button" result="add" class="btn btn-text-default margin-right-10" id="caption-btn-add">',e.textAdd,"</button>","</td>",'<td class="padding-small" style="vertical-align: bottom;">','<button type="button" result="add" class="btn btn-text-default" id="caption-btn-delete">',e.textDelete,"</button>","</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<div id="caption-checkbox-exclude"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="input-label" >',e.textNumbering,"</label>",'<div id="caption-combo-numbering" class="input-group-nr" style="width:160px;"></div>',"</td>",'<td class="padding-large">',"</td>",'<td class="padding-large">',"</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<div id="caption-checkbox-chapter"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small">','<label class="input-label">',e.textChapter,"</label>",'<div id="caption-combo-chapter" class="input-group-nr margin-right-10" style="width:160px;"></div>',"</td>",'<td colspan="2" class="padding-small">','<label class="input-label" >',e.textSeparator,"</label>",'<div id="caption-combo-separator" class="input-group-nr" style="width:160px;"></div>',"</td>","</tr>","<tr>",'<td colspan="4" class="padding-small">','<label class="input-label" id="caption-label-example">',e.textExamples,"</label>","</td>","</tr>","</table>","</div>","</div>"].join(""))({scope:this})},t),this.objectType=t.objectType,this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtCaption=new Common.UI.InputField({el:$("#caption-txt-caption"),allowBlank:!1,value:""});var e=this.txtCaption.$el.find("input");e.on("mouseup",_.bind(this.checkStartPosition,this,"mouse")),e.on("keydown",_.bind(this.checkStartPosition,this,"key")),this.cmbPosition=new Common.UI.ComboBox({el:$("#caption-combo-position"),cls:"input-group-nr",menuStyle:"min-width: 75px;",editable:!1,disabled:void 0===this.objectType,takeFocusOnClose:!0,data:[{displayValue:this.textBefore,value:1},{displayValue:this.textAfter,value:0}]}),this.cmbPosition.setValue(Common.Utils.InternalSettings.get("de-settings-label-position")||0),this.cmbPosition.on("selected",(function(e,i){t.props.put_Before(!!i.value)}));var i=Common.Utils.InternalSettings.get("de-settings-captions");null!=i&&null!=i||(i=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",i)),i=i?JSON.parse(i):[],this.arrLabel=i.concat([{displayValue:this.textEquation,value:this.textEquation,type:0},{displayValue:this.textFigure,value:this.textFigure,type:0},{displayValue:this.textTable,value:this.textTable,type:0}]),this.cmbLabel=new Common.UI.ComboBox({el:$("#caption-combo-label"),cls:"input-group-nr",menuStyle:"min-width: 160px;max-height:155px;",editable:!1,takeFocusOnClose:!0,data:this.arrLabel,alwaysVisibleY:!0}),this.cmbLabel.on("selected",(function(e,i){var n=i.value;t.props.put_Label(n),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name());var s=1==i.type;t.btnDelete.setDisabled(!s),t.currentLabel=n,t.positionCaption=t.txtCaption.getValue().length}));var n,s,o=Common.Utils.InternalSettings.get("de-settings-current-label");if(o&&(s=_.findIndex(this.arrLabel,(function(t){return t.value===o}))),o&&-1!==s)n=this.cmbLabel.store.at(s);else{var a=this.arrLabel.length-1;this.objectType===Asc.c_oAscTypeSelectElement.Math?a=this.arrLabel.length-3:this.objectType===Asc.c_oAscTypeSelectElement.Image&&(a=this.arrLabel.length-2),n=this.cmbLabel.store.at(a)}this.cmbLabel.selectRecord(n),this.btnAdd=new Common.UI.Button({el:$("#caption-btn-add")}),this.btnAdd.on("click",_.bind((function(t){var e=this;new Common.Views.TextInputDialog({label:e.textLabel,inputConfig:{allowBlank:!1,blankError:e.textLabelError,validation:function(t){return!!t||""}},handler:function(t,i){if("ok"==t)if(n=_.findWhere(e.arrLabel,{value:i}))e.cmbLabel.setValue(i),e.cmbLabel.trigger("selected",e.cmbLabel,n);else{var n={displayValue:i,value:i,type:1};e.arrLabel.unshift(n),e.cmbLabel.setData(e.arrLabel),e.cmbLabel.setValue(i),e.cmbLabel.trigger("selected",e.cmbLabel,n),e.cmbLabel.scroller.update({alwaysVisibleY:!0})}}}).on("close",(function(){e.cmbLabel.focus()})).show()}),this)),this.btnDelete=new Common.UI.Button({el:$("#caption-btn-delete"),disabled:!0}),this.btnDelete.on("click",_.bind((function(t){var e=this.cmbLabel.getValue();this.arrLabel=_.reject(this.arrLabel,(function(t){return t.value===e})),this.cmbLabel.setData(this.arrLabel),this.cmbLabel.setValue(this.arrLabel[0].value),this.cmbLabel.trigger("selected",this.cmbLabel,this.arrLabel[0]),this.cmbLabel.focus()}),this)),this.chExclude=new Common.UI.CheckBox({el:$("#caption-checkbox-exclude"),labelText:this.textExclude}),this.chExclude.on("change",(function(e,i,n){t.props.put_ExcludeLabel("checked"==i),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name()),t.positionCaption=t.txtCaption.getValue().length})),this.chExclude.setValue(!!Common.Utils.InternalSettings.get("de-settings-label-exclude"),!0),this.cmbNumbering=new Common.UI.ComboBox({el:$("#caption-combo-numbering"),cls:"input-group-nr",menuStyle:"min-width: 160px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal,maskExp:/[0-9]/,defValue:1},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter,maskExp:/[a-z]/,defValue:"a"},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter,maskExp:/[A-Z]/,defValue:"A"},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman,maskExp:/[ivxlcdm]/,defValue:"i"},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman,maskExp:/[IVXLCDM]/,defValue:"I"}]});var l=Common.Utils.InternalSettings.get("de-settings-label-numbering");null==l&&(l=Asc.c_oAscNumberingFormat.Decimal),this.cmbNumbering.setValue(l),this.cmbNumbering.on("selected",(function(e,i){t.props.put_Format(i.value),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name())})),this.chChapter=new Common.UI.CheckBox({el:$("#caption-checkbox-chapter"),labelText:this.textChapterInc}),this.chChapter.on("change",(function(e,i,n){t.props.put_IncludeChapterNumber("checked"==i),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name()),t.positionCaption=t.txtCaption.getValue().length,t.cmbChapter.setDisabled("checked"!==i),t.cmbSeparator.setDisabled("checked"!==i)})),this.chChapter.setValue(!!Common.Utils.InternalSettings.get("de-settings-label-chapter-include"),!0);var r=DE.getController("Main");this._arrLevel=[];for(var c=0;c<9;c++)this._arrLevel.push({displayValue:r["txtStyle_Heading_"+(c+1)],value:c});this.cmbChapter=new Common.UI.ComboBox({el:$("#caption-combo-chapter"),cls:"input-group-nr",menuStyle:"min-width: 160px;max-height:135px;",editable:!1,takeFocusOnClose:!0,disabled:!0,data:this._arrLevel}),this.cmbChapter.setValue(Common.Utils.InternalSettings.get("de-settings-label-chapter")||0),this.cmbChapter.on("selected",(function(e,i){t.props.put_HeadingLvl(i.value),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name())})),this.cmbSeparator=new Common.UI.ComboBox({el:$("#caption-combo-separator"),cls:"input-group-nr",menuStyle:"min-width: 160px;",editable:!1,takeFocusOnClose:!0,disabled:!0,data:[{displayValue:"-     ("+this.textHyphen+")",value:"-"},{displayValue:".     ("+this.textPeriod+")",value:"."},{displayValue:":     ("+this.textColon+")",value:":"},{displayValue:"  ("+this.textLongDash+")",value:""},{displayValue:"    ("+this.textDash+")",value:""}]}),this.cmbSeparator.setValue(Common.Utils.InternalSettings.get("de-settings-label-separator")||"-"),this.cmbSeparator.on("selected",(function(e,i){t.props.put_Separator(i.value),t.props.updateName(),t.txtCaption.setValue(t.props.get_Name())})),this.lblExample=this.$window.find("#caption-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.txtCaption,this.cmbPosition,this.cmbLabel,this.btnAdd,this.btnDelete,this.chExclude,this.cmbNumbering,this.chChapter,this.cmbChapter,this.cmbSeparator].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.txtCaption},afterRender:function(){this._setDefaults(this.props)},close:function(){var t=_.where(this.arrLabel,{type:1}),e=JSON.stringify(t);Common.localStorage.setItem("de-settings-captions",e),Common.Utils.InternalSettings.set("de-settings-captions",e),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){this.props=new Asc.CAscCaptionProperties,this.props.put_Before(!!this.cmbPosition.getValue());var e=this.cmbLabel.getValue();this.props.put_Label(e);var i=this.cmbLabel.getSelectedRecord();this.btnDelete.setDisabled(!i||0==i.type),this.props.put_ExcludeLabel("checked"==this.chExclude.getValue()),this.props.put_Format(this.cmbNumbering.getValue()),this.props.put_IncludeChapterNumber("checked"==this.chChapter.getValue()),this.props.put_HeadingLvl(this.cmbChapter.getValue()),this.props.put_Separator(this.cmbSeparator.getValue()),this.props.updateName(),this.txtCaption.setValue(this.props.get_Name()),this.currentLabel=e,this.positionCaption=this.txtCaption.getValue().length,this.cmbChapter.setDisabled("checked"!==this.chChapter.getValue()),this.cmbSeparator.setDisabled("checked"!==this.chChapter.getValue())},getSettings:function(){return this.props.put_Additional(this.txtCaption.getValue().substr(this.positionCaption)),this.props},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),"ok"==t&&(Common.Utils.InternalSettings.set("de-settings-current-label",this.cmbLabel.getValue()),Common.Utils.InternalSettings.set("de-settings-label-position",this.cmbPosition.getValue()),Common.Utils.InternalSettings.set("de-settings-label-exclude","checked"==this.chExclude.getValue()),Common.Utils.InternalSettings.set("de-settings-label-numbering",this.cmbNumbering.getValue()),Common.Utils.InternalSettings.set("de-settings-label-chapter-include","checked"==this.chChapter.getValue()),Common.Utils.InternalSettings.set("de-settings-label-chapter",this.cmbChapter.getValue()),Common.Utils.InternalSettings.set("de-settings-label-separator",this.cmbSeparator.getValue())),this.close()},checkStartPosition:function(t,e){var i=this,n=e.key;"mouse"===t||"ArrowLeft"===n||"ArrowDown"===n?setTimeout((function(){e.target.selectionStart<i.positionCaption+1&&(e.target.selectionStart=i.positionCaption)}),0):"ArrowUp"===n||"Home"===n?setTimeout((function(){e.target.selectionStart=i.positionCaption}),0):e.target.selectionStart!==e.target.selectionEnd&&"ArrowRight"===n?e.target.selectionEnd>i.positionCaption?setTimeout((function(){e.target.selectionStart=e.target.selectionEnd}),0):setTimeout((function(){e.target.selectionStart=i.positionCaption}),0):"Backspace"===n?(e.target.selectionStart===e.target.selectionEnd&&e.target.selectionStart<i.positionCaption+1||e.target.selectionStart<i.positionCaption)&&e.preventDefault():"Delete"===n?e.target.selectionStart<i.positionCaption&&e.preventDefault():"End"!==n&&e.target.selectionStart!==e.target.selectionEnd&&0===e.target.selectionStart&&e.preventDefault()},textTitle:"Insert Caption",textCaption:"Caption",textInsert:"Insert",textLabel:"Label",textAdd:"Add label",textDelete:"Delete label",textNumbering:"Numbering",textChapterInc:"Include chapter number",textChapter:"Chapter starts with style",textSeparator:"Use separator",textExamples:"Examples: Table 2-A, Image 1.IV",textBefore:"Before",textAfter:"After",textHyphen:"hyphen",textPeriod:"period",textColon:"colon",textLongDash:"long dash",textDash:"dash",textEquation:"Equation",textFigure:"Figure",textTable:"Table",textExclude:"Exclude label from caption",textLabelError:"Label must not be empty."},DE.Views.CaptionDialog||{}))})),define("documenteditor/main/app/view/NoteSettingsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views.NoteSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,id:"window-note-settings",separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,buttons:[{value:"insert",caption:this.textInsert},{value:"apply",caption:this.textApply,id:"note-settings-btn-apply"},"cancel"],primary:"insert",contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',e.textLocation,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="note-settings-radio-foot" style="margin-top: 4px;display: inline-block"></div>','<div id="note-settings-combo-footnote" class="input-group-nr float-right" style="display: inline-block; width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="note-settings-radio-end" style="margin-top: 4px;display: inline-block"></div>','<div id="note-settings-combo-endnote" class="input-group-nr float-right" style="display: inline-block; width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textFormat,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div class="margin-right-10" style="display: inline-block; vertical-align: middle;">','<label class="input-label">',e.textNumFormat,"</label>",'<div id="note-settings-combo-format" class="input-group-nr" style="width:150px;"></div>',"</div>",'<div style="display: inline-block; vertical-align: middle;">','<label class="input-label">',e.textStart,"</label>",'<div id="note-settings-spin-start"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',e.textNumbering,"</label>",'<div id="note-settings-combo-numbering" class="input-group-nr" style="width:150px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="input-label">',e.textCustom,"</label>",'<div id="note-settings-txt-custom"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textApplyTo,"</label>",'<div id="note-settings-combo-apply" class="input-group-nr" style="width:150px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.isEndNote=t.isEndNote||!1,this.hasSections=t.hasSections||!1,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={footnote:{numbering:Asc.c_oAscFootnoteRestart.Continuous,format:Asc.c_oAscNumberingFormat.Decimal,start:1},endnote:{numbering:Asc.c_oAscFootnoteRestart.Continuous,format:Asc.c_oAscNumberingFormat.LowerRoman,start:1}}},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.radioFootnote=new Common.UI.RadioBox({el:$("#note-settings-radio-foot"),name:"asc-radio-notes",labelText:this.textFootnote,checked:!0}),this.radioFootnote.on("change",(function(e,i,n){i&&(t.changeNoteType(!1),setTimeout((function(){t.cmbFootnote.focus()}),1))})),this.radioEndnote=new Common.UI.RadioBox({el:$("#note-settings-radio-end"),labelText:this.textEndnote,name:"asc-radio-notes"}),this.radioEndnote.on("change",(function(e,i,n){i&&(t.changeNoteType(!0),setTimeout((function(){t.cmbEndnote.focus()}),1))})),this.cmbFootnote=new Common.UI.ComboBox({el:$("#note-settings-combo-footnote"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textPageBottom,value:Asc.c_oAscFootnotePos.PageBottom},{displayValue:this.textTextBottom,value:Asc.c_oAscFootnotePos.BeneathText}]}),this.cmbFootnote.setValue(Asc.c_oAscFootnotePos.PageBottom),this.cmbEndnote=new Common.UI.ComboBox({el:$("#note-settings-combo-endnote"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textSectEnd,value:Asc.c_oAscEndnotePos.SectEnd},{displayValue:this.textDocEnd,value:Asc.c_oAscEndnotePos.DocEnd}]}),this.cmbEndnote.setValue(Asc.c_oAscEndnotePos.DocEnd),this.cmbFormat=new Common.UI.ComboBox({el:$("#note-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal,maskExp:/[0-9]/,defValue:1},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter,maskExp:/[a-z]/,defValue:"a"},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter,maskExp:/[A-Z]/,defValue:"A"},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman,maskExp:/[ivxlcdm]/,defValue:"i"},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman,maskExp:/[IVXLCDM]/,defValue:"I"}]}),this.cmbFormat.setValue(this._state.footnote.format),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.spnStart=new Common.UI.CustomSpinner({el:$("#note-settings-spin-start"),step:1,width:85,defaultUnit:"",value:1,maxValue:16383,minValue:1,allowDecimal:!1,maskExp:/[0-9]/}),this.spnStart.on("change",(function(e,i,n,s){e.getNumberValue()>1&&t.cmbNumbering.getValue()!==Asc.c_oAscFootnoteRestart.Continuous&&t.cmbNumbering.setValue(Asc.c_oAscFootnoteRestart.Continuous)})),this._arrNumbering=[{displayValue:this.textContinue,value:Asc.c_oAscFootnoteRestart.Continuous},{displayValue:this.textEachSection,value:Asc.c_oAscFootnoteRestart.EachSect},{displayValue:this.textEachPage,value:Asc.c_oAscFootnoteRestart.EachPage}],this.cmbNumbering=new Common.UI.ComboBox({el:$("#note-settings-combo-numbering"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:this._arrNumbering}),this.cmbNumbering.setValue(Asc.c_oAscFootnoteRestart.Continuous),this.cmbNumbering.on("selected",(function(e,i){i.value!=Asc.c_oAscFootnoteRestart.EachSect&&i.value!=Asc.c_oAscFootnoteRestart.EachPage||t.spnStart.setValue(1,!0)})),this.txtCustom=new Common.UI.InputField({el:$("#note-settings-txt-custom"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,style:"width: 85px; vertical-align: middle;",value:""}).on("changing",(function(e,i){t.cmbFormat.setDisabled(i.length>0),t.spnStart.setDisabled(i.length>0),t.btnApply.setDisabled(i.length>0)}));var e=this.hasSections?[{displayValue:this.textSection,value:0}]:[];e.push({displayValue:this.textDocument,value:1}),this.cmbApply=new Common.UI.ComboBox({el:$("#note-settings-combo-apply"),cls:"input-group-nr",menuStyle:"min-width: 150px;",editable:!1,takeFocusOnClose:!0,data:e}),this.cmbApply.setValue(e[0].value),this.btnApply=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find("#note-settings-btn-apply").addBack().filter("#note-settings-btn-apply").length>0}))||new Common.UI.Button({el:$("#note-settings-btn-apply")}),this.afterRender()},getFocusedComponents:function(){return[this.radioFootnote,this.cmbFootnote,this.radioEndnote,this.cmbEndnote,this.cmbFormat,this.spnStart,this.cmbNumbering,this.txtCustom,this.cmbApply].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){if(this.isEndNote?this.radioEndnote.setValue(!0,!0):this.radioFootnote.setValue(!0,!0),this.changeNoteType(this.isEndNote),t){var e=t.get_Pos();this.isEndNote?this.cmbEndnote.setValue(e):this.cmbFootnote.setValue(e),e=t.get_NumFormat(),this.cmbFormat.setValue(e),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord()),e=t.get_NumStart(),this.spnStart.setValue(e),e=t.get_NumRestart(),this.cmbNumbering.setValue(e)}},getSettings:function(){var t=new Asc.CAscFootnotePr;t.put_Pos(this.isEndNote?this.cmbEndnote.getValue():this.cmbFootnote.getValue()),t.put_NumRestart(this.cmbNumbering.getValue());var e=this.txtCustom.getValue();return _.isEmpty(e)&&(e=this.cmbFormat.getValue(),t.put_NumFormat(e),t.put_NumStart(this.spnStart.getNumberValue())),{props:t,applyToAll:1==this.cmbApply.getValue(),custom:_.isEmpty(e)?void 0:e,isEndNote:this.isEndNote}},onDlgBtnClick:function(t){this._handleInput("object"==typeof t?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("insert"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"insert"==t||"apply"==t?this.getSettings():void 0),this.close()},onFormatSelect:function(t,e){if(e){this.spnStart.setMask(e.maskExp);var i=this;switch(e.value){case Asc.c_oAscNumberingFormat.UpperRoman:this.spnStart.options.toCustomFormat=this._10toRome,this.spnStart.options.fromCustomFormat=this._Rometo10;break;case Asc.c_oAscNumberingFormat.LowerRoman:this.spnStart.options.toCustomFormat=function(t){return i._10toRome(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Rometo10(t.toLocaleUpperCase())};break;case Asc.c_oAscNumberingFormat.UpperLetter:this.spnStart.options.toCustomFormat=this._10toS,this.spnStart.options.fromCustomFormat=this._Sto10;break;case Asc.c_oAscNumberingFormat.LowerLetter:this.spnStart.options.toCustomFormat=function(t){return i._10toS(t).toLocaleLowerCase()},this.spnStart.options.fromCustomFormat=function(t){return i._Sto10(t.toLocaleUpperCase())};break;default:this.spnStart.options.toCustomFormat=function(t){return t},this.spnStart.options.fromCustomFormat=function(t){return t}}this.spnStart.setValue(this.spnStart.getValue()),this._state[this.isEndNote?"endnote":"footnote"].format=e.value}},_10toS:function(t){t=parseInt(t);for(var e=Math.ceil(t/26),i=String.fromCharCode((t-1)%26+"A".charCodeAt(0)),n="",s=0;s<e;s++)n+=i;return n},_Sto10:function(t){if(t.length<1||new RegExp("[^"+t.charAt(0)+"]").test(t)||!/[A-Z]/.test(t))return 1;var e=t.length-1,i=t.charCodeAt(0)-"A".charCodeAt(0)+1;return i+=26*e},_10toRome:function(t){t=parseInt(t);for(var e="",i=[["M",1e3],["CM",900],["D",500],["CD",400],["C",100],["XC",90],["L",50],["XL",40],["X",10],["IX",9],["V",5],["IV",4],["I",1]],n=i[0][1],s=Math.floor(t/n),o=0,a=0;a<s;a++)e+=i[o][0];for(t-=s*n,o++;t>0;)(s=t-(n=i[o][1]))>=0?(e+=i[o][0],t=s):o++;return e},_Rometo10:function(t){if(!/[IVXLCDM]/.test(t)||t.length<1)return 1;for(var e={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},i=t.length-1,n=e[t.charAt(i)],s=n,o=i-1;o>=0;o--){var a=e[t.charAt(o)];if(a<s){if(s/a>10)return 1;a*=-1}n+=a,s=Math.abs(a)}return n},changeNoteType:function(t){this._state[this.isEndNote?"endnote":"footnote"].start=this.spnStart.getNumberValue(),this._state[this.isEndNote?"endnote":"footnote"].numbering=this.cmbNumbering.getValue(),this.isEndNote=t,this.cmbFootnote.setDisabled(t),this.cmbEndnote.setDisabled(!t);var e=this._state[t?"endnote":"footnote"],i=t?this._arrNumbering.slice(0,2):this._arrNumbering;this.cmbNumbering.setData(i),this.cmbNumbering.setValue(e.numbering),this.cmbFormat.setValue(e.format),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord()),this.spnStart.setValue(e.start)},textTitle:"Notes Settings",textLocation:"Location",textFootnote:"Footnote",textPageBottom:"Bottom of page",textTextBottom:"Below text",textFormat:"Format",textNumFormat:"Number Format",textStart:"Start at",textNumbering:"Numbering",textContinue:"Continuous",textEachPage:"Restart each page",textEachSection:"Restart each section",textApplyTo:"Apply changes to",textDocument:"Whole document",textSection:"Current section",textApply:"Apply",textInsert:"Insert",textCustom:"Custom Mark",textSectEnd:"End of section",textDocEnd:"End of document",textEndnote:"Endnote"},DE.Views.NoteSettingsDialog||{}))})),void 0===Common)Common={};var c_oHyperlinkType={InternalLink:0,WebLink:1};if(define("documenteditor/main/app/view/HyperlinkSettingsDialog",[],(function(){"use strict";DE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 330px;">','<div style="margin-bottom: 10px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternal,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternal,"</button>","</div>",'<div id="id-external-link">','<div class="input-row">',"<label>"+this.textUrl+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row" style="margin-bottom: 4px;"></div>',"</div>",'<div id="id-internal-link">','<div class="input-row">',"<label>"+this.textUrl+"</label>","</div>",'<div id="id-dlg-hyperlink-list" style="width:100%; height: 171px;"></div>',"</div>",'<div class="input-row">',"<label>"+this.textDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row" style="margin-bottom: 4px;"></div>','<div class="input-row">',"<label>"+this.textTooltip+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row" style="margin-bottom: 4px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this._originalProps=null,this.urlType=AscCommon.c_oAscUrlType.Invalid,this.appOptions=this.options.appOptions,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),t.btnExternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.WebLink)),t.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),t.btnInternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.InternalLink)),Common.UI.GroupedButtons([t.btnExternal,t.btnInternal]);var i={el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,iconCls:"toolbar__icon btn-browse",placeHolder:t.appOptions.isDesktopApp?t.txtUrlPlaceholder:"",btnHint:t.textSelectFile,validation:function(e){var i=$.trim(e);return i.length>2083?t.txtSizeLimit:(t.urlType=t.api.asc_getUrlType(i),t.urlType!==AscCommon.c_oAscUrlType.Invalid||t.txtNotUrl)},ariaLabel:t.textUrl};t.inputUrl=t.appOptions.isDesktopApp?new Common.UI.InputFieldBtn(i):new Common.UI.InputField(i),t.inputUrl._input.on("input",(function(e){t.isInputFirstChange&&t.inputUrl.showError(),t.isInputFirstChange=!1;var i=$(e.target).val();t.isAutoUpdate&&(t.inputDisplay.setValue(i),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(i))})),t.appOptions.isDesktopApp&&t.inputUrl.on("button:click",_.bind(t.onSelectFile,t)),t.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;",ariaLabel:t.textDisplay}).on("changed:after",(function(){t.isTextChanged=!0})),t.inputDisplay._input.on("input",(function(e){t.isAutoUpdate=""==$(e.target).val()})),t.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength,ariaLabel:t.textTooltip}),t.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,enableKeyEvents:!0,tabindex:1}),t.internalList.on("item:select",_.bind(this.onSelectItem,this)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.internalList.on("entervalue",_.bind(t.onPrimary,t)),t.externalPanel=e.find("#id-external-link"),t.internalPanel=e.find("#id-internal-link")},getFocusedComponents:function(){return[this.btnExternal,this.btnInternal,this.inputUrl,this.internalList,this.inputDisplay,this.inputTip].concat(this.getFooterButtons())},ShowHideElem:function(t){this.externalPanel.toggleClass("hidden",t!==c_oHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==c_oHyperlinkType.InternalLink);var e=this.internalList.store;if(t==c_oHyperlinkType.InternalLink){if(e.length<1){var i=this.api.asc_GetHyperlinkAnchors(),n=i.length,s=0,o=0,a=[];a.push(new Common.UI.TreeViewModel({name:this.txtBeginning,level:0,index:0,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1})),a.push(new Common.UI.TreeViewModel({name:this.txtHeadings,level:0,index:1,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,type:Asc.c_oAscHyperlinkAnchor.Heading,hasSubItems:!1}));for(var l=0;l<n;l++){var r=i[l],c=i[l].asc_GetHeadingLevel()+1,d=!0;r.asc_GetType()==Asc.c_oAscHyperlinkAnchor.Heading&&(c>s&&a[a.length-1].set("hasSubItems",!0),c<=o&&(o=c,d=!1),a.push(new Common.UI.TreeViewModel({name:r.asc_GetHeadingText(),level:c,index:l+2,hasParent:d,type:Asc.c_oAscHyperlinkAnchor.Heading,headingParagraph:r.asc_GetHeadingParagraph()})),s=c)}a.push(new Common.UI.TreeViewModel({name:this.txtBookmarks,level:0,index:a.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,type:Asc.c_oAscHyperlinkAnchor.Bookmark,hasSubItems:!1})),s=0;for(l=0;l<n;l++){d=!0;(r=i[l]).asc_GetType()==Asc.c_oAscHyperlinkAnchor.Bookmark&&(s<1&&a[a.length-1].set("hasSubItems",!0),a.push(new Common.UI.TreeViewModel({name:r.asc_GetBookmarkName(),level:1,index:a.length,hasParent:!1,type:Asc.c_oAscHyperlinkAnchor.Bookmark})),s=1)}e.reset(a),this.internalList.collapseAll()}var h=this.internalList.getSelectedRec();this.btnOk.setDisabled(!h||0==h.get("level")&&h.get("index")>0);var p=this;_.delay((function(){p.inputDisplay.focus()}),50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));p=this;_.delay((function(){p.inputUrl.focus()}),50)}},onLinkTypeClick:function(t,e,i){if(this.ShowHideElem(t),this.isAutoUpdate){if(t==c_oHyperlinkType.InternalLink){var n=this.internalList.getSelectedRec();this.inputDisplay.setValue(n&&(n.get("level")||0==n.get("index"))?n.get("name"):"")}else this.inputDisplay.setValue(this.inputUrl.getValue());this.isTextChanged=!0}},onSelectItem:function(t,e,i,n){this.btnOk.setDisabled(0==i.get("level")&&i.get("index")>0),this.isAutoUpdate&&(this.inputDisplay.setValue(i.get("level")||0==i.get("index")?i.get("name"):""),this.isTextChanged=!0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setSettings:function(t){if(t){var e=this,i=t.get_Bookmark(),n=(null===i||""==i)&&(t.get_Value()||!Common.Utils.InternalSettings.get("de-settings-link-type"))?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink;if(n==c_oHyperlinkType.WebLink?e.btnExternal.toggle(!0):e.btnInternal.toggle(!0),e.ShowHideElem(n),n==c_oHyperlinkType.WebLink)t.get_Value()?e.inputUrl.setValue(t.get_Value().replace(new RegExp(" ","g"),"%20")):e.inputUrl.setValue(""),this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));else{if(t.is_TopOfDocument())this.internalList.selectByIndex(0);else if(t.is_Heading()){(s=this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Heading,headingParagraph:t.get_Heading()}))&&(this.internalList.expandRecord(this.internalList.store.at(1)),this.internalList.scrollToRecord(this.internalList.selectRecord(s)))}else{(s=this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Bookmark,name:i}))&&(this.internalList.expandRecord(this.internalList.store.findWhere({type:Asc.c_oAscHyperlinkAnchor.Bookmark,level:0})),this.internalList.scrollToRecord(this.internalList.selectRecord(s)))}var s=this.internalList.getSelectedRec();this.btnOk.setDisabled(!s||0==s.get("level")&&s.get("index")>0)}null!==t.get_Text()?(e.inputDisplay.setValue(t.get_Text()),e.inputDisplay.setDisabled(!1),e.isAutoUpdate=""==e.inputDisplay.getValue()||n==c_oHyperlinkType.WebLink&&e.inputUrl.getValue()==e.inputDisplay.getValue()):(e.inputDisplay.setValue(this.textDefault),e.inputDisplay.setDisabled(!0)),this.isTextChanged=!1,e.inputTip.setValue(t.get_ToolTip()),e._originalProps=t}},getSettings:function(){var t=this,e=new Asc.CHyperlinkProperty,i="",n=this.btnExternal.isActive()?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink;if(n==c_oHyperlinkType.WebLink){var s=$.trim(t.inputUrl.getValue());t.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(s)||(s=(t.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+s),s=s.replace(new RegExp("%20","g")," "),e.put_Value(s),e.put_Bookmark(null),i=s}else{var o=this.internalList.getSelectedRec();if(o){e.put_Bookmark(o.get("name")),0==o.get("index")&&e.put_TopOfDocument();var a=o.get("headingParagraph");a&&e.put_Heading(a),i=o.get("name")}}return t.inputDisplay.isDisabled()||!t.isTextChanged&&!_.isEmpty(t.inputDisplay.getValue())?e.put_Text(null):((_.isEmpty(t.inputDisplay.getValue())||n==c_oHyperlinkType.WebLink&&t.isAutoUpdate)&&t.inputDisplay.setValue(i),e.put_Text(t.inputDisplay.getValue())),e.put_ToolTip(t.inputTip.getValue()),e.put_InternalHyperlink(t._originalProps.get_InternalHyperlink()),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(this.btnExternal.isActive()){if(!0!==this.inputUrl.checkValidate())return this.isInputFirstChange=!0,void this.inputUrl.focus()}else{var e=this.internalList.getSelectedRec();if(!e||0==e.get("level")&&e.get("index")>0)return}if(!0!==this.inputDisplay.checkValidate())return void this.inputDisplay.focus();!this._originalProps.get_Bookmark()&&!this._originalProps.get_Value()&&Common.Utils.InternalSettings.set("de-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()},onSelectFile:function(){var t=this;if(t.api){t.api.asc_getFilePath((function(e){e&&(t.inputUrl.setValue(e),!0!==t.inputUrl.checkValidate()&&(t.isInputFirstChange=!0),t.isAutoUpdate&&(t.inputDisplay.setValue(e),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(e)))}))}},textUrl:"Link to",textDisplay:"Display",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"',textTooltip:"ScreenTip text",textDefault:"Selected text",textTitle:"Hyperlink Settings",textExternal:"External Link",textInternal:"Place in Document",txtBeginning:"Beginning of document",txtHeadings:"Headings",txtBookmarks:"Bookmarks",txtSizeLimit:"This field is limited to 2083 characters",txtUrlPlaceholder:"Enter the web address or select a file",textSelectFile:"Select file"},DE.Views.HyperlinkSettingsDialog||{}))})),define("documenteditor/main/app/view/BookmarksDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views.BookmarksDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,buttons:["close"],separator:!1,id:"window-bookmarks"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,keydowncallback:function(t){if(e.appOptions&&e.appOptions.canMakeActionLink&&t.keyCode===Common.UI.Keys.ESC){var i=!1;return[e.copyDropdownUpper,e.copyDropdownLower].forEach((function(t){var e=t.box.parent();e.hasClass("open")&&(e.removeClass("open"),t.parentBtn.focus(),i=!0)})),i}},contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-extra-small">','<label class="input-label">',e.textBookmarkName,"</label>","</td>","</tr>","<tr>",'<td class="padding-large" style="display: flex;">','<div id="bookmarks-txt-name" class="margin-right-10" style="display:inline-block;vertical-align: top;flex-grow:1;"></div>','<div id="bookmarks-btn-add" style="display: inline-block; position: relative;"></div>','<div id="bookmarks-btn-add-copy-dropdown" class="form-control-size" style="display: inline-block; position: relative; vertical-align: top; width: 0px">','<button type="button" class="dropdown-toggle" data-toggle="dropdown" style="display: none"></button>',"</div>","</td>","</tr>","<tr>",'<td class="padding-extra-small">','<label class="header margin-right-10">',e.textSort,"</label>",'<div id="bookmarks-radio-name" class="margin-right-10"></div>','<div id="bookmarks-radio-location"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="bookmarks-list" style="width:100%; height: 139px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default margin-right-5" id="bookmarks-btn-goto">',e.textGoto,"</button>",'<div style="display: inline-block; position: relative;">','<button type="button" class="btn btn-text-default auto dropdown-toggle move-focus" id="bookmarks-btn-link" style="min-width: 75px;" data-toggle="dropdown">',e.textGetLink,"</button>","</div>",'<button type="button" class="btn btn-text-default float-right" id="bookmarks-btn-delete">',e.textDelete,"</button>","</td>","</tr>","<tr>","<td>",'<div id="bookmarks-checkbox-hidden"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.appOptions=t.appOptions,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtName=new Common.UI.InputField({el:$("#bookmarks-txt-name"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,value:"",maxLength:40,validation:function(e){var i=t.props.asc_CheckNewBookmarkName(e),n=t.props.asc_HaveBookmark(e);return t.btnAdd.setDisabled(!i&&!n),!!(i||_.isEmpty(e)||n)||t.txtInvalidName}}).on("changing",(function(e,i){var n=t.props.asc_HaveBookmark(i);if(n){var s=t.bookmarksList.store.findWhere({value:i});t.bookmarksList.selectRecord(s),t.bookmarksList.scrollToRecord(s)}else t.bookmarksList.deselectAll();t.btnGoto.setDisabled(!n),t.btnDelete.setDisabled(!n),t.btnGetLink.setDisabled(!n)})),this.radioName=new Common.UI.RadioBox({el:$("#bookmarks-radio-name"),labelText:this.textName,name:"asc-radio-bookmark-sort"}),this.radioName.on("change",_.bind(this.onRadioSort,this)),this.radioLocation=new Common.UI.RadioBox({el:$("#bookmarks-radio-location"),labelText:this.textLocation,name:"asc-radio-bookmark-sort"}),this.radioLocation.on("change",_.bind(this.onRadioSort,this)),Common.Utils.InternalSettings.get("de-bookmarks-sort-location")?this.radioLocation.setValue(!0,!0):this.radioName.setValue(!0,!0),this.bookmarksList=new Common.UI.ListView({el:$("#bookmarks-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.bookmarksList.store.comparator=function(e){return t.radioName.getValue()?e.get("value"):e.get("location")},this.bookmarksList.on("item:dblclick",_.bind(this.onDblClickBookmark,this)),this.bookmarksList.on("entervalue",_.bind(this.onPrimary,this)),this.bookmarksList.on("item:select",_.bind(this.onSelectBookmark,this)),this.btnAdd=new Common.UI.Button({parentEl:$("#bookmarks-btn-add"),disabled:!0,caption:this.textAdd,cls:this.appOptions.canMakeActionLink?"btn-text-split-default":"btn-text-default",split:this.appOptions.canMakeActionLink,menu:this.appOptions.canMakeActionLink,takeFocusOnClose:!0}),this.btnAdd.on("click",_.bind(this.addBookmark,this,!0)),this.appOptions.canMakeActionLink&&(this.btnAdd.setMenu(new Common.UI.Menu({menuAlign:"tr-br",style:"min-width: 150px;",items:[{caption:this.textAdd,value:1},{caption:this.textAddAndGetLink,value:2}]})),this.btnAdd.menu.on("item:click",_.bind(this.onAddMenu,this))),this.btnGoto=new Common.UI.Button({el:$("#bookmarks-btn-goto"),disabled:!0}),this.btnGoto.on("click",_.bind(this.gotoBookmark,this)),this.btnDelete=new Common.UI.Button({el:$("#bookmarks-btn-delete"),disabled:!0}),this.btnDelete.on("click",_.bind(this.deleteBookmark,this)),this.btnGetLink=new Common.UI.Button({el:$("#bookmarks-btn-link"),disabled:!0}),this.btnGetLink.on("click",_.bind(this.getBookmarkLink,this)),this.chHidden=new Common.UI.CheckBox({el:$("#bookmarks-checkbox-hidden"),labelText:this.textHidden,value:Common.Utils.InternalSettings.get("de-bookmarks-hidden")||!1}),this.chHidden.on("change",_.bind(this.onChangeHidden,this)),this.appOptions.canMakeActionLink&&(this.copyDropdownUpper=this.createCopyDropdown(this.btnAdd,$("#bookmarks-btn-add-copy-dropdown"),{right:0}),this.copyDropdownLower=this.createCopyDropdown(this.btnGetLink,this.btnGetLink.$el.parent(),{left:-80})),this.afterRender()},getFocusedComponents:function(){var t=[this.txtName,this.radioName,this.radioLocation,this.bookmarksList,this.btnAdd];return this.copyDropdownUpper&&(t=t.concat([this.copyDropdownUpper.input,this.copyDropdownUpper.button])),t=t.concat([this.btnAdd,this.btnGoto,this.btnGetLink,this.btnDelete,this.chHidden]),this.copyDropdownLower&&(t=t.concat([this.copyDropdownLower.input,this.copyDropdownLower.button])),t.concat(this.getFooterButtons())},afterRender:function(){this._setDefaults(this.props);var t=this,e=function(){var e=t.bookmarksList.getSelectedRec();t.refreshBookmarks(),e&&((e=t.bookmarksList.store.findWhere({value:e.get("value")}))?(t.bookmarksList.selectRecord(e),t.bookmarksList.scrollToRecord(e)):(t.txtName.setValue(""),t.btnAdd.setDisabled(!0),t.btnGoto.setDisabled(!0),t.btnDelete.setDisabled(!0),t.btnGetLink.setDisabled(!0)))};this.api.asc_registerCallback("asc_onBookmarksUpdate",e),this.on("close",(function(i){t.api.asc_unregisterCallback("asc_onBookmarksUpdate",e)}))},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this;_.delay((function(){$("input",t.txtName.cmpEl).select().focus()}),100)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),Common.Utils.InternalSettings.set("de-bookmarks-hidden","checked"==this.chHidden.getValue()),Common.Utils.InternalSettings.set("de-bookmarks-sort-location",this.radioLocation.getValue())},_setDefaults:function(t){this.refreshBookmarks(),this.btnGetLink.setVisible(this.appOptions.canMakeActionLink)},getSettings:function(){return{}},onDlgBtnClick:function(t){this.close()},onPrimary:function(){return!0},createCopyDropdown:function(t,e,i){var n=this,s="";i&&(s+="right: "+(null!=i.right?i.right+"px;":"auto;"),s+="left: "+(null!=i.left?i.left+"px;":"auto;"));var o=$('<div class="bookmark-copy-dropdown dropdown-menu" style="width: 291px; '+s+' padding: 10px;"><div class="bookmark-copy-dropdown-input display-inline-block-middle"></div><button class="bookmark-copy-dropdown-btn btn btn-text-default margin-left-5 display-inline-block-middle" style="width: 86px;">'+n.textCopy+"</button></div>");e.append(o),o.on("click",_.bind((function(){return!1}),this)),e.on({"shown.bs.dropdown":function(){_.delay((function(){a._input.select().focus()}),100)},"hide.bs.dropdown":function(){n.txtName._input.select().focus()}});var a=new Common.UI.InputField({el:e.find(".bookmark-copy-dropdown-input"),editable:!1,style:"width: 176px;"}),l=new Common.UI.Button({el:o.find("button")});return l.on("click",(function(){a._input.select(),document.execCommand("copy")})),Common.Gateway.on("setactionlink",(function(t){a.setValue(t)})),{parentBtn:t,box:o,input:a,button:l}},refreshBookmarks:function(){if(this.props){for(var t=this.bookmarksList.store,e=this.props.asc_GetCount(),i="checked"==this.chHidden.getValue(),n=[],s=0;s<e;s++){var o=this.props.asc_GetName(s);if(!this.props.asc_IsInternalUseBookmark(o)&&(i||!this.props.asc_IsHiddenBookmark(o))){var a=new Common.UI.DataViewModel;a.set({value:o,location:s}),n.push(a)}}t.reset(n,{silent:!1})}},onSelectBookmark:function(t,e,i){if(i){var n=i.get("value");this.txtName.setValue(n),this.btnAdd.setDisabled(!1),this.btnGoto.setDisabled(!1),this.btnDelete.setDisabled(!1),this.btnGetLink.setDisabled(!1)}},gotoBookmark:function(t,e){var i=this.bookmarksList.getSelectedRec();i?this.props.asc_SelectBookmark(i.get("value")):""!==this.txtName.getValue()&&this.props.asc_SelectBookmark(this.txtName.getValue())},addBookmark:function(t){this.props.asc_AddBookmark(this.txtName.getValue()),this.refreshBookmarks();var e=this.bookmarksList.store.findWhere({value:this.txtName.getValue()});this.bookmarksList.selectRecord(e),this.bookmarksList.scrollToRecord(e),this.txtName.focus(),t&&this.close()},onAddMenu:function(t,e){1==e.value?this.addBookmark(!0):2==e.value&&(this.addBookmark(),this.getBookmarkLink(this.btnAdd),setTimeout((function(){$("#bookmarks-btn-add-copy-dropdown button").click()}),5))},onDblClickBookmark:function(t,e,i){this.props.asc_SelectBookmark(i.get("value"))},deleteBookmark:function(t,e){var i=this.bookmarksList.getSelectedRec();if(i){this.props.asc_RemoveBookmark(i.get("value"));var n=this.bookmarksList.store;_.indexOf(n.models,i);n.remove(i),this.txtName.setValue(""),this.btnAdd.setDisabled(!0),this.btnGoto.setDisabled(!0),this.btnDelete.setDisabled(!0),this.btnGetLink.setDisabled(!0)}},getBookmarkLink:function(t){if(!t.cmpEl||!t.cmpEl.parent().hasClass("open")){var e=this.bookmarksList.getSelectedRec();e&&Common.Gateway.requestMakeActionLink({action:{type:"bookmark",data:e.get("value")}})}},onRadioSort:function(t,e,i){e&&(this.bookmarksList.store.sort(),this.bookmarksList.onResetItems())},onChangeHidden:function(t,e,i,n){this.refreshBookmarks()},textTitle:"Bookmarks",textLocation:"Location",textBookmarkName:"Bookmark name",textSort:"Sort by",textName:"Name",textAdd:"Add",textAddAndGetLink:"Add & Get Link",textGoto:"Go to",textDelete:"Delete",textClose:"Close",textHidden:"Hidden bookmarks",txtInvalidName:"Bookmark name can only contain letters, digits and underscores, and should begin with the letter",textGetLink:"Get Link",textCopy:"Copy"},DE.Views.BookmarksDialog||{}))})),define("documenteditor/main/app/view/NotesRemoveDialog",[],(function(){"use strict";DE.Views.NotesRemoveDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t),this.template=['<div class="box">','<div id="notes-remove-chk-foot" style="margin-bottom: 5px;"></div>','<div id="notes-remove-chk-end"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.chFootnote=new Common.UI.CheckBox({el:t.find("#notes-remove-chk-foot"),labelText:this.textFoot,value:!0}),this.chEndnote=new Common.UI.CheckBox({el:t.find("#notes-remove-chk-end"),labelText:this.textEnd,value:!0})},getFocusedComponents:function(){return[this.chFootnote,this.chEndnote].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chFootnote},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return{footnote:this.chFootnote.isChecked(),endnote:this.chEndnote.isChecked()}},onPrimary:function(){return this._handleInput("ok"),!1},textTitle:"Delete Notes",textFoot:"Delete All Footnotes",textEnd:"Delete All Endnotes"},DE.Views.NotesRemoveDialog||{}))})),define("documenteditor/main/app/view/CrossReferenceDialog",[],(function(){"use strict";DE.Views.CrossReferenceDialog=Common.UI.Window.extend(_.extend({options:{width:400,style:"min-width: 240px;",cls:"modal-dlg",modal:!1,id:"window-cross-ref"},initialize:function(t){_.extend(this.options,{title:this.txtTitle,buttons:[{value:"ok",caption:this.textInsert},"close"]},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-cross-type" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtReference+"</label>",'<div id="id-dlg-cross-ref" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<div id="id-dlg-cross-insert-as" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 7px;">','<div id="id-dlg-cross-below-above" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<div id="id-dlg-cross-separate" class="margin-right-10" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-cross-separator" style="display: inline-block;vertical-align: middle;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="width: 100%;">','<label id="id-dlg-cross-which">'+this.textWhich+"</label>",'<div id="id-dlg-cross-list" class="no-borders" style="width:368px; height:161px;margin-top: 2px; "></div>',"</td>","</tr>","</table>","</div>"].join(""),this.crossRefProps=t.crossRefProps,this.api=t.api,this.options.tpl=_.template(this.template)(this.options),this._locked=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var e=Common.Utils.InternalSettings.get("de-settings-captions");null!=e&&null!=e||(e=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",e)),(e=(e=e?JSON.parse(e):[]).concat([{value:5,displayValue:this.textEquation},{value:6,displayValue:this.textFigure},{value:7,displayValue:this.textTable}])).sort((function(t,e){var i=t.displayValue.toLowerCase(),n=e.displayValue.toLowerCase();return i>n?1:i<n?-1:0})),this.cmbType=new Common.UI.ComboBox({el:t.find("#id-dlg-cross-type"),menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textParagraph},{value:1,displayValue:this.textHeading},{value:2,displayValue:this.textBookmark},{value:3,displayValue:this.textFootnote},{value:4,displayValue:this.textEndnote}].concat(e)}),this.cmbType.on("selected",_.bind(this.onTypeSelected,this)),this.cmbReference=new Common.UI.ComboBox({el:t.find("#id-dlg-cross-ref"),menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,cls:"input-group-nr",data:[]}),this.cmbReference.on("selected",_.bind(this.onReferenceSelected,this)),this.chInsertAs=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-insert-as"),labelText:this.textInsertAs,value:!0}),this.chBelowAbove=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-below-above"),labelText:this.textIncludeAbove}),this.chSeparator=new Common.UI.CheckBox({el:t.find("#id-dlg-cross-separate"),labelText:this.textSeparate}).on("change",_.bind((function(t,e,i,n){var s="checked"===t.getValue();this.inputSeparator.setDisabled(!s)}),this)),this.inputSeparator=new Common.UI.InputField({el:t.findById("#id-dlg-cross-separator"),style:"width: 35px;",validateOnBlur:!1,disabled:!0}),this.refList=new Common.UI.ListView({el:t.find("#id-dlg-cross-list"),store:new Common.UI.DataViewStore,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.refList.on("entervalue",_.bind(this.onPrimary,this)).on("item:dblclick",_.bind(this.onPrimary,this)),this.lblWhich=t.find("#id-dlg-cross-which"),this.btnInsert=new Common.UI.Button({el:t.find(".primary"),disabled:!0}),this.afterRender()},afterRender:function(){this._setDefaults();var t=this,e=function(){t.refreshReferences(t.cmbType.getSelectedRecord(),!0)};this.api.asc_registerCallback("asc_onEndCalculate",e),this.on("close",(function(i){t.api.asc_unregisterCallback("asc_onEndCalculate",e)}))},_handleInput:function(t,e){if(this.options.handler&&this.options.handler.call(this,t),"ok"!=t)this.close();else{if(!e&&document.activeElement&&"textarea"==document.activeElement.localName&&/area_id/.test(document.activeElement.id))return;!this.btnInsert.isDisabled()&&this.insertReference()}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},getSettings:function(){return{type:this.cmbType.getValue(),refType:this.cmbReference.getValue()}},_setDefaults:function(){var t,e;this.crossRefProps&&(t=this.cmbType.store.findWhere({value:this.crossRefProps.type}))&&(e=this.crossRefProps.refType),t?this.cmbType.selectRecord(t):this.cmbType.setValue(0),this.refreshReferenceTypes(this.cmbType.getSelectedRecord(),e)},insertReference:function(){var t=this.refList.getSelectedRec(),e=this.cmbType.getSelectedRecord(),i=1==e.type||e.value>4?5:e.value,n=this.cmbReference.getValue(),s="checked"==this.chInsertAs.getValue(),o="checked"==this.chBelowAbove.getValue(),a="checked"==this.chSeparator.getValue()?this.inputSeparator.getValue():void 0;switch(i){case 0:case 1:this.api.asc_AddCrossRefToParagraph(t.get("para"),n,s,o,a);break;case 2:this.api.asc_AddCrossRefToBookmark(t.get("value"),n,s,o,a);break;case 3:case 4:this.api.asc_AddCrossRefToNote(t.get("para"),n,s,o);break;case 5:n==Asc.c_oAscDocumentRefenceToType.OnlyCaptionText&&!1===t.get("para").asc_canAddRefToCaptionText(e.displayValue)?Common.UI.warning({msg:this.textEmpty}):this.api.asc_AddCrossRefToCaption(e.displayValue,t.get("para"),n,s,o)}},onTypeSelected:function(t,e){this.refreshReferenceTypes(e)},refreshReferenceTypes:function(t,e){var i=[],n=this.textWhich;if(1==t.type||t.value>4)i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textCaption},{value:Asc.c_oAscDocumentRefenceToType.OnlyLabelAndNumber,displayValue:this.textLabelNum},{value:Asc.c_oAscDocumentRefenceToType.OnlyCaptionText,displayValue:this.textOnlyCaption},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}];else switch(t.value){case 0:i=[{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textParaNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textParaNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textParaNumFull},{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textText},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichPara;break;case 1:i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textHeadingText},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textHeadingNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textHeadingNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textHeadingNumFull},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichHeading;break;case 2:i=[{value:Asc.c_oAscDocumentRefenceToType.Text,displayValue:this.textBookmarkText},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNum,displayValue:this.textParaNum},{value:Asc.c_oAscDocumentRefenceToType.ParaNumNoContext,displayValue:this.textParaNumNo},{value:Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,displayValue:this.textParaNumFull},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow}],n=this.textWhichBookmark;break;case 3:i=[{value:Asc.c_oAscDocumentRefenceToType.NoteNumber,displayValue:this.textNoteNum},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow},{value:Asc.c_oAscDocumentRefenceToType.NoteNumberFormatted,displayValue:this.textNoteNumForm}],n=this.textWhichNote;break;case 4:i=[{value:Asc.c_oAscDocumentRefenceToType.NoteNumber,displayValue:this.textEndNoteNum},{value:Asc.c_oAscDocumentRefenceToType.PageNum,displayValue:this.textPageNum},{value:Asc.c_oAscDocumentRefenceToType.AboveBelow,displayValue:this.textAboveBelow},{value:Asc.c_oAscDocumentRefenceToType.NoteNumberFormatted,displayValue:this.textEndNoteNumForm}],n=this.textWhichEndnote}this.cmbReference.setData(i);var s=this.cmbReference.store.findWhere({value:e});this.cmbReference.setValue(s?e:i[0].value),this.onReferenceSelected(this.cmbReference,this.cmbReference.getSelectedRecord()),this.lblWhich.text(n),this.refreshReferences(t)},refreshReferences:function(t,e){if(t){var i,n=this.refList.store,s=1==t.type||t.value>4?5:t.value,o=[],a=n.length,l=_.indexOf(n.models,this.refList.getSelectedRec());switch(s){case 0:i=this.api.asc_GetAllNumberedParagraphs();break;case 1:i=this.api.asc_GetAllHeadingParagraphs();break;case 2:i=this.api.asc_GetBookmarksManager();break;case 3:i=this.api.asc_GetAllFootNoteParagraphs();break;case 4:i=this.api.asc_GetAllEndNoteParagraphs();break;case 5:i=this.api.asc_GetAllCaptionParagraphs(this.cmbType.getSelectedRecord().displayValue)}if(2==s)for(var r=i.asc_GetCount(),c=0;c<r;c++){var d=i.asc_GetName(c);i.asc_IsInternalUseBookmark(d)||i.asc_IsHiddenBookmark(d)||o.push({value:d})}else if(i)for(c=0;c<i.length;c++)o.push({value:i[c].asc_getText(),para:i[c]});if(n.reset(o),n.length>0){var h=e&&n.length==a&&l>=0&&l<n.length?n.at(l):n.at(0);this.refList.selectRecord(h),this.refList.scrollToRecord(h)}this.btnInsert.setDisabled(o.length<1||this._locked)}},onReferenceSelected:function(t,e){if(e){var i=e.value,n=this.cmbType.getSelectedRecord(),s=1==n.type||n.value>4?5:n.value,o=5==s&&i!==Asc.c_oAscDocumentRefenceToType.PageNum||s<5&&(i==Asc.c_oAscDocumentRefenceToType.Text||i==Asc.c_oAscDocumentRefenceToType.AboveBelow);this.chBelowAbove.setDisabled(o),o=!(0==s||2==s)||i!==Asc.c_oAscDocumentRefenceToType.ParaNumFullContex,this.chSeparator.setDisabled(o),this.inputSeparator.setDisabled(o||"checked"!==this.chSeparator.getValue())}},setLocked:function(t){this._locked=t,this.btnInsert.setDisabled(this.refList.store.length<1||this._locked)},txtTitle:"Cross-reference",txtType:"Reference type",txtReference:"Insert reference to",textInsertAs:"Insert as hyperlink",textSeparate:"Separate numbers with",textIncludeAbove:"Include above/below",textPageNum:"Page number",textParaNum:"Paragraph number",textParaNumNo:"Paragraph number (no context)",textParaNumFull:"Paragraph number (full context)",textText:"Paragraph text",textAboveBelow:"Above/below",textHeadingText:"Heading text",textHeadingNum:"Heading number",textHeadingNumNo:"Heading number (no context)",textHeadingNumFull:"Heading number (full context)",textBookmarkText:"Bookmark text",textNoteNum:"Footnote number",textNoteNumForm:"Footnote number (formatted)",textEndNoteNum:"Endnote number",textEndNoteNumForm:"Endnote number (formatted)",textCaption:"Entire caption",textLabelNum:"Only label and number",textOnlyCaption:"Only caption text",textParagraph:"Numbered item",textHeading:"Heading",textBookmark:"Bookmark",textFootnote:"Footnote",textEndnote:"Endnote",textEquation:"Equation",textFigure:"Figure",textTable:"Table",textInsert:"Insert",textWhich:"For which caption",textWhichHeading:"For which heading",textWhichBookmark:"For which bookmark",textWhichNote:"For which footnote",textWhichEndnote:"For which endnote",textWhichPara:"For which numbered item",textEmpty:"The request reference is empty."},DE.Views.CrossReferenceDialog||{}))})),define("documenteditor/main/app/view/TableOfContentsSettings",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";DE.Views.TableOfContentsSettings=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:500,contentHeight:375,id:"window-table-contents"},initialize:function(t){var e=this,i=t.type?300:375;_.extend(this.options,{title:t.type?this.textTitleTOF:this.textTitle,contentHeight:i,contentStyle:"padding: 15px 10px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-small">','<div id="tableofcontents-chb-pages"></div>',"</td>",'<td rowspan="5" class="padding-small" style="vertical-align: top;">','<div class="canvas-box float-right" style="width: 240px; height: 182px; position:relative; overflow:hidden;">','<div id="tableofcontents-img" style="width: 230px; height: 100%;"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="tableofcontents-chb-align"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<label class="input-label vertical-align-baseline">'+e.textLeader+"</label>",'<div id="tableofcontents-combo-leader" class="input-group-nr margin-left-10 vertical-align-baseline" style="display: inline-block; width:95px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="tableofcontents-chb-links"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">',"<% if (type == 1) { %>",'<label class="input-label padding-small" style="display: block;">'+e.textBuildTableOF+"</label>",'<div id="tableofcontents-radio-caption" class="padding-small" style="display: block;"></div>','<div id="tableofcontents-radio-style" class="" style="display: block;"></div>',"<% } else { %>",'<label class="input-label padding-small" style="display: block;">'+e.textBuildTable+"</label>",'<div id="tableofcontents-radio-levels" class="padding-small" style="display: block;"></div>','<div id="tableofcontents-radio-styles" class="" style="display: block;"></div>',"<% } %>","</td>","</tr>","<tr>",'<td class="padding-small" style="vertical-align: top;">',"<% if (type == 1) { %>",'<div id="tableofcontents-tof-from-caption" style="width:220px;">','<div id="tableofcontents-combo-captions" style="display: inline-block; width:129px; margin-bottom: 10px;"></div>',"</div>",'<div id="tableofcontents-tof-from-style" style="width:220px;" class="hidden">','<div id="tableofcontents-combo-tof-styles" style="display: inline-block; width:129px; margin-bottom: 10px;"></div>',"</div>",'<div id="tableofcontents-chb-full-caption"></div>',"<% } else { %>",'<div id="tableofcontents-from-levels" style="width:220px;">','<label class="input-label vertical-align-baseline">'+e.textLevels+"</label>",'<div id="tableofcontents-spin-levels" class="margin-left-10 vertical-align-baseline" style="display: inline-block; width:95px;"></div>',"</div>",'<div id="tableofcontents-from-styles" class="hidden">',"<table>","<tr>","<td>",'<div id="tableofcontents-styles-list" class="header-styles-tableview" style="width:100%; height: 143px;"></div>',"</td>","</tr>","</table>","</div>","<% } %>","</td>",'<td class="padding-small" style="vertical-align: top;">','<label class="input-label margin-left-10 vertical-align-baseline">'+e.textStyles+"</label>",'<div id="tableofcontents-combo-styles" class="input-group-nr margin-left-10 vertical-align-baseline" style="display: inline-block; width:129px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({type:t.type||0})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.type=t.type||0,this.startLevel=1,this.endLevel=3,this.isInitStylesListHeaders=!1,this._noApply=!0,this._originalProps=null,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.chPages=new Common.UI.CheckBox({el:$("#tableofcontents-chb-pages"),labelText:this.strShowPages,value:"checked"}),this.chPages.on("change",_.bind((function(t,e,i,n){var s="checked"==t.getValue(),o=1==this.type&&this.cmbStyles.getValue()==Asc.c_oAscTOFStylesType.Centered;if(this.chAlign.setDisabled(!s||o),this.cmbLeader.setDisabled(!s||o),this.api&&!this._noApply){var a=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;a.put_ShowPageNumbers(s),s&&!o&&(a.put_RightAlignTab("checked"==this.chAlign.getValue()),a.put_TabLeader(this.cmbLeader.getValue())),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",a):this.api.SetDrawImagePlaceContents("tableofcontents-img",a),this.scrollerY.update()}}),this)),this.chAlign=new Common.UI.CheckBox({el:$("#tableofcontents-chb-align"),labelText:this.strAlign,value:"checked"}),this.chAlign.on("change",_.bind((function(t,e,i,n){var s="checked"==t.getValue();if(this.cmbLeader.setDisabled(!s),this.api&&!this._noApply){var o=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;o.put_RightAlignTab(s),s&&o.put_TabLeader(this.cmbLeader.getValue()),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",o):this.api.SetDrawImagePlaceContents("tableofcontents-img",o),this.scrollerY.update()}}),this)),this.cmbLeader=new Common.UI.ComboBoxCustom({el:$("#tableofcontents-combo-leader"),style:"width: 85px;",menuStyle:"min-width: 85px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscTabLeader.None,cls:"",displayValue:this.textNone},{value:Asc.c_oAscTabLeader.Dot,cls:"font-sans-serif",displayValue:"...................."},{value:Asc.c_oAscTabLeader.Hyphen,cls:"font-sans-serif",displayValue:"-----------------"},{value:Asc.c_oAscTabLeader.Underscore,cls:"font-sans-serif",displayValue:"__________"}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>" class="<%= item.cls %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join("")),updateFormControl:function(t){this._input&&this._input.toggleClass("font-sans-serif",t.get("value")!==Asc.c_oAscTabLeader.None)}}),this.cmbLeader.setValue(Asc.c_oAscTabLeader.Dot),this.cmbLeader.on("selected",_.bind((function(t,e){if(this.api&&!this._noApply){var i=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;i.put_TabLeader(e.value),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",i):this.api.SetDrawImagePlaceContents("tableofcontents-img",i),this.scrollerY.update()}}),this)),this.chLinks=new Common.UI.CheckBox({el:$("#tableofcontents-chb-links"),labelText:1==this.type?this.strLinksOF:this.strLinks,value:"checked"}),this.chLinks.on("change",_.bind((function(t,e,i,n){if(this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;s.put_Hyperlink("checked"==t.getValue()),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",s):this.api.SetDrawImagePlaceContents("tableofcontents-img",s),this.scrollerY.update()}}),this)),1==this.type?(this.radioCaption=new Common.UI.RadioBox({el:$("#tableofcontents-radio-caption"),labelText:this.textRadioCaption,name:"asc-radio-content-tof-build",checked:!0}),this.radioCaption.on("change",_.bind((function(t,e,i){e&&(this.captionContainer.toggleClass("hidden",!e),this.styleContainer.toggleClass("hidden",e),this.changeCaption(this.cmbCaptions.getSelectedRecord()),this.disableButtons())}),this)),this.radioStyle=new Common.UI.RadioBox({el:$("#tableofcontents-radio-style"),labelText:this.textRadioStyle,name:"asc-radio-content-tof-build"}),this.radioStyle.on("change",_.bind((function(t,e,i){e&&(this.styleContainer.toggleClass("hidden",!e),this.captionContainer.toggleClass("hidden",e),this.changeTOFStyle(this.cmbTOFStyles.getSelectedRecord()),this.disableButtons())}),this)),this.cmbCaptions=new Common.UI.ComboBox({el:$("#tableofcontents-combo-captions"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,takeFocusOnClose:!0,data:[]}),this.cmbCaptions.on("selected",_.bind((function(t,e){this.changeCaption(e),this.disableButtons()}),this)),this.cmbTOFStyles=new Common.UI.ComboBox({el:$("#tableofcontents-combo-tof-styles"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!1,takeFocusOnClose:!0,data:[]}),this.cmbTOFStyles.on("selected",_.bind((function(t,e){this.changeTOFStyle(e)}),this)),this.chFullCaption=new Common.UI.CheckBox({el:$("#tableofcontents-chb-full-caption"),labelText:this.strFullCaption,value:"checked"}),this.chFullCaption.on("change",_.bind((function(t,e,i,n){if(this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;s.put_IncludeLabelAndNumber("checked"==t.getValue()),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",s),this.scrollerY.update()}}),this)),this.captionContainer=$("#tableofcontents-tof-from-caption"),this.styleContainer=$("#tableofcontents-tof-from-style")):(this.radioLevels=new Common.UI.RadioBox({el:$("#tableofcontents-radio-levels"),labelText:this.textRadioLevels,name:"asc-radio-content-build",checked:!0}),this.radioLevels.on("change",_.bind((function(t,e,i){e&&(this.levelsContainer.toggleClass("hidden",!e),this.stylesContainer.toggleClass("hidden",e),(this._needUpdateOutlineLevels||this._forceUpdateOutlineLevels)&&this.synchronizeLevelsFromStyles(!0))}),this)),this.radioStyles=new Common.UI.RadioBox({el:$("#tableofcontents-radio-styles"),labelText:this.textRadioStyles,name:"asc-radio-content-build"}),this.radioStyles.on("change",_.bind((function(e,i,n){i&&(this.stylesContainer.toggleClass("hidden",!i),this.levelsContainer.toggleClass("hidden",i),i&&!this.isInitStylesListHeaders&&(this.initListHeaders(),this.stylesList.setOffsetFromHeader(!0),this.isInitStylesListHeaders=!0),this._needUpdateStyles&&this.synchronizeLevelsFromOutline(),this.stylesList.scroller.update({alwaysVisibleY:!0}),setTimeout((function(){var e=t.stylesLevels.findWhere({checked:!0});e&&t.stylesList.scrollToRecord(e)}),10))}),this)),this.spnLevels=new Common.UI.CustomSpinner({el:$("#tableofcontents-spin-levels"),step:1,width:85,defaultUnit:"",value:this.endLevel,maxValue:9,minValue:1,allowDecimal:!1,maskExp:/[1-9]/}),this.spnLevels.on("change",_.bind(this.onLevelsChange,this)),this.stylesLevels=new Common.UI.DataViewStore,this.stylesLevels&&(this.stylesList=new Common.UI.ListView({el:$("#tableofcontents-styles-list",this.$window),store:this.stylesLevels,simpleAddMode:!0,showLast:!1,tabindex:1,headers:[{name:t.textStyle,width:144,style:Common.UI.isRTL()?"margin-right: 16px;":"margin-left: 16px;"},{name:t.textLevel}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item">','<div class="<% if (checked) { %>checked<% } %>"><%= Common.Utils.String.htmlEncode(displayValue) %></div>',"<div>",'<div class="input-field" style="width:40px;"><input type="text" class="form-control text-align-right" value="<%= value %>" maxLength="1">',"</div>","</div>","</div>"].join(""))}),this.stylesList.on("item:change",_.bind(this.onItemChange,this)),this.stylesList.on("item:add",_.bind(this.addEvents,this))),this.levelsContainer=$("#tableofcontents-from-levels"),this.stylesContainer=$("#tableofcontents-from-styles"));var e=1==this.type?[{displayValue:this.txtCurrent,value:Asc.c_oAscTOFStylesType.Current},{displayValue:this.txtSimple,value:Asc.c_oAscTOFStylesType.Simple},{displayValue:this.txtOnline,value:Asc.c_oAscTOFStylesType.Web},{displayValue:this.txtClassic,value:Asc.c_oAscTOFStylesType.Classic},{displayValue:this.txtDistinctive,value:Asc.c_oAscTOFStylesType.Distinctive},{displayValue:this.txtCentered,value:Asc.c_oAscTOFStylesType.Centered},{displayValue:this.txtFormal,value:Asc.c_oAscTOFStylesType.Formal}]:[{displayValue:this.txtCurrent,value:Asc.c_oAscTOCStylesType.Current},{displayValue:this.txtSimple,value:Asc.c_oAscTOCStylesType.Simple},{displayValue:this.txtOnline,value:Asc.c_oAscTOCStylesType.Web},{displayValue:this.txtStandard,value:Asc.c_oAscTOCStylesType.Standard},{displayValue:this.txtModern,value:Asc.c_oAscTOCStylesType.Modern},{displayValue:this.txtClassic,value:Asc.c_oAscTOCStylesType.Classic}];this.cmbStyles=new Common.UI.ComboBox({el:$("#tableofcontents-combo-styles"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,takeFocusOnClose:!0,data:e}),this.cmbStyles.setValue(1==this.type?Asc.c_oAscTOFStylesType.Current:Asc.c_oAscTOCStylesType.Current),this.cmbStyles.on("selected",_.bind((function(t,e){if(this.api&&!this._noApply){var i=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;if(i.put_StylesType(e.value),1==this.type){var n=e.value!==Asc.c_oAscTOFStylesType.Centered;this.chAlign.setValue(n,!0),this.chAlign.setDisabled(!n),this.cmbLeader.setDisabled(!n),i.put_RightAlignTab(n),n&&i.put_TabLeader(this.cmbLeader.getValue())}1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",i):this.api.SetDrawImagePlaceContents("tableofcontents-img",i),this.scrollerY.update()}}),this)),this.scrollerY=new Common.UI.Scroller({el:this.$window.find("#tableofcontents-img").parent(),minScrollbarLength:20}),this.scrollerY.update(),this.scrollerY.scrollTop(0),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},getFocusedComponents:function(){return[this.chPages,this.chAlign,this.cmbLeader,this.chLinks,this.radioLevels,this.radioStyles,this.spnLevels,this.stylesList,this.cmbStyles,this.radioCaption,this.radioStyle,this.cmbCaptions,this.cmbTOFStyles,this.chFullCaption].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chPages},afterRender:function(){this._setDefaults(this.props)},close:function(){1==this.type?this.api.SetDrawImagePlaceTableOfFigures(null):this.api.SetDrawImagePlaceContents(null),this.scrollerY.update(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this)},_setDefaults:function(t){if(this._noApply=!0,t){var e=t.get_Hyperlink();this.chLinks.setValue(null!=e?e:"indeterminate",!0),e=t.get_StylesType(),this.cmbStyles.setValue(null!==e?e:Asc.c_oAscTOCStylesType.Current),e=t.get_ShowPageNumbers(),this.chPages.setValue(null!=e?e:"indeterminate"),"checked"==this.chPages.getValue()?(e=t.get_RightAlignTab(),this.chAlign.setValue(null!=e?e:"indeterminate"),"checked"==this.chAlign.getValue()&&void 0!==(e=t.get_TabLeader())&&this.cmbLeader.setValue(e)):1==this.type&&this.cmbStyles.getValue()==Asc.c_oAscTOFStylesType.Centered&&this.chAlign.setValue(!1)}1==this.type?this.fillTOFProps(t):this.fillTOCProps(t),this._originalProps=t||new Asc.CTableOfContentsPr,t||(1==this.type?(this._originalProps.put_Caption(this.textFigure),this._originalProps.put_IncludeLabelAndNumber("checked"==this.chFullCaption.getValue())):this._originalProps.put_OutlineRange(this.startLevel,this.endLevel),this._originalProps.put_Hyperlink("checked"==this.chLinks.getValue()),this._originalProps.put_ShowPageNumbers("checked"==this.chPages.getValue()),"checked"==this.chPages.getValue()&&(this._originalProps.put_RightAlignTab("checked"==this.chAlign.getValue()),this._originalProps.put_TabLeader(this.cmbLeader.getValue()))),1==this.type?this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",this._originalProps):this.api.SetDrawImagePlaceContents("tableofcontents-img",this._originalProps),this.scrollerY.update(),this._noApply=!1},initListHeaders:function(){var t=this.stylesList.headerEl.find(".table-header-item"),e=this.stylesList.headerEl.width(),i=$(t[0]).width(),n=parseFloat($(t[0]).css("margin-left"));$(t[0]).addClass("hidden");var s=$(t[1]).width();$(t[0]).removeClass("hidden"),n+i+s>e&&this.stylesList.setHeaderWidth(0,e-s-n)},fillTOCProps:function(t){var e=this,i=this.api.asc_GetStylesArray(),n=[],s=!1;if(_.each(i,(function(t){var i=t.get_Name(),s=e.api.asc_GetHeadingLevel(i);(t.get_QFormat()||s>=0)&&n.push({name:i,displayValue:t.get_TranslatedName(),allowSelected:!1,checked:!1,value:"",headerLevel:s>=0?s+1:-1})})),t){var o=t.get_OutlineStart(),a=t.get_OutlineEnd(),l=t.get_StylesCount();this.startLevel=o,this.endLevel=a,(o<0||a<0)&&l<1&&(o=1,a=9,this.spnLevels.setValue(a,!0));for(var r=!1,c=0;c<l;c++){var d=t.get_StyleName(c),h=t.get_StyleLevel(c);(g=_.findWhere(n,{name:d}))?(g.checked=!0,g.value=h,g.headerLevel!==h&&(r=!0)):(n.push({name:d,displayValue:d,allowSelected:!1,checked:!0,value:h,headerLevel:-1}),r=!0)}if(o>0&&a>0)for(c=o;c<=a;c++){(g=_.findWhere(n,{headerLevel:c}))&&(g.checked=!0,g.value=c)}var p=-1,m=-1,u=-1;for(c=0;c<9;c++){if(g=_.findWhere(n,{headerLevel:c+1}))if(g.headerLevel==(h=g.value)){if(!(u<1)){p=m=-1,r=!0;break}p<1&&(p=h),m=h}else{if(g.checked){p=m=-1,r=!0;break}p>0&&(u=c+1)}}this.spnLevels.setValue(m>0?m:"",!0),s=r||p>1}else for(c=this.startLevel;c<=this.endLevel;c++){var g;(g=_.findWhere(n,{headerLevel:c}))&&(g.checked=!0,g.value=c)}(n.sort((function(t,e){var i=t.displayValue.toLocaleLowerCase(),n=e.displayValue.toLocaleLowerCase();return i<n?-1:i>n?1:0})),this.stylesLevels.reset(n),s)&&(this._forceUpdateOutlineLevels=!0,this.radioStyles.setValue(!0),this.stylesList.scroller.update({alwaysVisibleY:!0}),(g=this.stylesLevels.findWhere({checked:!0}))&&this.stylesList.scrollToRecord(g))},fillTOFProps:function(t){var e,i,n=!0,s=Common.Utils.InternalSettings.get("de-settings-captions");(null!=s&&null!=s||(s=Common.localStorage.getItem("de-settings-captions")||"",Common.Utils.InternalSettings.set("de-settings-captions",s)),(s=(s=s?JSON.parse(s):[]).concat([{value:this.textEquation,displayValue:this.textEquation},{value:this.textFigure,displayValue:this.textFigure},{value:this.textTable,displayValue:this.textTable}])).sort((function(t,e){var i=t.displayValue.toLowerCase(),n=e.displayValue.toLowerCase();return i>n?1:i<n?-1:0})),s=[{value:null,displayValue:this.textNone}].concat(s),this.cmbCaptions.setData(s),t)&&(n=!!t.get_Caption(),(i=this.cmbCaptions.store.findWhere({value:t.get_Caption()}))&&(e=i.get("value")));(s.length>0&&this.cmbCaptions.setValue(e||this.textFigure),s=[],_.each(this.api.asc_getAllUsedParagraphStyles(),(function(t,e){s.push({displayValue:t.get_TranslatedName(),styleName:t.get_Name(),value:e})})),s.sort((function(t,e){var i=t.displayValue.toLocaleLowerCase(),n=e.displayValue.toLocaleLowerCase();return i<n?-1:i>n?1:0})),this.cmbTOFStyles.setData(s),e=void 0,t)&&(t.get_StylesCount()>0&&(i=this.cmbTOFStyles.store.findWhere({styleName:t.get_StyleName(0)}))&&(e=i.get("value")));s.length>0&&this.cmbTOFStyles.setValue(e||s[0].value),t&&(e=t.get_IncludeLabelAndNumber(),this.chFullCaption.setValue(null!=e?e:"indeterminate",!0)),!n&&this.radioStyle.setValue(!0)},synchronizeLevelsFromOutline:function(){var t=this.spnLevels.getNumberValue();this.stylesLevels.each((function(e){var i=e.get("headerLevel");i>=1&&i<=t?(e.set("checked",!0),e.set("value",i)):(e.set("checked",!1),e.set("value",""))})),this._needUpdateStyles=!1},synchronizeLevelsFromStyles:function(t){for(var e=-1,i=-1,n=-1,s=0;s<9;s++){var o;if(o=this.stylesLevels.findWhere({headerLevel:s+1})){var a=o.get("headerLevel"),l=o.get("value");if(a==l){if(!(n<1)){e=i=-1,!0;break}e<1&&(e=l),i=l}else{if(o.get("checked")){e=i=-1,!0;break}e>0&&(n=s+1)}}}e<0&&i<0&&((o=this.stylesLevels.findWhere({checked:!0}))||(e=1,i=9));this.startLevel=e,this.endLevel=i,this.spnLevels.setValue(i>0?i:t?9:"",!0),t&&i<=0&&this.onLevelsChange(this.spnLevels),this._needUpdateOutlineLevels=!1,this._forceUpdateOutlineLevels=!1},getSettings:function(){var t=this._originalProps;if(t.put_Hyperlink("checked"==this.chLinks.getValue()),t.put_ShowPageNumbers("checked"==this.chPages.getValue()),"checked"==this.chPages.getValue()&&(t.put_RightAlignTab("checked"==this.chAlign.getValue()),t.put_TabLeader(this.cmbLeader.getValue())),t.put_StylesType(this.cmbStyles.getValue()),t.clear_Styles(),1==this.type)if(this.radioCaption.getValue())t.put_Caption(this.cmbCaptions.getValue());else{t.put_Caption(null);var e=this.cmbTOFStyles.getSelectedRecord();e&&t.add_Style(e.styleName)}else this._needUpdateOutlineLevels&&this.synchronizeLevelsFromStyles(),this._needUpdateStyles||this.stylesLevels.each((function(e){e.get("checked")&&t.add_Style(e.get("name"),e.get("value"))})),t.put_OutlineRange(this.startLevel,this.endLevel);return t},addEvents:function(t,e,i){var n=e.$el.find("input"),s=this;n.on("keypress",(function(t){var e=String.fromCharCode(t.which);/[1-9]/.test(e)||t.ctrlKey||(t.preventDefault(),t.stopPropagation())})),n.on("input",(function(t){var e=_.isEmpty(n.val());if(i.get("checked")!==!e&&i.set("checked",!e),i.set("value",e?"":parseInt(n.val())),s._needUpdateOutlineLevels=!0,s.api&&!s._noApply){var o=s._originalProps?s._originalProps:new Asc.CTableOfContentsPr;o.clear_Styles(),s.stylesLevels.each((function(t){t.get("checked")&&o.add_Style(t.get("name"),t.get("value"))})),o.get_StylesCount()>0?o.put_OutlineRange(-1,-1):o.put_OutlineRange(1,9),s.api.SetDrawImagePlaceContents("tableofcontents-img",o),s.scrollerY.update()}}))},onItemChange:function(t,e,i){this.addEvents(t,e,i);var n=e.$el.find("input");setTimeout((function(){n.focus(),n[0].selectionStart=n[0].selectionEnd=n[0].value.length}),10)},changeCaption:function(t){if(this.api&&!this._noApply&&t){var e=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;e.put_Caption(t.value),e.clear_Styles(),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",e),this.scrollerY.update()}},changeTOFStyle:function(t){if(this.api&&!this._noApply){var e=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;e.put_Caption(null),e.clear_Styles(),e.add_Style(t.styleName),this.api.SetDrawImagePlaceTableOfFigures("tableofcontents-img",e),this.scrollerY.update()}},onLevelsChange:function(t,e,i,n){if(this._needUpdateStyles=!0,this.startLevel=1,this.endLevel=t.getNumberValue(),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.CTableOfContentsPr;s.clear_Styles(),s.put_OutlineRange(this.startLevel,this.endLevel),this.api.SetDrawImagePlaceContents("tableofcontents-img",s),this.scrollerY.update()}},disableButtons:function(){this.type&&this.btnOk.setDisabled(this.radioCaption.getValue()&&null===this.cmbCaptions.getValue()||this.radioStyle.getValue()&&this.cmbTOFStyles.length<1)},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.btnOk.isDisabled())return;this.handler.call(this,t,this.getSettings())}this.close()},textTitle:"Table of Contents",textLeader:"Leader",textBuildTable:"Build table of contents from",textLevels:"Levels",textStyles:"Styles",strShowPages:"Show page numbers",strAlign:"Right align page numbers",strLinks:"Format Table of Contents as links",textNone:"None",textRadioLevels:"Outline levels",textRadioStyles:"Selected styles",textStyle:"Style",textLevel:"Level",txtCurrent:"Current",txtSimple:"Simple",txtStandard:"Standard",txtModern:"Modern",txtClassic:"Classic",txtOnline:"Online",textTitleTOF:"Table of Figures",textBuildTableOF:"Build table of figures from",textRadioCaption:"Caption",textRadioStyle:"Style",strFullCaption:"Include label and number",textEquation:"Equation",textFigure:"Figure",textTable:"Table",txtDistinctive:"Distinctive",txtCentered:"Centered",txtFormal:"Formal",strLinksOF:"Format table of figures as links"},DE.Views.TableOfContentsSettings||{}))})),define("documenteditor/main/app/view/EditListItemDialog",[],(function(){"use strict";DE.Views.EditListItemDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textDisplayName+"</label>","</div>",'<div id="id-dlg-label-name" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">',"<label>"+this.textValue+"</label>","</div>",'<div id="id-dlg-label-value" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-label-name"),allowBlank:!1,blankError:t.textNameError,style:"width: 100%;",maxLength:256,validateOnBlur:!1,validation:function(t){return!!t||""}}),t.inputName._input.on("input",(function(e){null==t.copyvalue&&t.inputValue.getValue()==t.inputName.getValue()&&(t.copyvalue=1),1==t.copyvalue?t.inputValue.setValue($(e.target).val()):2==t.copyvalue&&(t.copyvalue=0)})),t.inputValue=new Common.UI.InputField({el:$("#id-dlg-label-value"),style:"width: 100%;",maxLength:256,validateOnBlur:!1,validation:function(e){if(""!==e&&t.options.store&&t.options.store.findWhere({value:e}))return t.textValueError;return!0}}),t.inputValue._input.on("input",(function(e){null==t.copyvalue&&t.inputValue.getValue()==t.inputName.getValue()&&(t.copyvalue=2),2==t.copyvalue?t.inputName.setValue($(e.target).val()):1==t.copyvalue&&(t.copyvalue=0)})),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputValue].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(!0!==this.inputName.checkValidate())return void this.inputName.focus();if(!0!==this.inputValue.checkValidate())return void this.inputValue.focus()}this.options.handler.call(this,t,this.inputName.getValue(),this.inputValue.getValue())}this.close()},setSettings:function(t){t&&(this.inputName.setValue(t.name||""),this.inputValue.setValue(t.value||""))},textDisplayName:"Display name",textValue:"Value",textNameError:"Display name must not be empty.",textValueError:"An item with the same value already exists."},DE.Views.EditListItemDialog||{}))})),define("text!documenteditor/main/app/template/ControlSettingsDialog.template",[],(function(){return'<div id="id-adv-control-settings-general" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textName %></label>\n                    <div id="control-settings-txt-name"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textPlaceholder %></label>\n                    <div id="control-settings-txt-pholder"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textTag %></label>\n                    <div id="control-settings-txt-tag"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-temp"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div class="separator horizontal"></div>\n                </td>\n            </tr>\n        </table>\n        <table cols="2" style="width: auto;" role="presentation">\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <label class="header"><%= scope.textAppearance %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textShowAs %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="control-settings-combo-show" class="input-group-nr" style="display: inline-block; width:120px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textColor %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="control-settings-color-btn" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="" colspan="2">\n                    <button type="button" class="btn btn-text-default auto" id="control-settings-btn-all" style="min-width: 98px;"><%= scope.textApplyAll %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-lock" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-lock-delete"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-chb-lock-edit"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-list" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td>\n                    <label class="header" style="width: 99px;"><%= scope.textDisplayName %></label>\n                    <label class="header" style=""><%= scope.textValue %></label>\n                </td>\n                <td></td>\n            </tr>\n            <tr style="vertical-align: top;">\n                <td class="padding-small">\n                    <div id="control-settings-list" class="margin-right-10" style="width:200px; height: 214px;"></div>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-add" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textAdd %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-change" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textChange %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-delete" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-up" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textUp %></button>\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-down" style="min-width: 86px;margin-bottom: 5px;"><%= scope.textDown %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-date" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td>\n                    <label><%= scope.textFormat %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-txt-format" style="width: 100%;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-format" style="width: 100%; height: 162px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textLang %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="control-settings-lang"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-checkbox" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: auto;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textChecked %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-checked-edit" style="width:53px"></button>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textUnchecked %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-unchecked-edit" style="width:53px"></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-additional" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr class="group-key">\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textGroupKey %></label>\n                    <div id="control-settings-txt-groupkey"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textKey %></label>\n                    <div id="control-settings-txt-key"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textLabel %></label>\n                    <div id="control-settings-txt-label"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="input-label"><%= scope.textHelp %></label>\n                    <textarea id="control-settings-txt-help" class="form-control" style="width: 100%; height: 90px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="control-settings-chb-required"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-control-settings-field" class="settings-panel">\n    <div class="inner-content">\n        <table cols="2" style="width: auto;" role="presentation">\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="control-settings-chb-max-chars" class="margin-right-10" style="display: inline-block;"></div>\n                    <div id="control-settings-spin-max-chars" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <div id="control-settings-chb-comb"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label margin-right-10"><%= scope.textPlaceholderSymbol %></label>\n                </td>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default" id="control-settings-btn-placeholder-edit" style="width:53px"></button>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" colspan="2">\n                    <label class="input-label margin-right-10"><%= scope.textWidth %></label>\n                    <div id="control-settings-spin-width"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),define("documenteditor/main/app/view/ControlSettingsDialog",["text!documenteditor/main/app/template/ControlSettingsDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.ControlSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,contentHeight:325,toggleGroup:"control-adv-settings-group",storageName:"de-control-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-control-settings-general",panelCaption:this.strGeneral},{panelId:"id-adv-control-settings-lock",panelCaption:this.textLock},{panelId:"id-adv-control-settings-list",panelCaption:this.textCombobox},{panelId:"id-adv-control-settings-date",panelCaption:this.textDate},{panelId:"id-adv-control-settings-checkbox",panelCaption:this.textCheckbox},{panelId:"id-adv-control-settings-field",panelCaption:this.textField},{panelId:"id-adv-control-settings-additional",panelCaption:this.textAdditional}],contentTemplate:_.template(t)({scope:this})},e),this.handler=e.handler,this.props=e.props,this.api=e.api,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtName=new Common.UI.InputField({el:$("#control-settings-txt-name"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",maxLength:64,value:""}),this.txtTag=new Common.UI.InputField({el:$("#control-settings-txt-tag"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",maxLength:64,value:""}),this.txtPlaceholder=new Common.UI.InputField({el:$("#control-settings-txt-pholder"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.cmbShow=new Common.UI.ComboBox({el:$("#control-settings-combo-show"),cls:"input-group-nr",menuStyle:"min-width: 120px;",editable:!1,takeFocusOnClose:!0,data:[{displayValue:this.textBox,value:Asc.c_oAscSdtAppearance.Frame},{displayValue:this.textNone,value:Asc.c_oAscSdtAppearance.Hidden}]}),this.cmbShow.setValue(Asc.c_oAscSdtAppearance.Frame),this.btnColor=new Common.UI.ColorButton({parentEl:$("#control-settings-color-btn"),auto:{caption:this.textSystemColor,color:Common.Utils.ThemeColor.getHexColor(220,220,220)},additionalAlign:this.menuAddAlign,color:"auto",colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","00FF00","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","C9C8FF","CC99FF","FFFFFF"],themecolors:0,effects:0,takeFocusOnClose:!0}),this.colors=this.btnColor.getPicker(),this.btnApplyAll=new Common.UI.Button({el:$("#control-settings-btn-all")}),this.btnApplyAll.on("click",_.bind(this.applyAllClick,this)),this.chTemp=new Common.UI.CheckBox({el:$("#control-settings-chb-temp"),labelText:this.txtRemContent}),this.chLockDelete=new Common.UI.CheckBox({el:$("#control-settings-chb-lock-delete"),labelText:this.txtLockDelete}),this.chLockEdit=new Common.UI.CheckBox({el:$("#control-settings-chb-lock-edit"),labelText:this.txtLockEdit}),this.list=new Common.UI.ListView({el:$("#control-settings-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="margin-right-5" style="width:90px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div style="width:90px;display: inline-block;vertical-align: middle; overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>"].join("")),tabindex:1}),this.list.on("item:select",_.bind(this.onSelectItem,this)),this.btnAdd=new Common.UI.Button({el:$("#control-settings-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddItem,this)),this.btnChange=new Common.UI.Button({el:$("#control-settings-btn-change")}),this.btnChange.on("click",_.bind(this.onChangeItem,this)),this.btnDelete=new Common.UI.Button({el:$("#control-settings-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteItem,this)),this.btnUp=new Common.UI.Button({el:$("#control-settings-btn-up")}),this.btnUp.on("click",_.bind(this.onMoveItem,this,!0)),this.btnDown=new Common.UI.Button({el:$("#control-settings-btn-down")}),this.btnDown.on("click",_.bind(this.onMoveItem,this,!1));var e=[{value:1025},{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:14345},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1057},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:10266},{value:9242},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052},{value:1028}];e.forEach((function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value),i=Common.util.LanguageInfo.getLocalLanguageDisplayName(t.value);t.displayValue=i.native,t.displayValueEn=i.english,t.langName=e[0]})),this.cmbLang=new Common.UI.ComboBox({el:$("#control-settings-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),data:e,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",(function(e,i){t.updateFormats(i.value)})),this.listFormats=new Common.UI.ListView({el:$("#control-settings-format"),store:new Common.UI.DataViewStore,scrollAlwaysVisible:!0,tabindex:1}),this.listFormats.on("item:select",_.bind(this.onSelectFormat,this)),this.txtDate=new Common.UI.InputField({el:$("#control-settings-txt-format"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.btnEditChecked=new Common.UI.Button({el:$("#control-settings-btn-checked-edit"),hint:this.tipChange}),this.btnEditChecked.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditChecked.on("click",_.bind(this.onEditCheckbox,this,!0)),this.btnEditUnchecked=new Common.UI.Button({el:$("#control-settings-btn-unchecked-edit"),hint:this.tipChange}),this.btnEditUnchecked.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditUnchecked.on("click",_.bind(this.onEditCheckbox,this,!1)),this.txtGroupKey=new Common.UI.InputField({el:$("#control-settings-txt-groupkey"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.txtKey=new Common.UI.InputField({el:$("#control-settings-txt-key"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.txtLabel=new Common.UI.InputField({el:$("#control-settings-txt-label"),allowBlank:!0,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",value:""}),this.textareaHelp=this.$window.find("#control-settings-txt-help"),this.textareaHelp.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isHelpChanged=!0})),this.chRequired=new Common.UI.CheckBox({el:$("#control-settings-chb-required"),labelText:this.textRequired}),this.btnEditPlaceholder=new Common.UI.Button({el:$("#control-settings-btn-placeholder-edit"),hint:this.tipChange}),this.btnEditPlaceholder.cmpEl.css({"font-size":"16px","line-height":"16px"}),this.btnEditPlaceholder.on("click",_.bind(this.onEditPlaceholder,this)),this.spnWidth=new Common.UI.MetricSpinner({el:$("#control-settings-spin-width"),step:.1,width:80,defaultUnit:"cm",value:"Auto",allowAuto:!0,maxValue:55.88,minValue:.1}),this.spnMaxChars=new Common.UI.MetricSpinner({el:$("#control-settings-spin-max-chars"),step:1,width:53,defaultUnit:"",value:"10",maxValue:1e6,minValue:1}),this.chMaxChars=new Common.UI.CheckBox({el:$("#control-settings-chb-max-chars"),labelText:this.textMaxChars}),this.chMaxChars.on("change",_.bind((function(t,e,i,n){this.spnMaxChars.setDisabled("checked"!=t.getValue())}),this)),this.chComb=new Common.UI.CheckBox({el:$("#control-settings-chb-comb"),labelText:this.textComb}),this.chComb.on("change",_.bind((function(t,e,i,n){var s="checked"==t.getValue();s&&this.chMaxChars.setValue(!0),this.btnEditPlaceholder.setDisabled(!s),this.spnWidth.setDisabled(!s)}),this)),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.txtName,this.txtTag,this.txtPlaceholder,this.chTemp,this.cmbShow,this.btnColor,this.btnApplyAll,this.chLockDelete,this.chLockEdit,this.list,this.btnAdd,this.btnChange,this.btnDelete,this.btnUp,this.btnDown,this.txtDate,this.listFormats,this.cmbLang,this.btnEditChecked,this.btnEditUnchecked]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){0==e?i.txtName.focus():1==e?i.chLockDelete.focus():2==e?i.list.focus():3==e?i.txtDate.focus():4==e&&i.btnEditChecked.focus()}),100)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this.props),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){var e=t.get_Alias();this.txtName.setValue(e||""),e=t.get_Tag(),this.txtTag.setValue(e||""),e=t.get_PlaceholderText(),this.txtPlaceholder.setValue(e||""),null!=(e=t.get_Appearance())&&this.cmbShow.setValue(e),(e=t.get_Color())?(e=Common.Utils.ThemeColor.getHexColor(e.get_r(),e.get_g(),e.get_b()),this.colors.selectByRGB(e,!0)):(this.colors.clearSelection(),e="auto"),this.btnColor.setAutoColor("auto"==e),this.btnColor.setColor(e),void 0===(e=t.get_Lock())&&(e=Asc.c_oAscSdtLockType.Unlocked),this.chLockDelete.setValue(e==Asc.c_oAscSdtLockType.SdtContentLocked||e==Asc.c_oAscSdtLockType.SdtLocked),this.chLockEdit.setValue(e==Asc.c_oAscSdtLockType.SdtContentLocked||e==Asc.c_oAscSdtLockType.ContentLocked),e=t.get_Temporary(),this.chTemp.setValue(!!e);var i,n=t.get_SpecificType();if(this.btnsCategory[2].setVisible(n==Asc.c_oAscContentControlSpecificType.ComboBox||n==Asc.c_oAscContentControlSpecificType.DropDownList),n==Asc.c_oAscContentControlSpecificType.ComboBox||n==Asc.c_oAscContentControlSpecificType.DropDownList){if(this.btnsCategory[2].setCaption(n==Asc.c_oAscContentControlSpecificType.ComboBox?this.textCombobox:this.textDropDown),i=n==Asc.c_oAscContentControlSpecificType.ComboBox?t.get_ComboBoxPr():t.get_DropDownListPr()){for(var s=i.get_ItemsCount(),o=[],a=0;a<s;a++)o.push({value:i.get_ItemValue(a),name:i.get_ItemDisplayText(a)});this.list.store.reset(o)}this.disableListButtons()}if(this.btnsCategory[3].setVisible(n==Asc.c_oAscContentControlSpecificType.DateTime),n==Asc.c_oAscContentControlSpecificType.DateTime&&(i=t.get_DateTimePr())){this.datetime=i;var l=i.get_LangId()||this.options.controlLang;if(l){var r=this.cmbLang.store.findWhere({value:l});r=r?r.get("value"):1033,this.cmbLang.setValue(r)}this.updateFormats(this.cmbLang.getValue());var c=i.get_DateFormat(),d=this.listFormats.store.findWhere({format:c});this.listFormats.selectRecord(d),this.listFormats.scrollToRecord(d),this.txtDate.setValue(c)}if(this.btnsCategory[4].setVisible(n==Asc.c_oAscContentControlSpecificType.CheckBox),n==Asc.c_oAscContentControlSpecificType.CheckBox&&(i=t.get_CheckBoxPr())){var h=i.get_CheckedSymbol();(g=i.get_CheckedFont())&&this.btnEditChecked.cmpEl.css("font-family",g),h&&this.btnEditChecked.setCaption(String.fromCharCode(h)),this.checkedBox={code:h,font:g},h=i.get_UncheckedSymbol(),(g=i.get_UncheckedFont())&&this.btnEditUnchecked.cmpEl.css("font-family",g),h&&this.btnEditUnchecked.setCaption(String.fromCharCode(h)),this.uncheckedBox={code:h,font:g}}this.type=n;var p=t.get_FormPr();if(this.btnsCategory[6].setVisible(!!p),p){e=p.get_Key(),this.txtKey.setValue(e||""),e=p.get_Label(),this.txtLabel.setValue(e||""),e=p.get_HelpText(),this.textareaHelp.val(e||""),e=p.get_Required(),this.chRequired.setValue(!!e);var m=!0;n==Asc.c_oAscContentControlSpecificType.CheckBox&&i&&(e=i.get_GroupKey(),this.txtGroupKey.setValue(e||""),!(m="string"!=typeof e)&&this.btnsCategory[4].setCaption(this.textRadiobox)),this.$window.find(".group-key").toggleClass("hidden",m)}var u=t.get_TextFormPr();if(this.btnsCategory[5].setVisible(!!u),u){var g;h=u.get_PlaceHolderSymbol();(g=u.get_PlaceHolderFont())&&this.btnEditPlaceholder.cmpEl.css("font-family",g),h&&this.btnEditPlaceholder.setCaption(String.fromCharCode(h)),this.placeholder={code:h,font:g},e=u.get_Comb(),this.chComb.setValue(!!e,!0),this.btnEditPlaceholder.setDisabled(!e),this.spnWidth.setDisabled(!e),e=u.get_MaxCharacters(),this.chMaxChars.setValue(e&&e>=0,!0),this.spnMaxChars.setDisabled(!e||e<0),this.spnMaxChars.setValue(e&&e>=0?e:10),e=u.get_Width(),this.spnWidth.setValue(0!==e&&void 0!==e?Common.Utils.Metric.fnRecalcFromMM(25.4*e/20/72):-1,!0)}n!=Asc.c_oAscContentControlSpecificType.CheckBox&&n!=Asc.c_oAscContentControlSpecificType.Picture||p||this.txtPlaceholder.cmpEl&&this.txtPlaceholder.cmpEl.closest("tr").hide()}},getSettings:function(){var t=new AscCommon.CContentControlPr;if(t.put_Alias(this.txtName.getValue()),t.put_Tag(this.txtTag.getValue()),t.put_PlaceholderText(this.txtPlaceholder.getValue()||"    "),t.put_Appearance(this.cmbShow.getValue()),this.btnColor.isAutoColor())t.put_Color(null);else{var e=this.colors.getColor()||this.btnColor.color;e&&(e=Common.Utils.ThemeColor.getRgbColor(e),t.put_Color(e.get_r(),e.get_g(),e.get_b()))}t.put_Temporary("checked"===this.chTemp.getValue());var i,n=Asc.c_oAscSdtLockType.Unlocked;if("checked"==this.chLockDelete.getValue()&&"checked"==this.chLockEdit.getValue()?n=Asc.c_oAscSdtLockType.SdtContentLocked:"checked"==this.chLockDelete.getValue()?n=Asc.c_oAscSdtLockType.SdtLocked:"checked"==this.chLockEdit.getValue()&&(n=Asc.c_oAscSdtLockType.ContentLocked),t.put_Lock(n),this.type!=Asc.c_oAscContentControlSpecificType.ComboBox&&this.type!=Asc.c_oAscContentControlSpecificType.DropDownList||((i=this.type==Asc.c_oAscContentControlSpecificType.ComboBox?this.props.get_ComboBoxPr():this.props.get_DropDownListPr()).clear(),this.list.store.each((function(t,e){i.add_Item(t.get("name"),t.get("value"))})),this.type==Asc.c_oAscContentControlSpecificType.ComboBox?t.put_ComboBoxPr(i):t.put_DropDownListPr(i)),this.type==Asc.c_oAscContentControlSpecificType.DateTime&&((i=this.props.get_DateTimePr()).put_DateFormat(this.txtDate.getValue()),i.put_LangId(this.cmbLang.getValue()),t.put_DateTimePr(i)),this.type==Asc.c_oAscContentControlSpecificType.CheckBox&&(this.checkedBox&&this.checkedBox.changed||this.uncheckedBox&&this.uncheckedBox.changed)&&(i=this.props.get_CheckBoxPr(),this.checkedBox&&(i.put_CheckedSymbol(this.checkedBox.code),i.put_CheckedFont(this.checkedBox.font)),this.uncheckedBox&&(i.put_UncheckedSymbol(this.uncheckedBox.code),i.put_UncheckedFont(this.uncheckedBox.font)),t.put_CheckBoxPr(i)),this.btnsCategory[6].isVisible()){var s=new AscCommon.CSdtFormPr;s.put_Key(this.txtKey.getValue()),s.put_Label(this.txtLabel.getValue()),s.put_Required("checked"==this.chRequired.getValue()),this.isHelpChanged&&s.put_HelpText(this.textareaHelp.val()),this.type!=Asc.c_oAscContentControlSpecificType.CheckBox||this.$window.find(".group-key").hasClass("hidden")||(i=this.props.get_CheckBoxPr())&&(i.put_GroupKey(this.txtGroupKey.getValue()),t.put_CheckBoxPr(i)),t.put_FormPr(s)}if(this.btnsCategory[5].isVisible()){var o=new AscCommon.CSdtTextFormPr;if(this.spnWidth.getValue()){var a=this.spnWidth.getNumberValue();o.put_Width(a<=0?0:parseInt(72*Common.Utils.Metric.fnRecalcToMM(a)*20/25.4))}else o.put_Width(0);this.placeholder&&this.placeholder.changed&&(o.put_PlaceHolderSymbol(this.placeholder.code),o.put_PlaceHolderFont(this.placeholder.font)),o.put_Comb("checked"==this.chComb.getValue());var l="checked"==this.chMaxChars.getValue()||"checked"==this.chComb.getValue();o.put_MaxCharacters(l),l&&o.put_MaxCharacters(this.spnMaxChars.getNumberValue()||10),t.put_TextFormPr(o)}return t},onDlgBtnClick:function(t){var e="object"==typeof t?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,this.getSettings()),this.close()},applyAllClick:function(t,e){if(this.api){var i=new AscCommon.CContentControlPr;if(i.put_Appearance(this.cmbShow.getValue()),this.btnColor.isAutoColor())i.put_Color(null);else{var n=this.colors.getColor()||this.btnColor.color;n&&(n=Common.Utils.ThemeColor.getRgbColor(n),i.put_Color(n.get_r(),n.get_g(),n.get_b()))}this.api.asc_SetContentControlProperties(i,null,!0)}},onSelectItem:function(t,e,i){this.disableListButtons(!1)},disableListButtons:function(t){void 0===t&&(t=!this.list.getSelectedRec()),this.btnChange.setDisabled(t),this.btnDelete.setDisabled(t),this.btnUp.setDisabled(t),this.btnDown.setDisabled(t)},onAddItem:function(){var t=this;new DE.Views.EditListItemDialog({store:t.list.store,handler:function(e,i,n){if("ok"==e){var s=t.list.store.add({value:n,name:i});s&&(t.list.selectRecord(s),t.list.scrollToRecord(s),t.disableListButtons())}t.list.focus()}}).on("close",(function(){t.list.focus()})).show()},onChangeItem:function(){var t=this,e=this.list.getSelectedRec(),i=new DE.Views.EditListItemDialog({store:t.list.store,handler:function(i,n,s){"ok"==i&&e&&e.set({value:s,name:n}),t.list.focus()}}).on("close",(function(){t.list.focus()}));e&&i.show(),e&&i.setSettings({name:e.get("name"),value:e.get("value")})},onDeleteItem:function(t,e){var i=this.list.getSelectedRec();if(i){var n=this.list.store,s=_.indexOf(n.models,i);n.remove(i),s>n.length-1&&(s=n.length-1),n.length>0&&(this.list.selectByIndex(s),this.list.scrollToRecord(n.at(s)))}this.disableListButtons(),this.list.focus()},onMoveItem:function(t){var e=this.list.store,i=e.length,n=this.list.getSelectedRec();if(n){var s=e.indexOf(n);e.add(e.remove(n),{at:t?Math.max(0,s-1):Math.min(i-1,s+1)}),this.list.selectRecord(n),this.list.scrollToRecord(n)}this.list.focus()},updateFormats:function(t){if(this.datetime){for(var e=this.datetime,i=e.get_FormatsExamples(),n=[],s=0,o=i.length;s<o;s++){e.get_String(i[s],void 0,t),(a=new Common.UI.DataViewModel).set({format:i[s],value:e.get_String(i[s],void 0,t)}),n.push(a)}this.listFormats.store.reset(n),this.listFormats.selectByIndex(0);var a=this.listFormats.getSelectedRec();this.listFormats.scrollToRecord(a),this.txtDate.setValue(a.get("format"))}},onEditCheckbox:function(t){if(this.api){var e=this,i=t?e.checkedBox:e.uncheckedBox,n=t?e.btnEditChecked:e.btnEditUnchecked,s=function(t,e,s){"ok"==e&&(i.changed=!0,i.code=s.code,i.font=s.font,i.font&&n.cmpEl.css("font-family",i.font),s.symbol&&n.setCaption(s.symbol))},o=new Common.Views.SymbolTableDialog({api:e.api,lang:e.options.interfaceLang,modal:!0,type:0,font:i.font,code:i.code,handler:s}).on("close",(function(){n.focus()}));o.show(),o.on("symbol:dblclick",s)}},onEditPlaceholder:function(){if(this.api){var t=this,e=t.placeholder,i=t.btnEditPlaceholder,n=function(t,n,s){"ok"==n&&(e.changed=!0,e.code=s.code,e.font=s.font,e.font&&i.cmpEl.css("font-family",e.font),s.symbol&&i.setCaption(s.symbol))},s=new Common.Views.SymbolTableDialog({api:t.api,lang:t.options.interfaceLang,modal:!0,type:0,font:e.font,code:e.code,handler:n});s.show(),s.on("symbol:dblclick",n)}},onSelectFormat:function(t,e,i){i&&this.txtDate.setValue(i.get("format"))},updateMetricUnit:function(){this.spnWidth.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),this.spnWidth.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)},textTitle:"Content Control Settings",textName:"Title",textTag:"Tag",txtLockDelete:"Content control cannot be deleted",txtLockEdit:"Contents cannot be edited",textLock:"Locking",textShowAs:"Show as",textColor:"Color",textBox:"Bounding box",textNone:"None",textApplyAll:"Apply to All",textAppearance:"Appearance",textSystemColor:"System",strGeneral:"General",textAdd:"Add",textChange:"Edit",textDelete:"Delete",textUp:"Up",textDown:"Down",textCombobox:"Combo box",textDropDown:"Drop-down list",textDisplayName:"Display name",textValue:"Value",textDate:"Date format",textLang:"Language",textFormat:"Display the date like this",textCheckbox:"Check box",textChecked:"Checked symbol",textUnchecked:"Unchecked symbol",tipChange:"Change symbol",textPlaceholder:"Placeholder",textAdditional:"Additional",textField:"Text field",textKey:"Key",textLabel:"Label",textHelp:"Help text",textRequired:"Required",textGroupKey:"Group key",textRadiobox:"Radio box",textWidth:"Width",textPlaceholderSymbol:"Placeholder symbol",textMaxChars:"Characters limit",textComb:"Comb of characters",txtRemContent:"Remove content control when contents are edited"},DE.Views.ControlSettingsDialog||{}))})),define("documenteditor/main/app/view/DateTimeDialog",[],(function(){"use strict";DE.Views.DateTimeDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-date-time",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="font-weight-bold">'+this.textLang+"</label>","</div>",'<div id="datetime-dlg-lang" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">','<label class="font-weight-bold">'+this.textFormat+"</label>","</div>",'<div id="datetime-dlg-format" class="" style="margin-bottom: 10px;width: 100%; height: 162px; overflow: hidden;"></div>','<div class="input-row" style="margin-bottom: 8px;">','<div id="datetime-dlg-update" style="margin-top: 3px;margin-bottom: 10px;"></div>','<button type="button" class="btn btn-text-default auto float-right" id="datetime-dlg-default">'+this.textDefault+"</button>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.lang=this.options.lang,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=[{value:1025},{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:14345},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1057},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:10266},{value:9242},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052},{value:1028}];t.forEach((function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value),i=Common.util.LanguageInfo.getLocalLanguageDisplayName(t.value);t.displayValue=i.native,t.displayValueEn=i.english,t.langName=e[0]})),this.cmbLang=new Common.UI.ComboBox({el:$("#datetime-dlg-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),data:t,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",_.bind((function(t,e){this.updateFormats(e.value)}),this));var e=Common.Utils.InternalSettings.get("de-date-auto-update");null!=e&&null!=e||(e=Common.localStorage.getBool("de-date-auto-update"),Common.Utils.InternalSettings.set("de-date-auto-update",e)),this.chUpdate=new Common.UI.CheckBox({el:$("#datetime-dlg-update"),labelText:this.textUpdate,value:!!e}),this.chUpdate.on("change",_.bind((function(t,e,i,n){this.onSelectFormat(this.listFormats,null,this.listFormats.getSelectedRec()),Common.localStorage.setBool("de-date-auto-update","checked"===e),Common.Utils.InternalSettings.set("de-date-auto-update","checked"===e)}),this)),this.listFormats=new Common.UI.ListView({el:$("#datetime-dlg-format"),store:new Common.UI.DataViewStore,tabindex:1,scrollAlwaysVisible:!0,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item"><span dir="ltr"><%= value %></span></div>')}),this.listFormats.on("item:select",_.bind(this.onSelectFormat,this)),this.listFormats.on("item:dblclick",_.bind(this.onDblClickFormat,this)),this.listFormats.on("entervalue",_.bind(this.onPrimary,this)),this.btnDefault=new Common.UI.Button({el:$("#datetime-dlg-default")}),this.btnDefault.on("click",_.bind((function(t,e){var i=this.listFormats.getSelectedRec();Common.UI.warning({msg:Common.Utils.String.format(this.confirmDefault,Common.util.LanguageInfo.getLocalLanguageName(this.cmbLang.getValue())[1],i?i.get("value"):""),buttons:["yes","no"],primary:"yes",callback:_.bind((function(t){if("yes"==t){this.defaultFormats[this.cmbLang.getValue()]=i?i.get("format"):"";var e=[];for(var n in this.defaultFormats)n&&e.push({lang:n,format:this.defaultFormats[n]});var s=JSON.stringify(e);Common.localStorage.setItem("de-settings-datetime-default",s),Common.Utils.InternalSettings.set("de-settings-datetime-default",s)}this.listFormats.focus()}),this)})}),this)),this.chUpdate.$el.outerWidth()+this.btnDefault.$el.outerWidth()>this.$window.find(".box").width()&&(this.btnDefault.$el.removeClass("float-right"),this.listFormats.$el.height(139)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},afterRender:function(){var t=this,e=Common.Utils.InternalSettings.get("de-settings-datetime-default"),i=e?JSON.parse(e):[];this.defaultFormats=[],i.forEach((function(e){e.lang&&(t.defaultFormats[parseInt(e.lang)]=e.format)})),this._setDefaults()},getFocusedComponents:function(){return[this.cmbLang,this.listFormats,this.chUpdate,this.btnDefault].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbLang},_setDefaults:function(){if(this.props=new Asc.CAscDateTime,this.lang){var t=this.cmbLang.store.findWhere({value:this.lang});t=t?t.get("value"):1033,this.cmbLang.setValue(t)}this.updateFormats(this.cmbLang.getValue())},getSettings:function(){return this.props},updateFormats:function(t){this.props.put_Lang(t);for(var e=this.props.get_FormatsExamples(),i=[],n=this.listFormats.store,s=0,o=e.length;s<o;s++){(a=new Common.UI.DataViewModel).set({format:e[s],value:this.props.get_String(e[s],void 0,t)}),i.push(a)}n.reset(i);var a,l=this.defaultFormats[t];!(a=l?n.findWhere({format:l}):null)&&(a=n.at(0)),this.listFormats.selectRecord(a),this.listFormats.scrollToRecord(a),this.onSelectFormat(this.listFormats,null,a)},onSelectFormat:function(t,e,i){i&&(this.props.put_Format(i.get("format")),this.props.put_Update("checked"==this.chUpdate.getValue()))},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},txtTitle:"Date & Time",textLang:"Language",textFormat:"Formats",textUpdate:"Update automatically",textDefault:"Set as default",confirmDefault:'Set default format for {0}: "{1}"'},DE.Views.DateTimeDialog||{}))})),define("documenteditor/main/app/view/PageMarginsDialog",[],(function(){"use strict";DE.Views.PageMarginsDialog=Common.UI.Window.extend(_.extend({options:{width:404,header:!0,style:"min-width: 404px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">','<tr style="vertical-align: top;">',"<td>",'<div class="float-left">','<label class="font-weight-bold">'+this.textTitle+"</label>",'<div style="margin-top: 2px;">','<div style="display: inline-block;">','<label class="input-label">'+this.textTop+"</label>",'<div id="page-margins-spin-top"></div>',"</div>",'<div class="margin-left-8" style="display: inline-block;">','<label class="input-label">'+this.textBottom+"</label>",'<div id="page-margins-spin-bottom"></div>',"</div>","</div>",'<div style="margin-top: 4px;">','<div style="display: inline-block;">','<label class="input-label" id="margin-left-label">'+this.textLeft+"</label>",'<div id="page-margins-spin-left"></div>',"</div>",'<div class="margin-left-8" style="display: inline-block;">','<label class="input-label" id="margin-right-label">'+this.textRight+"</label>",'<div id="page-margins-spin-right"></div>',"</div>","</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textGutterPosition+"</label>","<div>",'<div style="display: inline-block;" id="page-margins-spin-gutter"></div>','<div style="display: inline-block;" id="page-margins-spin-gutter-position" class="margin-left-8"></div>',"</div>","</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textOrientation+"</label>",'<div id="page-margins-cmb-orientation"></div>',"</div>",'<div style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textMultiplePages+"</label>",'<div id="page-margins-cmb-multiple-pages"></div>',"</div>","</div>","</td>","<td>",'<div class="float-right">','<label class="font-weight-bold">'+this.textPreview+"</label>",'<div id="page-margins-preview" style="margin-top: 2px; height: 120px; width: 162px;"></div>',"</div>","</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.maxMarginsW=this.maxMarginsH=0,this.api=this.options.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnTop=new Common.UI.MetricSpinner({el:$("#page-margins-spin-top"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:-55.87}),this.spnTop.on("change",_.bind((function(t,e,i){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_TopMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#page-margins-spin-bottom"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:-55.87}),this.spnBottom.on("change",_.bind((function(t,e,i){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#page-margins-spin-left"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnLeft.on("change",_.bind((function(t,e,i){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#page-margins-spin-right"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnRight.on("change",_.bind((function(t,e,i){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_RightMargin(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.spinners.push(this.spnRight),this.spnGutter=new Common.UI.MetricSpinner({el:$("#page-margins-spin-gutter"),step:.1,width:86,defaultUnit:"cm",value:"1 cm",maxValue:55.88,minValue:0}),this.spnGutter.on("change",_.bind((function(t,e,i){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_Gutter(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.spinners.push(this.spnGutter),this.cmbGutterPosition=new Common.UI.ComboBox({el:$("#page-margins-spin-gutter-position"),menuStyle:"min-width: 86px;",style:"width: 86px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textLeft},{value:1,displayValue:this.textTop}]}),this.cmbGutterPosition.on("selected",_.bind((function(t,e){this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_GutterAtTop(e.value),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.cmbOrientation=new Common.UI.ComboBox({el:$("#page-margins-cmb-orientation"),menuStyle:"min-width: 180px;",style:"width: 180px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textPortrait},{value:1,displayValue:this.textLandscape}]}),this.cmbOrientation.on("selected",_.bind((function(t,e){if(this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.get_Orientation()!==e.value)){this.properties.put_TopMargin(Common.Utils.Metric.fnRecalcToMM(e.value?this.spnLeft.getNumberValue():this.spnRight.getNumberValue())),this.properties.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM(e.value?this.spnRight.getNumberValue():this.spnLeft.getNumberValue())),this.properties.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM(e.value?this.spnBottom.getNumberValue():this.spnTop.getNumberValue())),this.properties.put_RightMargin(Common.Utils.Metric.fnRecalcToMM(e.value?this.spnTop.getNumberValue():this.spnBottom.getNumberValue()));var i=this.properties.get_H();this.properties.put_H(this.properties.get_W()),this.properties.put_W(i),this.properties.put_Orientation(e.value),this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(this.properties.get_H()-2.6),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(this.properties.get_W()-12.7),this.spnTop.setMaxValue(this.maxMarginsH),this.spnBottom.setMaxValue(this.maxMarginsH),this.spnLeft.setMaxValue(this.maxMarginsW),this.spnRight.setMaxValue(this.maxMarginsW),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_TopMargin()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_BottomMargin()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_LeftMargin()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(this.properties.get_RightMargin()),!0),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties)}}),this)),this.cmbMultiplePages=new Common.UI.ComboBox({el:$("#page-margins-cmb-multiple-pages"),menuStyle:"min-width: 180px;",style:"width: 180px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textNormal},{value:1,displayValue:this.textMirrorMargins}]}),this.cmbMultiplePages.on("selected",_.bind((function(t,e){0===e.value?(this.window.find("#margin-left-label").html(this.textLeft),this.window.find("#margin-right-label").html(this.textRight),this.cmbGutterPosition.setDisabled(!1)):(this.window.find("#margin-left-label").html(this.textInside),this.window.find("#margin-right-label").html(this.textOutside),this.cmbGutterPosition.setValue(0),this.cmbGutterPosition.setDisabled(!0)),this.api&&(this.properties=this.properties?this.properties:new Asc.CDocumentSectionProps,this.properties.put_MirrorMargins(e.value),this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties))}),this)),this.window=this.getChild(),this.window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.spnTop,this.spnBottom,this.spnLeft,this.spnRight,this.spnGutter,this.cmbGutterPosition,this.cmbOrientation,this.cmbMultiplePages].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnTop},onAnimateAfter:function(){this.api&&this.properties&&this.api.SetDrawImagePreviewMargins("page-margins-preview",this.properties)},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=null;if(this.spnLeft.getNumberValue()+this.spnRight.getNumberValue()+(this.cmbGutterPosition.getValue()?0:this.spnGutter.getNumberValue())>this.maxMarginsW?e=this.txtMarginsW:Math.abs(this.spnTop.getNumberValue()+this.spnBottom.getNumberValue()+(this.cmbGutterPosition.getValue()?this.spnGutter.getNumberValue():0))>this.maxMarginsH&&(e=this.txtMarginsH),e)return void Common.UI.warning({title:this.notcriticalErrorTitle,msg:e})}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},setSettings:function(t){if(t){this.properties=t,this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(t.get_H()-2.6),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(t.get_W()-12.7),this.spnTop.setMaxValue(this.maxMarginsH),this.spnBottom.setMaxValue(this.maxMarginsH),this.spnLeft.setMaxValue(this.maxMarginsW),this.spnRight.setMaxValue(this.maxMarginsW),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_TopMargin()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_BottomMargin()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_LeftMargin()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_RightMargin()),!0),this.cmbOrientation.setValue(t.get_Orientation()),this.spnGutter.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_Gutter()),!0),this.cmbGutterPosition.setValue(t.get_GutterAtTop()?1:0);var e=t.get_MirrorMargins();this.cmbMultiplePages.setValue(e?1:0),e&&(this.window.find("#margin-left-label").html(this.textInside),this.window.find("#margin-right-label").html(this.textOutside),this.cmbGutterPosition.setValue(0)),this.cmbGutterPosition.setDisabled(e)}},getSettings:function(){var t=new Asc.CDocumentSectionProps;return t.put_TopMargin(Common.Utils.Metric.fnRecalcToMM(this.spnTop.getNumberValue())),t.put_BottomMargin(Common.Utils.Metric.fnRecalcToMM(this.spnBottom.getNumberValue())),t.put_LeftMargin(Common.Utils.Metric.fnRecalcToMM(this.spnLeft.getNumberValue())),t.put_RightMargin(Common.Utils.Metric.fnRecalcToMM(this.spnRight.getNumberValue())),t.put_Orientation(this.cmbOrientation.getValue()),t.put_Gutter(Common.Utils.Metric.fnRecalcToMM(this.spnGutter.getNumberValue())),t.put_GutterAtTop(!!this.cmbGutterPosition.getValue()),t.put_MirrorMargins(!!this.cmbMultiplePages.getValue()),t.put_H(this.properties.get_H()),t.put_W(this.properties.get_W()),t},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},textTitle:"Margins",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",notcriticalErrorTitle:"Warning",txtMarginsW:"Left and right margins are too high for a given page wight",txtMarginsH:"Top and bottom margins are too high for a given page height",textMultiplePages:"Multiple pages",textGutter:"Gutter",textGutterPosition:"Gutter position",textOrientation:"Orientation",textPreview:"Preview",textPortrait:"Portrait",textLandscape:"Landscape",textMirrorMargins:"Mirror margins",textNormal:"Normal",textInside:"Inside",textOutside:"Outside"},DE.Views.PageMarginsDialog||{}))})),define("documenteditor/main/app/view/PageSizeDialog",[],(function(){"use strict";DE.Views.PageSizeDialog=Common.UI.Window.extend(_.extend({options:{width:215,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-size",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">','<label class="input-label">'+this.textPreset+"</label>",'<div id="page-size-combo-preset" class="input-group-nr" style="margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-right-10">','<label class="input-label">'+this.textWidth+"</label>",'<div id="page-size-spin-width"></div>',"</td>","<td>",'<label class="input-label">'+this.textHeight+"</label>",'<div id="page-size-spin-height"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.isOrientPortrait=!0,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnWidth=new Common.UI.MetricSpinner({el:$("#page-size-spin-width"),step:.1,width:86,defaultUnit:"cm",value:"10 cm",maxValue:118.9,minValue:0}),this.spinners.push(this.spnWidth),this.spnWidth.on("change",_.bind((function(t,e,i,n){!this._noApply&&this.cmbPreset.getValue()>-1&&this.cmbPreset.setValue(-1)}),this)),this.spnHeight=new Common.UI.MetricSpinner({el:$("#page-size-spin-height"),step:.1,width:86,defaultUnit:"cm",value:"20 cm",maxValue:118.9,minValue:0}),this.spinners.push(this.spnHeight),this.spnHeight.on("change",_.bind((function(t,e,i,n){!this._noApply&&this.cmbPreset.getValue()>-1&&this.cmbPreset.setValue(-1)}),this)),this.cmbPreset=new Common.UI.ComboBox({el:$("#page-size-combo-preset"),cls:"input-group-nr",menuStyle:"min-width: 183px;max-height: 208px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{value:0,displayValue:"US Letter",size:[215.9,279.4]},{value:1,displayValue:"US Legal",size:[215.9,355.6]},{value:2,displayValue:"A4",size:[210,297]},{value:3,displayValue:"A5",size:[148,210]},{value:4,displayValue:"B5",size:[176,250]},{value:5,displayValue:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:"Envelope DL",size:[110,220]},{value:7,displayValue:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:"A3",size:[297,420]},{value:9,displayValue:"Tabloid Oversize",size:[296.9,457.2]},{value:10,displayValue:"ROC 16K",size:[196.8,273]},{value:11,displayValue:"Envelope Choukei 3",size:[120,235]},{value:12,displayValue:"Super B/A3",size:[305,487]},{value:13,displayValue:"A0",size:[841,1189]},{value:14,displayValue:"A1",size:[594,841]},{value:16,displayValue:"A2",size:[420,594]},{value:17,displayValue:"A6",size:[105,148]},{value:-1,displayValue:this.txtCustom,size:[]}]}),this.cmbPreset.setValue(-1),this.cmbPreset.on("selected",_.bind((function(t,e){if(this._noApply=!0,e.value<0);else{var i=Common.Utils.Metric.fnRecalcFromMM(this.isOrientPortrait?e.size[0]:e.size[1]),n=Common.Utils.Metric.fnRecalcFromMM(this.isOrientPortrait?e.size[1]:e.size[0]);(i<this.spnWidth.getMinValue()||n<this.spnHeight.getMinValue())&&this.cmbPreset.setValue(-1),this.spnWidth.setValue(i,!0),this.spnHeight.setValue(n,!0)}this._noApply=!1}),this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.cmbPreset,this.spnWidth,this.spnHeight].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbPreset},_handleInput:function(t){if(this.options.handler){if("ok"==t&&this.options.checkPageSize){var e=this.getSettings();if(this.options.checkPageSize(e[0],e[1]))return}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},setSettings:function(t){if(t){this.isOrientPortrait=t.get_W()<t.get_H(),this.spnWidth.setMinValue(Common.Utils.Metric.fnRecalcFromMM(t.get_LeftMargin()+t.get_RightMargin()+12.7)),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_W()),!0),this.spnHeight.setMinValue(Common.Utils.Metric.fnRecalcFromMM(t.get_TopMargin()+t.get_BottomMargin()+2.6)),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_H()),!0);var e=this.isOrientPortrait?t.get_W():t.get_H(),i=this.isOrientPortrait?t.get_H():t.get_W(),n=this.cmbPreset.store.find((function(t){var n=t.get("size");return Math.abs(n[0]-e)<.1&&Math.abs(n[1]-i)<.1}));this.cmbPreset.setValue(n?n.get("value"):-1)}},getSettings:function(){return[Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue()),Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())]},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},textTitle:"Page Size",textWidth:"Width",textHeight:"Height",textPreset:"Preset",txtCustom:"Custom"},DE.Views.PageSizeDialog||{}))})),define("documenteditor/main/app/view/CustomColumnsDialog",[],(function(){"use strict";DE.Views.CustomColumnsDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-custom-columns",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">','<label class="input-label">'+this.textColumns+'</label><div id="custom-columns-spin-num" class="float-right"></div>',"</div>",'<div id="custom-columns-list" style="width:100%; height: 122px;"></div>','<div class="input-row" style="margin: 10px 0;">','<div id="custom-columns-equal-width"></div>',"</div>",'<div class="input-row">','<div id="custom-columns-separator"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.totalWidth=558.7,this.minWidthCol=10,this.defaultSpacing=12.5,this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.spnColumns=new Common.UI.MetricSpinner({el:$("#custom-columns-spin-num"),step:1,allowDecimal:!1,width:45,defaultUnit:"",value:1,maxValue:30,minValue:1,maskExp:/[0-9]/}),this.spnColumns.on("change",(function(e,i,n,s){var o=parseInt(i),a=t.columnsList.store.length,l=o>a,r="checked"==t.chEqualWidth.getValue(),c=[];if(0!=a&&o!=a){if(r){var d=1==a?t.defaultSpacing:t.columnsList.store.at(0).get("spacing"),h=(t.totalWidth-d*(o-1))/o;h<t.minWidthCol&&(h=t.minWidthCol,d=(t.totalWidth-h*o)/(o-1));for(var p=0;p<o;p++)c.push({width:h,spacing:d})}else{for(var m=0,u=(t.columnsList.store.at(a-1).get("width")+(a>1?t.columnsList.store.at(a-2).get("spacing"):0))/t.totalWidth,g=[1],b=(p=0,t.defaultSpacing);p<o;p++){var _=0;if(p<o-1){if(p<a-1)_=(a>1?t.columnsList.store.at(p).get("spacing"):t.defaultSpacing)/(u*o+1-a*u);else _=b;b=_}g[p]=p<a?t.columnsList.store.at(p).get("width")/t.columnsList.store.at(0).get("width"):g[a-1],c.push({spacing:_}),m+=_}var C=(t.totalWidth-m)/g.reduce((function(t,e){return t+e}));for(p=0;p<o;p++)c[p].width=C*g[p]}t.updateColumnsList(c),t.setMaxValueSpinsForColumns(),l||r||t.setMaxColumns(),t.chEqualWidth.setDisabled(o<2),t.chSeparator.setDisabled(o<2)}})),this.columnsList=new Common.UI.ListView({el:$("#custom-columns-list",this.$window),store:new Common.UI.DataViewStore,showLast:!1,handleSelect:!1,tabindex:0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),headers:[{name:"#",width:26},{name:this.textWidth,width:115},{name:this.textTitleSpacing,width:113}],itemTemplate:_.template(['<div id="custom-columns-list-item-<%= index %>" class="list-item" style="display:flex; align-items:center; width=100%;">','<label class="level-caption padding-right-5" style="flex-shrink:0; width:20px;"><%= index + 1 %></label>','<div style="display:inline-block;flex-grow: 1;">','<div style="padding: 0 5px;display: inline-block;vertical-align: top;"><div id="custom-columns-list-item-spin-width-<%= index %>" class="input-group-nr" style=""></div></div>','<div style="padding: 0 5px;display: inline-block;vertical-align: top;"><div id="custom-columns-list-item-spin-spacing-<%= index %>" class="input-group-nr"></div></div>',"</div>","</div>"].join(""))}),this.columnsList.on("item:add",_.bind(this.addControls,this)),this.chEqualWidth=new Common.UI.CheckBox({el:$("#custom-columns-equal-width"),labelText:this.textEqualWidth}).on("change",(function(e,i,n){t.lockSpinsForEqualColumns("checked"==i),"checked"==i&&t.setEqualWidthColumns(),t.columnsList.store.length>0&&(t.setMaxColumns(),t.setMaxValueSpinsForColumns())})),this.chSeparator=new Common.UI.CheckBox({el:$("#custom-columns-separator"),labelText:this.textSeparator}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.spnColumns,this.chEqualWidth,this.chSeparator].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnColumns},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){if(t){var e=t.get_EqualWidth(),i=e?t.get_Num():t.get_ColsCount(),n=t.get_TotalWidth(),s=[];this.totalWidth=n,this.spnColumns.setValue(i,!0);for(var o=e&&i>1?this.calcWidthForEqualColumns(i,t.get_Space()):n,a=0;a<i;a++)if(!e&&i>1){var l=t.get_Col(a);s.push({width:l.get_W(),spacing:l.get_Space()}),l.get_W()<this.minWidthCol&&(this.minWidthCol=l.get_W())}else s.push({width:o,spacing:t.get_Space()});this.chEqualWidth.setValue(e,!0),this.chEqualWidth.setDisabled(i<2),this.chSeparator.setValue(t.get_Sep()),this.chSeparator.setDisabled(i<2),this.updateColumnsList(s),this.setMaxColumns(),this.setMaxValueSpinsForColumns()}},getSettings:function(){var t=new Asc.CDocumentColumnsProps;return t.put_Num(this.spnColumns.getNumberValue()),t.put_Space(this.columnsList.store.at(0).get("spacing")),t.put_EqualWidth("checked"==this.chEqualWidth.getValue()),t.put_Sep("checked"==this.chSeparator.getValue()),"checked"!=this.chEqualWidth.getValue()&&this.columnsList.store.each((function(e,i){t.put_ColByValue(i,e.get("width"),e.get("spacing"))})),t},updateColumnsList:function(t){var e=t.map((function(e,i){return{index:i,allowSelected:!1,width:e.width,spacing:i!=t.length-1?e.spacing:0,widthSpin:null,spacingSpin:null}}));this.columnsList.store.reset(e)},setMaxColumns:function(){var t=Math.floor(this.totalWidth/this.minWidthCol);if("checked"==this.chEqualWidth.getValue())this.spnColumns.setMaxValue(t);else{var e=this,i=e.columnsList.store.length,n=null,s=[];if(i>1){for(var o=0;o<i;o++)s[o]=e.columnsList.store.at(o).get("width")/e.columnsList.store.at(0).get("width");n=(e.columnsList.store.at(i-1).get("width")+e.columnsList.store.at(i-2).get("spacing"))/e.totalWidth}else i=2,s=[1,1],n=(e.totalWidth-e.defaultSpacing)/(2*e.totalWidth);var a=_.min(s),l=(s=s.map((function(t){return t/a}))).pop()*e.minWidthCol,r=s.reduce((function(t,e){return t+e}))*e.minWidthCol,c=e.columnsList.store.length>1?e.columnsList.store.at(i-2).get("spacing"):e.defaultSpacing,d=0;e.columnsList.store.each((function(t,i){i<e.columnsList.store.length-2&&(d+=t.get("spacing"))}));var h=n*l,p=(1-i*n)*l-n*this.totalWidth+n*r+(1-i)*n*l+c,m=-this.totalWidth*(1-i*n)+r*(1-i*n)+l*(1-i)*(1-i*n)+d+c*(1-i),u=(Math.sqrt(p*p-4*h*m)-p)/(2*h);this.spnColumns.setMaxValue(Math.floor(u+.01))}},lockSpinsForEqualColumns:function(t){var e=this.columnsList.store.length;this.columnsList.store.each((function(i,n){i.get("widthSpin").setDisabled(t),i.get("spacingSpin").setDisabled(0!=n&&t||n==e-1)}))},calcWidthForEqualColumns:function(t,e){return(this.totalWidth-(t-1)*e)/t},setEqualWidthColumns:function(){if(0!=this.columnsList.store.length){var t=this,e=this.spnColumns.getNumberValue(),i=this.columnsList.store.at(0).get("spacing"),n=this.calcWidthForEqualColumns(e,i);n<this.minWidthCol&&(n=this.minWidthCol+1e-4,i=e>1?(this.totalWidth-e*n)/(e-1):0),this.columnsList.store.each((function(s,o){t.setWidthColumnValue(s,n),o!=e-1&&t.setSpacingColumnValue(s,i)}))}},setWidthColumnValue:function(t,e){var i=t.get("widthSpin"),n=Common.Utils.Metric.fnRecalcFromMM(e);t.set("width",e,{silent:!0}),i.getMaxValue()<n&&i.setMaxValue(this.decimalRouding(n)),i.setValue(n,!0)},setSpacingColumnValue:function(t,e){t.set("spacing",e,{silent:!0}),t.get("spacingSpin").setValue(Common.Utils.Metric.fnRecalcFromMM(e),!0)},setMaxValueSpinsForColumns:function(){if("checked"==this.chEqualWidth.getValue()){var t=this.columnsList.store.at(0),e=this.columnsList.store.length,i=this.minWidthCol,n=e>1?Common.Utils.Metric.fnRecalcFromMM((this.totalWidth-e*i)/(e-1)):0;t.get("widthSpin").setMaxValue(1e6),t.get("spacingSpin").setMaxValue(e>1?this.decimalRouding(n):0)}else{var s=this,o=(e=this.columnsList.store.length,Common.Utils.Metric.fnRecalcFromMM(this.totalWidth-this.minWidthCol*(e-1)));n=Common.Utils.Metric.fnRecalcFromMM(this.totalWidth-this.minWidthCol*e);this.columnsList.store.each((function(t){t.get("widthSpin").setMaxValue(s.decimalRouding(o)),t.get("spacingSpin").setMaxValue(s.decimalRouding(n))}))}},decimalRouding:function(t,e){var i=Math.pow(10,e||2);return Math.round(t*i)/i},setNewValueSpinsForColumns:function(t,e,i){var n=this,s=[],o=[],a=0;if(s=l("width",t+1,n.columnsList.store.length),"width"==i){if(0!=e&&(o=l("spacing",0,n.columnsList.store.length-1)),0!=e)l("width",0,t).forEach((function(t,e){s[e]=t}))}else{if(0!=e)l("width",0,t+1).forEach((function(t,e){s[e]=t}));0!=e&&(o=l("spacing",0,n.columnsList.store.length-1,t))}function l(t,i,s,o){for(var l=function(t,e,i,s,o){null==s&&(s=!1);for(var a=[],l=e;l<i;l++)if(void 0===o||o!=l){var r=n.columnsList.store.at(l).get(t);("width"==t&&(s||r>n.minWidthCol)||"spacing"==t&&r>0)&&(void 0===c&&(c=l),a[l]=r/n.columnsList.store.at(c).get(t))}if(s&&0==a.length){var c;for(l=e;l<i;l++)a[l]=1}return a}(t,i,s,e<0,o),r="width"==t?n.minWidthCol:0,c=[];l.length>0&&l.reduce((function(t,e){return t+(e?1:0)}))>0&&0!=e;){a=e/l.reduce((function(t,e){return t+e}));for(var d=i;d<s;d++)if(l[d]&&(void 0===o||o!=d)){var h=a*l[d],p=void 0!==c[d]?c[d]:n.columnsList.store.at(d).get(t),m=p-h;m<r&&(h=p-r,m=r,l[d]=0),c[d]=m,e-=h}e=n.decimalRouding(e,6)}return c}s.forEach((function(t,e){n.setWidthColumnValue(n.columnsList.store.at(e),t)})),o.forEach((function(t,e){n.setSpacingColumnValue(n.columnsList.store.at(e),t)}))},addControls:function(t,e,i){if(i){var n=this,s=i.get("index"),o=s===n.columnsList.store.length-1,a="checked"==n.chEqualWidth.getValue(),l=Common.Utils.Metric.getCurrentMetricName(),r=new Common.UI.MetricSpinner({el:$("#custom-columns-list-item-spin-width-"+s),step:Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1,width:105,tabindex:1,defaultUnit:l,value:n.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(i.get("width")))+" "+l,maxValue:120,minValue:n.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(n.minWidthCol)),disabled:a||0==s&&o}).on("change",(function(t,e,o,a){var l=Common.Utils.Metric.fnRecalcToMM(parseFloat(e)-Common.Utils.Metric.fnRecalcFromMM(i.get("width")).toFixed(2));i.set("width",i.get("width")+l,{silent:!0}),n.setNewValueSpinsForColumns(s,l,"width"),n.setMaxColumns()})),c=new Common.UI.MetricSpinner({el:$("#custom-columns-list-item-spin-spacing-"+s),step:Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1,width:105,tabindex:1,defaultUnit:l,value:o?"":this.decimalRouding(Common.Utils.Metric.fnRecalcFromMM(i.get("spacing")))+" "+l,maxValue:120,minValue:0,disabled:a&&0!=s||o}).on("change",(function(t,e,o,a){var l=Common.Utils.Metric.fnRecalcToMM(parseFloat(e)-Common.Utils.Metric.fnRecalcFromMM(i.get("spacing")).toFixed(2));i.set("spacing",i.get("spacing")+l,{silent:!0}),"checked"==n.chEqualWidth.getValue()?n.setEqualWidthColumns():n.setNewValueSpinsForColumns(s,l,"spacing"),n.setMaxColumns()}));i.set("widthSpin",r,{silent:!0}),i.set("spacingSpin",c,{silent:!0})}},textTitle:"Columns",textColumns:"Number of columns",textWidth:"Width",textTitleSpacing:"Spacing",textEqualWidth:"Equal column width",textSeparator:"Column divider"},DE.Views.CustomColumnsDialog||{}))})),define("documenteditor/main/app/view/ListTypesAdvanced",[],(function(){"use strict";DE.Views.ListTypesAdvanced=Common.UI.Window.extend(_.extend({options:{header:!1,width:250,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-advanced-list-type"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),this.lang=this.options.lang,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var e=[],i=this;Asc.c_oAscAllNumberingTypes&&Asc.c_oAscAllNumberingTypes.forEach((function(t){e.push({displayValue:AscCommon.IntToNumberFormat(1,t,i.lang)+", "+AscCommon.IntToNumberFormat(2,t,i.lang)+", "+AscCommon.IntToNumberFormat(3,t,i.lang)+",...",value:t})})),this.cmbTypes=new Common.UI.ComboBox({el:t.find("#id-advanced-list-type"),cls:"input-group-nr",menuStyle:"min-width: 100%; max-height: 190px;",data:e,editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0}),this.cmbTypes.scroller&&this.cmbTypes.scroller.update({alwaysVisibleY:!0});var n=void 0!==this.options.current?this.cmbTypes.store.findWhere({value:this.options.current}):null;this.cmbTypes.setValue(n?n.value:Asc.c_oAscNumberingFormat.Decimal);i=this;setTimeout((function(){i.cmbTypes.focus()}),100)},getFocusedComponents:function(){return[this.cmbTypes].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbTypes},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbTypes.getValue()),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbTypes.getValue()),this.close(),!1},labelSelect:"Select list type"},DE.Views.ListTypesAdvanced||{}))})),void 0===Common)Common={};define("documenteditor/main/app/view/ListSettingsDialog",["documenteditor/main/app/view/ListTypesAdvanced"],(function(){"use strict";DE.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:320,style:"min-width: 240px;",cls:"modal-dlg",split:!1,buttons:null},initialize:function(t){this.type=t.type||0,this.extended=!0,this.rightPanelWidth=210,_.extend(this.options,{title:this.txtTitle,width:2===this.type?415+(this.extended?this.rightPanelWidth:0):320},t||{}),this.template=['<table style="width:100%;" class="">',"<tr>",'<td style="vertical-align: top;">','<div class="box list-settings">',"<% if (type == 2) { %>",'<table style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width: 100%;">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 115px;margin-bottom: 10px;"></div>',"</td>","</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-numbering-bold" style="margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-numbering-italic" style="margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-bullet-color" style="margin-bottom: 10px;"></div>',"</td>","</tr>","</table>",'<table style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width: 100%;">','<label class="input-label">'+this.txtNumFormatString+"</label>",'<div id="id-dlg-numbering-format-str" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label"></label>','<div id="id-dlg-btn-more" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","<% } else if (type == 0) {%>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtAlign+"</label>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label" style="display: block;">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 139px;display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-bold" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-italic" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-bullet-color" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>',"</td>","</tr>","</table>","<% } else { %>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label">'+this.txtType+"</label>",'<div id="id-dlg-numbering-format" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtAlign+"</label>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="width: 100%;">','<label class="input-label">'+this.txtNumFormatString+"</label>",'<div id="id-dlg-numbering-format-str" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5">','<label class="input-label" style="display: block;">'+this.txtFontName+"</label>",'<div id="id-dlg-numbering-font-name" style="display: inline-block;width: 90px;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-bold" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-numbering-italic" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>','<div id="id-dlg-bullet-color" class="margin-left-4" style="display: inline-block;margin-bottom: 10px;vertical-align: middle;"></div>',"</td>",'<td class="padding-left-5">','<label class="input-label">'+this.txtSize+"</label>",'<div id="id-dlg-bullet-size" class="input-group-nr" style="width: 85px;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","<% } %>",'<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">',"<label>"+(2===this.type?this.textSelectLevel:this.textPreview)+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10 <% if (type != 2) { %> hidden <% } %>" style="width: 50px;vertical-align: top;">','<div id="levels-list" class="no-borders" style="width:100%; height:235px;"></div>',"</td>","<td>",'<div id="bulleted-list-preview" style="height:'+(2===this.type?235:208)+'px;"></div>',"</td>","</tr>","</table>","</div>",'<div class="footer center">','<button class="btn normal dlg-btn primary" result="ok" style="width: 86px;">'+this.okButtonText+"</button>",'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>","</div>","</td>","<% if (type == 2) { %>",'<td style="width: '+this.rightPanelWidth+'px;vertical-align: top;">','<div id="id-dlg-panel-more-settings" class="padding-left-5 padding-right-15" style="width: '+this.rightPanelWidth+'px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">','<label class="input-label" style="display: block;">'+this.txtFontName+"</label>",'<div id="id-dlg-numbering-font-name" style="display: inline-block;width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtInclcudeLevel+"</label>",'<div id="id-dlg-numbering-format-lvl" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtStart+"</label>",'<div id="id-dlg-numbering-spin-start" style="width: 100%;margin-bottom: 5px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<div id="id-dlg-numbering-restart" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+this.txtAlign+"</label>","</td>",'<td class="padding-left-5" style="vertical-align:bottom;">','<label class="input-label">'+this.txtAlignAt+"</label>","</td>","</tr>","<tr>","<td>",'<div id="id-dlg-bullet-align" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5">','<div id="id-dlg-numbering-align-at" style="width: 100%;min-width40px;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtIndent+"</label>",'<div id="id-dlg-numbering-indent" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+this.txtFollow+"</label>",'<div id="id-dlg-numbering-follow" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<div id="id-dlg-chk-tabstop" class="input-group-nr" style="width: 100%;margin-bottom: 3px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-left-22">','<div id="id-dlg-num-tabstop" style="width: 100%;"></div>',"</td>","</tr>","</table>","</div>","</td>","<% } %>","</tr>","</table>"].join(""),this.props=t.props,this.level=t.level||0,this.api=t.api,this.fontStore=t.fontStore,this.fontName="",this.options.tpl=_.template(this.template)(this.options),this.levels=[],this.formatString={selectionStart:0,selectionEnd:0,text:"",lvlIndexes:[]},this.spinners=[],this.recentBullets=[],this.recentNumTypes=[],this.lang=this.api.asc_GetPossibleNumberingLanguage(),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.btnColor=new Common.UI.ButtonColored({parentEl:e.find("#id-dlg-bullet-color"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.txtColor,menu:!0,takeFocusOnClose:!0,additionalItemsBefore:[{id:"id-dlg-bullet-text-color",caption:this.txtLikeText,checkable:!0,toggleGroup:"list-settings-color",style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"},{id:"id-dlg-bullet-auto-color",caption:this.textAuto,checkable:!0,toggleGroup:"list-settings-color",style:Common.UI.isRTL()?"padding-right:20px;":"padding-left:20px;"},{caption:"--"}],additionalAlign:this.menuAddAlign}),this.btnColor.setMenu(),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.btnColor.menu.items[0].on("toggle",_.bind(this.onLikeTextColor,this)),this.btnColor.menu.items[1].on("toggle",_.bind(this.onAutoColor,this)),this.colors=this.btnColor.getPicker();var i=["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<%= item.displayValue %><% if (item.value === Asc.c_oAscNumberingFormat.Bullet) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span><% } %>',"</a></li>","<% }); %>"],n=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(i).concat(["</ul>","</div>"]);this._arrNumbers=[{displayValue:"1, 2, 3,...",value:Asc.c_oAscNumberingFormat.Decimal},{displayValue:"a, b, c,...",value:Asc.c_oAscNumberingFormat.LowerLetter},{displayValue:"A, B, C,...",value:Asc.c_oAscNumberingFormat.UpperLetter},{displayValue:"i, ii, iii,...",value:Asc.c_oAscNumberingFormat.LowerRoman},{displayValue:"I, II, III,...",value:Asc.c_oAscNumberingFormat.UpperRoman}],"ru"===Common.Locale.getDefaultLanguage()&&(this._arrNumbers=this._arrNumbers.concat([{displayValue:", , ,...",value:Asc.c_oAscNumberingFormat.RussianLower},{displayValue:", , ,...",value:Asc.c_oAscNumberingFormat.RussianUpper}])),this._arrBullets=[{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Symbol"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Symbol"},{displayValue:this.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:"",font:"Arial"}],this._itemNoneBullet={displayValue:this.txtNone,value:Asc.c_oAscNumberingFormat.None},this._itemNewBullet={displayValue:this.txtNewBullet,value:-1},this._itemMoreTypes={displayValue:this.txtMoreTypes,value:-2},this.loadRecent(),this.cmbFormat=new Common.UI.ComboBoxCustom({el:e.find("#id-dlg-numbering-format"),menuStyle:"min-width: 100%;max-height: 220px;",style:2===this.type?"width: 100%;":"width: 139px;",editable:!1,template:_.template(n.join("")),itemsTemplate:_.template(i.join("")),takeFocusOnClose:!0,data:[],updateFormControl:function(t,e){var i=$(this.el).find(".form-control");t?t.get("value")==Asc.c_oAscNumberingFormat.Bullet?i[0].innerHTML=t.get("displayValue")+'<span style="font-family:'+(t.get("font")||"Arial")+'">'+t.get("symbol")+"</span>":i[0].innerHTML=t.get("displayValue"):i[0].innerHTML=e||""}}),this.cmbFormat.on("selected",_.bind((function(e,i){if(this._changedProps)if(-1==i.value){var n=function(e){t.fillLevelProps(t.levels[t.level])};this.addNewBullet(n)}else if(-2==i.value){n=function(e){t.fillLevelProps(t.levels[t.level])};this.addNewListType(n)}else{var s=this._changedProps.get_Format();if(this._changedProps.put_Format(i.value),i.value==Asc.c_oAscNumberingFormat.Bullet)this.bulletProps.font=i.font?i.font:void 0,this.bulletProps.symbol=i.symbol,this._changedProps.put_FontFamily(this.bulletProps.font),this._changedProps.put_Text([new Asc.CAscNumberingLvlText]),this._changedProps.get_Text()[0].put_Value(this.bulletProps.symbol);else if(s==Asc.c_oAscNumberingFormat.Bullet)this._changedProps.put_FontFamily(void 0),this._changedProps.put_Text([new Asc.CAscNumberingLvlText]),this._changedProps.get_Text()[0].put_Type(Asc.c_oAscNumberingLvlTextType.Num),this._changedProps.get_Text()[0].put_Value(this.level);else if(s==Asc.c_oAscNumberingFormat.None&&!this.formatString.lvlIndexes[this.level][this.level]){var o=this.txtNumFormat.$el.find("input")[0].selectionStart;this._changedProps.get_Text().splice(o,0,new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Num,this.level))}this.fillLevelProps(this.levels[this.level])}this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.cmbAlign=new Common.UI.ComboBox({el:e.find("#id-dlg-bullet-align"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:AscCommon.align_Left,displayValue:this.textLeft},{value:AscCommon.align_Center,displayValue:this.textCenter},{value:AscCommon.align_Right,displayValue:this.textRight}],takeFocusOnClose:!0}),this.cmbAlign.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.put_Align(e.value),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.cmbSize=new Common.UI.ComboBox({el:e.find("#id-dlg-bullet-size"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,cls:"input-group-nr",data:[{value:-1,displayValue:this.txtLikeText},{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}],takeFocusOnClose:!0}),this.cmbSize.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.put_FontSize(e.value>0?e.value:void 0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this));for(var s=[],o=0;o<9;o++)s.push({value:o});this.levelsList=new Common.UI.ListView({el:$("#levels-list",this.$window),store:new Common.UI.DataViewStore(s),tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;line-height: 15px;"><%= (value+1) %></div>')}),this.levelsList.on("item:select",_.bind(this.onSelectLevel,this)),this.txtNumFormat=new Common.UI.InputField({el:e.find("#id-dlg-numbering-format-str"),allowBlank:!0,value:""});var a=this.txtNumFormat.$el.find("input");a.on("keydown",_.bind(this.onKeyDown,this)),a.on("keyup",_.bind(this.onKeyUp,this)),a.on("input",_.bind(this.onFormatInput,this));var l=function(e){t.checkMousePosition(a[0]),$(document).off("mouseup",l)};a.on("mousedown",_.bind((function(t){$(document).on("mouseup",l)}),this)),a.on("contextmenu",(function(t){return t.preventDefault(),t.stopPropagation(),!1})),this.cmbLevel=new Common.UI.ComboBox({el:e.find("#id-dlg-numbering-format-lvl"),menuStyle:"min-width: 100%;",style:"width: 100%;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.cmbLevel.on("selected",_.bind(this.onIncludeLevelSelected,this)),this.spnStart=new Common.UI.MetricSpinner({el:e.find("#id-dlg-numbering-spin-start"),step:1,width:"100%",defaultUnit:"",value:1,maxValue:16383,minValue:1,allowDecimal:!1}),this.spnStart.on("change",_.bind((function(t,e,i,n){this._changedProps&&(this._changedProps.put_Start(t.getNumberValue()),this.makeFormatStr(this._changedProps)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.cmbFonts=new Common.UI.ComboBoxFonts({el:e.find("#id-dlg-numbering-font-name"),cls:"input-group-nr",style:"width: 100%;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName,takeFocusOnClose:!0}).on("selected",_.bind(this.onFontName,this)),this.btnBold=new Common.UI.Button({parentEl:e.find("#id-dlg-numbering-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.btnBold.on("click",_.bind(this.onBoldClick,this)),this.btnItalic=new Common.UI.Button({parentEl:e.find("#id-dlg-numbering-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.btnItalic.on("click",_.bind(this.onItalicClick,this)),this.spnAlign=new Common.UI.MetricSpinner({el:e.findById("#id-dlg-numbering-align-at"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnAlign),this.spnAlign.on("change",_.bind((function(t,e,i,n){this._changedProps&&(this._changedProps.put_NumberPosition(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.spnTabStop.setMinValue(t.getNumberValue()),this.spnTabStop.setValue(this.spnTabStop.getValue(),!0)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.spnIndents=new Common.UI.MetricSpinner({el:e.findById("#id-dlg-numbering-indent"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnIndents),this.spnIndents.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_IndentSize(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.cmbFollow=new Common.UI.ComboBox({el:e.find("#id-dlg-numbering-follow"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscNumberingSuff.Tab,displayValue:this.textTab},{value:Asc.c_oAscNumberingSuff.Space,displayValue:this.textSpace},{value:Asc.c_oAscNumberingSuff.None,displayValue:this.txtNone}],takeFocusOnClose:!0}),this.cmbFollow.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.put_Suff(e.value),this.chTabStop.setDisabled(e.value!==Asc.c_oAscNumberingSuff.Tab),this.spnTabStop.setDisabled(e.value!==Asc.c_oAscNumberingSuff.Tab||"checked"!==this.chTabStop.getValue()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.chRestart=new Common.UI.CheckBox({el:e.find("#id-dlg-numbering-restart"),labelText:this.txtRestart}),this.chRestart.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_Restart("checked"==t.getValue()?-1:0)}),this)),this.chTabStop=new Common.UI.CheckBox({el:e.find("#id-dlg-chk-tabstop"),labelText:this.txtTabStop}),this.chTabStop.on("change",_.bind((function(t,e,i,n){this._changedProps&&(this._changedProps.put_StopTab("checked"===t.getValue()?Common.Utils.Metric.fnRecalcToMM(this.spnTabStop.getNumberValue()):null),this.spnTabStop.setDisabled("checked"!==t.getValue()||this.cmbFollow.getValue()!==Asc.c_oAscNumberingSuff.Tab)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.spnTabStop=new Common.UI.MetricSpinner({el:e.findById("#id-dlg-num-tabstop"),step:.1,width:"100%",defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnTabStop),this.spnTabStop.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_StopTab(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}),this)),this.panelMore=e.findById("#id-dlg-panel-more-settings"),this.panelMoreTable=this.panelMore.parent(),this.btnMore=new Common.UI.Button({parentEl:e.findById("#id-dlg-btn-more"),cls:"btn-toolbar bg-white",iconCls:this.extended?"caret-double-left":"caret-double-right",scaling:!1,hint:this.extended?this.textHide:this.textMore}),this.btnMore.on("click",_.bind(this.onMoreClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),2==this.type&&Common.localStorage.getBool("de-hide-multilevel-settings",!0)&&this.onMoreClick(this.btnMore),this.afterRender()},getFocusedComponents:function(){switch(this.type){case 0:return[this.cmbFormat,this.cmbAlign,this.cmbSize,this.btnBold,this.btnItalic,this.btnColor].concat(this.getFooterButtons());case 1:return[this.cmbFormat,this.cmbAlign,this.txtNumFormat,this.cmbFonts,this.btnBold,this.btnItalic,this.btnColor,this.cmbSize].concat(this.getFooterButtons());case 2:return[this.cmbFormat,this.cmbSize,this.btnBold,this.btnItalic,this.btnColor,this.txtNumFormat,this.btnMore,this.levelsList,this.cmbFonts,this.cmbLevel,this.spnStart,this.chRestart,this.cmbAlign,this.spnAlign,this.spnIndents,this.cmbFollow,this.chTabStop,this.spnTabStop].concat(this.getFooterButtons())}return[]},getDefaultFocusableComponent:function(){return this.cmbFormat},onAnimateAfter:function(){this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},afterRender:function(){this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.fontName})),this.updateMetricUnit(),this.updateThemeColors(),this._setDefaults(this.props);var t=this,e=function(e){t.levelsList.selectByIndex(e)};this.api.asc_registerCallback("asc_onPreviewLevelChange",e),this.on("close",(function(i){t.api.asc_unregisterCallback("asc_onPreviewLevelChange",e)}))},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onAutoColor:function(t,e){if(e){var i=Common.Utils.ThemeColor.getHexColor(0,0,0);if(this.btnColor.setColor(i),this.colors.clearSelection(),this._changedProps)(i=new Asc.asc_CColor).put_auto(!0),this._changedProps.put_Color(i);this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}},onLikeTextColor:function(t,e){if(e){var i=Common.Utils.ThemeColor.getHexColor(0,0,0);this.btnColor.setColor(i),this.colors.clearSelection(),this._changedProps&&this._changedProps.put_Color(void 0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)}},onColorsSelect:function(t,e){this._changedProps&&this._changedProps.put_Color(Common.Utils.ThemeColor.getRgbColor(e)),this.btnColor.menu.items[0].setChecked(!1,!0),this.btnColor.menu.items[1].setChecked(!1,!0),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},addNewBullet:function(t){var e,i=this,n=i.bulletProps,s=function(s,o,a){e=o,"ok"==o&&(n.changed=!0,n.code=a.code,n.font=a.font,n.symbol=a.symbol,i._changedProps&&(i._changedProps.put_Format(Asc.c_oAscNumberingFormat.Bullet),i._changedProps.put_FontFamily(n.font),i._changedProps.put_Text([new Asc.CAscNumberingLvlText]),i._changedProps.get_Text()[0].put_Value(n.symbol),i.api&&i.api.SetDrawImagePreviewBullet("bulleted-list-preview",i.props,i.level,2==i.type))),t&&t.call(i,o)},o=new Common.Views.SymbolTableDialog({api:i.options.api,lang:i.options.interfaceLang,modal:!0,type:0,font:n.font,symbol:n.symbol,handler:s}).on("close",(function(n){void 0===e&&t&&t.call(i),setTimeout((function(){i.cmbFormat.focus()}),1)}));o.show(),o.on("symbol:dblclick",s)},addNewListType:function(t){var e,i=this;new DE.Views.ListTypesAdvanced({modal:!0,lang:i.lang,handler:function(n,s){e=n,"ok"==n&&i._changedProps&&(i._changedProps.put_Format(s),i.api&&i.api.SetDrawImagePreviewBullet("bulleted-list-preview",i.props,i.level,2==i.type)),t&&t.call(i,n)}}).on("close",(function(n){void 0===e&&t&&t.call(i),setTimeout((function(){i.cmbFormat.focus()}),1)})).show()},_handleInput:function(t){if(this.options.handler){for(var e=[],i=[],n=0;n<9;n++)this.levels[n]&&(e.push(this.levels[n]),i.push(n));this.options.handler.call(this,t,{props:1==e.length?e[0]:e,num:1==i.length?i[0]:i})}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(t){if(this.bulletProps={},t){var e=t.get_Lvl(this.level);this.level<0&&(this.level=0),this.levels[this.level]=e||new Asc.CAscNumberingLvl(this.level),2==this.type?this.levelsList.selectByIndex(this.level):this.fillLevelProps(this.levels[this.level])}this._changedProps=this.levels[this.level]},onSelectLevel:function(t,e,i){this.level=i.get("value"),void 0===this.levels[this.level]&&(this.levels[this.level]=this.props.get_Lvl(this.level)),this.fillLevelProps(this.levels[this.level]),this._changedProps=this.levels[this.level],this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},fillLevelProps:function(t){if(t){var e=this;this.cmbAlign.setValue(void 0!==t.get_Align()?t.get_Align():"");var i=t.get_Format(),n=t.get_Text();n&&n.length&&i==Asc.c_oAscNumberingFormat.Bullet&&(this.bulletProps.symbol=n[0].get_Value()),this.cmbSize.setValue(t.get_FontSize()||-1);var s=t.get_FontFamily();if(s){var o=this.cmbFonts.store.findWhere({name:s});this.fontName=o?o.get("name"):s,this.cmbFonts.setValue(this.fontName)}else this.cmbFonts.setValue("");this.bulletProps.font=s,this.btnBold.toggle(!0===t.get_Bold(),!0),this.btnItalic.toggle(!0===t.get_Italic(),!0);var a=t.get_Color();if(this.btnColor.menu.items[0].setChecked(void 0===a,!0),this.btnColor.menu.items[1].setChecked(!!a&&a.get_auto(),!0),a&&!a.get_auto()?(Common.Utils.ThemeColor.selectPickerColorByEffect(a,this.colors),"object"==typeof a&&(a=Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()))):(this.colors.clearSelection(),a="000000"),this.btnColor.setColor(a),1===this.type){(i!==Asc.c_oAscNumberingFormat.None||this.cmbFormat.store.length<1)&&this.checkRecentNum(i);var l=[this._itemNoneBullet].concat(this._arrNumbers);this.recentNumTypes.forEach((function(t){null!=t&&(t=parseInt(t),l.push({displayValue:AscCommon.IntToNumberFormat(1,t,e.lang)+", "+AscCommon.IntToNumberFormat(2,t,e.lang)+", "+AscCommon.IntToNumberFormat(3,t,e.lang)+",...",value:t}))})),l.push(this._itemMoreTypes),this.cmbFormat.setData(l),this.cmbFormat.setValue(void 0!==i?i:""),0===t.get_Start()&&""===AscCommon.IntToNumberFormat(0,i)&&t.put_Start(1),this.makeFormatStr(t)}else{if(i!==Asc.c_oAscNumberingFormat.None||this.cmbFormat.store.length<1){i===Asc.c_oAscNumberingFormat.Bullet?this.checkRecent(this.bulletProps.symbol,this.bulletProps.font):i!==Asc.c_oAscNumberingFormat.None&&this.checkRecentNum(i);l=2===this.type?[this._itemNoneBullet].concat(this._arrNumbers):[];2===this.type&&this.recentNumTypes.forEach((function(t){null!=t&&(t=parseInt(t),l.push({displayValue:AscCommon.IntToNumberFormat(1,t,e.lang)+", "+AscCommon.IntToNumberFormat(2,t,e.lang)+", "+AscCommon.IntToNumberFormat(3,t,e.lang)+",...",value:t}))})),l=l.concat(this._arrBullets),this.recentBullets.forEach((function(t){l.push({displayValue:e.txtSymbol+": ",value:Asc.c_oAscNumberingFormat.Bullet,symbol:t.symbol,font:t.font})})),2===this.type&&l.push(this._itemMoreTypes),l.push(this._itemNewBullet),this.cmbFormat.setData(l)}i===Asc.c_oAscNumberingFormat.Bullet?this.cmbFormat.selectRecord(this.cmbFormat.store.findWhere({value:Asc.c_oAscNumberingFormat.Bullet,symbol:this.bulletProps.symbol,font:this.bulletProps.font||""})):0===this.type&&i===Asc.c_oAscNumberingFormat.None?this.cmbFormat.setValue(Asc.c_oAscNumberingFormat.None,this.txtNone):this.cmbFormat.setValue(void 0!==i?i:"")}if(2===this.type){this.spnStart.setMinValue(""!==AscCommon.IntToNumberFormat(0,i)?0:1),0===t.get_Start()&&""===AscCommon.IntToNumberFormat(0,i)&&t.put_Start(1),this.spnStart.setValue(t.get_Start(),!0),this.spnAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_NumberPosition()),!0),this.spnIndents.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_IndentSize()),!0),this.cmbFollow.setValue(t.get_Suff()),this.chRestart.setValue(-1===t.get_Restart(),!0),this.chTabStop.setValue(null!==t.get_StopTab(),!0),this.spnTabStop.setMinValue(this.spnAlign.getNumberValue()),this.spnTabStop.setValue(null!==t.get_StopTab()?Common.Utils.Metric.fnRecalcFromMM(t.get_StopTab()):this.spnIndents.getNumberValue(),!0),this.txtNumFormat.setDisabled(i==Asc.c_oAscNumberingFormat.Bullet),this.spnStart.setDisabled(i==Asc.c_oAscNumberingFormat.Bullet),this.chRestart.setDisabled(0===this.level),this.chTabStop.setDisabled(t.get_Suff()!==Asc.c_oAscNumberingSuff.Tab),this.spnTabStop.setDisabled(null===t.get_StopTab()||t.get_Suff()!==Asc.c_oAscNumberingSuff.Tab);for(var r=[],c=(e=this,0);c<this.level;c++){var d=this.props.get_Lvl(c).get_Format();d!==Asc.c_oAscNumberingFormat.None&&d!==Asc.c_oAscNumberingFormat.Bullet&&r.push({displayValue:e.textLevel+" "+(c+1),value:c})}this.cmbLevel.setData(r),this.cmbLevel.setValue(""),this.cmbLevel.setDisabled(i==Asc.c_oAscNumberingFormat.Bullet||0===this.level||r.length<1),this.makeFormatStr(t)}}},makeFormatStr:function(t){var e="";if(this.formatString.lvlIndexes[this.level]=[],t)if(t.get_Format()!==Asc.c_oAscNumberingFormat.Bullet){var i=t.get_Text(),n=this,s=this.formatString.lvlIndexes[this.level];i.forEach((function(t,i){if(t.get_Type()===Asc.c_oAscNumberingLvlTextType.Text)e+=t.get_Value().toString();else if(t.get_Type()===Asc.c_oAscNumberingLvlTextType.Num){var o=t.get_Value();void 0===n.levels[o]&&(n.levels[o]=n.props.get_Lvl(o)),s[o]={start:e.length,index:i};var a=n.levels[o];e+=AscCommon.IntToNumberFormat(a.get_Start(),a.get_Format(),n.lang),s[o].end=e.length}})),this.txtNumFormat.$el.find("input").css("font-family","inherit")}else e=this.bulletProps.symbol,this.txtNumFormat.$el.find("input").css("font-family",this.bulletProps.font||"inherit");this.formatString.text=e,this.txtNumFormat.setValue(e)},onIncludeLevelSelected:function(t,e){var i=this.txtNumFormat.$el.find("input")[0].selectionStart;if(this._changedProps){for(var n=this._changedProps.get_Text(),s=this.formatString.lvlIndexes[this.level],o=0;o<s.length;o++)if(s[o]){var a=s[o];o===e.value?(n.splice(a.index,1),a.end<i&&(i-=a.end-a.start)):a.end<i&&(i-=a.end-a.start-1)}n.splice(i,0,new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Num,e.value)),this._changedProps.put_Text(n),this.makeFormatStr(this._changedProps),this.cmbLevel.setValue("")}this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},posToIndex:function(t){if(this._changedProps)for(var e=this.formatString.lvlIndexes[this.level],i=0;i<e.length;i++)if(e[i]){var n=e[i];n.end<t&&(t-=n.end-n.start-1)}return t},isPosInRange:function(t,e){if(this._changedProps)for(var i=this.formatString.lvlIndexes[this.level],n=0;n<i.length;n++)if(i[n]){var s=i[n];if(t>s.start&&t<s.end)return e?s.end:s.start}},checkMousePosition:function(t){var e=this;setTimeout((function(){var i;t.selectionStart===t.selectionEnd?void 0!==(i=e.isPosInRange(t.selectionStart))&&(t.selectionStart=t.selectionEnd=i):(void 0!==(i=e.isPosInRange(t.selectionStart))&&(t.selectionStart=i),void 0!==(i=e.isPosInRange(t.selectionEnd,!0))&&(t.selectionEnd=i));e.formatString.selectionStart=t.selectionStart,e.formatString.selectionEnd=t.selectionEnd}),0)},onFormatInput:function(t){var e=$(t.target).val(),i=this.formatString.text,n=e.slice(this.formatString.selectionStart,e.length-(i.length-this.formatString.selectionEnd)),s=this.posToIndex(this.formatString.selectionStart),o=this.posToIndex(this.formatString.selectionEnd);if(this._changedProps){var a=this._changedProps.get_Text(),l=a.slice(0,s);n.split("").forEach((function(t){l.push(new Asc.CAscNumberingLvlText(Asc.c_oAscNumberingLvlTextType.Text,t))})),l=l.concat(a.slice(o,a.length)),this._changedProps.put_Text(l),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type),this.makeFormatStr(this._changedProps),this.formatString.lvlIndexes[this.level][this.level]||(this._changedProps.put_Format(Asc.c_oAscNumberingFormat.None),this.cmbFormat.setValue(Asc.c_oAscNumberingFormat.None))}this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd},onKeyDown:function(t){var e=this,i=t.keyCode,n=t.shiftKey;if(i===Common.UI.Keys.LEFT){var s=e.isPosInRange(t.target.selectionStart-1);void 0!==s&&setTimeout((function(){t.target.selectionStart=s,!n&&(t.target.selectionEnd=s),e.formatString.selectionStart=t.target.selectionStart,e.formatString.selectionEnd=t.target.selectionEnd}),0)}else i===Common.UI.Keys.RIGHT?void 0!==(s=e.isPosInRange(t.target.selectionEnd+1,!0))&&setTimeout((function(){t.target.selectionEnd=s,!n&&(t.target.selectionStart=s),e.formatString.selectionStart=t.target.selectionStart,e.formatString.selectionEnd=t.target.selectionEnd}),0):i===Common.UI.Keys.BACKSPACE?t.target.selectionStart===t.target.selectionEnd&&(this.formatString.selectionStart=t.target.selectionStart-1,this.formatString.selectionEnd=t.target.selectionEnd):i===Common.UI.Keys.DELETE&&t.target.selectionStart===t.target.selectionEnd&&(this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd+1)},onKeyUp:function(t){this.formatString.selectionStart=t.target.selectionStart,this.formatString.selectionEnd=t.target.selectionEnd},onFontName:function(t,e){this._changedProps&&(this._changedProps.put_FontFamily(e.name?e.name:void 0),this._changedProps.get_Format()===Asc.c_oAscNumberingFormat.Bullet&&this.fillLevelProps(this._changedProps)),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},onBoldClick:function(){this._changedProps&&this._changedProps.put_Bold(this.btnBold.isActive()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},onItalicClick:function(){this._changedProps&&this._changedProps.put_Italic(this.btnItalic.isActive()),this.api&&this.api.SetDrawImagePreviewBullet("bulleted-list-preview",this.props,this.level,2==this.type)},loadRecent:function(){var t=Common.localStorage.getItem("de-recent-list-bullets");if(""!==t&&(t=JSON.parse(t)),_.isArray(t)){this.recentBullets=t;for(var e=0;e<this.recentBullets.length;++e)this.recentBullets[e].symbol||(this.recentBullets.splice(e,1),e--)}""!==(t=Common.localStorage.getItem("de-recent-list-formats"))&&(t=JSON.parse(t)),_.isArray(t)&&(this.recentNumTypes=t)},saveRecent:function(){var t=JSON.stringify(this.recentBullets);Common.localStorage.setItem("de-recent-list-bullets",t)},saveRecentNum:function(){var t=JSON.stringify(this.recentNumTypes);Common.localStorage.setItem("de-recent-list-formats",t)},checkRecent:function(t,e){if(t){e=e||"";for(var i=0;i<this._arrBullets.length;++i)if(this._arrBullets[i].symbol===t&&this._arrBullets[i].font===e)return;if(0===this.recentBullets.length)return this.recentBullets.push({symbol:t,font:e}),void this.saveRecent();for(i=0;i<this.recentBullets.length;++i)if(this.recentBullets[i].symbol===t&&this.recentBullets[i].font===e){this.recentBullets.splice(i,1);break}this.recentBullets.splice(0,0,{symbol:t,font:e}),this.recentBullets.length>5&&this.recentBullets.splice(5,this.recentBullets.length-5),this.saveRecent()}},checkRecentNum:function(t){if(null!=t){for(var e=0;e<this._arrNumbers.length;++e)if(this._arrNumbers[e].value===t)return;if(0===this.recentNumTypes.length)return this.recentNumTypes.push(t),void this.saveRecentNum();for(e=0;e<this.recentNumTypes.length;++e)if(this.recentNumTypes[e]===t){this.recentNumTypes.splice(e,1);break}this.recentNumTypes.splice(0,0,t),this.recentNumTypes.length>5&&this.recentNumTypes.splice(5,this.recentNumTypes.length-5),this.saveRecentNum()}},onMoreClick:function(t){this.extended?(this.extended=!1,this.panelMore.css({display:"none"}),this.panelMoreTable.css({width:"auto"}),this.setWidth(this.getWidth()-this.rightPanelWidth),t.updateHint(this.textMore),t.setIconCls("icon caret-double-right"),Common.localStorage.setItem("de-hide-multilevel-settings",1)):(this.extended=!0,this.panelMore.css({display:"block"}),this.panelMoreTable.width(this.panelMore.width()),this.setWidth(this.getWidth()+this.rightPanelWidth),t.updateHint(this.textHide),t.setIconCls("icon caret-double-left"),Common.localStorage.setItem("de-hide-multilevel-settings",0))},txtTitle:"List Settings",txtSize:"Size",txtColor:"Color",txtBullet:"Bullet",txtAlign:"Alignment",textLeft:"Left",textCenter:"Center",textRight:"Right",textAuto:"Automatic",textPreview:"Preview",txtType:"Type",txtLikeText:"Like a text",textLevel:"Level",txtNone:"None",txtNewBullet:"New bullet",txtSymbol:"Symbol",txtNumFormatString:"Number format",txtInclcudeLevel:"Include level number",txtStart:"Start at",txtFontName:"Font",textBold:"Bold",textItalic:"Italic",textTab:"Tab character",textSpace:"Space",txtAlignAt:"at",txtIndent:"Text Indent",txtFollow:"Follow number with",txtRestart:"Restart list",txtMoreTypes:"More types",txtTabStop:"Add tab stop at",textMore:"Show more settings",textHide:"Hide settings",textSelectLevel:"Select level"},DE.Views.ListSettingsDialog||{}))})),define("documenteditor/main/app/view/LineNumbersDialog",[],(function(){"use strict";DE.Views.LineNumbersDialog=Common.UI.Window.extend(_.extend({options:{width:290,header:!0,style:"min-width: 290px;",cls:"modal-dlg",id:"window-line-numbers",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div id="line-numbers-add-line-numbering" style="margin-bottom: 15px;"></div>','<div style="margin-bottom: 15px;">','<div class="margin-right-9" style="display: inline-block;"><label>'+this.textStartAt+'</label><div id="line-numbers-start-at"></div></div>','<div class="margin-right-9" style="display: inline-block;"><label>'+this.textFromText+'</label><div id="line-numbers-from-text"></div></div>','<div style="display: inline-block;"><label>'+this.textCountBy+'</label><div id="line-numbers-count-by"></div></div>',"</div>",'<div style="margin-bottom: 8px;"><label>'+this.textNumbering+"</label></div>",'<div id="line-numbers-restart-each-page" style="margin-bottom: 8px;"></div>','<div id="line-numbers-restart-each-section" style="margin-bottom: 8px;"></div>','<div id="line-numbers-continuous" style="margin-bottom: 15px;"></div>','<div style="margin-bottom: 5px;">',"<label>"+this.textApplyTo+'</label><div id="line-numbers-combo-apply" class="input-group-nr" style="width:150px;"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chAddLineNumbering=new Common.UI.CheckBox({el:$("#line-numbers-add-line-numbering"),labelText:this.textAddLineNumbering}).on("change",_.bind((function(t,e,i,n){var s="checked"!==t.getValue();this.spnStartAt.setDisabled(s),this.spnFromText.setDisabled(s),this.spnCountBy.setDisabled(s),this.rbRestartEachPage.setDisabled(s),this.rbRestartEachSection.setDisabled(s),this.rbContinuous.setDisabled(s)}),this)),this.spnStartAt=new Common.UI.MetricSpinner({el:$("#line-numbers-start-at"),step:1,width:80,defaultUnit:"",value:1,maxValue:32767,minValue:1,disabled:!0}),this.spnFromText=new Common.UI.MetricSpinner({el:$("#line-numbers-from-text"),step:.1,width:80,defaultUnit:"cm",value:"Auto",autoText:this.txtAutoText,maxValue:55.87,minValue:.1,allowAuto:!0,disabled:!0}),this.spinners.push(this.spnFromText),this.spnCountBy=new Common.UI.MetricSpinner({el:$("#line-numbers-count-by"),step:1,width:80,defaultUnit:"",value:1,maxValue:100,minValue:1,disabled:!0}),this.rbRestartEachPage=new Common.UI.RadioBox({el:$("#line-numbers-restart-each-page"),labelText:this.textRestartEachPage,name:"asc-radio-line-numbers",disabled:!0,checked:!0}),this.rbRestartEachSection=new Common.UI.RadioBox({el:$("#line-numbers-restart-each-section"),labelText:this.textRestartEachSection,name:"asc-radio-line-numbers",disabled:!0}),this.rbContinuous=new Common.UI.RadioBox({el:$("#line-numbers-continuous"),labelText:this.textContinuous,name:"asc-radio-line-numbers",disabled:!0}),this.cmbApply=new Common.UI.ComboBox({el:$("#line-numbers-combo-apply"),cls:"input-group-nr",menuStyle:"min-width: 150px;",takeFocusOnClose:!0,editable:!1,data:[{displayValue:this.textSection,value:Asc.c_oAscSectionApplyType.Current},{displayValue:this.textForward,value:Asc.c_oAscSectionApplyType.ToEnd},{displayValue:this.textDocument,value:Asc.c_oAscSectionApplyType.All}]}),this.cmbApply.setValue(this.options.applyTo),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.chAddLineNumbering,this.spnStartAt,this.spnFromText,this.spnCountBy,this.rbRestartEachPage,this.rbRestartEachSection,this.rbContinuous,this.cmbApply].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chAddLineNumbering},afterRender:function(){},setSettings:function(t){if(t){var e=t.get_Restart();switch(this.chAddLineNumbering.setValue(!0),e){case Asc.c_oAscLineNumberRestartType.Continuous:this.rbContinuous.setValue(!0,!0);break;case Asc.c_oAscLineNumberRestartType.NewPage:this.rbRestartEachPage.setValue(!0,!0);break;case Asc.c_oAscLineNumberRestartType.NewSection:this.rbRestartEachSection.setValue(!0,!0)}this.spnStartAt.setValue(null!==t.get_Start()&&void 0!==t.get_Start()?t.get_Start():"",!0),this.spnFromText.setValue(null!==t.get_Distance()&&void 0!==t.get_Distance()?Common.Utils.Metric.fnRecalcFromMM(25.4*t.get_Distance()/20/72):-1,!0),this.spnCountBy.setValue(null!==t.get_CountBy()&&void 0!==t.get_CountBy()?t.get_CountBy():"",!0)}else this.chAddLineNumbering.setValue(!1)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){var t;if("checked"===this.chAddLineNumbering.getValue()){t=new Asc.CSectionLnNumType,this.rbContinuous.getValue()?t.put_Restart(Asc.c_oAscLineNumberRestartType.Continuous):this.rbRestartEachPage.getValue()?t.put_Restart(Asc.c_oAscLineNumberRestartType.NewPage):this.rbRestartEachSection.getValue()&&t.put_Restart(Asc.c_oAscLineNumberRestartType.NewSection),t.put_Start(""!==this.spnStartAt.getValue()?this.spnStartAt.getNumberValue():void 0);var e=this.spnFromText.getNumberValue();t.put_Distance(e<0?null:parseInt(72*Common.Utils.Metric.fnRecalcToMM(e)*20/25.4)),t.put_CountBy(""!==this.spnCountBy.getValue()?this.spnCountBy.getNumberValue():void 0)}return{props:t,type:this.cmbApply.getValue()}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},textTitle:"Line Numbers",textAddLineNumbering:"Add line numbering",textStartAt:"Start at",textFromText:"From text",textCountBy:"Count by",textNumbering:"Numbering",textRestartEachPage:"Restart Each Page",textRestartEachSection:"Restart Each Section",textContinuous:"Continuous",textApplyTo:"Apply changes to",textDocument:"Whole document",textSection:"Current section",textForward:"This point forward",txtAutoText:"Auto"},DE.Views.LineNumbersDialog||{}))})),define("documenteditor/main/app/view/HyphenationDialog",[],(function(){"use strict";DE.Views.HyphenationDialog=Common.UI.Window.extend(_.extend({options:{width:290,header:!0,style:"min-width: 290px;",cls:"modal-dlg",id:"window-hyphenation-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" style="padding-bottom: 15px;">','<div id="hyphenation-chk-auto"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 15px;">','<div id="hyphenation-chk-caps"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 10px;">','<label class="margin-right-5">'+this.textZone+"</label>","</td>",'<td style="padding-bottom: 10px;">','<div id="hyphenation-num-zone" style="display: inline-block;"></div>',"</td>","</tr>","<tr>",'<td style="padding-bottom: 5px;">','<label class="margin-right-5">'+this.textLimit+"</label>","</td>",'<td style="padding-bottom: 5px;">','<div id="hyphenation-num-limit" style="display: inline-block;"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this._changedProps=null,this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.chAuto=new Common.UI.CheckBox({el:t.find("#hyphenation-chk-auto"),labelText:this.textAuto}).on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.setAutoHyphenation("checked"===t.getValue())}),this)),this.chCaps=new Common.UI.CheckBox({el:t.find("#hyphenation-chk-caps"),labelText:this.textCaps}).on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.setHyphenateCaps("checked"===t.getValue())}),this)),this.spnLimit=new Common.UI.MetricSpinner({el:t.find("#hyphenation-num-limit"),step:1,width:80,defaultUnit:"",value:-1,autoText:this.textNoLimit,allowAuto:!0,maxValue:32767,minValue:1}),this.spnLimit.setValue(-1),this.spnLimit.on("change",_.bind((function(t,e,i,n){if(this._changedProps){var s=t.getNumberValue();this._changedProps.setHyphenationLimit(s<0?0:s)}}),this)),this.spnLimit.on("changing",_.bind((function(t,e,i,n){0===parseInt(e)&&t.setValue(-1)}),this)),this.spnZone=new Common.UI.MetricSpinner({el:t.find("#hyphenation-num-zone"),step:.1,width:80,defaultUnit:"cm",value:"1 cm",maxValue:55.87,minValue:0}),this.spnZone.on("change",_.bind((function(t,e,i,n){if(this._changedProps){var s=t.getNumberValue();this._changedProps.setHyphenationZone(parseInt(72*Common.Utils.Metric.fnRecalcToMM(s)*20/25.4))}}),this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit()},getFocusedComponents:function(){return[this.chAuto,this.chCaps,this.spnZone,this.spnLimit].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chAuto},afterRender:function(){},setSettings:function(t){if(t){this.chAuto.setValue(!!t.isAutoHyphenation(),!0),this.chCaps.setValue(!!t.isHyphenateCaps(),!0);var e=t.getHyphenationLimit()||0;this.spnLimit.setValue(null!=e?0===e?-1:e:"",!0),e=t.getHyphenationZone(),this.spnZone.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(25.4*e/20/72):"",!0)}this._changedProps=t||new AscCommon.AutoHyphenationSettings},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},getSettings:function(){return this._changedProps},updateMetricUnit:function(){this.spnZone.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),this.spnZone.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)},textTitle:"Hyphenation",textAuto:"Automatically hyphenate document",textCaps:"Hyphenate words in CAPS",textLimit:"Limit consecutive hyphens to",textNoLimit:"No limit",textZone:"Hyphenation zone"},DE.Views.HyphenationDialog||{}))})),define("documenteditor/main/app/view/CellsAddDialog",[],(function(){"use strict";DE.Views.CellsAddDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 10px;">','<div id="table-combo-row-col" class="input-group-nr margin-right-5" style="display: inline-block;"></div>','<div id="table-spin-row-col" style="display: inline-block;"></div>',"</div>",'<div id="table-radio-before" style="padding-bottom: 8px;"></div>','<div id="table-radio-after" style="padding-bottom: 8px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.cmbRowCol=new Common.UI.ComboBox({el:$("#table-combo-row-col"),cls:"input-group-nr",style:"width: 110px;",menuStyle:"min-width: 110px;",editable:!1,takeFocusOnClose:!0,scrollAlwaysVisible:!0,data:[{value:0,displayValue:this.textRow},{value:1,displayValue:this.textCol}]}),this.cmbRowCol.setValue(0),this.cmbRowCol.on("selected",_.bind((function(t,e){var i=0==e.value;this.spnCount.setMaxValue(i?100:64),this.spnCount.setValue(this.spnCount.getNumberValue()),this.radioBefore.setCaption(i?this.textUp:this.textLeft),this.radioAfter.setCaption(i?this.textDown:this.textRight)}),this)),this.spnCount=new Common.UI.MetricSpinner({el:$("#table-spin-row-col"),step:1,width:65,value:1,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1}),this.radioBefore=new Common.UI.RadioBox({el:$("#table-radio-before"),labelText:this.textUp,name:"asc-radio-table-cells-add",checked:!0}),this.radioAfter=new Common.UI.RadioBox({el:$("#table-radio-after"),labelText:this.textDown,name:"asc-radio-table-cells-add"}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.cmbRowCol,this.spnCount,this.radioBefore,this.radioAfter].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnCount},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return{row:0==this.cmbRowCol.getValue(),before:this.radioBefore.getValue(),count:this.spnCount.getNumberValue()}},onPrimary:function(){return this._handleInput("ok"),!1},textTitle:"Insert Several",textLeft:"To the left",textRight:"To the right",textUp:"Above the cursor",textDown:"Below the cursor",textRow:"Rows",textCol:"Columns"},DE.Views.CellsAddDialog||{}))})),define("documenteditor/main/app/view/NumberingValueDialog",[],(function(){"use strict";DE.Views.NumberingValueDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-spin-set-value"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.spnStart=new Common.UI.CustomSpinner({el:$("#id-spin-set-value"),step:1,width:182,defaultUnit:"",value:1,maxValue:16383,minValue:0,allowDecimal:!1,maskExp:/[0-9]/}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.spnStart.on("entervalue",_.bind(this.onPrimary,this)),this.spnStart.$el.find("input").focus(),this.afterRender()},getFocusedComponents:function(){return[this.spnStart].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnStart},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.spnStart.setValue(t.start),this.onFormatSelect(t.format))},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.spnStart.getNumberValue()},onPrimary:function(){return this._handleInput("ok"),!1},onFormatSelect:function(t){var e=/[0-9]/,i=this,n=function(t){return""!==t?AscCommon.IntToNumberFormat(parseInt(t),i.props.format):t},s=function(t){return t},o=1;switch(t){case Asc.c_oAscNumberingFormat.UpperRoman:case Asc.c_oAscNumberingFormat.LowerRoman:s=function(t){return/\D/.test(t)?AscCommon.RomanToInt(t):parseInt(t)},e=/[IVXLCDMivxlcdm0-9]/;break;case Asc.c_oAscNumberingFormat.UpperLetter:case Asc.c_oAscNumberingFormat.LowerLetter:s=function(t){return/\D/.test(t)?AscCommon.LatinNumberingToInt(t):parseInt(t)},e=/[A-Za-z0-9]/;break;case Asc.c_oAscNumberingFormat.RussianLower:case Asc.c_oAscNumberingFormat.RussianUpper:s=function(t){return/\D/.test(t)?AscCommon.RussianNumberingToInt(t):parseInt(t)},e=/[--0-9]/;break;default:n=function(t){return t},o=""!==AscCommon.IntToNumberFormat(0,this.props.format)?0:1}this.spnStart.setMask(e),this.spnStart.options.toCustomFormat=n,this.spnStart.options.fromCustomFormat=function(t){var e=s(t);return isNaN(e)?"1":e.toString()},this.spnStart.on("changing",(function(t,e){var i=s(e);isNaN(i)&&t.setValue(1)})),this.spnStart.setMinValue(o),this.spnStart.setValue(this.spnStart.getValue())}},DE.Views.NumberingValueDialog||{}))})),define("documenteditor/main/app/view/ListIndentsDialog",[],(function(){"use strict";DE.Views.ListIndentsDialog=Common.UI.Window.extend(_.extend({options:{width:305,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-list-indents",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.props=t.props,this.isBullet=t.isBullet||!1,this.template=['<div class="box" style="height: 85px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-10">','<label class="input-label">'+(this.isBullet?this.txtPosBullet:this.txtPosNumber)+"</label>",'<div id="id-dlg-indents-align-at" style="margin-bottom: 10px;"></div>',"</td>","<td>",'<label class="input-label">'+this.txtIndent+"</label>",'<div id="id-dlg-indents-indent" style="margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2">','<label class="input-label">'+(this.isBullet?this.txtFollowBullet:this.txtFollowNumber)+"</label>",'<div id="id-dlg-indents-follow" class="input-group-nr" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","</table>","</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.spnAlign=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-indents-align-at"),step:.1,width:130,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnAlign),this.spnAlign.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_NumberPosition(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spnIndents=new Common.UI.MetricSpinner({el:t.findById("#id-dlg-indents-indent"),step:.1,width:130,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.spnIndents),this.spnIndents.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_IndentSize(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.cmbFollow=new Common.UI.ComboBox({el:t.find("#id-dlg-indents-follow"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscNumberingSuff.Tab,displayValue:this.textTab},{value:Asc.c_oAscNumberingSuff.Space,displayValue:this.textSpace},{value:Asc.c_oAscNumberingSuff.None,displayValue:this.txtNone}],takeFocusOnClose:!0}),this.cmbFollow.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.put_Suff(e.value)}),this)),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.updateMetricUnit(),this._setDefaults(this.props)},getFocusedComponents:function(){return[this.spnAlign,this.spnIndents,this.cmbFollow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnAlign},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this._changedProps),this.close()},_setDefaults:function(t){t&&(this.spnAlign.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_NumberPosition()),!0),this.spnIndents.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_IndentSize()),!0),this.cmbFollow.setValue(t.get_Suff()),this.isBullet=t.get_Format()===Asc.c_oAscNumberingFormat.Bullet,this._changedProps=t)},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}},textTitle:"List Indents",txtPosBullet:"Bullet position",txtPosNumber:"Number position",txtIndent:"Text indent",txtFollowBullet:"Follow bullet with",txtFollowNumber:"Follow number with",textTab:"Tab character",textSpace:"Space",txtNone:"None"},DE.Views.ListIndentsDialog||{}))})),define("documenteditor/main/app/view/ProtectDialog",[],(function(){"use strict";DE.Views.ProtectDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{title:t.title?t.title:this.txtTitle,cls:"modal-dlg",width:350,height:"auto",buttons:t.buttons?t.buttons:[{value:"ok",caption:this.txtProtect},"cancel"]},t),this.handler=t.handler,this.props=t.props,this.template=t.template||['<div class="box">','<div class="input-row">',"<label>"+e.txtPassword+" ("+e.txtOptional+")</label>","</div>",'<div id="id-protect-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-protect-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>','<div class="" style="margin-bottom: 5px;">','<label class="font-weight-bold" style="margin-bottom: 5px;">'+e.txtAllow+"</label>","</div>",'<div id="id-protect-radio-view" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-forms" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-review" style="margin-bottom: 8px;"></div>','<div id="id-protect-radio-comment" style="margin-bottom: 8px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:this.$window.find("#id-protect-repeat-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:15,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:this.$window.find("#id-protect-password-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:15,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1,validation:function(e){return!(e.length>15)||t.txtLimit}}),this.rbView=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-view"),labelText:this.textView,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.ReadOnly,checked:!0}),this.rbForms=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-forms"),labelText:this.textForms,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.Forms}),this.rbReview=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-review"),labelText:this.textReview,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.TrackedChanges}),this.rbComments=new Common.UI.RadioBox({el:this.$window.find("#id-protect-radio-comment"),labelText:this.textComments,name:"asc-radio-protect-mode",value:Asc.c_oAscEDocProtect.Comments}),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd,this.rbView,this.rbForms,this.rbReview,this.rbComments].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputPwd},afterRender:function(){this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if("ok"!==t||!this.btnOk.isDisabled()){if(this.handler){if("ok"===t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue(),"ok"==t?this.getSettings():void 0)}this.close()}},_setDefaults:function(t){},getSettings:function(){return this.rbView.getValue()?Asc.c_oAscEDocProtect.ReadOnly:this.rbForms.getValue()?Asc.c_oAscEDocProtect.Forms:this.rbReview.getValue()?Asc.c_oAscEDocProtect.TrackedChanges:this.rbComments.getValue()?Asc.c_oAscEDocProtect.Comments:void 0},SetDisabled:function(t){this.btnOk.setDisabled(t)},txtPassword:"Password",txtRepeat:"Repeat password",txtOptional:"optional",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place.",txtProtect:"Protect",txtTitle:"Protect",txtAllow:"Allow only this type of editing in the document",textView:"No changes (Read only)",textForms:"Filling forms",textReview:"Tracked changes",textComments:"Comments",txtLimit:"Password is limited to 15 characters"},DE.Views.ProtectDialog||{}))})),define("text!documenteditor/main/app/template/MailMergeEmailDlg.template",[],(function(){return'<div id="id-merge-email-dlg" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" cellpadding="10" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label header"><%= scope.textFrom %></label>\r\n                    <div id="merge-email-dlg-from" class="margin-right-5"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label header"><%= scope.textTo %></label>\r\n                    <div id="merge-email-dlg-to"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label class="input-label header"><%= scope.textSubject %></label>\r\n                    <div id="merge-email-dlg-subject" style="width: 100%;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label class="input-label header"><%= scope.textFormat %></label>\r\n                    <div id="merge-email-dlg-format" style="width: 170px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label id="merge-email-dlg-lbl-filename"  class="input-label disabled header"><%= scope.textFileName %></label>\r\n                    <div id="merge-email-dlg-filename" style="width: 100%;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label id="merge-email-dlg-lbl-message" class="input-label disabled header"><%= scope.textMessage %></label>\r\n                     <textarea id="merge-email-dlg-message" class="disabled form-control" disabled="disabled" style="width: 100%;height: 70px;margin-bottom: 0;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <label class="header"><%= scope.textWarning %></label>\r\n                    <label class=""><%= scope.textWarningMsg %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("documenteditor/main/app/view/MailMergeEmailDlg",["text!documenteditor/main/app/template/MailMergeEmailDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";DE.Views.MailMergeEmailDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"MailMergeEmail",contentWidth:500},initialize:function(e){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this._arrFrom=[],this.cmbFrom=new Common.UI.ComboBox({el:$("#merge-email-dlg-from"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,takeFocusOnClose:!0,data:this._arrFrom}),this._arrTo=[],this.cmbTo=new Common.UI.ComboBox({el:$("#merge-email-dlg-to"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,takeFocusOnClose:!0,data:this._arrTo}),this.inputSubject=new Common.UI.InputField({el:$("#merge-email-dlg-subject"),allowBlank:!0,validateOnBlur:!1,placeHolder:this.subjectPlaceholder,style:"width: 100%;"}),this._arrFormat=[{displayValue:this.textHTML,value:Asc.c_oAscFileType.HTML},{displayValue:this.textAttachDocx,value:Asc.c_oAscFileType.DOCX},{displayValue:this.textAttachPdf,value:Asc.c_oAscFileType.PDF}],this.cmbFormat=new Common.UI.ComboBox({el:$("#merge-email-dlg-format"),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,takeFocusOnClose:!0,data:this._arrFormat}),this.cmbFormat.setValue(Asc.c_oAscFileType.HTML),this.cmbFormat.on("selected",_.bind(this.onCmbFormatSelect,this)),this.inputFileName=new Common.UI.InputField({el:$("#merge-email-dlg-filename"),allowBlank:!0,validateOnBlur:!1,disabled:!0,placeHolder:this.filePlaceholder,style:"width: 100%;"}),this.textareaMessage=this.$window.find("textarea"),this.lblFileName=$("#merge-email-dlg-lbl-filename"),this.lblMessage=$("#merge-email-dlg-lbl-message"),this._eventfunc=function(e){t._onWindowMessage(e)},this.mergeProps=this.options.props,this.mergedFileUrl=this.options.mergedFileUrl||"",this.afterRender()},getFocusedComponents:function(){return[this.cmbFrom,this.cmbTo,this.inputSubject,this.cmbFormat,this.inputFileName,this.textareaMessage].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFrom},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&t.Referer},afterRender:function(){this._setDefaults(this.mergeProps)},getSettings:function(){var t=this.inputFileName.getValue(),e=this.cmbFormat.getValue();if(e!==Asc.c_oAscFileType.HTML){_.isEmpty(t)&&(t="attach");var i=t.lastIndexOf("."),n=i>0?t.substring(i,t.length).toLowerCase():"";e==Asc.c_oAscFileType.PDF&&".pdf"!==n?t+=".pdf":e==Asc.c_oAscFileType.DOCX&&".docx"!==n&&(t+=".docx")}return{from:this.cmbFrom.getValue(),to:this.cmbTo.getValue(),subject:this.inputSubject.getValue(),mailFormat:e,fileName:t,message:this.textareaMessage.val()}},_setDefaults:function(t){if(t){if(t.fieldsList){var e=[];_.each(t.fieldsList,(function(t,i){e.push({displayValue:"<"+t+">",value:t})})),this.cmbTo.setData(e),e.length>0&&this.cmbTo.setValue(e[0].value)}if(t.emailAddresses){e=[];_.each(t.emailAddresses,(function(t,i){e.push({displayValue:t,value:t})})),this.cmbFrom.setData(e),e.length>0&&this.cmbFrom.setValue(e[0].value)}}},onPrimary:function(){return!0},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onCmbFormatSelect:function(t,e){var i=e.value==Asc.c_oAscFileType.HTML;this.inputFileName.setDisabled(i),this.lblFileName.toggleClass("disabled",i),i?this.textareaMessage.attr("disabled","disabled"):this.textareaMessage.removeAttr("disabled"),this.textareaMessage.toggleClass("disabled",i),this.lblMessage.toggleClass("disabled",i)},textTitle:"Send to E-mail",textFrom:"From",textTo:"To",textSubject:"Subject Line",textFormat:"Mail format",textFileName:"File name",textMessage:"Message",textHTML:"HTML",textAttachDocx:"Attach as DOCX",textAttachPdf:"Attach as PDF",subjectPlaceholder:"Theme",filePlaceholder:"PDF",textWarning:"Warning!",textWarningMsg:"Please note that mailing cannot be stopped once your click the 'Send' button."},DE.Views.MailMergeEmailDlg||{}))})),require(["common/main/lib/util/define","common/main/lib/controller/ScreenReaderFocus","common/main/lib/component/ComboBoxDataView","common/main/lib/view/OptionsDialog","common/main/lib/view/CopyWarningDialog","common/main/lib/view/InsertTableDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/view/PasswordDialog","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog","common/main/lib/view/SaveAsDlg","common/main/lib/view/AutoCorrectDialog","common/main/lib/view/DocumentAccessDialog","common/main/lib/view/SearchDialog","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/PluginDlg","common/main/lib/view/PluginPanel","common/main/lib/view/RenameDialog","common/main/lib/view/ExternalEditor","common/main/lib/view/ExternalDiagramEditor","common/main/lib/view/ExternalMergeEditor","common/main/lib/view/ExternalOleEditor","common/main/lib/view/ShapeShadowDialog","common/main/lib/view/CustomizeQuickAccessDialog","common/main/lib/view/LanguageDialog","common/main/lib/view/TextInputDialog","common/main/lib/view/DocumentHolderExt","common/main/lib/view/PdfSignDialog","common/main/lib/view/DocumentPropertyDialog","common/main/lib/view/MacrosDialog","common/main/lib/view/MacrosAiDialog","common/main/lib/component/MonacoEditor","documenteditor/main/app/controller/DocumentHolderExt","documenteditor/main/app/view/FileMenuPanels","documenteditor/main/app/view/DocumentHolderExt","documenteditor/main/app/view/ParagraphSettingsAdvanced","documenteditor/main/app/view/ImageSettingsAdvanced","documenteditor/main/app/view/TableSettingsAdvanced","documenteditor/main/app/view/DropcapSettingsAdvanced","documenteditor/main/app/view/StyleTitleDialog","documenteditor/main/app/view/TableFormulaDialog","documenteditor/main/app/view/TableToTextDialog","documenteditor/main/app/view/TextToTableDialog","documenteditor/main/app/view/WatermarkSettingsDialog","documenteditor/main/app/view/RoleDeleteDlg","documenteditor/main/app/view/RoleEditDlg","documenteditor/main/app/view/RolesManagerDlg","documenteditor/main/app/view/SaveFormDlg","documenteditor/main/app/view/CaptionDialog","documenteditor/main/app/view/NoteSettingsDialog","documenteditor/main/app/view/HyperlinkSettingsDialog","documenteditor/main/app/view/BookmarksDialog","documenteditor/main/app/view/NotesRemoveDialog","documenteditor/main/app/view/CrossReferenceDialog","documenteditor/main/app/view/TableOfContentsSettings","documenteditor/main/app/view/EditListItemDialog","documenteditor/main/app/view/ControlSettingsDialog","documenteditor/main/app/view/DateTimeDialog","documenteditor/main/app/view/PageMarginsDialog","documenteditor/main/app/view/PageSizeDialog","documenteditor/main/app/view/CustomColumnsDialog","documenteditor/main/app/view/ListSettingsDialog","documenteditor/main/app/view/LineNumbersDialog","documenteditor/main/app/view/HyphenationDialog","documenteditor/main/app/view/CellsAddDialog","documenteditor/main/app/view/NumberingValueDialog","documenteditor/main/app/view/ListIndentsDialog","documenteditor/main/app/view/ProtectDialog","documenteditor/main/app/view/MailMergeEmailDlg"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/documenteditor/main/app_pack.js",(function(){}));