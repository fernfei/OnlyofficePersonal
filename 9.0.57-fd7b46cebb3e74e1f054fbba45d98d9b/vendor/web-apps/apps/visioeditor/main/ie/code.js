/* minified by terser */
function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var helper=function(){var t,e=function(e){if(e){if(!t&&0==(t=$("div[aria-live]")).length){t=$('<div aria-live="assertive" class="sr-only" style=""></div>').appendTo($("body"))}}else t&&(t.remove(t),t=void 0)};return{setEnabled:e,disable:function(){e(!1)},speech:function(i){t||e(!0),t.text(""),setTimeout((function(e){t.text(i)}),0)}}};if(!window.Common&&(window.Common={}),!Common.Utils&&(Common.Utils={}),Common.Utils.ScreeenReaderHelper=new helper,define("common/main/lib/util/ScreenReaderHelper",(function(){})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ScreenReaderFocusManager=new function(){var t,e,i,n,o=!1,s=!1,a=!1,l=0,r=0,c=document,d=document,h=[],m=!1,u=!1,p=!1,f=!1,g=function(t,e){d=c,e?c=e:"esc"!==t?c=$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):0===l?document:t&&t.closest(".hint-section")||document:0===l&&(c=document)},b=function(t){!e||!t&&Common.Utils.ModalWindow.isVisible()||(m=t,e.asc_enableKeyEvents(!t))},v=function(){if((0===h.length||$("#file-menu-panel").is(":visible")&&1===l)&&M(),s)if(l!==r&&(0===l||1===l&&$("#file-menu-panel").is(":visible"))){var e=$(d).prop("id");"toolbar"===e?I():"left-menu"===e||"right-menu"===e?x(e):"file-menu-panel"===e&&k()}else 1!==l||l===r||"left-menu"!==$(c).prop("id")&&"right-menu"!==$(c).prop("id")||A("left-menu"===$(c).prop("id"));else $("#file-menu-panel").is(":visible")?k():I();var i=h[t];i&&($(i).parent().hasClass("ribtab")&&!$(i).parent().hasClass("active")&&"file"!==$(i).data("tab")&&$(i).trigger(jQuery.Event("click",{which:1})),$(h[t]).focus()),h.length>0?(!m&&b(!0),s=!0):s=!1},C=function(){s=!1,a=!1,f=!1},w=function(e){r=l,t=0,h.length=0,void 0!==e?l=e:l++},y=function(){l=$("#file-menu-panel").is(":visible")?1:0,g(),h.length=0},I=function(){for(var e,i=0;i<h.length;i++){var n=$(h[i]).parent();if(n&&n.hasClass("ribtab")&&n.hasClass("active")){e=h[i];break}}e&&(t=i)},x=function(e){for(var i,n=0;n<h.length;n++){var o=$(h[n]);if($(o.closest(".hint-section")).prop("id")===e&&o.hasClass("btn-category")&&o.hasClass("active")){i=h[n];break}}i&&(t=n)},k=function(){for(var e,i=0;i<h.length;i++)if($(h[i]).parent().hasClass("active")){e=h[i];break}e&&(t=i)},A=function(e){var n,o=0;if(e&&(n=i.getController("LeftMenu").getView("LeftMenu").getFocusElement()),n)for(var s=0;s<h.length;s++)if($(h[s]).is($(n))){o=s;break}t=o},M=function(){h=[];var t=[];_.isArray(c)?c.forEach((function(e){t=t.concat($(e).find("[data-hint="+l+"]").toArray())})):t=$(c).find("[data-hint="+l+"]").toArray(),(h=t.filter((function(t){return $(t).is(":visible")&&!function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}($(t))}))).forEach((function(t){void 0===$(t).attr("tabindex")&&$(t).attr("tabindex",0)}))},U=function(){C(),y(),m&&b(!1)};return{init:function(d){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){e=d,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE,p=!0;var _=Common.localStorage.getKeysFilter();n=_&&_.length?_.split(",")[0]:"",Common.Utils.ScreeenReaderHelper||require(["common/main/lib/util/ScreenReaderHelper"],(function(){Common.Utils.ScreeenReaderHelper.setEnabled(!0)})),$("#editor_sdk").on("click",(function(){U()})),$(document).on("mousedown",(function(){U()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!o||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?u?(b(!1),u=!1):s&&t.preventDefault():(t.preventDefault(),s?U():($("input:focus").blur(),l=$("#file-menu-panel").is(":visible")?1:0,g(),v())),o=!1})),$(document).on("keydown.after.bs.dropdown",(function(e){if(s){var i=$(h[t]).prop("tagName"),n="INPUT"===i||"TEXTAREA"===i,o=e.keyCode==Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN,d=e.keyCode==Common.UI.Keys.ESC||e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE;if($(h[t]).data("move-focus-only-tab")&&e.keyCode!==Common.UI.Keys.TAB&&!d)return;if(!o&&!d||e.keyCode==Common.UI.Keys.SPACE&&n)return;o&&e.preventDefault(),Common.UI.Menu.Manager.hideAll();var p,b,_,I,x=!1,k=h[t]&&$(h[t]),A=$("#file-menu-panel").is(":visible"),M=k&&k.hasClass("btn-category"),P=e.keyCode==Common.UI.Keys.LEFT,S=e.keyCode==Common.UI.Keys.RIGHT,T=e.keyCode==Common.UI.Keys.UP,D=e.keyCode==Common.UI.Keys.DOWN,E=e.keyCode==Common.UI.Keys.TAB,B=e.shiftKey&&e.keyCode==Common.UI.Keys.TAB;if(A?(p=P||T,b=2===l?S||D||E&&!B:S||D,_=B,I=E&&!B):M?(p=T||B,b=D||E,_=!1,I=S||P):f?(p=B,b=E,_=!1,I=!1):(p=P||B,b=S||E&&!B,_=T,I=D),e.keyCode==Common.UI.Keys.ESC)return void U();if(e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE){if(k&&(k.attr("for")?e.keyCode==Common.UI.Keys.RETURN?$("#"+k.attr("for")).trigger(jQuery.Event("click",{which:1})):e.preventDefault():"file"===k.data("tab")||A&&1===l||M?k.trigger(jQuery.Event("click",{which:1})):setTimeout((function(){k.trigger(jQuery.Event("click",{which:1}))}),1),"dropdown"!==k.data("toggle")&&k.blur()),!(k&&"file"===k.data("tab")||A&&1===l||M&&k.hasClass("active")))return C(),y(),Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),k&&"dropdown"!==k.data("toggle")&&(u=!0),void(m=!1);M&&k.hasClass("active")&&(f=!0),w(),g(k)}else if(p)x=!0,r=l,--t<0&&(t=h.length-1);else if(b)x=!0,r=l,++t>h.length-1&&(t=0);else if(I){var H='[data-hint="'+(l+1)+'"]';if(0===$(c).find(H).length||k&&0===$(k.closest(".hint-section")).find(H).filter(":visible").length)return;x=!0,w(),g(k),M&&(f=!0)}else if(_){if(0===l)return;x=!0,r=l,h.length=0,l--,g(k)}!a&&x&&(a=!0,Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0)),v()}})),$(document).on("keydown",(function(t){o=Common.Utils.InternalSettings.get(n+"settings-show-alt-hints")&&t.keyCode==Common.UI.Keys.ALT&&!t.shiftKey&&!Common.Utils.ModalWindow.isVisible()&&p&&!(window.PE&&$("#pe-preview").is(":visible")),Common.localStorage.getBool("screen-reader-focus-mode",!1)?!$(document.body).hasClass("focus-mode")&&$(document.body).addClass("focus-mode"):$(document.body).hasClass("focus-mode")&&$(document.body).removeClass("focus-mode")}))}},isFocusMode:function(){return!!a},exitFocusMode:U}},define("common/main/lib/controller/ScreenReaderFocus",(function(){})),define("common/main/lib/view/AdvancedSettingsWindow",[],(function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach((function(i,n){var o=new Common.UI.Button({parentEl:e.find("#slot-category-"+i.panelId),cls:"btn-category "+(i.categoryCls||""),caption:i.panelCaption,iconCls:i.categoryIcon||"",enableToggle:!0,toggleGroup:t.toggleGroup,allowDepress:!1,contentTarget:i.panelId});o.cmpEl.attr("content-target",i.panelId),o.on("click",_.bind(t.onCategoryClick,t,o,n)),t.btnsCategory.push(o)}));var i=e.find(".menu-panel");if(this.content_panel=e.find(".content-panel"),this.content_panel.width(this.contentWidth),e.width((i.length>0?i.outerWidth():0)+this.content_panel.outerWidth()+2),this.options.contentHeight)e.find(".body > .box").css("height",this.options.contentHeight);else if("number"==typeof this.options.height){var n=e.find(".body"),o=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));e.find(".body > .box").css("height",this.options.height-o)}this.content_panels=e.find(".settings-panel"),this.btnsCategory.length>0&&this.btnsCategory[0].toggle(!0,!0);var s=function(){e.width((i.length>0?i.outerWidth():0)+t.content_panel.outerWidth()+2)};$(window).on("resize",s),this.on("close",(function(){$(window).off("resize",s)}))},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"));e.find(".body > .box").css("height",parseInt(i.css("height"))-n)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));void 0===t&&(t=parseInt(e.find(".body > .box").css("height"))),Common.UI.Window.prototype.setHeight.call(this,t+n),e.find(".body > .box").css("height",t)},fixHeight:function(){var t=this.content_panels.filter(".active").height()-this.content_panel.height();t>0&&this.setInnerHeight(parseInt(this.$window.find(".body > .box").css("height"))+t)},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active"),this.fixHeight()},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=t>=0&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var n=this.btnsCategory[i];if(n.isVisible()&&!n.isDisabled()){e=n,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var t=-1;return this.btnsCategory.forEach((function(e,i){e.pressed&&(t=i)})),t},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.fixHeight())},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))})),define("common/main/lib/view/DocumentAccessDialog",[],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout((function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),define("common/main/lib/view/RenameDialog",[],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},getFocusedComponents:function(){return[this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.cls+=" advanced-settings-dlg invisible-borders",(!e.buttons||_.size(e.buttons)<1)&&(e.cls+=" no-footer"),e.contentHeight=e.height,e.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+e.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var e=document.createElement("iframe");e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this);var i=this,n=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:n}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())}),500),e.src=this.url,n.append(e),this.frame=e,this.on("resizing",(function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)}));var o=function(){i.onWindowResize()};$(window).on("resize",o),this.on("close",(function(){$(window).off("resize",o)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=2*this.bordersOffset;i-s<e+this._headerFooterHeight&&(e=i-s-this._headerFooterHeight),n-s<t+o&&(t=n-s-o),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(n-t-o)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),n=this.getHeight(),o=this.resizable?0:this.bordersOffset;if(n<e-2*o+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var s=Math.max(Math.min(this._restoreHeight,e-2*o),this.initConfig.minheight);this.setHeight(s),this.boxEl.css("height",s-this._headerFooterHeight)}var a=this.getTop();a<o?this.$window.css("top",o):a+n>e-o&&this.$window.css("top",e-o-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(e-2*o,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*o,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",o);if(i<t-2*o+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*o),this.initConfig.minwidth));var l=this.getLeft();l<o?this.$window.css("left",o):l+i>t-o&&this.$window.css("left",t-o-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*o,this.initConfig.minwidth)),this.$window.css("left",o)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),e="id-plugindlg-docked",i=t.find("#"+e);if(i.length<1){(i=$('<div id="'+e+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=i.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(i),i.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}i.show(),t.removeClass("hidden")},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),n=i.find("#id-plugindlg-"+t);if(n.length<1){var o="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+o+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(n)}n.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginPanel",[],(function(){"use strict";Common.Views.PluginPanel=Common.UI.BaseView.extend(_.extend({template:_.template(['<div class="current-plugin-box layout-ct vbox">','<div class="current-plugin-frame">',"</div>",'<div class="current-plugin-header">','<div class="tools">','<div class="plugin-close close"></div>','<div class="plugin-hide"></div>',"</div>","<label></label>","</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._state={},this.menu||(this.menu="left"),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$(".current-plugin-header label",this.$el),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$(".current-plugin-box",this.$el),this.currentPluginFrame=$(".current-plugin-frame",this.$el),this.pluginClose=new Common.UI.Button({parentEl:this.$el.find(".plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.sideMenuButton&&(this.pluginHide=new Common.UI.Button({parentEl:this.$el.find(".plugin-hide"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-panel-left-collapse",hint:this.textHidePanel})),this.isCanDocked&&this.showDockedButton(),this.trigger("render:after",this),this},showDockedButton:function(){var t=this.$el.find(".current-plugin-header .tools"),e="plugin-undock",i=t.find("."+e);i.length<1&&(i=$('<div class="'+e+'"></div>'),this.$el.find(".plugin-close").after(i),new Common.UI.Button({parentEl:this.$el.find("."+e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-unpin",hint:this.textUndock}).on("click",_.bind((function(){this.fireEvent("docked",this.iframePlugin.id)}),this)));i.show(),t.removeClass("hidden")},openInsideMode:function(t,e,i,n){return this.pluginName||this.render(),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=n,!0},closeInsideMode:function(){this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this._state.insidePlugin=void 0},_onLoad:function(){this.loadMask&&this.loadMask.hide()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},enablePointerEvents:function(t){this.iframePlugin&&(this.iframePlugin.style.pointerEvents=t?"":"none")},textClosePanel:"Close plugin",textLoading:"Loading",textUndock:"Unpin plugin",textHidePanel:"Collapse plugin"},Common.Views.PluginPanel||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var e={},i=this;_.extend(e,{header:!1,label:t.label||i.textUrl,inputConfig:{allowBlank:!1,blankError:i.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||i.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,e)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/DocumentHolderExt",[],(function(){"use strict";var t=window.DE||window.PDFE||window.PDFE||window.PE||window.SSE||window.VE;if(t&&t.Views&&t.Views.DocumentHolder){var e=t.Views.DocumentHolder.prototype;e.addEquationMenu=function(t,e){if(t){var i=this;i.clearEquationMenu(t,e);var n=i.initEquationMenu();return n.length>0&&_.each(n,(function(n,o){n.menu?_.each(n.menu.items,(function(t){t.on("click",_.bind(i.equationCallback,i,t.options.equationProps))})):n.on("click",_.bind(i.equationCallback,i,n.options.equationProps)),t.insertItem(e,n),e++})),n.length}},e.clearEquationMenu=function(t,e){for(var i=e;i<t.items.length&&t.items[i].options.equation;i++)t.items[i].menu?_.each(t.items[i].menu.items,(function(t){t.off("click")})):t.items[i].off("click"),t.removeItem(t.items[i]),i--},e.equationCallback=function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&e[t.callback](t.value)}this.fireEvent("equation:callback",[e])},e.initEquationMenu=function(){var t=this._currentTranslateObj;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),n=t._currentMathObj,o=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:n.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!n.get_HideTop()}},{caption:n.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!n.get_HideBottom()}},{caption:n.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!n.get_HideLeft()}},{caption:n.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!n.get_HideRight()}},{caption:n.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!n.get_HideHor()}},{caption:n.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!n.get_HideVer()}},{caption:n.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!n.get_HideTopLTR()}},{caption:n.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!n.get_HideTopRTL()}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var s=n.get_ScriptType();s==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)):(s==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),o.push(e)),s!=Asc.c_oAscMathInterfaceScript.SubSup&&s!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:s==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)),s!=Asc.c_oAscMathInterfaceScript.SubSup&&s!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:s==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),o.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:var a=n.get_FractionType();a!=Asc.c_oAscMathInterfaceFraction.Skewed&&a!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),o.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),o.push(e)),a!=Asc.c_oAscMathInterfaceFraction.Bar&&a!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:a==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:a==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:n.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!n.get_HidePlaceholder()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),o.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),o.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:n.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),o.push(e),void 0!==n.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:n.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!n.get_HideUpper()}}),o.push(e)),void 0!==n.get_HideLower()&&(e=new Common.UI.MenuItem({caption:n.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!n.get_HideLower()}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),o.push(e),n.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),o.push(e)),e=new Common.UI.MenuItem({caption:n.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!n.get_HideOpeningBracket()}}),o.push(e),e=new Common.UI.MenuItem({caption:n.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!n.get_HideClosingBracket()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!n.get_StretchBrackets()}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!n.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets()&&n.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!n.get_MatchBrackets()}}),o.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:n.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),o.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),o.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==n.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:n.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!n.get_HideDegree()}}),o.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),o.push(e)}return n.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),o.push(e)),n.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),o.push(e)),n.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),o.push(e)),n.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),o.push(e)),n.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),o.push(e)),o}},e.updateCustomItems=function(t,e){if(t&&e&&!(e.length<1)){var i=this,n=i.mode&&i.mode.lang?i.mode.lang.split(/[\-_]/)[0]:"en";i._preventCustomClick&&clearTimeout(i._preventCustomClick),i._hasCustomItems&&(i._preventCustomClick=setTimeout((function(){i._preventCustomClick=null}),500)),i._hasCustomItems=!0;var o,s=function(e,i){if(t&&t.items.length>0)for(var n=t.items.length-1;n>=0;n--)if(t.items[n].isCustomItem&&(void 0===i&&t.items[n].options.guid===e||t.items[n].options.guid===e&&t.items[n].value===i))return t.items[n]},a=function(t,e,o){var s=!1;return o?o.removeAll():((o=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,n){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),o.on("menu:click",(function(t,e){i._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&o.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&o.addItem(new Common.UI.MenuItemCustom({caption:("object"==_typeof(t.text)?t.text[n]||t.text.en:t.text)||"",value:t.id,guid:e,menu:!!t.items&&a(t.items,e),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled})),s=s||!!t.icons})),s&&(o.cmpEl?o.cmpEl.toggleClass("shifted-right",!0):o.options.cls="shifted-right"),o};if(e.forEach((function(e){var l=!s(e.guid);e&&e.items&&e.items.length>0&&e.items.forEach((function(r){if(r.separator&&l&&t.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e.guid})),r.text){var c=s(e.guid,r.id),d=("object"==_typeof(r.text)?r.text[n]||r.text.en:r.text)||"";if(c)c.setCaption(d),c.setDisabled(!!r.disabled),r.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,o=c.cmpEl),a(r.items,e.guid,c.menu)):c.setMenu(a(r.items,e.guid)));else{c=new Common.UI.MenuItemCustom({caption:d,value:r.id,guid:e.guid,menu:!!(r.items&&r.items.length>=0)&&a(r.items,e.guid),iconsSet:r.icons,baseUrl:"",disabled:!!r.disabled}).on("click",(function(t,e){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));t.addItem(c)}}}))})),o){var l=$("> [role=menu]",o).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}t.alignPosition()}},e.clearCustomItems=function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}}})),void 0===Common)Common={};define("common/main/lib/view/CustomizeQuickAccessDialog",[],(function(){"use strict";Common.Views.CustomizeQuickAccessDialog=Common.UI.Window.extend(_.extend({options:{width:296,style:"min-width: 296px;",cls:"modal-dlg quick-access-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<label class="padding-medium">'+this.textMsg+"</label>",'<div class="padding-small" id="quick-access-chb-save"></div>','<div class="padding-small" id="quick-access-chb-print"></div>','<div class="padding-small" id="quick-access-chb-quick-print" style="display:none;"></div>','<div class="padding-small" id="quick-access-chb-undo"></div>','<div class="padding-small" id="quick-access-chb-redo"></div>','<div class="padding-small" id="quick-access-chb-start-over" style="display:none;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.focusedComponents=[],this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.showSave&&(this.chSave=new Common.UI.CheckBox({el:$("#quick-access-chb-save"),labelText:this.options.mode&&(this.options.mode.canSaveToFile||this.options.mode.isDesktopApp&&this.options.mode.isOffline)?this.textSave:this.textDownload,value:this.props.save}),this.focusedComponents.push(this.chSave)),this.options.showPrint&&(this.chPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-print"),labelText:this.textPrint,value:this.props.print}),this.focusedComponents.push(this.chPrint)),this.options.showQuickPrint&&(this.chQuickPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-quick-print"),labelText:this.textQuickPrint,value:this.props.quickPrint}),this.focusedComponents.push(this.chQuickPrint),this.chQuickPrint.show()),this.chUndo=new Common.UI.CheckBox({el:$("#quick-access-chb-undo"),labelText:this.textUndo,value:this.props.undo}),this.focusedComponents.push(this.chUndo),this.chRedo=new Common.UI.CheckBox({el:$("#quick-access-chb-redo"),labelText:this.textRedo,value:this.props.redo}),this.focusedComponents.push(this.chRedo),window.PE&&(this.chStartOver=new Common.UI.CheckBox({el:$("#quick-access-chb-start-over"),labelText:this.textStartOver,value:this.props.startOver}),this.focusedComponents.push(this.chStartOver),this.chStartOver.show())},getFocusedComponents:function(){return this.focusedComponents.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.focusedComponents[0]},onBtnClick:function(t){"ok"===t.currentTarget.attributes.result.value&&Common.NotificationCenter.trigger("quickaccess:changed",{save:this.chSave?"checked"===this.chSave.getValue():void 0,print:this.chPrint?"checked"===this.chPrint.getValue():void 0,quickPrint:this.chQuickPrint?"checked"===this.chQuickPrint.getValue():void 0,undo:"checked"===this.chUndo.getValue(),redo:"checked"===this.chRedo.getValue(),startOver:this.chStartOver?"checked"===this.chStartOver.getValue():void 0}),this.close()},textTitle:"Customize quick access",textMsg:"Check the commands that will be displayed on the Quick Access Toolbar",textSave:"Save",textPrint:"Print",textQuickPrint:"Quick Print",textUndo:"Undo",textRedo:"Redo",textDownload:"Download file"},Common.Views.CustomizeQuickAccessDialog||{}))})),define("visioeditor/main/app/view/FileMenuPanels",[],(function(){"use strict";!VE.Views.FileMenuPanels&&(VE.Views.FileMenuPanels={}),VE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"VSDX",imgCls:"vsdx",type:Asc.c_oAscFileType.VSDX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"vsdx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"VE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,parseInt(e.value)])},textDownloadAs:"Download as"}),VE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"VSDX",imgCls:"vsdx",type:Asc.c_oAscFileType.VSDX,ext:".vsdx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"vsdx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"VE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("savecopy:format",[this.menu,parseInt(e.value),i.value])},textSaveCopyAs:"Save Copy as"}),VE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="appearance">','<td colspan="2" class="group-name"><label><%= scope.txtAppearance %></label></td>',"</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>",'<td><span id="fms-cmb-theme"></span></td>',"</tr>",'<tr class="tab-style">',"<td><label><%= scope.strTabStyle %></label></td>",'<td><div id="fms-cmb-tab-style"></div></td>',"</tr>",'<tr class="tab-background">','<td colspan="2"><div id="fms-chb-tab-background"></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-scrn-reader"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="edit quick-access">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-customize-quick-access" style="width:auto;display:inline-block;padding-right:10px;padding-left:10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomizeQuickAccess %></button></div></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chScreenReader=new Common.UI.CheckBox({el:i.findById("#fms-chb-scrn-reader"),labelText:this.txtScreenReader,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitPage},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var n=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));return this.cmbFontRender=new Common.UI.ComboBox({el:i.findById("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:n,data:[{value:Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling,displayValue:this.txtWin},{value:Asc.c_oAscFontRenderingModeType.noHinting,displayValue:this.txtMac},{value:Asc.c_oAscFontRenderingModeType.hinting,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.btnCustomizeQuickAccess=new Common.UI.Button({el:i.findById("#fms-btn-customize-quick-access")}),this.btnCustomizeQuickAccess.on("click",_.bind(this.customizeQuickAccess,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTabStyle=new Common.UI.ComboBox({el:i.findById("#fms-cmb-tab-style"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",data:[{value:"fill",displayValue:this.textFill},{value:"line",displayValue:this.textLine}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chTabBack=new Common.UI.CheckBox({el:i.findById("#fms-chb-tab-background"),labelText:this.txtTabBack,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()),this.cmbZoom.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFontRender.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTheme.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTabStyle.options.menuAlignEl=t?this.pnlSettings:null}},setMode:function(t){this.mode=t,$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.compactHeader&&t.isEdit?"hide":"show"](),$("tr.tab-background",this.el)[!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)?"show":"hide"](),$("tr.tab-style",this.el)[Common.Utils.isIE||Common.Controllers.Desktop.isWinXp()||!Common.UI.FeaturesManager.canChange("tabStyle",!0)?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.appearance",this.el)[Common.Utils.isIE?"hide":"show"](),t.compactHeader&&$("tr.quick-access",this.el).hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("ve-settings-show-alt-hints")),this.chScreenReader.setValue(Common.Utils.InternalSettings.get("app-settings-screen-reader"));var t=Common.Utils.InternalSettings.get("ve-settings-zoom");t=null!==t?parseInt(t):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):-1;var e=this.cmbZoom.store.findWhere({value:t});this.cmbZoom.setValue(e?parseInt(e.get("value")):t>0?t+"%":100),t=Common.Utils.InternalSettings.get("ve-settings-fontrender"),e=this.cmbFontRender.store.findWhere({value:parseInt(t)}),this.cmbFontRender.setValue(e?e.get("value"):Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling),this._fontRender=this.cmbFontRender.getValue(),t=Common.Utils.InternalSettings.get("ve-settings-cachemode"),(e=this.cmbFontRender.store.findWhere({value:"custom"}))&&t&&e.set("checked",!!t),e&&t&&this.cmbFontRender.cmpEl.find("#"+e.get("id")+" a").addClass("checked");var i=[];for(var n in Common.UI.Themes.map())i.push({value:n,displayValue:Common.UI.Themes.get(n).text});i.length&&(this.cmbTheme.setData(i),e=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(e?e.get("value"):Common.UI.Themes.defaultThemeId())),this.chTabBack.setValue("toolbar"===Common.Utils.InternalSettings.get("settings-tab-background")),t=Common.Utils.InternalSettings.get("settings-tab-style"),e=this.cmbTabStyle.store.findWhere({value:t}),this.cmbTabStyle.setValue(e?e.get("value"):"fill")},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),Common.localStorage.setItem("ve-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("ve-settings-show-alt-hints",Common.localStorage.getBool("ve-settings-show-alt-hints")),Common.localStorage.setItem("ve-settings-zoom",this.cmbZoom.getValue()),Common.localStorage.setItem("app-settings-screen-reader",this.chScreenReader.isChecked()?1:0),Common.localStorage.setItem("ve-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("ve-settings-cachemode",t&&!t.get("checked")?0:1),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)&&Common.UI.TabStyler.setBackground(this.chTabBack.isChecked()?"toolbar":"header"),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabStyle",!0)&&Common.UI.TabStyler.setStyle(this.cmbTabStyle.getValue()),Common.localStorage.save(),this.menu&&this.menu.fireEvent("settings:apply",[this.menu])},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},customizeQuickAccess:function(){this.dlgQuickAccess&&this.dlgQuickAccess.isVisible()||(this.dlgQuickAccess=new Common.Views.CustomizeQuickAccessDialog({showSave:this.mode.showSaveButton&&Common.UI.LayoutManager.isElementVisible("header-save"),showPrint:this.mode.canPrint&&this.mode.twoLevelHeader,showQuickPrint:this.mode.canQuickPrint&&this.mode.twoLevelHeader,mode:this.mode,props:{print:Common.localStorage.getBool("ve-quick-access-print",!0),quickPrint:Common.localStorage.getBool("ve-quick-access-quick-print",!0)}}),this.dlgQuickAccess.show())},strZoom:"Default Zoom Value",okButtonText:"Apply",txtFitPage:"Fit to Page",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",txtFitWidth:"Fit to Width",txtCacheMode:"Default cache mode",strMacrosSettings:"Macros Settings",txtWarnMacros:"Show Notification",txtRunMacros:"Enable All",txtStopMacros:"Disable All",txtWarnMacrosDesc:"Disable all macros with notification",txtRunMacrosDesc:"Enable all macros without notification",txtStopMacrosDesc:"Disable all macros without notification",strTheme:"Theme",txtThemeLight:"Light",txtThemeDark:"Dark",txtWorkspace:"Workspace",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use Option key to navigate the user interface using the keyboard",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtLastUsed:"Last used",txtScreenReader:"Turn on screen reader support",txtCustomizeQuickAccess:"Customize quick access",txtTabBack:"Use toolbar color as tabs background",strTabStyle:"Tab style",textFill:"Fill",textLine:"Line",txtAppearance:"Appearance"},VE.Views.FileMenuPanels.Settings||{})),VE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="blank-document-btn">','<div class="btn-blank-format"><div class="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="thumb" ',"<%  if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank document",txtCreateNew:"Create New"},VE.Views.FileMenuPanels.CreateNew||{})),VE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<table class="main">','<tbody><td class="header">'+this.txtVisioInfo+"</td></tbody>","<tbody>",'<tr><td class="title"><label>'+this.txtCommon+"</label></td></tr>","<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>","<tr></tr>","<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>","</tbody>",'<tbody class="properties-tab">','<tr><td class="title"><label>'+this.txtProperties+"</label></td></tr>",'<tr class="author-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>","</tbody>","</table>"].join("")),this.menu=t.menu,this.coreProps=null,this.authors=[],this._locked=!1},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded");var n=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),n=t.getValue();i!==n&&(t.setValue(n),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putTitle(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putKeywords(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putSubject(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putDescription(i),e.api.asc_setCoreProps(e.coreProps)})),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}" ></div><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var n=i.find(t.target);if(n.hasClass("close")&&!n.hasClass("disabled")){var o=n.closest("tr"),s=e.tblAuthor.find("tr").index(o);o.remove(),e.authors.splice(s,1),e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",(function(t,i,n,o){if(i!=n){var s=i.trim();if(s&&s!==n.trim()){var a=o&&o.relatedTarget&&"fminfo-btn-apply"==o.relatedTarget.id;s.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!a)){var n=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(n),e.updateScroller()}})),!a&&e.inputAuthor.setValue("")}e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps)}})).on("keydown:before",n),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateScroller:function(t){this.scroller&&this.scroller.update(t?{}:void 0)},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(n=t.info.owner)&&this.lblOwner.text(n),e=this._ShowHideInfoItem(this.lblOwner,!!n)||e,(n=t.info.uploaded)&&this.lblUploaded.text(n),e=this._ShowHideInfoItem(this.lblUploaded,!!n)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getAppProps():null;i&&(i=(i.asc_getApplication()||"")+(i.asc_getAppVersion()?" ":"")+(i.asc_getAppVersion()||""),this.lblApplication.text(i)),this._ShowHideInfoItem(this.lblApplication,!!i),this.coreProps=this.api?this.api.asc_getCoreProps():null;var n=this.coreProps?this.coreProps.asc_getCreated():"";this.lblDate.text(this.dateToString(n)),this._ShowHideInfoItem(this.lblDate,!!n),this.renderCustomProperties()}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;this.coreProps=i;var n=!1;t=i?i.asc_getModified():"",this.lblModifyDate.text(this.dateToString(t)),n=this._ShowHideInfoItem(this.lblModifyDate,!!t)||n,(t=i?i.asc_getLastModifiedBy():"")&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),n=this._ShowHideInfoItem(this.lblModifyBy,!!t)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),t=i?i.asc_getTitle():"",this.inputTitle.setValue(t||""),t=i?i.asc_getKeywords():"",this.inputTags.setValue(t||""),t=i?i.asc_getSubject():"",this.inputSubject.setValue(t||""),t=i?i.asc_getDescription():"",this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i?i.asc_getCreator():"")&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),!this.mode.isEdit&&this._ShowHideInfoItem(this.tblAuthor,!!this.authors.length),this.SetDisabled()}},tplCustomProperty:function(t,e,i){return e===AscCommon.c_oVariantTypes.vtBool?i=i?this.txtYes:this.txtNo:e===AscCommon.c_oVariantTypes.vtFiletime&&(i=this.dateToString(new Date(i),!0)),'<tr data-custom-property><td class="left"><label>'+Common.Utils.String.htmlEncode(t)+'</label></td><td class="right"><div class="custom-property-wrapper"><input type="text" spellcheck="false" class="form-control" readonly style="width: 200px;" value="'+i+'"><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></div></td></tr>'},dateToString:function(t,e){var i="";if(t){var n=(this.mode.lang||"en").replace("_","-").toLowerCase();try{n=="ar-SA".toLowerCase()&&(n+="-u-nu-latn-ca-gregory"),i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}catch(o){n="en",i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}}return i},renderCustomProperties:function(){if(this.api){$("tr[data-custom-property]").remove();var t=this.api.asc_getAllCustomProperties();_.each(t,_.bind((function(t,e){var i=this,n=t.asc_getName(),o=t.asc_getType(),s=t.asc_getValue(),a=$(this.tplCustomProperty(n,o,s));$("tbody.properties-tab").append(a),a.on("click",(function(t){if(!a.find("div.disabled").length){var e=a.find(t.target);e.hasClass("close")?i.renderCustomProperties():e.hasClass("form-control")}}))}),this))}},setDisabledCustomProperties:function(t){_.each($("tr[data-custom-property]"),(function(e){$(e).find("div.custom-property-wrapper")[t?"addClass":"removeClass"]("disabled"),$(e).find("div.close")[t?"hide":"show"]()}))},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),t.isEdit||(this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder","")),this.SetDisabled(),this},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},onLockCore:function(t){this._locked=t,this.updateFileInfo()},SetDisabled:function(){var t=!this.mode.isEdit||this._locked;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._locked),this.tblAuthor.toggleClass("disabled",t),this.setDisabledCustomProperties(t)},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtAppName:"Application",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtVisioInfo:"Document Info",txtCommon:"Common",txtProperties:"Properties",txtDocumentPropertyUpdateTitle:"Document Property",txtYes:"Yes",txtNo:"No"},VE.Views.FileMenuPanels.DocumentInfo||{})),VE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary auto">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.findById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},VE.Views.FileMenuPanels.DocumentRights||{})),VE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Visio Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new document or open an existing one",headername:"Basic operations"},{src:"UsageInstructions/ViewVisioInfo.htm",name:"View document information",headername:"Tools and settings"},{src:"HelpfulHints/About.htm",name:"About Visio Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic documents"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,n){t.onSelectItem(n.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var n={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(n)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(n)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(n),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}})})),define("visioeditor/main/app/view/DocumentHolderExt",[],(function(){"use strict";if(window.VE&&window.VE.Views&&window.VE.Views.DocumentHolder){var t=window.VE.Views.DocumentHolder.prototype;t.createDelayedElementsViewer=function(){var t=this;t.menuViewCopy||(t.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){t.menuViewCopy.setDisabled(!(t.api&&t.api.can_CopyCut()))},items:[t.menuViewCopy]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"view"]))},t.createDelayedElementsEditor=function(){var t=this;t.menuEditCopy||(t.menuEditCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),this.editModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){t.menuEditCopy.setDisabled(!(t.api&&t.api.can_CopyCut()))},items:[t.menuEditCopy]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"edit"]))}}})),require(["common/main/lib/controller/ScreenReaderFocus","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/DocumentAccessDialog","common/main/lib/view/SaveAsDlg","common/main/lib/view/CopyWarningDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/RenameDialog","common/main/lib/view/PluginDlg","common/main/lib/view/PluginPanel","common/main/lib/view/TextInputDialog","common/main/lib/view/DocumentHolderExt","common/main/lib/view/CustomizeQuickAccessDialog","visioeditor/main/app/view/FileMenuPanels","visioeditor/main/app/view/DocumentHolderExt"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/visioeditor/main/app_pack.js",(function(){}));