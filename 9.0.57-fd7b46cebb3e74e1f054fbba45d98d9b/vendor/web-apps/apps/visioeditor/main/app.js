/*!
 * Copyright (c) Ascensio System SIA 2025. All rights reserved
 *
 * http://www.onlyoffice.com 
 *
 * Version: 9.0.57 (build:1)
 */
if(function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var i=[],n=Object.getPrototypeOf,o=i.slice,s=i.flat?function(t){return i.flat.call(t)}:function(t){return i.concat.apply([],t)},a=i.push,r=i.indexOf,l={},c=l.toString,h=l.hasOwnProperty,d=h.toString,u=d.call(Object),m={},p=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},f=function(t){return null!=t&&t===t.window},g=t.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function v(t,e,i){var n,o,s=(i=i||g).createElement("script");if(s.text=t,e)for(n in b)(o=e[n]||e.getAttribute&&e.getAttribute(n))&&s.setAttribute(n,o);i.head.appendChild(s).parentNode.removeChild(s)}function C(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t}var w="3.7.1",y=/HTML$/i,x=function(t,e){return new x.fn.init(t,e)};function _(t){var e=!!t&&"length"in t&&t.length,i=C(t);return!p(t)&&!f(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function k(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}x.fn=x.prototype={jquery:w,constructor:x,length:0,toArray:function(){return o.call(this)},get:function(t){return null==t?o.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=x.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return x.each(this,t)},map:function(t){return this.pushStack(x.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},x.extend=x.fn.extend=function(){var t,e,i,n,o,s,a=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[r]||{},r++),"object"==typeof a||p(a)||(a={}),r===l&&(a=this,r--);r<l;r++)if(null!=(t=arguments[r]))for(e in t)n=t[e],"__proto__"!==e&&a!==n&&(c&&n&&(x.isPlainObject(n)||(o=Array.isArray(n)))?(i=a[e],s=o&&!Array.isArray(i)?[]:o||x.isPlainObject(i)?i:{},o=!1,a[e]=x.extend(c,s,n)):void 0!==n&&(a[e]=n));return a},x.extend({expando:"jQuery"+(w+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==c.call(t))&&(!(e=n(t))||"function"==typeof(i=h.call(e,"constructor")&&e.constructor)&&d.call(i)===u)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){v(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(_(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},text:function(t){var e,i="",n=0,o=t.nodeType;if(!o)for(;e=t[n++];)i+=x.text(e);return 1===o||11===o?t.textContent:9===o?t.documentElement.textContent:3===o||4===o?t.nodeValue:i},makeArray:function(t,e){var i=e||[];return null!=t&&(_(Object(t))?x.merge(i,"string"==typeof t?[t]:t):a.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},isXMLDoc:function(t){var e=t&&t.namespaceURI,i=t&&(t.ownerDocument||t).documentElement;return!y.test(e||i&&i.nodeName||"HTML")},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;n<i;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,s=t.length,a=!i;o<s;o++)!e(t[o],o)!==a&&n.push(t[o]);return n},map:function(t,e,i){var n,o,a=0,r=[];if(_(t))for(n=t.length;a<n;a++)null!=(o=e(t[a],a,i))&&r.push(o);else for(a in t)null!=(o=e(t[a],a,i))&&r.push(o);return s(r)},guid:1,support:m}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=i[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var I=i.pop,S=i.sort,E=i.splice,T="[\\x20\\t\\r\\n\\f]",M=new RegExp("^"+T+"+|((?:^|[^\\\\])(?:\\\\.)*)"+T+"+$","g");x.contains=function(t,e){var i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(t.contains?t.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))};var A=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function U(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}x.escapeSelector=function(t){return(t+"").replace(A,U)};var D=g,P=a;!function(){var e,n,s,a,l,c,d,u,p,f,g=P,b=x.expando,v=0,C=0,w=tt(),y=tt(),_=tt(),A=tt(),U=function(t,e){return t===e&&(l=!0),0},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="(?:\\\\[\\da-fA-F]{1,6}"+T+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",R="\\["+T+"*("+O+")(?:"+T+"*([*^$|!~]?=)"+T+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+T+"*\\]",F=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|.*)\\)|)",$=new RegExp(T+"+","g"),B=new RegExp("^"+T+"*,"+T+"*"),V=new RegExp("^"+T+"*([>+~]|"+T+")"+T+"*"),H=new RegExp(T+"|>"),N=new RegExp(F),z=new RegExp("^"+O+"$"),j={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+T+"*(even|odd|(([+-]|)(\\d*)n|)"+T+"*(?:([+-]|)"+T+"*(\\d+)|))"+T+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+T+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+T+"*((?:-\\d)?\\d*)"+T+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/[+~]/,X=new RegExp("\\\\[\\da-fA-F]{1,6}"+T+"?|\\\\([^\\r\\n\\f])","g"),Y=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},Z=function(){lt()},J=ut((function(t){return!0===t.disabled&&k(t,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(i=o.call(D.childNodes),D.childNodes),i[D.childNodes.length].nodeType}catch(t){g={apply:function(t,e){P.apply(t,o.call(e))},call:function(t){P.apply(t,o.call(arguments,1))}}}function Q(t,e,i,n){var o,s,a,r,l,h,d,f=e&&e.ownerDocument,v=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==v&&9!==v&&11!==v)return i;if(!n&&(lt(e),e=e||c,u)){if(11!==v&&(l=K.exec(t)))if(o=l[1]){if(9===v){if(!(a=e.getElementById(o)))return i;if(a.id===o)return g.call(i,a),i}else if(f&&(a=f.getElementById(o))&&Q.contains(e,a)&&a.id===o)return g.call(i,a),i}else{if(l[2])return g.apply(i,e.getElementsByTagName(t)),i;if((o=l[3])&&e.getElementsByClassName)return g.apply(i,e.getElementsByClassName(o)),i}if(!(A[t+" "]||p&&p.test(t))){if(d=t,f=e,1===v&&(H.test(t)||V.test(t))){for((f=G.test(t)&&rt(e.parentNode)||e)==e&&m.scope||((r=e.getAttribute("id"))?r=x.escapeSelector(r):e.setAttribute("id",r=b)),s=(h=ht(t)).length;s--;)h[s]=(r?"#"+r:":scope")+" "+dt(h[s]);d=h.join(",")}try{return g.apply(i,f.querySelectorAll(d)),i}catch(e){A(t,!0)}finally{r===b&&e.removeAttribute("id")}}}return vt(t.replace(M,"$1"),e,i,n)}function tt(){var t=[];return function e(i,o){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=o}}function et(t){return t[b]=!0,t}function it(t){var e=c.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function nt(t){return function(e){return k(e,"input")&&e.type===t}}function ot(t){return function(e){return(k(e,"input")||k(e,"button"))&&e.type===t}}function st(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&J(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function at(t){return et((function(e){return e=+e,et((function(i,n){for(var o,s=t([],i.length,e),a=s.length;a--;)i[o=s[a]]&&(i[o]=!(n[o]=i[o]))}))}))}function rt(t){return t&&void 0!==t.getElementsByTagName&&t}function lt(t){var e,i=t?t.ownerDocument||t:D;return i!=c&&9===i.nodeType&&i.documentElement?(d=(c=i).documentElement,u=!x.isXMLDoc(c),f=d.matches||d.webkitMatchesSelector||d.msMatchesSelector,d.msMatchesSelector&&D!=c&&(e=c.defaultView)&&e.top!==e&&e.addEventListener("unload",Z),m.getById=it((function(t){return d.appendChild(t).id=x.expando,!c.getElementsByName||!c.getElementsByName(x.expando).length})),m.disconnectedMatch=it((function(t){return f.call(t,"*")})),m.scope=it((function(){return c.querySelectorAll(":scope")})),m.cssHas=it((function(){try{return c.querySelector(":has(*,:jqfake)"),!1}catch(t){return!0}})),m.getById?(n.filter.ID=function(t){var e=t.replace(X,Y);return function(t){return t.getAttribute("id")===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&u){var i=e.getElementById(t);return i?[i]:[]}}):(n.filter.ID=function(t){var e=t.replace(X,Y);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&u){var i,n,o,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(o=e.getElementsByName(t),n=0;s=o[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),n.find.TAG=function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):e.querySelectorAll(t)},n.find.CLASS=function(t,e){if(void 0!==e.getElementsByClassName&&u)return e.getElementsByClassName(t)},p=[],it((function(t){var e;d.appendChild(t).innerHTML="<a id='"+b+"' href='' disabled='disabled'></a><select id='"+b+"-\r\\' disabled='disabled'><option selected=''></option></select>",t.querySelectorAll("[selected]").length||p.push("\\["+T+"*(?:value|"+L+")"),t.querySelectorAll("[id~="+b+"-]").length||p.push("~="),t.querySelectorAll("a#"+b+"+*").length||p.push(".#.+[+~]"),t.querySelectorAll(":checked").length||p.push(":checked"),(e=c.createElement("input")).setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),d.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&p.push(":enabled",":disabled"),(e=c.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||p.push("\\["+T+"*name"+T+"*="+T+"*(?:''|\"\")")})),m.cssHas||p.push(":has"),p=p.length&&new RegExp(p.join("|")),U=function(t,e){if(t===e)return l=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!m.sortDetached&&e.compareDocumentPosition(t)===i?t===c||t.ownerDocument==D&&Q.contains(D,t)?-1:e===c||e.ownerDocument==D&&Q.contains(D,e)?1:a?r.call(a,t)-r.call(a,e):0:4&i?-1:1)},c):c}for(e in Q.matches=function(t,e){return Q(t,null,null,e)},Q.matchesSelector=function(t,e){if(lt(t),u&&!A[e+" "]&&(!p||!p.test(e)))try{var i=f.call(t,e);if(i||m.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){A(e,!0)}return Q(e,c,null,[t]).length>0},Q.contains=function(t,e){return(t.ownerDocument||t)!=c&&lt(t),x.contains(t,e)},Q.attr=function(t,e){(t.ownerDocument||t)!=c&&lt(t);var i=n.attrHandle[e.toLowerCase()],o=i&&h.call(n.attrHandle,e.toLowerCase())?i(t,e,!u):void 0;return void 0!==o?o:t.getAttribute(e)},Q.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},x.uniqueSort=function(t){var e,i=[],n=0,s=0;if(l=!m.sortStable,a=!m.sortStable&&o.call(t,0),S.call(t,U),l){for(;e=t[s++];)e===t[s]&&(n=i.push(s));for(;n--;)E.call(t,i[n],1)}return a=null,t},x.fn.uniqueSort=function(){return this.pushStack(x.uniqueSort(o.apply(this)))},n=x.expr={cacheLength:50,createPseudo:et,match:j,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(X,Y),t[3]=(t[3]||t[4]||t[5]||"").replace(X,Y),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||Q.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&Q.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return j.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&N.test(i)&&(e=ht(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(X,Y).toLowerCase();return"*"===t?function(){return!0}:function(t){return k(t,e)}},CLASS:function(t){var e=w[t+" "];return e||(e=new RegExp("(^|"+T+")"+t+"("+T+"|$)"))&&w(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var o=Q.attr(n,t);return null==o?"!="===e:!e||(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o.replace($," ")+" ").indexOf(i)>-1:"|="===e&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,o){var s="nth"!==t.slice(0,3),a="last"!==t.slice(-4),r="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,h,d,u,m,p=s!==a?"nextSibling":"previousSibling",f=e.parentNode,g=r&&e.nodeName.toLowerCase(),C=!l&&!r,w=!1;if(f){if(s){for(;p;){for(d=e;d=d[p];)if(r?k(d,g):1===d.nodeType)return!1;m=p="only"===t&&!m&&"nextSibling"}return!0}if(m=[a?f.firstChild:f.lastChild],a&&C){for(w=(u=(c=(h=f[b]||(f[b]={}))[t]||[])[0]===v&&c[1])&&c[2],d=u&&f.childNodes[u];d=++u&&d&&d[p]||(w=u=0)||m.pop();)if(1===d.nodeType&&++w&&d===e){h[t]=[v,u,w];break}}else if(C&&(w=u=(c=(h=e[b]||(e[b]={}))[t]||[])[0]===v&&c[1]),!1===w)for(;(d=++u&&d&&d[p]||(w=u=0)||m.pop())&&(!(r?k(d,g):1===d.nodeType)||!++w||(C&&((h=d[b]||(d[b]={}))[t]=[v,w]),d!==e)););return(w-=o)===n||w%n==0&&w/n>=0}}},PSEUDO:function(t,e){var i,o=n.pseudos[t]||n.setFilters[t.toLowerCase()]||Q.error("unsupported pseudo: "+t);return o[b]?o(e):o.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?et((function(t,i){for(var n,s=o(t,e),a=s.length;a--;)t[n=r.call(t,s[a])]=!(i[n]=s[a])})):function(t){return o(t,0,i)}):o}},pseudos:{not:et((function(t){var e=[],i=[],n=bt(t.replace(M,"$1"));return n[b]?et((function(t,e,i,o){for(var s,a=n(t,null,o,[]),r=t.length;r--;)(s=a[r])&&(t[r]=!(e[r]=s))})):function(t,o,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:et((function(t){return function(e){return Q(t,e).length>0}})),contains:et((function(t){return t=t.replace(X,Y),function(e){return(e.textContent||x.text(e)).indexOf(t)>-1}})),lang:et((function(t){return z.test(t||"")||Q.error("unsupported lang: "+t),t=t.replace(X,Y).toLowerCase(),function(e){var i;do{if(i=u?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===function(){try{return c.activeElement}catch(t){}}()&&c.hasFocus()&&!!(t.type||t.href||~t.tabIndex)},enabled:st(!1),disabled:st(!0),checked:function(t){return k(t,"input")&&!!t.checked||k(t,"option")&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return q.test(t.nodeName)},input:function(t){return W.test(t.nodeName)},button:function(t){return k(t,"input")&&"button"===t.type||k(t,"button")},text:function(t){var e;return k(t,"input")&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:at((function(){return[0]})),last:at((function(t,e){return[e-1]})),eq:at((function(t,e,i){return[i<0?i+e:i]})),even:at((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:at((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:at((function(t,e,i){var n;for(n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t})),gt:at((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=nt(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ot(e);function ct(){}function ht(t,e){var i,o,s,a,r,l,c,h=y[t+" "];if(h)return e?0:h.slice(0);for(r=t,l=[],c=n.preFilter;r;){for(a in i&&!(o=B.exec(r))||(o&&(r=r.slice(o[0].length)||r),l.push(s=[])),i=!1,(o=V.exec(r))&&(i=o.shift(),s.push({value:i,type:o[0].replace(M," ")}),r=r.slice(i.length)),n.filter)!(o=j[a].exec(r))||c[a]&&!(o=c[a](o))||(i=o.shift(),s.push({value:i,type:a,matches:o}),r=r.slice(i.length));if(!i)break}return e?r.length:r?Q.error(t):y(t,l).slice(0)}function dt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function ut(t,e,i){var n=e.dir,o=e.next,s=o||n,a=i&&"parentNode"===s,r=C++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||a)return t(e,i,o);return!1}:function(e,i,l){var c,h,d=[v,r];if(l){for(;e=e[n];)if((1===e.nodeType||a)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||a)if(h=e[b]||(e[b]={}),o&&k(e,o))e=e[n]||e;else{if((c=h[s])&&c[0]===v&&c[1]===r)return d[2]=c[2];if(h[s]=d,d[2]=t(e,i,l))return!0}return!1}}function mt(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function pt(t,e,i,n,o){for(var s,a=[],r=0,l=t.length,c=null!=e;r<l;r++)(s=t[r])&&(i&&!i(s,n,o)||(a.push(s),c&&e.push(r)));return a}function ft(t,e,i,n,o,s){return n&&!n[b]&&(n=ft(n)),o&&!o[b]&&(o=ft(o,s)),et((function(s,a,l,c){var h,d,u,m,p=[],f=[],b=a.length,v=s||function(t,e,i){for(var n=0,o=e.length;n<o;n++)Q(t,e[n],i);return i}(e||"*",l.nodeType?[l]:l,[]),C=!t||!s&&e?v:pt(v,p,t,l,c);if(i?i(C,m=o||(s?t:b||n)?[]:a,l,c):m=C,n)for(h=pt(m,f),n(h,[],l,c),d=h.length;d--;)(u=h[d])&&(m[f[d]]=!(C[f[d]]=u));if(s){if(o||t){if(o){for(h=[],d=m.length;d--;)(u=m[d])&&h.push(C[d]=u);o(null,m=[],h,c)}for(d=m.length;d--;)(u=m[d])&&(h=o?r.call(s,u):p[d])>-1&&(s[h]=!(a[h]=u))}}else m=pt(m===a?m.splice(b,m.length):m),o?o(null,a,m,c):g.apply(a,m)}))}function gt(t){for(var e,i,o,a=t.length,l=n.relative[t[0].type],c=l||n.relative[" "],h=l?1:0,d=ut((function(t){return t===e}),c,!0),u=ut((function(t){return r.call(e,t)>-1}),c,!0),m=[function(t,i,n){var o=!l&&(n||i!=s)||((e=i).nodeType?d(t,i,n):u(t,i,n));return e=null,o}];h<a;h++)if(i=n.relative[t[h].type])m=[ut(mt(m),i)];else{if((i=n.filter[t[h].type].apply(null,t[h].matches))[b]){for(o=++h;o<a&&!n.relative[t[o].type];o++);return ft(h>1&&mt(m),h>1&&dt(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(M,"$1"),i,h<o&&gt(t.slice(h,o)),o<a&&gt(t=t.slice(o)),o<a&&dt(t))}m.push(i)}return mt(m)}function bt(t,e){var i,o=[],a=[],r=_[t+" "];if(!r){for(e||(e=ht(t)),i=e.length;i--;)(r=gt(e[i]))[b]?o.push(r):a.push(r);r=_(t,function(t,e){var i=e.length>0,o=t.length>0,a=function(a,r,l,h,d){var m,p,f,b=0,C="0",w=a&&[],y=[],_=s,k=a||o&&n.find.TAG("*",d),S=v+=null==_?1:Math.random()||.1,E=k.length;for(d&&(s=r==c||r||d);C!==E&&null!=(m=k[C]);C++){if(o&&m){for(p=0,r||m.ownerDocument==c||(lt(m),l=!u);f=t[p++];)if(f(m,r||c,l)){g.call(h,m);break}d&&(v=S)}i&&((m=!f&&m)&&b--,a&&w.push(m))}if(b+=C,i&&C!==b){for(p=0;f=e[p++];)f(w,y,r,l);if(a){if(b>0)for(;C--;)w[C]||y[C]||(y[C]=I.call(h));y=pt(y)}g.apply(h,y),d&&!a&&y.length>0&&b+e.length>1&&x.uniqueSort(h)}return d&&(v=S,s=_),w};return i?et(a):a}(a,o)),r.selector=t}return r}function vt(t,e,i,o){var s,a,r,l,c,h="function"==typeof t&&t,d=!o&&ht(t=h.selector||t);if(i=i||[],1===d.length){if((a=d[0]=d[0].slice(0)).length>2&&"ID"===(r=a[0]).type&&9===e.nodeType&&u&&n.relative[a[1].type]){if(!(e=(n.find.ID(r.matches[0].replace(X,Y),e)||[])[0]))return i;h&&(e=e.parentNode),t=t.slice(a.shift().value.length)}for(s=j.needsContext.test(t)?0:a.length;s--&&(r=a[s],!n.relative[l=r.type]);)if((c=n.find[l])&&(o=c(r.matches[0].replace(X,Y),G.test(a[0].type)&&rt(e.parentNode)||e))){if(a.splice(s,1),!(t=o.length&&dt(a)))return g.apply(i,o),i;break}}return(h||bt(t,d))(o,e,!u,i,!e||G.test(t)&&rt(e.parentNode)||e),i}ct.prototype=n.filters=n.pseudos,n.setFilters=new ct,m.sortStable=b.split("").sort(U).join("")===b,lt(),m.sortDetached=it((function(t){return 1&t.compareDocumentPosition(c.createElement("fieldset"))})),x.find=Q,x.expr[":"]=x.expr.pseudos,x.unique=x.uniqueSort,Q.compile=bt,Q.select=vt,Q.setDocument=lt,Q.tokenize=ht,Q.escape=x.escapeSelector,Q.getText=x.text,Q.isXML=x.isXMLDoc,Q.selectors=x.expr,Q.support=x.support,Q.uniqueSort=x.uniqueSort}();var L=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&x(t).is(i))break;n.push(t)}return n},O=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},R=x.expr.match.needsContext,F=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(t,e,i){return p(e)?x.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?x.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?x.grep(t,(function(t){return r.call(e,t)>-1!==i})):x.filter(e,t,i)}x.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?x.find.matchesSelector(n,t)?[n]:[]:x.find.matches(t,x.grep(e,(function(t){return 1===t.nodeType})))},x.fn.extend({find:function(t){var e,i,n=this.length,o=this;if("string"!=typeof t)return this.pushStack(x(t).filter((function(){for(e=0;e<n;e++)if(x.contains(o[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)x.find(t,o[e],i);return n>1?x.uniqueSort(i):i},filter:function(t){return this.pushStack($(this,t||[],!1))},not:function(t){return this.pushStack($(this,t||[],!0))},is:function(t){return!!$(this,"string"==typeof t&&R.test(t)?x(t):t||[],!1).length}});var B,V=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(t,e,i){var n,o;if(!t)return this;if(i=i||B,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:V.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof x?e[0]:e,x.merge(this,x.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:g,!0)),F.test(n[1])&&x.isPlainObject(e))for(n in e)p(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(o=g.getElementById(n[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?void 0!==i.ready?i.ready(t):t(x):x.makeArray(t,this)}).prototype=x.fn,B=x(g);var H=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function z(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}x.fn.extend({has:function(t){var e=x(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(x.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,o=this.length,s=[],a="string"!=typeof t&&x(t);if(!R.test(t))for(;n<o;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&x.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?x.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?r.call(x(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),x.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return L(t,"parentNode")},parentsUntil:function(t,e,i){return L(t,"parentNode",i)},next:function(t){return z(t,"nextSibling")},prev:function(t){return z(t,"previousSibling")},nextAll:function(t){return L(t,"nextSibling")},prevAll:function(t){return L(t,"previousSibling")},nextUntil:function(t,e,i){return L(t,"nextSibling",i)},prevUntil:function(t,e,i){return L(t,"previousSibling",i)},siblings:function(t){return O((t.parentNode||{}).firstChild,t)},children:function(t){return O(t.firstChild)},contents:function(t){return null!=t.contentDocument&&n(t.contentDocument)?t.contentDocument:(k(t,"template")&&(t=t.content||t),x.merge([],t.childNodes))}},(function(t,e){x.fn[t]=function(i,n){var o=x.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=x.filter(n,o)),this.length>1&&(N[t]||x.uniqueSort(o),H.test(t)&&o.reverse()),this.pushStack(o)}}));var j=/[^\x20\t\r\n\f]+/g;function W(t){return t}function q(t){throw t}function K(t,e,i,n){var o;try{t&&p(o=t.promise)?o.call(t).done(e).fail(i):t&&p(o=t.then)?o.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}x.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return x.each(t.match(j)||[],(function(t,i){e[i]=!0})),e}(t):x.extend({},t);var e,i,n,o,s=[],a=[],r=-1,l=function(){for(o=o||t.once,n=e=!0;a.length;r=-1)for(i=a.shift();++r<s.length;)!1===s[r].apply(i[0],i[1])&&t.stopOnFalse&&(r=s.length,i=!1);t.memory||(i=!1),e=!1,o&&(s=i?[]:"")},c={add:function(){return s&&(i&&!e&&(r=s.length-1,a.push(i)),function e(i){x.each(i,(function(i,n){p(n)?t.unique&&c.has(n)||s.push(n):n&&n.length&&"string"!==C(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return x.each(arguments,(function(t,e){for(var i;(i=x.inArray(e,s,i))>-1;)s.splice(i,1),i<=r&&r--})),this},has:function(t){return t?x.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=a=[],i||e||(s=i=""),this},locked:function(){return!!o},fireWith:function(t,i){return o||(i=[t,(i=i||[]).slice?i.slice():i],a.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var i=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return o.then(null,t)},pipe:function(){var t=arguments;return x.Deferred((function(e){x.each(i,(function(i,n){var o=p(t[n[4]])&&t[n[4]];s[n[1]]((function(){var t=o&&o.apply(this,arguments);t&&p(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,o?[t]:arguments)}))})),t=null})).promise()},then:function(e,n,o){var s=0;function a(e,i,n,o){return function(){var r=this,l=arguments,c=function(){var t,c;if(!(e<s)){if((t=n.apply(r,l))===i.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,p(c)?o?c.call(t,a(s,i,W,o),a(s,i,q,o)):(s++,c.call(t,a(s,i,W,o),a(s,i,q,o),a(s,i,W,i.notifyWith))):(n!==W&&(r=void 0,l=[t]),(o||i.resolveWith)(r,l))}},h=o?c:function(){try{c()}catch(t){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(t,h.error),e+1>=s&&(n!==q&&(r=void 0,l=[t]),i.rejectWith(r,l))}};e?h():(x.Deferred.getErrorHook?h.error=x.Deferred.getErrorHook():x.Deferred.getStackHook&&(h.error=x.Deferred.getStackHook()),t.setTimeout(h))}}return x.Deferred((function(t){i[0][3].add(a(0,t,p(o)?o:W,t.notifyWith)),i[1][3].add(a(0,t,p(e)?e:W)),i[2][3].add(a(0,t,p(n)?n:q))})).promise()},promise:function(t){return null!=t?x.extend(t,o):o}},s={};return x.each(i,(function(t,e){var a=e[2],r=e[5];o[e[1]]=a.add,r&&a.add((function(){n=r}),i[3-t][2].disable,i[3-t][3].disable,i[0][2].lock,i[0][3].lock),a.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=a.fireWith})),o.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,i=e,n=Array(i),s=o.call(arguments),a=x.Deferred(),r=function(t){return function(i){n[t]=this,s[t]=arguments.length>1?o.call(arguments):i,--e||a.resolveWith(n,s)}};if(e<=1&&(K(t,a.done(r(i)).resolve,a.reject,!e),"pending"===a.state()||p(s[i]&&s[i].then)))return a.then();for(;i--;)K(s[i],r(i),a.reject);return a.promise()}});var G=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&G.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},x.readyException=function(e){t.setTimeout((function(){throw e}))};var X=x.Deferred();function Y(){g.removeEventListener("DOMContentLoaded",Y),t.removeEventListener("load",Y),x.ready()}x.fn.ready=function(t){return X.then(t).catch((function(t){x.readyException(t)})),this},x.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==t&&--x.readyWait>0||X.resolveWith(g,[x]))}}),x.ready.then=X.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?t.setTimeout(x.ready):(g.addEventListener("DOMContentLoaded",Y),t.addEventListener("load",Y));var Z=function(t,e,i,n,o,s,a){var r=0,l=t.length,c=null==i;if("object"===C(i))for(r in o=!0,i)Z(t,e,r,i[r],!0,s,a);else if(void 0!==n&&(o=!0,p(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(x(t),i)})),e))for(;r<l;r++)e(t[r],i,a?n:n.call(t[r],r,e(t[r],i)));return o?t:c?e.call(t):l?e(t[0],i):s},J=/^-ms-/,Q=/-([a-z])/g;function tt(t,e){return e.toUpperCase()}function et(t){return t.replace(J,"ms-").replace(Q,tt)}var it=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function nt(){this.expando=x.expando+nt.uid++}nt.uid=1,nt.prototype={cache:function(t){var e=t[this.expando];return e||(e={},it(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[et(e)]=i;else for(n in e)o[et(n)]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][et(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(et):(e=et(e))in n?[e]:e.match(j)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||x.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!x.isEmptyObject(e)}};var ot=new nt,st=new nt,at=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rt=/[A-Z]/g;function lt(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(rt,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:at.test(t)?JSON.parse(t):t)}(i)}catch(t){}st.set(t,e,i)}else i=void 0;return i}x.extend({hasData:function(t){return st.hasData(t)||ot.hasData(t)},data:function(t,e,i){return st.access(t,e,i)},removeData:function(t,e){st.remove(t,e)},_data:function(t,e,i){return ot.access(t,e,i)},_removeData:function(t,e){ot.remove(t,e)}}),x.fn.extend({data:function(t,e){var i,n,o,s=this[0],a=s&&s.attributes;if(void 0===t){if(this.length&&(o=st.get(s),1===s.nodeType&&!ot.get(s,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&0===(n=a[i].name).indexOf("data-")&&(n=et(n.slice(5)),lt(s,n,o[n]));ot.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){st.set(this,t)})):Z(this,(function(e){var i;if(s&&void 0===e)return void 0!==(i=st.get(s,t))||void 0!==(i=lt(s,t))?i:void 0;this.each((function(){st.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){st.remove(this,t)}))}}),x.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=ot.get(t,e),i&&(!n||Array.isArray(i)?n=ot.access(t,e,x.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=x.queue(t,e),n=i.length,o=i.shift(),s=x._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete s.stop,o.call(t,(function(){x.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ot.get(t,i)||ot.access(t,i,{empty:x.Callbacks("once memory").add((function(){ot.remove(t,[e+"queue",i])}))})}}),x.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?x.queue(this[0],t):void 0===e?this:this.each((function(){var i=x.queue(this,t,e);x._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&x.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){x.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=x.Deferred(),s=this,a=this.length,r=function(){--n||o.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=ot.get(s[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),o.promise(e)}});var ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ht=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),dt=["Top","Right","Bottom","Left"],ut=g.documentElement,mt=function(t){return x.contains(t.ownerDocument,t)},pt={composed:!0};ut.getRootNode&&(mt=function(t){return x.contains(t.ownerDocument,t)||t.getRootNode(pt)===t.ownerDocument});var ft=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&mt(t)&&"none"===x.css(t,"display")};function gt(t,e,i,n){var o,s,a=20,r=n?function(){return n.cur()}:function(){return x.css(t,e,"")},l=r(),c=i&&i[3]||(x.cssNumber[e]?"":"px"),h=t.nodeType&&(x.cssNumber[e]||"px"!==c&&+l)&&ht.exec(x.css(t,e));if(h&&h[3]!==c){for(l/=2,c=c||h[3],h=+l||1;a--;)x.style(t,e,h+c),(1-s)*(1-(s=r()/l||.5))<=0&&(a=0),h/=s;h*=2,x.style(t,e,h+c),i=i||[]}return i&&(h=+h||+l||0,o=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=h,n.end=o)),o}var bt={};function vt(t){var e,i=t.ownerDocument,n=t.nodeName,o=bt[n];return o||(e=i.body.appendChild(i.createElement(n)),o=x.css(e,"display"),e.parentNode.removeChild(e),"none"===o&&(o="block"),bt[n]=o,o)}function Ct(t,e){for(var i,n,o=[],s=0,a=t.length;s<a;s++)(n=t[s]).style&&(i=n.style.display,e?("none"===i&&(o[s]=ot.get(n,"display")||null,o[s]||(n.style.display="")),""===n.style.display&&ft(n)&&(o[s]=vt(n))):"none"!==i&&(o[s]="none",ot.set(n,"display",i)));for(s=0;s<a;s++)null!=o[s]&&(t[s].style.display=o[s]);return t}x.fn.extend({show:function(){return Ct(this,!0)},hide:function(){return Ct(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ft(this)?x(this).show():x(this).hide()}))}});var wt,yt,xt=/^(?:checkbox|radio)$/i,_t=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,kt=/^$|^module$|\/(?:java|ecma)script/i;wt=g.createDocumentFragment().appendChild(g.createElement("div")),(yt=g.createElement("input")).setAttribute("type","radio"),yt.setAttribute("checked","checked"),yt.setAttribute("name","t"),wt.appendChild(yt),m.checkClone=wt.cloneNode(!0).cloneNode(!0).lastChild.checked,wt.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!wt.cloneNode(!0).lastChild.defaultValue,wt.innerHTML="<option></option>",m.option=!!wt.lastChild;var It={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function St(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&k(t,e)?x.merge([t],i):i}function Et(t,e){for(var i=0,n=t.length;i<n;i++)ot.set(t[i],"globalEval",!e||ot.get(e[i],"globalEval"))}It.tbody=It.tfoot=It.colgroup=It.caption=It.thead,It.th=It.td,m.option||(It.optgroup=It.option=[1,"<select multiple='multiple'>","</select>"]);var Tt=/<|&#?\w+;/;function Mt(t,e,i,n,o){for(var s,a,r,l,c,h,d=e.createDocumentFragment(),u=[],m=0,p=t.length;m<p;m++)if((s=t[m])||0===s)if("object"===C(s))x.merge(u,s.nodeType?[s]:s);else if(Tt.test(s)){for(a=a||d.appendChild(e.createElement("div")),r=(_t.exec(s)||["",""])[1].toLowerCase(),l=It[r]||It._default,a.innerHTML=l[1]+x.htmlPrefilter(s)+l[2],h=l[0];h--;)a=a.lastChild;x.merge(u,a.childNodes),(a=d.firstChild).textContent=""}else u.push(e.createTextNode(s));for(d.textContent="",m=0;s=u[m++];)if(n&&x.inArray(s,n)>-1)o&&o.push(s);else if(c=mt(s),a=St(d.appendChild(s),"script"),c&&Et(a),i)for(h=0;s=a[h++];)kt.test(s.type||"")&&i.push(s);return d}var At=/^([^.]*)(?:\.(.+)|)/;function Ut(){return!0}function Dt(){return!1}function Pt(t,e,i,n,o,s){var a,r;if("object"==typeof e){for(r in"string"!=typeof i&&(n=n||i,i=void 0),e)Pt(t,r,i,n,e[r],s);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=Dt;else if(!o)return t;return 1===s&&(a=o,o=function(t){return x().off(t),a.apply(this,arguments)},o.guid=a.guid||(a.guid=x.guid++)),t.each((function(){x.event.add(this,e,o,n,i)}))}function Lt(t,e,i){i?(ot.set(t,e,!1),x.event.add(t,e,{namespace:!1,handler:function(t){var i,n=ot.get(this,e);if(1&t.isTrigger&&this[e]){if(n)(x.event.special[e]||{}).delegateType&&t.stopPropagation();else if(n=o.call(arguments),ot.set(this,e,n),this[e](),i=ot.get(this,e),ot.set(this,e,!1),n!==i)return t.stopImmediatePropagation(),t.preventDefault(),i}else n&&(ot.set(this,e,x.event.trigger(n[0],n.slice(1),this)),t.stopPropagation(),t.isImmediatePropagationStopped=Ut)}})):void 0===ot.get(t,e)&&x.event.add(t,e,Ut)}x.event={global:{},add:function(t,e,i,n,o){var s,a,r,l,c,h,d,u,m,p,f,g=ot.get(t);if(it(t))for(i.handler&&(i=(s=i).handler,o=s.selector),o&&x.find.matchesSelector(ut,o),i.guid||(i.guid=x.guid++),(l=g.events)||(l=g.events=Object.create(null)),(a=g.handle)||(a=g.handle=function(e){return void 0!==x&&x.event.triggered!==e.type?x.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(j)||[""]).length;c--;)m=f=(r=At.exec(e[c])||[])[1],p=(r[2]||"").split(".").sort(),m&&(d=x.event.special[m]||{},m=(o?d.delegateType:d.bindType)||m,d=x.event.special[m]||{},h=x.extend({type:m,origType:f,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:p.join(".")},s),(u=l[m])||((u=l[m]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,n,p,a)||t.addEventListener&&t.addEventListener(m,a)),d.add&&(d.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),o?u.splice(u.delegateCount++,0,h):u.push(h),x.event.global[m]=!0)},remove:function(t,e,i,n,o){var s,a,r,l,c,h,d,u,m,p,f,g=ot.hasData(t)&&ot.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(j)||[""]).length;c--;)if(m=f=(r=At.exec(e[c])||[])[1],p=(r[2]||"").split(".").sort(),m){for(d=x.event.special[m]||{},u=l[m=(n?d.delegateType:d.bindType)||m]||[],r=r[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=u.length;s--;)h=u[s],!o&&f!==h.origType||i&&i.guid!==h.guid||r&&!r.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(u.splice(s,1),h.selector&&u.delegateCount--,d.remove&&d.remove.call(t,h));a&&!u.length&&(d.teardown&&!1!==d.teardown.call(t,p,g.handle)||x.removeEvent(t,m,g.handle),delete l[m])}else for(m in l)x.event.remove(t,m+e[c],i,n,!0);x.isEmptyObject(l)&&ot.remove(t,"handle events")}},dispatch:function(t){var e,i,n,o,s,a,r=new Array(arguments.length),l=x.event.fix(t),c=(ot.get(this,"events")||Object.create(null))[l.type]||[],h=x.event.special[l.type]||{};for(r[0]=l,e=1;e<arguments.length;e++)r[e]=arguments[e];if(l.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,l)){for(a=x.event.handlers.call(this,l,c),e=0;(o=a[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==s.namespace&&!l.rnamespace.test(s.namespace)||(l.handleObj=s,l.data=s.data,void 0!==(n=((x.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,r))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,o,s,a,r=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],a={},i=0;i<l;i++)void 0===a[o=(n=e[i]).selector+" "]&&(a[o]=n.needsContext?x(o,this).index(c)>-1:x.find(o,this,null,[c]).length),a[o]&&s.push(n);s.length&&r.push({elem:c,handlers:s})}return c=this,l<e.length&&r.push({elem:c,handlers:e.slice(l)}),r},addProp:function(t,e){Object.defineProperty(x.Event.prototype,t,{enumerable:!0,configurable:!0,get:p(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[x.expando]?t:new x.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return xt.test(e.type)&&e.click&&k(e,"input")&&Lt(e,"click",!0),!1},trigger:function(t){var e=this||t;return xt.test(e.type)&&e.click&&k(e,"input")&&Lt(e,"click"),!0},_default:function(t){var e=t.target;return xt.test(e.type)&&e.click&&k(e,"input")&&ot.get(e,"click")||k(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},x.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},x.Event=function(t,e){if(!(this instanceof x.Event))return new x.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Ut:Dt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&x.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Dt,isPropagationStopped:Dt,isImmediatePropagationStopped:Dt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Ut,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Ut,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Ut,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(t,e){function i(t){if(g.documentMode){var i=ot.get(this,"handle"),n=x.event.fix(t);n.type="focusin"===t.type?"focus":"blur",n.isSimulated=!0,i(t),n.target===n.currentTarget&&i(n)}else x.event.simulate(e,t.target,x.event.fix(t))}x.event.special[t]={setup:function(){var n;if(Lt(this,t,!0),!g.documentMode)return!1;(n=ot.get(this,e))||this.addEventListener(e,i),ot.set(this,e,(n||0)+1)},trigger:function(){return Lt(this,t),!0},teardown:function(){var t;if(!g.documentMode)return!1;(t=ot.get(this,e)-1)?ot.set(this,e,t):(this.removeEventListener(e,i),ot.remove(this,e))},_default:function(e){return ot.get(e.target,t)},delegateType:e},x.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,o=g.documentMode?this:n,s=ot.get(o,e);s||(g.documentMode?this.addEventListener(e,i):n.addEventListener(t,i,!0)),ot.set(o,e,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,o=g.documentMode?this:n,s=ot.get(o,e)-1;s?ot.set(o,e,s):(g.documentMode?this.removeEventListener(e,i):n.removeEventListener(t,i,!0),ot.remove(o,e))}}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){x.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,o=t.handleObj;return n&&(n===this||x.contains(this,n))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}})),x.fn.extend({on:function(t,e,i,n){return Pt(this,t,e,i,n)},one:function(t,e,i,n){return Pt(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,x(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=Dt),this.each((function(){x.event.remove(this,t,i,e)}))}});var Ot=/<script|<style|<link/i,Rt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $t(t,e){return k(t,"table")&&k(11!==e.nodeType?e:e.firstChild,"tr")&&x(t).children("tbody")[0]||t}function Bt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Vt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ht(t,e){var i,n,o,s,a,r;if(1===e.nodeType){if(ot.hasData(t)&&(r=ot.get(t).events))for(o in ot.remove(e,"handle events"),r)for(i=0,n=r[o].length;i<n;i++)x.event.add(e,o,r[o][i]);st.hasData(t)&&(s=st.access(t),a=x.extend({},s),st.set(e,a))}}function Nt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&xt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function zt(t,e,i,n){e=s(e);var o,a,r,l,c,h,d=0,u=t.length,f=u-1,g=e[0],b=p(g);if(b||u>1&&"string"==typeof g&&!m.checkClone&&Rt.test(g))return t.each((function(o){var s=t.eq(o);b&&(e[0]=g.call(this,o,s.html())),zt(s,e,i,n)}));if(u&&(a=(o=Mt(e,t[0].ownerDocument,!1,t,n)).firstChild,1===o.childNodes.length&&(o=a),a||n)){for(l=(r=x.map(St(o,"script"),Bt)).length;d<u;d++)c=o,d!==f&&(c=x.clone(c,!0,!0),l&&x.merge(r,St(c,"script"))),i.call(t[d],c,d);if(l)for(h=r[r.length-1].ownerDocument,x.map(r,Vt),d=0;d<l;d++)c=r[d],kt.test(c.type||"")&&!ot.access(c,"globalEval")&&x.contains(h,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?x._evalUrl&&!c.noModule&&x._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},h):v(c.textContent.replace(Ft,""),c,h))}return t}function jt(t,e,i){for(var n,o=e?x.filter(e,t):t,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||x.cleanData(St(n)),n.parentNode&&(i&&mt(n)&&Et(St(n,"script")),n.parentNode.removeChild(n));return t}x.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,o,s,a,r=t.cloneNode(!0),l=mt(t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||x.isXMLDoc(t)))for(a=St(r),n=0,o=(s=St(t)).length;n<o;n++)Nt(s[n],a[n]);if(e)if(i)for(s=s||St(t),a=a||St(r),n=0,o=s.length;n<o;n++)Ht(s[n],a[n]);else Ht(t,r);return(a=St(r,"script")).length>0&&Et(a,!l&&St(t,"script")),r},cleanData:function(t){for(var e,i,n,o=x.event.special,s=0;void 0!==(i=t[s]);s++)if(it(i)){if(e=i[ot.expando]){if(e.events)for(n in e.events)o[n]?x.event.remove(i,n):x.removeEvent(i,n,e.handle);i[ot.expando]=void 0}i[st.expando]&&(i[st.expando]=void 0)}}}),x.fn.extend({detach:function(t){return jt(this,t,!0)},remove:function(t){return jt(this,t)},text:function(t){return Z(this,(function(t){return void 0===t?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return zt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||$t(this,t).appendChild(t)}))},prepend:function(){return zt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=$t(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return zt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(x.cleanData(St(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return x.clone(this,t,e)}))},html:function(t){return Z(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ot.test(t)&&!It[(_t.exec(t)||["",""])[1].toLowerCase()]){t=x.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(x.cleanData(St(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return zt(this,arguments,(function(e){var i=this.parentNode;x.inArray(this,t)<0&&(x.cleanData(St(this)),i&&i.replaceChild(e,this))}),t)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){x.fn[t]=function(t){for(var i,n=[],o=x(t),s=o.length-1,r=0;r<=s;r++)i=r===s?this:this.clone(!0),x(o[r])[e](i),a.apply(n,i.get());return this.pushStack(n)}}));var Wt=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),qt=/^--/,Kt=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},Gt=function(t,e,i){var n,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in n=i.call(t),e)t.style[o]=s[o];return n},Xt=new RegExp(dt.join("|"),"i");function Yt(t,e,i){var n,o,s,a,r=qt.test(e),l=t.style;return(i=i||Kt(t))&&(a=i.getPropertyValue(e)||i[e],r&&a&&(a=a.replace(M,"$1")||void 0),""!==a||mt(t)||(a=x.style(t,e)),!m.pixelBoxStyles()&&Wt.test(a)&&Xt.test(e)&&(n=l.width,o=l.minWidth,s=l.maxWidth,l.minWidth=l.maxWidth=l.width=a,a=i.width,l.width=n,l.minWidth=o,l.maxWidth=s)),void 0!==a?a+"":a}function Zt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(h){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ut.appendChild(c).appendChild(h);var e=t.getComputedStyle(h);n="1%"!==e.top,l=12===i(e.marginLeft),h.style.right="60%",a=36===i(e.right),o=36===i(e.width),h.style.position="absolute",s=12===i(h.offsetWidth/3),ut.removeChild(c),h=null}}function i(t){return Math.round(parseFloat(t))}var n,o,s,a,r,l,c=g.createElement("div"),h=g.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===h.style.backgroundClip,x.extend(m,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,i,n,o;return null==r&&(e=g.createElement("table"),i=g.createElement("tr"),n=g.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",i.style.cssText="box-sizing:content-box;border:1px solid",i.style.height="1px",n.style.height="9px",n.style.display="block",ut.appendChild(e).appendChild(i).appendChild(n),o=t.getComputedStyle(i),r=parseInt(o.height,10)+parseInt(o.borderTopWidth,10)+parseInt(o.borderBottomWidth,10)===i.offsetHeight,ut.removeChild(e)),r},forceStyleTests:function(){h=g.createElement("div"),e()}}))}();var Jt=["Webkit","Moz","ms"],Qt=g.createElement("div").style,te={};function ee(t){var e=x.cssProps[t]||te[t];return e||(t in Qt?t:te[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=Jt.length;i--;)if((t=Jt[i]+e)in Qt)return t}(t)||t)}var ie=/^(none|table(?!-c[ea]).+)/,ne={position:"absolute",visibility:"hidden",display:"block"},oe={letterSpacing:"0",fontWeight:"400"};function se(t,e,i){var n=ht.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function ae(t,e,i,n,o,s){var a="width"===e?1:0,r=0,l=0,c=0;if(i===(n?"border":"content"))return 0;for(;a<4;a+=2)"margin"===i&&(c+=x.css(t,i+dt[a],!0,o)),n?("content"===i&&(l-=x.css(t,"padding"+dt[a],!0,o)),"margin"!==i&&(l-=x.css(t,"border"+dt[a]+"Width",!0,o))):(l+=x.css(t,"padding"+dt[a],!0,o),"padding"!==i?l+=x.css(t,"border"+dt[a]+"Width",!0,o):r+=x.css(t,"border"+dt[a]+"Width",!0,o));return!n&&s>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-l-r-.5))||0),l+c}function re(t,e,i){var n=Kt(t),o=(!m.boxSizingReliable()||i)&&"border-box"===x.css(t,"boxSizing",!1,n),s=o,a=Yt(t,e,n),r="offset"+e[0].toUpperCase()+e.slice(1);if(Wt.test(a)){if(!i)return a;a="auto"}return(!m.boxSizingReliable()&&o||!m.reliableTrDimensions()&&k(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===x.css(t,"display",!1,n))&&t.getClientRects().length&&(o="border-box"===x.css(t,"boxSizing",!1,n),(s=r in t)&&(a=t[r])),(a=parseFloat(a)||0)+ae(t,e,i||(o?"border":"content"),s,n,a)+"px"}function le(t,e,i,n,o){return new le.prototype.init(t,e,i,n,o)}x.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Yt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,a,r=et(e),l=qt.test(e),c=t.style;if(l||(e=ee(r)),a=x.cssHooks[e]||x.cssHooks[r],void 0===i)return a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:c[e];"string"===(s=typeof i)&&(o=ht.exec(i))&&o[1]&&(i=gt(t,e,o),s="number"),null!=i&&i==i&&("number"!==s||l||(i+=o&&o[3]||(x.cssNumber[r]?"":"px")),m.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l?c.setProperty(e,i):c[e]=i))}},css:function(t,e,i,n){var o,s,a,r=et(e);return qt.test(e)||(e=ee(r)),(a=x.cssHooks[e]||x.cssHooks[r])&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=Yt(t,e,n)),"normal"===o&&e in oe&&(o=oe[e]),""===i||i?(s=parseFloat(o),!0===i||isFinite(s)?s||0:o):o}}),x.each(["height","width"],(function(t,e){x.cssHooks[e]={get:function(t,i,n){if(i)return!ie.test(x.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?re(t,e,n):Gt(t,ne,(function(){return re(t,e,n)}))},set:function(t,i,n){var o,s=Kt(t),a=!m.scrollboxSize()&&"absolute"===s.position,r=(a||n)&&"border-box"===x.css(t,"boxSizing",!1,s),l=n?ae(t,e,n,r,s):0;return r&&a&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-ae(t,e,"border",!1,s)-.5)),l&&(o=ht.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=x.css(t,e)),se(0,i,l)}}})),x.cssHooks.marginLeft=Zt(m.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Yt(t,"marginLeft"))||t.getBoundingClientRect().left-Gt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(t,e){x.cssHooks[t+e]={expand:function(i){for(var n=0,o={},s="string"==typeof i?i.split(" "):[i];n<4;n++)o[t+dt[n]+e]=s[n]||s[n-2]||s[0];return o}},"margin"!==t&&(x.cssHooks[t+e].set=se)})),x.fn.extend({css:function(t,e){return Z(this,(function(t,e,i){var n,o,s={},a=0;if(Array.isArray(e)){for(n=Kt(t),o=e.length;a<o;a++)s[e[a]]=x.css(t,e[a],!1,n);return s}return void 0!==i?x.style(t,e,i):x.css(t,e)}),t,e,arguments.length>1)}}),x.Tween=le,le.prototype={constructor:le,init:function(t,e,i,n,o,s){this.elem=t,this.prop=i,this.easing=o||x.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(x.cssNumber[i]?"":"px")},cur:function(){var t=le.propHooks[this.prop];return t&&t.get?t.get(this):le.propHooks._default.get(this)},run:function(t){var e,i=le.propHooks[this.prop];return this.options.duration?this.pos=e=x.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):le.propHooks._default.set(this),this}},le.prototype.init.prototype=le.prototype,le.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=x.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){x.fx.step[t.prop]?x.fx.step[t.prop](t):1!==t.elem.nodeType||!x.cssHooks[t.prop]&&null==t.elem.style[ee(t.prop)]?t.elem[t.prop]=t.now:x.style(t.elem,t.prop,t.now+t.unit)}}},le.propHooks.scrollTop=le.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},x.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},x.fx=le.prototype.init,x.fx.step={};var ce,he,de=/^(?:toggle|show|hide)$/,ue=/queueHooks$/;function me(){he&&(!1===g.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(me):t.setTimeout(me,x.fx.interval),x.fx.tick())}function pe(){return t.setTimeout((function(){ce=void 0})),ce=Date.now()}function fe(t,e){var i,n=0,o={height:t};for(e=e?1:0;n<4;n+=2-e)o["margin"+(i=dt[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function ge(t,e,i){for(var n,o=(be.tweeners[e]||[]).concat(be.tweeners["*"]),s=0,a=o.length;s<a;s++)if(n=o[s].call(i,e,t))return n}function be(t,e,i){var n,o,s=0,a=be.prefilters.length,r=x.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=ce||pe(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),s=0,a=c.tweens.length;s<a;s++)c.tweens[s].run(n);return r.notifyWith(t,[c,n,i]),n<1&&a?i:(a||r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:x.extend({},e),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},i),originalProperties:e,originalOptions:i,startTime:ce||pe(),duration:i.duration,tweens:[],createTween:function(e,i){var n=x.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return e?(r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c,e])):r.rejectWith(t,[c,e]),this}}),h=c.props;for(!function(t,e){var i,n,o,s,a;for(i in t)if(o=e[n=et(i)],s=t[i],Array.isArray(s)&&(o=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(a=x.cssHooks[n])&&"expand"in a)for(i in s=a.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=o);else e[n]=o}(h,c.opts.specialEasing);s<a;s++)if(n=be.prefilters[s].call(c,t,h,c.opts))return p(n.stop)&&(x._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return x.map(h,ge,c),p(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),x.fx.timer(x.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}x.Animation=x.extend(be,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return gt(i.elem,t,ht.exec(e),i),i}]},tweener:function(t,e){p(t)?(e=t,t=["*"]):t=t.match(j);for(var i,n=0,o=t.length;n<o;n++)i=t[n],be.tweeners[i]=be.tweeners[i]||[],be.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,o,s,a,r,l,c,h,d="width"in e||"height"in e,u=this,m={},p=t.style,f=t.nodeType&&ft(t),g=ot.get(t,"fxshow");for(n in i.queue||(null==(a=x._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,r=a.empty.fire,a.empty.fire=function(){a.unqueued||r()}),a.unqueued++,u.always((function(){u.always((function(){a.unqueued--,x.queue(t,"fx").length||a.empty.fire()}))}))),e)if(o=e[n],de.test(o)){if(delete e[n],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;f=!0}m[n]=g&&g[n]||x.style(t,n)}if((l=!x.isEmptyObject(e))||!x.isEmptyObject(m))for(n in d&&1===t.nodeType&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=ot.get(t,"display")),"none"===(h=x.css(t,"display"))&&(c?h=c:(Ct([t],!0),c=t.style.display||c,h=x.css(t,"display"),Ct([t]))),("inline"===h||"inline-block"===h&&null!=c)&&"none"===x.css(t,"float")&&(l||(u.done((function(){p.display=c})),null==c&&(h=p.display,c="none"===h?"":h)),p.display="inline-block")),i.overflow&&(p.overflow="hidden",u.always((function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}))),l=!1,m)l||(g?"hidden"in g&&(f=g.hidden):g=ot.access(t,"fxshow",{display:c}),s&&(g.hidden=!f),f&&Ct([t],!0),u.done((function(){for(n in f||Ct([t]),ot.remove(t,"fxshow"),m)x.style(t,n,m[n])}))),l=ge(f?g[n]:0,n,u),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?be.prefilters.unshift(t):be.prefilters.push(t)}}),x.speed=function(t,e,i){var n=t&&"object"==typeof t?x.extend({},t):{complete:i||!i&&e||p(t)&&t,duration:t,easing:i&&e||e&&!p(e)&&e};return x.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in x.fx.speeds?n.duration=x.fx.speeds[n.duration]:n.duration=x.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){p(n.old)&&n.old.call(this),n.queue&&x.dequeue(this,n.queue)},n},x.fn.extend({fadeTo:function(t,e,i,n){return this.filter(ft).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=x.isEmptyObject(t),s=x.speed(e,i,n),a=function(){var e=be(this,x.extend({},t),s);(o||ot.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===s.queue?this.each(a):this.queue(s.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",s=x.timers,a=ot.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&ue.test(o)&&n(a[o]);for(o=s.length;o--;)s[o].elem!==this||null!=t&&s[o].queue!==t||(s[o].anim.stop(i),e=!1,s.splice(o,1));!e&&i||x.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=ot.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],s=x.timers,a=n?n.length:0;for(i.finish=!0,x.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<a;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),x.each(["toggle","show","hide"],(function(t,e){var i=x.fn[e];x.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(fe(e,!0),t,n,o)}})),x.each({slideDown:fe("show"),slideUp:fe("hide"),slideToggle:fe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){x.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),x.timers=[],x.fx.tick=function(){var t,e=0,i=x.timers;for(ce=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||x.fx.stop(),ce=void 0},x.fx.timer=function(t){x.timers.push(t),x.fx.start()},x.fx.interval=13,x.fx.start=function(){he||(he=!0,me())},x.fx.stop=function(){he=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,i){return e=x.fx&&x.fx.speeds[e]||e,i=i||"fx",this.queue(i,(function(i,n){var o=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(o)}}))},function(){var t=g.createElement("input"),e=g.createElement("select").appendChild(g.createElement("option"));t.type="checkbox",m.checkOn=""!==t.value,m.optSelected=e.selected,(t=g.createElement("input")).value="t",t.type="radio",m.radioValue="t"===t.value}();var ve,Ce=x.expr.attrHandle;x.fn.extend({attr:function(t,e){return Z(this,x.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){x.removeAttr(this,t)}))}}),x.extend({attr:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?x.prop(t,e,i):(1===s&&x.isXMLDoc(t)||(o=x.attrHooks[e.toLowerCase()]||(x.expr.match.bool.test(e)?ve:void 0)),void 0!==i?null===i?void x.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:null==(n=x.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&k(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,o=e&&e.match(j);if(o&&1===t.nodeType)for(;i=o[n++];)t.removeAttribute(i)}}),ve={set:function(t,e,i){return!1===e?x.removeAttr(t,i):t.setAttribute(i,i),i}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=Ce[e]||x.find.attr;Ce[e]=function(t,e,n){var o,s,a=e.toLowerCase();return n||(s=Ce[a],Ce[a]=o,o=null!=i(t,e,n)?a:null,Ce[a]=s),o}}));var we=/^(?:input|select|textarea|button)$/i,ye=/^(?:a|area)$/i;function xe(t){return(t.match(j)||[]).join(" ")}function _e(t){return t.getAttribute&&t.getAttribute("class")||""}function ke(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(j)||[]}x.fn.extend({prop:function(t,e){return Z(this,x.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[x.propFix[t]||t]}))}}),x.extend({prop:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&x.isXMLDoc(t)||(e=x.propFix[e]||e,o=x.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=x.find.attr(t,"tabindex");return e?parseInt(e,10):we.test(t.nodeName)||ye.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(x.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(t){var e,i,n,o,s,a;return p(t)?this.each((function(e){x(this).addClass(t.call(this,e,_e(this)))})):(e=ke(t)).length?this.each((function(){if(n=_e(this),i=1===this.nodeType&&" "+xe(n)+" "){for(s=0;s<e.length;s++)o=e[s],i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=xe(i),n!==a&&this.setAttribute("class",a)}})):this},removeClass:function(t){var e,i,n,o,s,a;return p(t)?this.each((function(e){x(this).removeClass(t.call(this,e,_e(this)))})):arguments.length?(e=ke(t)).length?this.each((function(){if(n=_e(this),i=1===this.nodeType&&" "+xe(n)+" "){for(s=0;s<e.length;s++)for(o=e[s];i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");a=xe(i),n!==a&&this.setAttribute("class",a)}})):this:this.attr("class","")},toggleClass:function(t,e){var i,n,o,s,a=typeof t,r="string"===a||Array.isArray(t);return p(t)?this.each((function(i){x(this).toggleClass(t.call(this,i,_e(this),e),e)})):"boolean"==typeof e&&r?e?this.addClass(t):this.removeClass(t):(i=ke(t),this.each((function(){if(r)for(s=x(this),o=0;o<i.length;o++)n=i[o],s.hasClass(n)?s.removeClass(n):s.addClass(n);else void 0!==t&&"boolean"!==a||((n=_e(this))&&ot.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||!1===t?"":ot.get(this,"__className__")||""))})))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+xe(_e(i))+" ").indexOf(e)>-1)return!0;return!1}});var Ie=/\r/g;x.fn.extend({val:function(t){var e,i,n,o=this[0];return arguments.length?(n=p(t),this.each((function(i){var o;1===this.nodeType&&(null==(o=n?t.call(this,i,x(this).val()):t)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=x.map(o,(function(t){return null==t?"":t+""}))),(e=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(Ie,""):null==i?"":i:void 0}}),x.extend({valHooks:{option:{get:function(t){var e=x.find.attr(t,"value");return null!=e?e:xe(x.text(t))}},select:{get:function(t){var e,i,n,o=t.options,s=t.selectedIndex,a="select-one"===t.type,r=a?null:[],l=a?s+1:o.length;for(n=s<0?l:a?s:0;n<l;n++)if(((i=o[n]).selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!k(i.parentNode,"optgroup"))){if(e=x(i).val(),a)return e;r.push(e)}return r},set:function(t,e){for(var i,n,o=t.options,s=x.makeArray(e),a=o.length;a--;)((n=o[a]).selected=x.inArray(x.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=x.inArray(x(t).val(),e)>-1}},m.checkOn||(x.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var Se=t.location,Ee={guid:Date.now()},Te=/\?/;x.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){}return n=i&&i.getElementsByTagName("parsererror")[0],i&&!n||x.error("Invalid XML: "+(n?x.map(n.childNodes,(function(t){return t.textContent})).join("\n"):e)),i};var Me=/^(?:focusinfocus|focusoutblur)$/,Ae=function(t){t.stopPropagation()};x.extend(x.event,{trigger:function(e,i,n,o){var s,a,r,l,c,d,u,m,b=[n||g],v=h.call(e,"type")?e.type:e,C=h.call(e,"namespace")?e.namespace.split("."):[];if(a=m=r=n=n||g,3!==n.nodeType&&8!==n.nodeType&&!Me.test(v+x.event.triggered)&&(v.indexOf(".")>-1&&(C=v.split("."),v=C.shift(),C.sort()),c=v.indexOf(":")<0&&"on"+v,(e=e[x.expando]?e:new x.Event(v,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=C.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+C.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:x.makeArray(i,[e]),u=x.event.special[v]||{},o||!u.trigger||!1!==u.trigger.apply(n,i))){if(!o&&!u.noBubble&&!f(n)){for(l=u.delegateType||v,Me.test(l+v)||(a=a.parentNode);a;a=a.parentNode)b.push(a),r=a;r===(n.ownerDocument||g)&&b.push(r.defaultView||r.parentWindow||t)}for(s=0;(a=b[s++])&&!e.isPropagationStopped();)m=a,e.type=s>1?l:u.bindType||v,(d=(ot.get(a,"events")||Object.create(null))[e.type]&&ot.get(a,"handle"))&&d.apply(a,i),(d=c&&a[c])&&d.apply&&it(a)&&(e.result=d.apply(a,i),!1===e.result&&e.preventDefault());return e.type=v,o||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(b.pop(),i)||!it(n)||c&&p(n[v])&&!f(n)&&((r=n[c])&&(n[c]=null),x.event.triggered=v,e.isPropagationStopped()&&m.addEventListener(v,Ae),n[v](),e.isPropagationStopped()&&m.removeEventListener(v,Ae),x.event.triggered=void 0,r&&(n[c]=r)),e.result}},simulate:function(t,e,i){var n=x.extend(new x.Event,i,{type:t,isSimulated:!0});x.event.trigger(n,null,e)}}),x.fn.extend({trigger:function(t,e){return this.each((function(){x.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return x.event.trigger(t,e,i,!0)}});var Ue=/\[\]$/,De=/\r?\n/g,Pe=/^(?:submit|button|image|reset|file)$/i,Le=/^(?:input|select|textarea|keygen)/i;function Oe(t,e,i,n){var o;if(Array.isArray(e))x.each(e,(function(e,o){i||Ue.test(t)?n(t,o):Oe(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,i,n)}));else if(i||"object"!==C(e))n(t,e);else for(o in e)Oe(t+"["+o+"]",e[o],i,n)}x.param=function(t,e){var i,n=[],o=function(t,e){var i=p(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!x.isPlainObject(t))x.each(t,(function(){o(this.name,this.value)}));else for(i in t)Oe(i,t[i],e,o);return n.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=x.prop(this,"elements");return t?x.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!x(this).is(":disabled")&&Le.test(this.nodeName)&&!Pe.test(t)&&(this.checked||!xt.test(t))})).map((function(t,e){var i=x(this).val();return null==i?null:Array.isArray(i)?x.map(i,(function(t){return{name:e.name,value:t.replace(De,"\r\n")}})):{name:e.name,value:i.replace(De,"\r\n")}})).get()}});var Re=/%20/g,Fe=/#.*$/,$e=/([?&])_=[^&]*/,Be=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ve=/^(?:GET|HEAD)$/,He=/^\/\//,Ne={},ze={},je="*/".concat("*"),We=g.createElement("a");function qe(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,s=e.toLowerCase().match(j)||[];if(p(i))for(;n=s[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function Ke(t,e,i,n){var o={},s=t===ze;function a(r){var l;return o[r]=!0,x.each(t[r]||[],(function(t,r){var c=r(e,i,n);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),a(c),!1)})),l}return a(e.dataTypes[0])||!o["*"]&&a("*")}function Ge(t,e){var i,n,o=x.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&x.extend(!0,t,n),t}We.href=Se.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Se.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Se.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ge(Ge(t,x.ajaxSettings),e):Ge(x.ajaxSettings,t)},ajaxPrefilter:qe(Ne),ajaxTransport:qe(ze),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0),i=i||{};var n,o,s,a,r,l,c,h,d,u,m=x.ajaxSetup({},i),p=m.context||m,f=m.context&&(p.nodeType||p.jquery)?x(p):x.event,b=x.Deferred(),v=x.Callbacks("once memory"),C=m.statusCode||{},w={},y={},_="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(c){if(!a)for(a={};e=Be.exec(s);)a[e[1].toLowerCase()+" "]=(a[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=a[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(t,e){return null==c&&(t=y[t.toLowerCase()]=y[t.toLowerCase()]||t,w[t]=e),this},overrideMimeType:function(t){return null==c&&(m.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)k.always(t[k.status]);else for(e in t)C[e]=[C[e],t[e]];return this},abort:function(t){var e=t||_;return n&&n.abort(e),I(0,e),this}};if(b.promise(k),m.url=((e||m.url||Se.href)+"").replace(He,Se.protocol+"//"),m.type=i.method||i.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(j)||[""],null==m.crossDomain){l=g.createElement("a");try{l.href=m.url,l.href=l.href,m.crossDomain=We.protocol+"//"+We.host!=l.protocol+"//"+l.host}catch(t){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=x.param(m.data,m.traditional)),Ke(Ne,m,i,k),c)return k;for(d in(h=x.event&&m.global)&&0==x.active++&&x.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Ve.test(m.type),o=m.url.replace(Fe,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(Re,"+")):(u=m.url.slice(o.length),m.data&&(m.processData||"string"==typeof m.data)&&(o+=(Te.test(o)?"&":"?")+m.data,delete m.data),!1===m.cache&&(o=o.replace($e,"$1"),u=(Te.test(o)?"&":"?")+"_="+Ee.guid+++u),m.url=o+u),m.ifModified&&(x.lastModified[o]&&k.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&k.setRequestHeader("If-None-Match",x.etag[o])),(m.data&&m.hasContent&&!1!==m.contentType||i.contentType)&&k.setRequestHeader("Content-Type",m.contentType),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+je+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(d,m.headers[d]);if(m.beforeSend&&(!1===m.beforeSend.call(p,k,m)||c))return k.abort();if(_="abort",v.add(m.complete),k.done(m.success),k.fail(m.error),n=Ke(ze,m,i,k)){if(k.readyState=1,h&&f.trigger("ajaxSend",[k,m]),c)return k;m.async&&m.timeout>0&&(r=t.setTimeout((function(){k.abort("timeout")}),m.timeout));try{c=!1,n.send(w,I)}catch(t){if(c)throw t;I(-1,t)}}else I(-1,"No Transport");function I(e,i,a,l){var d,u,g,w,y,_=i;c||(c=!0,r&&t.clearTimeout(r),n=void 0,s=l||"",k.readyState=e>0?4:0,d=e>=200&&e<300||304===e,a&&(w=function(t,e,i){for(var n,o,s,a,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in r)if(r[o]&&r[o].test(n)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}a||(a=o)}s=s||a}if(s)return s!==l[0]&&l.unshift(s),i[s]}(m,k,a)),!d&&x.inArray("script",m.dataTypes)>-1&&x.inArray("json",m.dataTypes)<0&&(m.converters["text script"]=function(){}),w=function(t,e,i,n){var o,s,a,r,l,c={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(s=h.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=h.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(a=c[l+" "+s]||c["* "+s]))for(o in c)if((r=o.split(" "))[1]===s&&(a=c[l+" "+r[0]]||c["* "+r[0]])){!0===a?a=c[o]:!0!==c[o]&&(s=r[0],h.unshift(r[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(m,w,k,d),d?(m.ifModified&&((y=k.getResponseHeader("Last-Modified"))&&(x.lastModified[o]=y),(y=k.getResponseHeader("etag"))&&(x.etag[o]=y)),204===e||"HEAD"===m.type?_="nocontent":304===e?_="notmodified":(_=w.state,u=w.data,d=!(g=w.error))):(g=_,!e&&_||(_="error",e<0&&(e=0))),k.status=e,k.statusText=(i||_)+"",d?b.resolveWith(p,[u,_,k]):b.rejectWith(p,[k,_,g]),k.statusCode(C),C=void 0,h&&f.trigger(d?"ajaxSuccess":"ajaxError",[k,m,d?u:g]),v.fireWith(p,[k,_]),h&&(f.trigger("ajaxComplete",[k,m]),--x.active||x.event.trigger("ajaxStop")))}return k},getJSON:function(t,e,i){return x.get(t,e,i,"json")},getScript:function(t,e){return x.get(t,void 0,e,"script")}}),x.each(["get","post"],(function(t,e){x[e]=function(t,i,n,o){return p(i)&&(o=o||n,n=i,i=void 0),x.ajax(x.extend({url:t,type:e,dataType:o,data:i,success:n},x.isPlainObject(t)&&t))}})),x.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),x._evalUrl=function(t,e,i){return x.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){x.globalEval(t,e,i)}})},x.fn.extend({wrapAll:function(t){var e;return this[0]&&(p(t)&&(t=t.call(this[0])),e=x(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return p(t)?this.each((function(e){x(this).wrapInner(t.call(this,e))})):this.each((function(){var e=x(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=p(t);return this.each((function(i){x(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(t){return!x.expr.pseudos.visible(t)},x.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Xe={0:200,1223:204},Ye=x.ajaxSettings.xhr();m.cors=!!Ye&&"withCredentials"in Ye,m.ajax=Ye=!!Ye,x.ajaxTransport((function(e){var i,n;if(m.cors||Ye&&!e.crossDomain)return{send:function(o,s){var a,r=e.xhr();if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)r[a]=e.xhrFields[a];for(a in e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)r.setRequestHeader(a,o[a]);i=function(t){return function(){i&&(i=n=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?s(0,"error"):s(r.status,r.statusText):s(Xe[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),n=r.onerror=r.ontimeout=i("error"),void 0!==r.onabort?r.onabort=n:r.onreadystatechange=function(){4===r.readyState&&t.setTimeout((function(){i&&n()}))},i=i("abort");try{r.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}})),x.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return x.globalEval(t),t}}}),x.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),x.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(n,o){e=x("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),g.head.appendChild(e[0])},abort:function(){i&&i()}}}));var Ze,Je=[],Qe=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Je.pop()||x.expando+"_"+Ee.guid++;return this[t]=!0,t}}),x.ajaxPrefilter("json jsonp",(function(e,i,n){var o,s,a,r=!1!==e.jsonp&&(Qe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(e.data)&&"data");if(r||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=p(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(Qe,"$1"+o):!1!==e.jsonp&&(e.url+=(Te.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||x.error(o+" was not called"),a[0]},e.dataTypes[0]="json",s=t[o],t[o]=function(){a=arguments},n.always((function(){void 0===s?x(t).removeProp(o):t[o]=s,e[o]&&(e.jsonpCallback=i.jsonpCallback,Je.push(o)),a&&p(s)&&s(a[0]),a=s=void 0})),"script"})),m.createHTMLDocument=((Ze=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ze.childNodes.length),x.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(m.createHTMLDocument?((n=(e=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,e.head.appendChild(n)):e=g),s=!i&&[],(o=F.exec(t))?[e.createElement(o[1])]:(o=Mt([t],e,s),s&&s.length&&x(s).remove(),x.merge([],o.childNodes)));var n,o,s},x.fn.load=function(t,e,i){var n,o,s,a=this,r=t.indexOf(" ");return r>-1&&(n=xe(t.slice(r)),t=t.slice(0,r)),p(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&x.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){s=arguments,a.html(n?x("<div>").append(x.parseHTML(t)).find(n):t)})).always(i&&function(t,e){a.each((function(){i.apply(this,s||[t.responseText,e,t])}))}),this},x.expr.pseudos.animated=function(t){return x.grep(x.timers,(function(e){return t===e.elem})).length},x.offset={setOffset:function(t,e,i){var n,o,s,a,r,l,c=x.css(t,"position"),h=x(t),d={};"static"===c&&(t.style.position="relative"),r=h.offset(),s=x.css(t,"top"),l=x.css(t,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(a=(n=h.position()).top,o=n.left):(a=parseFloat(s)||0,o=parseFloat(l)||0),p(e)&&(e=e.call(t,i,x.extend({},r))),null!=e.top&&(d.top=e.top-r.top+a),null!=e.left&&(d.left=e.left-r.left+o),"using"in e?e.using.call(t,d):h.css(d)}},x.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){x.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],o={top:0,left:0};if("fixed"===x.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===x.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((o=x(t).offset()).top+=x.css(t,"borderTopWidth",!0),o.left+=x.css(t,"borderLeftWidth",!0))}return{top:e.top-o.top-x.css(n,"marginTop",!0),left:e.left-o.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===x.css(t,"position");)t=t.offsetParent;return t||ut}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;x.fn[t]=function(n){return Z(this,(function(t,n,o){var s;if(f(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===o)return s?s[e]:t[n];s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):t[n]=o}),t,n,arguments.length)}})),x.each(["top","left"],(function(t,e){x.cssHooks[e]=Zt(m.pixelPosition,(function(t,i){if(i)return i=Yt(t,e),Wt.test(i)?x(t).position()[e]+"px":i}))})),x.each({Height:"height",Width:"width"},(function(t,e){x.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){x.fn[n]=function(o,s){var a=arguments.length&&(i||"boolean"!=typeof o),r=i||(!0===o||!0===s?"margin":"border");return Z(this,(function(e,i,o){var s;return f(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===o?x.css(e,i,r):x.style(e,i,o,r)}),e,a?o:void 0,a)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){x.fn[e]=function(t){return this.on(e,t)}})),x.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.on("mouseenter",t).on("mouseleave",e||t)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){x.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var ti=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(t,e){var i,n,s;if("string"==typeof e&&(i=t[e],e=t,t=i),p(t))return n=o.call(arguments,2),s=function(){return t.apply(e||this,n.concat(o.call(arguments)))},s.guid=t.guid=t.guid||x.guid++,s},x.holdReady=function(t){t?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=k,x.isFunction=p,x.isWindow=f,x.camelCase=et,x.type=C,x.now=Date.now,x.isNumeric=function(t){var e=x.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},x.trim=function(t){return null==t?"":(t+"").replace(ti,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return x}));var ei=t.jQuery,ii=t.$;return x.noConflict=function(e){return t.$===x&&(t.$=ii),e&&t.jQuery===x&&(t.jQuery=ei),x},void 0===e&&(t.jQuery=t.$=x),x})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("underscore",e):(t="undefined"!=typeof globalThis?globalThis:t||self,function(){var i=t._,n=t._=e();n.noConflict=function(){return t._=i,n}}())}(this,(function(){var t="1.13.6",e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},i=Array.prototype,n=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,s=i.push,a=i.slice,r=n.toString,l=n.hasOwnProperty,c="undefined"!=typeof ArrayBuffer,h="undefined"!=typeof DataView,d=Array.isArray,u=Object.keys,m=Object.create,p=c&&ArrayBuffer.isView,f=isNaN,g=isFinite,b=!{toString:null}.propertyIsEnumerable("toString"),v=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],C=Math.pow(2,53)-1;function w(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var s=Array(e+1);for(o=0;o<e;o++)s[o]=arguments[o];return s[e]=n,t.apply(this,s)}}function y(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function x(t){return void 0===t}function _(t){return!0===t||!1===t||"[object Boolean]"===r.call(t)}function k(t){var e="[object "+t+"]";return function(t){return r.call(t)===e}}var I=k("String"),S=k("Number"),E=k("Date"),T=k("RegExp"),M=k("Error"),A=k("Symbol"),U=k("ArrayBuffer"),D=k("Function"),P=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof P&&(D=function(t){return"function"==typeof t||!1});var L=D,O=k("Object"),R=h&&(!/\[native code\]/.test(String(DataView))||O(new DataView(new ArrayBuffer(8)))),F="undefined"!=typeof Map&&O(new Map),$=k("DataView");var B=R?function(t){return null!=t&&L(t.getInt8)&&U(t.buffer)}:$,V=d||k("Array");function H(t,e){return null!=t&&l.call(t,e)}var N=k("Arguments");!function(){N(arguments)||(N=function(t){return H(t,"callee")})}();var z=N;function j(t){return S(t)&&f(t)}function W(t){return function(){return t}}function q(t){return function(e){var i=t(e);return"number"==typeof i&&i>=0&&i<=C}}function K(t){return function(e){return null==e?void 0:e[t]}}var G=K("byteLength"),X=q(G),Y=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Z=c?function(t){return p?p(t)&&!B(t):X(t)&&Y.test(r.call(t))}:W(!1),J=K("length");function Q(t,e){e=function(t){for(var e={},i=t.length,n=0;n<i;++n)e[t[n]]=!0;return{contains:function(t){return!0===e[t]},push:function(i){return e[i]=!0,t.push(i)}}}(e);var i=v.length,o=t.constructor,s=L(o)&&o.prototype||n,a="constructor";for(H(t,a)&&!e.contains(a)&&e.push(a);i--;)(a=v[i])in t&&t[a]!==s[a]&&!e.contains(a)&&e.push(a)}function tt(t){if(!y(t))return[];if(u)return u(t);var e=[];for(var i in t)H(t,i)&&e.push(i);return b&&Q(t,e),e}function et(t,e){var i=tt(e),n=i.length;if(null==t)return!n;for(var o=Object(t),s=0;s<n;s++){var a=i[s];if(e[a]!==o[a]||!(a in o))return!1}return!0}function it(t){return t instanceof it?t:this instanceof it?void(this._wrapped=t):new it(t)}function nt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,G(t))}it.VERSION=t,it.prototype.value=function(){return this._wrapped},it.prototype.valueOf=it.prototype.toJSON=it.prototype.value,it.prototype.toString=function(){return String(this._wrapped)};var ot="[object DataView]";function st(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&at(t,e,i,n)}function at(t,e,i,n){t instanceof it&&(t=t._wrapped),e instanceof it&&(e=e._wrapped);var s=r.call(t);if(s!==r.call(e))return!1;if(R&&"[object Object]"==s&&B(t)){if(!B(e))return!1;s=ot}switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return o.valueOf.call(t)===o.valueOf.call(e);case"[object ArrayBuffer]":case ot:return at(nt(t),nt(e),i,n)}var a="[object Array]"===s;if(!a&&Z(t)){if(G(t)!==G(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,c=e.constructor;if(l!==c&&!(L(l)&&l instanceof l&&L(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}n=n||[];for(var h=(i=i||[]).length;h--;)if(i[h]===t)return n[h]===e;if(i.push(t),n.push(e),a){if((h=t.length)!==e.length)return!1;for(;h--;)if(!st(t[h],e[h],i,n))return!1}else{var d,u=tt(t);if(h=u.length,tt(e).length!==h)return!1;for(;h--;)if(!H(e,d=u[h])||!st(t[d],e[d],i,n))return!1}return i.pop(),n.pop(),!0}function rt(t){if(!y(t))return[];var e=[];for(var i in t)e.push(i);return b&&Q(t,e),e}function lt(t){var e=J(t);return function(i){if(null==i)return!1;var n=rt(i);if(J(n))return!1;for(var o=0;o<e;o++)if(!L(i[t[o]]))return!1;return t!==mt||!L(i[ct])}}var ct="forEach",ht=["clear","delete"],dt=["get","has","set"],ut=ht.concat(ct,dt),mt=ht.concat(dt),pt=["add"].concat(ht,ct,"has"),ft=F?lt(ut):k("Map"),gt=F?lt(mt):k("WeakMap"),bt=F?lt(pt):k("Set"),vt=k("WeakSet");function Ct(t){for(var e=tt(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n}function wt(t){for(var e={},i=tt(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e}function yt(t){var e=[];for(var i in t)L(t[i])&&e.push(i);return e.sort()}function xt(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var s=arguments[o],a=t(s),r=a.length,l=0;l<r;l++){var c=a[l];e&&void 0!==i[c]||(i[c]=s[c])}return i}}var _t=xt(rt),kt=xt(tt),It=xt(rt,!0);function St(t){if(!y(t))return{};if(m)return m(t);var e=function(){};e.prototype=t;var i=new e;return e.prototype=null,i}function Et(t){return V(t)?t:[t]}function Tt(t){return it.toPath(t)}function Mt(t,e){for(var i=e.length,n=0;n<i;n++){if(null==t)return;t=t[e[n]]}return i?t:void 0}function At(t,e,i){var n=Mt(t,Tt(e));return x(n)?i:n}function Ut(t){return t}function Dt(t){return t=kt({},t),function(e){return et(e,t)}}function Pt(t){return t=Tt(t),function(e){return Mt(e,t)}}function Lt(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,s){return t.call(e,i,n,o,s)}}return function(){return t.apply(e,arguments)}}function Ot(t,e,i){return null==t?Ut:L(t)?Lt(t,e,i):y(t)&&!V(t)?Dt(t):Pt(t)}function Rt(t,e){return Ot(t,e,1/0)}function Ft(t,e,i){return it.iteratee!==Rt?it.iteratee(t,e):Ot(t,e,i)}function $t(){}function Bt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}it.toPath=Et,it.iteratee=Rt;var Vt=Date.now||function(){return(new Date).getTime()};function Ht(t){var e=function(e){return t[e]},i="(?:"+tt(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}}var Nt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},zt=Ht(Nt),jt=Ht(wt(Nt)),Wt=it.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},qt=/(.)^/,Kt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Gt=/\\|'|\r|\n|\u2028|\u2029/g;function Xt(t){return"\\"+Kt[t]}var Yt=/^\s*(\w|\$)+\s*$/;var Zt=0;function Jt(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var s=St(t.prototype),a=t.apply(s,o);return y(a)?a:s}var Qt=w((function(t,e){var i=Qt.placeholder,n=function(){for(var o=0,s=e.length,a=Array(s),r=0;r<s;r++)a[r]=e[r]===i?arguments[o++]:e[r];for(;o<arguments.length;)a.push(arguments[o++]);return Jt(t,n,this,this,a)};return n}));Qt.placeholder=it;var te=w((function(t,e,i){if(!L(t))throw new TypeError("Bind must be called on a function");var n=w((function(o){return Jt(t,n,e,this,i.concat(o))}));return n})),ee=q(J);function ie(t,e,i,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var o=n.length,s=0,a=J(t);s<a;s++){var r=t[s];if(ee(r)&&(V(r)||z(r)))if(e>1)ie(r,e-1,i,n),o=n.length;else for(var l=0,c=r.length;l<c;)n[o++]=r[l++];else i||(n[o++]=r)}return n}var ne=w((function(t,e){var i=(e=ie(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=te(t[n],t)}return t}));var oe=w((function(t,e,i){return setTimeout((function(){return t.apply(null,i)}),e)})),se=Qt(oe,it,1);function ae(t){return function(){return!t.apply(this,arguments)}}function re(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}}var le=Qt(re,2);function ce(t,e,i){e=Ft(e,i);for(var n,o=tt(t),s=0,a=o.length;s<a;s++)if(e(t[n=o[s]],n,t))return n}function he(t){return function(e,i,n){i=Ft(i,n);for(var o=J(e),s=t>0?0:o-1;s>=0&&s<o;s+=t)if(i(e[s],s,e))return s;return-1}}var de=he(1),ue=he(-1);function me(t,e,i,n){for(var o=(i=Ft(i,n,1))(e),s=0,a=J(t);s<a;){var r=Math.floor((s+a)/2);i(t[r])<o?s=r+1:a=r}return s}function pe(t,e,i){return function(n,o,s){var r=0,l=J(n);if("number"==typeof s)t>0?r=s>=0?s:Math.max(s+l,r):l=s>=0?Math.min(s+1,l):s+l+1;else if(i&&s&&l)return n[s=i(n,o)]===o?s:-1;if(o!=o)return(s=e(a.call(n,r,l),j))>=0?s+r:-1;for(s=t>0?r:l-1;s>=0&&s<l;s+=t)if(n[s]===o)return s;return-1}}var fe=pe(1,de,me),ge=pe(-1,ue);function be(t,e,i){var n=(ee(t)?de:ce)(t,e,i);if(void 0!==n&&-1!==n)return t[n]}function ve(t,e,i){var n,o;if(e=Lt(e,i),ee(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var s=tt(t);for(n=0,o=s.length;n<o;n++)e(t[s[n]],s[n],t)}return t}function Ce(t,e,i){e=Ft(e,i);for(var n=!ee(t)&&tt(t),o=(n||t).length,s=Array(o),a=0;a<o;a++){var r=n?n[a]:a;s[a]=e(t[r],r,t)}return s}function we(t){return function(e,i,n,o){var s=arguments.length>=3;return function(e,i,n,o){var s=!ee(e)&&tt(e),a=(s||e).length,r=t>0?0:a-1;for(o||(n=e[s?s[r]:r],r+=t);r>=0&&r<a;r+=t){var l=s?s[r]:r;n=i(n,e[l],l,e)}return n}(e,Lt(i,o,4),n,s)}}var ye=we(1),xe=we(-1);function _e(t,e,i){var n=[];return e=Ft(e,i),ve(t,(function(t,i,o){e(t,i,o)&&n.push(t)})),n}function ke(t,e,i){e=Ft(e,i);for(var n=!ee(t)&&tt(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(!e(t[a],a,t))return!1}return!0}function Ie(t,e,i){e=Ft(e,i);for(var n=!ee(t)&&tt(t),o=(n||t).length,s=0;s<o;s++){var a=n?n[s]:s;if(e(t[a],a,t))return!0}return!1}function Se(t,e,i,n){return ee(t)||(t=Ct(t)),("number"!=typeof i||n)&&(i=0),fe(t,e,i)>=0}var Ee=w((function(t,e,i){var n,o;return L(e)?o=e:(e=Tt(e),n=e.slice(0,-1),e=e[e.length-1]),Ce(t,(function(t){var s=o;if(!s){if(n&&n.length&&(t=Mt(t,n)),null==t)return;s=t[e]}return null==s?s:s.apply(t,i)}))}));function Te(t,e){return Ce(t,Pt(e))}function Me(t,e,i){var n,o,s=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var r=0,l=(t=ee(t)?t:Ct(t)).length;r<l;r++)null!=(n=t[r])&&n>s&&(s=n);else e=Ft(e,i),ve(t,(function(t,i,n){((o=e(t,i,n))>a||o===-1/0&&s===-1/0)&&(s=t,a=o)}));return s}var Ae=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ue(t){return t?V(t)?a.call(t):I(t)?t.match(Ae):ee(t)?Ce(t,Ut):Ct(t):[]}function De(t,e,i){if(null==e||i)return ee(t)||(t=Ct(t)),t[Bt(t.length-1)];var n=Ue(t),o=J(n);e=Math.max(Math.min(e,o),0);for(var s=o-1,a=0;a<e;a++){var r=Bt(a,s),l=n[a];n[a]=n[r],n[r]=l}return n.slice(0,e)}function Pe(t,e){return function(i,n,o){var s=e?[[],[]]:{};return n=Ft(n,o),ve(i,(function(e,o){var a=n(e,o,i);t(s,e,a)})),s}}var Le=Pe((function(t,e,i){H(t,i)?t[i].push(e):t[i]=[e]})),Oe=Pe((function(t,e,i){t[i]=e})),Re=Pe((function(t,e,i){H(t,i)?t[i]++:t[i]=1})),Fe=Pe((function(t,e,i){t[i?0:1].push(e)}),!0);function $e(t,e,i){return e in i}var Be=w((function(t,e){var i={},n=e[0];if(null==t)return i;L(n)?(e.length>1&&(n=Lt(n,e[1])),e=rt(t)):(n=$e,e=ie(e,!1,!1),t=Object(t));for(var o=0,s=e.length;o<s;o++){var a=e[o],r=t[a];n(r,a,t)&&(i[a]=r)}return i})),Ve=w((function(t,e){var i,n=e[0];return L(n)?(n=ae(n),e.length>1&&(i=e[1])):(e=Ce(ie(e,!1,!1),String),n=function(t,i){return!Se(e,i)}),Be(t,n,i)}));function He(t,e,i){return a.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))}function Ne(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[0]:He(t,t.length-e)}function ze(t,e,i){return a.call(t,null==e||i?1:e)}var je=w((function(t,e){return e=ie(e,!0,!0),_e(t,(function(t){return!Se(e,t)}))})),We=w((function(t,e){return je(t,e)}));function qe(t,e,i,n){_(e)||(n=i,i=e,e=!1),null!=i&&(i=Ft(i,n));for(var o=[],s=[],a=0,r=J(t);a<r;a++){var l=t[a],c=i?i(l,a,t):l;e&&!i?(a&&s===c||o.push(l),s=c):i?Se(s,c)||(s.push(c),o.push(l)):Se(o,l)||o.push(l)}return o}var Ke=w((function(t){return qe(ie(t,!0,!0))}));function Ge(t){for(var e=t&&Me(t,J).length||0,i=Array(e),n=0;n<e;n++)i[n]=Te(t,n);return i}var Xe=w(Ge);function Ye(t,e){return t._chain?it(e).chain():e}function Ze(t){return ve(yt(t),(function(e){var i=it[e]=t[e];it.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),Ye(this,i.apply(it,t))}})),it}ve(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=i[t];it.prototype[t]=function(){var i=this._wrapped;return null!=i&&(e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0]),Ye(this,i)}})),ve(["concat","join","slice"],(function(t){var e=i[t];it.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Ye(this,t)}}));var Je={__proto__:null,VERSION:t,restArguments:w,isObject:y,isNull:function(t){return null===t},isUndefined:x,isBoolean:_,isElement:function(t){return!(!t||1!==t.nodeType)},isString:I,isNumber:S,isDate:E,isRegExp:T,isError:M,isSymbol:A,isArrayBuffer:U,isDataView:B,isArray:V,isFunction:L,isArguments:z,isFinite:function(t){return!A(t)&&g(t)&&!isNaN(parseFloat(t))},isNaN:j,isTypedArray:Z,isEmpty:function(t){if(null==t)return!0;var e=J(t);return"number"==typeof e&&(V(t)||I(t)||z(t))?0===e:0===J(tt(t))},isMatch:et,isEqual:function(t,e){return st(t,e)},isMap:ft,isWeakMap:gt,isSet:bt,isWeakSet:vt,keys:tt,allKeys:rt,values:Ct,pairs:function(t){for(var e=tt(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},invert:wt,functions:yt,methods:yt,extend:_t,extendOwn:kt,assign:kt,defaults:It,create:function(t,e){var i=St(t);return e&&kt(i,e),i},clone:function(t){return y(t)?V(t)?t.slice():_t({},t):t},tap:function(t,e){return e(t),t},get:At,has:function(t,e){for(var i=(e=Tt(e)).length,n=0;n<i;n++){var o=e[n];if(!H(t,o))return!1;t=t[o]}return!!i},mapObject:function(t,e,i){e=Ft(e,i);for(var n=tt(t),o=n.length,s={},a=0;a<o;a++){var r=n[a];s[r]=e(t[r],r,t)}return s},identity:Ut,constant:W,noop:$t,toPath:Et,property:Pt,propertyOf:function(t){return null==t?$t:function(e){return At(t,e)}},matcher:Dt,matches:Dt,times:function(t,e,i){var n=Array(Math.max(0,t));e=Lt(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},random:Bt,now:Vt,escape:zt,unescape:jt,templateSettings:Wt,template:function(t,e,i){!e&&i&&(e=i),e=It({},e,it.templateSettings);var n=RegExp([(e.escape||qt).source,(e.interpolate||qt).source,(e.evaluate||qt).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(n,(function(e,i,n,a,r){return s+=t.slice(o,r).replace(Gt,Xt),o=r+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e})),s+="';\n";var a,r=e.variable;if(r){if(!Yt.test(r))throw new Error("variable is not a bare identifier: "+r)}else s="with(obj||{}){\n"+s+"}\n",r="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{a=new Function(r,"_",s)}catch(t){throw t.source=s,t}var l=function(t){return a.call(this,t,it)};return l.source="function("+r+"){\n"+s+"}",l},result:function(t,e,i){var n=(e=Tt(e)).length;if(!n)return L(i)?i.call(t):i;for(var o=0;o<n;o++){var s=null==t?void 0:t[e[o]];void 0===s&&(s=i,o=n),t=L(s)?s.call(t):s}return t},uniqueId:function(t){var e=++Zt+"";return t?t+e:e},chain:function(t){var e=it(t);return e._chain=!0,e},iteratee:Rt,partial:Qt,bind:te,bindAll:ne,memoize:function(t,e){var i=function(n){var o=i.cache,s=""+(e?e.apply(this,arguments):n);return H(o,s)||(o[s]=t.apply(this,arguments)),o[s]};return i.cache={},i},delay:oe,defer:se,throttle:function(t,e,i){var n,o,s,a,r=0;i||(i={});var l=function(){r=!1===i.leading?0:Vt(),n=null,a=t.apply(o,s),n||(o=s=null)},c=function(){var c=Vt();r||!1!==i.leading||(r=c);var h=e-(c-r);return o=this,s=arguments,h<=0||h>e?(n&&(clearTimeout(n),n=null),r=c,a=t.apply(o,s),n||(o=s=null)):n||!1===i.trailing||(n=setTimeout(l,h)),a};return c.cancel=function(){clearTimeout(n),r=0,n=o=s=null},c},debounce:function(t,e,i){var n,o,s,a,r,l=function(){var c=Vt()-o;e>c?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(r,s)),n||(s=r=null))},c=w((function(c){return r=this,s=c,o=Vt(),n||(n=setTimeout(l,e),i&&(a=t.apply(r,s))),a}));return c.cancel=function(){clearTimeout(n),n=s=r=null},c},wrap:function(t,e){return Qt(e,t)},negate:ae,compose:function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:re,once:le,findKey:ce,findIndex:de,findLastIndex:ue,sortedIndex:me,indexOf:fe,lastIndexOf:ge,find:be,detect:be,findWhere:function(t,e){return be(t,Dt(e))},each:ve,forEach:ve,map:Ce,collect:Ce,reduce:ye,foldl:ye,inject:ye,reduceRight:xe,foldr:xe,filter:_e,select:_e,reject:function(t,e,i){return _e(t,ae(Ft(e)),i)},every:ke,all:ke,some:Ie,any:Ie,contains:Se,includes:Se,include:Se,invoke:Ee,pluck:Te,where:function(t,e){return _e(t,Dt(e))},max:Me,min:function(t,e,i){var n,o,s=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var r=0,l=(t=ee(t)?t:Ct(t)).length;r<l;r++)null!=(n=t[r])&&n<s&&(s=n);else e=Ft(e,i),ve(t,(function(t,i,n){((o=e(t,i,n))<a||o===1/0&&s===1/0)&&(s=t,a=o)}));return s},shuffle:function(t){return De(t,1/0)},sample:De,sortBy:function(t,e,i){var n=0;return e=Ft(e,i),Te(Ce(t,(function(t,i,o){return{value:t,index:n++,criteria:e(t,i,o)}})).sort((function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index})),"value")},groupBy:Le,indexBy:Oe,countBy:Re,partition:Fe,toArray:Ue,size:function(t){return null==t?0:ee(t)?t.length:tt(t).length},pick:Be,omit:Ve,first:Ne,head:Ne,take:Ne,initial:He,last:function(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[t.length-1]:ze(t,Math.max(0,t.length-e))},rest:ze,tail:ze,drop:ze,compact:function(t){return _e(t,Boolean)},flatten:function(t,e){return ie(t,e,!1)},without:We,uniq:qe,unique:qe,union:Ke,intersection:function(t){for(var e=[],i=arguments.length,n=0,o=J(t);n<o;n++){var s=t[n];if(!Se(e,s)){var a;for(a=1;a<i&&Se(arguments[a],s);a++);a===i&&e.push(s)}}return e},difference:je,unzip:Ge,transpose:Ge,zip:Xe,object:function(t,e){for(var i={},n=0,o=J(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},range:function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),s=0;s<n;s++,t+=i)o[s]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,o=t.length;n<o;)i.push(a.call(t,n,n+=e));return i},mixin:Ze,default:it},Qe=Ze(Je);return Qe._=Qe,Qe})),function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],(function(i,n,o){e.Backbone=t(e,o,i,n)}));else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(t){}t(e,exports,n,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}((function(t,e,i,n){var o=t.Backbone,s=Array.prototype.slice;e.VERSION="1.6.0",e.$=n,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a,r=e.Events={},l=/\s+/,c=function(t,e,n,o,s){var a,r=0;if(n&&"object"==typeof n){void 0!==o&&"context"in s&&void 0===s.context&&(s.context=o);for(a=i.keys(n);r<a.length;r++)e=c(t,e,a[r],n[a[r]],s)}else if(n&&l.test(n))for(a=n.split(l);r<a.length;r++)e=t(e,a[r],o,s);else e=t(e,n,o,s);return e};r.on=function(t,e,i){(this._events=c(h,this._events||{},t,e,{context:i,ctx:this,listening:a}),a)&&((this._listeners||(this._listeners={}))[a.id]=a,a.interop=!1);return this},r.listenTo=function(t,e,n){if(!t)return this;var o=t._listenId||(t._listenId=i.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),r=a=s[o];r||(this._listenId||(this._listenId=i.uniqueId("l")),r=a=s[o]=new g(this,t));var l=d(t,e,n,this);if(a=void 0,l)throw l;return r.interop&&r.on(e,n),this};var h=function(t,e,i,n){if(i){var o=t[e]||(t[e]=[]),s=n.context,a=n.ctx,r=n.listening;r&&r.count++,o.push({callback:i,context:s,ctx:s||a,listening:r})}return t},d=function(t,e,i,n){try{t.on(e,i,n)}catch(t){return t}};r.off=function(t,e,i){return this._events?(this._events=c(u,this._events,t,e,{context:i,listeners:this._listeners}),this):this},r.stopListening=function(t,e,n){var o=this._listeningTo;if(!o)return this;for(var s=t?[t._listenId]:i.keys(o),a=0;a<s.length;a++){var r=o[s[a]];if(!r)break;r.obj.off(e,n,this),r.interop&&r.off(e,n)}return i.isEmpty(o)&&(this._listeningTo=void 0),this};var u=function(t,e,n,o){if(t){var s,a=o.context,r=o.listeners,l=0;if(e||a||n){for(s=e?[e]:i.keys(t);l<s.length;l++){var c=t[e=s[l]];if(!c)break;for(var h=[],d=0;d<c.length;d++){var u=c[d];if(n&&n!==u.callback&&n!==u.callback._callback||a&&a!==u.context)h.push(u);else{var m=u.listening;m&&m.off(e,n)}}h.length?t[e]=h:delete t[e]}return t}for(s=i.keys(r);l<s.length;l++)r[s[l]].cleanup()}};r.once=function(t,e,i){var n=c(m,{},t,e,this.off.bind(this));return"string"==typeof t&&null==i&&(e=void 0),this.on(n,e,i)},r.listenToOnce=function(t,e,i){var n=c(m,{},e,i,this.stopListening.bind(this,t));return this.listenTo(t,n)};var m=function(t,e,n,o){if(n){var s=t[e]=i.once((function(){o(e,s),n.apply(this,arguments)}));s._callback=n}return t};r.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return c(p,this._events,t,void 0,i),this};var p=function(t,e,i,n){if(t){var o=t[e],s=t.all;o&&s&&(s=s.slice()),o&&f(o,n),s&&f(s,[e].concat(n))}return t},f=function(t,e){var i,n=-1,o=t.length,s=e[0],a=e[1],r=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,a,r);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e);return}},g=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};g.prototype.on=r.on,g.prototype.off=function(t,e){var i;this.interop?(this._events=c(u,this._events,t,e,{context:void 0,listeners:void 0}),i=!this._events):(this.count--,i=0===this.count),i&&this.cleanup()},g.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},r.bind=r.on,r.unbind=r.off,i.extend(e,r);var b=e.Model=function(t,e){var n=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var o=i.result(this,"defaults");n=i.defaults(i.extend({},o,n),o),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(b.prototype,r,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var o;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;var s=n.unset,a=n.silent,r=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,h=this.changed,d=this._previousAttributes;for(var u in o)e=o[u],i.isEqual(c[u],e)||r.push(u),i.isEqual(d[u],e)?delete h[u]:h[u]=e,s?delete c[u]:c[u]=e;if(this.idAttribute in o){var m=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,m,n)}if(!a){r.length&&(this._pending=n);for(var p=0;p<r.length;p++)this.trigger("change:"+r[p],this,c[r[p]],n)}if(l)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e,n=this._changing?this._previousAttributes:this.attributes,o={};for(var s in t){var a=t[s];i.isEqual(n[s],a)||(o[s]=a,e=!0)}return!!e&&o},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var o=t.parse?e.parse(i,t):i;if(!e.set(o,t))return!1;n&&n.call(t.context,e,i,t),e.trigger("sync",e,i,t)},j(this,t),this.sync("read",this,t)},save:function(t,e,n){var o;null==t||"object"==typeof t?(o=t,n=e):(o={})[t]=e;var s=(n=i.extend({validate:!0,parse:!0},n)).wait;if(o&&!s){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;var a=this,r=n.success,l=this.attributes;n.success=function(t){a.attributes=l;var e=n.parse?a.parse(t,n):t;if(s&&(e=i.extend({},o,e)),e&&!a.set(e,n))return!1;r&&r.call(n.context,a,t,n),a.trigger("sync",a,t,n)},j(this,n),o&&s&&(this.attributes=i.extend({},l,o));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=o);var h=this.sync(c,this,n);return this.attributes=l,h},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,o=t.wait,s=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){o&&s(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var a=!1;return this.isNew()?i.defer(t.success):(j(this,t),a=this.sync("delete",this,t)),o||s(),a},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||z();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});var v=e.Collection=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},C={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},y=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,o=Array(t.length-i),s=e.length;for(n=0;n<o.length;n++)o[n]=t[n+i];for(n=0;n<s;n++)t[n+i]=e[n];for(n=0;n<o.length;n++)t[n+s+i]=o[n]};i.extend(v.prototype,r,{model:b,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,w))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var o=this._removeModels(t,e);return!e.silent&&o.length&&(e.changes={added:[],merged:[],removed:o},this.trigger("update",this,e)),n?o[0]:o},set:function(t,e){if(null!=t){(e=i.extend({},C,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var o=e.at;null!=o&&(o=+o),o>this.length&&(o=this.length),o<0&&(o+=this.length+1);var s,a,r=[],l=[],c=[],h=[],d={},u=e.add,m=e.merge,p=e.remove,f=!1,g=this.comparator&&null==o&&!1!==e.sort,b=i.isString(this.comparator)?this.comparator:null;for(a=0;a<t.length;a++){s=t[a];var v=this.get(s);if(v){if(m&&s!==v){var w=this._isModel(s)?s.attributes:s;e.parse&&(w=v.parse(w,e)),v.set(w,e),c.push(v),g&&!f&&(f=v.hasChanged(b))}d[v.cid]||(d[v.cid]=!0,r.push(v)),t[a]=v}else u&&(s=t[a]=this._prepareModel(s,e))&&(l.push(s),this._addReference(s,e),d[s.cid]=!0,r.push(s))}if(p){for(a=0;a<this.length;a++)d[(s=this.models[a]).cid]||h.push(s);h.length&&this._removeModels(h,e)}var x=!1,_=!g&&u&&p;if(r.length&&_?(x=this.length!==r.length||i.some(this.models,(function(t,e){return t!==r[e]})),this.models.length=0,y(this.models,r,0),this.length=this.models.length):l.length&&(g&&(f=!0),y(this.models,l,null==o?this.length:o),this.length=this.models.length),f&&this.sort({silent:!0}),!e.silent){for(a=0;a<l.length;a++)null!=o&&(e.index=o+a),(s=l[a]).trigger("add",s,this,e);(f||x)&&this.trigger("sort",this,e),(l.length||h.length||c.length)&&(e.changes={added:l,removed:h,merged:c},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t,t.idAttribute)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=e.bind(this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=i.extend({parse:!0},t)).success,n=this;return t.success=function(i){var o=t.reset?"reset":"set";n[o](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},j(this,t),this.sync("read",this,t)},create:function(t,e){var n=(e=e?i.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var o=this,s=e.success;return e.success=function(t,e,i){n&&(t.off("error",o._forwardPristineError,o),o.add(t,i)),s&&s.call(i.context,t,e,i)},n&&t.once("error",this._forwardPristineError,this),t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t,e){return t[e||this.model.prototype.idAttribute||"id"]},values:function(){return new _(this,k)},keys:function(){return new _(this,I)},entries:function(){return new _(this,S)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){return this._isModel(t)?(t.collection||(t.collection=this),t):((e=e?i.clone(e):{}).collection=this,(n=this.model.prototype?new this.model(t,e):this.model(t,e)).validationError?(this.trigger("invalid",this,n.validationError,e),!1):n);var n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var o=this.get(t[n]);if(o){var s=this.indexOf(o);this.models.splice(s,1),this.length--,delete this._byId[o.cid];var a=this.modelId(o.attributes,o.idAttribute);null!=a&&delete this._byId[a],e.silent||(e.index=s,o.trigger("remove",o,this,e)),i.push(o),this._removeReference(o,e)}}return t.length>0&&!e.silent&&delete e.index,i},_isModel:function(t){return t instanceof b},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes,t.idAttribute);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes,t.idAttribute);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"changeId"===t){var o=this.modelId(e.previousAttributes(),e.idAttribute),s=this.modelId(e.attributes,e.idAttribute);null!=o&&delete this._byId[o],null!=s&&(this._byId[s]=e)}}this.trigger.apply(this,arguments)},_forwardPristineError:function(t,e,i){this.has(t)||this._onModelEvent("error",t,e,i)}});var x="function"==typeof Symbol&&Symbol.iterator;x&&(v.prototype[x]=v.prototype.values);var _=function(t,e){this._collection=t,this._kind=e,this._index=0},k=1,I=2,S=3;x&&(_.prototype[x]=function(){return this}),_.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===k)t=e;else{var i=this._collection.modelId(e.attributes,e.idAttribute);t=this._kind===I?i:[i,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var E=e.View=function(t){this.cid=i.uniqueId("view"),this.preinitialize.apply(this,arguments),i.extend(this,i.pick(t,M)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,M=["model","collection","el","id","attributes","className","tagName","events"];i.extend(E.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var o=e.match(T);this.delegate(o[1],o[2],n.bind(this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var A=function(t,e,n,o){i.each(n,(function(i,n){e[n]&&(t.prototype[n]=function(t,e,i,n){switch(e){case 1:return function(){return t[i](this[n])};case 2:return function(e){return t[i](this[n],e)};case 3:return function(e,o){return t[i](this[n],U(e,this),o)};case 4:return function(e,o,s){return t[i](this[n],U(e,this),o,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[n]),t[i].apply(t,e)}}}(e,i,n,o))}))},U=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?D(t):i.isString(t)?function(e){return e.get(t)}:t},D=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}};i.each([[v,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[b,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],(function(t){var e=t[0],n=t[1],o=t[2];e.mixin=function(t){var n=i.reduce(i.functions(t),(function(t,e){return t[e]=0,t}),{});A(e,t,n,o)},A(e,i,n,o)})),e.sync=function(t,n,o){var s=P[t];i.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:s,dataType:"json"};if(o.url||(a.url=i.result(n,"url")||z()),null!=o.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),o.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){a.type="POST",o.emulateJSON&&(a.data._method=s);var r=o.beforeSend;o.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",s),r)return r.apply(this,arguments)}}"GET"===a.type||o.emulateJSON||(a.processData=!1);var l=o.error;o.error=function(t,e,i){o.textStatus=e,o.errorThrown=i,l&&l.call(o.context,t,e,i)};var c=o.xhr=e.ajax(i.extend(a,o));return n.trigger("request",n,c,o),c};var P={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var L=e.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},O=/\((.*?)\)/g,R=/(\(\?)?:\w+/g,F=/\*\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(L.prototype,r,{preinitialize:function(){},initialize:function(){},route:function(t,n,o){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var s=this;return e.history.route(t,(function(i){var a=s._extractParameters(t,i);!1!==s.execute(o,a,n)&&(s.trigger.apply(s,["route:"+n].concat(a)),s.trigger("route",n,a),e.history.trigger("route",s,n,a))})),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace($,"\\$&").replace(O,"(?:$1)?").replace(R,(function(t,e){return e?t:"([^/?]+)"})).replace(F,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,(function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null}))}});var B=e.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},V=/^[#\/]|\s+$/g,H=/^\/+|\/+$/g,N=/#.*$/;B.started=!1,i.extend(B.prototype,r,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(V,"")},start:function(t){if(B.started)throw new Error("Backbone.history has already been started");if(B.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._trailingSlash=this.options.trailingSlash,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(H,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,o=n.insertBefore(this.iframe,n.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var s=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),B.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!this.matchRoot()&&this.notfound();this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return this.matchRoot()?(t=this.fragment=this.getFragment(t),i.some(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0}))||this.notfound()):this.notfound()},notfound:function(){return this.trigger("notfound"),!1},navigate:function(t,e){if(!B.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;this._trailingSlash||""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;t=t.replace(N,"");var o=this.decodeFragment(t);if(this.fragment!==o){if(this.fragment=o,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;e.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new B;b.extend=v.extend=L.extend=E.extend=B.extend=function(t,e){var n,o=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,e),n.prototype=i.create(o.prototype,t),n.prototype.constructor=n,n.__super__=o.prototype,n};var z=function(){throw new Error('A "url" property or function must be specified')},j=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e._debug=function(){return{root:t,_:i}},e})),void 0===Common)var Common={};if(define("notification",["backbone","underscore"],(function(t,e){"use strict";var i=function(){};if(e.extend(i.prototype,t.Events),void 0!==Common.NotificationCenter)throw"Native Common.NotificationCenter instance already defined.";i.extend=t.Model.extend,Common.NotificationCenter=new i})),define("core",["underscore"],(function(t){var e=function(t,e){for(var i=t.split("."),n=e||window,o=0,s=i.length;o<s;o++)n=n[i[o]]||{};return n},i=function(e){t.extend(this,e||{}),this.eventbus=new o({application:this}),this.createApplicationNamespace(),this.initialize.apply(this,arguments),!1!==this.autoCreate&&$($.proxy(this.onReady,this))};if(t.extend(i.prototype,{nameSpace:"Application",models:{},collections:{},controllers:{},allocationMap:{model:"Models",collection:"Collections",controller:"Controllers",view:"Views"},createApplicationNamespace:function(){var e=window;this.nameSpace&&void 0===e[this.nameSpace]&&(e[this.nameSpace]={}),e[this.nameSpace]=this,t.each(this.allocationMap,(function(t,e){this[t]=this[t]||{}}),this)},initialize:function(){},onReady:function(){this.start()},start:function(){this.initializeControllers(this.controllers||{}),this.launchControllers(),this.launch.call(this)},getClasseRefs:function(i,n){var o={},s=this[this.allocationMap[i]];return t.each(n,(function(t){o[t]=e(t,t.indexOf(".")>-1?window:s)}),this),o},initializeControllers:function(i){this.controllers={},t.each(i,(function(i){var n=i.indexOf(".")>-1?window:this[this.allocationMap.controller],o=e(i,n),s=(i.split(".").pop(),new o({id:i,application:this}));s.views=this.getClasseRefs("view",s.views||[]),t.extend(this.models,this.getClasseRefs("model",s.models||[])),t.extend(this.collections,this.getClasseRefs("collection",s.collections||{})),this.buildCollections(),this.controllers[i]=s}),this)},launchControllers:function(){t.each(this.controllers,(function(t,e){t.onLaunch(this)}),this)},launch:function(){},addListeners:function(t,e){this.eventbus.addListeners(t,e)},getController:function(t){return this.controllers[t]},getModel:function(t){this._modelsCache=this._modelsCache||{};var e=this._modelsCache[t],i=this.getModelConstructor(t);return!e&&i&&(e=this.createModel(t),this._modelsCache[t]=e),e||null},getModelConstructor:function(t){return this.models[t]},createModel:function(e,i){var n=this.getModelConstructor(e),o=null;return n&&(o=new n(t.extend(i||{}))),o},getCollection:function(t){this._collectionsCache=this._collectionsCache||{};var e=this._collectionsCache[t],i=this.getCollectionConstructor(t);return!e&&i&&(e=this.createCollection(t),this._collectionsCache[t]=e),e||null},getCollectionConstructor:function(t){return this.collections[t]},createCollection:function(t){var e=this.getCollectionConstructor(t),i=null;return e&&(i=new e),i},buildCollections:function(){t.each(this.collections,(function(t,e){this.getCollection(e)}),this)}}),void 0!==Backbone.Application)throw"Native Backbone.Application instance already defined.";Backbone.Application=i,Backbone.Application.extend=Backbone.Model.extend;var n=function(e){t.extend(this,e||{}),this.initialize.apply(this,arguments)};if(t.extend(n.prototype,{name:null,views:{},models:{},collections:{},initialize:function(t){},addListeners:function(t){this.getApplication().addListeners(t,this)},onLaunch:function(t){},getApplication:function(){return this.application},getView:function(t){return this._viewsCache[t]},getViewConstructor:function(t){return this.views[t]},createView:function(e,i){var n=this.getViewConstructor(e),o=t.extend(i||{},{alias:e});return this._viewsCache=this._viewsCache||{},this._viewsCache[e]=new n(o),this._viewsCache[e].options=t.extend({},o),this._viewsCache[e]},getModel:function(t){return this.application.getModel(t)},getModelConstructor:function(t){return this.application.getModelConstructor(t)},createModel:function(t,e){return this.application.createModel(t)},getCollection:function(t){return this.application.getCollection(t)},getCollectionConstructor:function(t){return this.application.getCollectionConstructor(t)},createCollection:function(t){return this.application.createCollection(t)},fireEvent:function(t,e,i){this.application.eventbus.fireEvent(t,e,i)},bindViewEvents:function(e,i){for(var n in this.unbindViewEvents(e),i=t.isFunction(i)?i.call(this):i){var o=i[n];t.isFunction(o)||(o=this[i[n]]);var s=n.match(/^(\S+)\s*(.*)$/),a=s[1],r=s[2];o=t.bind(o,this),a+=".bindViewEvents"+e.cid,e.$el.on(a,r,o)}return this},unbindViewEvents:function(t){return t.$el.off(".bindViewEvents"+t.cid),this}}),void 0!==Backbone.Controller)throw"Native Backbone.Controller instance already defined.";Backbone.Controller=n,Backbone.Controller.extend=Backbone.Model.extend;var o=function(e){var i=this;t.extend(this,e||{}),t.extend(Backbone.View.prototype,{alias:null,hidden:!1,getAlias:function(){return this.options.alias},fireEvent:function(t,e){this.trigger.apply(this,arguments),i.fireEvent(this.getAlias(),t,e)},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.$el.show(),this.hidden=!1}})};if(t.extend(o.prototype,{pool:{},addListeners:function(e,i){this.pool[i.id]=this.pool[i.id]||{};var n=this.pool[i.id];t.isArray(e)?t.each(e,(function(t){this.addListeners(t,i)}),this):t.isObject(e)&&t.each(e,(function(e,i){t.each(e,(function(t,e){n[i]=n[i]||{},n[i][e]=n[i][e]||[],n[i][e].push(t)}),this)}),this)},fireEvent:function(e,i,n){var o=this.getApplication();t.each(this.pool,(function(s,a){var r=s[e];if(r){var l=r[i],c=o.getController(a);t.each(l,(function(t){t.apply(c,n)}))}}),this)},getApplication:function(){return this.application}}),void 0!==Backbone.EventBus)throw"Native Backbone.Application instance already defined.";Backbone.EventBus=o})),void 0===window.Common&&(window.Common={}),Common.component=Common.component||{},Common.Analytics=Common.component.Analytics=new function(){var t;return{initialize:function(e,i){if(void 0===e)throw"Analytics: invalid id.";if(void 0===i||"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid category type.";t=i,$("head").append('<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(["_setAccount", "'+e+'"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);})();<\/script>')},trackEvent:function(e,i,n){if(void 0!==e&&"[object String]"!==Object.prototype.toString.apply(e))throw"Analytics: invalid action type.";if(void 0!==i&&"[object String]"!==Object.prototype.toString.apply(i))throw"Analytics: invalid label type.";if(void 0!==n&&("[object Number]"!==Object.prototype.toString.apply(n)||!isFinite(n)))throw"Analytics: invalid value type.";if("undefined"!=typeof _gaq){if("undefined"===t)throw"Analytics is not initialized.";_gaq.push(["_trackEvent",t,e,i,n])}}}},define("analytics",["jquery"],(function(){})),void 0===window.Common&&(window.Common={}),Common.Gateway=new function(){var t=this,e=$(t),i={init:function(t){e.trigger("init",t)},openDocument:function(t){e.trigger("opendocument",t)},openDocumentFromBinary:function(t){e.trigger("opendocumentfrombinary",t)},showMessage:function(t){e.trigger("showmessage",t)},applyEditRights:function(t){e.trigger("applyeditrights",t)},processSaveResult:function(t){e.trigger("processsaveresult",t)},processRightsChange:function(t){e.trigger("processrightschange",t)},refreshHistory:function(t){e.trigger("refreshhistory",t)},setHistoryData:function(t){e.trigger("sethistorydata",t)},setEmailAddresses:function(t){e.trigger("setemailaddresses",t)},setActionLink:function(t){e.trigger("setactionlink",t.url)},processMailMerge:function(t){e.trigger("processmailmerge",t)},downloadAs:function(t){e.trigger("downloadas",t)},processMouse:function(t){e.trigger("processmouse",t)},internalCommand:function(t){e.trigger("internalcommand",t)},resetFocus:function(t){e.trigger("resetfocus",t)},setUsers:function(t){e.trigger("setusers",t)},showSharingSettings:function(t){e.trigger("showsharingsettings",t)},setSharingSettings:function(t){e.trigger("setsharingsettings",t)},insertImage:function(t){e.trigger("insertimage",t)},setMailMergeRecipients:function(t){e.trigger("setmailmergerecipients",t)},setRevisedFile:function(t){e.trigger("setrevisedfile",t)},setFavorite:function(t){e.trigger("setfavorite",t)},requestClose:function(t){e.trigger("requestclose",t)},blurFocus:function(t){e.trigger("blurfocus",t)},grabFocus:function(t){e.trigger("grabfocus",t)},setReferenceData:function(t){e.trigger("setreferencedata",t)},refreshFile:function(t){e.trigger("refreshfile",t)},setRequestedDocument:function(t){e.trigger("setrequesteddocument",t)},setRequestedSpreadsheet:function(t){e.trigger("setrequestedspreadsheet",t)},setReferenceSource:function(t){e.trigger("setreferencesource",t)},startFilling:function(t){e.trigger("startfilling",t)},requestRoles:function(t){e.trigger("requestroles",t)}},n=function(t,e){window.parent&&window.JSON&&(t.frameEditorId=window.frameEditorId,e?window.parent.postMessage(t,"*",[e]):window.parent.postMessage(window.JSON.stringify(t),"*"))},o=function(t){!function(t){if(t.origin===window.parentOrigin||t.origin===window.location.origin||"null"===t.origin&&("file://"===window.parentOrigin||"file://"===window.location.origin)){var e=t.data;if(e&&"openDocumentFromBinary"===e.command)(o=i[e.command])&&o.call(this,e.data);else if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var n,o;try{n=window.JSON.parse(e)}catch(t){n=""}n&&(o=i[n.command])&&o.call(this,n.data)}}}(t)};return window.attachEvent?window.attachEvent("onmessage",o):window.addEventListener("message",o,!1),{appReady:function(){n({event:"onAppReady"})},requestEditRights:function(){n({event:"onRequestEditRights"})},requestHistory:function(){n({event:"onRequestHistory"})},requestHistoryData:function(t){n({event:"onRequestHistoryData",data:t})},requestRestore:function(t,e,i){n({event:"onRequestRestore",data:{version:t,url:e,fileType:i}})},requestEmailAddresses:function(){n({event:"onRequestEmailAddresses"})},requestStartMailMerge:function(){n({event:"onRequestStartMailMerge"})},requestHistoryClose:function(t){n({event:"onRequestHistoryClose"})},reportError:function(t,e){n({event:"onError",data:{errorCode:t,errorDescription:e}})},reportWarning:function(t,e){n({event:"onWarning",data:{warningCode:t,warningDescription:e}})},sendInfo:function(t){n({event:"onInfo",data:t})},setDocumentModified:function(t){n({event:"onDocumentStateChange",data:t})},internalMessage:function(t,e){n({event:"onInternalMessage",data:{type:t,data:e}})},updateVersion:function(){n({event:"onOutdatedVersion"})},downloadAs:function(t,e){n({event:"onDownloadAs",data:{url:t,fileType:e}})},requestSaveAs:function(t,e,i){n({event:"onRequestSaveAs",data:{url:t,title:e,fileType:i}})},collaborativeChanges:function(){n({event:"onCollaborativeChanges"})},requestRename:function(t){n({event:"onRequestRename",data:t})},metaChange:function(t){n({event:"onMetaChange",data:t})},documentReady:function(){n({event:"onDocumentReady"})},requestClose:function(){n({event:"onRequestClose"})},requestMakeActionLink:function(t){n({event:"onMakeActionLink",data:t})},requestUsers:function(t,e,i,o,s){n({event:"onRequestUsers",data:{c:t,id:e,from:i,count:o,search:s}})},requestSendNotify:function(t){n({event:"onRequestSendNotify",data:t})},requestInsertImage:function(t){n({event:"onRequestInsertImage",data:{c:t}})},requestMailMergeRecipients:function(){n({event:"onRequestMailMergeRecipients"})},requestCompareFile:function(){n({event:"onRequestCompareFile"})},requestSharingSettings:function(){n({event:"onRequestSharingSettings"})},requestCreateNew:function(){n({event:"onRequestCreateNew"})},requestReferenceData:function(t){n({event:"onRequestReferenceData",data:t})},requestOpen:function(t){n({event:"onRequestOpen",data:t})},requestSelectDocument:function(t){n({event:"onRequestSelectDocument",data:{c:t}})},requestSelectSpreadsheet:function(t){n({event:"onRequestSelectSpreadsheet",data:{c:t}})},requestReferenceSource:function(){n({event:"onRequestReferenceSource"})},requestStartFilling:function(t){n({event:"onRequestStartFilling",data:t})},switchEditorType:function(t,e){n({event:"onSwitchEditorType",data:{type:t,restart:e}})},startFilling:function(){n({event:"onStartFilling"})},requestFillingStatus:function(t){n({event:"onRequestFillingStatus",data:t})},pluginsReady:function(){n({event:"onPluginsReady"})},requestRefreshFile:function(){n({event:"onRequestRefreshFile"})},userActionRequired:function(){n({event:"onUserActionRequired"})},saveDocument:function(t){t&&n({event:"onSaveDocument",data:t.buffer},t.buffer)},submitForm:function(){n({event:"onSubmit"})},on:function(i,n){e.on(i,(function(e,i){n.call(t,i)}))}}},define("gateway",["jquery"],(function(){})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("../vendor/es6-promise/es6-promise.auto.min",e):t.ES6Promise=e()}(this,(function(){"use strict";function t(t){return"function"==typeof t}function e(){var t=setTimeout;return function(){return t(i,1)}}function i(){for(var t=0;t<b;t+=2){(0,S[t])(S[t+1]),S[t]=void 0,S[t+1]=void 0}b=0}function n(t,e){var i=this,n=new this.constructor(s);void 0===n[T]&&p(n);var o=i._state;if(o){var a=arguments[o-1];w((function(){return m(o,n,a,i._result)}))}else d(i,n,t,e);return n}function o(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(s);return r(e,t),e}function s(){}function a(e,i,s){i.constructor===e.constructor&&s===n&&i.constructor.resolve===o?function(t,e){e._state===A?c(t,e._result):e._state===U?h(t,e._result):d(e,void 0,(function(e){return r(t,e)}),(function(e){return h(t,e)}))}(e,i):void 0===s?c(e,i):t(s)?function(t,e,i){w((function(t){var n=!1,o=function(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}(i,e,(function(i){n||(n=!0,e!==i?r(t,i):c(t,i))}),(function(e){n||(n=!0,h(t,e))}),t._label);!n&&o&&(n=!0,h(t,o))}),t)}(e,i,s):c(e,i)}function r(t,e){if(t===e)h(t,new TypeError("You cannot resolve a promise with itself"));else if(function(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}(e)){var i=void 0;try{i=e.then}catch(e){return void h(t,e)}a(t,e,i)}else c(t,e)}function l(t){t._onerror&&t._onerror(t._result),u(t)}function c(t,e){t._state===M&&(t._result=e,t._state=A,0!==t._subscribers.length&&w(u,t))}function h(t,e){t._state===M&&(t._state=U,t._result=e,w(l,t))}function d(t,e,i,n){var o=t._subscribers,s=o.length;t._onerror=null,o[s]=e,o[s+A]=i,o[s+U]=n,0===s&&t._state&&w(u,t)}function u(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n=void 0,o=void 0,s=t._result,a=0;a<e.length;a+=3)n=e[a],o=e[a+i],n?m(i,n,o,s):o(s);t._subscribers.length=0}}function m(e,i,n,o){var s=t(n),a=void 0,l=void 0,d=!0;if(s){try{a=n(o)}catch(t){d=!1,l=t}if(i===a)return void h(i,new TypeError("A promises callback cannot return that same promise."))}else a=o;i._state!==M||(s&&d?r(i,a):!1===d?h(i,l):e===A?c(i,a):e===U&&h(i,a))}function p(t){t[T]=D++,t._state=void 0,t._result=void 0,t._subscribers=[]}var f;f=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var g=f,b=0,v=void 0,C=void 0,w=function(t,e){S[b]=t,S[b+1]=e,2===(b+=2)&&(C?C(i):E())},y="undefined"!=typeof window?window:void 0,x=y||{},_=x.MutationObserver||x.WebKitMutationObserver,k="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),I="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,S=new Array(1e3),E=void 0;E=k?function(){return process.nextTick(i)}:_?function(){var t=0,e=new _(i),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():I?function(){var t=new MessageChannel;return t.port1.onmessage=i,function(){return t.port2.postMessage(0)}}():void 0===y&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return void 0!==(v=t.runOnLoop||t.runOnContext)?function(){v(i)}:e()}catch(t){return e()}}():e();var T=Math.random().toString(36).substring(2),M=void 0,A=1,U=2,D=0,P=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(s),this.promise[T]||p(this.promise),g(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?c(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&c(this.promise,this._result))):h(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===M&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===o){var l=void 0,c=void 0,d=!1;try{l=t.then}catch(t){d=!0,c=t}if(l===n&&t._state!==M)this._settledAt(t._state,e,t._result);else if("function"!=typeof l)this._remaining--,this._result[e]=t;else if(i===L){var u=new i(s);d?h(u,c):a(u,t,l),this._willSettleAt(u,e)}else this._willSettleAt(new i((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===M&&(this._remaining--,t===U?h(n,i):this._result[e]=i),0===this._remaining&&c(n,this._result)},t.prototype._willSettleAt=function(t,e){var i=this;d(t,void 0,(function(t){return i._settledAt(A,e,t)}),(function(t){return i._settledAt(U,e,t)}))},t}(),L=function(){function e(t){this[T]=D++,this._result=this._state=void 0,this._subscribers=[],s!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){r(t,e)}),(function(e){h(t,e)}))}catch(e){h(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var i=this,n=i.constructor;return t(e)?i.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):i.then(e,e)},e}();return L.prototype.then=n,L.all=function(t){return new P(this,t).promise},L.race=function(t){var e=this;return new e(g(t)?function(i,n){for(var o=t.length,s=0;s<o;s++)e.resolve(t[s]).then(i,n)}:function(t,e){return e(new TypeError("You must pass an array to race."))})},L.resolve=o,L.reject=function(t){var e=new this(s);return h(e,t),e},L._setScheduler=function(t){C=t},L._setAsap=function(t){w=t},L._asap=w,L.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=L},L.Promise=L,L.polyfill(),L})),void 0===Common)var Common={};if(Common.Locale=new function(){"use strict";var l10n=null,loadcallback,apply=!1,defLang="en",currentLang=defLang,_4letterLangs=["pt-pt","zh-tw","sr-cyrl"],_applyLocalization=function(t){_clearRtl();try{if(t&&(loadcallback=t),l10n){for(var e in l10n){var i=e.split(".");if(i&&i.length>2){for(var n=window,o=0;o<i.length-1;++o)void 0===n[i[o]]&&(n[i[o]]=new Object),n=n[i[o]];n&&(n[i[i.length-1]]=l10n[e])}}loadcallback&&loadcallback()}else apply=!0}catch(t){}},_get=function(prop,scope){var res="";return l10n&&scope&&scope.name&&(res=l10n[scope.name+"."+prop],!res&&scope.default&&(res=scope.default)),res||(scope?eval(scope.name).prototype[prop]:"")},_getCurrentLanguage=function(){return currentLang},_getDefaultLanguage=function(){return defLang},_getLoadedLanguage=function(){return loadedLang},_getUrlParameterByName=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},_requireLang=function(t){"string"!=typeof t&&(t=null);var e=(t||_getUrlParameterByName("lang")||defLang).toLowerCase().split(/[\-_]/);e=e[0]+(e.length>1?"-"+e[1]:"");var i=_4letterLangs.indexOf(e);e=i<0?e.split(/[\-]/)[0]:_4letterLangs[i],currentLang=e,fetch("locale/"+e+".json").then((function(t){if(!t.ok){if(i>=0)throw new Error("4letters error");if(currentLang=defLang,e!=defLang)return fetch("locale/"+defLang+".json");throw new Error("server error")}return t.json()})).then((function(t){if(t.json){if(!t.ok)throw new Error("server error");return t.json()}throw l10n=t,new Error("loaded")})).then((function(t){l10n=t||{},apply&&_applyLocalization()})).catch((function(t){return/4letters/.test(t)?setTimeout((function(){_requireLang(e.split(/[\-_]/)[0])}),0):!/loaded/.test(t)&&currentLang!=defLang&&defLang&&defLang.length<3?setTimeout((function(){_requireLang(defLang)}),0):(l10n=l10n||{},apply&&_applyLocalization(),void("loaded"==t.message||(currentLang=null,console.log("fetch error: "+t))))}))},_clearRtl=function(){!_isCurrentRtl()&&document.body.classList.contains("rtl")&&(document.body.removeAttribute("dir"),document.body.classList.remove("rtl"),document.body.classList.remove("rtl-font"),document.body.setAttribute("applang",currentLang),window.isrtl=!1)};if(window.fetch)_requireLang();else{var polyfills=["../vendor/fetch/fetch.umd"];window.Promise?require(polyfills,_requireLang):require(["../vendor/es6-promise/es6-promise.auto.min"],(function(){require(polyfills,_requireLang)}))}const _isCurrentRtl=function(){return currentLang&&/^(ar|he|ur)$/i.test(currentLang)};return{apply:_applyLocalization,get:_get,getCurrentLanguage:_getCurrentLanguage,isCurrentLanguageRtl:_isCurrentRtl,getDefaultLanguage:_getDefaultLanguage}},define("locale",(function(){})),function(t){"use strict";var e='[data-toggle="dropdown"]',i=function(e){t(e).on("click.bs.dropdown",this.toggle)};function n(e){var i=e.attr("data-target");i||(i=(i=e.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n="#"!==i?t(document).find(i):null;return n&&n.length?n:e.parent()}function o(i){i&&3===i.which||(t(".dropdown-backdrop").remove(),t(e).each((function(){var e=t(this),o=n(e),s={relatedTarget:this};o.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(o[0],i.target)||(o.trigger(i=t.Event("hide.bs.dropdown",s)),i.isDefaultPrevented()||(e.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))})))}i.VERSION="3.4.1",i.prototype.toggle=function(e){var i=t(this);if(!i.is(".disabled, :disabled")){var s=n(i),a=s.hasClass("open");if(o(),!a){var r={relatedTarget:this};if(s.trigger(e=t.Event("show.bs.dropdown",r)),e.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",r))}return!1}},i.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var o=t(this);if(i.preventDefault(),i.stopPropagation(),!o.is(".disabled, :disabled")){var s=n(o),a=s.hasClass("open");if(!a&&27!=i.which||a&&27==i.which)return 27==i.which&&s.find(e).trigger("focus"),o.trigger("click");var r=s.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var l=r.index(i.target);38==i.which&&l>0&&l--,40==i.which&&l<r.length-1&&l++,~l||(l=0),r.eq(l).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=function(e){return this.each((function(){var n=t(this),o=n.data("bs.dropdown");o||n.data("bs.dropdown",o=new i(this)),"string"==typeof e&&o[e].call(n)}))},t.fn.dropdown.Constructor=i,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",o).on("click.bs.dropdown.data-api",".dropdown form",(function(t){t.stopPropagation()})).on("click.bs.dropdown.data-api",e,i.prototype.toggle).on("keydown.bs.dropdown.data-api",e,i.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",i.prototype.keydown)}(jQuery),define("common/main/lib/mods/dropdown",(function(){})),function(t){"use strict";var e=["sanitize","whiteList","sanitizeFn"],i=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],n={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},o=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,s=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function a(e,n){var a=e.nodeName.toLowerCase();if(-1!==t.inArray(a,n))return-1===t.inArray(a,i)||Boolean(e.nodeValue.match(o)||e.nodeValue.match(s));for(var r=t(n).filter((function(t,e){return e instanceof RegExp})),l=0,c=r.length;l<c;l++)if(a.match(r[l]))return!0;return!1}function r(e,i,n){if(0===e.length)return e;if(n&&"function"==typeof n)return n(e);if(!document.implementation||!document.implementation.createHTMLDocument)return e;var o=document.implementation.createHTMLDocument("sanitization");o.body.innerHTML=e;for(var s=t.map(i,(function(t,e){return e})),r=t(o.body).find("*"),l=0,c=r.length;l<c;l++){var h=r[l],d=h.nodeName.toLowerCase();if(-1!==t.inArray(d,s))for(var u=t.map(h.attributes,(function(t){return t})),m=[].concat(i["*"]||[],i[d]||[]),p=0,f=u.length;p<f;p++)a(u[p],m)||h.removeAttribute(u[p].nodeName);else h.parentNode.removeChild(h)}return o.body.innerHTML}var l=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};l.VERSION="3.4.1",l.TRANSITION_DURATION=150,l.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:n},l.prototype.init=function(e,i,n){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(document).find(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),s=o.length;s--;){var a=o[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},l.prototype.getDefaults=function(){return l.DEFAULTS},l.prototype.getOptions=function(i){var n=this.$element.data();for(var o in n)n.hasOwnProperty(o)&&-1!==t.inArray(o,e)&&delete n[o];return(i=t.extend({},this.getDefaults(),n,i)).delay&&"number"==typeof i.delay&&(i.delay={show:i.delay,hide:i.delay}),i.sanitize&&(i.template=r(i.template,i.whiteList,i.sanitizeFn)),i},l.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,(function(t,n){i[t]!=n&&(e[t]=n)})),e},l.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState)i.hoverState="in";else{if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout((function(){"in"==i.hoverState&&i.show()}),i.options.delay.show)}},l.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},l.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout((function(){"out"==i.hoverState&&i.hide()}),i.options.delay.hide)}},l.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var n=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,c=r.test(a);c&&(a=a.replace(r,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?o.appendTo(t(document).find(this.options.container)):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),d=o[0].offsetWidth,u=o[0].offsetHeight;if(c){var m=a,p=this.getPosition(this.$viewport);a="bottom"==a&&h.bottom+u>p.bottom?"top":"top"==a&&h.top-u<p.top?"bottom":"right"==a&&h.right+d>p.width?"left":"left"==a&&h.left-d<p.left?"right":a,o.removeClass(m).addClass(a)}var f=this.getCalculatedOffset(a,h,d,u);this.applyPlacement(f,a);var g=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(l.TRANSITION_DURATION):g()}},l.prototype.applyPlacement=function(t,e){var i=this.tip(),n=i[0].offsetWidth,o=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top+=s,t.left+=a,(Common.Utils||common.utils).setOffset(i,t),i.addClass("in");var r=i[0].offsetWidth,l=i[0].offsetHeight;"top"==e&&l!=o&&(t.top=t.top+o-l);var c=this.getViewportAdjustedDelta(e,t,r,l);c.left?t.left+=c.left:t.top+=c.top;var h=/top|bottom/.test(e),d=h?2*c.left-n+r:2*c.top-o+l,u=h?"offsetWidth":"offsetHeight";(Common.Utils||common.utils).setOffset(i,t),this.replaceArrow(d,i[0][u],h)},l.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},l.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=r(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},l.prototype.hide=function(e){var i=this,n=t(this.$tip),o=t.Event("hide.bs."+this.type);function s(){"in"!=i.hoverState&&n.detach(),i.$element&&i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),e&&e()}if(this.$element.trigger(o),!o.isDefaultPrevented())return n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",s).emulateTransitionEnd(l.TRANSITION_DURATION):s(),this.hoverState=null,this},l.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},l.prototype.hasContent=function(){return this.getTitle()},l.prototype.getPosition=function(e){var i=(e=e||this.$element)[0],n="BODY"==i.tagName,o=(Common.Utils||common.utils).getBoundingClientRect(i);null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var s=window.SVGElement&&i instanceof window.SVGElement,a=n?{top:0,left:0}:s?null:(Common.Utils||common.utils).getOffset(e),r={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=n?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,r,l,a)},l.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},l.prototype.getViewportAdjustedDelta=function(t,e,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+n;r<a.top?o.top=a.top-r:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var c=e.left-s,h=e.left+s+i;c<a.left?o.left=a.left-c:h>a.right&&(o.left=a.left+a.width-h)}return o},l.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},l.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},l.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},l.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},l.prototype.enable=function(){this.enabled=!0},l.prototype.disable=function(){this.enabled=!1},l.prototype.toggleEnabled=function(){this.enabled=!this.enabled},l.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},l.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide((function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null}))},l.prototype.sanitizeHtml=function(t){return r(t,this.options.whiteList,this.options.sanitizeFn)};var c=t.fn.tooltip;t.fn.tooltip=function(e){return this.each((function(){var i=t(this),n=i.data("bs.tooltip"),o="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||i.data("bs.tooltip",n=new l(this,o)),"string"==typeof e&&n[e]())}))},t.fn.tooltip.Constructor=l,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=c,this}}(jQuery),define("common/main/lib/mods/tooltip",(function(){})),define("common/main/lib/util/LocalStorage",["gateway"],(function(){Common.localStorage=new function(){var t,e,i={};Common.Gateway.on("internalcommand",(function(t){"localstorage"==t.type&&(i=t.keys)}));var n=function(t,e,n){if(s)try{localStorage.setItem(t,e)}catch(t){}else i[t]=e},o=function(t){return s?localStorage.getItem(t):void 0===i[t]?null:i[t]};try{var s=!!window.localStorage}catch(t){s=!1}return{getId:function(){return t},setId:function(e){t=e},getItem:o,getItemAsInt:function(t,e){var i=o(t);return null!==i?parseInt(i):e||0},getBool:function(t,e){var i=o(t);return e=e||!1,null!==i?0!=parseInt(i):e},setBool:function(t,e,i){n(t,e?1:0)},setItem:n,removeItem:function(t){s?localStorage.removeItem(t):delete i[t]},setKeysFilter:function(t){e=t},getKeysFilter:function(){return e},itemExists:function(t){return null!==o(t)},sync:function(){},save:function(){}}}})),define("common/main/lib/controller/Scaling",["core"],(function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.Scaling=new function(){const t={"pixel-ratio__1":1,"pixel-ratio__1_25":1.25,"pixel-ratio__1_5":1.5,"pixel-ratio__1_75":1.75,"pixel-ratio__2":2,"pixel-ratio__2_5":2.25};let e=document.body.className;const i=function(e){const i=/(pixel-ratio__[\w-]+)/.exec(e);return i&&i[1]in t?i[1]:"pixel-ratio__1"};let n=i(e);return new MutationObserver(function(e,o){const s=i(document.body.className);s!=n&&($("[ratio]").trigger("app:scaling",{ratio:t[s]}),n=s)}.bind(this)).observe(document.body,{attributes:!0,attributeFilter:["class"]}),{currentRatio:function(){return t[n]},currentRatioSelector:function(){return n}}}})),define("common/main/lib/controller/Themes",["core"],(function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.Themes=new function(t){!t&&(t={});const e="light",i="dark",n="system";var o={"theme-system":{text:t.txtThemeSystem||"Same as system",type:n,source:"static"},"theme-light":{text:t.txtThemeLight||"Light",type:"light",source:"static",skeleton:{css:".loadmask {--sk-height-toolbar-controls: 66px; --sk-layout-padding-toolbar: 0;\n                                    --sk-shadow-toolbar: inset 0 -1px #cbcbcb; --sk-border-radius-toolbar: 0;\n                                    --sk-background-toolbar: #f7f7f7; --sk-background-toolbar-controls: #f7f7f7;\n                                    --sk-background-toolbar-header-word: #446995; --sk-background-toolbar-header-pdf: #aa5252;\n                                    --sk-background-toolbar-header-slide: #BE664F; --sk-background-toolbar-header-cell: #40865c; \n                                    --sk-background-toolbar-header-visio: #444796; \n                                    --sk-background-toolbar-tab: rgba(0,0,0,.15); --sk-background-toolbar-button: #d8dadc;\n                                    --sk-layout-padding-toolbar-controls: 0 7px; --sk-layout-padding-header: 0 8px;\n                                    --sk-canvas-background: #eee; --sk-canvas-content-background: #fff;\n                                    --sk-canvas-page-border: #dde0e5; --sk-canvas-line: rgba(0,0,0,.05);\n                                    --sk-height-formula: 24px; --sk-padding-formula: 0 0 4px 0;\n                                    --sk-border-style-formula: solid; --sk-gap-formula-field: 20px;\n                                    --sk-border-radius-formula-field: 0px;\n                                }"}},"theme-classic-light":{text:t.txtThemeClassicLight||"Classic Light",type:"light",source:"static",skeleton:{css:".loadmask {--sk-height-toolbar-controls: 66px; --sk-layout-padding-toolbar: 0;\n                                    --sk-shadow-toolbar: inset 0 -1px #cbcbcb; --sk-border-radius-toolbar: 0;\n                                    --sk-background-toolbar-header-word: #446995; --sk-background-toolbar-header-pdf: #aa5252;\n                                    --sk-background-toolbar-header-slide: #BE664F;; --sk-background-toolbar-header-cell: #40865c;\n                                    --sk-background-toolbar-header-visio: #444796; \n                                    --sk-background-toolbar: #f7f7f7; --sk-background-toolbar-controls: #f1f1f1;\n                                    --sk-background-toolbar-tab: rgba(255,255,255,.15); --sk-background-toolbar-button: #d8dadc;\n                                    --sk-layout-padding-toolbar-controls: 0 7px; --sk-layout-padding-header: 0 8px;\n                                    --sk-canvas-background: #eee; --sk-canvas-content-background: #fff;\n                                    --sk-canvas-page-border: #dde0e5; --sk-canvas-line: rgba(0,0,0,.05);\n                                    --sk-height-formula: 24px; --sk-padding-formula: 0 0 4px 0;\n                                    --sk-border-style-formula: solid; --sk-gap-formula-field: 20px;\n                                    --sk-border-radius-formula-field: 0px;\n                                }"}},"theme-dark":{text:t.txtThemeDark||"Dark",type:"dark",source:"static",skeleton:{css:".theme-dark .loadmask, .theme-type-dark .loadmask {\n                                --sk-height-toolbar-controls: 66px; --sk-layout-padding-toolbar: 0;\n                                --sk-shadow-toolbar: inset 0 -1px #616161; --sk-border-radius-toolbar: 0;\n                                --sk-background-toolbar-header-word: #2a2a2a; --sk-background-toolbar-header-pdf: #2a2a2a;\n                                --sk-background-toolbar-header-slide: #2a2a2a;--sk-background-toolbar-header-cell: #2a2a2a;\n                                --sk-background-toolbar-header-visio: #2a2a2a; \n                                --sk-background-toolbar: #404040; --sk-background-toolbar-controls: #404040;\n                                --sk-background-toolbar-tab: rgba(255,255,255,.15); --sk-background-toolbar-button: #555;\n                                --sk-layout-padding-toolbar-controls: 0 7px; --sk-layout-padding-header: 0 8px;\n                                --sk-canvas-background: #555; --sk-canvas-content-background: #fff;\n                                --sk-canvas-page-border: #555; --sk-canvas-line: rgba(0,0,0,.05);\n                                --sk-height-formula: 24px; --sk-padding-formula: 0 0 4px 0;\n                                --sk-border-style-formula: solid; --sk-gap-formula-field: 20px;\n                                --sk-border-radius-formula-field: 0px;\n                            }\n                            .content-theme-dark {\n                                --sk-canvas-content-background: #3a3a3a; --sk-canvas-page-border: #616161;\n                                --sk-canvas-line: rgba(255,255,255,.05);\n                            }"}},"theme-contrast-dark":{text:t.txtThemeContrastDark||"Dark Contrast",type:"dark",source:"static",skeleton:{css:".theme-dark .loadmask, .theme-type-dark .loadmask {\n                                --sk-height-toolbar-controls: 66px; --sk-layout-padding-toolbar: 0;\n                                --sk-shadow-toolbar: inset 0 -1px #616161; --sk-border-radius-toolbar: 0;\n                                --sk-background-toolbar-header-word: #2a2a2a; --sk-background-toolbar-header-pdf: #2a2a2a;\n                                --sk-background-toolbar-header-slide: #2a2a2a;--sk-background-toolbar-header-cell: #2a2a2a;\n                                --sk-background-toolbar-header-visio: #2a2a2a; \n                                --sk-background-toolbar: #404040; --sk-background-toolbar-controls: #404040;\n                                --sk-background-toolbar-tab: rgba(255,255,255,.15); --sk-background-toolbar-button: #555;\n                                --sk-layout-padding-toolbar-controls: 0 7px; --sk-layout-padding-header: 0 8px;\n                                --sk-canvas-background: #555; --sk-canvas-content-background: #fff;\n                                --sk-canvas-page-border: #555; --sk-canvas-line: rgba(0,0,0,.05);\n                                --sk-height-formula: 24px; --sk-padding-formula: 0 0 4px 0;\n                                --sk-border-style-formula: solid; --sk-gap-formula-field: 20px;\n                                --sk-border-radius-formula-field: 0px;\n                            }\n                            .content-theme-dark {\n                                --sk-canvas-content-background: #3a3a3a;\n                                --sk-canvas-page-border: #616161; --sk-canvas-line: rgba(255,255,255,.05);\n                            }"}},"theme-gray":{text:t.txtThemeGray||"Gray",type:"light",source:"static",skeleton:{css:".loadmask {--sk-height-toolbar-controls: 66px;--sk-layout-padding-toolbar: 0;\n                                    --sk-shadow-toolbar: inset 0 -1px #cbcbcb; --sk-border-radius-toolbar: 0;\n                                    --sk-background-toolbar-header-word: #f7f7f7; --sk-background-toolbar-header-pdf: #f7f7f7;\n                                    --sk-background-toolbar-header-slide: #f7f7f7;--sk-background-toolbar-header-cell: #f7f7f7;\n                                    --sk-background-toolbar-header-visio: #f7f7f7; \n                                    --sk-background-toolbar: #f7f7f7; --sk-background-toolbar-controls: #f1f1f1;\n                                    --sk-background-toolbar-tab: #e0e0e0; --sk-background-toolbar-button: #e0e0e0;\n                                    --sk-layout-padding-toolbar-controls: 0 7px; --sk-layout-padding-header: 0 8px;\n                                    --sk-canvas-background: #eee; --sk-canvas-content-background: #fff;\n                                    --sk-canvas-page-border: #ccc; --sk-canvas-line: rgba(0,0,0,.05);\n                                    --sk-height-formula: 24px; --sk-padding-formula: 0 0 4px 0;\n                                    --sk-border-style-formula: solid; --sk-gap-formula-field: 20px;\n                                    --sk-border-radius-formula-field: 0px;\n                                }"}},"theme-white":{text:t.txtThemeModernLight||"White",type:"light",source:"static",icons:{cls:"mod2"}},"theme-night":{text:t.txtThemeModernDark||"Night",type:"dark",source:"static",icons:{cls:"mod2"}}},s=["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","toolbar-header-pdf","toolbar-header-visio","text-toolbar-header-on-background-document","text-toolbar-header-on-background-spreadsheet","text-toolbar-header-on-background-presentation","text-toolbar-header-on-background-pdf","text-toolbar-header-on-background-visio","background-normal","background-toolbar","background-toolbar-additional","background-primary-dialog-button","background-notification-popover","background-notification-badge","background-scrim","background-loader","background-accent-button","background-contrast-popover","shadow-contrast-popover","highlight-button-hover","highlight-button-pressed","highlight-button-pressed-hover","highlight-primary-dialog-button-hover","highlight-header-button-hover","highlight-header-button-pressed","highlight-text-select","highlight-accent-button-hover","highlight-accent-button-pressed","highlight-toolbar-tab-underline-document","highlight-toolbar-tab-underline-spreadsheet","highlight-toolbar-tab-underline-presentation","highlight-toolbar-tab-underline-pdf","highlight-toolbar-tab-underline-visio","highlight-header-tab-underline-document","highlight-header-tab-underline-spreadsheet","highlight-header-tab-underline-presentation","highlight-header-tab-underline-pdf","highlight-header-tab-underline-visio","border-toolbar","border-divider","border-regular-control","border-toolbar-button-hover","border-preview-hover","border-preview-select","border-control-focus","border-color-shading","border-error","border-contrast-popover","text-normal","text-normal-pressed","text-secondary","text-tertiary","text-link","text-link-hover","text-link-active","text-link-visited","text-inverse","text-toolbar-header","text-contrast-background","text-alt-key-hint","icon-normal","icon-normal-pressed","icon-inverse","icon-toolbar-header","icon-notification-badge","icon-contrast-popover","icon-success","canvas-background","canvas-content-background","canvas-page-border","canvas-ruler-background","canvas-ruler-border","canvas-ruler-margins-background","canvas-ruler-mark","canvas-ruler-handle-border","canvas-ruler-handle-border-disabled","canvas-high-contrast","canvas-high-contrast-disabled","canvas-cell-border","canvas-cell-title-background","canvas-cell-title-background-hover","canvas-cell-title-background-selected","canvas-cell-title-border","canvas-cell-title-border-hover","canvas-cell-title-border-selected","canvas-cell-title-text","canvas-dark-cell-title","canvas-dark-cell-title-hover","canvas-dark-cell-title-selected","canvas-dark-cell-title-border","canvas-dark-cell-title-border-hover","canvas-dark-cell-title-border-selected","canvas-dark-content-background","canvas-dark-page-border","canvas-scroll-thumb","canvas-scroll-thumb-hover","canvas-scroll-thumb-pressed","canvas-scroll-thumb-border","canvas-scroll-thumb-border-hover","canvas-scroll-thumb-border-pressed","canvas-scroll-arrow","canvas-scroll-arrow-hover","canvas-scroll-arrow-pressed","canvas-scroll-thumb-target","canvas-scroll-thumb-target-hover","canvas-scroll-thumb-target-pressed","canvas-sheet-view-cell-background","canvas-sheet-view-cell-background-hover","canvas-sheet-view-cell-background-pressed","canvas-sheet-view-cell-title-label","canvas-freeze-line-1px","canvas-freeze-line-2px","canvas-select-all-icon","canvas-anim-pane-background","canvas-anim-pane-item-fill-selected","canvas-anim-pane-item-fill-hovered","canvas-anim-pane-button-fill","canvas-anim-pane-button-fill-hovered","canvas-anim-pane-button-fill-disabled","canvas-anim-pane-play-button-fill","canvas-anim-pane-play-button-outline","canvas-anim-pane-effect-bar-entrance-fill","canvas-anim-pane-effect-bar-entrance-outline","canvas-anim-pane-effect-bar-emphasis-fill","canvas-anim-pane-effect-bar-emphasis-outline","canvas-anim-pane-effect-bar-exit-fill","canvas-anim-pane-effect-bar-exit-outline","canvas-anim-pane-effect-bar-path-fill","canvas-anim-pane-effect-bar-path-outline","canvas-anim-pane-timeline-ruler-outline","canvas-anim-pane-timeline-ruler-tick","canvas-anim-pane-timeline-scroller-fill","canvas-anim-pane-timeline-scroller-outline","canvas-anim-pane-timeline-scroller-opacity","canvas-anim-pane-timeline-scroller-opacity-hovered","canvas-anim-pane-timeline-scroller-opacity-active","toolbar-height-controls","sprite-button-icons-uid"],a={},r=function(t){const e=t||s;var i={};if(!Common.Utils.isIE10&&!Common.Utils.isIE11){var n=getComputedStyle(document.body);e.forEach((function(t,e){i[t]=n.getPropertyValue("--"+t).trim()}))}return i};var l=function(t){var e,i=Common.Locale.getCurrentLanguage();t.themes&&t.themes instanceof Array?t.themes.forEach((function(t){t.id?(e=t.l10n&&t.l10n[i]?t.l10n[i]:t.name,o[t.id]={text:e,type:t.type,src:t}):"string"==typeof t&&h(t)})):t.id&&(e=t.l10n&&t.l10n[i]?t.l10n[i]:t.name,o[t.id]={text:e,type:t.type,src:t}),Common.NotificationCenter.trigger("uitheme:countchanged")};const c=function(){let t=window.uitheme.id;if(o[t]){if("static"!=o[t].source){const e=document.body.className.match("theme-type-"+o[t].type);e?e.length&&(document.body.className=document.body.className.replace(/theme-type-(?:dark|ligth)/i,"theme-type-"+o[t].type)):document.body.classList.add("theme-type-"+o[t].type)}}else t=p().id,document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(t,"theme-type-"+o[t].type);const e=Common.localStorage.getItem("ui-theme");if(!e||u(e)!==t){var i={id:t,type:o[t].type,text:o[t].text,colors:r()};o[t].icons&&(i.icons=o[t].icons),Common.localStorage.setItem("ui-theme",JSON.stringify(i))}};var h=function(t){Common.Utils.loadConfig(t,(function(t){"error"!=t?(l(t),c()):console.warn("failed to load/parse themes.json")}))},d=function(t){Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.localThemes()&&(l({themes:Common.Controllers.Desktop.localThemes()}),c()):h.call(this,"../../../../themes.json")},u=function(t){return"string"==typeof t&&t.startsWith("{")&&t.endsWith("}")&&(t=JSON.parse(t)),t&&"object"==typeof t?t.id:t},m=function(t){};const p=function(){const t=(Common.Controllers.Desktop&&Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.systemThemeType():window.matchMedia("(prefers-color-scheme: dark)").matches?i:e)==i?window.uitheme.DEFAULT_DARK_THEME_ID:window.uitheme.DEFAULT_LIGHT_THEME_ID;return{id:t,info:o[t]}},f=function(t){window.uitheme.is_theme_system()&&b.call(this,!0)},g=function(t){window.uitheme.set_id(t);const e=window.uitheme.relevant_theme_id();if(o[e].src){let t=o[e];!function(t,e){if(e){var i=document.createElement("style");i.id=t,i.type="text/css",i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i)}}(t.src.id,function(t,e){if(e&&t){var i=[":root .",t,"{"];for(var n in e)"highlight-toolbar-tab-underline"===n?(i.push("--",n+"-document",":",e[n],";"),i.push("--",n+"-spreadsheet",":",e[n],";"),i.push("--",n+"-presentation",":",e[n],";"),i.push("--",n+"-pdf",":",e[n],";"),i.push("--",n+"-visio",":",e[n],";"),console.log("Obsolete: The 'highlight-toolbar-tab-underline' color for interface themes is deprecated. Please use 'highlight-toolbar-tab-underline-document', 'highlight-toolbar-tab-underline-presentation', etc. instead.")):i.push("--",n,":",e[n],";");return i.push("}"),i.join("")}}(t.src.id,t.src.colors)),(t=>{t.src&&t.src.icons&&(!t.icons&&(t.icons={}),t.src.icons["sprite-buttons-base-url"]&&(t.icons.basepath=t.src.icons["sprite-buttons-base-url"]),t.src.icons["style-class-selector"]&&(t.icons.src=t.src.icons["style-class-selector"]))})(t),delete t.src}document.body.className=document.body.className.replace(/theme-[\w-]+\s?/gi,"").trim(),document.body.classList.add(e,"theme-type-"+o[e].type);let i=getComputedStyle(document.body).getPropertyValue("--sprite-button-icons-base-url");o[e].icons&&(o[e].icons.basepath?i=o[e].icons.basepath:i&&(o[e].icons.basepath=i),o[e].icons.cls&&document.body.classList.add("theme-icons-cls-"+o[e].icons.cls)),i&&window.uitheme.apply_icons_from_url(e,i),this.api.asc_setContentDarkMode&&("dark"==o[e].type?(this.api.asc_setContentDarkMode(this.isContentThemeDark()),Common.NotificationCenter.trigger("contenttheme:dark",this.isContentThemeDark())):this.api.asc_setContentDarkMode(!1));const n=r();if(n.type=o[e].type,n.name=e,this.api.asc_setSkin(n),!Common.Utils.isIE10&&!Common.Utils.isIE11){const e=Object.assign({id:t,colors:n},o[t]);delete e.source,Common.localStorage.setItem("ui-theme",JSON.stringify(e))}a={}},b=function(t,e){if(t||Common.localStorage.getItem("ui-theme-id")!=window.uitheme.id){const t=Common.localStorage.getItem("ui-theme-id");t&&(g.call(this,t),Common.NotificationCenter.trigger("uitheme:changed",t,e))}};return{init:function(t){["toolbar-header-document","toolbar-header-spreadsheet","toolbar-header-presentation","toolbar-header-pdf","toolbar-header-visio"].forEach((function(t){document.documentElement.style.removeProperty("--"+t)})),Common.Gateway.on("opendocument",m.bind(this)),$(window).on("storage",function(t){"ui-theme-id"!=t.key||Common.Controllers.Desktop.isActive()?"content-theme"==t.key&&this.setContentTheme(t.originalEvent.newValue,!0,!1):t.originalEvent.newValue&&b.call(this)}.bind(this)),this.api=t;const i=window.uitheme.relevant_theme_id(),n=r(s);n.type=window.uitheme.type?window.uitheme.type:o[i]?o[i].type:e,n.name=i,t.asc_setSkin(n);const a=o[i]&&"dark"==o[i].type&&window.uitheme.iscontentdark;t.asc_setContentDarkMode&&t.asc_setContentDarkMode(a),document.body.classList.contains("theme-type-"+n.type)||document.body.classList.add("theme-type-"+n.type),!o[i]&&window.uitheme&&window.uitheme.id==i&&(o[i]=window.uitheme);const l=getComputedStyle(document.body);if(o[i]&&o[i].icons){if(!document.querySelector("style#"+i)){const t=o[i].icons.basepath?o[i].icons.basepath:l.getPropertyValue("--sprite-button-icons-base-url");t&&window.uitheme.apply_icons_from_url(i,t)}o[i].icons.cls&&document.body.classList.add("theme-icons-cls-"+o[i].icons.cls)}Common.Utils.isIE10||Common.Utils.isIE11||Common.Controllers.Desktop.isActive()||window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",f.bind(this)),Common.NotificationCenter.on("document:ready",d.bind(this))},available:function(){return!Common.Utils.isIE&&!this.locked},setAvailable:function(t){this.locked=!t},map:function(){if(Common.Controllers.Desktop.isActive()&&!Common.Controllers.Desktop.systemThemeSupported()){const t=Object.assign({},o);return delete t["theme-system"],t}return o},get:function(t){return o[t]},currentThemeId:function(){return o[window.uitheme.id]?window.uitheme.id:window.uitheme.DEFAULT_LIGHT_THEME_ID},currentThemeColor:function(t){return getComputedStyle(document.body).getPropertyValue(t)},defaultThemeId:function(t){return window.uitheme.DEFAULT_LIGHT_THEME_ID},defaultTheme:function(t){return o[this.defaultThemeId(t)]},isDarkTheme:function(t){return!t&&(t=this.currentThemeId()),(function(t){return o[t].type==n}(t)?p().info.type:o[t].type)==i},isContentThemeDark:function(){return window.uitheme.iscontentdark},setContentTheme:function(t,e,i){var n="dark"==t;(n!=window.uitheme.iscontentdark||e)&&(window.uitheme.iscontentdark=n,this.isDarkTheme()&&this.api.asc_setContentDarkMode(n),!1!==i&&Common.localStorage.getItem("content-theme")!=t&&Common.localStorage.setItem("content-theme",t),Common.NotificationCenter.trigger("contenttheme:dark",n))},toggleContentTheme:function(){window.uitheme.iscontentdark=!window.uitheme.iscontentdark,Common.localStorage.setItem("content-theme",window.uitheme.iscontentdark?"dark":"light"),this.isDarkTheme()&&this.api.asc_setContentDarkMode(window.uitheme.iscontentdark),Common.NotificationCenter.trigger("contenttheme:dark",window.uitheme.iscontentdark)},setTheme:function(t,e){if(!t)return;const i=u(t);o[i]&&i!=window.uitheme.id&&(g.call(this,i),Common.localStorage.setItem("ui-theme-id",i),Common.NotificationCenter.trigger("uitheme:changed",i,e))},refreshTheme:b,addTheme:function(t){l(t)},toggleTheme:function(){},getThemeColors:function(){const t=window.uitheme.relevant_theme_id(),e=r();return e.type=o[t]?o[t].type:"light",e.name=t,e},getThemeProps:function(t){if("font"===t)a[t]||(a[t]={size:document.documentElement.style.getPropertyValue("--font-size-base-app-custom")||window.getComputedStyle(document.body).getPropertyValue("--font-size-base")||"11px",name:document.documentElement.style.getPropertyValue("--font-family-base-custom")||'Arial, Helvetica, "Helvetica Neue", sans-serif'});else if("tab-style"===t)return Common.Utils.isIE||Common.Controllers.Desktop&&Common.Controllers.Desktop.isWinXp()?"fill":window.getComputedStyle(document.body).getPropertyValue("--toolbar-preferred-tab-style")||"line";return a[t]}}}(Common.UI.Themes)})),define("common/main/lib/controller/TabStyler",["core"],(function(){"use strict";!Common.UI&&(Common.UI={}),Common.UI.TabStyler=new function(){var t,e=!0,i=!0,n=function(){if(Common.localStorage.getItem("settings-tab-style")!==Common.Utils.InternalSettings.get("settings-tab-style")){const t=Common.localStorage.getItem("settings-tab-style");t&&(Common.Utils.InternalSettings.set("settings-tab-style",t),Common.NotificationCenter.trigger("tabstyle:changed",t))}},o=function(){if(Common.localStorage.getItem("settings-tab-background")!==Common.Utils.InternalSettings.get("settings-tab-background")){const t=Common.localStorage.getItem("settings-tab-background");t&&(Common.Utils.InternalSettings.set("settings-tab-background",t),Common.NotificationCenter.trigger("tabbackground:changed",t))}},s=function(i){i?(Common.localStorage.setItem("settings-tab-style",i),Common.Utils.InternalSettings.set("settings-tab-style",i)):(i=Common.UI.FeaturesManager.getInitValue("tabStyle",!0),e&&Common.localStorage.itemExists("settings-tab-style")?i=Common.localStorage.getItem("settings-tab-style"):void 0===i&&(i=t&&"object"==typeof t&&t.toolbarNoTabs?"line":Common.UI.Themes.getThemeProps("tab-style")),Common.Utils.InternalSettings.set("settings-tab-style",i||"fill")),Common.NotificationCenter.trigger("tabstyle:changed",i)},a=function(){s()};return{init:function(s){t=s,e=Common.UI.FeaturesManager.canChange("tabStyle",!0),i=!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0);var r=Common.UI.FeaturesManager.getInitValue("tabStyle",!0);e&&Common.localStorage.itemExists("settings-tab-style")?r=Common.localStorage.getItem("settings-tab-style"):void 0===r&&(r=t&&"object"==typeof t&&t.toolbarNoTabs?"line":Common.UI.Themes.getThemeProps("tab-style")),Common.Utils.InternalSettings.set("settings-tab-style",r||"fill"),r=Common.UI.FeaturesManager.getInitValue("tabBackground",!0),i&&Common.localStorage.itemExists("settings-tab-background")?r=Common.localStorage.getItem("settings-tab-background"):void 0===r&&t&&"object"==typeof t&&t.toolbarNoTabs&&(r="toolbar"),Common.Utils.InternalSettings.set("settings-tab-background",r||"header"),t&&"object"==typeof t&&t.toolbarNoTabs&&console.log("Obsolete: The 'toolbarNoTabs' parameter of the 'customization' section is deprecated. Please use 'tabStyle' and 'tabBackground' parameters in the 'customization.features' section instead."),$(window).on("storage",(function(t){"settings-tab-style"===t.key&&e?n(t.originalEvent.newValue):"settings-tab-background"===t.key&&i&&o(t.originalEvent.newValue)})),Common.NotificationCenter.on("uitheme:changed",a)},setStyle:s,setBackground:function(t){Common.localStorage.setItem("settings-tab-background",t),Common.Utils.InternalSettings.set("settings-tab-background",t),Common.NotificationCenter.trigger("tabbackground:changed",t)},refreshStyle:n,refreshBackground:o}}})),define("common/main/lib/controller/Desktop",["core"],(function(){"use strict";var t=window.DE||window.PE||window.SSE||window.PDFE||window.VE,e=Object.assign({version:"9.0.57.1",eventloading:!0,titlebuttons:!0,uithemes:!0,btnhome:!0,quickprint:!0,framesize:{width:window.innerWidth,height:window.innerHeight}},t.features),i=window.desktop||window.AscDesktopEditor;i&&i.execCommand("webapps:features",JSON.stringify(e));!Common.Controllers&&(Common.Controllers={}),Common.Controllers.Desktop=new function(){var n,o={version:"9.0.57.1"},s={"btn-save":"save","btn-save-coauth":"coauth","btn-synch":"synch"};let a=[];var r,c;if(i){if(i.features=i.features||{},r=window.RendererProcessVariable,window.on_native_message=function(e,s){if(/^style:change/.test(e)){if("toolbar"==(l=JSON.parse(s)).element)"off"==l.action&&"native-color"==l.style&&$(".toolbar").removeClass("editor-native-color");else if("body"==l.element&&"merge"==l.action){var a=document.createElement("style");a.innerHTML=l.style,document.body.appendChild(a)}}else if(/window:features/.test(e)){var l=JSON.parse(s);_.isNumber(l.skiptoparea)&&($(".asc-window.modal").length&&$(".asc-window.modal").position().top<l.skiptoparea&&$(".asc-window.modal").css("top",l.skiptoparea),Common.Utils.InternalSettings.set("window-inactive-area-top",l.skiptoparea)),void 0!==l.singlewindow&&(o.isFillFormApp?$("#title-doc-name")[l.singlewindow?"hide":"show"]():n&&n.home&&n.home.btn.setVisible(l.singlewindow),i.features.singlewindow=l.singlewindow,Common.NotificationCenter.trigger("desktop:window",{compositetitle:i.features.singlewindow}))}else if(/editor:config/.test(e)){if("request"==s){var c={user:o.user,title:{buttons:[]}};if(n){if(!$.isEmptyObject(n))if(t.getController("Viewport").getView("Common.Views.Header")){if(i.getViewportSettings){"window"==i.getViewportSettings().widgetType&&n.home&&n.home.btn.setVisible(!0)}for(var h in n)c.title.buttons.push(u(h,n[h]))}i.execCommand("editor:config",JSON.stringify(c))}else o.callback_editorconfig||(o.callback_editorconfig=function(){setTimeout((function(){window.on_native_message(e,s)}),0)})}}else if(/button:click/.test(e)){(l=JSON.parse(s)).action&&n[l.action]&&n[l.action].btn.click()}else if(/theme:changed/.test(e))Common.UI.Themes.setTheme(s,"native");else if(/^uitheme:added/.test(e)){let t;r.localthemes||(r.localthemes=[]);try{t=JSON.parse(s)}catch(t){console.warn("local theme is broken")}t&&(t instanceof Array?(r.localthemes=[].concat(r.localthemes,t),Common.UI.Themes.addTheme({themes:t})):(r.localthemes.push(t),Common.UI.Themes.addTheme(t)))}else if(/renderervars:changed/.test(e)){const t=JSON.parse(s);t.theme&&t.theme.system&&(window.RendererProcessVariable.theme.system=t.theme.system,"theme-system"==Common.UI.Themes.currentThemeId()&&Common.UI.Themes.refreshTheme(!0,"native"))}else if(/element:show/.test(e)){var d=/title:(?:(true|show)|(false|hide))/.exec(s);d&&(d[1]?$("#app-title").show():d[2]&&$("#app-title").hide())}else if(/althints:show/.test(e))/false|hide/.test(s)&&Common.NotificationCenter&&Common.NotificationCenter.trigger("hints:clear");else if(/file:print/.test(e))t.getController("Main").onPrint();else if(/printer:config/.test(e)){var m,p=null,f=[];try{m=JSON.parse(s)}catch(t){console.warn("printers info is broken")}m&&(m.printers&&(f=m.printers),m.current_printer&&(p=m.current_printer));const e=t.getController("Print");e&&e.setPrinterInfo(p,f)}else/file:saveas/.test(e)?t.getController("Main").api.asc_DownloadAs():/file:save/.test(e)&&t.getController("Main").api.asc_Save()},window.on_native_message("editor:config","request"),window.native_message_cmd)for(var h in window.native_message_cmd)"uitheme:changed"!=h&&window.on_native_message(h,window.native_message_cmd[h]);i.execCommand("webapps:features",JSON.stringify(e)),window.onupdaterecents=function(t){a=k(t),Common.NotificationCenter.trigger("update:recents",a)};var d=document.createElement("style");d.appendChild(document.createTextNode(".modals-mask{opacity:0 !important;}")),document.getElementsByTagName("head")[0].appendChild(d)}var u=function(t,e){return{action:t,icon:e.icon||void 0,hint:e.btn.options.hint,disabled:e.btn.isDisabled(),visible:e.btn.isVisible()}},m=function(t,e,n){var o={};o[t]=n,i.execCommand("title:button",JSON.stringify({disabled:o}))},p=function(t,e){i.execCommand("title:button",JSON.stringify({"icon:changed":{save:s[e.next]}}))},f=function(t){if("open"==t)i.execCommand("title:button",JSON.stringify({disabled:{all:!0}}));else{var e={};for(var o in n)e[o]=n[o].btn.isDisabled();i.execCommand("title:button",JSON.stringify({disabled:e}))}},g=function(t,e){let o={visible:t&&!(e>0)};n&&(o.hints={},n.print&&(o.hints.print=n.print.btn.btnEl.attr("data-hint-title-lang")),n.quickprint&&(o.hints.quickprint=n.quickprint.btn.btnEl.attr("data-hint-title-lang")),n.undo&&(o.hints.undo=n.undo.btn.btnEl.attr("data-hint-title-lang")),n.redo&&(o.hints.redo=n.redo.btn.btnEl.attr("data-hint-title-lang")),n.save&&(o.hints.save=n.save.btn.btnEl.attr("data-hint-title-lang")),n.startover&&(o.hints.startover=n.startover.btn.btnEl.attr("data-hint-title-lang"))),i.execCommand("althints:show",JSON.stringify(o))},b=function(t){Common.UI.HintManager&&Common.UI.HintManager.isHintVisible()?(i.execCommand("althints:keydown",JSON.stringify({code:t.keyCode})),console.log("hint keydown",t.keyCode)):78==t.keyCode&&o.canCreateNew&&!t.shiftKey&&(Common.Utils.isWindows&&t.ctrlKey&&!t.metaKey||Common.Utils.isMac&&t.metaKey&&!t.ctrlKey)&&this.process("create:new")};const v=function(t){if(n.quickprint){const t=window.SSE?"sse-settings-quick-print-button":window.PE?"pe-settings-quick-print-button":window.PDFE?"pdfe-settings-quick-print-button":window.VE?"ve-settings-quick-print-button":"de-settings-quick-print-button",e=Common.localStorage.getBool(t,!1);if(n.quickprint.visible!=e){n.quickprint.visible=e;const t={visible:{quickprint:e}};i.execCommand("title:button",JSON.stringify(t))}}},C=function(){const t=this,e=function(t,e,i){return(/\/$/.test(t)?t:t+"/")+e+i};fetch(e("resources/help/",Common.Locale.getDefaultLanguage(),"/Contents.json")).then((function(t){t.ok&&fetch(e("resources/help/",Common.Locale.getCurrentLanguage(),"/Contents.json")).then((function(t){t.ok&&(c=e("resources/help/",Common.Locale.getCurrentLanguage(),""))})).catch((function(t){c=e("resources/help/",Common.Locale.getDefaultLanguage(),"")}))})).catch((function(i){t.helpUrl()&&fetch(e(t.helpUrl(),Common.Locale.getDefaultLanguage(),"/Contents.json")).then((function(t){return t.json()})).then((function(i){fetch(e(t.helpUrl(),Common.Locale.getCurrentLanguage(),"/Contents.json")).then((function(t){return t.json()})).then((function(i){c=e(t.helpUrl(),Common.Locale.getCurrentLanguage(),"")})).catch((function(i){c=e(t.helpUrl(),Common.Locale.getDefaultLanguage(),"")}))})).catch((function(t){}))}))},w=function(t){_.extend(o,t),i&&i.execCommand("doc:onready",""),i&&i.LocalFileRecents(),$(".toolbar").addClass("editor-native-color")},y=function(){if(o.isEdit){const o=t.getController("Viewport").getView("Common.Views.Header"),s=t.getController("Main").api,a=s.asc_getLocalRestrictions?s.asc_getLocalRestrictions():Asc.c_oAscLocalRestrictionType.None;Asc.c_oAscLocalRestrictionType.None!==a&&(e.readonly=!0,o.setDocumentReadOnly(!0),s.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None),new Common.UI.SynchronizeTip({extCls:"no-arrow",placement:"bottom",target:$(".toolbar"),text:(n=a,n===Asc.c_oAscLocalRestrictionType.ReadOnly?Common.Locale.get("tipFileReadOnly",{name:"Common.Translation",default:"Document is read only. You can make changes and save its local copy later."}):Common.Locale.get("tipFileLocked",{name:"Common.Translation",default:"Document is locked for editing. You can make changes and save its local copy later."})),showLink:!1}).on("closeclick",(function(){this.close()})).show(),i.execCommand("webapps:features",JSON.stringify(e)),s.asc_registerCallback("asc_onDocumentName",(function(){e.readonly&&s.asc_getLocalRestrictions()==Asc.c_oAscLocalRestrictionType.None&&(e.readonly=!1,o.setDocumentReadOnly(!1),i.execCommand("webapps:features",JSON.stringify(e)))})))}var n},x=function(a){if(e.viewmode=window.PDFE?!!a.isXpsViewer:!a.isEdit,e.viewmode&&(e.btnhome=!1),e.crypted=a.isCrypted,i.execCommand("webapps:features",JSON.stringify(e)),n={},!e.viewmode){var r=t.getController("Viewport").getView("Common.Views.Header");{let t;i.getViewportSettings&&(t=i.getViewportSettings()),r.btnHome=new Common.UI.Button({cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-home",visible:t&&"window"==t.widgetType,hint:Common.Locale.get("hintBtnHome",{name:"Common.Controllers.Desktop",default:"Show Main window"}),dataHint:"0",dataHintDirection:"right",dataHintOffset:"10, -18",dataHintTitle:"K"}).render($("#box-document-title #slot-btn-dt-home")),n.home={btn:r.btnHome},r.btnHome.on("click",(function(t){i.execCommand("title:button",JSON.stringify({click:"home"}))})),$("#id-box-doc-name").on({dblclick:function(t){i.execCommand("title:dblclick",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousedown:function(t){i.execCommand("title:mousedown",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mousemove:function(t){i.execCommand("title:mousemove",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))},mouseup:function(t){i.execCommand("title:mouseup",JSON.stringify({x:t.originalEvent.screenX,y:t.originalEvent.screenY}))}})}if(r.btnSave){n.save={btn:r.btnSave};var l=/\s?([^\s]+)$/.exec(n.save.btn.$icon.attr("class"));l&&l.length&&(n.save.icon=s[l])}for(var c in r.btnPrint&&(n.print={btn:r.btnPrint}),r.btnPrintQuick&&(n.quickprint={btn:r.btnPrintQuick,visible:r.btnPrintQuick.isVisible()}),r.btnUndo&&(n.undo={btn:r.btnUndo}),r.btnRedo&&(n.redo={btn:r.btnRedo}),r.btnStartOver&&(n.startover={btn:r.btnStartOver}),r.btnQuickAccess&&(n.quickaccess={btn:r.btnQuickAccess}),n)n[c].btn.options.signals=["disabled"],n[c].btn.on("disabled",m.bind(this,c));n.save&&(n.save.btn.options.signals.push("icon:changed"),n.save.btn.on("icon:changed",p.bind(this)))}o.callback_editorconfig&&(o.callback_editorconfig(),delete o.callback_editorconfig),void 0!==i.features.singlewindow&&(o.isFillFormApp&&$("#title-doc-name")[i.features.singlewindow?"hide":"show"](),n.home&&n.home.btn.setVisible(i.features.singlewindow))},k=function(t){let e=[];const i=/Win/.test(navigator.platform)?/([^\\/]+\.[a-zA-Z0-9]{1,})$/:/([^/]+\.[a-zA-Z0-9]{1,})$/;for(let n in t){const o=t[n];if(l.matchFileFormat(o.type)&&i.test(o.path)){const t=i.exec(o.path)[1],n=o.path.slice(0,o.path.length-t.length-1);e.push({fileid:o.id,type:o.type,format:l.parseFileFormat(o.type),title:t,url:o.path,folder:n})}}return e},I=function(t,e,i){console.log("open recent")},S=function(t){i.execCommand("quickaccess:changed",JSON.stringify(t))},E=function(e){console.log("extend menu file");{const e=t.getController("LeftMenu").leftMenu.getMenu("file"),i=t.getController("Main").appOptions.canCreateNew;if(e.miNew.visible&&i){const t=new Common.UI.MenuItem({el:$('<li id="fm-btn-create-fromtpl" class="fm-btn"></li>'),action:"create:fromtemplate",caption:T("itemCreateFromTemplate","Create from template"),canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]});t.$el.insertAfter(e.miNew.$el),e.items.push(t)}}},T=function(t,e){return Common.Locale.get(t,{name:"Common.Controllers.Desktop",default:e})};return{init:function(n){if(_.extend(o,n),o.isDesktopApp){let n=r&&"winxp"===r.os;Common.UI.Themes.setAvailable(!n),Common.NotificationCenter.on({"app:ready":w,"document:ready":y.bind(this),"app:face":x.bind(this),"modal:show":f.bind(this,"open"),"modal:close":f.bind(this,"close"),"modal:hide":f.bind(this,"hide"),"uitheme:changed":function(t,e){if("native"!=e)if(window.uitheme.is_theme_system())i.execCommand("uitheme:changed",JSON.stringify({name:"theme-system"}));else{var n=Common.UI.Themes.get(t);n&&i.execCommand("uitheme:changed",JSON.stringify({name:t,type:n.type}))}},"hints:show":g.bind(this),"quickaccess:changed":S.bind(this)}),t.addListeners({FileMenu:{"item:click":function(t,e,n){"file:exit"==e?(i.execCommand("editor:event",JSON.stringify({action:"file:close"})),t.hide()):"file:open"==e?(i.execCommand("editor:event",JSON.stringify({action:"file:open"})),t.hide()):"create:fromtemplate"==e&&(i.execCommand("create:new","template:"+(window.SSE?"cell":window.PE?"slide":window.VE?"visio":window.PDFE||window.PDFE||o.isPDFForm?"form":"word")),t.hide())},"settings:apply":v.bind(this),"recent:open":I.bind(this),"render:after":E}},{id:"desktop"}),$(document).on("keydown",b.bind(this)),"fillform"==e.uitype&&(o.isFillFormApp=!0,$("#header-logo, .brand-logo").hide()),C.call(this)}},process:function(t){if(o.isDesktopApp&&i){if("goback"==t)return i.execCommand("go:folder",o.isOffline?"offline":o.customization.goback.url),!0;if("preloader:hide"==t)return i.execCommand("editor:onready",""),!0;if("create:new"==t&&"desktop://create.new"==o.createUrl)return i.execCommand("create:new",window.SSE?"cell":window.PE?"slide":window.VE?"visio":window.PDFE||o.isPDFForm?"form":"word"),!0}return!1},requestClose:function(){o.isDesktopApp&&i&&i.execCommand("editor:event",JSON.stringify({action:"file:close",url:o.customization.goback.url}))},removeRecent:function(){o.isDesktopApp&&i&&i.execCommand("recent:forget")},isActive:function(){return!!i},isOffline:function(){return o.isFillFormApp?t.getController("ApplicationController").appOptions.isOffline:t.getController("Main").appOptions.isOffline},isFeatureAvailable:function(t){return!!i&&!!i[t]},isWinXp:function(){return r&&"winxp"===r.os},call:function(t){if(i[t]){let e=[].slice.call(arguments,1);return i[t].apply(this,e)}},helpUrl:function(){if(c)return c;if(r&&r.helpUrl){var t=window.SSE?"spreadsheeteditor":window.PE?"presentationeditor":window.PDFE?"pdfeditor":window.VE?"visioeditor":"documenteditor";return r.helpUrl+"/"+t+"/main/resources/help"}},isHelpAvailable:function(){return!!c},getDefaultPrinterName:function(){return r?r.defaultPrinterName:""},systemThemeType:function(){return r.theme&&r.theme.system?r.theme.system:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},systemThemeSupported:function(){return r.theme&&"disabled"!==r.theme.system},localThemes:function(){return r?r.localthemes:void 0},recentFiles:function(){return a},openRecent:function(t){if(this.isActive()){const e={name:Common.Utils.String.htmlDecode(t.get("title")),path:Common.Utils.String.htmlDecode(t.get("url"))};return null!=t.get("fileid")&&null!=t.get("fileid")?(e.id=t.get("fileid"),e.type=t.type):e.id=-1,i.execCommand("open:recent",JSON.stringify(e)),!0}return!1},uiRtlSupported:function(){return r&&null!=r.rtl},systemLangs:function(){return r&&r.keyboard?r.keyboard.langs:void 0}}};const n=64,o=128,s=256,a=512,r=16384,l={defines:{}};l.defines.FileFormat={FILE_UNKNOWN:0,FILE_DOCUMENT:n,FILE_DOCUMENT_DOCX:65,FILE_DOCUMENT_DOC:66,FILE_DOCUMENT_ODT:67,FILE_DOCUMENT_RTF:68,FILE_DOCUMENT_TXT:69,FILE_DOCUMENT_HTML:70,FILE_DOCUMENT_MHT:71,FILE_DOCUMENT_EPUB:72,FILE_DOCUMENT_FB2:73,FILE_DOCUMENT_MOBI:74,FILE_DOCUMENT_DOCM:75,FILE_DOCUMENT_DOTX:76,FILE_DOCUMENT_DOTM:77,FILE_DOCUMENT_ODT_FLAT:78,FILE_DOCUMENT_OTT:79,FILE_DOCUMENT_DOC_FLAT:80,FILE_DOCUMENT_OFORM:85,FILE_DOCUMENT_DOCXF:86,FILE_DOCUMENT_OFORM_PDF:87,FILE_DOCUMENT_PAGES:88,FILE_DOCUMENT_HWP:89,FILE_DOCUMENT_HWPX:96,FILE_DOCUMENT_XML:112,FILE_PRESENTATION:o,FILE_PRESENTATION_PPTX:129,FILE_PRESENTATION_PPT:130,FILE_PRESENTATION_ODP:131,FILE_PRESENTATION_PPSX:132,FILE_PRESENTATION_PPTM:133,FILE_PRESENTATION_PPSM:134,FILE_PRESENTATION_POTX:135,FILE_PRESENTATION_POTM:136,FILE_PRESENTATION_ODP_FLAT:137,FILE_PRESENTATION_OTP:138,FILE_PRESENTATION_ODG:140,FILE_PRESENTATION_KEY:141,FILE_SPREADSHEET:s,FILE_SPREADSHEET_XLSX:257,FILE_SPREADSHEET_XLS:258,FILE_SPREADSHEET_ODS:259,FILE_SPREADSHEET_CSV:260,FILE_SPREADSHEET_XLSM:261,FILE_SPREADSHEET_XLTX:262,FILE_SPREADSHEET_XLTM:263,FILE_SPREADSHEET_XLSB:264,FILE_SPREADSHEET_ODS_FLAT:265,FILE_SPREADSHEET_OTS:266,FILE_SPREADSHEET_NUMBERS:269,FILE_CROSSPLATFORM:a,FILE_CROSSPLATFORM_PDF:513,FILE_CROSSPLATFORM_SWF:514,FILE_CROSSPLATFORM_DJVU:515,FILE_CROSSPLATFORM_XPS:516,FILE_CROSSPLATFORM_PDFA:521,FILE_DRAW:r,FILE_DRAW_VSDX:16385,FILE_DRAW_VSSX:16386,FILE_DRAW_VSTX:16387,FILE_DRAW_VSDM:16388,FILE_DRAW_VSSM:16389,FILE_DRAW_VSTM:16390},l.parseFileFormat=function(t){switch(t){case l.defines.FileFormat.FILE_DOCUMENT_DOC:return"doc";case l.defines.FileFormat.FILE_DOCUMENT_DOCX:return"docx";case l.defines.FileFormat.FILE_DOCUMENT_ODT:return"odt";case l.defines.FileFormat.FILE_DOCUMENT_RTF:return"rtf";case l.defines.FileFormat.FILE_DOCUMENT_TXT:return"txt";case l.defines.FileFormat.FILE_DOCUMENT_HTML:return"html";case l.defines.FileFormat.FILE_DOCUMENT_MHT:return"mht";case l.defines.FileFormat.FILE_DOCUMENT_EPUB:return"epub";case l.defines.FileFormat.FILE_DOCUMENT_FB2:return"fb2";case l.defines.FileFormat.FILE_DOCUMENT_DOCM:return"docm";case l.defines.FileFormat.FILE_DOCUMENT_DOTX:return"dotx";case l.defines.FileFormat.FILE_DOCUMENT_OTT:return"ott";case l.defines.FileFormat.FILE_DOCUMENT_OFORM:return"oform";case l.defines.FileFormat.FILE_DOCUMENT_OFORM_PDF:return"pdf";case l.defines.FileFormat.FILE_DOCUMENT_DOCXF:return"docxf";case l.defines.FileFormat.FILE_DOCUMENT_ODT_FLAT:return"fodt";case l.defines.FileFormat.FILE_DOCUMENT_DOTM:return"dotm";case l.defines.FileFormat.FILE_DOCUMENT_XML:return"xml";case l.defines.FileFormat.FILE_DOCUMENT_PAGES:return"pages";case l.defines.FileFormat.FILE_DOCUMENT_HWP:return"hwpx";case l.defines.FileFormat.FILE_DOCUMENT_HWPX:return"hwp";case l.defines.FileFormat.FILE_SPREADSHEET_XLS:return"xls";case l.defines.FileFormat.FILE_SPREADSHEET_XLTX:return"xltx";case l.defines.FileFormat.FILE_SPREADSHEET_XLSX:return"xlsx";case l.defines.FileFormat.FILE_SPREADSHEET_XLSB:return"xlsb";case l.defines.FileFormat.FILE_SPREADSHEET_ODS:return"ods";case l.defines.FileFormat.FILE_SPREADSHEET_CSV:return"csv";case l.defines.FileFormat.FILE_SPREADSHEET_OTS:return"ots";case l.defines.FileFormat.FILE_SPREADSHEET_XLTM:return"xltm";case l.defines.FileFormat.FILE_SPREADSHEET_XLSM:return"xlsm";case l.defines.FileFormat.FILE_SPREADSHEET_ODS_FLAT:return"fods";case l.defines.FileFormat.FILE_SPREADSHEET_NUMBERS:return"numbers";case l.defines.FileFormat.FILE_PRESENTATION_PPT:return"ppt";case l.defines.FileFormat.FILE_PRESENTATION_POTX:return"potx";case l.defines.FileFormat.FILE_PRESENTATION_PPTX:return"pptx";case l.defines.FileFormat.FILE_PRESENTATION_ODP:return"odp";case l.defines.FileFormat.FILE_PRESENTATION_PPSX:return"ppsx";case l.defines.FileFormat.FILE_PRESENTATION_OTP:return"otp";case l.defines.FileFormat.FILE_PRESENTATION_PPTM:return"pptm";case l.defines.FileFormat.FILE_PRESENTATION_PPSM:return"ppsm";case l.defines.FileFormat.FILE_PRESENTATION_POTM:return"potm";case l.defines.FileFormat.FILE_PRESENTATION_ODP_FLAT:return"fodp";case l.defines.FileFormat.FILE_PRESENTATION_ODG:return"odg";case l.defines.FileFormat.FILE_PRESENTATION_KEY:return"key";case l.defines.FileFormat.FILE_CROSSPLATFORM_PDFA:case l.defines.FileFormat.FILE_CROSSPLATFORM_PDF:return"pdf";case l.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:return"djvu";case l.defines.FileFormat.FILE_CROSSPLATFORM_XPS:return"xps";case l.defines.FileFormat.FILE_DRAW_VSTX:case l.defines.FileFormat.FILE_DRAW_VSSX:case l.defines.FileFormat.FILE_DRAW_VSDM:case l.defines.FileFormat.FILE_DRAW_VSSM:case l.defines.FileFormat.FILE_DRAW_VSTM:case l.defines.FileFormat.FILE_DRAW_VSDX:return"vsdx"}return""},l.matchFileFormat=function(t){return window.PE?t>l.defines.FileFormat.FILE_PRESENTATION&&!(t>l.defines.FileFormat.FILE_SPREADSHEET):window.DE?t>l.defines.FileFormat.FILE_DOCUMENT&&!(t>l.defines.FileFormat.FILE_PRESENTATION)||t==l.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==l.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==l.defines.FileFormat.FILE_CROSSPLATFORM_DJVU:window.SSE?t>l.defines.FileFormat.FILE_SPREADSHEET&&!(t>l.defines.FileFormat.FILE_CROSSPLATFORM)||t==l.defines.FileFormat.FILE_CROSSPLATFORM_XPS:window.PDFE?t==l.defines.FileFormat.FILE_CROSSPLATFORM_PDFA||t==l.defines.FileFormat.FILE_CROSSPLATFORM_PDF||t==l.defines.FileFormat.FILE_CROSSPLATFORM_DJVU||t==l.defines.FileFormat.FILE_CROSSPLATFORM_XPS:!!window.VE&&(t==l.defines.FileFormat.FILE_DRAW_VSDX||t==l.defines.FileFormat.FILE_DRAW_VSDM||t==l.defines.FileFormat.FILE_DRAW_VSTX||t==l.defines.FileFormat.FILE_DRAW_VSTM||t==l.defines.FileFormat.FILE_DRAW_VSSX||t==l.defines.FileFormat.FILE_DRAW_VSSM)}})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Header",["backbone","core"],(function(t){"use strict";Common.Views.Header=t.View.extend(_.extend(function(){var t,e,i,n,o,s,a,r=!1,l="",c=!!window.PDFE,h=!!window.DE,d=!!window.SSE,u=!!window.PE,m=!!window.VE,p='<li id="<%= user.get("iid") %>" class="<% if (!user.get("online")) { %> offline <% } if (user.get("view")) {%> viewmode <% } %>"><div class="user-name"><div class="color"<% if (user.get("avatar")) { %>style="background-image: url(<%=user.get("avatar")%>); <% if (user.get("color")!==null) { %> border-color:<%=user.get("color")%>; border-style: solid;<% }%>"<% } else { %>style="background-color: <% if (user.get("color")!==null) { %> <%=user.get("color")%> <% } else { %> #cfcfcf <% }%>;"<% } %>><% if (!user.get("avatar")) { %><%-user.get("initials")%><% } %></div><label><%= fnEncode(user.get("username")) %></label><% if (len>1) { %><label class="margin-left-3">(<%=len%>)</label><% } %></div></li>',f=_.template("<ul><% for (originalId in users) { %><%= usertpl({user: users[originalId][0], fnEncode: fnEncode, len: users[originalId].length}) %><% } %></ul>");function g(t,s){var a=t.getVisibleEditingCount();i&&(e&&(a>1&&(e.isEdit||e.isRestrictedEdit)||a>0&&e.canLiveView)?(i.html(f({users:t.chain().filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).groupBy((function(t){return t.get("idOriginal")})).value(),usertpl:_.template(p),fnEncode:function(t){return Common.Utils.String.htmlEncode(AscCommon.UserInfoParser.getParsedName(t))}})),i.scroller=new Common.UI.Scroller({el:i.find("ul"),useKeyboard:!0,minScrollbarLength:40,alwaysVisibleY:!0}),i.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})):i.empty()),function(t,i){if(!o)return;e&&(t>1&&(e.isEdit||e.isRestrictedEdit)||t>0&&e.canLiveView)?(n.show(),o.find(".caption").html(i)):n.hide();w()}(a,t.getVisibleEditingOriginalCount())}function b(t){g(t.collection)}function v(){r=!0,this.btnShare&&this.btnShare.setVisible(!1),w()}function C(t){var e=o.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}function w(t){if(t=t||e,a&&t){var i=a.parent();if(t.twoLevelHeader){if(!t.compactHeader){s=Common.Utils.getPosition(i).left,r=i.next().outerWidth();var n=a.outerWidth(),o=a[0].style.width;(o=o?parseFloat(o):n)-n>.1?(i.css("padding-left",s<r?Math.max(2,i.outerWidth()-2-o):2),i.css("padding-right",s<r?2:Math.max(2,i.outerWidth()-2-o))):(i.css("padding-left",s<r?Math.max(2,Math.min(r-s+2,i.outerWidth()-2-o)):2),i.css("padding-right",s<r?2:Math.max(2,Math.min(s-r+2,i.outerWidth()-2-o))))}}else{var s=Common.Utils.getPosition(i).left,r=i.next().outerWidth();i.css("padding-left",s<r?Math.max(2,r-s):2),i.css("padding-right",s<r?2:Math.max(2,s-r))}if((!t.customization||!t.customization.toolbarHideFileName)&&(!t.twoLevelHeader||t.compactHeader)){var l=parseFloat(i.css("padding-left")||0)+parseFloat(i.css("padding-right")||0)+parseInt(a.css("min-width")||50);t.isCrypted&&(l+=20),i.css("flex-basis",Math.ceil(l)+"px"),i.closest(".extra.right").css("flex-basis",Math.ceil(l)+i.next().outerWidth()+"px"),Common.NotificationCenter.trigger("tab:resize")}}}function y(t){var i=this;if(t=t||e,i.btnPDFMode&&t){var n=t.isPDFEdit?"edit":t.isPDFAnnotate?"comment":"view",o=t.isPDFEdit,s=!o&&t.isPDFAnnotate;if(i.btnPDFMode.setIconCls("toolbar__icon icon--inverse "+(o?"btn-edit":s?"btn-menu-comments":"btn-sheet-view")),i.btnPDFMode.setCaption(o?i.textEdit:s?i.textComment:i.textView),i.btnPDFMode.updateHint(o?i.tipEdit:s?i.tipComment:i.tipView),i.btnPDFMode.options.value=n,i.btnPDFMode.menu&&"object"==typeof i.btnPDFMode.menu){var a=_.find(i.btnPDFMode.menu.items,(function(t){return t.value==n}));a?a.setChecked(!0):this.btnPDFMode.menu.clearAll()}}}function x(t,i){if(this.btnDocMode&&e)if(void 0===i){var n=void 0!==t;if(void 0===t)if(e.isReviewOnly)t="review";else{var o=Common.Utils.InternalSettings.get(this.appPrefix+"track-changes");t=0===o||2===o?"review":"edit"}var s="edit"===t,a="review"===t,r="view-form"===t;if(this.btnDocMode.setIconCls("toolbar__icon icon--inverse "+(s?"btn-edit":a?"btn-ic-review":"btn-sheet-view")),this.btnDocMode.setCaption(s?this.textEdit:a?this.textReview:r?this.textViewForm:this.textView),this.btnDocMode.updateHint(s?this.tipDocEdit:a?this.tipReview:r?this.tipDocViewForm:this.tipDocView),this.btnDocMode.options.value=t,n&&!this.btnDocMode.isVisible()&&this.btnDocMode.setVisible(!0),this.btnDocMode.menu&&"object"==typeof this.btnDocMode.menu){var l=_.find(this.btnDocMode.menu.items,(function(e){return e.value==t}));l?l.setChecked(!0):this.btnDocMode.menu.clearAll()}}else this.btnDocMode.menu&&this.btnDocMode.menu.items&&"edit"===this.btnDocMode.menu.items[0].value&&this.btnDocMode.menu.items[0].setDisabled(i)}function k(){e&&e.twoLevelHeader&&!e.compactHeader&&w()}function I(t){a&&(t.isCrypted&&(a.before('<div class="inner-box-icon crypted hidden"><svg class="icon"><use xlink:href="#svg-icon-crypted"></use></svg></div>'),this.imgCrypted=a.parent().find(".crypted"),this._showImgCrypted=!0),w(t))}function S(t,e){void 0!==e.save&&(this.btnSave[e.save?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-save",e.save)),void 0!==e.print&&(this.btnPrint[e.print?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-print",e.print)),void 0!==e.quickPrint&&(this.btnPrintQuick[e.quickPrint?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-quick-print",e.quickPrint)),void 0!==e.undo&&(this.btnUndo[e.undo?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-undo",e.undo)),void 0!==e.redo&&(this.btnRedo[e.redo?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-redo",e.redo)),void 0!==e.startOver&&(this.btnStartOver[e.startOver?"show":"hide"](),Common.localStorage.setBool(this.appPrefix+"quick-access-start-over",e.startOver)),Common.NotificationCenter.trigger("edit:complete"),t&&"header"==t&&Common.NotificationCenter.trigger("quickaccess:changed",e),w()}function E(s){e=s;var a=this;if(a.btnGoBack.on("click",(function(t){Common.NotificationCenter.trigger("goback")})),a.btnClose&&(a.btnClose.on("click",(function(t){Common.NotificationCenter.trigger("close")})),a.btnClose.updateHint(e.customization.close.text||a.textClose)),a.btnFavorite.on("click",(function(t){Common.NotificationCenter.trigger("markfavorite",!a.options.favorite)})),a.btnShare&&(a.btnShare.on("click",(function(t){Common.NotificationCenter.trigger("collaboration:sharing")})),a.btnShare.updateHint(a.tipAccessRights),a.btnShare.setVisible(!r&&e&&(e.sharingSettingsUrl&&e.sharingSettingsUrl.length||e.canRequestSharingSettings)),w()),a.btnStartFill&&a.btnStartFill.on("click",(function(t){Common.NotificationCenter.trigger("forms:request-fill")})),a.btnFillStatus&&(a.btnFillStatus.updateHint(a.tipFillStatus),a.btnFillStatus&&a.btnFillStatus.on("click",(function(t){Common.UI.TooltipManager.closeTip("showFillStatus"),Common.Gateway.requestFillingStatus(e.user.roles&&e.user.roles.length>0?e.user.roles[0]:void 0)}))),a.logo&&a.logo.children(0).on("click",(function(t){var e=a.branding&&a.branding.logo&&void 0!==a.branding.logo.url?a.branding.logo.url:"https://www.onlyoffice.com";if(e){var i=window.open(e);i&&i.focus()}})),n){g(t),n.on("shown.bs.dropdown",(function(){i.scroller&&i.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0})})),n.find(".cousers-menu").on("click",(function(t){return!1}));var l=t.getVisibleEditingCount();o.tooltip({title:a.tipUsers,placement:"bottom",html:!0}),o.on("click",C.bind(a)),n[e&&(l>1&&(e.isEdit||e.isRestrictedEdit)||l>0&&e.canLiveView)?"show":"hide"](),w()}if(e.user.guest&&e.canRenameAnonymous&&a.btnUserName&&a.btnUserName.on("click",(function(t){Common.NotificationCenter.trigger("user:rename")})),a.btnPrint&&(a.btnPrint.updateHint(a.tipPrint+Common.Utils.String.platformKey("Ctrl+P")),a.btnPrint.on("click",(function(t){a.fireEvent("print",a)}))),a.btnPrintQuick&&(a.btnPrintQuick.updateHint(a.tipPrintQuick),a.btnPrintQuick.on("click",(function(t){a.fireEvent("print-quick",a)}))),a.btnSave&&(a.btnSave.updateHint(e.canSaveToFile||e.isDesktopApp&&e.isOffline?a.tipSave+(c?"":Common.Utils.String.platformKey("Ctrl+S")):a.tipDownload),a.btnSave.on("click",(function(t){a.fireEvent("save",a)}))),a.btnUndo&&(a.btnUndo.updateHint(a.tipUndo+Common.Utils.String.platformKey("Ctrl+Z")),a.btnUndo.on("click",(function(t){a.fireEvent("undo",a)}))),a.btnRedo&&(a.btnRedo.updateHint(a.tipRedo+Common.Utils.String.platformKey("Ctrl+Y")),a.btnRedo.on("click",(function(t){a.fireEvent("redo",a)}))),a.btnStartOver&&(a.btnStartOver.updateHint(a.tipStartOver+Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl+Shift+enter":"Ctrl+F5")),a.btnStartOver.on("click",(function(t){a.fireEvent("startover",a)}))),a.btnQuickAccess){a.btnQuickAccess.updateHint(a.tipCustomizeQuickAccessToolbar);var h=[];a.btnSave&&Common.UI.LayoutManager.isElementVisible("header-save")&&h.push({caption:e.canSaveToFile||e.isDesktopApp&&e.isOffline?a.tipSave:a.textDownload,value:"save",checkable:!0}),a.btnPrint&&h.push({caption:a.textPrint,value:"print",checkable:!0}),a.btnPrintQuick&&h.push({caption:a.tipPrintQuick,value:"quick-print",checkable:!0}),a.btnUndo&&h.push({caption:a.tipUndo,value:"undo",checkable:!0}),a.btnRedo&&h.push({caption:a.tipRedo,value:"redo",checkable:!0}),a.btnStartOver&&h.push({caption:a.textStartOver,value:"startover",checkable:!0}),a.btnQuickAccess.setMenu(new Common.UI.Menu({cls:"ppm-toolbar",style:"min-width: 110px;",menuAlign:"tl-bl",items:h})),a.btnQuickAccess.menu.on("show:before",(function(t){t.items.forEach((function(t){"save"===t.value?t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-save",!0),!0):"print"===t.value?t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-print",!0),!0):"quick-print"===t.value?t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-quick-print",!0),!0):"undo"===t.value?t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-undo",!0),!0):"redo"===t.value&&t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-redo",!0),!0),"startover"===t.value&&t.setChecked(Common.localStorage.getBool(a.appPrefix+"quick-access-start-over",!0),!0)}))})),a.btnQuickAccess.menu.on("item:click",(function(t,e){var i={};switch(e.value){case"save":i.save=e.checked;break;case"print":i.print=e.checked;break;case"quick-print":i.quickPrint=e.checked;break;case"undo":i.undo=e.checked;break;case"redo":i.redo=e.checked;break;case"startover":i.startOver=e.checked}S.call(a,"header",i)})),Common.NotificationCenter.on("quickaccess:changed",S.bind(a,"settings"))}e.twoLevelHeader||a.btnDownload&&(a.btnDownload.updateHint(a.tipDownload),a.btnDownload.on("click",(function(t){a.fireEvent("downloadas",["original"])}))),a.btnEdit&&(a.btnEdit.updateHint(a.tipGoEdit),a.btnEdit.on("click",(function(t){a.fireEvent("go:editor",a)}))),a.btnSearch&&a.btnSearch.updateHint(a.tipSearch+Common.Utils.String.platformKey("Ctrl+F"));var d=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem" class="menu-item"><div><% if (!_.isEmpty(iconCls)) { %><span class="menu-item-icon <%= iconCls %>"></span><% } %><b><%= caption %></b></div><% if (options.description !== null) { %><label class="margin-left-10 description"><%= options.description %></label><% } %></a>');if(a.btnPDFMode){h=[];var u=a.btnPDFMode.options.value;e.canPDFEdit&&(h.push({caption:a.textComment,iconCls:"menu__icon btn-menu-comments",template:d,description:a.textAnnotateDesc,value:"comment",checkable:!0,toggleGroup:"docmode"}),h.push({caption:a.textEdit,iconCls:"menu__icon btn-edit",template:d,description:a.textEditDescNoCoedit,value:"edit",checkable:!0,toggleGroup:"docmode"})),a.btnPDFMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar select-checked-items",style:"width: 220px;",menuAlign:"tr-br",items:h})),a.btnPDFMode.menu.on("item:click",(function(t,e){Common.NotificationCenter.trigger("pdf:mode-apply",e.value)})),(m=_.find(a.btnPDFMode.menu.items,(function(t){return t.value==u})))&&m.setChecked(!0)}else if(a.btnDocMode){var m;h=[],u=a.btnDocMode.options.value;!e.isReviewOnly&&h.push({caption:a.textEdit,iconCls:"menu__icon btn-edit",template:d,description:a.textDocEditDesc,value:"edit",checkable:!0,toggleGroup:"docmode"}),e.canReview&&h.push({caption:a.textReview,iconCls:"menu__icon btn-ic-review",template:d,description:a.textReviewDesc,value:"review",checkable:!0,toggleGroup:"docmode"}),e.isPDFForm&&e.isFormCreator?h.push({caption:a.textViewForm,iconCls:"menu__icon btn-sheet-view",template:d,description:a.textDocViewFormDesc,value:"view-form",checkable:!0,toggleGroup:"docmode"}):h.push({caption:a.textView,iconCls:"menu__icon btn-sheet-view",template:d,description:a.textDocViewDesc,value:"view",checkable:!0,toggleGroup:"docmode"}),a.btnDocMode.setMenu(new Common.UI.Menu({cls:"ppm-toolbar select-checked-items",style:"width: 220px;",menuAlign:"tr-br",items:h})),a.btnDocMode.menu.on("item:click",(function(t,e){Common.NotificationCenter.trigger("doc:mode-apply",e.value,!0)})),(m=_.find(a.btnDocMode.menu.items,(function(t){return t.value==u})))&&m.setChecked(!0)}e.twoLevelHeader&&!e.compactHeader&&Common.NotificationCenter.on("window:resize",k)}function T(t){var e=this;if(e.imgCrypted&&e.imgCrypted.toggleClass("hidden",!0),e.isSaveDocName=!1,!e.withoutExt){var i=e.cutDocName(a.val());e.withoutExt=!0,_.delay((function(){e.setDocTitle(i),a.select()}),100)}}function M(t){var e=this,i=a.val();i=i.trim(),_.isEmpty(i)||e.cutDocName(e.documentCaption)===i?t&&Common.NotificationCenter.trigger("edit:complete",e):(e.isSaveDocName=!0,/[\t*\+:\"<>?|\\\\/]/gim.test(i)?_.defer((function(){Common.UI.error({msg:(new Common.Views.RenameDialog).txtInvalidName+'*+:"<>?|/',callback:function(){_.delay((function(){a.focus()}),50)}})})):e.withoutExt&&(i=e.cutDocName(i),e.fireEvent("rename",[i]),i+=e.fileExtention,e.withoutExt=!1,e.setDocTitle(i),t&&Common.NotificationCenter.trigger("edit:complete",e)))}function A(t){var e=this;t.keyCode===Common.UI.Keys.RETURN?M.call(e,!0):t.keyCode===Common.UI.Keys.ESC?(e.setDocTitle(e.cutDocName(e.documentCaption)),Common.NotificationCenter.trigger("edit:complete",this)):_.delay((function(){e.setDocTitle()}),10)}return{options:{branding:{},documentCaption:"",canBack:!1,wopi:!1},el:"#header",events:{},initialize:function(e){var i=this;this.options=this.options?_.extend(this.options,e):e,this.documentCaption=this.options.documentCaption,this.branding=this.options.customization,this.isModified=!1;var n=Common.localStorage.getKeysFilter();this.appPrefix=n&&n.length?n.split(",")[0]:"",i.btnGoBack=new Common.UI.Button({id:"btn-go-back",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-goback",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),(t=this.options.storeUsers).bind({add:b,change:b,reset:g}),i.btnSearch=new Common.UI.Button({cls:"btn-header no-caret",iconCls:"toolbar__icon icon--inverse btn-menu-search",enableToggle:!0,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),i.btnFavorite=new Common.UI.Button({id:"id-btn-favorite",cls:"btn-header",iconCls:"toolbar__icon icon--inverse btn-favorite",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),Common.NotificationCenter.on({"app:ready":function(t){Common.Utils.asyncCall(E,i,t)},"app:face":function(t){Common.Utils.asyncCall(I,i,t)},"tab:visible":function(){Common.Utils.asyncCall(w,i)},"collaboration:sharingdeny":function(t){Common.Utils.asyncCall(v,i,t)}}),Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this)),Common.NotificationCenter.on("mentions:setusers",this.avatarsUpdate.bind(this)),Common.NotificationCenter.on("tabstyle:changed",this.changeLogo.bind(this)),Common.NotificationCenter.on("tabbackground:changed",this.changeLogo.bind(this))},render:function(t,e){return $(t).html(this.getPanel(e)),this},getPanel:function(t,d){!e&&(e=d);var m=this;function p(t,e,i,n,o,s,a){return new Common.UI.Button({cls:"btn-header",iconCls:t,disabled:!0===i,lock:a,dataHint:"0",dataHintDirection:n||(d.isDesktopApp?"right":"left"),dataHintOffset:o||(d.isDesktopApp?"10, -18":"10, 10"),dataHintTitle:s}).render(e)}if(!("left"!=t||d&&d.isDesktopApp)){g=$('<section class="logo"><div id="header-logo"><i></i></div></section>'),this.logo=g.find("#header-logo");var f=this.getSuitableLogo(this.branding,d);return this.logo.toggleClass("logo-light",f.isLight),this.branding&&this.branding.logo&&this.logo&&(!1===this.branding.logo.visible?this.logo.addClass("hidden"):(this.branding.logo.image||this.branding.logo.imageDark||this.branding.logo.imageLight)&&(l=f.image,this.logo.html('<img src="'+l+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),this.logo.css({"background-image":"none",width:"auto"}),(this.branding.logo.url||void 0===this.branding.logo.url)&&this.logo.addClass("link"))),g}if("right"==t){var g=$(_.template('<section><section id="box-doc-name"><input id="rib-doc-name" autofill="off" autocomplete="off"/></input></section><section id="box-right-btn-group" style="display: inherit;"><div class="hedset"><div class="btn-slot margin-right-2" id="slot-btn-header-form-submit"></div><div class="btn-slot margin-right-2" id="slot-btn-start-fill"></div><div class="btn-slot margin-right-2 margin-left-5" id="slot-btn-fill-status"></div></div><div class="hedset"><div class="btn-slot" id="slot-hbtn-edit"></div><div class="btn-slot" id="slot-hbtn-print"></div><div class="btn-slot" id="slot-hbtn-print-quick"></div><div class="btn-slot" id="slot-hbtn-download"></div></div><div class="hedset" data-layout-name="header-editMode"><div class="btn-slot" id="slot-btn-edit-mode"></div></div><div class="hedset" data-layout-name="header-users"><section id="tlb-box-users" class="box-cousers dropdown"><div class="btn-users dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="bottom" data-hint-offset="big"><div class="inner-box-icon"><svg class=""><use xlink:href="#svg-icon-users"></use></svg></div><label class="caption"></label></div><div class="cousers-menu dropdown-menu"><label id="tlb-users-menu-descr"><%= tipUsers %></label><div class="cousers-list"></div></div></section></div><div class="hedset"><div class="btn-slot" id="slot-btn-share"></div></div><div class="hedset"><div class="btn-slot" id="slot-btn-mode"></div><div class="btn-slot" id="slot-btn-back"></div><div class="btn-slot" id="slot-btn-favorite"></div><div class="btn-slot" id="slot-btn-search"></div></div><div class="hedset"><div class="btn-slot" data-layout-name="header-user"><button type="button" class="btn btn-header slot-btn-user-name hidden"><div class="color-user-name"></div></button><div class="btn-current-user hidden"><div class="color-user-name"></div></div></div><div class="btn-slot" id="slot-btn-close"></div></div></section></section>')({tipUsers:this.labelCoUsersDescr,textShare:this.textShare}));return a?g.find("#rib-doc-name").hide():(a=g.find("#rib-doc-name"),m.documentCaption&&setTimeout((function(){m.setDocTitle(m.documentCaption)}),50)),this.setCanRename(!!this.options.canRename),!0===this.options.canBack?m.btnGoBack.render(g.find("#slot-btn-back")):g.find("#slot-btn-back").hide(),void 0!==this.options.favorite&&null!==this.options.favorite?(m.btnFavorite.render(g.find("#slot-btn-favorite")),m.btnFavorite.changeIcon(m.options.favorite?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),m.btnFavorite.updateHint(m.options.favorite?m.textRemoveFavorite:m.textAddFavorite)):g.find("#slot-btn-favorite").hide(),d.twoLevelHeader||(!d.canDownload&&!d.canDownloadOrigin||d.isOffline||(this.btnDownload=p("toolbar__icon icon--inverse btn-download",g.findById("#slot-hbtn-download"),void 0,"bottom","big")),d.canPrint&&(this.btnPrint=p("toolbar__icon icon--inverse btn-print",g.findById("#slot-hbtn-print"),void 0,"bottom","big","P")),d.canQuickPrint&&(this.btnPrintQuick=p("toolbar__icon icon--inverse btn-quick-print",g.findById("#slot-hbtn-print-quick"),void 0,"bottom","big","Q"))),d.canRequestEditRights&&(!d.twoLevelHeader&&d.canEdit&&!c||d.isPDFForm&&d.canFillForms&&d.isRestrictedEdit||c&&(d.canPDFEdit&&!d.isPDFEdit&&!d.isPDFAnnotate||d.isPDFFill))&&(this.btnEdit=p("toolbar__icon icon--inverse btn-edit",g.findById("#slot-hbtn-edit"),void 0,"bottom","big")),m.btnSearch.render(g.find("#slot-btn-search")),d.twoLevelHeader&&!d.compactHeader||(d.user.guest&&d.canRenameAnonymous?(m.btnUserName=new Common.UI.Button({el:g.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),m.btnUserName.cmpEl.removeClass("hidden")):(m.elUserName=g.find(".btn-current-user"),m.elUserName.removeClass("hidden")),s=g.find(".color-user-name"),m.setUserName(m.options.userName),d.canCloseEditor&&(m.btnClose=p("toolbar__icon icon--inverse btn-close",g.findById("#slot-btn-close"),!1,"bottom","big"))),!r&&d&&(d.sharingSettingsUrl&&d.sharingSettingsUrl.length||d.canRequestSharingSettings)?(m.btnShare=new Common.UI.Button({cls:"btn-header btn-header-share",iconCls:"toolbar__icon icon--inverse btn-users-share",caption:m.textShare,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),m.btnShare.render(g.find("#slot-btn-share"))):g.find("#slot-btn-share").hide(),c&&d.isEdit&&d.canSwitchMode?(m.btnPDFMode=new Common.UI.Button({cls:"btn-header btn-header-pdf-mode",iconCls:"toolbar__icon icon--inverse btn-menu-comments",caption:m.textComment,menu:!0,value:"comment",lock:[Common.enumLock.lostConnect,Common.enumLock.fileMenuOpened,Common.enumLock.changeModeLock],dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),m.btnPDFMode.render(g.find("#slot-btn-edit-mode")),y.call(m,d),Common.NotificationCenter.on("pdf:mode-changed",_.bind(y,m))):h&&d.isEdit&&d.canSwitchMode?(m.btnDocMode=new Common.UI.Button({cls:"btn-header btn-header-pdf-mode ",iconCls:"toolbar__icon icon--inverse "+(d.isReviewOnly?"btn-ic-review":"btn-edit"),caption:d.isReviewOnly?m.textReview:m.textEdit,menu:!0,visible:d.isReviewOnly||!d.canReview,lock:[Common.enumLock.previewReviewMode,Common.enumLock.lostConnect,Common.enumLock.disableOnStart,Common.enumLock.docLockView,Common.enumLock.docLockComments,Common.enumLock.docLockForms,Common.enumLock.fileMenuOpened,Common.enumLock.changeModeLock],value:d.isReviewOnly?"review":"edit",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),m.btnDocMode.render(g.find("#slot-btn-edit-mode")),x.call(m),Common.NotificationCenter.on("doc:mode-changed",_.bind(x,m))):g.find("#slot-btn-edit-mode").hide(),d.canStartFilling?(m.btnStartFill=new Common.UI.Button({cls:"btn-text-default auto yellow",caption:d.customization&&d.customization.startFillingForm&&d.customization.startFillingForm.text?d.customization.startFillingForm.text:m.textStartFill,dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big"}),m.btnStartFill.render(g.find("#slot-btn-start-fill"))):g.find("#slot-btn-start-fill").hide(),d.isPDFForm&&d.canRequestFillingStatus&&(m.btnFillStatus=new Common.UI.Button({cls:"btn-header",iconCls:"toolbar__icon icon--inverse  btn-filling-status"}),m.btnFillStatus.render(g.find("#slot-btn-fill-status"))),i=g.find(".cousers-list"),n=g.find(".box-cousers"),o=n.find("> .btn-users"),n.hide(),g}if("title"==t){g=$(_.template('<section id="box-document-title"><div class="extra"></div><div class="hedset" role="menubar" aria-label="<%= scope.ariaQuickAccessToolbar %>"><div class="btn-slot" id="slot-btn-dt-home"></div><div class="btn-slot" id="slot-btn-dt-save" data-layout-name="header-save"></div><div class="btn-slot" id="slot-btn-dt-print"></div><div class="btn-slot" id="slot-btn-dt-print-quick"></div><div class="btn-slot" id="slot-btn-dt-undo"></div><div class="btn-slot" id="slot-btn-dt-redo"></div><div class="btn-slot" id="slot-btn-dt-start-over"></div><div class="btn-slot" id="slot-btn-dt-quick-access"></div></div><div class="lr-separator" id="id-box-doc-name"><input id="title-doc-name" autofill="off" autocomplete="off"/></input></div><div class="hedset"><div class="btn-slot" data-layout-name="header-user"><button type="button" class="btn btn-header slot-btn-user-name hidden"><div class="color-user-name"></div></button><div class="btn-current-user hidden"><div class="color-user-name"></div></div></div><div class="btn-slot" id="slot-btn-close"></div></div></section>')({scope:m}));if(a&&a.hide().off(),a=g.find("#title-doc-name"),setTimeout((function(){m.setDocTitle(m.documentCaption)}),50),m.options.wopi&&a.attr("maxlength",m.options.wopi.FileNameMaxLength),d.user.guest&&d.canRenameAnonymous?(m.btnUserName=new Common.UI.Button({el:g.findById(".slot-btn-user-name"),cls:"btn-header",dataHint:"0",dataHintDirection:"bottom",dataHintOffset:"big",visible:!0}),m.btnUserName.cmpEl.removeClass("hidden")):(m.elUserName=g.find(".btn-current-user"),m.elUserName.removeClass("hidden")),s=g.find(".color-user-name"),m.setUserName(m.options.userName),d.canCloseEditor&&(m.btnClose=p("toolbar__icon icon--inverse btn-close",g.findById("#slot-btn-close"),!1,"left","10, 10")),d.canPrint&&d.twoLevelHeader&&(m.btnPrint=p("toolbar__icon icon--inverse btn-print",g.findById("#slot-btn-dt-print"),!0,void 0,void 0,"P"),!Common.localStorage.getBool(m.appPrefix+"quick-access-print",!0)&&m.btnPrint.hide()),d.canQuickPrint&&d.twoLevelHeader&&(m.btnPrintQuick=p("toolbar__icon icon--inverse btn-quick-print",g.findById("#slot-btn-dt-print-quick"),!0,void 0,void 0,"Q"),!Common.localStorage.getBool(m.appPrefix+"quick-access-quick-print",!0)&&m.btnPrintQuick.hide()),d.showSaveButton){let t=d.canSaveToFile||d.isDesktopApp&&d.isOffline?"btn-save":"btn-download";m.btnSave=p("toolbar__icon icon--inverse "+t,g.findById("#slot-btn-dt-save"),!0,void 0,void 0,"S"),!Common.localStorage.getBool(m.appPrefix+"quick-access-save",!0)&&m.btnSave.hide()}return m.btnUndo=p("toolbar__icon icon--inverse btn-undo icon-rtl",g.findById("#slot-btn-dt-undo"),!0,void 0,void 0,"Z",[Common.enumLock.undoLock,Common.enumLock.fileMenuOpened,Common.enumLock.lostConnect]),!Common.localStorage.getBool(m.appPrefix+"quick-access-undo",!0)&&m.btnUndo.hide(),m.btnRedo=p("toolbar__icon icon--inverse btn-redo icon-rtl",g.findById("#slot-btn-dt-redo"),!0,void 0,void 0,"Y",[Common.enumLock.redoLock,Common.enumLock.fileMenuOpened,Common.enumLock.lostConnect]),!Common.localStorage.getBool(m.appPrefix+"quick-access-redo",!0)&&m.btnRedo.hide(),u&&(m.btnStartOver=p("toolbar__icon icon--inverse btn-preview",g.findById("#slot-btn-dt-start-over"),!0,void 0,void 0,"O"),!Common.localStorage.getBool(m.appPrefix+"quick-access-start-over",!0)&&m.btnStartOver.hide()),m.btnQuickAccess=new Common.UI.Button({cls:"btn-header no-caret",iconCls:"toolbar__icon icon--inverse btn-more",menu:!0,dataHint:"0",dataHintDirection:d.isDesktopApp?"right":"left",dataHintOffset:d.isDesktopApp?"10, -18":"10, 10"}),m.btnQuickAccess.render(g.find("#slot-btn-dt-quick-access")),g}},setVisible:function(t){},setBranding:function(t,e){this.branding=t;var i=$("#header-logo"),n=this.getSuitableLogo(t,e);i.toggleClass("logo-light",n.isLight),t&&t.logo&&i&&(!1===t.logo.visible?i.addClass("hidden"):(t.logo.image||t.logo.imageDark||t.logo.imageLight)&&(l=n.image,i.html('<img src="'+l+'" style="max-width:100px; max-height:20px; margin: 0;"/>'),i.css({"background-image":"none",width:"auto"}),(t.logo.url||void 0===t.logo.url)&&i.addClass("link")))},getSuitableLogo:function(t,e,i,n){var o=(t=t||{}).logo?t.logo.image||t.logo.imageDark||t.logo.imageLight:null,s=!0;if(i=i||Common.Utils.InternalSettings.get("settings-tab-style")||"fill",n=n||Common.Utils.InternalSettings.get("settings-tab-background")||"header",!Common.Utils.isIE){var a=Common.UI.Themes.currentThemeColor(h&&e.isPDFForm||c?"--toolbar-header-pdf":h?"--toolbar-header-document":d?"--toolbar-header-spreadsheet":m?"--toolbar-header-visio":"--toolbar-header-presentation"),r=Common.UI.Themes.currentThemeColor("--background-toolbar"),l=e.twoLevelHeader&&!e.compactHeader||"toolbar"!==n?a:r;s=new Common.Utils.RGBColor(l).isDark(),o=t.logo?s?t.logo.imageDark||t.logo.image||t.logo.imageLight:t.logo.imageLight||t.logo.image||t.logo.imageDark:null}return{image:o,isLight:!s}},changeLogo:function(){if(e){var t=this.branding,i=this.getSuitableLogo(t,e,Common.Utils.InternalSettings.get("settings-tab-style"),Common.Utils.InternalSettings.get("settings-tab-background"));if($("#header-logo").toggleClass("logo-light",i.isLight),t&&t.logo&&!1!==t.logo.visible&&e&&(t.logo.image||t.logo.imageDark||t.logo.imageLight)){var n=i.image;n!==l&&(l=n,$("#header-logo img").attr("src",n))}}},setDocumentCaption:function(t){!t&&(t=""),this.documentCaption=t;var e=this.documentCaption.lastIndexOf(".");return this.fileExtention=e>0?this.documentCaption.substring(e):"",this.isModified&&(t+="*"),this.readOnly&&(t+=" ("+this.textReadOnly+")"),a&&this.setDocTitle(t),t},getDocumentCaption:function(){return this.documentCaption},setDocumentChanged:function(t){this.isModified=t;var e=this.documentCaption;t&&(e+="*"),this.setDocTitle(e)},setCanBack:function(t,e){return this.options.canBack=t,this.btnGoBack[t?"show":"hide"](),t&&this.btnGoBack.updateHint(e&&"string"==typeof e?e:this.textBack),w(),this},getCanBack:function(){return this.options.canBack},setFavorite:function(t){return this.options.favorite=t,this.btnFavorite[null!=t?"show":"hide"](),this.btnFavorite.changeIcon(t?{next:"btn-in-favorite",curr:"btn-favorite"}:{next:"btn-favorite",curr:"btn-in-favorite"}),this.btnFavorite.updateHint(t?this.textRemoveFavorite:this.textAddFavorite),w(),this},getFavorite:function(){return this.options.favorite},setWopi:function(t){this.options.wopi=t},setCanRename:function(t){var e=this;if(e.options.canRename=t,a){var i=a;if(t)i.removeAttr("disabled").tooltip({title:e.txtRename,placement:"cursor"}),i.on({keydown:A.bind(this),focus:T.bind(this),blur:function(t){!e.isSaveDocName&&M.call(e),e.imgCrypted&&e.imgCrypted.toggleClass("hidden",!1),Common.Utils.isGecko&&(i[0].selectionStart=i[0].selectionEnd=0),e.isSaveDocName||(e.withoutExt=!1,e.setDocTitle(e.documentCaption))},paste:function(t){setTimeout((function(){var t=e.cutDocName(a.val());e.setDocTitle(t)}))}});else{i.off(),i.attr("disabled",!0);var n=i.data("bs.tooltip");n&&(n.options.title="",n.setContent())}i.attr("data-can-copy",t)}},cutDocName:function(t){if(t.length<=this.fileExtention.length)return t;var e=t.length-this.fileExtention.length;return t.substring(e)==this.fileExtention?t.substring(0,e):t},setDocTitle:function(t){if(a){var e=this.getTextWidth(t||a.val());e>=0&&a.width(e),t&&e>=0&&a.val(t),this._showImgCrypted&&e>=0&&(this.imgCrypted.toggleClass("hidden",!1),this._showImgCrypted=!1),e>=0&&k()}},getTextWidth:function(t){if(!this._testCanvas){var e=(a.css("font-size")+" "+a.css("font-family")).trim();if(e){var i=document.createElement("canvas");this._testCanvas=i.getContext("2d"),this._testCanvas.font=e}}if(this._testCanvas){var n=this._testCanvas.measureText(t);return void 0!==n.actualBoundingBoxLeft?Math.ceil(Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight))+1:n.width?Math.ceil(n.width)+2:0}return-1},setUserName:function(t){return this.options.userName=t,this.btnUserName?this.btnUserName.updateHint(t):this.elUserName&&this.elUserName.tooltip({title:Common.Utils.String.htmlEncode(t),placement:"cursor",html:!0}),s&&this.updateAvatarEl(),this},setUserAvatar:function(t){this.options.userAvatar=t,s&&this.updateAvatarEl()},setUserId:function(t){this.options.currentUserId=t},updateAvatarEl:function(){this.options.userAvatar?(s.css({"background-image":"url("+this.options.userAvatar+")","background-color":"transparent"}),s.text("")):s.text(Common.Utils.getUserInitials(this.options.userName))},avatarsUpdate:function(t,e){"info"===t&&this.setUserAvatar(Common.UI.ExternalUsers.getImage(this.options.currentUserId))},getButton:function(t){return"save"==t?this.btnSave:"users"==t?n:"share"==t?this.btnShare:"mode"==t?this.btnDocMode:void 0},lockHeaderBtns:function(t,e,i){var n=this;if("users"==t)e?o.addClass("disabled").attr("disabled","disabled"):o.removeClass("disabled").removeAttr("disabled"),n.btnShare&&n.btnShare.setDisabled(e);else if("rename-user"==t)n.btnUserName&&n.btnUserName.setDisabled(e);else if("search"==t)n.btnSearch&&n.btnSearch.setDisabled(e);else{var s=function(t){t&&Common.Utils.lockControls(i,e,{array:[t]})};switch(t){case"undo":s(n.btnUndo);break;case"redo":s(n.btnRedo);break;case"mode":s(n.btnDocMode?n.btnDocMode:n.btnPDFMode)}}},setDocumentReadOnly:function(t){this.readOnly=t,this.setDocumentCaption(this.documentCaption)},onStartFilling:function(){this.btnStartFill&&this.btnStartFill.setVisible(!1),w()},onThemeChanged:function(){this.changeLogo(),this._testCanvas&&(this._testCanvas=void 0),this.setDocTitle()},textBack:"Go to Documents",txtRename:"Rename",txtAccessRights:"Change access rights",tipAccessRights:"Manage document access rights",labelCoUsersDescr:"Document is currently being edited by several users.",tipViewUsers:"View users and manage document access rights",tipUsers:"View users",tipDownload:"Download file",tipPrint:"Print file",tipGoEdit:"Edit current file",tipSave:"Save",tipUndo:"Undo",tipRedo:"Redo",textCompactView:"Hide Toolbar",textHideStatusBar:"Combine sheet and status bars",textHideLines:"Hide Rulers",textZoom:"Zoom",textAdvSettings:"Advanced Settings",tipViewSettings:"View Settings",textRemoveFavorite:"Remove from Favorites",textAddFavorite:"Mark as favorite",textHideNotes:"Hide Notes",tipSearch:"Search",textShare:"Share",tipPrintQuick:"Quick print",textReadOnly:"Read only",textView:"Viewing",textComment:"Commenting",textEdit:"Editing",textViewDesc:"All changes will be saved locally",textCommentDesc:"All changes will be saved to the file. Real time collaboration",textEditDesc:"All changes will be saved to the file. Real time collaboration",textViewDescNoCoedit:"View or annotate",textEditDescNoCoedit:"Add or edit text, shapes, images etc.",tipView:"Viewing",tipComment:"Commenting",tipEdit:"Editing",textDocViewDesc:"View the file, but make no changes",textDocEditDesc:"Make any changes",tipDocView:"Viewing",tipDocEdit:"Editing",textReview:"Reviewing",textReviewDesc:"Suggest changes",tipReview:"Reviewing",textClose:"Close file",textStartFill:"Start filling",tipCustomizeQuickAccessToolbar:"Customize Quick Access Toolbar",textPrint:"Print",textViewForm:"Viewing form",tipDocViewForm:"Viewing form",textDocViewFormDesc:"See how the form will look like when filling out",helpDocMode:"Easily change the way you work on a document: edit, review and track changes, or view only. This works individually for each user. So, you wonât affect or disturb other co-authors. ",helpDocModeHeader:"Switch between modes",helpQuickAccess:"Hide or show the functional buttons of your choice.",helpQuickAccessHeader:"Customize Quick Access",ariaQuickAccessToolbar:"Quick access toolbar",textAnnotateDesc:"Fill forms or annotate",textDownload:"Download",tipFillStatus:"Filling status"}}(),Common.Views.Header||{}))})),define("text",["module"],(function(t){"use strict";var e,i,n,o,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,h=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,u=c&&(location.port||void 0),m={},p=t.config&&t.config()||{};function f(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(r,"")).match(l);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=a[e];try{t=new ActiveXObject(i)}catch(t){}if(t){a=[i];break}}return t},parseName:function(t){var e,i,n,o=!1,s=t.lastIndexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==s&&(!a||s>1)?(e=t.substring(0,s),i=t.substring(s+1)):e=t,-1!==(s=(n=i||e).indexOf("!"))&&(o="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:e=n),{moduleName:e,ext:i,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,o){var s,a,r,l=e.xdRegExp.exec(t);return!l||(s=l[2],r=(a=(a=l[3]).split(":"))[1],a=a[0],(!s||s===i)&&(!a||a.toLowerCase()===n.toLowerCase())&&(!r&&!a||function(t,e,i,n){if(e===n)return!0;if(t===i){if("http"===t)return f(e,"80")===f(n,"80");if("https"===t)return f(e,"443")===f(n,"443")}return!1}(s,r,i,o)))},finishLoad:function(t,i,n,o){n=i?e.strip(n):n,p.isBuild&&(m[t]=n),o(n)},load:function(t,i,n,o){if(o&&o.isBuild&&!o.inlineText)n();else{p.isBuild=o&&o.isBuild;var s=e.parseName(t),a=s.moduleName+(s.ext?"."+s.ext:""),r=i.toUrl(a),l=p.useXhr||e.useXhr;0!==r.indexOf("empty:")?!c||l(r,h,d,u)?e.get(r,(function(i){e.finishLoad(t,s.strip,i,n)}),(function(t){n.error&&n.error(t)})):i([a],(function(t){e.finishLoad(s.moduleName+"."+s.ext,s.strip,t,n)}),(function(t){n.error&&n.error(t)})):n()}},write:function(t,i,n,o){if(m.hasOwnProperty(i)){var s=e.jsEscape(m[i]);n.asModule(t+"!"+i,"define(function () { return '"+s+"';});\n")}},writeFile:function(t,i,n,o,s){var a=e.parseName(i),r=a.ext?"."+a.ext:"",l=a.moduleName+r,c=n.toUrl(a.moduleName+r)+".js";e.load(l,n,(function(i){var n=function(t){return o(c,t)};n.asModule=function(t,e){return o.asModule(t,c,e)},e.write(t,l,n,s)}),s)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var o=i.readFileSync(t,"utf8");"\ufeff"===o[0]&&(o=o.substring(1)),e(o)}catch(t){n&&n(t)}}):"xhr"===p.env||!p.env&&e.createXhr()?e.get=function(t,i,n,o){var s,a=e.createXhr();if(a.open("GET",t,!0),o)for(s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s.toLowerCase(),o[s]);p.onXhr&&p.onXhr(a,t),a.onreadystatechange=function(e){var o,s;4===a.readyState&&((o=a.status||0)>399&&o<600?((s=new Error(t+" HTTP status: "+o)).xhr=a,n&&n(s)):i(a.responseText),p.onXhrComplete&&p.onXhrComplete(a,t))},a.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,o=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),r="";try{for(i=new java.lang.StringBuffer,(n=a.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(s),i.append(n);r=String(i.toString())}finally{a.close()}e(r)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,a,r,l={};s&&(t=t.replace(/\//g,"\\")),r=new FileUtils.File(t);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream)).init(r,1,0,!1),(a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream)).init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),e(l.value)}catch(t){throw new Error((r&&r.path||"")+": "+t)}}),e})),define("text!visioeditor/main/app/template/Viewport.template",[],(function(){return'<div class="layout-region">\n    <section class="layout-ct">\n        <div id="file-menu-panel" class="toolbar-fullview-panel hint-section" style="display:none;"></div>\n    </section>\n    <div id="viewport-vbox-layout" class="layout-ct vbox">\n        <section id="app-title" class="layout-item"></section>\n        <div id="toolbar" class="layout-item hint-section" data-layout-name="toolbar" role="toolbar"></div>\n        <div class="layout-item middle">\n            <div id="viewport-hbox-layout" class="layout-ct hbox">\n                <div id="left-menu" class="layout-item hint-section" data-layout-name="leftMenu" style="width: 40px;"></div>\n                <div id="about-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\n                <div id="editor-container" class="layout-item"><div id="editor_sdk"></div></div>\n            </div>\n        </div>\n        <div id="statusbar" class="layout-item" data-layout-name="statusBar"></div>\n    </div>\n</div>'})),void 0===Common)var Common={};if(define("common/main/lib/component/Layout",["backbone"],(function(){"use strict";var t=function(t){this.box=null,this.panels=[],this.splitters=[],_.extend(this,t||{})},e=function(){return{width:null,height:null,resize:!1,stretch:!1,rely:!1}};_.extend(t.prototype,Backbone.Events,{initialize:function(t){this.$parent=this.box.parent(),this.resize={eventMove:_.bind(this.resizeMove,this),eventStop:_.bind(this.resizeStop,this)};this.freeze=t.freeze,this.changeLayout(t.items)},doLayout:function(){},changeLayout:function(t){var i,n,o=!1;this.splitters&&this.splitters.forEach((function(t){t.resizer&&t.resizer.el.remove()}),this),this.splitters=[],this.panels=[],t.forEach((function(t){t.el instanceof HTMLElement&&(t.el=$(t.el)),(i=_.extend(new e,t)).stretch&&(o=!0,i.rely=!1,i.resize=!1),this.panels.push(i),i.resize&&(n={isresizer:!0,minpos:i.resize.min||0,maxpos:i.resize.max||0,fmin:i.resize.fmin,fmax:i.resize.fmax,behaviour:i.behaviour,index:this.splitters.length,offset:i.resize.offset||0,multiply:i.resize.multiply},o?(i.resize.el=n.el=i.el.before('<div class="layout-resizer before"></div>').prev(),this.panels.splice(this.panels.length-1,0,n)):(i.resize.el=n.el=i.el.after('<div class="layout-resizer after"></div>').next(),this.panels.push(n)),this.splitters.push({resizer:n}),i.resize.hidden&&n.el.hide(),Common.Gateway.on("processmouse",this.resize.eventStop))}),this),this.freezePanels(this.freeze)},getElementHeight:function(t){return parseInt(t.css("height"))},getElementWidth:function(t){return parseInt(t.css("width"))},getItem:function(t){for(var e in this.panels){var i=this.panels[e];if(i.alias==t)return i}},onSelectStart:function(t){return t.preventDefault&&t.preventDefault(),!1},addHandler:function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeHandler:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},clearSelection:function(){if(window.getSelection){var t=window.getSelection();t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges()}else document.selection&&document.selection.empty()},resizeStart:function(t){if(!this.freeze){this.clearSelection(),this.addHandler(window.document,"selectstart",this.onSelectStart),$(document).on({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop});var e=t.data.panel;this.resize.type=t.data.type,this.resize.$el=e.el,this.resize.min=e.minpos>0?e.minpos:this.resize.$el.parent().width()+e.minpos,this.resize.fmin=e.fmin,this.resize.fmax=e.fmax,this.resize.behaviour=e.behaviour,this.resize.multiply=e.multiply,this.resize.$el.addClass("move"),"vertical"==t.data.type?(this.resize.height=parseInt(this.resize.$el.css("height")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().height()+e.maxpos)-this.resize.height,this.resize.inity=t.pageY*Common.Utils.zoom()-parseInt(t.currentTarget.style.top)):"horizontal"==t.data.type&&(this.resize.width=parseInt(this.resize.$el.css("width")),this.resize.max=(e.maxpos>0?e.maxpos:this.resize.$el.parent().width()+e.maxpos)-this.resize.width,this.resize.initx=t.pageX*Common.Utils.zoom()-parseInt(t.currentTarget.style.left)),this.resize.multiply&&this.resize.multiply.koeff&&(this.resize.max=Math.floor(this.resize.max/this.resize.multiply.koeff)*this.resize.multiply.koeff+(this.resize.multiply.offset||0)),Common.NotificationCenter.trigger("layout:resizestart")}},resizeMove:function(t){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if("vertical"==this.resize.type)var i="top",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="left",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,a=Math.floor(s)*o+(this.resize.multiply.offset||0),r=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>a+o/2?r:a}this.resize.fmin&&this.resize.fmax?n<this.resize.fmin()||n>this.resize.fmax()||(this.resize.$el[0].style[i]=n+"px"):n<this.resize.min||n>this.resize.max||(this.resize.$el[0].style[i]=n+"px")},resizeStop:function(t){if(this.removeHandler(window.document,"selectstart",this.onSelectStart),$(document).off({mousemove:this.resize.eventMove,mouseup:this.resize.eventStop}),this.resize.$el){var e=t instanceof jQuery.Event?Common.Utils.zoom():1;if(t instanceof jQuery.Event||void 0!==t.pageY&&void 0!==t.pageX||(t.pageY=t.y,t.pageX=t.x),"vertical"==this.resize.type)var i="height",n=t.pageY*e-this.resize.inity;else"horizontal"==this.resize.type&&(i="width",n=t.pageX*e-this.resize.initx);if(this.resize.multiply&&this.resize.multiply.koeff){var o=this.resize.multiply.koeff,s=n/o,a=Math.floor(s)*o+(this.resize.multiply.offset||0),r=Math.ceil(s)*o+(this.resize.multiply.offset||0);n=n>a+o/2?r:a}this.resize.fmin&&this.resize.fmax?(n<this.resize.fmin()&&(n=this.resize.fmin()),n>this.resize.fmax()&&(n=this.resize.fmax())):(n<this.resize.min&&(n=this.resize.min),n>this.resize.max&&(n=this.resize.max));var l=null,c=null,h=0;this.resize.$el.hasClass("after")?(l=this.resize.$el.prev(),c=this.resize.$el.next(),h=parseInt(l.css(i))):(l=this.resize.$el.next(),c=this.resize.$el.prev(),h=parseInt(l.css(i)),n=l.parent()[i]()-(n+this.resize[i])),"vertical"==this.resize.type&&(n-=Common.Utils.getPosition(l).top),l.css(i,n+"px"),this.resize.behaviour&&c.css(i,parseInt(c.css(i))-(n-h)),this.resize.$el.removeClass("move"),delete this.resize.$el,this.resize.value!=n&&(this.doLayout(),this.trigger("layout:resizedrag",this)),Common.NotificationCenter.trigger("layout:resizestop")}},freezePanels:function(t){this.panels.forEach((function(e){!e.stretch&&e.resize&&$(e.resize.el).css("cursor",t?"default":"")})),this.freeze=t},setResizeValue:function(t,e){if(t>=this.splitters.length)return this.doLayout(),!1;var i=null,n=null,o=0,s=this.splitters[t].resizer,a="height";return e<s.fmin()&&(e=s.fmin()),e>s.fmax()&&(e=s.fmax()),s.el.hasClass("after")?(i=s.el.prev(),n=s.el.next(),o=parseInt(i.css(a))):(e=(i=s.el.next()).parent()[a]()-(e+s[a]),n=s.el.next(),o=parseInt(i.css(a))),e-=Common.Utils.getPosition(i).top,i.css(a,e+"px"),s.behaviour&&n.css(a,parseInt(n.css(a))-(e-o)),s.value!=e&&this.doLayout(),Math.abs(o-e)>.99}}),!Common.UI&&(Common.UI={}),Common.UI.VBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.VBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(){var t,e,i=0;this.panels.forEach((function(n){n.stretch?t=n:((e=n.el.is(":visible"))&&(i+=!0!==n.rely?n.height:this.getElementHeight(n.el)),n.resize&&!1!==n.resize.autohide&&n.resize.el&&(e?(n.resize.el.show(),t&&(i+=n.resize.height)):(n.resize.el.hide(),t&&(i-=n.resize.height))))}),this),t&&(t.height=this.$parent.height()-i),i=0,this.panels.forEach((function(t){t.el.is(":visible")&&(e={top:i},!0!==t.rely&&(e.height=t.height),t.el.css(e),i+=e.height||this.getElementHeight(t.el))}),this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach((function(t){!t.stretch&&!t.height&&(t.height=this.getElementHeight(t.el)),t.isresizer&&t.el.on("mousedown",{type:"vertical",panel:t},_.bind(this.resizeStart,this))}),this),this.doLayout.call(this)}}),Common.UI.HBoxLayout=function(e){t.apply(this,arguments),this.initialize.apply(this,arguments)},Common.UI.HBoxLayout.prototype=_.extend(new t,{initialize:function(e){t.prototype.initialize.call(this,e)},doLayout:function(t){var e,i,n=0;this.panels.forEach((function(t){t.stretch?e=t:((i=t.el.is(":visible"))&&(t.isresizer?n+=t.offset:n+=!0!==t.rely?t.width:this.getElementWidth(t.el)),t.resize&&!1!==t.resize.autohide&&t.resize.el&&(i?(t.resize.el.show(),e&&(n-=t.resize.width)):(t.resize.el.hide(),e&&(n-=t.resize.width))))}),this),e&&(e.width=this.$parent.width()-n),n=0,this.panels.forEach((function(t){t.el.is(":visible")&&(i={left:n-(t.isresizer?t.width:0)},!0!==t.rely&&(i.width=t.width),t.el.css(i),t.isresizer?n+=t.offset:n+=this.getElementWidth(t.el))}),this)},changeLayout:function(e){t.prototype.changeLayout.call(this,e),this.panels.forEach((function(t){!t.stretch&&!t.width&&(t.width=this.getElementWidth(t.el)),t.isresizer&&t.el.on("mousedown",{type:"horizontal",panel:t},_.bind(this.resizeStart,this))}),this),this.doLayout.call(this)}}),Common.UI.VBoxLayout.prototype.constructor=Common.UI.VBoxLayout,Common.UI.HBoxLayout.prototype.constructor=Common.UI.HBoxLayout})),define("visioeditor/main/app/view/Viewport",["text!visioeditor/main/app/template/Viewport.template","jquery","underscore","backbone","common/main/lib/component/Layout"],(function(t,e,i,n){"use strict";VE.Views.Viewport=n.View.extend({el:"#viewport",template:i.template(t),events:{},initialize:function(){this._initEditing=!0},render:function(){var t=e(this.el);t.html(this.template({})),Common.Utils.isSafari?(e("body").addClass("safari"),e("body").mousewheel((function(t){t.preventDefault(),t.stopPropagation()}))):Common.Utils.isChrome&&e("body").addClass("chrome"),t.on("scroll",(function(){t.scrollTop(0)}));var i,n=e("#viewport-vbox-layout",t),o=n.find(" > .layout-item");this.vlayout=new Common.UI.VBoxLayout({box:n,items:[{el:n.find("> .layout-item#app-title").hide(),alias:"title",height:Common.Utils.InternalSettings.get("document-title-height")},{el:o[1],alias:"toolbar",height:Common.localStorage.getBool("ve-compact-toolbar")?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},{el:o[2],stretch:!0},{el:o[3],alias:"statusbar",height:(i=parseInt(getComputedStyle(document.body).getPropertyValue("--statusbar-height")||25),Common.localStorage.getBool("ve-compact-statusbar",!0)?i:2*i)}]});let s=[{el:(o=(n=e("#viewport-hbox-layout",t)).find(" > .layout-item"))[0],rely:!0,alias:"left",resize:{hidden:!0,autohide:!1,min:300,max:600}},{el:o[1],stretch:!0}];return Common.UI.isRTL()&&(s[0].resize.min=-600,s[0].resize.max=-300,[s[0],s[1]]=[s[1],s[0]]),this.hlayout=new Common.UI.HBoxLayout({box:n,items:s}),this},setMode:function(t){t.isDisconnected?(i.isUndefined(this.mode)&&(this.mode={}),this.mode.canCoAuthoring=!1):this.mode=t}})})),define("text!visioeditor/main/app/template/LeftMenu.template",[],(function(){return'<div id="view-left-menu" class="tool-menu left">\n    <div class="tool-menu-btns" role="menubar" aria-orientation="vertical" aria-label="<%= scope.ariaLeftMenu %>">\n        \x3c!--<button id="left-btn-searchbar" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-search"><i class="icon toolbar__icon btn-menu-search">&nbsp;</i></button>--\x3e\n        <button id="left-btn-thumbs" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-thumbs">&nbsp;</i></button>\n        <button id="left-btn-chat" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target="left-panel-chat"><i class="icon toolbar__icon btn-menu-chat">&nbsp;</i></button>\n        <button id="left-btn-support" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-support">&nbsp;</i></button>\n        <button id="left-btn-about" class="btn btn-category" data-hint="0" data-hint-direction="right" data-hint-offset="big" content-target=""><i class="icon toolbar__icon btn-menu-about">&nbsp;</i></button>\n        <div id="slot-left-menu-more"></div>\n    </div>\n    <div class="left-panel side-panel" style="">\n        \x3c!--<div id="left-panel-search" class="" style="display: none;"></div>--\x3e\n        <div id="left-panel-chat" class="content-box" style="display: none;"></div>\n    </div>\n</div>'})),void 0===Common)var Common={};if(define("common/main/lib/component/BaseView",["backbone"],(function(t){"use strict";Common.UI=_.extend(Common.UI||{},{Keys:{BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,SPACE:32,PAGEUP:33,PAGEDOWN:34,INSERT:45,ZERO:48,EQUALITY_FF:61,NUM_ZERO:96,NUM_PLUS:107,NUM_MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,MINUS_FF:173,EQUALITY:187,MINUS:189},BaseView:t.View.extend({isSuspendEvents:!1,initialize:function(t){this.options=this.options?_({}).extend(this.options,t):t},setVisible:function(t){return this[t?"show":"hide"]()},isVisible:function(){return $(this.el).is(":visible")},suspendEvents:function(){this.isSuspendEvents=!0},resumeEvents:function(){this.isSuspendEvents=!1}}),getId:function(t){return _.uniqueId(t||"asc-gen")}})})),define("common/main/lib/component/SideMenu",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.UI.SideMenu=e.View.extend({buttons:[],btnMoreContainer:void 0,render:function(){this.btnMore=new Common.UI.Button({parentEl:this.btnMoreContainer,cls:"btn-side-more btn-category",iconCls:"toolbar__icon btn-more",onlyIcon:!0,style:"width: 100%;",hint:this.tipMore,menu:new Common.UI.Menu({cls:"shifted-right",items:[]})}),this.btnMore.menu.on("item:click",t.bind(this.onMenuMore,this)),this.btnMore.menu.on("item:custom-click",t.bind(this.onMenuMore,this)),this.btnMore.menu.on("show:before",t.bind(this.onShowBeforeMoreMenu,this)),this.btnMore.hide(),$(window).on("resize",t.bind(this.setMoreButton,this))},setButtons:function(e){this.buttons=[],e.forEach(t.bind((function(t){t&&t.cmpEl.is(":visible")&&this.buttons.push(t)}),this))},addButton:function(t){this.buttons.push(t)},insertButton:function(e,i){this.btnMoreContainer.before(i),e.on("click",t.bind((function(){this.fireEvent("button:click",[e])}),this)),this.addButton(e),this.setMoreButton()},insertPanel:function(t){this.$el.find(".side-panel").append(t)},setMoreButton:function(){if(this.buttons.length){var e=this.btnMore,i=this.buttons[0].cmpEl.outerHeight(!0),n=parseFloat(this.$el.find(".tool-menu-btns").css("padding-top")),o=n+this.buttons.length*i,s=this.$el.height();if(o>s){var a,r,l=[];for(o=n,r=0;r<this.buttons.length;r++)if((o+=i)>s){a=r-1;break}if(this.buttons.forEach((function(e,i){i>=a?(e.options.iconImg?l.push({caption:Common.Utils.String.htmlEncode(e.hint),iconImg:e.options.iconImg,template:t.template(['<a id="<%= id %>" class="menu-item" tabindex="-1" type="menuitem">','<img class="menu-item-icon" src="<%= options.iconImg %>">',"<%= caption %>","</a>"].join("")),value:i,toggleGroup:"sideMenuItems",checkmark:!1,checkable:!0}):e.options.iconsSet?l.push(new Common.UI.MenuItemCustom({caption:Common.Utils.String.htmlEncode(e.hint),iconsSet:e.options.iconsSet,baseUrl:e.options.baseUrl,value:i,disabled:e.isDisabled(),toggleGroup:"sideMenuItems",checkmark:!1,checkable:!0})):l.push({caption:Common.Utils.String.htmlEncode(e.hint),iconCls:"menu__icon "+e.iconCls,value:i,disabled:e.isDisabled(),toggleGroup:"sideMenuItems",checkmark:!1,checkable:!0}),e.cmpEl.hide()):e.cmpEl.show()})),l.length>0){for(this.btnMore.menu.removeAll(),r=0;r<l.length;r++)this.btnMore.menu.addItem(l[r]);e.show()}}else this.buttons.forEach((function(t){t.cmpEl.show()})),e.hide()}},clearMoreButton:function(){this.buttons&&this.buttons.forEach((function(t){t.cmpEl.show()})),this.btnMore.hide()},onMenuMore:function(t,e){var i=this.buttons[e.value];"left-btn-support"!==i.cmpEl.prop("id")&&i.toggle(!i.pressed),i.trigger("click",i)},onShowBeforeMoreMenu:function(e){var i;e.items.forEach((function(t){t.setChecked(!1,!0)})),this.buttons.forEach((function(t,e){t.pressed&&(i=e)}));var n=t.findWhere(e.items,{value:i});n&&n.setChecked(!0,!0)},setDisabledMoreMenuItem:function(e,i){if(this.btnMore&&!e.cmpEl.is(":visible")){var n=t.indexOf(this.buttons,e),o=t.findWhere(this.btnMore.menu.items,{value:n});o&&o.setDisabled(i)}},setDisabledAllMoreMenuItems:function(t){this.btnMore&&this.btnMore.menu.items.length>0&&this.btnMore.menu.items.forEach((function(e){e.setDisabled(t)}))},setDisabledPluginButtons:function(t){var e=this;this.buttons.forEach((function(i){"plugin"===i.options.type&&(i.setDisabled(t),e.setDisabledMoreMenuItem(i,t))}))},isButtonInMoreMenu:function(e){return t.indexOf(this.buttons,e)>-1},getPluginButton:function(t){for(var e,i=0;i<this.buttons.length;i++)if(this.buttons[i].options.value===t){e=this.buttons[i];break}return[e,i]},openPlugin:function(t){var e=this.getPluginButton(t)[0];e&&(e.isDisabled()||e.pressed||(e.toggle(!0),this.fireEvent("button:click",[e])))},closePlugin:function(t){var e=this.getPluginButton(t),i=e[0],n=e[1];i.cmpEl.parent().remove(),this.buttons.splice(n,1),this.close&&this.close(),this.setMoreButton()},isPluginButtonPressed:function(){for(var t=!1,e=0;e<this.buttons.length;e++)if("plugin"===this.buttons[e].options.type&&this.buttons[e].pressed){t=!0;break}return t},toggleActivePluginButton:function(t){for(var e=0;e<this.buttons.length;e++)"plugin"===this.buttons[e].options.type&&this.buttons[e].pressed&&this.buttons[e].toggle(t,!0)},updatePluginButtonsIcons:function(e){var i=this;e.forEach((function(e){var n=i.getPluginButton(e.guid),o=n[0],s=n[1],a=t.findWhere(i.btnMore.menu.items,{value:s}),r=e.baseUrl+e.parsedIcons.normal;o.options.iconsSet||(o.options.iconImg=r,o.cmpEl.find("img").attr("src",r)),a&&!a.options.iconsSet&&a.cmpEl.find("img").attr("src",r)}))}})})),void 0===Common)var Common={};if(define("common/main/lib/component/ToggleManager",["common/main/lib/component/BaseView"],(function(){"use strict";var t={};function e(e,i){var n,o,s;if(i)for(o=0,s=(n=t[e.toggleGroup]).length;o<s;o++)n[o]!==e&&(n[o].isActive?n[o].isActive()&&n[o].toggle(!1):n[o].toggle(!1))}Common.UI.ToggleManager={register:function(i){if(i.toggleGroup){var n=t[i.toggleGroup];n||(n=t[i.toggleGroup]=[]),n.push(i),i.on("toggle",e)}},unregister:function(i){if(i.toggleGroup){var n=t[i.toggleGroup];n&&(_.without(n,i),i.off("toggle",e))}},getToggled:function(e){var i,n=t[e],o=0;if(n)for(i=n.length;o<i;o++)if(!0===n[o].pressed||!0===n[o].checked)return n[o];return null}}})),void 0===Common)var Common={};if(define("common/main/lib/component/Button",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],(function(){"use strict";window.createButtonSet=function(){function t(t){}t.prototype=new Array,t.prototype.constructor=t;var e=!1;t.prototype.add=function(t){t.setDisabled(e),this.push(t)},t.prototype.setDisabled=function(t){e=t,this.forEach((function(e){e.setDisabled(t)}))},t.prototype.toggle=function(t,e){this.forEach((function(i){i.toggle(t,e)}))},t.prototype.pressed=function(){return this.some((function(t){return t.pressed}))},t.prototype.contains=function(t){return this.some((function(e){return e.id==t}))},t.prototype.concat=function(){var t=Array.prototype.slice.call(arguments),e=Array.prototype.slice.call(this);return t.forEach((function(t){t instanceof Array?Array.prototype.push.apply(e,t):t&&e.push(t)})),e};var i=Object.create(t.prototype);for(var n in arguments)i.add(arguments[n]);return i};var t='<% if ( iconImg ) { %><img src="<%= iconImg %>"><% } else { %><% if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); %><% } %>',e='<%= caption %><i class="caret"></i>',i='<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>> <div class="inner-box-icon">'+t+'</div><div class="inner-box-caption"><span class="caption"><%= caption %></span></div></button>',n='<div class="btn-group icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><div class="inner-box-icon">'+t+'</div><div class="inner-box-caption"><span class="caption">'+e+'</span><i class="caret compact-caret"></i></div></button></div>',o='<div class="btn-group x-huge split icon-top" id="<%= id %>" style="<%= style %>"><button type="button" class="btn <%= cls %> inner-box-icon"><span class="btn-fixflex-hcenter">'+t+'</span></button><button type="button" class="btn <%= cls %> inner-box-caption dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>><span class="btn-fixflex-vcenter"><span class="caption">'+e+'</span><i class="caret compact-caret"></i></span></button></div>',s=function(t){var e=Common.UI.Themes.getThemeProps("font"),i=document.createElement("span");i.style.fontSize=e&&e.size?e.size:"11px",i.style.fontFamily=e&&e.name?e.name:'Arial, Helvetica, "Helvetica Neue", sans-serif',i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.innerHTML=t,document.body.appendChild(i);var n=i.offsetWidth;return document.body.removeChild(i),n},a=function(t,e){for(var i=t.length-1,n=t;s(n)>e;)n=t.slice(0,i).trim()+"...",i--;return n};Common.UI.Button=Common.UI.BaseView.extend({options:{id:null,hint:!1,delayRenderHint:!0,enableToggle:!1,allowDepress:!0,toggleGroup:null,cls:"",iconCls:"",caption:"",menu:null,disabled:!1,pressed:!1,split:!1,visible:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"0, 0",scaling:!0,canFocused:!1,takeFocusOnClose:!1,action:""},template:_.template(["<% var applyicon = function() { %>","<% if (iconImg) { print('<img src=\"' + iconImg + '\">'); } else { %>",'<% if (iconCls != "") {  if (/svgicon/.test(iconCls)) {print(\'<svg class="icon uni-scale"><use class="zoom-int" xlink:href="#\' + /svgicon\\s(\\S+)/.exec(iconCls)[1] + \'"></use></svg>\');} else print(\'<i class="icon \' + iconCls + \'">&nbsp;</i>\'); }} %>',"<% } %>","<% if ( !menu && onlyIcon ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>","</button>","<% } else if ( !menu ) { %>",'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>","<% } else if (onlyIcon) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>","</button>","</div>","<% } else if (split == false) {%>",'<div class="btn-group" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>',"<% applyicon() %>",'<span class="caption"><%= caption %></span>','<span class="inner-box-caret"><i class="caret"></i></span>',"</button>","</div>","<% } else { %>",'<div class="btn-group split <%= groupCls %>" id="<%= id %>" style="<%= style %>">','<button type="button" class="btn <%= cls %>">',"<% applyicon() %>",'<span class="caption"><%= caption %></span>',"</button>",'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" <% if (dataHintTitle) { %> data-hint-title="<%= dataHintTitle %>" <% } %>>','<i class="caret"></i>','<span class="sr-only"></span>',"</button>","</div>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),e.hint=e.options.hint,e.enableToggle=e.options.enableToggle,e.allowDepress=e.options.allowDepress,e.cls=e.options.cls,e.iconCls=e.options.iconCls,e.menu=e.options.menu,e.split=e.options.split,e.toggleGroup=e.options.toggleGroup,e.disabled=e.options.disabled,e.visible=e.options.visible,e.pressed=e.options.pressed,e.caption=e.options.caption,e.template=e.options.template||e.template,e.style=e.options.style,e.rendered=!1,e.stopPropagation=e.options.stopPropagation,e.delayRenderHint=e.options.delayRenderHint,e.action=e.options.action||"",!1===e.options.scaling&&e.options.iconCls&&(e.iconCls=e.options.iconCls+" scaling-off"),e.options.takeFocusOnClose&&(e.options.canFocused=!0),e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},getCaptionWithBreaks:function(t){var e=t.split(" "),i=null,n=156,o=e.indexOf("&");if(o>-1&&(e[o-1]+=" &",e.splice(o,1)),e.length>1)if(n=this.menu||!0===this.split?n-10:n,e.length<3)e[0]=a(e[0],this.menu?n+10:n),e[1]=a(e[1],n),i=e[0]+"<br>"+e[1];else{var r="";if(s(e[0]+" "+e[1])<n){for(var l=2;l<e.length;l++)r+=e[l]+" ";2*s(r+(this.menu?10:0))<s(e[0]+" "+e[1])?(r=a((e[1]+" "+r).trim(),n),i=e[0]+"<br>"+r):(r=a(r.trim(),n),i=e[0]+" "+e[1]+"<br>"+r)}else{for(var c=1;c<e.length;c++)r+=e[c]+" ";r=a(r.trim(),n),i=e[0]+"<br>"+r}}else i=s(t)<n?t:a(t,n),(this.menu||!0===this.split)&&(i+="<br>");return i},render:function(t){var e=this;if(e.trigger("render:before",e),e.cmpEl=e.$el||$(e.el),t&&(e.setElement(t,!1),!e.rendered)){if(/icon-top/.test(e.cls)&&e.caption&&/huge/.test(e.cls)){!0===e.split?(e.cls&&(e.cls=e.cls.replace(/\s?(?:x-huge|icon-top)/g,"")),this.template=_.template(o)):e.menu?this.template=_.template(n):this.template=_.template(i);var s=this.getCaptionWithBreaks(this.caption);s&&(e.caption=s)}e.cmpEl=$(this.template({id:e.id,cls:e.cls,groupCls:e.split&&/btn-toolbar/.test(e.cls)?"no-borders":"",iconCls:e.iconCls,iconImg:e.options.iconImg,menu:e.menu,split:e.split,onlyIcon:e.options.onlyIcon,disabled:e.disabled,pressed:e.pressed,caption:e.caption,style:e.style,dataHint:e.options.dataHint,dataHintDirection:e.options.dataHintDirection,dataHintOffset:e.options.dataHintOffset,dataHintTitle:e.options.dataHintTitle})),e.menu&&_.isObject(e.menu)&&_.isFunction(e.menu.render)&&(e.menu.render(e.cmpEl),e.options.canFocused&&e.attachKeyEvents()),t.html(e.cmpEl),e.$icon=e.$el.find(".icon")}if(!e.rendered){var a=e.cmpEl,r=a.hasClass("btn-group"),l=a.hasClass("split");_.isString(e.toggleGroup)&&(e.enableToggle=!0);var c,h=function(t){if(!e.disabled&&(1===t.which||void 0===t.which)){if(e.doToggle(),e.options.hint){var i=e.btnEl.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide())}e.split&&e.options.takeFocusOnClose&&e.focus(),e.trigger("click",e,t)}},d=function(t,i,n){if(!t){var o=!1;$("button",a).each((function(t,e){if($(e).is(":hover"))return o=!0,!1})),o||(a.removeClass("over"),$("button",a).removeClass("over"))}if("button"==i){if(!t&&e.enableToggle&&e.allowDepress&&e.pressed)return;if(t&&!l&&e.enableToggle&&e.allowDepress&&!e.pressed)return void n.preventDefault();$("button:first",a).toggleClass("active",t)}else $("[data-toggle^=dropdown]:first",a).toggleClass("active",t);a.toggleClass("active",t),e.stopPropagation&&n.stopPropagation()},u=function(t){d(!1,c,t),$(document).off("mouseup",u)};r?(l&&($("[data-toggle^=dropdown]",a).on("mousedown",_.bind((function(t){if(!e.disabled&&1==t.which&&l){if(e.options.hint){var i=(e.btnMenuEl?e.btnMenuEl:e.btnEl).data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide())}d(!e.isMenuOpen(),"arrow",t)}}),this)),$("button",a).on("mousedown",_.bind((function(t){c=t.currentTarget.className.match(/dropdown/)?"arrow":"button",d(!0,c,t),$(document).on("mouseup",u)}),this)),e.options.width>0&&$("button:first",a).css("width",e.options.width-$("[data-toggle^=dropdown]",a).outerWidth())),a.on("hide.bs.dropdown",_.bind(d,e,!1,"arrow")),a.on("show.bs.dropdown",_.bind(d,e,!0,"arrow")),a.on("hidden.bs.dropdown",_.bind((function(t,i){e.cmpEl.find(".dropdown-toggle").blur(),e.cmpEl.hasClass("active")!==e.pressed&&e.cmpEl.trigger("button.internal.active",[e.pressed])}),e)),$("button:first",a).on("click",h)):a.on("click",h),a.on("button.internal.active",_.bind((function(t,i){l?d(i,"button",t):(a.toggleClass("active",i),$("button",a).toggleClass("active",i)),e.stopPropagation&&t.stopPropagation()}),e)),a.on("mouseover",(function(t){e.disabled||(e.cmpEl.addClass("over"),e.trigger("mouseover",e,t))})),a.on("mouseout",(function(t){e.cmpEl.removeClass("over"),e.disabled||e.trigger("mouseout",e,t)})),Common.UI.ToggleManager.register(e),!1!==e.options.scaling&&(a.attr("ratio","ratio"),e.applyScaling(Common.UI.Scaling.currentRatio()),a.on("app:scaling",(function(t,i){e.options.scaling!=i.ratio&&e.applyScaling(i.ratio)})));var m=$("button",a).length>0?$("button",a):e.cmpEl;if(e.menu||m.addClass("canfocused"),e.enableToggle&&!e.menu&&m.attr("aria-pressed",!!e.pressed),e.menu&&($("[data-toggle^=dropdown]",a).attr("aria-haspopup","menu"),$("[data-toggle^=dropdown]",a).attr("aria-expanded",!1)),!e.caption&&e.options.hint||e.options.ariaLabel){var p=e.options.ariaLabel?e.options.ariaLabel:"string"==typeof e.options.hint?e.options.hint:e.options.hint[0];m.attr("aria-label",p)}Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this))}return e.rendered=!0,e.options.hint&&e.createHint(e.options.hint),e.pressed&&e.toggle(e.pressed,!0),e.disabled&&e.setDisabled(!(e.disabled=!1)),e.visible||e.setVisible(e.visible),e.trigger("render:after",e),this},doToggle:function(){var t=this;!t.enableToggle||!1===t.allowDepress&&t.pressed||t.toggle()},toggle:function(t,e){var i=void 0===t?!this.pressed:!!t;this.pressed=i,this.cmpEl&&(this.cmpEl.attr("aria-pressed",i),this.cmpEl.trigger("button.internal.active",[i])),e||this.trigger("toggle",this,i)},click:function(t){this.disabled||(this.doToggle(),this.trigger("click",this,t))},isActive:function(){return this.enableToggle?this.pressed:this.cmpEl.hasClass("active")},setDisabled:function(t){if(this.rendered&&this.disabled!=t){var e=(s=this.cmpEl).hasClass("btn-group"),i=this;if((t=!0===t)!==s.hasClass("disabled")){var n=function(e){e.toggleClass("disabled",t),i.options.allowMouseEventsOnDisabled||(t?e.attr({disabled:t}):e.removeAttr("disabled"))};n(s),e&&n(s.children("button"))}if((t||!Common.Utils.isGecko)&&this.options.hint){var o=this.btnEl.data("bs.tooltip");o&&(t&&o.hide(),!Common.Utils.isGecko&&(o.enabled=!t)),this.btnMenuEl&&(o=this.btnMenuEl.data("bs.tooltip"))&&(t&&o.hide(),!Common.Utils.isGecko&&(o.enabled=!t))}if(t&&this.menu&&_.isObject(this.menu)&&this.menu.rendered&&this.menu.isVisible()&&setTimeout((function(){i.menu.hide()}),1),i.options.signals)i.options.signals.indexOf("disabled")<0||i.trigger("disabled",i,t);if(void 0!==i.tabindex){var s=this.split?this.cmpEl:this.$el&&this.$el.find("button").addBack().filter("button");t&&(this.tabindex=s.attr("tabindex")),s.attr("tabindex",t?"-1":i.tabindex)}}this.disabled=t},isDisabled:function(){return this.disabled},setIconCls:function(t){var e=$(this.el).find("i.icon"),i=this.iconCls,n=$(this.el).find(".icon use.zoom-int");if(this.iconCls=t,/svgicon/.test(this.iconCls)){var o=/svgicon\s(\S+)/.exec(this.iconCls);n.attr("xlink:href",o&&o.length>1?"#"+o[1]:"")}else{if(n.length){o=/btn-[^\s]+/.exec(this.iconCls);n.attr("href",o?"#"+o[0]:"")}e.removeClass(i),e.addClass(t||""),!1===this.options.scaling&&e.addClass("scaling-off")}},changeIcon:function(t){var e=this,i=$(this.el).find("i.icon");if(i.length>1&&(i=$(i[0])),t&&(t.curr||t.next)&&i){var n=$(this.el).find(".icon use.zoom-int");t.curr&&(i.removeClass(t.curr),e.iconCls=e.iconCls.replace(t.curr,"").trim()),t.next&&(!i.hasClass(t.next)&&i.addClass(t.next),e.iconCls.indexOf(t.next)<0&&(e.iconCls+=" "+t.next)),n.length&&t.next&&n.attr("href","#"+t.next),e.options.signals&&(e.options.signals.indexOf("icon:changed")<0||e.trigger("icon:changed",e,t))}},hasIcon:function(t){return this.$icon.hasClass(t)},setVisible:function(t){this.cmpEl&&this.cmpEl.toggleClass("hidden",!t),this.visible=t,this.options.signals&&(this.options.signals.indexOf("visible")<0||this.trigger("visible",this,t))},isVisible:function(){return this.cmpEl?this.cmpEl.is(":visible"):$(this.el).is(":visible")},createHint:function(t,e){if(this.options.hint=t,this.rendered){var i=this,n=this.cmpEl,o=n.closest(".asc-window"),s=o.length>0?parseInt(o.css("z-index"))+10:void 0;if(!this.btnEl)if("object"==typeof this.options.hint&&this.options.hint.length>1&&$("button",n).length>0){var a=$("button",n);this.btnEl=$(a[0]),this.btnMenuEl=$(a[1])}else this.btnEl=n;var r=this.btnEl.data("bs.tooltip");if(r&&r.updateTitle("string"==typeof t?t:t[0]),this.btnMenuEl&&(r=this.btnMenuEl.data("bs.tooltip"))&&r.updateTitle(t[1]),!this._isTooltipInited){if(this.delayRenderHint?(this.btnEl.one("mouseenter",(function(){i.btnEl.tooltip({html:!!e,title:"string"==typeof i.options.hint?i.options.hint:i.options.hint[0],placement:i.options.hintAnchor||"cursor",zIndex:s,container:i.options.hintContainer}),!Common.Utils.isGecko&&(i.btnEl.data("bs.tooltip").enabled=!i.disabled),i.btnEl.mouseenter()})),this.btnMenuEl&&this.btnMenuEl.one("mouseenter",(function(){i.btnMenuEl.tooltip({html:!!e,title:i.options.hint[1],placement:i.options.hintAnchor||"cursor",zIndex:s,container:i.options.hintContainer}),!Common.Utils.isGecko&&(i.btnMenuEl.data("bs.tooltip").enabled=!i.disabled),i.btnMenuEl.mouseenter()}))):(this.btnEl.tooltip({html:!!e,title:"string"==typeof this.options.hint?this.options.hint:this.options.hint[0],placement:this.options.hintAnchor||"cursor",zIndex:s,container:this.options.hintContainer}),this.btnMenuEl&&this.btnMenuEl.tooltip({html:!!e,title:this.options.hint[1],placement:this.options.hintAnchor||"cursor",zIndex:s,container:this.options.hintContainer})),o.length>0){var l=function(t){if(o[0]===t.$window[0]){var e=i.btnEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),i.btnMenuEl&&(e=i.btnMenuEl.data("bs.tooltip"))&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),Common.NotificationCenter.off({"modal:close":l})}};Common.NotificationCenter.on({"modal:close":l})}this._isTooltipInited=!0}}},updateHint:function(t,e){if(this.options.hint=t,this.rendered){if(this.createHint(t,e),this.disabled||!Common.Utils.isGecko){var i=this.btnEl.data("bs.tooltip");i&&(this.disabled&&i.hide(),!Common.Utils.isGecko&&(i.enabled=!this.disabled)),this.btnMenuEl&&(i=this.btnMenuEl.data("bs.tooltip"))&&(this.disabled&&i.hide(),!Common.Utils.isGecko&&(i.enabled=!this.disabled))}if(!this.caption){var n=this.cmpEl;($("button",n).length>0?$("button",n):n).attr("aria-label","string"==typeof t?t:t[0])}}},setCaption:function(t){if(this.caption!=t){var i=!1;if(/icon-top/.test(this.options.cls)&&this.caption&&/huge/.test(this.options.cls)){var n=this.getCaptionWithBreaks(t);this.caption=n||t,i=!0}else this.caption=t;if(this.rendered){var o=this.cmpEl.find(".caption");o.length>0?o.html(i&&(this.split||this.menu)?_.template(e)({caption:this.caption}):this.caption):this.cmpEl.find("button:first").addBack().filter("button").html(this.caption)}}},setMenu:function(t){t&&_.isObject(t)&&_.isFunction(t.render)&&(this.menu=t,this.rendered&&(this.menu.render(this.cmpEl),this.options.canFocused&&this.attachKeyEvents()),this.trigger("menu:created",this))},attachKeyEvents:function(){var t=this;if(t.menu&&t.menu.rendered&&t.cmpEl){var e=$("button",t.cmpEl);!t.split&&e.addClass("move-focus"),t.menu.on("keydown:before",(function(i,n){if((n.keyCode===Common.UI.Keys.DOWN||n.keyCode===Common.UI.Keys.SPACE)&&!t.isMenuOpen())return $(e[t.split?1:0]).click(),n.preventDefault(),n.stopPropagation(),!1})),t.options.takeFocusOnClose&&t.menu.on("hide:after",(function(){setTimeout((function(){t.focus()}),1)}))}},applyScaling:function(t){const e=this;if(e.options.scaling!=t)if(e.options.scaling=t,t>2){const t=e.$el.is("button")?e.$el:e.$el.find("button:first");if(!t.find("svg.icon").length){const i=e.iconCls||t.find("i.icon").attr("class"),n=/btn-[^\s]+/.exec(i),o=n?n[0]:"null",s=(i?i.indexOf("icon-rtl"):-1)>-1?"icon-rtl":"",a='<svg class="icon %rtlCls"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",o).replace("%rtlCls",s);t.find("i.icon").after(a)}}else if(!e.$el.find("i.icon")){const t='<i class="icon %cls">&nbsp;</i>'.replace("%cls",e.iconCls);e.$el.find("svg.icon").after(t)}},isMenuOpen:function(){return this.cmpEl&&this.cmpEl.hasClass("open")},focus:function(){this.split?this.cmpEl.focus():this.$el&&this.$el.find("button").addBack().filter("button").focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),this.disabled||(this.split?this.cmpEl.attr("tabindex",this.tabindex):this.$el&&this.$el.find("button").addBack().filter("button").attr("tabindex",this.tabindex)))},onThemeChanged:function(){if(this.rendered){var t=this.cmpEl;if(this.options.width>0)t&&t.hasClass("btn-group")&&t.hasClass("split")&&$("button:first",t).css("width",this.options.width-$("[data-toggle^=dropdown]",t).outerWidth());else if(t&&this.caption&&/icon-top/.test(this.options.cls)&&/huge/.test(this.options.cls)){var i=t.find(".caption");i.length>0&&i.html(this.split||this.menu?_.template(e)({caption:this.caption}):this.caption)}}}}),Common.UI.ButtonCustom=Common.UI.Button.extend(_.extend({initialize:function(t){t.iconCls="icon-custom "+(t.iconCls||""),Common.UI.Button.prototype.initialize.call(this,t),this.baseUrl=t.baseUrl||"",this.iconsSet=Common.UI.iconsStr2IconsObj(t.iconsSet||[""]);var e=Common.UI.getSuitableIcons(this.iconsSet);this.iconNormalImg=this.baseUrl+e.normal,this.iconActiveImg=this.baseUrl+e.active},render:function(t){Common.UI.Button.prototype.render.call(this,t);var e=!1,i=this;this.cmpButtonFirst=$("button:first",this.$el||$(this.el));const n=function(t,n){var o=i.cmpButtonFirst.hasClass("active")||i.cmpButtonFirst.is(":active");o!==e&&(i.updateIcon(),e=o)};this.cmpButtonFirst[0]&&new MutationObserver(n).observe(this.cmpButtonFirst[0],{attributes:!0,attributeFilter:["class"]});var o=function(t){n(),$(document).off("mouseup",o)};this.cmpButtonFirst.on("mousedown",_.bind((function(t){n(),$(document).on("mouseup",o)}),this)),this.updateIcon(),Common.NotificationCenter.on("uitheme:changed",this.updateIcons.bind(this))},updateIcons:function(){var t=Common.UI.getSuitableIcons(this.iconsSet);this.iconNormalImg=this.baseUrl+t.normal,this.iconActiveImg=this.baseUrl+t.active,this.updateIcon()},updateIcon:function(){this.$icon&&this.$icon.css({"background-image":"url("+(this.cmpButtonFirst&&(this.cmpButtonFirst.hasClass("active")||this.cmpButtonFirst.is(":active"))?this.iconActiveImg:this.iconNormalImg)+")"})},applyScaling:function(t){this.options.scaling!==t&&(this.options.scaling=t,this.updateIcons())}},Common.UI.ButtonCustom||{})),Common.UI.GroupedButtons=function(t,e){let i=t,n=t&&t.length>0&&t[0].cmpEl?t[0].cmpEl.parent():null;n.addClass("grouped-buttons"),e&&(e.underline&&n.addClass("underline"),e.flat&&n.addClass("flat"));let o=function(){let t,e;i&&i.forEach((function(i){!t&&i.isVisible()?(t=!0,i.cmpEl.addClass("first")):i.cmpEl.removeClass("first"),i.cmpEl.removeClass("last"),i.isVisible()&&(e=i)})),e&&e.cmpEl.addClass("last")};return i&&i.forEach((function(t){t.options.signals=t.options.signals||[],t.options.signals.push("visible"),t.on("visible",o)})),o(),{update:o}}})),define("text!common/main/lib/template/Chat.template",[],(function(){return'<div id="chat-box" class="layout-ct vbox">\r\n    <div id="chat-users" class="layout-item area">\r\n        <div id="chat-user-ct"></div>\r\n    </div>\r\n    <div id="chat-messages" class="layout-item area">\r\n        <div id="chat-message-ct"></div>\r\n    </div>\r\n    <div id="chat-options" class="layout-item">\r\n        <div id="chat-options-ct">\r\n            <textarea id="chat-msg-text" class="user-select textarea-control" maxlength="<%=maxMsgLength%>" data-hint="1" data-hint-direction="left-top" placeholder="<%=textEnterMessage%>" aria-label="<%=textEnterMessage%>"></textarea>\r\n            <button id="chat-msg-btn-add" class="btn normal dlg-btn primary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%=scope.textSend%></button>\r\n        </div>\r\n    </div>\r\n    <div id="chat-header" class="">\r\n            <label role="heading"><%=textChat%></label>\r\n            <div id="chat-btn-close" class="float-right margin-left-4"></div>\r\n        </div>\r\n</div>'})),define("common/main/lib/util/utils",[],(function(){function _extend_object(t,e){return"undefined"!=typeof _?_.extend({},t,e):Object?Object.assign({},t,e):e}void 0===window.Common&&(window.Common={}),void 0===Common.Utils&&(Common.Utils={});var utils=new function(){var t=navigator.userAgent.toLowerCase(),e=function(e){return e.test(t)},i="CSS1Compat"==document.compatMode,n=function(e,i){var n;return e&&(n=i.exec(t))?parseFloat(n[1]):0},o=document.documentMode,s=(e(/edge/),e(/opera/)),a=s&&e(/version\/10\.5/),r=!s&&(e(/msie/)||e(/trident/)||e(/edge/)),l=r&&(e(/msie 7/)&&8!=o&&9!=o&&10!=o||7==o),c=r&&(e(/msie 8/)&&7!=o&&9!=o&&10!=o||8==o),h=r&&(e(/msie 9/)&&7!=o&&8!=o&&10!=o||9==o),d=r&&(e(/msie 10/)&&7!=o&&8!=o&&9!=o||10==o),u=r&&(e(/trident\/7\.0/)&&7!=o&&8!=o&&9!=o&&10!=o||11==o),m=r&&e(/msie 6/),p=!r&&e(/\bchrome\b/),f=!r&&e(/webkit/),g=!r&&!p&&e(/safari/),b=g&&e(/applewebkit\/4/),v=g&&e(/version\/3/),C=g&&e(/version\/4/),w=g&&e(/version\/5\.0/),y=g&&e(/version\/5/),x=!f&&!r&&e(/gecko/),_=x&&e(/rv:1\.9/),k=x&&e(/rv:2\.0/),I=x&&e(/rv:5\./),S=x&&e(/rv:10\./),E=_&&e(/rv:1\.9\.0/),T=_&&e(/rv:1\.9\.1/),M=_&&e(/rv:1\.9\.2/),A=e(/windows|win32/),U=e(/macintosh|mac os x/),D=e(/linux/),P=n(!0,/\bchrome\/(\d+\.\d+)/),L=n(!0,/\bfirefox\/(\d+\.\d+)/),O=n(r,/msie (\d+\.\d+)/),R=n(s,/version\/(\d+\.\d+)/),F=n(g,/version\/(\d+\.\d+)/),B=n(f,/webkit\/(\d+\.\d+)/),V=/^https/i.test(window.location.protocol),H=(/android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera),void 0),N=this,z=function(){var t={};if(window.AscCommon&&window.AscCommon.checkDeviceScale)t=window.AscCommon.checkDeviceScale(),AscCommon.correctApplicationScale(t);else{const e="screen and (-webkit-min-device-pixel-ratio: 2.25), screen and (min-resolution: 2.25dppx), screen and (min-resolution: 216dpi)";window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.25) and (-webkit-max-device-pixel-ratio: 1.49), screen and (min-resolution: 1.25dppx) and (max-resolution: 1.49dppx)").matches?t.devicePixelRatio=1.25:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5) and (-webkit-max-device-pixel-ratio: 1.74), screen and (min-resolution: 1.5dppx) and (max-resolution: 1.74dppx)").matches?t.devicePixelRatio=1.5:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.75) and (-webkit-max-device-pixel-ratio: 1.99), screen and (min-resolution: 1.75dppx) and (max-resolution: 1.99dppx)").matches?t.devicePixelRatio=1.75:window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2), screen and (min-resolution: 2dppx), screen and (min-resolution: 192dpi)").matches?t.devicePixelRatio=2:t.devicePixelRatio=1,window.matchMedia(e).matches&&(t.devicePixelRatio=2.25)}$(document.body);var e=document.body.className,i=e.replace(/pixel-ratio__[\w-]+/gi,"").trim();t.devicePixelRatio<1.25?/pixel-ratio__/.test(e)&&(document.body.className=i):t.devicePixelRatio<1.5?/pixel-ratio__1_25/.test(e)||(document.body.className=i+" pixel-ratio__1_25"):t.devicePixelRatio<1.75?/pixel-ratio__1_5/.test(e)||(document.body.className=i+" pixel-ratio__1_5"):!(t.devicePixelRatio<1.75)&&t.devicePixelRatio<2?/pixel-ratio__1_75/.test(e)||(document.body.className=i+" pixel-ratio__1_75"):!(t.devicePixelRatio<2)&&t.devicePixelRatio<2.25?/pixel-ratio__2\b/.test(e)||(document.body.className=i+" pixel-ratio__2"):/pixel-ratio__2_5/.test(e)||(document.body.className=i+" pixel-ratio__2_5"),N.zoom=t.correct?t.zoom:1,N.innerWidth=window.innerWidth*N.zoom,N.innerHeight=window.innerHeight*N.zoom,N.applicationPixelRatio=t.applicationPixelRatio||t.devicePixelRatio,N.innerWidth<1&&void 0===H?H=!0:H&&N.innerWidth>0&&(H=!1,jQuery.support&&jQuery.support.forceStyleTests(),Common.NotificationCenter.trigger("app:repaint"))},j=function(){return!!(p&&128<=P)&&1!==N.zoom},W=function(t){let e=t.offset();return j()?{left:e.left*N.zoom,top:e.top*N.zoom}:e},q=function(t){let e=t.position();return j()?{left:e.left*N.zoom,top:e.top*N.zoom}:e};return N.zoom=1,N.applicationPixelRatio=1,N.innerWidth=window.innerWidth,N.innerHeight=window.innerHeight,r?($(document.body).addClass("ie"),$(window).on("resize",(function(){N.innerWidth=window.innerWidth,N.innerHeight=window.innerHeight}))):(z(),$(window).on("resize",z)),{checkSize:z,userAgent:t,isStrict:i,isIEQuirks:r&&!i&&(m||l||c||h),isOpera:s,isOpera10_5:a,isWebKit:f,isChrome:p,isSafari:g,isSafari3:v,isSafari4:C,isSafari5:y,isSafari5_0:w,isSafari2:b,isIE:r,isIE6:m,isIE7:l,isIE7m:m||l,isIE7p:r&&!m,isIE8:c,isIE8m:m||l||c,isIE8p:r&&!(m||l),isIE9:h,isIE9m:m||l||c||h,isIE9p:r&&!(m||l||c),isIE10:d,isIE10m:m||l||c||h||d,isIE10p:r&&!(m||l||c||h),isIE11:u,isIE11m:m||l||c||h||d||u,isIE11p:r&&!(m||l||c||h||d),isGecko:x,isGecko3:_,isGecko4:k,isGecko5:I,isGecko10:S,isFF3_0:E,isFF3_5:T,isFF3_6:M,isFF4:4<=L&&L<5,isFF5:5<=L&&L<6,isFF10:10<=L&&L<11,isLinux:D,isWindows:A,isMac:U,chromeVersion:P,firefoxVersion:L,ieVersion:O,operaVersion:R,safariVersion:F,webKitVersion:B,isSecure:V,emailRe:/^(mailto:)?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%+-=\? :&]*)/i,ipRe:/^(((https?)|(ftps?)):\/\/)?([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?/i,hostnameRe:/^(((https?)|(ftps?)):\/\/)?([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(([\-\wÐ°-ÑÑ]+\.)+[\wÐ°-ÑÑ\-]{2,}(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/i,localRe:/^(((https?)|(ftps?)):\/\/)([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?(([\-\wÐ°-ÑÑ]+)(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`'~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/i,emailStrongRe:/(mailto:)?([a-z0-9'\.\+_-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%+-=\?:&]*)/gi,emailAddStrongRe:/(mailto:|\s[@]|\s[+])?([a-z0-9'\._-]+@[a-z0-9\.-]+\.[a-z0-9]{2,4})([a-ÑÑ0-9\._%\+-=\?:&]*)/gi,ipStrongRe:/(((https?)|(ftps?)):\/\/([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?/gi,hostnameStrongRe:/((((https?)|(ftps?)):\/\/([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?)|(([\-\wÐ°-ÑÑ]*:?[\-\wÐ°-ÑÑ]*@)?www\.))((([\-\wÐ°-ÑÑ]+\.)+[\wÐ°-ÑÑ\-]{2,}|([\-\wÐ°-ÑÑ]+))(:\d+)?(\/[%\-\wÐ°-ÑÑ]*(\.[\wÐ°-ÑÑ]{2,})?(([\wÐ°-ÑÑ\-\.\?\\\/\+@&#;:`~=%!,\(\)]*)(\.[\wÐ°-ÑÑ]{2,})?)*)*\/?)/gi,documentSettingsType:{Paragraph:0,Table:1,Header:2,TextArt:3,Shape:4,Image:5,Slide:6,Chart:7,MailMerge:8,Signature:9,Pivot:10,Cell:11,Slicer:12,Form:13},importTextType:{DRM:0,CSV:1,TXT:2,Paste:3,Columns:4,Data:5},zoom:function(){return N.zoom},applicationPixelRatio:function(){return N.applicationPixelRatio},topOffset:0,innerWidth:function(){return N.innerWidth},innerHeight:function(){return N.innerHeight},croppedGeometry:function(){return{left:0,top:Common.Utils.InternalSettings.get("window-inactive-area-top"),width:N.innerWidth,height:N.innerHeight-Common.Utils.InternalSettings.get("window-inactive-area-top")}},getBoundingClientRect:function(t){let e=t.getBoundingClientRect();if(!j())return e;let i=N.zoom,n={};return void 0!==e.x&&(n.x=e.x*i),void 0!==e.y&&(n.y=e.y*i),void 0!==e.width&&(n.width=e.width*i),void 0!==e.height&&(n.height=e.height*i),void 0!==e.left&&(n.left=e.left*i),void 0!==e.top&&(n.top=e.top*i),void 0!==e.right&&(n.right=e.right*i),void 0!==e.bottom&&(n.bottom=e.bottom*i),n},getOffset:W,setOffset:function(t,e){var i,n,o,s,a,r,l=t.css("position"),c={};return"static"===l&&(t[0].style.position="relative"),a=W(t),o=t.css("top"),r=t.css("left"),("absolute"===l||"fixed"===l)&&(o+r).indexOf("auto")>-1?(s=(i=q(t)).top,n=i.left):(s=parseFloat(o)||0,n=parseFloat(r)||0),null!=e.top&&(c.top=e.top-a.top+s),null!=e.left&&(c.left=e.left-a.left+n),t.css(c),t},getPosition:q}};Common.Utils=_extend_object(Common.Utils,utils);var themecolor=new function(){var t=!0;return{txtBlack:"Black",txtWhite:"White",txtRed:"Red",txtGreen:"Green",txtBlue:"Blue",txtYellow:"Yellow",txtPurple:"Purple",txtAqua:"Aqua",txtDarkRed:"Dark red",txtDarkGreen:"Dark green",txtDarkBlue:"Dark blue",txtDarkYellow:"Dark yellow",txtDarkPurple:"Dark purple",txtDarkTeal:"Dark teal",txtLightGray:"Light gray",txtGray:"Gray",txtLightBlue:"Light blue",txtPink:"Pink",txtLightYellow:"Light yellow",txtSkyBlue:"Sky blue",txtRose:"Rose",txtTurquosie:"Turquosie",txtLightGreen:"Light green",txtLavender:"Lavender",txtLightOrange:"Light orange",txtTeal:"Teal",txtGold:"Gold",txtOrange:"Orange",txtIndigo:"Indigo",txtBrown:"Brown",txtDarkGray:"Dark gray",txtbackground:"Background",txttext:"Text",txtaccent:"Accent",txtDarker:"Darker",txtLighter:"Lighter",txtBrightGreen:"Bright green",txtViolet:"Violet",ThemeValues:[6,15,7,16,0,1,2,3,4,5],getTranslation:function(t){return t?this["txt"+t.replace(" ","")]||t:""},getEffectTranslation:function(t){return 0!==(t=parseInt(100*t))?(t>0?this.txtLighter:this.txtDarker)+" "+Math.abs(t)+"%":""},setColors:function(e,i){if(t){for(var n=1;n<3;n++)this["txtbackground"+n]=this.txtbackground+" "+n,this["txttext"+n]=this.txttext+" "+n;for(n=1;n<7;n++)this["txtaccent"+n]=this.txtaccent+" "+n;t=!1}var o,s;if(i&&i.length>0){var a=[];for(n=0;n<i.length;n++)s={color:this.getHexColor(i[n].get_r(),i[n].get_g(),i[n].get_b()),tip:this.getTranslation(i[n].asc_getName())},a.push(s);this.standartcolors=a}var r=[];for(n=0;n<6;n++)for(o=0;o<10;o++){var l=n+6*o,c=this.getTranslation(e[l].asc_getName()),h=this.getTranslation(e[l].asc_getNameInColorScheme()),d=this.getEffectTranslation(e[l].asc_getEffectValue());c&&(h&&(c+=Common.Utils.String.textComma+" "+h),d&&(c+=Common.Utils.String.textComma+" "+d)),s={color:this.getHexColor(e[l].get_r(),e[l].get_g(),e[l].get_b()),effectId:l,effectValue:this.ThemeValues[o],tip:c},r.push(s)}this.effectcolors=r},getEffectColors:function(){return this.effectcolors},getStandartColors:function(){return this.standartcolors},getHexColor:function(t,e,i){return t=t.toString(16),e=e.toString(16),i=i.toString(16),1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),t+e+i},getRgbColor:function(t){var e="object"==typeof t?t.color:t;3==(e=e.replace(/#/,"")).length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16);var i=new Asc.asc_CColor;return i.put_type("object"==typeof t&&void 0!==t.effectId?Asc.c_oAscColor.COLOR_TYPE_SCHEME:Asc.c_oAscColor.COLOR_TYPE_SRGB),i.put_r(e>>16),i.put_g((65280&e)>>8),i.put_b(255&e),i.put_a(255),void 0!==t.effectId&&i.put_value(t.effectId),i},colorValue2EffectId:function(t){if("object"==typeof t&&t&&void 0!==t.effectValue&&this.effectcolors)for(var e=0;e<this.effectcolors.length;e++)if(this.effectcolors[e].effectValue===t.effectValue&&t.color.toUpperCase()===this.effectcolors[e].color.toUpperCase()){t.effectId=this.effectcolors[e].effectId;break}return t},selectPickerColorByEffect:function(t,e){if(t)if("object"==typeof t){for(var i=!1,n=0;n<10;n++)if(Common.Utils.ThemeColor.ThemeValues[n]==t.effectValue){e.select(t,!0),i=!0;break}i||e.clearSelection()}else e.select(t,!0);else e.clearSelection()}}};Common.Utils.ThemeColor=_extend_object(themecolor,Common.Utils.ThemeColor);var metrics=new function(){var t=this;return t.c_MetricUnits={cm:0,pt:1,inch:2},t.currentMetric=t.c_MetricUnits.pt,t.metricName=["Cm","Pt","Inch"],t.defaultMetric=t.c_MetricUnits.cm,{c_MetricUnits:t.c_MetricUnits,txtCm:"cm",txtPt:"pt",txtInch:'"',setCurrentMetric:function(e){t.currentMetric=e},getCurrentMetric:function(){return t.currentMetric},getCurrentMetricName:function(){return this["txt"+t.metricName[t.currentMetric]]},getMetricName:function(e){return this["txt"+t.metricName[void 0!==e?e:0]]},setDefaultMetric:function(e){t.defaultMetric=e},getDefaultMetric:function(){return t.defaultMetric},fnRecalcToMM:function(e){if(null!=e)switch(t.currentMetric){case t.c_MetricUnits.cm:return 10*e;case t.c_MetricUnits.pt:return 25.4*e/72;case t.c_MetricUnits.inch:return 25.4*e}return e},fnRecalcFromMM:function(e){switch(t.currentMetric){case t.c_MetricUnits.cm:return parseFloat((e/10).toFixed(4));case t.c_MetricUnits.pt:return parseFloat((72*e/25.4).toFixed(3));case t.c_MetricUnits.inch:return parseFloat((e/25.4).toFixed(3))}return e}}};Common.Utils.Metric=_extend_object(metrics,Common.Utils.Metric),Common.Utils.RGBColor=function(t){var e,i,n;"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^hsb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e={},i=Math.round(t[1]),n=Math.round(255*t[2]/100),o=Math.round(255*t[3]/100);if(0==n)e.r=e.g=e.b=o;else{var s=o,a=(255-n)*o/255,r=i%60*(s-a)/60;360==i&&(i=0),i<60?(e.r=s,e.b=a,e.g=a+r):i<120?(e.g=s,e.b=a,e.r=s-r):i<180?(e.g=s,e.r=a,e.b=a+r):i<240?(e.b=s,e.r=a,e.g=s-r):i<300?(e.b=s,e.g=a,e.r=a+r):i<360?(e.r=s,e.g=a,e.b=s-r):(e.r=0,e.g=0,e.b=0)}return[Math.round(e.r),Math.round(e.g),Math.round(e.b)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],s=0;s<o.length;s++){var a=o[s].re,r=o[s].process,l=a.exec(t);if(l){var c=r(l);e=c[0],i=c[1],n=c[2]}}e=e<0||isNaN(e)?0:e>255?255:e,i=i<0||isNaN(i)?0:i>255?255:i,n=n<0||isNaN(n)?0:n>255?255:n;return{r:e,g:i,b:n,isEqual:function(t){return e==t.r&&i==t.g&&n==t.b},toRGB:function(){return"rgb("+e+", "+i+", "+n+")"},toRGBA:function(t){return void 0===t&&(t=1),"rgba("+e+", "+i+", "+n+", "+t+")"},toHex:function(){var t=e.toString(16),o=i.toString(16),s=n.toString(16);return 1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),"#"+t+o+s},toHSB:function(){var t={h:0,s:0,b:0},o=Math.min(e,i,n),s=Math.max(e,i,n),a=s-o;return t.b=s,t.s=0!=s?255*a/s:0,0!=t.s?t.h=e==s?0+(i-n)/a:i==s?2+(n-e)/a:4+(e-i)/a:t.h=0,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t.h=parseInt(t.h),t.s=parseInt(t.s),t.b=parseInt(t.b),t},isDark:function(){return Math.sqrt(e*e*.299+i*i*.587+n*n*.114)<140}}};var utilsString=new function(){return{textCtrl:"Ctrl",textShift:"Shift",textAlt:"Alt",textComma:",",format:function(t){var e=_.toArray(arguments).slice(1);return e.length&&"object"==typeof e[0]&&(e=e[0]),t.replace(/\{(\d+)\}/g,(function(t,i){return e[i]}))},htmlEncode:function(t){return"undefined"!=typeof _?_.escape(t):t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},htmlDecode:function(t){return _.unescape(t)},ellipsis:function(t,e,i){if(t&&t.length>e){if(i){var n=t.substr(0,e-2),o=Math.max(n.lastIndexOf(" "),n.lastIndexOf("."),n.lastIndexOf("!"),n.lastIndexOf("?"));if(-1!==o&&o>=e-15)return n.substr(0,o)+"..."}return t.substr(0,e-3)+"..."}return t},platformKey:function(t,e,i){return _.isEmpty(e)&&(e=" ({0})"),Common.Utils.isMac?(_.isFunction(i)&&(t=i.call(this,t)),Common.Utils.String.format(e,t.replace(/\+(?=\S)/g,"").replace(/Ctrl|ctrl/g,"â").replace(/Alt|alt/g,"â¥").replace(/Shift|shift/g,"â§"))):Common.Utils.String.format(e,t.replace(/Ctrl|ctrl/g,this.textCtrl).replace(/Alt|alt/g,this.textAlt).replace(/Shift|shift/g,this.textShift))},parseFloat:function(t){return"string"==typeof t&&(t=t.replace(",",".")),parseFloat(t)},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedDigits:function(t,e,i){void 0===i&&(i="0");for(var n="",o=t.toString(),s=o.length;s<e;s++)n+=i;return n+o}}};Common.Utils.String=_extend_object(utilsString,Common.Utils.String),Common.Utils.isBrowserSupported=function(){return!(0!=Common.Utils.ieVersion&&Common.Utils.ieVersion<10||0!=Common.Utils.safariVersion&&Common.Utils.safariVersion<5||0!=Common.Utils.firefoxVersion&&Common.Utils.firefoxVersion<4||0!=Common.Utils.chromeVersion&&Common.Utils.chromeVersion<7||0!=Common.Utils.operaVersion&&Common.Utils.operaVersion<10.5)},Common.Utils.showBrowserRestriction=function(){if(!(document.getElementsByClassName&&document.getElementsByClassName("app-error-panel").length>0)){var t=window.DE?"Document":window.SSE?"Spreadsheet":window.PE?"Presentation":window.PDFE?"PDF":window.VE?"Visio":"that",e=document.createElement("div");e.innerHTML='<div class="app-error-panel"><div class="message-block"><div class="message-inner"><div class="title">Your browser is not supported.</div><div class="text">Sorry, '+t+' Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div></div></div><div class="message-auxiliary"></div></div>',document.body.appendChild(e),$("#loading-mask").hide().remove(),$("#viewport").hide().remove()}},Common.Utils.applyCustomization=function(t,e){for(var i in t){var n;if(e[i]&&(n=$(e[i])).length){var o=t[i];!1===o||!1===o.visible?n.hide():(o.text&&n.text(o.text),!1===o.visible&&n.hide())}}},Common.Utils.applyCustomizationPlugins=function(plugins){if(plugins&&!(plugins.length<1)){var _createXMLHTTPObject=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},_getPluginCode=function(url){if(!url)return"";try{var xhrObj=_createXMLHTTPObject();xhrObj&&url&&(xhrObj.open("GET",url,!1),xhrObj.send(""),200==xhrObj.status&&eval(xhrObj.responseText))}catch(t){}return null};plugins.forEach((function(t){t&&_getPluginCode(t)}))}},Common.Utils.fillUserInfo=function(t,e,i,n){var o=t||{};return o.anonymous=!o.id,!o.id&&(o.id=n),o.fullname=o.name?o.name:i,o.group&&(o.fullname=o.group.toString()+AscCommon.UserInfoParser.getSeparator()+o.fullname),o.guest=!o.name,o},Common.Utils.createXhr=function(){var t;if("undefined"!=typeof XMLHttpRequest)t=new XMLHttpRequest;else try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t},Common.Utils.getConfigJson=function(t){if(t)try{var e=Common.Utils.createXhr();if(e)return e.open("GET",t,!1),e.send(""),JSON.parse(e.responseText)}catch(t){}return null},Common.Utils.loadConfig=function(t,e){fetch(t,{method:"get",headers:{Accept:"application/json"}}).then((function(t){return t.ok?t.json():"error"})).then((function(t){e(t)})).catch((function(t){e("error")}))},Common.Utils.asyncCall=function(t,e,i){new Promise((function(t,e){t()})).then((function(){t.call(e,i)}))},String.prototype.strongMatch=function(t){if(t&&t instanceof RegExp){var e=this.toString().match(t);return!!(e&&e.length>0&&e[0].length==this.length)}return!1},Common.Utils.InternalSettings=new function(){var t={};return{get:function(e){return t[e]},set:function(e,i){t[e]=i}}},Common.Utils.lockControls=function(t,e,i,n){!i&&(i={});var o=i.array||n;function s(t,i){if(t&&t.options&&_.contains(t.options.lock,i)){var n=t.keepState.indexOf(i);e?n<0&&t.keepState.push(i):n<0||t.keepState.splice(n,1)}}i.merge&&(o=_.union(n,o)),_.each(o,(function(e){e&&_.isFunction(e.setDisabled)&&(!e.keepState&&(e.keepState=[]),i.clear&&i.clear.length>0&&e.keepState.length>0&&(e.keepState=_.difference(e.keepState,i.clear)),_.isArray(t)?_.each(t,(function(t){s(e,t)})):s(e,t),e.keepState.length>0?!e.isDisabled()&&e.setDisabled(!0):e.isDisabled()&&e.setDisabled(!1))}))},Common.Utils.injectButtons=function(t,e,i,n,o,s,a,r,l,c,h,d,u){var m=createButtonSet();return m.setDisabled(!0),e=e||"id-toolbar-"+i,t.each((function(p,f){var g="btn-toolbar";/x-huge/.test(f.className)&&(g+=" x-huge icon-top");var b=new Common.UI.Button({parentEl:t.eq(p),id:e+p,cls:g,iconCls:i,caption:n,split:s||!1,menu:a||!1,enableToggle:r||!1,lock:o,disabled:!0,action:u,dataHint:l,dataHintDirection:c,dataHintOffset:h,dataHintTitle:d});m.add(b)})),m},Common.Utils.injectComponent=function(t,e){e&&t.length&&(e.rendered?t.append(e.$el):e.render(t))},Common.Utils.startFullscreenForElement=function(t){t&&(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen())},Common.Utils.cancelFullscreen=function(){(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)&&(document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())},Common.Utils.warningDocumentIsLocked=function(t){t.disablefunc&&t.disablefunc(!0);var e=window.DE||window.PE||window.SSE||window.PDFE||window.VE;Common.UI.warning({msg:Common.Locale.get("warnFileLocked",{name:"Common.Translation",default:"You can't edit this file. Document is in use by another application."}),buttons:[{value:"view",caption:Common.Locale.get("warnFileLockedBtnView",{name:"Common.Translation",default:"Open for viewing"})},{value:"edit",caption:Common.Locale.get("warnFileLockedBtnEdit",{name:"Common.Translation",default:"Create a copy"})}],primary:"view",callback:function(i){"edit"==i&&(t.disablefunc&&t.disablefunc(!1),e.getController("Main").api.asc_setLocalRestrictions(Asc.c_oAscLocalRestrictionType.None))}})},jQuery.fn.extend({elementById:function(t,e){var i=document.getElementById(t.substring(1));if(!i)if((e=e||this)&&e.length>0)e.each((function(e,n){if(n.querySelectorAll)if(0==(i=n.querySelectorAll(t)).length){if("#"+n.id==t)return i=n,!1}else if(i.length)return i=i[0],!1}));else if(e&&e.querySelectorAll&&(i=e.querySelectorAll(t))&&i.length)return i[0];return i},findById:function(t,e){var i=$.fn.elementById.apply(this,arguments);return i?$(i):$()}}),Common.Utils.InternalSettings.set("toolbar-height-tabs",32),Common.Utils.InternalSettings.set("toolbar-height-tabs-top-title",28),Common.Utils.InternalSettings.set("toolbar-height-controls",parseInt(window.getComputedStyle(document.body).getPropertyValue("--toolbar-height-controls")||(Common.Utils.isIE?66:84))),Common.Utils.InternalSettings.set("document-title-height",28),Common.Utils.InternalSettings.set("window-inactive-area-top",0),Common.Utils.InternalSettings.set("toolbar-height-compact",Common.Utils.InternalSettings.get("toolbar-height-tabs")),Common.Utils.InternalSettings.set("toolbar-height-normal",Common.Utils.InternalSettings.get("toolbar-height-tabs")+Common.Utils.InternalSettings.get("toolbar-height-controls")),Common.Utils.ModalWindow=new function(){var t=0;return{show:function(){t++},close:function(){t--},isVisible:function(){return t>0}}},Common.Utils.UserInfoParser=new function(){var t=!1,e=String.fromCharCode(160);return{setParser:function(e){t=!!e},getSeparator:function(){return e},getParsedName:function(i){return t&&i?i.substring(i.indexOf(e)+1):i},getParsedGroups:function(i){if(t&&i){for(var n=i.indexOf(e),o=n>-1?i.substring(0,n).split(","):[],s=0;s<o.length;s++)o[s]=o[s].trim();return o}}}},Common.Utils.getUserInitials=function(t){for(var e=t.split(" "),i=e[0].substring(0,1).toUpperCase(),n=e.length-1;n>0;n--)if("("!==e[n][0]&&")"!==e[n][0]){/[\u0600-\u06FF]/.test(i)&&(i+="â"),i+=e[n].substring(0,1).toUpperCase();break}return i},Common.Utils.getKeyByValue=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i},Common.Utils.checkComponentLoaded=function(t){return"function"==typeof t},!Common.UI&&(Common.UI={}),Common.UI.isRTL=function(){return void 0===window.isrtl&&(window.nativeprocvars&&void 0!==window.nativeprocvars.rtl?window.isrtl=window.nativeprocvars.rtl:window.isrtl=!Common.Utils.isIE&&Common.Locale.isCurrentLanguageRtl()),window.isrtl},Common.UI.iconsStr2IconsObj=function(t){if("string"!=typeof t)return t;let e={"theme-name":{origin:"",values:[""]},"theme-type":{origin:"",values:[""]},state:{origin:"",values:["normal"]},scale:{origin:"",values:[]},extension:{origin:"",values:[]}},i="",n=function(n){let o=t.indexOf("%"+n+"%");if(-1===o)return;let s=o+n.length+2,a=t.indexOf("(",s);if(a!=s)return;let r=t.indexOf(")",a);e[n].origin=t.substring(o,r+1),e[n].values=t.substring(a+1,r).split("|"),"scale"===n&&o>0&&47==t.charCodeAt(o-1)&&(i="icon")};for(let t in e)n(t);for(let t=0,i=e.scale.values.length;t<i;t++)"default"===e.scale.values[t]&&e.scale.values.splice(t,1,"100","125","150","175","200");let o="",s=!1;for(let t=0,i=e.extension.values.length;t<i;t++)"svg"===e.extension.values[t]?s=!0:o=e.extension.values[t];s&&""===o&&(o="svg");let a=[];for(let n=0,r=e["theme-name"].values.length;n<r;n++){let r=e["theme-name"].values[n];for(let n=0,l=e["theme-type"].values.length;n<l;n++){let l=t,c=e["theme-type"].values[n],h={};""!==r&&(h.theme=r),""!==c&&(h.style=c),""!=e["theme-name"].origin&&(l=l.replaceAll(e["theme-name"].origin,r)),""!=e["theme-type"].origin&&(l=l.replaceAll(e["theme-type"].origin,c));let d=e.scale.values.length;0==d&&(e.scale.values.push("100"),d++);for(let t=0;t<d;t++){let n=e.scale.values[t],a=!1;n.length>0?"*"===n?a=!0:"%"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)):(a=!0,n="*");let r="";if(!a){let t=parseInt(n);if(100!==t){let e=t%100;r="@"+(t/100>>0),0!==e&&(0==e%10&&(e/=10),r+="."+e),r+="x"}n+="%"}let c=l;""!=e.scale.origin&&(c=c.replaceAll(e.scale.origin,i+r)),""!=e.extension.origin&&(c=c.replaceAll(e.extension.origin,a&&s?"svg":o)),h[n]={};for(let t=0,i=e.state.values.length;t<i;t++){let i=e.state.values[t];if(""!==e.state.origin)if("normal"===i){let t=c.indexOf(e.state.origin);h[n][i]=c.replace(e.state.origin,""),"/"==h[n][i].charAt(t)&&(h[n][i]=h[n][i].substring(0,t)+h[n][i].substring(t+1))}else h[n][i]=c.replace(e.state.origin,"_"+i);else h[n][i]=c}}a.push(h)}}return a},Common.UI.getSuitableIcons=function(t){if(t){if((t=Common.UI.iconsStr2IconsObj(t)).length&&"string"!=typeof t[0]){for(var e=Common.UI.Themes.currentThemeId().toLowerCase(),i=Common.UI.Themes.isDarkTheme()?"dark":"light",n=-1,o=0;o<t.length;o++)if(t[o].theme&&t[o].theme.toLowerCase()==e){n=o;break}if(n<0)for(o=0;o<t.length;o++)if(t[o].style&&t[o].style.toLowerCase()==i){n=o;break}n<0&&(n=0);var s,a,r=100*Common.Utils.applicationPixelRatio(),l=t[n],c=1e4,h=0;for(var d in l)l.hasOwnProperty(d)&&("default"==d?s=l[d]:isNaN(parseInt(d))||(h=Math.abs(r-parseInt(d)))<c-.01&&(c=h,a=l[d]));return c>.01&&s&&(a=s),{normal:a?a.normal:"",hover:a?a.hover||a.normal:"",active:a?a.active||a.normal:""}}var u=t[(Common.Utils.applicationPixelRatio()>1&&t.length>1?1:0)+(t.length>2?2:0)];return{normal:u,hover:u,active:u}}},Common.UI.simpleColorsConfig={colors:["1755A0","D43230","F5C346","EA3368","12A489","552F8B","9D1F87","BB2765","479ED2","67C9FA","3D8A44","80CA3D","1C19B4","7F4B0F","FF7E07","FFFFFF","D3D3D4","879397","575757","000000"],dynamiccolors:5,themecolors:0,effects:0,columns:5,cls:"palette-large",paletteWidth:174},Common.UI.isValidNumber=function(t){let e=new RegExp("^s*[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)s*$");if("string"==typeof t){let e=t.match(/,/g);e&&1===e.length&&(t=t.replace(",","."))}return"number"==typeof t||!(""===t||!e.test(t.trim())||isNaN(parseFloat(t)))}})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Chat",["text!common/main/lib/template/Chat.template","common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],(function(t){"use strict";Common.Views.Chat=Common.UI.BaseView.extend(_.extend({el:"#left-panel-chat",template:_.template(t),storeUsers:void 0,storeMessages:void 0,tplUser:['<li id="<%= user.get("iid") %>"<% if (!user.get("online")) { %> class="offline"<% } %>>','<div class="name"><div class="color" style="background-color: <%= user.get("color") %>;" ></div><%= Common.Utils.String.htmlEncode(user.get("parsedName")) %>',"</div>","</li>"].join(""),templateUserList:_.template("<ul><% for (originalId in users) { %><%= _.template(usertpl)({user: users[originalId][0], scope: scope}) %><% } %></ul>"),tplMsg:["<li>",'<% if (msg.get("type")==1) { %>','<div class="message service" data-can-copy="true"><%= msg.get("message") %></div>',"<% } else { %>",'<div class="color"','<% if (msg.get("avatar")) { %>','style="background-image: url(<%=msg.get("avatar")%>); <% if (msg.get("usercolor")!==null) { %> border-color:<%=msg.get("usercolor")%>; border-style:solid;<% }%>"',"<% } else { %>",'style="background-color: <% if (msg.get("usercolor")!==null) { %> <%=msg.get("usercolor")%> <% } else { %> #cfcfcf <% }%>;"',"<% } %>",'><% if (!msg.get("avatar")) { %><%-msg.get("initials")%><% } %></div>','<div class="user-content">','<div class="user-name" data-can-copy="true">','<%= Common.Utils.String.htmlEncode(msg.get("parsedName")) %>',"</div>",'<label class="message user-select" data-can-copy="true" tabindex="-1" oo_editor_input="true"><%= msg.get("message") %></label>',"</div>","<% } %>","</li>"].join(""),templateMsgList:_.template("<ul><% _.each(messages, function(item) { %><%= _.template(msgtpl)({msg: item, scope: scope}) %><% }); %></ul>"),events:{},usersBoxHeight:117,messageBoxHeight:70,addMessageBoxHeight:110,initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments),this.storeUsers.bind({add:_.bind(this._onResetUsers,this),change:_.bind(this._onResetUsers,this),reset:_.bind(this._onResetUsers,this)}),this.storeMessages.bind({add:_.bind(this._onAddMessage,this),reset:_.bind(this._onResetMessages,this)})},render:function(t){return t=t||this.el,$(t).html(this.template({scope:this,maxMsgLength:Asc.c_oAscMaxCellOrCommentLength,textChat:this.textChat,textEnterMessage:this.textEnterMessage})),this.panelBox=$("#chat-box",this.el),this.panelUsers=$("#chat-users",this.el),this.panelMessages=$("#chat-messages",this.el),this.txtMessage=$("#chat-msg-text",this.el),this.panelOptions=$("#chat-options",this.el),this.panelUsers.scroller=new Common.UI.Scroller({el:$("#chat-users"),useKeyboard:!0,minScrollbarLength:25}),this.panelMessages.scroller=new Common.UI.Scroller({el:$("#chat-messages"),includePadding:!0,useKeyboard:!0,minScrollbarLength:40}),this.panelOptions.scroller=new Common.UI.Scroller({el:$("#chat-options")}),this.buttonClose=new Common.UI.Button({parentEl:$("#chat-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),$("#chat-msg-btn-add",this.el).on("click",_.bind(this._onBtnAddMessage,this)),this.txtMessage.on("keydown",_.bind(this._onKeyDown,this)),this.setupLayout(),this.trigger("render:after",this),this},focus:function(){var t=this;_.defer((function(){t.txtMessage.focus()}),100),this.updateLayout(!0),this.setupAutoSizingTextBox()},getFocusElement:function(){return this.txtMessage},_onKeyDown:function(t){t.keyCode==Common.UI.Keys.RETURN&&(!t.ctrlKey&&!t.metaKey||t.altKey||this._onBtnAddMessage(t))},_onResetUsers:function(t,e){this.panelUsers&&(this.panelUsers.html(this.templateUserList({users:this.storeUsers.chain().filter((function(t){return t.get("online")})).groupBy((function(t){return t.get("idOriginal")})).value(),usertpl:this.tplUser,scope:this})),this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}))},_onAddMessage:function(t,e,i){if(this.panelMessages){var n=this.panelMessages.find("ul");n&&n.length&&(this._prepareMessage(t),n.append(_.template(this.tplMsg)({msg:t,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}),this.panelMessages.scroller.scrollTop(Common.Utils.getBoundingClientRect(n.get(0)).height))}},_onResetMessages:function(t,e){this.panelMessages&&(t.each((function(t){this._prepareMessage(t)}),this),this.panelMessages.html(this.templateMsgList({messages:t.models,msgtpl:this.tplMsg,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},renderMessages:function(){this.panelMessages&&this.storeMessages&&(this.panelMessages.html(this.templateMsgList({messages:this.storeMessages.models,msgtpl:this.tplMsg,scope:this})),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},_onBtnAddMessage:function(t){this.txtMessage&&(this.fireEvent("message:add",[this,this.txtMessage.val().trim()]),this.txtMessage.val(""),this.focus())},_prepareMessage:function(t){var e=this.storeUsers.findOriginalUser(t.get("userid")),i=Common.UI.ExternalUsers.getImage(t.get("userid"));t.set({usercolor:e?e.get("color"):Common.UI.ExternalUsers.getColor(t.get("userid")),avatar:i,initials:e?e.get("initials"):Common.Utils.getUserInitials(t.get("parsedName")),message:this._pickLink(t.get("message"))},{silent:!0}),void 0===i&&Common.UI.ExternalUsers.get("info",[t.get("userid")])},_pickLink:function(t){var e,i,n=[];t.replace(Common.Utils.ipStrongRe,(function(t){var i=/[\.,\?\+;:=!\(\)]+$/.exec(t);return i&&(t=t.substring(0,i.index)),e=arguments[arguments.length-2],n.push({start:e,end:t.length+e,str:'<a href="'+t+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),(t.length<1e3||t.search(/\S{255,}/)<0)&&t.replace(Common.Utils.hostnameStrongRe,(function(t){var o=/[\.,\?\+;:=!\(\)]+$/.exec(t);o&&(t=t.substring(0,o.index));var s=/(((^https?)|(^ftp)):\/\/)/i.test(t)?t:"http://"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+s+'" target="_blank" data-can-copy="true">'+t+"</a>"}),""})),t.replace(Common.Utils.emailStrongRe,(function(t){var o=/((^mailto:)\/\/)/i.test(t)?t:"mailto:"+t;return e=arguments[arguments.length-2],i=t.length,_.find(n,(function(t){return e>=t.start&&e<t.end||e<=t.start&&e+i>t.start}))||n.push({start:e,end:i+e,str:'<a href="'+o+'">'+t+"</a>"}),""}));for(var o=(n=_.sortBy(n,(function(t){return t.start}))).length>0?Common.Utils.String.htmlEncode(t.substring(0,n[0].start))+n[0].str:Common.Utils.String.htmlEncode(t),s=1;s<n.length;s++)o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,n[s].start))+n[s].str;return n.length>0&&(o+=Common.Utils.String.htmlEncode(t.substring(n[s-1].end,t.length))),o},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this),this.textBoxAutoSizeLocked=void 0},setupLayout:function(){var t=this,e=$(t.el),i=this.panelBox.find(" > .layout-item");t.layout=new Common.UI.VBoxLayout({box:this.panelBox,items:[{el:i[0],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return t.usersBoxHeight},fmax:function(){return Math.max(t.usersBoxHeight-20,.5*t.panelBox.height()-t.messageBoxHeight)}}},{el:i[1],rely:!0,behaviour:"splitter",resize:{hidden:!1,autohide:!1,fmin:function(){return Math.max(t.messageBoxHeight+t.usersBoxHeight,.5*t.panelBox.height())},fmax:function(){return t.panelBox.height()-t.addMessageBoxHeight}}},{el:i[2],stretch:!0}]}),t.layout.on("layout:resizedrag",(function(e){t.updateScrolls(),t.usersCachedHeigt=t.panelUsers.height()+8+1,e.index||(t.textBoxAutoSizeLocked=!0)}),this),$(window).on("resize",(function(){"none"!==e.css("display")&&t.updateLayout()})),this.updateLayout();var n=this.panelBox.height();this.layout.setResizeValue(0,this.usersBoxHeight),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.max(.5*n,n-t.panelOptions.height()-4))),this.setupAutoSizingTextBox(),this.disableTextBoxButton($(this.txtMessage)),this.txtMessage.bind("input propertychange",_.bind(this.onTextareaInput,this))},onTextareaInput:function(t){this.updateHeightTextBox(t),this.disableTextBoxButton($(t.target))},disableTextBoxButton:function(t){var e=$(t.siblings("#chat-msg-btn-add")[0]);t.val().trim().length>0?(e.removeAttr("disabled"),e.removeClass("disabled")):(e.attr("disabled",!0),e.addClass("disabled"))},updateLayout:function(t){var e=this,i=this.panelBox.height();if(e.layout.setResizeValue(1,Math.max(e.addMessageBoxHeight,Math.max(.5*i,i-e.panelOptions.height()-4))),t){this.panelUsers.css("height");this.panelUsers.css("height","1px");var n=this.panelUsers.get(0).scrollHeight;e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(n+2,Math.floor(.5*i)-e.messageBoxHeight)))}else e.layout.setResizeValue(0,Math.max(e.usersBoxHeight,Math.min(e.usersCachedHeigt+2,Math.floor(.5*i)-e.messageBoxHeight)));e.updateScrolls(),e.updateHeightTextBox(null)},setupAutoSizingTextBox:function(){this.lineHeight=0,this.minHeight=44,this.lineHeight=1.25*parseInt(this.txtMessage.css("lineHeight"),10),this.updateHeightTextBox(!0)},updateHeightTextBox:function(t){var e,i,n=this.txtMessage;if(i=this.panelBox.height(),t&&0==n.val().length)return this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,i-this.addMessageBoxHeight)),this.textBoxAutoSizeLocked=void 0,void this.updateScrolls();_.isUndefined(this.textBoxAutoSizeLocked)&&(n.height(),n.get(0).scrollHeight,n.css({height:this.minHeight+"px"}),n.height(),e=Math.max(n.get(0).scrollHeight+this.lineHeight,1),n.css({height:"100%"}),i=this.panelBox.height(),this.layout.setResizeValue(1,Math.max(this.addMessageBoxHeight,Math.min(i-e-40,i-this.addMessageBoxHeight)))&&this.updateScrolls())},updateScrolls:function(){this.panelUsers&&this.panelUsers.scroller&&this.panelMessages&&this.panelMessages.scroller&&(this.panelUsers.scroller.update({minScrollbarLength:25,alwaysVisibleY:!0}),this.panelMessages.scroller.update({minScrollbarLength:40,alwaysVisibleY:!0}))},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},textSend:"Send",textChat:"Chat",textClosePanel:"Close chat",textEnterMessage:"Enter your message here"},Common.Views.Chat||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/CheckBox",["common/main/lib/component/BaseView","underscore"],(function(t,e){"use strict";Common.UI.CheckBoxTemplate='<label class="checkbox-indeterminate"><input id="<%= id %>" type="checkbox" class="checkbox__native"><label for="<%= id %>" class="checkbox__shape canfocused"><svg width="14" height="14" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" x="0" y="0"><path class="chb-check-mark" d="M10.767,4.201c0.3,0.29 0.31,0.76 0.03,1.07l-4.25,4.5c-0.14,0.14 -0.34,0.23 -0.54,0.23c-0.2,-0 -0.4,-0.08 -0.54,-0.22l-2.25,-2.25c-0.29,-0.29 -0.29,-0.77 0,-1.06c0.29,-0.29 0.77,-0.29 1.06,-0l1.7,1.7l3.72,-3.93c0.29,-0.31 0.76,-0.32 1.07,-0.04Z"/><rect class="chb-indeterminate" height="2" rx="0.5" transform="matrix(1 0 0 1 0 0)" width="8" x="3" y="6"/></svg></label></label>',Common.UI.CheckBox=Common.UI.BaseView.extend({options:{labelText:""},disabled:!1,rendered:!1,indeterminate:!1,checked:!1,value:"unchecked",template:e.template(['<label class="checkbox-indeterminate">','<input id="<%= id %>" type="checkbox" class="checkbox__native">','<label for="<%= id %>" class="checkbox__shape canfocused" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" role="checkbox" aria-checked="false" aria-labelledby="<%= id %>-description">','<svg width="14" height="14" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" x="0" y="0">','<path class="chb-check-mark" d="M10.767,4.201c0.3,0.29 0.31,0.76 0.03,1.07l-4.25,4.5c-0.14,0.14 -0.34,0.23 -0.54,0.23c-0.2,-0 -0.4,-0.08 -0.54,-0.22l-2.25,-2.25c-0.29,-0.29 -0.29,-0.77 0,-1.06c0.29,-0.29 0.77,-0.29 1.06,-0l1.7,1.7l3.72,-3.93c0.29,-0.31 0.76,-0.32 1.07,-0.04Z"/>','<rect class="chb-indeterminate" height="2" rx="0.5" transform="matrix(1 0 0 1 0 0)" width="8" x="3" y="6"/>',"</svg>","</label>",'<span id="<%= id %>-description"></span>',"</label>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(t){var e=this;if(!e.rendered){var i=this.template({id:Common.UI.getId("chb-"),dataHint:e.options.dataHint,dataHintDirection:e.options.dataHintDirection,dataHintOffset:e.options.dataHintOffset});t?(this.setElement(t,!1),t.html(i)):e.$el.html(i),this.$chk=e.$el.find("input[type=checkbox]"),this.$label=e.$el.find("label.checkbox-indeterminate"),this.$span=e.$label.find("span"),this.$chk.on("click",this.onItemCheck.bind(this)),this.$label.on("keydown",this.onKeyDown.bind(this)),this.rendered=!0}return this.options.disabled&&this.setDisabled(this.options.disabled),void 0!==this.options.value&&this.setValue(this.options.value,!0),this.setCaption(this.options.labelText),this},setDisabled:function(t){this.rendered&&((t=!0===t)!==this.disabled&&(this.$label.toggleClass("disabled",t),t?this.$chk.attr({disabled:t}):this.$chk.removeAttr("disabled"),void 0!==this.tabindex&&(t&&(this.tabindex=this.$label.attr("tabindex")),this.$label.attr("tabindex",t?"-1":this.tabindex))),this.disabled=t)},isDisabled:function(){return this.disabled},onItemCheck:function(t){this.disabled||(this.indeterminate?(this.indeterminate=!1,this.setValue(!1)):this.setValue(!this.checked))},setRawValue:function(t){this.checked=!0===t||"true"===t||"1"===t||1===t||"checked"===t,this.indeterminate="indeterminate"===t,this.value=this.indeterminate?"indeterminate":this.checked?"checked":"unchecked",this.$chk.prop({indeterminate:this.indeterminate,checked:this.checked}),$(this.$label.find("label")).attr("aria-checked",this.indeterminate?"mixed":this.checked)},setValue:function(t,e){this.rendered?t!=this.value&&(this.lastValue=this.value,this.setRawValue(t),!0!==e&&this.trigger("change",this,this.value,this.lastValue)):this.options.value=t},getValue:function(){return this.value},isChecked:function(){return this.checked},setCaption:function(t){this.$span.text(t),this.$span.css("visibility",t?"visible":"hidden")},onKeyDown:function(t){t.isDefaultPrevented()||t.keyCode===Common.UI.Keys.SPACE&&this.onItemCheck(t)},focus:function(){this.$label&&this.$label.focus()},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this.$label.attr("tabindex",this.tabindex))}})})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.FocusManager=new function(){var t=[],e=0,i=function(t){var e=[];return t.forEach||(t=[t]),t.forEach((function(t){if(t){var i={};t.cmp&&"string"==typeof t.selector?i=t:(i.cmp=t,Common.UI.ListView&&t instanceof Common.UI.ListView?i.selector=".listview":t instanceof Common.UI.CheckBox?i.selector=".checkbox-indeterminate":Common.UI.RadioBox&&t instanceof Common.UI.RadioBox?i.selector=".radiobox":Common.UI.TreeView&&t instanceof Common.UI.TreeView?i.selector=".treeview":t instanceof Common.UI.Button?i.selector=t.split?".btn-group":"button":i.selector=".form-control"),i.el=(i.cmp.$el||$(i.cmp.el||i.cmp)).find(i.selector).addBack().filter(i.selector),i.el&&i.el.attr&&(i.cmp.setTabIndex?i.cmp.setTabIndex(1):i.el.attr("tabindex",1..toString())),e.push(i)}})),e},n=function(t){if(t&&!t.traps&&t.fields&&!(t.fields.length<1)){var e=$('<span aria-hidden="true" tabindex="1"></span>');e.on("focus",(function(){if(!t.hidden)for(var e=t.fields,i=e.length-1;i>=0;i--){var n=e[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout((function(){o.focus()}),10);break}}})),t.parent.$window.prepend(e);var i=$('<span aria-hidden="true" tabindex="2"></span>');i.on("focus",(function(){if(!t.hidden)for(var e=t.fields,i=0;i<e.length;i++){var n=e[i];if((n.cmp.isVisible?n.cmp.isVisible():n.cmp.is(":visible"))&&(!n.cmp.isDisabled||!n.cmp.isDisabled())){var o=n.selector?(n.cmp.$el||$(n.cmp.el||n.cmp)).find(n.selector).addBack().filter(n.selector):n.el;o&&setTimeout((function(){o.focus()}),10);break}}})),t.parent.$window.append(i),t.traps=[e,i]}},o=function(e,i){var n=e?1:-1;for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];s&&s.index<i&&s.traps&&s.traps[1].attr("tabindex",(parseInt(s.traps[1].attr("tabindex"))+n).toString()),!e&&s&&s.index>i&&s.index--}},s=function(o,s,a){if(o&&o.cid){if(t[o.cid]){var r=t[o.cid].fields||[];a<0&&(a+=r.length),t[o.cid].fields=void 0===a?r.concat(i(s)):r.slice(0,a).concat(i(s)).concat(r.slice(a))}else t[o.cid]={parent:o,fields:i(s),hidden:!1,index:e++};return n(t[o.cid]),a||0}};return{init:function(){Common.NotificationCenter.on({"modal:show":function(i){i&&i.cid&&(t[i.cid]?t[i.cid].hidden=!1:(t[i.cid]={parent:i,hidden:!1,index:e++},o(!0,t[i.cid].index)))},"window:show":function(e){e&&e.cid&&t[e.cid]&&!t[e.cid].fields&&(t[e.cid].fields=i(e.getFocusedComponents()),n(t[e.cid]));var o=e?e.getDefaultFocusableComponent():null;o&&setTimeout((function(){o.focus()}),100)},"modal:close":function(i,n){i&&i.cid&&t[i.cid]&&(o(!1,t[i.cid].index),delete t[i.cid],e--)},"modal:hide":function(e,i){e&&e.cid&&t[e.cid]&&(t[e.cid].hidden=!0)}})},add:function(t,e){s(t,e)},insert:s,remove:function(e,i,n){if(e&&e.cid&&t[e.cid]&&t[e.cid].fields&&void 0!==i){var o=t[e.cid].fields.splice(i,n);o&&o.forEach((function(t){t.el&&t.el.attr&&(t.cmp.setTabIndex?t.cmp.setTabIndex(-1):t.el.attr("tabindex","-1"))}))}}}},define("common/main/lib/controller/FocusManager",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/Window",["common/main/lib/component/BaseView","common/main/lib/component/CheckBox","common/main/lib/controller/FocusManager"],(function(){"use strict";Common.UI.Window=Common.UI.BaseView.extend(_.extend(function(){var t={closable:!0,header:!0,modal:!0,width:"auto",height:"auto",title:"Title",alias:"Window",cls:"",toolclose:"close",help:!1,maxwidth:void 0,maxheight:void 0,minwidth:0,minheight:0,enableKeyEvents:!0,automove:!0,role:"dialog"};function e(){var t=$(".modals-mask");return 0==t.length&&(t=$("<div class='modals-mask'>").appendTo(document.body).hide()).attr("counter",0),t}function i(t){if(!this.isLocked()&&this.isVisible()&&this.initConfig.enableKeyEvents&&!1!==this.pauseKeyEvents){if(this.initConfig.keydowncallback&&this.initConfig.keydowncallback.call(this,t))return!1;switch(t.keyCode){case Common.UI.Keys.ESC:if($(".asc-loadmask").length<1)return t.preventDefault(),t.stopPropagation(),!1!==this.initConfig.closable&&(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close()),!1;break;case Common.UI.Keys.RETURN:var e=$(t.target);if(e.hasClass("dlg-btn")&&!e.hasClass("primary"))return;if(this.$window.find(".btn.primary").length&&$(".asc-loadmask").length<1&&!1===(this.initConfig.onprimary||this.onPrimary).call(this))return t.preventDefault(),!1}}}function n(){if(null==window.innerHeight)var t=document.documentElement.offsetWidth,e=document.documentElement.offsetHeight;else t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight();return{width:t,height:e-=Common.Utils.InternalSettings.get("window-inactive-area-top"),top:Common.Utils.InternalSettings.get("window-inactive-area-top")}}function o(){if("auto"==this.initConfig.height){var t=Math.ceil(parseFloat(this.$window.find("> .body").css("height")));this.initConfig.header&&(t+=parseInt(this.$window.find("> .header").css("height"))),this.$window.height(t)}}function s(){var t=n(),e=t.width,i=t.height;if("auto"==this.initConfig.height){var o=parseInt(this.$window.find(".body").css("height"));this.initConfig.header&&(o+=parseInt(this.$window.find(".header").css("height")))}else(o=this.initConfig.height)>i&&(o=i);var s="auto"==this.initConfig.width?parseInt(this.$window.find(".body").css("width")):this.initConfig.width,a=t.top+Math.floor((parseInt(i)-parseInt(o))/2),r=Math.floor((parseInt(e)-parseInt(s))/2);this.$window.css({left:r<0?0:r,top:a<0?0:a})}function a(){var t=n(),e=t.width,i=t.height;this.getLeft()+this.getWidth()>e&&this.$window.css("left",e-this.getWidth()),this.getTop()<t.top?this.$window.css("top",t.top):this.getTop()+this.getHeight()>i&&(i-this.getHeight()<0?this.$window.css("top",t.top):this.$window.css("top",t.top+i-this.getHeight()))}function r(t){return{"-webkit-transition":"0.3s opacity","-moz-transition":"0.3s opacity","-ms-transition":"0.3s opacity","-o-transition":"0.3s opacity",opacity:t}}function l(t){if(!$(t.target).hasClass("close")&&!$(t.target).hasClass("help")){Common.UI.Menu.Manager.hideAll();var e=t instanceof jQuery.Event?Common.Utils.zoom():1;this.dragging.enabled=!0,this.dragging.initx=t.pageX*e-this.getLeft(),this.dragging.inity=t.pageY*e-this.getTop();var i=n(),o=i.width,s=i.height;this.dragging.maxx=o-this.getWidth(),this.dragging.maxy=s-this.getHeight(),this.dragging.maxy<0&&(this.dragging.maxy=0),this.dragging.maxy+=i.top,$(document).on("mousemove",this.binding.drag),$(document).on("mouseup",this.binding.dragStop),this.fireEvent("drag",[this,"start"])}}function c(){$(document).off("mousemove",this.binding.drag),$(document).off("mouseup",this.binding.dragStop),this.dragging.enabled=!1,this.fireEvent("drag",[this,"end"])}function h(t){if(this.dragging.enabled){var e=t instanceof jQuery.Event?Common.Utils.zoom():1,i=t.pageX*e-this.dragging.initx,n=t.pageY*e-this.dragging.inity,o=Common.Utils.InternalSettings.get("window-inactive-area-top");i<0?i=0:i>this.dragging.maxx&&(i=this.dragging.maxx),n<o?n=o:n>this.dragging.maxy&&(n=this.dragging.maxy),this.$window.css({left:i,top:n})}}function d(t){"mouseup"==t.type&&this.dragging.enabled&&c.call(this)}function u(){var t=n(),e=t.width,i=t.height,o=this.getHeight(),s=this.getWidth(),a=this.getTop(),r=this.getLeft();a=a+o>i?i-o:a,r=r+s>e?e-s:r,this.$window.css({left:r<0?0:r,top:a<0?0:a})}function m(t){Common.UI.Menu.Manager.hideAll();var e=$(t.target),i=this.getLeft(),o=this.getTop();this.resizing.enabled=!0,this.resizing.initpage_x=t.pageX*Common.Utils.zoom(),this.resizing.initpage_y=t.pageY*Common.Utils.zoom(),this.resizing.initx=this.resizing.initpage_x-i,this.resizing.inity=this.resizing.initpage_y-o,this.resizing.initw=this.getWidth(),this.resizing.inith=this.getHeight(),this.resizing.type=[e.hasClass("left")?-1:e.hasClass("right")?1:0,e.hasClass("top")?-1:e.hasClass("bottom")?1:0];var s=n(),a=s.width,r=s.height,l=this.initConfig.maxwidth?this.initConfig.maxwidth:a,c=this.initConfig.maxheight?this.initConfig.maxheight:r;this.resizing.minw=this.initConfig.minwidth,this.resizing.maxw=this.resizing.type[0]>0?Math.min(a-i,l):Math.min(i+this.resizing.initw,l),this.resizing.minh=this.initConfig.minheight,this.resizing.maxh=this.resizing.type[1]>0?Math.min(r-o,c):Math.min(o+this.resizing.inith,c),$(document.body).css("cursor",e.css("cursor")),this.$window.find(".resize-border").addClass("resizing"),this.$window.find(".header").addClass("resizing"),$(document).on("mousemove",this.binding.resize),$(document).on("mouseup",this.binding.resizeStop),this.fireEvent("resize",[this,"start"])}function p(t){if(this.resizing.enabled){var e=!1,i=t instanceof jQuery.Event?Common.Utils.zoom():1,n=t.pageX*i,o=t.pageY*i;if(this.resizing.type[0]){var s=this.resizing.initw+(n-this.resizing.initpage_x)*this.resizing.type[0];s>this.resizing.maxw?(n-=(s-this.resizing.maxw)*this.resizing.type[0],s=this.resizing.maxw):s<this.resizing.minw&&(n-=(s-this.resizing.minw)*this.resizing.type[0],s=this.resizing.minw),this.resizing.type[0]<0&&this.$window.css({left:n-this.resizing.initx}),this.setWidth(s),e=!0}if(this.resizing.type[1]){var a=this.resizing.inith+(o-this.resizing.initpage_y)*this.resizing.type[1];a>this.resizing.maxh?(o-=(a-this.resizing.maxh)*this.resizing.type[1],a=this.resizing.maxh):a<this.resizing.minh&&(o-=(a-this.resizing.minh)*this.resizing.type[1],a=this.resizing.minh),this.resizing.type[1]<0&&this.$window.css({top:o-this.resizing.inity}),this.setHeight(a),e=!0}e&&this.fireEvent("resizing")}}function f(){$(document).off("mousemove",this.binding.resize),$(document).off("mouseup",this.binding.resizeStop),$(document.body).css("cursor","auto"),this.$window.find(".resize-border").removeClass("resizing"),this.$window.find(".header").removeClass("resizing"),this.resizing.enabled=!1,this.fireEvent("resize",[this,"end"])}return Common.UI.alert=function(t){this.Window.prototype;t.buttons||(t.buttons=["ok"]),t.dontshow=t.dontshow||!1,t.width||(t.width="auto");var e='<div class="info-box"><% if (typeof iconCls !== "undefined") { %><div class="icon <%= iconCls %>"></div><% } %><div class="text" <% if (typeof iconCls == "undefined") { %> style="padding-'+(Common.UI.isRTL()?"right":"left")+':10px;"<% } %>><span><%= msg %></span><% if (dontshow) { %><div class="dont-show-checkbox"></div><% } %></div></div><% if (dontshow) { %><div class="separator horizontal" style="width: 100%;"></div><% } %>';_.extend(t,{cls:"alert",onprimary:function(t){return a({currentTarget:i.getChild(".footer .dlg-btn")[0]}),!1},getFocusedComponents:r,getDefaultFocusableComponent:l,tpl:_.template(e)(t),role:"alertdialog",repaintcallback:function(){o.call(this,this),s.call(this)}});var i=new Common.UI.Window(t),n=null;function o(e){var i=e.getChild(".info-box"),n=e.getChild(".info-box .text > span"),o=e.getChild(".footer"),s=e.getChild(".header"),a=e.getChild(".body"),r=e.getChild(".icon"),l=r.length>0?r.height():0,c=r.length>0?$(r).outerWidth(!0):0,h=e.getChild(".info-box .dont-show-checkbox");if(t.dontshow||a.css("padding-bottom","10px"),(t.maxwidth||t.minwidth)&&"auto"==t.width){var d=Common.UI.isRTL()?parseInt(i.css("padding-right"))+c+n.width()+parseInt(i.css("padding-left")):Common.Utils.getPosition(n).left+n.width()+parseInt(i.css("padding-right"));t.maxwidth&&d>t.maxwidth?t.width=t.maxwidth:t.minwidth&&d<t.minwidth&&(t.width=t.minwidth)}if("auto"==t.width){i.height(Math.max(n.height(),l)+(h.length>0?h.height()+parseInt(h.css("margin-top")):0)),a.height(parseInt(i.css("height"))+parseInt(o.css("height")));var u=h.find("span");d=Common.UI.isRTL()?parseInt(i.css("padding-right"))+c+parseInt(i.css("padding-left"))+Math.max(n.width(),h.length>0?$(h).find(".checkbox-indeterminate").outerWidth(!0):0):Math.max(n.width(),u.length>0?Common.Utils.getPosition(u).left+u.width():0)+Common.Utils.getPosition(n).left+parseInt(i.css("padding-right"));e.setSize(d,parseInt(a.css("height"))+parseInt(s.css("height")))}else n.css("white-space","normal"),e.setWidth(t.width),i.height(Math.max(n.height(),l)+(h.length>0?h.height()+parseInt(h.css("margin-top")):0)),a.height(parseInt(i.css("height"))+parseInt(o.css("height"))),e.setHeight(parseInt(a.css("height"))+parseInt(s.css("height")));n.height()>0&&n.height()<l/2&&n.css({"vertical-align":"baseline","line-height":l+"px"})}function a(e){t.callback&&t.callback.call(i,e.currentTarget.attributes.result.value,!!n&&"checked"==n.getValue()),i.close(!0)}function r(t){return i.getFooterButtons()}function l(){return _.find(i.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))}return i.getFocusedComponents=r,i.getDefaultFocusableComponent=l,i.on({"render:after":function(e){var s=e.getChild(".footer");t.dontshow&&s.addClass("dontshow"),s.find(".dlg-btn").on("click",a),n=new Common.UI.CheckBox({el:i.$window.find(".dont-show-checkbox"),labelText:t.textDontShow||i.textDontShow}),o(e)},close:function(){t.callback&&t.callback.call(i,"close")}}),i.show(),i},Common.UI.error=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textError),Common.UI.alert(_.extend(t,{iconCls:"error"}))},Common.UI.confirm=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textConfirmation),Common.UI.alert(_.extend(t,{iconCls:"confirm"}))},Common.UI.info=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textInformation),Common.UI.alert(_.extend(t,{iconCls:"info"}))},Common.UI.warning=function(t){return!(t=t||{}).title&&(t.title=this.Window.prototype.textWarning),Common.UI.alert(_.extend(t,{iconCls:"warn"}))},{$window:void 0,$lastmodal:void 0,dragging:{enabled:!1},resizing:{enabled:!1},initialize:function(e){this.initConfig={},this.binding={};var i={ok:this.okButtonText,cancel:this.cancelButtonText,yes:this.yesButtonText,no:this.noButtonText,close:this.closeButtonText};if(e.buttons&&_.isArray(e.buttons)){null==e.primary&&(e.primary="ok");var n=[];_.each(e.buttons,(function(t){if("object"==typeof t){if(void 0!==t.value){var o={value:t.value,text:t.caption,cls:"auto"+(t.primary||e.primary==t.value?" primary":"")};t.id&&(o.id=t.id),n.push(o)}}else void 0!==t&&n.push({value:t,text:i[t],cls:e.primary==t||_.indexOf(e.primary,t)>-1?"primary":""})})),e.buttonsParsed=n,e.footerCls=e.footerCls||"center"}_.extend(this.initConfig,t,e||{}),!this.initConfig.id&&(this.initConfig.id="window-"+this.cid),!this.initConfig.tpl&&(this.initConfig.tpl=""),Common.UI.BaseView.prototype.initialize.call(this,this.initConfig)},render:function(){var t=this.initConfig.renderTo||document.body;if($(t).append(_.template('<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;" role="<%= role %>" aria-modal="<%= modal %>"><% if (header==true) { %><div class="header"><div class="tools"><% if (closable!==false) %><div class="tool close"></div><% %><% if (help===true) %><div class="tool help">?</div><% %></div><div class="title"><%= title %></div> </div><% } %><div class="body"><%= tpl %><% if (typeof (buttonsParsed) !== "undefined" && _.size(buttonsParsed) > 0) { %><div class="footer"><% _.each(buttonsParsed, function (item) { %><button class="btn normal dlg-btn <%= item.cls %>" result="<%= item.value %>" <% if (item.id) { %>id="<%=item.id%>" <% } %> ><%= item.text %></button><% }); %></div><% } %></div></div>')(this.initConfig)),this.$window=$("#"+this.initConfig.id),Common.Locale.getCurrentLanguage()&&"en"!==Common.Locale.getCurrentLanguage()&&this.$window.attr("applang",Common.Locale.getCurrentLanguage()),this.binding.keydown=_.bind(i,this),this.initConfig.header){this.binding.drag=_.bind(h,this),this.binding.dragStop=_.bind(c,this),this.binding.dragStart=_.bind(l,this);this.$window.find(".header").on("mousedown",this.binding.dragStart),this.$window.find(".tool.close").on("click",_.bind((function(){this.$window.find(".tool.close").hasClass("disabled")||(this.initConfig.toolcallback?this.initConfig.toolcallback.call(this):"hide"==this.initConfig.toolclose?this.hide():this.close())}),this)),this.$window.find(".tool.help").on("click",_.bind((function(){this.$window.find(".tool.help").hasClass("disabled")||this.fireEvent("help",this)}),this)),this.initConfig.modal||Common.Gateway.on("processmouse",_.bind(d,this));var e=this.$window.find(".tools .tool").length;e>0&&this.$window.find("> .header > .title").css({"padding-right":20*e+"px","padding-left":20*e+"px"}),this.$window.find(".body").css({"border-top-left-radius":"0px","border-top-right-radius":"0px"})}else this.$window.find(".body").css({top:0});"auto"!==this.initConfig.height&&this.$window.css("height",this.initConfig.height),this.initConfig.resizable&&this.setResizable(this.initConfig.resizable);var n=this;return this.binding.winclose=function(t){n.$window&&n.isVisible()&&n.$window==t.$window&&n.close()},this.binding.onAppRepaint=_.bind(this.onAppRepaint,this),this.binding.onThemeChanged=_.bind(this.onThemeChanged,this),Common.NotificationCenter.on("window:close",this.binding.winclose),Common.NotificationCenter.on("app:repaint",this.binding.onAppRepaint),Common.NotificationCenter.on("uitheme:changed",this.binding.onThemeChanged),this.initConfig.footerCls&&this.$window.find(".footer").addClass(this.initConfig.footerCls),this.menuAddAlign=function(t,e,i){var o=this;n.$window.hasClass("notransform")?(t.css({left:e,top:i}),o.options.additionalAlign=null):(n.$window.addClass("notransform"),t.addClass("hidden"),setTimeout((function(){t.removeClass("hidden"),t.css({left:e,top:i}),o.options.additionalAlign=null}),300))},this.fireEvent("render:after",this),this},show:function(t,i){if(this.initConfig.modal){var n=e();if(!1===this.options.animate||this.options.animate&&!1===this.options.animate.mask)n.attr("counter",parseInt(n.attr("counter"))+1),n.show();else{var l=$(":root").css("--modal-window-mask-opacity");n.css("opacity",0),n.attr("counter",parseInt(n.attr("counter"))+1),n.show(),setTimeout((function(){n.css(r(l))}),1)}Common.NotificationCenter.trigger("modal:show",this),this.$lastmodal=$(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone")}this.$window?this.$window.is(":visible")||(this.$window.css({opacity:0}),a.call(this),this.$window.show()):(this.render(),o.call(this),_.isNumber(t)&&_.isNumber(i)?(this.$window.css("left",Math.floor(t)),this.$window.css("top",Math.floor(i))):s.call(this)),$(document).on("keydown."+this.cid,this.binding.keydown),this.initConfig.automove&&(this.binding.windowresize=_.bind(u,this),$(window).on("resize",this.binding.windowresize));var c=this;setTimeout((function(){c.fireEvent("animate:before",c)}),10),!1!==this.options.animate?(this.$window.css({"-webkit-transform":"scale(0.8)","-moz-transform":"scale(0.8)","-ms-transform":"scale(0.8)","-o-transform":"scale(0.8)",opacity:0}),setTimeout((function(){c.$window.css({"-webkit-transition":"0.2s opacity, 0.2s -webkit-transform","-webkit-transform":"scale(1)","-moz-transition":"0.2s opacity, 0.2s -moz-transform","-moz-transform":"scale(1)","-ms-transition":"0.2s opacity, 0.2s -ms-transform","-ms-transform":"scale(1)","-o-transition":"0.2s opacity, 0.2s -o-transform","-o-transform":"scale(1)",opacity:"1"}),setTimeout((function(){c.fireEvent("animate:after",c)}),210)}),1),setTimeout((function(){c.$window.addClass("notransform"),c.fireEvent("show",c)}),this.initConfig.modal?1e3:350)):(this.$window.css({opacity:1}),this.$window.addClass("notransform"),this.fireEvent("show",this),setTimeout((function(){c.fireEvent("animate:after",c)}),10)),Common.NotificationCenter.trigger("window:show",this)},close:function(t){if($(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.initConfig.header&&this.$window.find(".header").off("mousedown",this.binding.dragStart),Common.NotificationCenter.off({"window:close":this.binding.winclose}),Common.NotificationCenter.off("app:repaint",this.binding.onAppRepaint),Common.NotificationCenter.off("uitheme:changed",this.binding.onThemeChanged),this.initConfig.modal){var i=e(),n=!0;if(i.attr("counter",parseInt(i.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),n=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),n)if(!1!==this.options.animate){var o=$(":root").css("--modal-window-mask-opacity");i.css(r(0)),setTimeout((function(){parseInt(i.attr("counter"))<1&&(i.css("opacity",o),i.hide(),i.attr("counter",0))}),300)}else parseInt(i.attr("counter"))<1&&(i.hide(),i.attr("counter",0));Common.NotificationCenter.trigger("modal:close",this,n&&parseInt(i.attr("counter"))<1)}this.$window.remove(),!0!==t&&this.fireEvent("close",this)},hide:function(){if($(document).off("keydown."+this.cid),this.initConfig.automove&&$(window).off("resize",this.binding.windowresize),this.$window){if(this.initConfig.modal){var t=e(),i=!0;if(t.attr("counter",parseInt(t.attr("counter"))-1),this.$lastmodal.length>0&&(this.$lastmodal.removeClass("dethrone"),i=!(this.$lastmodal.hasClass("modal")&&this.$lastmodal.is(":visible"))),i)if(!1!==this.options.animate){var n=$(":root").css("--modal-window-mask-opacity");t.css(r(0)),setTimeout((function(){parseInt(t.attr("counter"))<1&&(t.css("opacity",n),t.hide(),t.attr("counter",0))}),300)}else parseInt(t.attr("counter"))<1&&(t.hide(),t.attr("counter",0));Common.NotificationCenter.trigger("modal:hide",this,i&&parseInt(t.attr("counter"))<1)}this.$window.hide(),this.$window.removeClass("notransform"),this.fireEvent("hide",this)}},isLocked:function(){return this.$window.hasClass("dethrone")||!this.initConfig.modal&&this.$window.parent().find(".asc-window.modal:visible").length},getChild:function(t){return t?this.$window.find(t):this.$window},setWidth:function(t){if(t>=0){var e=parseInt(this.$window.css("min-width"));t<e&&(t=e),t-=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),this.$window.width(t)}},getWidth:function(){return parseInt(this.$window.css("width"))},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),t-=parseInt(this.$window.css("border-bottom-width"))+parseInt(this.$window.css("border-top-width")),this.$window.height(t),this.initConfig.header&&(t-=parseInt(this.$window.find("> .header").css("height"))),this.$window.find("> .body").css("height",t)}},getHeight:function(){return parseInt(this.$window.css("height"))},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},getSize:function(){return[this.getWidth(),this.getHeight()]},setTitle:function(t){this.$window.find("> .header > .title").text(t)},getTitle:function(){return this.$window.find("> .header > .title").text()},getLeft:function(){return parseInt(this.$window.css("left"))},getTop:function(){return parseInt(this.$window.css("top"))},setPosition:function(t,e){this.$window&&(_.isNumber(t)&&_.isNumber(e)?(this.$window.css("left",Math.floor(t)),this.$window.css("top",Math.floor(e))):s.call(this))},isVisible:function(){return this.$window&&this.$window.is(":visible")},setResizable:function(t,e,i){if(t!==this.resizable){if(t){var n='<div class="resize-border left" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-right-style: solid; cursor: w-resize;"></div><div class="resize-border left bottom" style="border-bottom-left-radius: 5px; cursor: sw-resize;"></div><div class="resize-border bottom" style="left: 4px; right: 4px; width: auto; z-index: 2; border-top-style: solid; cursor: s-resize;"></div><div class="resize-border right bottom" style="border-bottom-right-radius: 5px; cursor: se-resize;"></div><div class="resize-border right" style="top:'+(this.initConfig.header?"33":"5")+'px; bottom: 5px; height: auto; border-left-style: solid; cursor: e-resize;"></div><div class="resize-border left top" style="border-top-left-radius: 5px; cursor: nw-resize;"></div><div class="resize-border top" style="left: 4px; right: 4px; width: auto; z-index: 2; border-bottom-style:'+(this.initConfig.header?"none":"solid")+'; cursor: n-resize;"></div><div class="resize-border right top" style="border-top-right-radius: 5px; cursor: ne-resize;"></div>';this.initConfig.header&&(n+='<div class="resize-border left" style="top: 5px; height: 28px; cursor: w-resize;"></div><div class="resize-border right" style="top: 5px; height: 28px; cursor: e-resize;"></div>'),this.$window.append(_.template(n)),this.binding.resize=_.bind(p,this),this.binding.resizeStop=_.bind(f,this),this.binding.resizeStart=_.bind(m,this),e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]),this.$window.find(".resize-border").on("mousedown",this.binding.resizeStart)}else this.$window.find(".resize-border").remove();this.resizable=t}else t&&(e&&e.length>1&&(this.initConfig.minwidth=e[0]),e&&e.length>1&&(this.initConfig.minheight=e[1]),i&&i.length>1&&(this.initConfig.maxwidth=i[0]),i&&i.length>1&&(this.initConfig.maxheight=i[1]))},onAppRepaint:function(){this.$window&&this.isVisible()&&(o.call(this),this.initConfig.repaintcallback?this.initConfig.repaintcallback.call(this):!1!==this.initConfig.repaintcallback&&s.call(this))},onThemeChanged:function(){this.$window&&this.isVisible()&&o.call(this)},suspendKeyEvents:function(){this.pauseKeyEvents=!1},resumeKeyEvents:function(){this.initConfig.enableKeyEvents&&(this.pauseKeyEvents=!0)},onPrimary:function(){},getFocusedComponents:function(){return[]},getDefaultFocusableComponent:function(){},getFooterButtons:function(){if(!this.footerButtons){var t=[];this.$window.find(".dlg-btn").each((function(e,i){t.push(new Common.UI.Button({el:$(i)}))})),this.footerButtons=t}return this.footerButtons},cancelButtonText:"Cancel",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",closeButtonText:"Close",textWarning:"Warning",textError:"Error",textConfirmation:"Confirmation",textInformation:"Information",textDontShow:"Don't show this message again"}}(),Common.UI.Window||{}))})),void 0===Common)var Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/Plugins",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout","common/main/lib/component/Window"],(function(t){"use strict";Common.Views.Plugins=Common.UI.BaseView.extend(_.extend({storePlugins:void 0,initialize:function(t){_.extend(this,t),this._locked=!1,this._state={DisabledControls:!1,docProtection:{isReadOnly:!1,isReviewOnly:!1,isFormsOnly:!1,isCommentsOnly:!1}},this.lockedControls=[],this.pluginPanels={},this.customPluginPanels={},Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.pluginMenu=new Common.UI.Menu({menuAlign:"tr-br",items:[]}),this.trigger("render:after",this),this},getPanel:function(){var t=$('<section id="plugins-panel" class="panel" data-tab="plugins" role="tabpanel" aria-labelledby="plugins"></section>'),e=$('<div class="group"></div>');return this.storePlugins.isEmpty()||this.storePlugins.each((function(t){})),e.appendTo(t),t},renderTo:function(t){if(!this.storePlugins.isEmpty()){var e=this,i=$('<div class="group"></div>'),n=Common.enumLock;this.storePlugins.each((function(t){if(t.get("visible")){var o=t.get("variations"),s=t.get("guid"),a=o[t.get("currentVariation")].get("icons"),r=t.get("baseUrl")+e.parseIcons(a),l=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconImg:r,caption:Common.Utils.String.htmlEncode(t.get("name")),menu:o&&o.length>1,split:o&&o.length>1,value:s,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[n.viewMode,n.previewReviewMode,n.viewFormMode,n.selRangeEdit,n.editFormula]:[n.viewMode,n.previewReviewMode,n.viewFormMode,n.lostConnect,n.docLockView,n.docLockForms,n.docLockComments,n.selRangeEdit,n.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),c=$('<span class="btn-slot text x-huge"></span>').appendTo(i);l.render(c),t.set("button",l),e.lockedControls.push(l)}}));var o=e._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,o.isReadOnly,{array:e.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,o.isFormsOnly,{array:e.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,o.isCommentsOnly,{array:e.lockedControls}),t.html(i),$('<div class="separator long"></div>').prependTo(t)}},setLocked:function(t){this._locked=t},ChangeSettings:function(t){this.disableControls(this._locked)},disableControls:function(t){this._state.DisabledControls!==t&&(this._state.DisabledControls=t,_.each(this.lockedControls,(function(e){e.setDisabled(t)})),this.pluginsMask&&this.pluginsMask.css("display",t?"block":"none"))},SetDisabled:function(t,e,i){e?Common.Utils.lockControls(Common.enumLock.previewReviewMode,t,{array:this.lockedControls}):i?Common.Utils.lockControls(Common.enumLock.viewFormMode,t,{array:this.lockedControls}):Common.Utils.lockControls(Common.enumLock.viewMode,t,{array:this.lockedControls})},openedPluginMode:function(t,e){var i=this.storePlugins.findWhere({guid:t});if(i){var n=i.get("button");n&&(e||n.toggle(!0),n.menu&&n.menu.items.length>0&&(n.menu.items[0].setCaption(this.textStop),n.menu.items[0].isRun=!0),n.options.isRun=!0)}},closedPluginMode:function(t,e){var i=this.storePlugins.findWhere({guid:t});if(i){var n=i.get("button");n&&(e||n.toggle(!1),n.menu&&n.menu.items.length>0&&(n.menu.items[0].setCaption(this.textStart),n.menu.items[0].isRun=!1),n.options.isRun=!1)}},iconsStr2IconsObj:function(t){let e=t;return"string"==typeof e?-1===e.indexOf("%")?[t,t]:Common.UI.iconsStr2IconsObj(t):e},parseIcons:function(t){return Common.UI.getSuitableIcons(this.iconsStr2IconsObj(t))},updatePluginIcons:function(t){if(!t.get("visible"))return null;var e=t.get("variations")[t.get("currentVariation")].get("icons");""!==e&&(t.set("parsedIcons",this.parseIcons(e)),this.updatePluginButton(t))},updatePluginButton:function(t){if(!t.get("visible")||!t.get("parsedIcons"))return null;var e=t.get("backgroundPlugin");e&&e.cmpEl&&e.cmpEl.find("img").attr("src",t.get("baseUrl")+t.get("parsedIcons").normal)},createBackgroundPluginsButton:function(){var t=Common.enumLock,e=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-background-plugins",caption:this.textBackgroundPlugins,menu:new Common.UI.Menu({cls:"background-plugins",style:"min-width: 230px;",items:[{template:_.template('<div class="menu-header">'+this.textTheListOfBackgroundPlugins+"</div>"),stopPropagation:!0}],restoreHeight:!0}),hint:this.textBackgroundPlugins,lock:[t.viewMode,t.previewReviewMode,t.viewFormMode,t.docLockView,t.docLockForms,t.docLockComments,t.selRangeEdit,t.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"});return this.lockedControls.push(e),e},createPluginButton:function(t){if(!t.get("visible"))return null;var e,i=this,n=t.get("variations"),o=t.get("guid"),s=n[t.get("currentVariation")].get("icons");""===s?e="toolbar__icon btn-plugin-default":t.set("parsedIcons",this.parseIcons(s));var a=[];_.each(t.get("variations"),(function(t,e){t.get("visible")&&a.push({caption:e>0?t.get("description"):i.textStart,value:parseInt(t.get("index")),isRun:!1})}));var r=Common.enumLock,l=new Common.UI.ButtonCustom({cls:"btn-toolbar x-huge icon-top",iconCls:e,iconsSet:this.iconsStr2IconsObj(s),baseUrl:t.get("baseUrl"),caption:Common.Utils.String.htmlEncode(t.get("name")),menu:a.length>1,split:a.length>1,value:o,isRun:!1,hint:t.get("name"),lock:t.get("isDisplayedInViewer")?[r.viewMode,r.previewReviewMode,r.viewFormMode,r.selRangeEdit,r.editFormula]:[r.viewMode,r.previewReviewMode,r.viewFormMode,r.docLockView,r.docLockForms,r.docLockComments,r.selRangeEdit,r.editFormula],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"});return l.split&&(l.setMenu(new Common.UI.Menu({items:a,pluginGuid:t.get("guid")})),l.menu.on("item:click",(function(t,e,n){i.fireEvent("plugin:select",[t.options.pluginGuid,e.value,e.isRun,0===e.value&&e.isRun])}))),l.on("click",(function(t,e){i.fireEvent("plugin:select",[t.options.value,0,l.options.isRun])})),t.set("button",l),i.lockedControls.push(l),l},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},showPluginPanel:function(t,e){var i=this.pluginPanels[e]?this.pluginPanels[e]:this.customPluginPanels[e],n=this.pluginPanels[e]?this.storePlugins.findWhere({guid:e}).get("menu"):i.menu;if(t){for(var o in this.pluginPanels)this.pluginPanels[o].menu===n&&this.pluginPanels[o].$el.removeClass("active");for(var o in this.customPluginPanels)this.customPluginPanels[o].menu===n&&this.customPluginPanels[o].$el.removeClass("active");i.$el.addClass("active")}else i.$el.removeClass("active"),this.fireEvent("right"===n?"pluginsright:hide":"pluginsleft:hide",this)},strPlugins:"Plugins",textStart:"Start",textStop:"Stop",groupCaption:"Plugins",tipMore:"More",textBackgroundPlugins:"Background Plugins",textTheListOfBackgroundPlugins:"The list of background plugins",textSettings:"Settings"},Common.Views.Plugins||{}))})),function(t){"function"==typeof define&&define.amd?define("jmousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}((function(t){var e,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(t.event.fixHooks)for(var a=n.length;a;)t.event.fixHooks[n[--a]]=t.event.mouseHooks;var r=t.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var e=o.length;e;)this.addEventListener(o[--e],l,!1);else this.onmousewheel=l;t.data(this,"mousewheel-line-height",r.getLineHeight(this)),t.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=o.length;t;)this.removeEventListener(o[--t],l,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(t(e)["offsetParent"in t.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0}};function l(n){var o,a=n||window.event,r=s.call(arguments,1),l=0,d=0,u=0;if((n=t.event.fix(a)).type="mousewheel","detail"in a&&(u=-1*a.detail),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(d=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(d=-1*u,u=0),l=0===u?d:u,"deltaY"in a&&(l=u=-1*a.deltaY),"deltaX"in a&&(d=a.deltaX,0===u&&(l=-1*d)),0!==u||0!==d){if(1===a.deltaMode){var m=t.data(this,"mousewheel-line-height");l*=m,u*=m,d*=m}else if(2===a.deltaMode){var p=t.data(this,"mousewheel-page-height");l*=p,u*=p,d*=p}return o=Math.max(Math.abs(u),Math.abs(d)),(!i||o<i)&&(i=o,h(a,o)&&(i/=40)),h(a,o)&&(l/=40,d/=40,u/=40),l=Math[l>=1?"floor":"ceil"](l/i),d=Math[d>=1?"floor":"ceil"](d/i),u=Math[u>=1?"floor":"ceil"](u/i),n.deltaX=d,n.deltaY=u,n.deltaFactor=i,n.deltaMode=0,r.unshift(n,l,d,u),e&&clearTimeout(e),e=setTimeout(c,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function c(){i=null}function h(t,e){return r.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})),function(t){"use strict";"function"==typeof define&&define.amd?define("perfectscrollbar",["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}((function(t){"use strict";var e,i={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1,includeMargin:!0},n=(e=0,function(){var t=e;return e+=1,".perfect-scrollbar-"+t});t.fn.perfectScrollbar=function(e,o){return this.each((function(){var s=t.extend(!0,{},i),a=t(this);if("object"==typeof e?t.extend(!0,s,e):o=e,"update"===o)return a.data("perfect-scrollbar-update")&&a.data("perfect-scrollbar-update")(),a;if("destroy"===o)return a.data("perfect-scrollbar-destroy")&&a.data("perfect-scrollbar-destroy")(),a;if(a.data("perfect-scrollbar"))return a.data("perfect-scrollbar");a.addClass("ps-container oo");var r,l,c,h,d,u,m,p,f,g,b,v,C,w,y,x,_,k,I,S,E,T,M,A,U=t("<div class='ps-scrollbar-x-rail'></div>").appendTo(a),D=t("<div class='ps-scrollbar-y-rail'></div>").appendTo(a),P=t("<div class='ps-scrollbar-x'><div></div></div>").appendTo(U),L=t("<div class='ps-scrollbar-y'><div></div></div>").appendTo(D),O=parseInt(U.css("bottom"),10),R=parseInt(D.css("right"),10),F=n(),$=!1,B=function(t){return s.minScrollbarLength&&(t=Math.max(t,s.minScrollbarLength)),t},V=function(){U.css({left:Common.UI.isRTL()?"auto":a.scrollLeft(),right:Common.UI.isRTL()?-a.scrollLeft():"auto",bottom:O-a.scrollTop(),width:f,display:r?"inherit":"none"}),D.hasClass("in-scrolling")?D.css({right:R-a.scrollLeft(),height:v,display:l?"inherit":"none"}):(D.css({top:a.scrollTop(),right:R-a.scrollLeft(),height:v,display:l?"inherit":"none"}),Common.UI.isRTL()&&$&&D.css({left:a.scrollLeft()+1})),P&&P.css({left:Common.UI.isRTL()?"auto":p,right:Common.UI.isRTL()?p:"auto",width:m}),L&&L.css({top:b,height:g})},H=function(){c=s.includePadding?a.innerWidth():a.width(),h=s.includePadding?a.innerHeight():a.height(),v=h-(s.includeMargin?parseInt(D.css("margin-top"))+parseInt(D.css("margin-bottom")):0),f=c-(s.includeMargin?parseInt(U.css("margin-left"))+parseInt(U.css("margin-right")):0),d=a.prop("scrollWidth"),u=a.prop("scrollHeight"),!s.suppressScrollX&&c+s.scrollXMarginOffset<d?(r=!0,m=B(parseInt(f*c/d,10)),p=parseInt(a.scrollLeft()*(Common.UI.isRTL()?-1:1)*(f-m)/(d-c),10)):(r=!1,m=0,p=0,a.scrollLeft(0)),!s.suppressScrollY&&h+s.scrollYMarginOffset<u?(l=!0,g=B(parseInt(v*h/u,10)),b=parseInt(a.scrollTop()*(v-g)/(u-h),10)):(l=!1,g=0,b=0,a.scrollTop(0)),b>=v-g&&(b=v-g),p>=f-m&&(p=f-m),V(),s.onChange&&s.onChange(this)},N=function(){var e,i;P.bind("mousedown"+F,(function(t){$=!0,Common.NotificationCenter.trigger("hints:clear"),i=t.pageX*Common.Utils.zoom(),e=Common.Utils.getPosition(P).left,U.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()})),t(document).bind("mousemove"+F,(function(t){U.hasClass("in-scrolling")&&(!function(t,e){var i=f-m;Common.UI.isRTL()&&(t=i-t,e*=-1);var n=t+e;p=n<0?0:n>i?i:n;var o=parseInt(p*(d-c)/(f-m),10);a.scrollLeft(o*(Common.UI.isRTL()?-1:1)),D.css({right:R-o}),Common.UI.isRTL()&&$&&D.css({left:a.scrollLeft()+1})}(e,t.pageX*Common.Utils.zoom()-i),t.stopPropagation(),t.preventDefault())})),t(document).bind("mouseup"+F,(function(t){U.hasClass("in-scrolling")&&U.removeClass("in-scrolling")})),e=i=null},z=function(){var e,i;L.bind("mousedown"+F,(function(t){Common.NotificationCenter.trigger("hints:clear"),i=t.pageY*Common.Utils.zoom(),e=Common.Utils.getPosition(L).top,D.addClass("in-scrolling");var n=parseInt(D.css("margin-top")),o=Common.Utils.getBoundingClientRect(D[0]);D.css({position:"fixed",left:o.left,top:o.top-n}),t.stopPropagation(),t.preventDefault()})),t(document).bind("mousemove"+F,(function(t){D.hasClass("in-scrolling")&&(!function(t,e){var i=t+e,n=v-g;b=i<0?0:i>n?n:i;var o=parseInt(b*(u-h)/(v-g),10);a.scrollTop(o),U.css({bottom:O-o})}(e,t.pageY*Common.Utils.zoom()-i),t.stopPropagation(),t.preventDefault())})),t(document).bind("mouseup"+F,(function(t){D.hasClass("in-scrolling")&&(D.removeClass("in-scrolling"),D.css({position:"",left:"",top:""}),V())})),e=i=null},j=function(t,e){var i=a.scrollTop();if(0===t){if(!l)return!1;if(0===i&&e>0||i>=u-h&&e<0)return!s.wheelPropagation}var n=a.scrollLeft();if(0===e){if(!r)return!1;if(0===n&&t<0||n>=d-c&&t>0)return!s.wheelPropagation}return!0},W=function(){a.unbind(F),t(window).unbind(F),t(document).unbind(F),a.data("perfect-scrollbar",null),a.data("perfect-scrollbar-update",null),a.data("perfect-scrollbar-destroy",null),P.remove(),L.remove(),U.remove(),D.remove(),P=L=c=h=d=u=m=p=O=g=b=R=null,$=!1},q="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;return(A=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/))&&"msie"===A[1]&&(C=parseInt(A[2],10),a.addClass("ie").addClass("ie"+C),6===C&&(w=function(){t(this).addClass("hover")},y=function(){t(this).removeClass("hover")},a.bind("mouseenter"+F,w).bind("mouseleave"+F,y),U.bind("mouseenter"+F,w).bind("mouseleave"+F,y),D.bind("mouseenter"+F,w).bind("mouseleave"+F,y),P.bind("mouseenter"+F,w).bind("mouseleave"+F,y),L.bind("mouseenter"+F,w).bind("mouseleave"+F,y),V=function(){P.css({left:p+a.scrollLeft(),bottom:O,width:m}),L.css({top:b+a.scrollTop(),right:R,height:g}),P.hide().show(),L.hide().show()})),H(),a.bind("scroll"+F,(function(t){H()})),N(),z(),x=function(t){t.stopPropagation()},L.bind("click"+F,x),D.bind("click"+F,(function(t){var e=parseInt(g/2,10),i=(t.pageY*Common.Utils.zoom()-Common.Utils.getOffset(D).top-e)/(v-g);i<0?i=0:i>1&&(i=1),a.scrollTop((u-h)*i)})),P.bind("click"+F,x),U.bind("click"+F,(function(t){var e=parseInt(m/2,10),i=f-m,n=(Common.UI.isRTL()?i-(t.pageX*Common.Utils.zoom()-Common.Utils.getOffset(U).left)+e:t.pageX*Common.Utils.zoom()-Common.Utils.getOffset(U).left-e)/i;$=!0,n<0?n=0:n>1&&(n=1),a.scrollLeft((d-c)*n*(Common.UI.isRTL()?-1:1))})),q&&(_=function(t,e){a.scrollTop(a.scrollTop()-e),a.scrollLeft(a.scrollLeft()-t),H()},k={},I=0,S={},E=null,T=!1,t(window).bind("touchstart"+F,(function(t){T=!0})),t(window).bind("touchend"+F,(function(t){T=!1})),a.bind("touchstart"+F,(function(t){var e=t.originalEvent.targetTouches[0];k.pageX=e.pageX,k.pageY=e.pageY,I=(new Date).getTime(),null!==E&&clearInterval(E),t.stopPropagation()})),a.bind("touchmove"+F,(function(t){if(!T&&1===t.originalEvent.targetTouches.length){var e=t.originalEvent.targetTouches[0],i={};i.pageX=e.pageX,i.pageY=e.pageY;var n=i.pageX-k.pageX,o=i.pageY-k.pageY;_(n,o),k=i;var s=(new Date).getTime(),a=s-I;a>0&&(S.x=n/a,S.y=o/a,I=s),t.preventDefault()}})),a.bind("touchend"+F,(function(t){clearInterval(E),E=setInterval((function(){Math.abs(S.x)<.01&&Math.abs(S.y)<.01?clearInterval(E):(_(30*S.x,30*S.y),S.x*=.8,S.y*=.8)}),10)}))),a.mousewheel&&function(){s.wheelSpeed/=10;var e=!1;a.bind("mousewheel"+F,(function(i,n,o,c){Common.NotificationCenter.trigger("hints:clear");var h=i.deltaX*i.deltaFactor||o,d=i.deltaY*i.deltaFactor||c;if(i&&i.target&&("textarea"===i.target.type||"input"===i.target.type)){i.stopImmediatePropagation(),i.preventDefault();var u=t(i.target).scrollTop(),m=0;return i.originalEvent?i.originalEvent.wheelDelta?m=i.originalEvent.wheelDelta:i.originalEvent.deltaY?m=40*-i.originalEvent.deltaY:i.originalEvent.detail&&(m=i.originalEvent.detail):m=void 0!==i.wheelDelta?i.wheelDelta:i.deltaY,void t(i.target).scrollTop(u-m)}e=!1,s.useBothWheelAxes?l&&!r?(d?a.scrollTop(a.scrollTop()-d*s.wheelSpeed):a.scrollTop(a.scrollTop()+h*s.wheelSpeed),e=!0):r&&!l&&(h?($=!0,a.scrollLeft(a.scrollLeft()+h*s.wheelSpeed)):a.scrollLeft(a.scrollLeft()-d*s.wheelSpeed),e=!0):(a.scrollTop(a.scrollTop()-d*s.wheelSpeed),a.scrollLeft(a.scrollLeft()+h*s.wheelSpeed)),H(),(e=e||j(h,d))&&(i.stopPropagation(),i.preventDefault())})),a.bind("MozMousePixelScroll"+F,(function(t){e&&t.preventDefault()}))}(),s.useKeyboard&&(M=!1,a.bind("mouseenter"+F,(function(t){M=!0})),a.bind("mouseleave"+F,(function(t){M=!1})),t(document).bind("keydown"+F,(function(e){if(M&&!t(document.activeElement).is(":input,[contenteditable]")){var i=0,n=0;switch(e.which){case 37:i=-30;break;case 38:n=30;break;case 39:i=30;break;case 40:n=-30;break;case 33:n=90;break;case 32:case 34:n=-90;break;case 35:n=-h;break;case 36:n=h;break;default:return}a.scrollTop(a.scrollTop()-n),a.scrollLeft(a.scrollLeft()+i),j(i,n)&&e.preventDefault()}}))),a.data("perfect-scrollbar",a),a.data("perfect-scrollbar-update",H),a.data("perfect-scrollbar-destroy",W),a}))}})),void 0===Common)var Common={};if(define("common/main/lib/component/Scroller",["jmousewheel","perfectscrollbar","common/main/lib/component/BaseView"],(function(){"use strict";var t;Common.UI.Scroller=_.extend(Common.UI.BaseView.extend({options:{wheelSpeed:20,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:5,scrollYMarginOffset:5,includePadding:!0,includeMargin:!0,alwaysVisibleX:!1,alwaysVisibleY:!1,scrollYStyle:null},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.options.el&&this.render()},render:function(){var t=this;return t.cmpEl=t.$el||$(this.el),t.rendered||(t.cmpEl.perfectScrollbar(_.extend({},t.options)),t.rendered=!0,this.setAlwaysVisibleX(t.options.alwaysVisibleX),this.setAlwaysVisibleY(t.options.alwaysVisibleY),this.options.scrollYStyle&&this.setOptionStyleY(this.options.scrollYStyle)),this},remove:function(){this.destroy(),Backbone.View.prototype.remove.call(this)},update:function(e){var i=this.options;e?(this.destroy(),i=_.extend(this.options,e),this.cmpEl.perfectScrollbar(i)):this.cmpEl.perfectScrollbar("update"),this.setAlwaysVisibleX(i.alwaysVisibleX),this.setAlwaysVisibleY(i.alwaysVisibleY),i.scrollYStyle&&this.setOptionStyleY(i.scrollYStyle);var n=function(e){t=!0;var i=function(e){$(document).unbind("mouseup",i),_.delay((function(){t=!1}),10)};$(document).mouseup(i)};$(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y",this.cmpEl).off("mousedown",n).on("mousedown",n)},destroy:function(){this.cmpEl.perfectScrollbar("destroy")},scrollLeft:function(t){this.cmpEl.scrollLeft(t),this.update()},scrollTop:function(t){this.cmpEl.scrollTop(t),this.update()},getScrollTop:function(){return this.cmpEl.scrollTop()},getScrollLeft:function(){return this.cmpEl.scrollLeft()},setAlwaysVisibleX:function(t){t?($(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x")):($(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x"),$(this.el).find(".ps-scrollbar-x").addClass("always-visible-x"))},setAlwaysVisibleY:function(t){t?($(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y")):($(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y"),$(this.el).find(".ps-scrollbar-y").addClass("always-visible-y"))},setOptionStyleY:function(t){$(this.el).find(".ps-scrollbar-y-rail").css(t),this.cmpEl.perfectScrollbar("update")},isVisible:function(){return $(this.el).find(".ps-scrollbar-y-rail").is(":visible")}}),{isMouseCapture:function(){return t}})})),define("common/main/lib/view/About",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.Views.About=Common.UI.BaseView.extend(_.extend({menu:void 0,rendered:!1,options:{alias:"Common.Views.About"},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.txtVersionNum="9.0.57.1",!/\s$/.test(this.txtAddress)&&(this.txtAddress+=" "),!/\s$/.test(this.txtMail)&&(this.txtMail+=" "),!/\s$/.test(this.txtTel)&&(this.txtTel+=" "),!/\s$/.test(this.txtVersion)&&(this.txtVersion+=" "),this.template=_.template(['<table id="id-about-licensor-logo" cols="1" style="width: 100%; margin-top: 20px;">',"<tr>",'<td align="center"><div class="asc-about-office"></div></td>',"</tr>","<tr>",'<td align="center"><label class="asc-about-version">'+t.appName.toUpperCase()+"</label></td>","</tr>","<tr>",'<td align="center"><label class="asc-about-version" id="id-about-licensor-version-name">'+this.txtVersion+this.txtVersionNum+"</label></td>","</tr>","</table>",'<table id="id-about-licensor-info" cols="3" style="width: 100%;" class="margin-bottom">',"<tr>",'<td colspan="3" align="center" style="padding: 20px 0 10px 0;"><label class="asc-about-companyname"><%= publishername %></label></td>',"</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtAddress+"</label>",'<label class="asc-about-desc"><%= publisheraddr %></label>',"</td>","</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtMail+"</label>",'<a href="mailto:<%= supportemail %>"><%= supportemail %></a>',"</td>","</tr>","<tr>",'<td colspan="3" align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtTel+"</label>",'<label class="asc-about-desc" dir="ltr"><%= phonenum %></label>',"</td>","</tr>","<tr>",'<td colspan="3" align="center">','<a href="<%= publisherurl %>" target="_blank"><% print(publisherurl.replace(/https?:\\/{2}/, "").replace(/\\/$/,"")) %></a>',"</td>","</tr>","</table>",'<table id="id-about-licensee-info" cols="1" style="width: 100%; margin-top: 20px;" class="hidden margin-bottom"><tbody>',"<tr>",'<td align="center" class="padding-small"><div id="id-about-company-logo"></div></td>',"</tr>","<tr>",'<td align="center"><label class="asc-about-version">'+t.appName.toUpperCase()+"</label></td>","</tr>","<tr>",'<td align="center"><label style="padding-bottom: 29px;" class="asc-about-version" id="id-about-licensee-version-name">'+this.txtVersion+this.txtVersionNum+"</label></td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-companyname" id="id-about-company-name"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtAddress+"</label>",'<label class="asc-about-desc" id="id-about-company-address"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtMail+"</label>",'<a href="mailto:" id="id-about-company-mail"></a>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<label class="asc-about-desc-name">'+this.txtTel+"</label>",'<label class="asc-about-desc" id="id-about-company-tel"></label>',"</td>","</tr>","<tr>",'<td align="center" class="padding-small">','<a href="" target="_blank" id="id-about-company-url"></a>',"</td>","</tr>","<tr>",'<td align="center">','<label class="asc-about-lic" id="id-about-company-lic"></label>',"</td>","</tr>","</table>",'<table id="id-about-licensor-short" cols="1" style="width: 100%; margin-top: 31px;" class="hidden"><tbody>',"<tr>",'<td style="width:50%;"><div class="separator horizontal short left"></div></td>','<td align="center"><label class="asc-about-header">'+this.txtPoweredBy+"</label></td>",'<td style="width:50%;"><div class="separator horizontal short"></div></td>',"</tr>","<tr>",'<td colspan="3" align="center" style="padding: 9px 0 10px;"><label class="asc-about-companyname"><%= publishername %></label></td>',"</tr>","<tr>",'<td colspan="3" align="center">','<a href="<%= publisherurl %>" target="_blank"><% print(publisherurl.replace(/https?:\\/{2}/, "").replace(/\\/$/,"")) %></a>',"</td>","</tr>","</table>"].join("")),this.menu=t.menu},render:function(){if(!this.rendered){this.rendered=!0;var t=$(this.template({publishername:"Ascensio System SIA",publisheraddr:"20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050",publisherurl:"https://www.onlyoffice.com",supportemail:"1639670695@qq.com",phonenum:"+371 633-99867",scope:this}));this.cntLicenseeInfo=t.findById("#id-about-licensee-info"),this.cntLicensorInfo=t.findById("#id-about-licensor-info"),this.divCompanyLogo=t.findById("#id-about-company-logo"),this.lblCompanyName=t.findById("#id-about-company-name"),this.lblCompanyAddress=t.findById("#id-about-company-address"),this.lblCompanyMail=t.findById("#id-about-company-mail"),this.lblCompanyUrl=t.findById("#id-about-company-url"),this.lblCompanyLic=t.findById("#id-about-company-lic"),this.lblCompanyTel=t.findById("#id-about-company-tel"),this.$el.html(t),this.$el.addClass("about-dlg"),this.licData&&this.setLicInfo(this.licData),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0}))}return this},setLicInfo:function(t){if(this.rendered)if(t&&"object"==typeof t&&t.customer&&"object"==typeof t.customer){this.licData=t;var e=t.customer;$("#id-about-licensor-logo").addClass("hidden"),$("#id-about-licensor-short").removeClass("hidden"),this.cntLicensorInfo.addClass("hidden"),this.cntLicenseeInfo.removeClass("hidden"),this.cntLicensorInfo.removeClass("margin-bottom");var i=e.name;if(i&&i.length?this.lblCompanyName.text(i):this.lblCompanyName.parents("tr").addClass("hidden"),(i=e.address)&&i.length?this.lblCompanyAddress.text(i):this.lblCompanyAddress.parents("tr").addClass("hidden"),(i=e.mail)&&i.length?this.lblCompanyMail.attr("href","mailto:"+i).text(i):this.lblCompanyMail.parents("tr").addClass("hidden"),(i=e.phone)&&i.length?this.lblCompanyTel.text(i):this.lblCompanyTel.parents("tr").addClass("hidden"),(i=e.www)&&i.length){var n=/^https?:\/{2}/i.test(i)?"":"http://";this.lblCompanyUrl.attr("href",n+i).text(i)}else this.lblCompanyUrl.parents("tr").addClass("hidden");(i=e.info)&&i.length?this.lblCompanyLic.text(i):this.lblCompanyLic.parents("tr").addClass("hidden"),(i=Common.UI.Themes.isDarkTheme()?e.logoDark||e.logo:e.logo||e.logoDark)&&i.length?this.divCompanyLogo.html('<img src="'+i+'" style="max-width:216px; max-height: 35px;" />'):this.divCompanyLogo.parents("tr").addClass("hidden"),i&&i.length&&Common.NotificationCenter.on("uitheme:changed",this.changeLogo.bind(this))}else this.cntLicenseeInfo.addClass("hidden"),this.cntLicensorInfo.addClass("margin-bottom");else this.licData=t||!0},changeLogo:function(){if(this.licData){var t=this.licData.customer;t.logo&&t.logoDark&&t.logo!==t.logoDark&&this.divCompanyLogo.find("img").attr("src",Common.UI.Themes.isDarkTheme()?t.logoDark||t.logo:t.logo||t.logoDark)}},show:function(){this.rendered||this.render(),Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},setMode:function(t){t.isLightVersion&&($("#id-about-licensor-version-name").text(this.txtEdition+this.txtVersion+this.txtVersionNum),$("#id-about-licensee-version-name").text(this.txtEdition+this.txtVersion+this.txtVersionNum))},txtPoweredBy:"Powered by",txtVersion:"Version ",txtLicensor:"LICENSOR",txtLicensee:"LICENSEE",txtAddress:"address: ",txtMail:"email: ",txtTel:"tel.: ",txtEdition:"Integration Edition "},Common.Views.About||{}))})),define("text!visioeditor/main/app/template/FileMenu.template",[],(function(){return'<div class="panel-menu" role="menubar" aria-label="<%= scope.ariaFileMenu %>">\n    <li id="fm-btn-return" class="fm-btn" data-layout-name="toolbar-file-close"></li>\n    <li class="devider devider-small"></li>\n    <li id="fm-btn-create" class="fm-btn"></li>\n    <li id="fm-btn-recent" class="fm-btn"></li>\n    <li class="devider devider-small"></li>\n    <li id="fm-btn-download" class="fm-btn"></li>\n    <li id="fm-btn-save-copy" class="fm-btn"></li>\n    <li id="fm-btn-save-desktop" class="fm-btn"></li>\n    <li id="fm-btn-print" class="fm-btn"></li>\n    <li id="fm-btn-rename" class="fm-btn"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-info" class="fm-btn" data-layout-name="toolbar-file-info"></li>\n    <li id="fm-btn-rights" class="fm-btn"></li>\n    <li id="fm-btn-back" class="fm-btn"></li>\n    <li class="devider-last"></li>\n    <li class="devider"></li>\n    <li id="fm-btn-settings" class="fm-btn" data-layout-name="toolbar-file-settings"></li>\n    <li id="fm-btn-help" class="fm-btn"></li>\n</div>\n<div class="panel-context">\n    <div id="panel-saveas" class="content-box"></div>\n    <div id="panel-savecopy" class="content-box"></div>\n    <div id="panel-recentfiles" class="content-box"></div>\n    <div id="panel-createnew" class="content-box"></div>\n    <div id="panel-info" class="content-box"></div>\n    <div id="panel-rights" class="content-box"></div>\n    <div id="panel-settings" class="content-box"></div>\n    <div id="panel-help" class="content-box"></div>\n</div>'})),void 0===Common)var Common={};function onDropDownKeyDown(t){var e=$(this),i=e.parent(),n=jQuery.Event("keydown.before.bs.dropdown",{keyCode:t.keyCode}),o=jQuery.Event("keydown.after.bs.dropdown",{keyCode:t.keyCode});i.trigger(n),i.hasClass("no-stop-propagate")?(arguments.length>1&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),!/^(38|40|27|13|9|37|39)$/.test(t.keyCode)||t.ctrlKey||t.altKey||(patchDropDownKeyDownAdditional.call(this,t),/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()))):e.hasClass("move-focus")?(!/^(13|9|32)/.test(t.keyCode)&&(27!==t.keyCode||i.hasClass("open"))||t.ctrlKey||t.altKey)&&(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()):(patchDropDownKeyDown.call(this,t),t.preventDefault(),t.stopPropagation()),i.trigger(o)}function checkFocusedItem(t,e){var i=t.innerHeight(),n=(i-t.height())/2,o=Common.Utils.getPosition(e).top,s=e.outerHeight();o<0?t.scrollTop(t.scrollTop()+o-n):o+s>i&&t.scrollTop(t.scrollTop()+o+s-i+n)}function patchDropDownKeyDown(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&27==t.keyCode){if(27==t.which){if((o=$("[role=menu] li.dropdown-submenu.over:visible",i)).length)return o.eq(o.length-1).removeClass("over"),!1;i.hasClass("dropdown-submenu")&&i.hasClass("over")?(i.removeClass("over"),i.find("> a").focus()):i.find("[data-toggle=dropdown]").focus()}return n?e.click():void 0}var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(":focus"));if(39==t.keyCode){if(s<0)return;var a=o.eq(s).parent();a.hasClass("dropdown-submenu")&&!a.hasClass("over")&&(a.mouseenter(),a.addClass("focused-submenu"),_.delay((function(){var t=$("> [role=menu]",a),e=t.find("> li:not(.divider):not(.disabled):visible > a"),i=t.find("> li:not(.divider):not(.disabled):visible .dataview"),n=t.find("> li:not(.divider):not(.disabled):visible .theme-colorpalette.focused"),o=t.find("> li:not(.divider):not(.disabled):visible ul.internal-menu");e.length>0&&i.length<1&&o.length<1&&n.length<1&&e.index(e.filter(":focus"))<0&&e.eq(0).focus()}),250))}else 37==t.keyCode?i.hasClass("dropdown-submenu")&&i.hasClass("over")&&(i.removeClass("over"),i.find("> a").focus()):(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),i.hasClass("dropdown-submenu")&&i.hasClass("over")&&i.addClass("focused-submenu"),checkFocusedItem(e,o.eq(s)),o.eq(s).focus())}}}}function patchDropDownKeyDownAdditional(t){if(/(38|40|27|37|39)/.test(t.keyCode)){var e=$(this);if(/(37|39)/.test(t.keyCode)||(t.preventDefault(),t.stopPropagation()),!e.is(".disabled, :disabled")){var i=getParent(e),n=i.hasClass("open")||i.hasClass("over");if(!n||n&&(27==t.keyCode||37==t.keyCode||39==t.keyCode))return n?e.click():void 0;var o=$("> [role=menu] > li:not(.divider):not(.disabled):visible",i).find("> a");if(o.length){var s=o.index(o.filter(".focus")),a=s;if(38==t.keyCode?s>0?s--:s=e.hasClass("no-cyclic")?0:o.length-1:40==t.keyCode&&(s<o.length-1?s++:s=e.hasClass("no-cyclic")?o.length-1:0),~s||(s=0),o.removeClass("focus"),o.eq(s).addClass("focus"),a!==s){var r=o.eq(a).parent().data("bs.tooltip");r&&r.hide(),(r=o.eq(s).parent().data("bs.tooltip"))&&r.show()}}}}}function getParent(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i=e&&$(e);return i&&i.length?i:t.parent()}function clearMenus(t){$(".dropdown-toggle").each((function(e){var i=$(this).parent();i.hasClass("open")&&("prevent-canvas-click"!=i.attr("data-value")?(i.trigger(e=$.Event("hide.bs.dropdown")),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",t)):i.attr("data-value",""))}))}function toggle(){$(".dropdown-backdrop").remove()}if(Common.Views=Common.Views||{},define("common/main/lib/view/RecentFiles",["common/main/lib/component/BaseView"],(function(){"use strict";Common.Views.RecentFiles=Common.UI.BaseView.extend(_.extend({menu:void 0,template:_.template(['<div class="header"><%= scope.txtOpenRecent %></div>','<div id="id-recent-view"></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.recent=t.recent,this.el=t.el,Common.NotificationCenter.on("update:recents",function(t){if(this.viewRecentPicker){const e=this.viewRecentPicker.store;e&&e.reset(this.recent.concat(t))}}.bind(this))},render:function(){return this.$el.html(this.template({scope:this})),this.viewRecentPicker=new Common.UI.DataView({el:$("#id-recent-view"),store:new Common.UI.DataViewStore(this.recent),itemTemplate:_.template(['<div class="recent-wrap">','<div class="recent-icon">',"<div>",'<div class= <% if (typeof format !== "undefined") {%> "img-format-<%=format %>"<% } else {%> "svg-file-recent"<%} %>></div>',"</div>","</div>",'<div class="file-name"><% if (typeof title !== "undefined") {%><%= Common.Utils.String.htmlEncode(title || "") %><% } %></div>','<div class="file-info"><% if (typeof folder !== "undefined") {%><%= Common.Utils.String.htmlEncode(folder || "") %><% } %></div>',"</div>"].join(""))}),this.viewRecentPicker.on("item:click",_.bind(this.onRecentFileClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onRecentFileClick:function(t,e,i){this.menu&&!Common.Controllers.Desktop.openRecent(i)&&this.menu.fireEvent("recent:open",[this.menu,i.get("url")])},txtOpenRecent:"Open Recent"},Common.Views.RecentFiles||{}))})),define("visioeditor/main/app/view/FileMenu",["text!visioeditor/main/app/template/FileMenu.template","underscore","common/main/lib/component/BaseView","common/main/lib/view/RecentFiles"],(function(t,e){"use strict";VE.Views.FileMenu=Common.UI.BaseView.extend(e.extend({el:"#file-menu-panel",rendered:!1,options:{alias:"FileMenu"},template:e.template(t),events:function(){return{"click .fm-btn":e.bind((function(t){var i=$(t.currentTarget);if(!i.hasClass("disabled")){i.hasClass("active")||($(".fm-btn",this.el).removeClass("active"),i.addClass("active"));var n=e.findWhere(this.items,{el:t.currentTarget});if(n){var o=this.panels[n.options.action];if("help"===n.options.action&&!0===o.noHelpContents&&navigator.onLine){this.fireEvent("item:click",[this,"external-help",!0]);const t=Common.Utils.InternalSettings.get("url-help-center");return void(t&&window.open(t,"_blank"))}this.fireEvent("item:click",[this,n.options.action,!!o]),o&&(this.$el.find(".content-box:visible").hide(),this.active=n.options.action,o.show())}}}),this)}},initialize:function(){},render:function(){var t=$(this.template({scope:this}));if(this.miClose=new Common.UI.MenuItem({el:t.elementById("#fm-btn-return"),action:"back",caption:this.btnCloseMenuCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-previtem icon-rtl"}),this.miDownload=new Common.UI.MenuItem({el:t.elementById("#fm-btn-download"),action:"saveas",caption:this.btnDownloadCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-download"}),this.miSaveCopyAs=new Common.UI.MenuItem({el:t.elementById("#fm-btn-save-copy"),action:"save-copy",caption:this.btnSaveCopyAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-save-copy"}),this.miSaveAs=new Common.UI.MenuItem({el:t.elementById("#fm-btn-save-desktop"),action:"save-desktop",caption:this.btnSaveAsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miPrint=new Common.UI.MenuItem({el:t.elementById("#fm-btn-print"),action:"print",caption:this.btnPrintCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],dataHintTitle:"P",iconCls:"menu__icon btn-print"}),this.miRename=new Common.UI.MenuItem({el:t.elementById("#fm-btn-rename"),action:"rename",caption:this.btnRenameCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-rename"}),this.options.miRename&&(this.miRename.setDisabled(this.options.miRename.isDisabled()),delete this.options.miRename),this.miRecent=new Common.UI.MenuItem({el:t.elementById("#fm-btn-recent"),action:"recent",caption:this.btnRecentFilesCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[2,14]}),this.miNew=new Common.UI.MenuItem({el:t.elementById("#fm-btn-create"),action:"new",caption:this.btnCreateNewCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-create-new"}),this.miInfo=new Common.UI.MenuItem({el:t.elementById("#fm-btn-info"),action:"info",caption:this.btnInfoCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-menu-about"}),this.miAccess=new Common.UI.MenuItem({el:t.elementById("#fm-btn-rights"),action:"rights",caption:this.btnRightsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-users-share"}),this.miHelp=new Common.UI.MenuItem({el:t.elementById("#fm-btn-help"),action:"help",caption:this.btnHelpCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-help"}),this.miSettings=new Common.UI.MenuItem({el:t.elementById("#fm-btn-settings"),action:"opts",caption:this.btnSettingsCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-settings"}),this.miBack=new Common.UI.MenuItem({el:t.elementById("#fm-btn-back"),action:"exit",caption:this.btnBackCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-goback"}),this.items=[],this.items.push(this.miClose,this.miDownload,this.miSaveCopyAs,this.miSaveAs,this.miPrint,this.miRename,this.miRecent,this.miNew,this.miInfo,this.miAccess,this.miSettings,this.miHelp,this.miBack),this.rendered=!0,this.$el.html(t),this.$el.find(".content-box").hide(),e.isUndefined(this.scroller)){var i=this;this.scroller=new Common.UI.Scroller({el:this.$el.find(".panel-menu"),suppressScrollX:!0,alwaysVisibleY:!0}),Common.NotificationCenter.on("window:resize",(function(){i.scroller.update()}))}return this.applyMode(),Common.Controllers.Desktop.isActive()&&Common.NotificationCenter.trigger("update:recents",Common.Controllers.Desktop.recentFiles()),this.api&&(this.panels.info.setApi(this.api),this.panels.opts&&this.panels.opts.setApi(this.api)),this.fireEvent("render:after",[this]),this},show:function(t,e){if((!this.isVisible()||void 0!==t)&&this.mode&&Common.Controllers.LaunchController.isScriptLoaded()){this.rendered||this.render();var i=!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"info":"saveas";t||(t=this.active||i),this.$el.show(),this.scroller.update(),this.selectMenu(t,e,i),this.api&&this.api.asc_enableKeyEvents(!1),this.fireEvent("menu:show",[this])}},hide:function(){this.$el.hide(),this.fireEvent("menu:hide",[this])},applyMode:function(){if(this.rendered&&(this.panels||(this.panels={opts:new VE.Views.FileMenuPanels.Settings({menu:this}).render(this.$el.find("#panel-settings")),info:new VE.Views.FileMenuPanels.DocumentInfo({menu:this}).render(this.$el.find("#panel-info")),rights:new VE.Views.FileMenuPanels.DocumentRights({menu:this}).render(this.$el.find("#panel-rights"))}),this.mode)){var t=Common.UI.LayoutManager.isElementVisible("toolbar-file-close");this.miClose[t?"show":"hide"](),this.miDownload[!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline?"hide":"show"]();var e=!!Common.Controllers.Desktop.isActive()&&Common.Controllers.Desktop.call("isBlockchainSupport");this.miSaveCopyAs[!this.mode.canDownload||this.mode.isDesktopApp&&this.mode.isOffline||!this.mode.canRequestSaveAs&&!this.mode.saveAsUrl||e?"hide":"show"](),this.miSaveAs[this.mode.canDownload&&this.mode.isDesktopApp&&this.mode.isOffline?"show":"hide"](),this.miPrint[this.mode.canPrint&&!this.mode.canPreviewPrint?"show":"hide"](),this.miRename[this.mode.canRename&&!this.mode.isDesktopApp?"show":"hide"](),this.miRecent[this.mode.canOpenRecent?"show":"hide"](),this.miNew[this.mode.canCreateNew?"show":"hide"](),t=Common.UI.LayoutManager.isElementVisible("toolbar-file-info"),this.miInfo[t?"show":"hide"](),t=!this.mode.isOffline&&this.document&&this.document.info&&(this.document.info.sharingSettings&&this.document.info.sharingSettings.length>0||this.mode.sharingSettingsUrl&&this.mode.sharingSettingsUrl.length||this.mode.canRequestSharingSettings),this.miAccess[t?"show":"hide"](),t=Common.UI.LayoutManager.isElementVisible("toolbar-file-settings"),this.miSettings[t?"show":"hide"](),t=this.mode.canHelp,this.miHelp[t?"show":"hide"](),t=this.mode.canBack,this.miBack[t?"show":"hide"](),this.customizationDone||(this.customizationDone=!0,this.mode.canBack&&this.mode.customization.goback.text&&"string"==typeof this.mode.customization.goback.text&&this.miBack.setCaption(this.mode.customization.goback.text)),this.panels.opts.setMode(this.mode),this.panels.info.setMode(this.mode),!this.mode.isDisconnected&&this.panels.info.updateInfo(this.document),this.panels.rights.setMode(this.mode),!this.mode.isDisconnected&&this.panels.rights.updateInfo(this.document),this.mode.canCreateNew&&this.mode.templates&&this.mode.templates.length&&!this.panels.new&&(this.panels.new=new VE.Views.FileMenuPanels.CreateNew({menu:this,docs:this.mode.templates,blank:this.mode.canRequestCreateNew||!!this.mode.createUrl}).render()),this.mode.canOpenRecent&&this.mode.recent&&!this.panels.recent&&(this.panels.recent=new Common.Views.RecentFiles({el:"#panel-recentfiles",menu:this,recent:this.mode.recent}).render()),this.mode.canDownload&&!this.panels.saveas&&(this.panels.saveas=new VE.Views.FileMenuPanels.ViewSaveAs({menu:this,fileType:this.document.fileType}).render()),this.mode.canDownload&&(this.mode.canRequestSaveAs||this.mode.saveAsUrl)&&!this.panels["save-copy"]&&(this.panels["save-copy"]=new VE.Views.FileMenuPanels.ViewSaveCopy({menu:this,fileType:this.document.fileType}).render()),this.mode.canHelp&&!this.panels.help&&(this.panels.help=new VE.Views.FileMenuPanels.Help({menu:this}).render(),this.panels.help.setLangConfig(this.mode.lang)),Common.Controllers.Desktop.isActive()?(this.$el.find("#fm-btn-local-open").length<1&&($('<li id="fm-btn-local-open" class="fm-btn"/>').insertBefore($("#fm-btn-recent",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-local-open",this.$el),action:"file:open",caption:this.btnFileOpenCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-open"}))),this.$el.find("#fm-btn-exit").length<1&&($('<li class="devider" /><li id="fm-btn-exit" class="fm-btn"/>').insertAfter($("#fm-btn-back",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-exit",this.$el),action:"file:exit",caption:this.btnExitCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-close"})))):this.mode.canCloseEditor&&this.$el.find("#fm-btn-close").length<1&&($('<li class="devider" /><li id="fm-btn-close" class="fm-btn"/>').insertAfter($("#fm-btn-back",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-close",this.$el),action:"close-editor",caption:this.mode.customization.close.text||this.btnCloseEditor,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-close"}))),this.mode.canSwitchToMobile&&($('<li id="fm-btn-switchmobile" class="fm-btn"></li>').insertBefore($("#fm-btn-settings",this.$el)),this.items.push(new Common.UI.MenuItem({el:$("#fm-btn-switchmobile",this.$el),action:"switch:mobile",caption:this.btnSwitchToMobileCaption,canFocused:!1,dataHint:1,dataHintDirection:"left-top",dataHintOffset:[-2,22],iconCls:"menu__icon btn-switch-mobile"}))),this.hideDividers()}},hideDividers:function(){const t=Array.from(this.$el.find(".panel-menu > li")),e=t.map(((t,e)=>({el:t,i:e}))).filter((({el:t})=>$(t).hasClass("fm-btn")&&"none"!==$(t).css("display")));if(!e.length)return void t.forEach((t=>{const e=$(t);e.hasClass("devider")&&e.css("display","none")}));const i=e[0].i,n=e[e.length-1].i;let o=!1;for(let e=t.length-1;e>=0;e--){const s=$(t[e]);if(s.hasClass("devider")){e>i&&e<n&&!o?(s.show(),o=!0):s.hide()}else s.hasClass("fm-btn")&&"none"!==s.css("display")&&(o=!1)}},setMode:function(t,e){t.isDisconnected?(this.mode.canEdit=this.mode.isEdit=!1,this.mode.canOpenRecent=this.mode.canCreateNew=!1,this.mode.isDisconnected=t.isDisconnected,this.mode.canRename=!1,t.enableDownload||(this.mode.canPrint=this.mode.canDownload=!1)):this.mode=t,e||this.applyMode()},setApi:function(t){return this.api=t,this.rendered&&(this.panels.info.setApi(t),this.panels.opts&&this.panels.opts.setApi(t)),this.api.asc_registerCallback("asc_onDocumentName",e.bind(this.onDocumentName,this)),this},loadDocument:function(t){this.document=t.doc},selectMenu:function(t,e,i){if(t){var n=this._getMenuItem(t),o=this.panels[t];if(!n.isDisabled()&&n.isVisible()||(n=this._getMenuItem(i),o=this.panels[i]),n&&o){if($(".fm-btn",this.el).removeClass("active"),n.$el.addClass("active"),this.$el.find(".content-box:visible").hide(),o.show(e),this.scroller){var s=Common.Utils.getPosition(n.$el).top,a=n.$el.outerHeight(),r=this.$el.outerHeight();if(s<0||s+a>r){var l=this.scroller.$el.scrollTop()+s+(a-r)/2;l=Math.floor(l/a)*a,this.scroller.scrollTop(l)}}this.active=t}}},disableMenu:function(t,e){if(t){var i=this._getMenuItem(t);i&&i.setDisabled(e)}},_getMenuItem:function(t){return e.find(this.items,(function(e){return e.options.action==t}))},onDocumentName:function(t){this.document.title=t,this.rendered&&this.panels.info.updateInfo(this.document)},isVisible:function(){return!this.$el.is(":hidden")},getButton:function(t){if(this.rendered){if("rename"==t)return this.miRename}else if("rename"==t)return this.options.miRename?this.options.miRename:this.options.miRename=new Common.UI.MenuItem({})},SetDisabled:function(t,e){},btnDownloadCaption:"Download as...",btnInfoCaption:"Document Info...",btnRightsCaption:"Access Rights...",btnCreateNewCaption:"Create New",btnRecentFilesCaption:"Open Recent...",btnPrintCaption:"Print",btnHelpCaption:"Help...",btnReturnCaption:"Back to Document",btnBackCaption:"Go to Documents",btnSettingsCaption:"Advanced Settings...",btnSaveAsCaption:"Save as",btnRenameCaption:"Rename...",btnCloseMenuCaption:"Back",btnSaveCopyAsCaption:"Save Copy as...",btnExitCaption:"Exit",btnFileOpenCaption:"Open...",btnCloseEditor:"Close File",ariaFileMenu:"File menu"},VE.Views.FileMenu||{}))})),define("visioeditor/main/app/view/LeftMenu",["text!visioeditor/main/app/template/LeftMenu.template","jquery","underscore","backbone","common/main/lib/component/SideMenu","common/main/lib/component/Button","common/main/lib/view/Chat","common/main/lib/view/Plugins","common/main/lib/view/About","visioeditor/main/app/view/FileMenu"],(function(t,e,i,n){"use strict";var o=40;VE.Views.LeftMenu=Common.UI.SideMenu.extend(i.extend({el:"#left-menu",template:i.template(t),initialize:function(){this.minimizedMode=!0,this._state={disabled:!1}},render:function(){var t=e(this.template({scope:this}));return this.btnMoreContainer=t.find("#slot-left-menu-more"),Common.UI.SideMenu.prototype.render.call(this),this.btnMore.menu.menuAlign="tl-tr",this.btnSearchBar=new Common.UI.Button({action:"advancedsearch",el:t.elementById("#left-btn-searchbar"),hint:this.tipSearch,disabled:!0,iconCls:"btn-menu-search",enableToggle:!0,toggleGroup:"leftMenuGroup"}),this.btnSearchBar.on("click",this.onBtnMenuClick.bind(this)),this.btnAbout=new Common.UI.Button({action:"about",el:t.elementById("#left-btn-about"),hint:this.tipAbout,enableToggle:!0,disabled:!0,iconCls:"btn-menu-about",toggleGroup:"leftMenuGroup"}),this.btnAbout.on("toggle",this.onBtnMenuToggle.bind(this)),this.btnSupport=new Common.UI.Button({action:"support",el:t.elementById("#left-btn-support"),hint:this.tipSupport,iconCls:"btn-menu-support",disabled:!0}),this.btnSupport.on("click",i.bind((function(){var t=this.mode.customization;t&&t.feedback&&t.feedback.url?window.open(t.feedback.url):window.open("https://support.onlyoffice.com"),Common.NotificationCenter.trigger("edit:complete",this)}),this)),this.btnChat=new Common.UI.Button({el:t.elementById("#left-btn-chat"),hint:this.tipChat+Common.Utils.String.platformKey("Alt+Q"," ("+(Common.Utils.isMac?Common.Utils.String.textCtrl+"+":"")+"{0})"),enableToggle:!0,disabled:!0,iconCls:"btn-menu-chat",toggleGroup:"leftMenuGroup"}),this.btnChat.on("click",this.onBtnMenuClick.bind(this)),this.btnChat.hide(),this.menuFile=new VE.Views.FileMenu,this.btnAbout.panel=new Common.Views.About({el:"#about-menu-panel",appName:this.txtEditor}),this.btnThumbs=new Common.UI.Button({action:"thumbs",el:t.elementById("#left-btn-thumbs"),hint:this.tipPages,enableToggle:!0,disabled:!0,iconCls:"btn-menu-thumbs",toggleGroup:"leftMenuGroup"}),this.btnThumbs.on("click",i.bind(this.onBtnMenuClick,this)),this.$el.html(t),this},onBtnMenuToggle:function(t,e){e?(t.panel.show(),this._state.pluginIsRunning||this.$el.width(o)):t.panel.hide(),VE.getController("Toolbar").DisableToolbar(1==e),this.supressEvents||Common.NotificationCenter.trigger("layout:changed","leftmenu")},onBtnMenuClick:function(t,i){if(this.supressEvents=!0,this.btnAbout.pressed&&this.btnAbout.toggle(!1),"thumbs"==t.options.action){if(!t.pressed&&this._state.pluginIsRunning)this.$el.width(Common.localStorage.getItem("ve-mainmenu-width")||300);else(n=this.$el.width())>o&&(Common.localStorage.setItem("ve-mainmenu-width",n),this.$el.width(o)),this._state.pluginIsRunning&&this.onCoauthOptions()}else{if(t.pressed)this.$el.width()>o||this.$el.width(Common.localStorage.getItem("ve-mainmenu-width")||300);else if(!this._state.pluginIsRunning){var n=this.$el.width();this.isVisible()&&n>o&&Common.localStorage.setItem("ve-mainmenu-width",n),this.$el.width(o)}this.onCoauthOptions()}"plugin"!==t.options.type&&e(".left-panel .plugin-panel").toggleClass("active",!1),this.fireEvent("panel:show",[this,t.options.action,t.pressed]),Common.NotificationCenter.trigger("layout:changed","leftmenu"),this.supressEvents=!1},onCoauthOptions:function(t){this.mode.canCoAuthoring&&this.mode.canChat&&(this.btnChat.pressed?(this.btnChat.$el.hasClass("notify")&&this.btnChat.$el.removeClass("notify"),this.panelChat.show(),this.panelChat.focus()):this.panelChat.hide()),this.panelSearch&&(this.btnSearchBar.pressed?(this.panelSearch.show(),this.panelSearch.focus()):this.panelSearch.hide())},getFocusElement:function(){var t=!1;return this.btnChat&&this.btnChat.pressed?t=this.panelChat.getFocusElement():this.btnSearchBar&&this.btnSearchBar.pressed&&(t=this.panelSearch.getFocusElement()),t},setOptionsPanel:function(t,e){"chat"==t?this.panelChat=e.render("#left-panel-chat"):"advancedsearch"==t&&(this.panelSearch=e.render("#left-panel-search"))},markCoauthOptions:function(t,e){"chat"!=t||!this.btnChat.isVisible()&&!this.isButtonInMoreMenu(this.btnChat)||this.btnChat.isDisabled()||this.btnChat.pressed||this.btnChat.$el.addClass("notify")},close:function(t){this.menuFile.isVisible()?this.menuFile.hide():(this.btnAbout.toggle(!1),this.btnThumbs.toggle(!1,!this.mode),this._state.pluginIsRunning||this.$el.width(o),this.mode&&this.mode.canCoAuthoring&&this.mode.canChat&&(this.panelChat&&this.panelChat.hide(),this.btnChat.toggle(!1)),this.panelSearch&&(this.panelSearch.hide(),this.btnSearchBar.toggle(!1,!0)),this.toggleActivePluginButton(!1))},isOpened:function(){var t=this.btnSearchBar.pressed;return!t&&(t=this.btnChat.pressed),t},disableMenu:function(t,e){this.btnSearchBar.setDisabled(!1),this.btnAbout.setDisabled(!1),this.btnSupport.setDisabled(!1),this.btnChat.setDisabled(!1),this.btnThumbs.setDisabled(e),this.setDisabledAllMoreMenuItems(!1)},showMenu:function(t,e,i){var n=/^(\w+):?(\w*)$/.exec(t);if("file"==n[1]){if(!Common.Controllers.LaunchController.isScriptLoaded())return;this.menuFile.isVisible(),this.menuFile.show(n[2].length?n[2]:void 0,e)}else"chat"==t?!this.btnChat.isVisible()&&!this.isButtonInMoreMenu(this.btnChat)||this.btnChat.isDisabled()||this.btnChat.pressed||(this.btnChat.toggle(!0),this.onBtnMenuClick(this.btnChat),this.panelChat.focus()):"advancedsearch"==t&&(!this.btnSearchBar.isVisible()&&!this.isButtonInMoreMenu(this.btnSearchBar)||this.btnSearchBar.isDisabled()||this.btnSearchBar.pressed||(this.btnSearchBar.toggle(!0),this.onBtnMenuClick(this.btnSearchBar),this.panelSearch.focus(),!i&&this.fireEvent("search:aftershow",this)))},getMenu:function(t){switch(t){default:return null;case"file":return this.menuFile;case"about":return this.btnAbout.panel}},setMode:function(t){return this.mode=t,this.btnAbout.panel.setMode(t),this},setDeveloperMode:function(t,n,o){if(this.$el.is(":visible")){if((t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)&&!this.developerHint){var s="";t&Asc.c_oLicenseMode.Trial&&t&Asc.c_oLicenseMode.Developer?s=this.txtTrialDev:0!=(t&Asc.c_oLicenseMode.Trial)?s=this.txtTrial:0!=(t&Asc.c_oLicenseMode.Developer)&&(s=this.txtDeveloper),s=s.toUpperCase(),this.developerHint=e('<div id="developer-hint">'+s+"</div>").appendTo(this.$el),this.devHeight=this.developerHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}if(this.developerHint&&this.developerHint.toggleClass("hidden",!(t&Asc.c_oLicenseMode.Trial||t&Asc.c_oLicenseMode.Developer)),n&&!this.betaHint){var a=t?'style="margin-top: 4px;"':"",r=(o||"").split("."),l="";r.length>0&&(l+="v. "+r[0]),r.length>1&&(l+="."+r[1]),this.betaHint=e('<div id="beta-hint"'+a+">"+l+" (beta)</div>").appendTo(this.$el),this.betaHeight=this.betaHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}this.betaHint&&this.betaHint.toggleClass("hidden",!n);var c=this.$el.find("button.btn-category:visible"),h=c.length>0?e(c[c.length-1]):null;this.minDevPosition=h?Common.Utils.getOffset(h).top-Common.Utils.getOffset(h.offsetParent()).top+h.height()+20:20,this.onWindowResize()}},setLimitMode:function(){if(this.$el.is(":visible")){if(!this.limitHint){var t=this.txtLimit.toUpperCase();this.limitHint=e('<div id="limit-hint" style="margin-top: 4px;">'+t+"</div>").appendTo(this.$el),this.limitHeight=this.limitHint.outerHeight(),!this.devHintInited&&e(window).on("resize",i.bind(this.onWindowResize,this)),this.devHintInited=!0}this.limitHint&&this.limitHint.toggleClass("hidden",!1);var n=this.$el.find("button.btn-category:visible"),o=n.length>0?e(n[n.length-1]):null;this.minDevPosition=o?Common.Utils.getOffset(o).top-Common.Utils.getOffset(o.offsetParent()).top+o.height()+20:20,this.onWindowResize()}},onWindowResize:function(){var t=(this.devHeight||0)+(this.betaHeight||0)+(this.limitHeight||0),e=Math.max((this.$el.height()-t)/2,this.minDevPosition);this.developerHint&&(this.developerHint.css("top",e),e+=this.devHeight),this.betaHint&&(this.betaHint.css("top",e),e+=this.betaHeight+4),this.limitHint&&this.limitHint.css("top",e)},isVisible:function(){return this.$el&&this.$el.is(":visible")},setButtons:function(){var t=[this.btnThumbs,this.btnChat,this.btnSupport,this.btnAbout];Common.UI.SideMenu.prototype.setButtons.apply(this,[t])},tipChat:"Chat",tipAbout:"About",tipSupport:"Feedback & Support",tipSearch:"Search",tipPlugins:"Plugins",tipPages:"Pages",txtDeveloper:"DEVELOPER MODE",txtTrial:"TRIAL MODE",txtTrialDev:"Trial Developer Mode",txtLimit:"Limit Access",txtEditor:"Visio Editor",ariaLeftMenu:"Left menu"},VE.Views.LeftMenu||{}))})),define("visioeditor/main/app/controller/Viewport",["core","common/main/lib/view/Header","visioeditor/main/app/view/Viewport","visioeditor/main/app/view/LeftMenu"],(function(t){"use strict";VE.Controllers.Viewport=Backbone.Controller.extend(_.assign({models:[],collections:[],views:["Viewport","Common.Views.Header"],initialize:function(){var t=this;this.addListeners({FileMenu:{"menu:hide":t.onFileMenu.bind(t,"hide"),"menu:show":t.onFileMenu.bind(t,"show"),"settings:apply":t.applySettings.bind(t)},Statusbar:{"view:compact":function(e,i){var n=parseInt(window.getComputedStyle(document.body).getPropertyValue("--statusbar-height")||25);t.viewport.vlayout.getItem("statusbar").height=i?n:2*n}},Toolbar:{"render:before":function(e){var i=VE.getController("Main").appOptions;e.setExtra("right",t.header.getPanel("right",i)),i.twoLevelHeader&&!i.compactHeader||e.setExtra("left",t.header.getPanel("left",i)),t.toolbar=e,t.header.btnSearch.hide()},"view:compact":function(e,i){t.viewport.vlayout.getItem("toolbar").height=i?Common.Utils.InternalSettings.get("toolbar-height-compact"):Common.Utils.InternalSettings.get("toolbar-height-normal")},"print:disabled":function(e){t.header.btnPrint&&t.header.btnPrint.setDisabled(e),t.header.btnPrintQuick&&t.header.btnPrintQuick.setDisabled(e)}}}),Common.NotificationCenter.on("tabstyle:changed",this.onTabStyleChange.bind(this)),Common.NotificationCenter.on("tabbackground:changed",this.onTabBackgroundChange.bind(this)),this._initEditing=!0},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",this.onApiCoAuthoringDisconnect.bind(this)),Common.NotificationCenter.on("api:disconnect",this.onApiCoAuthoringDisconnect.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this))},getApi:function(){return this.api},setMode:function(t){this.mode=t,this.viewport&&this.viewport.setMode(t)},onLaunch:function(){this.viewport=this.createView("Viewport").render(),this.api=new Asc.VisioEditorApi({"id-view":"editor_sdk",translate:this.getApplication().getController("Main").translationTable,isRtlInterface:Common.UI.isRTL()}),this.header=this.createView("Common.Views.Header",{headerCaption:"Visio Editor",storeUsers:VE.getCollection("Common.Collections.Users")}),Common.NotificationCenter.on("layout:changed",_.bind(this.onLayoutChanged,this)),$(window).on("resize",_.bind(this.onWindowResize,this));var t=$("#left-menu");this.viewport.hlayout.on("layout:resizedrag",(function(){this.api.Resize(),Common.localStorage.setItem("ve-mainmenu-width",t.width())}),this),this.boxSdk=$("#editor_sdk"),this.boxSdk.css("border-left","none"),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},onAppShowed:function(t){var e=this;e.appConfig=t;var i=Common.Utils.InternalSettings,n=$(".toolbar-fullview-panel");if(n.css("top",Common.UI.LayoutManager.isElementVisible("toolbar")?i.get("toolbar-height-tabs"):0),(!t.isEdit||!Common.localStorage.itemExists("ve-compact-toolbar")&&t.customization&&t.customization.compactToolbar)&&(e.viewport.vlayout.getItem("toolbar").height=i.get("toolbar-height-compact")),e.onTabStyleChange(),e.onTabBackgroundChange(),t.customization&&t.customization.toolbarHideFileName&&e.viewport.vlayout.getItem("toolbar").el.addClass("style-skip-docname"),t.twoLevelHeader&&!t.compactHeader){var o=e.viewport.vlayout.getItem("title").el;o.html(e.header.getPanel("title",t)).show(),o.find(".extra").html(e.header.getPanel("left",t));var s=e.viewport.vlayout.getItem("toolbar");s.el.addClass("top-title"),s.height-=i.get("toolbar-height-tabs")-i.get("toolbar-height-tabs-top-title");var a=i.get("toolbar-height-tabs-top-title");i.set("toolbar-height-tabs",a),i.set("toolbar-height-compact",a),i.set("toolbar-height-normal",a+i.get("toolbar-height-controls")),n.css("top",(Common.UI.LayoutManager.isElementVisible("toolbar")?a:0)+i.get("document-title-height")),s=e.getApplication().getController("Toolbar").getView("Toolbar")}},onAppReady:function(t){},onLayoutChanged:function(t){switch(t){default:this.viewport.vlayout.doLayout();case"leftmenu":var e=this.viewport.hlayout.getItem("left");e.resize.el&&(e.el.width()>40?(this.boxSdk.css("border-left",""),e.resize.el.show()):(e.resize.el.hide(),this.boxSdk.css("border-left","0 none"))),this.viewport.hlayout.doLayout();break;case"header":case"toolbar":case"status":this.viewport.vlayout.doLayout()}this.api.Resize()},onWindowResize:function(t){this.onLayoutChanged("window"),Common.NotificationCenter.trigger("window:resize")},onFileMenu:function(t){var e="show"==t;this.header.lockHeaderBtns("users",e)},applySettings:function(){},onApiCoAuthoringDisconnect:function(t){this.header&&(this.header.btnDownload&&!t&&this.header.btnDownload.hide(),this.header.btnPrint&&!t&&this.header.btnPrint.hide(),this.header.btnPrintQuick&&!t&&this.header.btnPrintQuick.hide(),this.header.btnEdit&&this.header.btnEdit.hide(),this.header.lockHeaderBtns("rename-user",!0))},SetDisabled:function(t){this.header&&this.header.lockHeaderBtns("rename-user",t)},onSearchShow:function(){this.header.btnSearch&&this.header.btnSearch.toggle(!0)},onSearchToggle:function(){var t=this.getApplication().getController("LeftMenu");if(t.isSearchPanelVisible())return this.header.btnSearch.toggle(!1,!0),void t.getView("LeftMenu").panelSearch.focus();if(!this.searchBar){var e=this.mode.canBrandingExt&&(!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.mode.customization&&!1===this.mode.customization.leftMenu);this.searchBar=new Common.UI.SearchBar(e?{showOpenPanel:!1,width:303}:{}),this.searchBar.on("hide",_.bind((function(){this.header.btnSearch.toggle(!1,!0),Common.NotificationCenter.trigger("edit:complete")}),this))}if(this.header.btnSearch.pressed){var i=this.getApplication().getController("Search"),n=i.getResultsNumber();this.searchBar.show(i.getSearchText()),this.searchBar.updateResultsNumber(n[0],n[1])}else this.searchBar.hide()},isSearchBarVisible:function(){return this.searchBar&&this.searchBar.isVisible()},applyCommonMode:function(){Common.localStorage.getBool("ve-hidden-status")&&this.getApplication().getController("Statusbar").getView("Statusbar").setVisible(!1);var t=Common.UI.LayoutManager.getInitValue("leftMenu");t=void 0!==t&&!t,Common.localStorage.getBool("ve-hidden-leftmenu",t)&&this.getApplication().getController("LeftMenu").getView("LeftMenu").hide()},applyEditorMode:function(){this.viewport&&this.mode.isEdit&&this._initEditing&&(this._initEditing=!1)},onTabStyleChange:function(t){t=t||Common.Utils.InternalSettings.get("settings-tab-style"),this.viewport.vlayout.getItem("toolbar").el.toggleClass("lined-tabs","line"===t)},onTabBackgroundChange:function(t){t=t||Common.Utils.InternalSettings.get("settings-tab-background"),this.viewport.vlayout.getItem("toolbar").el.toggleClass("style-off-tabs","toolbar"===t)},onThemeChanged:function(){if(Common.UI.Themes.available()){var t=Common.Utils.InternalSettings,e=$(".toolbar-fullview-panel");const i=window.getComputedStyle(document.body);t.set("toolbar-height-controls",parseInt(i.getPropertyValue("--toolbar-height-controls")||84)),t.set("toolbar-height-normal",t.get("toolbar-height-tabs")+t.get("toolbar-height-controls")),e.css("top",(Common.UI.LayoutManager.isElementVisible("toolbar")?t.get("toolbar-height-tabs"):0)+(this.appConfig.twoLevelHeader&&!this.appConfig.compactHeader?t.get("document-title-height"):0)),this.viewport.vlayout.getItem("toolbar").height=this.toolbar&&this.toolbar.isCompact()?t.get("toolbar-height-compact"):t.get("toolbar-height-normal"),this.viewport.vlayout.getItem("statusbar").height=parseInt(i.getPropertyValue("--statusbar-height")||25),Common.NotificationCenter.trigger("layout:changed","toolbar")}}},VE.Controllers.Viewport))})),$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu]",onDropDownKeyDown),"ontouchstart"in document.documentElement&&$(document).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",toggle),function(){var t,e=$._data($(document).get(0),"events");e&&e.click&&e.click.every((function(e,i,n){return/click/.test(e.type)&&!e.selector&&/bs\..+\.dropdown/.test(e.namespace)&&(t=e.handler),!t})),t&&$(document).off("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",(function(t){1!=t.which&&null!=t.which||clearMenus(/form-control/.test(t.target.className))}))}(),define("common/main/lib/extend/Bootstrap",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/MenuItem",["common/main/lib/component/BaseView","common/main/lib/component/ToggleManager"],(function(){"use strict";Common.UI.MenuItem=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,checkable:!1,checked:!1,allowDepress:!1,disabled:!1,visible:!0,value:null,toggleGroup:null,iconCls:"",menu:null,canFocused:!0,dataHint:"",dataHintDirection:"",dataHintOffset:"",dataHintTitle:"",scaling:!0,header:""},tagName:"li",template:_.template(['<% if (header) { %><span class="menu-item-header"><%- header %></span><% } %><% if (caption) { %><a id="<%= id %>" class="menu-item" <% if (_.isEmpty(iconCls)) { %> data-no-icon <% } %> style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; if(!_.isUndefined(options.dataHint)) { %> data-hint="<%= options.dataHint %>" <% }; if(!_.isUndefined(options.dataHintDirection)) { %> data-hint-direction="<%= options.dataHintDirection %>" <% }; if(!_.isUndefined(options.dataHintOffset)) { %> data-hint-offset="<%= options.dataHintOffset %>" <% }; if(options.dataHintTitle) { %> data-hint-title="<%= options.dataHintTitle %>" <% }; %> >',"<% if (!_.isEmpty(iconCls)) { %>",'<span class="menu-item-icon <%= iconCls %>"></span>',"<% } else if (!_.isEmpty(iconImg)) { %>",'<img src="<%= iconImg %>" class="menu-item-icon">',"<% } %>","<%- caption %>","</a>","<% } %>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.caption=e.options.caption,this.menu=e.options.menu||null,this.checkable=e.options.checkable,this.checked=e.options.checked,e.allowDepress=e.options.allowDepress,this.disabled=e.options.disabled,this.visible=e.options.visible,this.value=e.options.value,this.toggleGroup=e.options.toggleGroup,this.template=e.options.template||this.template,this.iconCls=e.options.iconCls,this.iconImg=e.options.iconImg,this.hint=e.options.hint,this.rendered=!1,this.header=e.options.header,null===this.menu||this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple||(this.menu=new Common.UI.Menu(_.extend({},e.options.menu))),e.options.el&&this.render()},render:function(){var t=this,e=t.$el||$(this.el);if(t.cmpEl=e,t.trigger("render:before",t),"--"===t.caption)e.addClass("divider");else if(!this.rendered){e.off("click"),Common.UI.ToggleManager.unregister(t),e.html(this.template({id:t.id,caption:t.caption,iconCls:t.iconCls,iconImg:t.iconImg,style:t.style,options:t.options,header:t.header})),t.menu&&(e.addClass("dropdown-submenu"),t.menu.render(e),e.mouseenter(_.bind(t.menu.alignPosition,t.menu)),e.focusout(_.bind(t.onBlurItem,t)),e.hover(_.bind(t.onHoverItem,t),_.bind(t.onUnHoverItem,t)));var i=e.children(":first");this.checkable&&i&&(i.toggleClass("checkable",this.checkable),i.toggleClass("no-checkmark",!1===this.options.checkmark),i.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||i.css("background-image","none")),t.options.hint&&(e.attr("data-toggle","tooltip"),e.tooltip({title:t.options.hint,placement:t.options.hintAnchor||function(t,e){var i=Common.Utils.getBoundingClientRect(e),n=t.offsetWidth,o=t.offsetHeight,s=Common.Utils.innerWidth(),a=Common.Utils.innerHeight(),r=i.top,l=i.left+i.width+2;r+o>a&&(r=a-o-2),l+n>s&&(l=i.left-n-2),Common.Utils.setOffset($(t),{top:r,left:l}).addClass("in")}})),this.cls&&e.addClass(this.cls),this.disabled&&e.toggleClass("disabled",this.disabled),e.on("click",_.bind(this.onItemClick,this)),e.on("mousedown",_.bind(this.onItemMouseDown,this)),Common.UI.ToggleManager.register(t),!1!==t.options.scaling&&t.iconCls&&(e.attr("ratio","ratio"),t.applyScaling(Common.UI.Scaling.currentRatio()),e.on("app:scaling",(function(e,i){t.options.scaling!=i.ratio&&t.applyScaling(i.ratio)})))}return this.visible||this.setVisible(this.visible),t.rendered=!0,t.trigger("render:after",t),this},setCaption:function(t){this.caption=t,this.rendered&&(this.cmpEl.find("> a").contents().last()[0].textContent=t)},setIconCls:function(t){if(this.rendered&&!_.isEmpty(this.iconCls)){var e=this.cmpEl.children(":first");if(e){e.find(".menu-item-icon").removeClass(this.iconCls).addClass(t);var i=e.find("use.zoom-int");if(i.length){var n=/btn-[^\s]+/.exec(t),o=n?n[0]:"null";i.attr("href","#"+o)}}}this.iconCls=t},setChecked:function(t,e){this.toggle(t,e)},isChecked:function(){return this.checked},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},toggle:function(t,e){var i=void 0===t?!this.checked:!!t;if(this.checkable){if(this.checked=i,this.rendered){var n=this.cmpEl.children(":first");n&&(n.toggleClass("checked",this.checked),_.isEmpty(this.iconCls)||n.css("background-image","none"))}e||this.trigger("toggle",this,i)}},onItemMouseDown:function(t){if(Common.UI.HintManager&&Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},onItemClick:function(t){return(1==t.which||void 0===t.which&&!this.menu)&&(this.disabled||!this.allowDepress&&this.checked&&this.toggleGroup||this.menu||this.setChecked(!this.checked),this.menu?t.target.id==this.id?(this._doHover(t),!1):void(this.menu.isOver||this.cmpEl.removeClass("over")):!this.disabled&&void this.trigger("click",this,t))},onHoverItem:function(t){this._doHover(t)},onUnHoverItem:function(t){this._doUnHover(t)},onBlurItem:function(t){this._doUnHover(t)},_doHover:function(t){var e=this;e.menu&&!e.disabled&&(clearTimeout(e.hideMenuTimer),e.cmpEl.trigger("show.bs.dropdown"),e.expandMenuTimer=_.delay((function(){e.cmpEl.addClass("over"),e.cmpEl.trigger("shown.bs.dropdown")}),200))},_doUnHover:function(t){var e=this;if(e.cmpEl.hasClass("dropdown-submenu")&&e.cmpEl.hasClass("over")&&(t&&t.relatedTarget&&e.cmpEl.find(t.relatedTarget).length>0||e.cmpEl.hasClass("focused-submenu")))e.cmpEl.removeClass("focused-submenu");else if(e.menu&&!e.disabled&&(clearTimeout(e.expandMenuTimer),e.hideMenuTimer=_.delay((function(){e.menu.isOver||e.cmpEl.removeClass("over")}),200),t&&"focusout"!==t.type)){var i=e.cmpEl.children(":focus");i.length>0&&(i.blur(),e.cmpEl.closest("ul").focus())}},setMenu:function(t){if(t&&_.isObject(t)&&_.isFunction(t.render))if(this.rendered){this.menu&&(this.menu instanceof Common.UI.Menu||this.menu instanceof Common.UI.MenuSimple)&&(Common.UI.Menu.Manager.unregister(this.menu),this.menu.cmpEl&&this.menu.cmpEl.remove()),this.menu=t;var e=this.cmpEl;e.addClass("dropdown-submenu"),this.menu.render(e),e.mouseenter(_.bind(this.menu.alignPosition,this.menu)),e.focusout(_.bind(this.onBlurItem,this)),e.hover(_.bind(this.onHoverItem,this),_.bind(this.onUnHoverItem,this))}else this.menu=t},applyScaling:function(t){var e=this;if(e.options.scaling!=t){e.options.scaling=t;var i=this.cmpEl.children(":first");if(t>2&&!i.find("svg.menu-item-icon").length){var n=e.iconCls,o=/btn-[^\s]+/.exec(n),s=o?o[0]:"null",a=(n?n.indexOf("icon-rtl"):-1)>-1?"icon-rtl":"",r='<svg class="menu-item-icon %rtlCls"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",s).replace("%rtlCls",a);i.find("span.menu-item-icon").after(r)}}}}),Common.UI.MenuItemSeparator=function(t){return(t=t||{}).caption="--",new Common.UI.MenuItem(t)},Common.UI.MenuItemCustom=Common.UI.MenuItem.extend(_.extend({initialize:function(t){Common.UI.MenuItem.prototype.initialize.call(this,t),this.isCustomItem=!0,this.baseUrl=t.baseUrl||"",this.iconsSet=Common.UI.iconsStr2IconsObj(t.iconsSet||[""]);var e=Common.UI.getSuitableIcons(this.iconsSet);this.iconImg=this.baseUrl+e.normal},render:function(){return Common.UI.MenuItem.prototype.render.call(this),this.updateIcon(),Common.NotificationCenter.on("uitheme:changed",this.updateIcons.bind(this)),this},updateIcons:function(){var t=Common.UI.getSuitableIcons(this.iconsSet);this.iconImg=this.baseUrl+t.normal,this.updateIcon()},updateIcon:function(){this.cmpEl&&this.cmpEl.find("> a img").attr("src",this.iconImg).addClass("custom-icon")},applyScaling:function(t){this.options.scaling!==t&&(this.options.scaling=t,this.updateIcons())}},Common.UI.MenuItemCustom||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/Menu",["common/main/lib/extend/Bootstrap","common/main/lib/component/BaseView","common/main/lib/component/MenuItem","common/main/lib/component/Scroller"],(function(){"use strict";var t,e,i;Common.UI.Menu=(t=[],e={},i={register:function(i){e[i.id]=i,i.on("show:after",(function(e){t.push(e)})).on("hide:after",(function(e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}))},unregister:function(i){var n=t.indexOf(i);delete e[i.id],n>-1&&t.splice(n,1),i.off("show:after").off("hide:after")},hideAll:function(){return Common.NotificationCenter.trigger("menumanager:hideall"),!!(t&&t.length>0)&&(_.each(t,(function(t){t&&t.hide()})),!0)}},_.extend(Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu"></ul>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||Common.UI.MenuItem.prototype.template,this.rendered=!1,this.items=[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.outerMenu=this.options.outerMenu,Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),Common.Utils.isIE&&(this.options.restoreHeightAndTop=!1),this.options.cyclic||(this.options.cls+=" no-cyclic"),_.each(this.options.items,(function(t){t instanceof Common.UI.MenuItem?e.items.push(t):e.items.push(new Common.UI.MenuItem(_.extend({tagName:"li",template:e.itemTemplate},t)))})),this.options.el&&this.render(),i.register(this)},remove:function(){i.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t?(this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({options:e.options})),t.append(this.cmpEl))):e.rendered||(this.cmpEl=this.template({options:e.options}),this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||(_.each(e.items||[],(function(t){n.append(t.render().el),t.on("click",_.bind(e.onItemClick,e)),t.on("toggle",_.bind(e.onItemToggle,e))})),n.on("click",(function(t){e.trigger("menu:click",this,t)}))),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),this.parentEl.on("keydown.before.bs.dropdown",_.bind(e.onBeforeKeydownMenu,e)),this.options.innerMenus&&this.on("keydown:before",_.bind(e.onBeforeKeyDown,e)),n.hover((function(t){e.isOver=!0}),(function(t){e.isOver=!1}))),this.rendered=!0,this.trigger("render:after",this),this},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},insertItem:function(t,e){var i=this;if(this.cmpEl,e instanceof Common.UI.MenuItem||(e=new Common.UI.MenuItem(_.extend({tagName:"li",template:i.itemTemplate},e))),t<0||t>=i.items.length?i.items.push(e):i.items.splice(t,0,e),this.rendered){var n=this.menuRoot;n&&(t<0?n.append(e.render().el):0===t?n.prepend(e.render().el):n.children("li:nth-child("+t+")").after(e.render().el),e.on("click",_.bind(i.onItemClick,i)),e.on("toggle",_.bind(i.onItemToggle,i)))}},addItem:function(t,e){if(e){for(var i=-1,n=0;n<this.items.length;n++)if(this.items[n].isCustomItem){i=n;break}this.insertItem(i,t)}else this.insertItem(-1,t)},removeItem:function(t){var e=this.items.indexOf(t);e>-1&&(this.items.splice(e,1),t.off("click").off("toggle"),t.remove())},removeItems:function(t,e){if(!(t>this.items.length-1)){t+e>this.items.length&&(e=this.items.length-t);for(var i=t;i<t+e;i++)this.items[i].off("click").off("toggle"),this.items[i].remove();this.items.splice(t,e)}},removeAll:function(t){for(var e=0;e<this.items.length;e++)t&&this.items[e].isCustomItem||(this.items[e].off("click").off("toggle"),this.items[e].remove(),this.items.splice(e,1),e--)},onBeforeShowMenu:function(t){Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){this.updateScroller();var e=this.menuRoot,i=e.find("> li .checked");if(i.length){var n=Common.Utils.getPosition(i).top,o=i.outerHeight(),s=e.outerHeight();if(this.options.scrollToCheckedItem&&(n<0||n+o>s)){var a=e.scrollTop()+n+(o-s)/2;a=Math.floor(a/o)*o,e.scrollTop(a)}this.options.focusToCheckedItem&&setTimeout((function(){i.focus()}),1)}}this._search={}},updateScroller:function(){if(this.scroller&&this.menuRoot){var t=this.menuRoot;if(void 0===this.wheelSpeed||0===this.wheelSpeed){var e=t.find("> li:first"),i=e.length?e.outerHeight():1;this.wheelSpeed=Math.min(Math.floor(t.height()/i)*i/10,20)}this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed})}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(this.trigger("keydown:before",this,t),!t.isDefaultPrevented())if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;if(clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){i._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index){var n=this.menuRoot.find("> li").find("> a");this._search.index=n.index(n.filter(":focus"))}this.selectCandidate()}},onBeforeKeydownMenu:function(t){if(!t.isDefaultPrevented()&&this.outerMenu&&this.outerMenu.menu&&(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)){var e=this.menuRoot.find("> li").find("> a"),i=e.index(e.filter(":focus"));(t.keyCode==Common.UI.Keys.UP&&0==i||t.keyCode==Common.UI.Keys.DOWN&&i==e.length-1)&&(this.outerMenu.menu.focusOuter(t,this.outerMenu.index),t.preventDefault(),t.stopPropagation())}},selectCandidate:function(){for(var t,e,i=this._search.index&&-1!=this._search.index?this._search.index:0,n=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),o=n.test(this.items[i].caption),s=0;s<this.items.length;s++){var a=this.items[s];if(n.test(a.caption)){if(!t&&(t=a,e=s,!o))break;if(this._search.full&&s==i||s>i){t=a,e=s;break}}}if(t){if(this._search.index=e,a=t.cmpEl.find("a"),this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible,wheelSpeed:this.wheelSpeed});var r=Common.Utils.getPosition(a).top,l=a.outerHeight(),c=this.menuRoot.outerHeight();if(r<0||r+l>c){var h=this.menuRoot.scrollTop()+r;h=Math.floor(h/l)*l,this.menuRoot.scrollTop(h)}}a.focus()}},onBeforeKeyDown:function(t,e){if(e.keyCode==Common.UI.Keys.RETURN){var i=$(e.target).closest("li");i.length>0&&(e.preventDefault(),e.stopPropagation(),i.click()),Common.UI.Menu.Manager.hideAll()}else if("after.bs.dropdown"!==e.namespace&&(e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.UP)){if(this.menuRoot.length<1||$(e.target).closest("ul[role=menu]").get(0)!==this.menuRoot.get(0))return;var n=this.findInnerMenu(e.keyCode);n&&n.focusInner&&(e.preventDefault(),e.stopPropagation(),_.delay((function(){n.focusInner(e)}),10))}},setInnerMenu:function(t){!this.options.innerMenus&&t&&(this.options.innerMenus=t,this.rendered&&this.on("keydown:before",_.bind(this.onBeforeKeyDown,this)))},findInnerMenu:function(t,e,i){if(this.options.innerMenus){var n=$("> li",this.menuRoot),o=$("> li:not(.divider):not(.disabled):visible",this.menuRoot),s=o.length;if(s)for(var a=0;a<s;){var r=void 0!==e?o.index(n.eq(e)):o.index(o.find("> a").filter(":focus").parent()),l=t==Common.UI.Keys.DOWN?r<s-1?r+1:0:r>0?r-1:s-1,c=o.eq(l);e=n.index(c);for(var h=0;h<this.options.innerMenus.length;h++){var d=this.options.innerMenus[h];if(d&&d.menu&&d.index==e)return d.menu}if(c.find("> a").length>0)return i?c:void 0;a++}}},focusInner:function(t){t.keyCode==Common.UI.Keys.UP?this.items[this.items.length-1].cmpEl.find("> a").focus():this.items[0].cmpEl.find("> a").focus()},focusOuter:function(t,e){var i=this.findInnerMenu(t.keyCode,e,!0);if(i&&i.focusInner)_.delay((function(){i.focusInner(t)}),10);else if(i)i.find("> a").focus();else{var n=$("> li:not(.divider):not(.disabled):visible",this.menuRoot).find("> a"),o=n.length;o&&n.eq(t.keyCode==Common.UI.Keys.UP?e<0?o-1:e:e>=o-1?0:e+1).focus()}},onItemClick:function(t,e){if(t.menu||(this.isOver=!1),t.options.stopPropagation){e.stopPropagation();var i=this;_.delay((function(){i.$el.parent().parent().find("[data-toggle=dropdown]").focus()}),10)}else this.trigger(t.isCustomItem?"item:custom-click":"item:click",this,t,e)},onItemToggle:function(t,e,i){this.trigger("item:toggle",this,t,e,i)},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=Common.Utils.getOffset(n),a=Common.Utils.innerWidth()-10,r=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),h=n.outerWidth(),d=n.outerHeight(),u={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},m={tl:[0,0],tr:[h,0],bl:[0,d],br:[h,d]},p=s.left-u[o[1]][0]+m[o[2]][0]+this.offset[0],f=s.top-u[o[1]][1]+m[o[2]][1]+this.offset[1];if(p+l>a?p=n.is("li.dropdown-submenu")?s.left-l+2:a-l:p<0&&(p=n.is("li.dropdown-submenu")?s.left+h-2:0),p<0&&(p=0),this.options.restoreHeightAndTop)r=(g=Common.Utils.croppedGeometry()).height-10,i.css("max-height","none"),f+(c=i.outerHeight())>r+g.top&&(f=r-c+g.top),f<g.top&&(f=g.top),f+c>r+g.top&&(i.css("max-height",r-f+g.top+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find("> .dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});else if(this.options.restoreHeight)"number"==typeof this.options.restoreHeight&&(f+c>r?(i.css("max-height",r-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),this.wheelSpeed=void 0):f+c<r&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(r-f,this.options.restoreHeight)+"px"),this.wheelSpeed=void 0));else{var g;f+c>(r=(g=Common.Utils.croppedGeometry()).height-10)+g.top&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-u[o[1]][1]+m[o[2]][1]+this.offset[1]+(e||0)):f=r-c+g.top),f<g.top&&(f=g.top)}if(this.options.additionalAlign)this.options.additionalAlign.call(this,i,p,f);else{var b={left:p,top:f};c<r||(b["margin-top"]=0),i.css(b)}},getChecked:function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.isChecked&&i.isChecked()&&(!t||!i.isCustomItem))return i}},clearAll:function(t){_.each(this.items,(function(e){!e.setChecked||t&&e.isCustomItem||e.setChecked(!1,!0)}))},getItems:function(t){return t?_.reject(this.items,(function(t){return!!t.isCustomItem})):this.items},getItemsLength:function(t){return t?_.reject(this.items,(function(t){return!!t.isCustomItem})).length:this.items.length}}),{Manager:i})),Common.UI.MenuSimple=Common.UI.BaseView.extend({options:{cls:"",style:"",itemTemplate:null,items:[],menuAlign:"tl-bl",menuAlignEl:null,offset:[0,0],cyclic:!0,search:!1,searchFields:["caption"],scrollAlwaysVisible:!0,scrollToCheckedItem:!0,focusToCheckedItem:!1},template:_.template(['<ul class="dropdown-menu <%= options.cls %>" oo_editor_input="true" style="<%= options.style %>" role="menu">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>","</ul>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);this.id=this.options.id||Common.UI.getId(),this.itemTemplate=this.options.itemTemplate||_.template(['<a id="<%= id %>" <% if(typeof style !== "undefined") { %> style="<%= style %>" <% } %>','<% if(typeof canFocused !== "undefined") { %> tabindex="-1" type="menuitem" <% } %>','<% if(typeof stopPropagation !== "undefined") { %> data-stopPropagation="true" <% } %>','class="<% if (checked) { %> checked <% } %>" >','<% if (typeof iconCls !== "undefined") { %>','<span class="menu-item-icon <%= iconCls %>"></span>',"<% } %>","<%= caption %>","</a>"].join("")),this.rendered=!1,this.items=this.options.items||[],this.offset=[0,0],this.menuAlign=this.options.menuAlign,this.menuAlignEl=this.options.menuAlignEl,this.scrollAlwaysVisible=this.options.scrollAlwaysVisible,this.search=this.options.search,this.setRecent(t.recent),Common.UI.isRTL()&&("tl-tr"===this.menuAlign?this.menuAlign="tr-tl":"tl-bl"===this.menuAlign?this.menuAlign="tr-br":"tr-br"===this.menuAlign?this.menuAlign="tl-bl":"bl-tl"===this.menuAlign&&(this.menuAlign="br-tr")),this.options.restoreHeight&&(this.options.restoreHeight="number"==typeof this.options.restoreHeight?this.options.restoreHeight:this.options.maxHeight?this.options.maxHeight:1e5,!this.options.maxHeight&&(this.options.maxHeight=this.options.restoreHeight)),this.options.cyclic||(this.options.cls+=" no-cyclic"),this.options.el&&this.render(),Common.UI.Menu.Manager.register(this)},remove:function(){Common.UI.Menu.Manager.unregister(this),Common.UI.BaseView.prototype.remove.call(this)},render:function(t){var e=this;this.trigger("render:before",this),this.cmpEl=e.$el||$(this.el),t&&this.setElement(t,!1),e.rendered||(this.cmpEl=$(this.template({items:e.items,itemTemplate:e.itemTemplate,options:e.options})),t?t.append(this.cmpEl):this.$el.append(this.cmpEl));var i=this.cmpEl.parent(),n="menu"===i.attr("role")?i:i.find("[role=menu]");return this.menuRoot=n,n&&(e.rendered||(n.on("click","li",_.bind(e.onItemClick,e)),n.on("mousedown","li",_.bind(e.onItemMouseDown,e))),this.options.maxHeight&&(n.css({"max-height":e.options.maxHeight}),this.scroller=new Common.UI.Scroller({el:e.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible})),n.css({position:"fixed",right:"auto",left:-1e3,top:-1e3}),this.parentEl=n.parent(),this.parentEl.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),this.parentEl.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),this.parentEl.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),this.parentEl.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),this.parentEl.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),n.hover((function(t){e.isOver=!0}),(function(t){e.isOver=!1}))),this.rendered=!0,this.trigger("render:after",this),this.recent&&this.menuRoot.find("> li:first").addClass("border-top"),this.loadRecent(),this},resetItems:function(t){this.items=t||[],this.$items=null;var e=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>","<% item.checked = item.checked || false;  %>","<li><%= itemTemplate(item) %></li>","<% }) %>"].join(""));this.cmpEl&&this.cmpEl.html(e({items:this.items,itemTemplate:this.itemTemplate,options:this.options})),this.recent&&this.menuRoot&&this.menuRoot.find("> li:first").addClass("border-top"),this.loadRecent()},isVisible:function(){return this.rendered&&this.cmpEl.is(":visible")},show:function(){this.rendered&&this.parentEl&&!this.parentEl.hasClass("open")&&this.cmpEl.dropdown("toggle")},hide:function(){this.rendered&&this.parentEl&&(this.parentEl.hasClass("open")?this.cmpEl.dropdown("toggle"):this.parentEl.hasClass("over")&&this.parentEl.removeClass("over"))},onItemClick:function(t){if(1!=t.which&&void 0!==t.which)return!1;var e=$(t.currentTarget).closest("li").index(),i=e>=0?this.items[e]:null;if(i){if(i.disabled)return!1;if(i.checkable&&!i.checked&&this.setChecked(e,!i.checked),this.isOver=!1,i.stopPropagation){t.stopPropagation();var n=this;_.delay((function(){n.$el.parent().parent().find("[data-toggle=dropdown]").focus()}),10)}else this.addItemToRecent(i),this.trigger("item:click",this,i,t)}},onItemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation()},setChecked:function(t,e,i){this.toggle(t,e,i)},toggle:function(t,e,i){var n=!!e,o=this.items[t];if(this.clearAll(),o&&o.checkable){if(o.checked=n,this.rendered){var s=o.el||this.cmpEl.find("#"+o.id);s&&(s.toggleClass("checked",o.checked),_.isEmpty(o.iconCls)||s.css("background-image","none"))}i||this.trigger("item:toggle",this,o,n)}},setDisabled:function(t){this.disabled=!!t,this.rendered&&this.cmpEl.toggleClass("disabled",this.disabled)},isDisabled:function(){return this.disabled},onBeforeShowMenu:function(t){this.loadRecent(),Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),t&&t.target===t.currentTarget&&this.alignPosition()},onAfterShowMenu:function(t){if(this.trigger("show:after",this,t),this.scroller&&t&&t.target===t.currentTarget){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var e=this.menuRoot;if(this.recent&&this.recentArr&&this.recentArr.length)e.scrollTop(0);else{var i=e.find("> li .checked");if(i.length){var n=Common.Utils.getPosition(i).top,o=i.outerHeight(),s=e.outerHeight();if(this.options.scrollToCheckedItem&&(n<0||n+o>s)){var a=e.scrollTop()+n+(o-s)/2;a=Math.floor(a/o)*o,e.scrollTop(a)}this.options.focusToCheckedItem&&setTimeout((function(){i.focus()}),1)}}}if(this._search={},this.search&&!this.$items){var r=this;this.$items=this.menuRoot.find("> li").find("> a"),_.each(this.$items,(function(t,e){r.items[e].el=$(t)}))}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e)},onAfterKeydownMenu:function(t){if(t.keyCode==Common.UI.Keys.RETURN){var e=$(t.target).closest("li");if(e.length<=0&&(e=$(t.target).parent().find("li .dataview")),e.length>0&&e.click(),e.hasClass("dropdown-submenu")||Common.UI.Menu.Manager.hideAll(),$(t.currentTarget).closest("li").hasClass("dropdown-submenu"))return t.stopPropagation(),!1}else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN)this.fromKeyDown=!0;else if(t.keyCode==Common.UI.Keys.ESC);else if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){var i=this;clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){i._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(this._search.index=this.$items.index(this.$items.filter(":focus"))),this.selectCandidate()}},selectCandidate:function(){for(var t,e,i=this,n=this._search.index&&-1!=this._search.index?this._search.index:0,o=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),s=this.options.searchFields.some((function(t){return o.test(i.items[n][t])})),a=0;a<this.items.length;a++){var r=this.items[a],l=!1;if(this.options.searchFields.forEach((function(c){if(r[c]&&o.test(r[c])){if(!t&&(t=r,e=a,!s))return void(l=!0);if(i._search.full&&a==n||a>n)return t=r,e=a,void(l=!0)}})),l)break}if(t){this._search.index=e;r=t.el;if(this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var c=Common.Utils.getPosition(r).top,h=r.outerHeight(),d=this.menuRoot.outerHeight();if(c<0||c+h>d){var u=this.menuRoot.scrollTop()+c;u=Math.floor(u/h)*h,this.menuRoot.scrollTop(u)}}r.focus()}},setOffset:function(t,e){this.offset[0]=_.isUndefined(t)?this.offset[0]:t,this.offset[1]=_.isUndefined(e)?this.offset[1]:e,this.alignPosition()},getOffset:function(){return this.offset},alignPosition:function(t,e){var i=this.menuRoot,n=this.menuAlignEl||i.parent(),o=this.menuAlign.match(/^([a-z]+)-([a-z]+)/),s=Common.Utils.getOffset(n),a=Common.Utils.innerWidth(),r=Common.Utils.innerHeight()-10,l=i.outerWidth(),c=i.outerHeight(),h=n.outerWidth(),d=n.outerHeight(),u={tl:[0,0],bl:[0,c],tr:[l,0],br:[l,c]},m={tl:[0,0],tr:[h,0],bl:[0,d],br:[h,d]},p=s.left-u[o[1]][0]+m[o[2]][0]+this.offset[0],f=s.top-u[o[1]][1]+m[o[2]][1]+this.offset[1];p+l>a?p=n.is("li.dropdown-submenu")?s.left-l+2:a-l:p<0&&(p=n.is("li.dropdown-submenu")?s.left+h-2:0),p<0&&(p=0),this.options.restoreHeight?"number"==typeof this.options.restoreHeight&&(f+c>r?(i.css("max-height",r-f+"px"),!this.scroller&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".dropdown-menu "),minScrollbarLength:30,suppressScrollX:!0,alwaysVisibleY:this.scrollAlwaysVisible}))):f+c<r&&i.height()<this.options.restoreHeight&&i.css("max-height",Math.min(r-f,this.options.restoreHeight)+"px")):(f+c>r&&(t&&"string"==typeof t?(o=t.match(/^([a-z]+)-([a-z]+)/),f=s.top-u[o[1]][1]+m[o[2]][1]+this.offset[1]+(e||0)):f=r-c),f<0&&(f=0)),this.options.additionalAlign?this.options.additionalAlign.call(this,i,p,f):i.css({left:Math.ceil(p),top:Math.ceil(f)})},clearAll:function(){this.cmpEl&&this.cmpEl.find("li > a.checked").removeClass("checked"),_.each(this.items,(function(t){t.checked=!1}))},setRecent:function(t){var e=Common.localStorage.getKeysFilter();this.recent=!!t&&{count:t.count||5,key:t.key||(e&&e.length?e.split(",")[0]:"")+this.id,offset:t.offset||0,valueField:t.valueField||"caption"}},loadRecent:function(){if(this.recent&&this.rendered){this.recentArr||(this.recentArr=[]);var t=_.findWhere(this.items,{checked:!0});this.clearRecent();var e=this,i=Common.localStorage.getItem(this.recent.key);if((i=i?i.split(";"):[]).reverse().forEach((function(t){let i=_.find(e.items,(function(i){return i[e.recent.valueField]===t}));i&&e.addItemToRecent(i,!0,0)})),this.recentArr=i,t){let i,n=_.findIndex(e.items,(i={},i[e.recent.valueField]=t[e.recent.valueField],i));n>-1&&e.setChecked(n,!0,!0)}}},clearRecent:function(){for(let t=0;t<this.items.length&&this.items[t].isRecent;t++)this.onRemoveRecentItem(this.items[t]),this.items.splice(t,1),t--},addItemToRecent:function(t,e,i){if(!t||!this.recent)return;for(let e=0;e<this.items.length&&this.items[e].isRecent;e++)if(this.items[e][this.recent.valueField]===t[this.recent.valueField]){if(e<this.recent.offset)return;this.onRemoveRecentItem(this.items[e]),this.items.splice(e,1);break}let n=0;for(let t=0;t<this.items.length&&this.items[t].isRecent;t++)n++;n<this.recent.count||(this.onRemoveRecentItem(this.items[this.recent.count-1]),this.items.splice(this.recent.count-1,1));var o=Object.assign({},t);if(o.isRecent=!0,o.id=Common.UI.getId(),o.checked=!1,this.items.splice(void 0!==i?i:this.recent.offset,0,o),this.onInsertRecentItem(o,void 0!==i?i:this.recent.offset),!e){var s=[];for(let t=0;t<this.items.length&&this.items[t].isRecent;t++)s.push(this.items[t][this.recent.valueField]);this.recentArr=s,Common.localStorage.setItem(this.recent.key,s.join(";"))}this.$items=null},onInsertRecentItem:function(t,e){if(this.cmpEl){var i=$(_.template("<li><%= itemTemplate(item) %></li>")({itemTemplate:this.itemTemplate,item:t}));this.cmpEl.find("> li").eq(e||0).before(i),i&&(t.el=i.find("> a"))}},onRemoveRecentItem:function(t){this.cmpEl&&this.cmpEl.find("> li a#"+t.id).closest("li").remove()}})})),define("visioeditor/main/app/view/DocumentHolder",["jquery","underscore","backbone","gateway","common/main/lib/util/utils","common/main/lib/component/Menu"],(function(t,e,i,n){"use strict";VE.Views.DocumentHolder=i.View.extend(e.extend({el:"#editor_sdk",template:null,events:{},initialize:function(){this._isDisabled=!1,this._preventCustomClick=null,this._hasCustomItems=!1},render:function(){return this.fireEvent("render:before",this),this.cmpEl=t(this.el),this.fireEvent("render:after",this),this},setApi:function(t){return this.api=t,this},setMode:function(t){return this.mode=t,this},createDelayedElementsViewer:function(){},createDelayedElementsEditor:function(){},focus:function(){var t=this;e.defer((function(){t.cmpEl.focus()}),50)},SetDisabled:function(t,e,i){this._isDisabled=t},updateCustomItems:function(){},clearCustomItems:function(){},parseIcons:function(){}},VE.Views.DocumentHolder||{}))})),define("visioeditor/main/app/controller/DocumentHolder",["core","visioeditor/main/app/view/DocumentHolder"],(function(){"use strict";VE.Controllers.DocumentHolder=Backbone.Controller.extend({models:[],collections:[],views:["DocumentHolder"],initialize:function(){this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements}});var t=this;t._TtHeight=20,t._isDisabled=!1,t._state={},t.mode={},t.mouseMoveData=null,t.isTooltipHiding=!1,t.screenTip={toolTip:new Common.UI.Tooltip({owner:this,html:!0,title:"<br><b>Press Ctrl and click link</b>",cls:"link-tooltip"}),strTip:"",isHidden:!0,isVisible:!1}},onLaunch:function(){this.documentHolder=this.createView("DocumentHolder").render(),this.documentHolder.el.tabIndex=-1,this.onAfterRender();var t=this;Common.NotificationCenter.on({"window:show":function(e){t.screenTip.toolTip.hide(),t.screenTip.isVisible=!1,t.mode&&t.mode.isDesktopApp&&t.api&&t.api.asc_onShowPopupWindow()},"modal:show":function(t){},"layout:changed":function(e){t.screenTip.toolTip.hide(),t.screenTip.isVisible=!1,t.onDocumentHolderResize()}}),Common.NotificationCenter.on("script:loaded",_.bind(t.createPostLoadElements,t))},setApi:function(t){return this.api=t,this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(this.onMouseMoveStart,this)),this.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(this.onMouseMoveEnd,this)),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onHyperlinkClick,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onMouseMove,this)),this.mode.isEdit,this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),this.api.asc_registerCallback("asc_onFocusObject",_.bind(this.onFocusObject,this)),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)),this.documentHolder.setApi(this.api)),this},setMode:function(t){this.mode=t,this.documentHolder.setMode(t)},createPostLoadElements:function(){},createDelayedElements:function(t,e){var i=this;t=i.documentHolder;"view"===e?t.menuViewCopy.on("click",_.bind(i.onCutCopyPaste,i)):"edit"===e&&t.menuEditCopy.on("click",_.bind(i.onCutCopyPaste,i))},getView:function(t){return t?Backbone.Controller.prototype.getView.call():this.documentHolder},showPopupMenu:function(t,e,i,n,o){var s=this;if(!_.isUndefined(t)&&null!==t){Common.UI.Menu.Manager.hideAll();var a=[i.get_X(),i.get_Y()],r=$(s.documentHolder.el).find(Common.Utils.String.format("#menu-container-{0}",t.id));t.rendered||(r.length<1&&(r=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',t.id)),$(s.documentHolder.el).append(r)),t.render(r),t.cmpEl.attr({tabindex:"-1"})),r.css({left:a[0],top:a[1]}),t.show(),_.isFunction(t.options.initMenu)&&(t.options.initMenu(e),t.alignPosition()),_.delay((function(){t.cmpEl.focus()}),10),s.documentHolder.currentMenu=t,s.api.onPluginContextMenuShow&&s.api.onPluginContextMenuShow(i)}},fillViewMenuProps:function(t){var e=this.documentHolder;e.viewModeMenu||e.createDelayedElementsViewer();return{menu_to_show:e.viewModeMenu,menu_props:{}}},fillEditMenuProps:function(t){var e=this.documentHolder;if(e.editModeMenu||e.createDelayedElementsEditor(),!t||!_.isArray(t)||t.length<1)return{menu_to_show:e.editModeMenu,menu_props:{}};return{menu_to_show:null,menu_props:{}}},applyEditorMode:function(){this.mode&&this.mode.isEdit&&!this.documentHolder.editModeMenu&&this.documentHolder.createDelayedElementsEditor()},showObjectMenu:function(t,e,i){},onContextMenu:function(t){if(Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(),t){var e=this;_.delay((function(){t.get_Type()==Asc.c_oAscContextMenuTypes.Thumbnails||e.showObjectMenu.call(e,t)}),10)}else Common.UI.Menu.Manager.hideAll()},onFocusObject:function(t){var e=this,i=e.documentHolder.currentMenu;if(i&&i.isVisible()){var n=e.mode&&e.mode.isEdit?e.fillEditMenuProps(t):e.fillViewMenuProps(t);n&&n.menu_to_show===i&&(i.options.initMenu(n.menu_props),i.alignPosition())}this.mode&&this.mode.isEdit},handleDocumentWheel:function(t){var e=this;if(e.api){e._isScrolling||(e._isScrolling=!0,e._ctrlPressedAtScrollStart=t.ctrlKey),clearTimeout(e._scrollEndTimeout),e._scrollEndTimeout=setTimeout((function(){e._isScrolling=!1}),100);var i=_.isUndefined(t.originalEvent)?t.wheelDelta:t.originalEvent.wheelDelta;_.isUndefined(i)&&(i=t.deltaY),e._ctrlPressedAtScrollStart&&!t.altKey&&(i<0?e.api.zoomOut():i>0&&e.api.zoomIn(),t.preventDefault(),t.stopPropagation())}},handleDocumentKeyDown:function(t){var e=this;if(e.api){var i=t.keyCode;if((t.ctrlKey||t.metaKey)&&!t.shiftKey&&!t.altKey){if(i===Common.UI.Keys.NUM_PLUS||i===Common.UI.Keys.EQUALITY||Common.Utils.isGecko&&i===Common.UI.Keys.EQUALITY_FF||Common.Utils.isOpera&&43==i)return e.api.zoomIn(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.NUM_MINUS||i===Common.UI.Keys.MINUS||Common.Utils.isGecko&&i===Common.UI.Keys.MINUS_FF||Common.Utils.isOpera&&45==i)return e.api.zoomOut(),t.preventDefault(),t.stopPropagation(),!1;if(i===Common.UI.Keys.ZERO||i===Common.UI.Keys.NUM_ZERO)return e.api.zoomFitToPage(),t.preventDefault(),t.stopPropagation(),!1}e.documentHolder.currentMenu&&e.documentHolder.currentMenu.isVisible()&&(i!=Common.UI.Keys.UP&&i!=Common.UI.Keys.DOWN||$("ul.dropdown-menu",e.documentHolder.currentMenu.el).focus()),i==Common.UI.Keys.ESC&&Common.UI.Menu.Manager.hideAll()}},onDocumentHolderResize:function(t){var e=this;e._XY=void 0,e._Height=e.documentHolder.cmpEl.height(),e._Width=e.documentHolder.cmpEl.width(),e._BodyWidth=$("body").width()},onAfterRender:function(t){var e,i,n,o=this,s=o.documentHolder.cmpEl;if(s){s.on("contextmenu",(function(t){return t.preventDefault(),t.stopPropagation(),!1})),s.on("click",(function(t){if("canvas"==t.target.localName)if(o._preventClick)o._preventClick=!1;else{if(t.target.getAttribute&&t.target.getAttribute("oo_no_focused"))return;s.focus()}})),s.on("mousedown",(function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()})),s.on("touchstart",(function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}));var a=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";e=o.documentHolder.el,i=a,n=_.bind(o.handleDocumentWheel,o),e.addEventListener?e.addEventListener(i,n,!1):e.attachEvent("on"+i,n)}Common.Utils.isChrome?document.addEventListener("mousewheel",_.bind(o.handleDocumentWheel,o),{passive:!1}):$(document).on("mousewheel",_.bind(o.handleDocumentWheel,o)),$(document).on("keydown",_.bind(o.handleDocumentKeyDown,o)),$(window).on("resize",_.bind(o.onDocumentHolderResize,o)),o.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind(o.onDocumentHolderResize,o))},onHyperlinkClick:function(t){if(t){var e=this.api.asc_getUrlType(t);if(e===AscCommon.c_oAscUrlType.Http||e===AscCommon.c_oAscUrlType.Email)window.open(t);else{var i=this;setTimeout((function(){Common.UI.warning({msg:i.documentHolder.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(e){try{"yes"==e&&window.open(t)}catch(t){t&&console.log(t.stack)}}})}),1)}}},onMouseMoveStart:function(){this.screenTip.isHidden=!0},onMouseMoveEnd:function(){var t=this;t.screenTip.isHidden&&t.screenTip.isVisible&&(t.screenTip.isVisible=!1,t.isTooltipHiding=!0,t.screenTip.toolTip.hide((function(){t.isTooltipHiding=!1,t.mouseMoveData&&t.onMouseMove(t.mouseMoveData),t.mouseMoveData=null})))},onMouseMove:function(t){var e=this,i=e.documentHolder.cmpEl,n=e.screenTip;if(_.isUndefined(e._XY)&&(e._XY=[Common.Utils.getOffset(i).left-$(window).scrollLeft(),Common.Utils.getOffset(i).top-$(window).scrollTop()],e._Width=i.width(),e._Height=i.height(),e._BodyWidth=$("body").width()),t){var o,s,a=t.get_Type();if(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink){if(e.isTooltipHiding)return void(e.mouseMoveData=t);var r=t.get_Hyperlink();if(!r)return;(s=_.isEmpty(r.get_ToolTip())?r.get_Value():r.get_ToolTip()).length>256&&(s=s.substr(0,256)+"...");var l=!1;n.isHidden=!1,s=Common.Utils.String.htmlEncode(s),(n.tipType!==a||n.tipLength!==s.length||n.strTip.indexOf(s)<0)&&(n.toolTip.setTitle(a==Asc.c_oAscMouseMoveDataTypes.Hyperlink?s+"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>":s),n.tipLength=s.length,n.strTip=s,n.tipType=a,l=!0),(o=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-15,o[0]+=e._XY[0]+5,n.isVisible&&!l||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),l&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),l=!1,o[0]+n.tipWidth>e._BodyWidth&&(o[0]=e._BodyWidth-n.tipWidth,l=!0),o[1]-=n.tipHeight,o[1]<0&&(o[1]=0),o[0]+n.tipWidth>e._BodyWidth&&(o[0]=e._BodyWidth-n.tipWidth),n.toolTip.getBSTip().$tip.css({top:o[1]+"px",left:o[0]+"px"})}}},onCoAuthoringDisconnect:function(){this.mode.isEdit=!1},SetDisabled:function(t){this._isDisabled=t,this.documentHolder.SetDisabled(t)},changePosition:function(){var t=this,e=t.documentHolder.cmpEl;t._XY=[Common.Utils.getOffset(e).left-$(window).scrollLeft(),Common.Utils.getOffset(e).top-$(window).scrollTop()],t._Height=e.height(),t._Width=e.width(),t._BodyWidth=$("body").width(),t.onMouseMoveStart()},onCutCopyPaste:function(t,e){var i=this;i.api&&(("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste())||Common.localStorage.getBool("ve-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("ve-hide-copywarning",1),i.editComplete()}}).show());i.editComplete()},onPluginContextMenu:function(t){t&&t.length>0&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)},editComplete:function(){this.documentHolder&&this.documentHolder.fireEvent("editcomplete",this.documentHolder)},clearSelection:function(){}})})),define("text!visioeditor/main/app/template/Toolbar.template",[],(function(){return'<div class="toolbar">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right"></div>\n    </div>\n    <section class="box-controls" role="tabpanel">\n        <section class="panel static">\n        </section>\n        <section class="box-panels">\n            <section class="panel" data-tab="home" role="tabpanel" aria-labelledby="home">\n            </section>\n        </section>\n    </section>\n</div>'})),define("text!visioeditor/main/app/template/ToolbarView.template",[],(function(){return'<div class="toolbar toolbar-view">\n    <div class="box-tabs">\n        <div class="extra left"></div>\n        <%= tabsmarkup %>\n        <div class="extra right">\n        </div>\n    </div>\n    <section class="box-controls">\n        <section class="box-panels">\n        </section>\n    </section>\n</div>'})),void 0===Common)var Common={};if(define("common/main/lib/component/ComboBox",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.UI.ComboBoxModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),value:null,displayValue:null}}}),Common.UI.ComboBoxStore=Backbone.Collection.extend({model:Common.UI.ComboBoxModel}),Common.UI.ComboBox=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,editable:!0,disabled:!1,menuCls:"",menuStyle:"",menuAlignEl:null,restoreMenuHeight:!0,displayField:"displayValue",valueField:"value",search:!1,searchFields:["displayValue"],placeHolder:"",scrollAlwaysVisible:!1,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<span class="input-group combobox <%= cls %>" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control" spellcheck="false" placeholder="<%= placeHolder %>" role="combobox" aria-controls="<%= id %>-menu" aria-expanded="false" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>" data-move-focus-only-tab="true">','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret"></span>',"</button>",'<ul id="<%= id %>-menu" class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","</ul>","</span>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.template=e.options.template||e.template,this.itemsTemplate=e.options.itemsTemplate,this.itemTemplate=e.options.itemTemplate,this.hint=e.options.hint,this.editable=e.options.editable,this.disabled=e.options.disabled,this.store=e.options.store||new Common.UI.ComboBoxStore,this.displayField=e.options.displayField,this.valueField=e.options.valueField,this.placeHolder=e.options.placeHolder,this.search=e.options.search,this.searchFields=e.options.searchFields,this.scrollAlwaysVisible=e.options.scrollAlwaysVisible,this.focusWhenNoSelection=!1!==e.options.focusWhenNoSelection,this.restoreMenuHeight=e.options.restoreMenuHeight,e.rendered=e.options.rendered||!1,this.lastValue=null,e.store.add(e.options.data),e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered)this.cmpEl=e.$el||$(this.el);else{var i=this.store.toJSON();this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,menuCls:this.menuCls,menuStyle:this.menuStyle,items:i,scope:e,placeHolder:this.placeHolder,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),this.itemsTemplate?this.cmpEl.find("ul").html($(this.itemsTemplate({items:i,scope:e}))):this.itemTemplate&&this.cmpEl.find("ul").html($(_.template(["<% _.each(items, function(item) { %>","<%= itemTemplate(item) %>","<% }); %>"].join(""))({items:i,itemTemplate:this.itemTemplate,scope:this}))),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)}if(!e.rendered){var n=this.cmpEl;if(this._input=n.find("input"),this._button=n.find(".btn"),n.on("click","a",_.bind(this.itemClicked,this)),n.on("mousedown","a",_.bind(this.itemMouseDown,this)),this.editable?(n.on("change","input",_.bind(this.onInputChanged,this)),n.on("input","input",_.bind(this.onInputChanging,this)),n.on("keydown","input",_.bind(this.onInputKeyDown,this)),n.on("focusin","input",_.bind(this.onInputFocusIn,this)),n.on("click",".form-control",_.bind(this.onEditableInputClick,this))):(n.on("click",".form-control",_.bind(this.onInputClick,this)),this._input.attr("readonly","readonly"),this._input.attr("data-can-copy",!1),this._input.on("mousedown",(function(t){t.preventDefault()}))),e.options.hint){n.attr("data-toggle","tooltip"),n.tooltip({title:e.options.hint,placement:e.options.hintAnchor||"cursor"});var o=n.closest(".asc-window");if(o.length>0){n.data("bs.tooltip").tip().css("z-index",parseInt(o.css("z-index"))+10);var s=function(t){if(o[0]===t.$window[0]){var e=n.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide()),Common.NotificationCenter.off({"modal:close":s})}};Common.NotificationCenter.on({"modal:close":s})}n.find(".dropdown-menu").on("mouseenter",(function(){var t=n.data("bs.tooltip");t&&(void 0===t.dontShow&&(t.dontShow=!0),t.hide())}))}var a=n.find(".dropdown-menu");a.hasClass("menu-absolute")&&a.css("min-width",n.outerWidth()),n.on("show.bs.dropdown",_.bind(e.onBeforeShowMenu,e)),n.on("shown.bs.dropdown",_.bind(e.onAfterShowMenu,e)),n.on("hide.bs.dropdown",_.bind(e.onBeforeHideMenu,e)),n.on("hidden.bs.dropdown",_.bind(e.onAfterHideMenu,e)),n.on("keydown.after.bs.dropdown",_.bind(e.onAfterKeydownMenu,e)),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e)),this.setDefaultSelection(),this.listenTo(this.store,"reset",this.onResetItems);var r=this.options.ariaLabel?this.options.ariaLabel:this.options.hint;r&&this.cmpEl.find(".form-control").attr("aria-label",r)}return e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},setData:function(t){this.store.reset([]),this.store.add(t),this.setRawValue(""),this.onResetItems()},openMenu:function(t,e){if(!(this.store.length<1)){var i=this;this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),_.delay((function(){i.cmpEl.addClass("open"),e&&e()}),t||0)}},closeMenu:function(){this.cmpEl.removeClass("open"),this.cmpEl.find(".form-control").attr("aria-expanded","false")},isMenuOpen:function(){return this.cmpEl.hasClass("open")},onBeforeShowMenu:function(t){if(this.scroller||(this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))),Common.NotificationCenter.trigger("menu:show"),this.trigger("show:before",this,t),this.options.hint){var e=this.cmpEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}var i=this.cmpEl.find("ul"),n=i.hasClass("menu-absolute");if(this.options.restoreMenuHeightAndTop||n){var o=Common.Utils.getOffset(this.cmpEl),s=this.options.menuAlignEl?Common.Utils.getOffset(this.options.menuAlignEl).top:0,a=parseInt(i.css("margin-top")),r=o.top-s+this.cmpEl.outerHeight()+a,l=o.left;if(this.options.restoreMenuHeightAndTop){var c=this.options.menuAlignEl?this.options.menuAlignEl.outerHeight():Common.Utils.innerHeight()-10,h="number"==typeof this.options.restoreMenuHeightAndTop?this.options.restoreMenuHeightAndTop:1e5,d=r+i.outerHeight()>c&&r+h>c&&.9*(o.top-s)>c-r;n?d&&(r=o.top-s-i.outerHeight()):i.toggleClass("show-top",d)}n&&(l+i.outerWidth()>Common.Utils.innerWidth()&&(l+=this.cmpEl.outerWidth()-i.outerWidth()),i.css({left:l,top:r+s}))}},onAfterShowMenu:function(t){this.alignMenuPosition();var e=$(this.el).find("ul"),i=e.find("> li.selected");if(i.length){var n=Common.Utils.getPosition(i).top,o=i.outerHeight(),s=e.outerHeight();if(n<0||n+o>s){var a=e.scrollTop()+n+(o-s)/2;a=Math.floor(a/o)*o,e.scrollTop(a)}setTimeout((function(){i.find("a").focus()}),1)}else if(this.focusWhenNoSelection){var r=this;setTimeout((function(){r.cmpEl.find("ul li:first a").focus()}),1)}this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),this.cmpEl.find(".form-control").attr("aria-expanded","true"),this.trigger("show:after",this,t,{fromKeyDown:void 0===t}),this._search={}},alignMenuPosition:function(){if(this.restoreMenuHeight){var t=$(this.el).find("ul");if("number"!=typeof this.restoreMenuHeight){var e=parseFloat(t.css("max-height"));t.hasClass("scrollable-menu")||e?this.restoreMenuHeight=e||1e5:this.restoreMenuHeight=1e5}var i=Common.Utils.croppedGeometry(),n=this.options.menuAlignEl?Common.Utils.getOffset(this.options.menuAlignEl).top:i.top,o=this.options.menuAlignEl?this.options.menuAlignEl.outerHeight():i.height-10,s=t.outerHeight(),a=Common.Utils.getBoundingClientRect(t.get(0)).top,r=s;s<this.restoreMenuHeight&&(r=this.restoreMenuHeight);var l=Common.Utils.getOffset(this.cmpEl);a<l.top?l.top-n<r&&(r=l.top-n):a+r>o+n&&(r=o+n-a),r!==s&&(t.css("max-height",r+"px"),t.hasClass("menu-absolute")&&a<l.top&&t.css({top:l.top-t.outerHeight()}))}},onBeforeHideMenu:function(t){this.trigger("hide:before",this,t),Common.UI.Scroller.isMouseCapture()&&t.preventDefault()},onAfterHideMenu:function(t,e){if(this.cmpEl.find(".dropdown-toggle").blur(),this.cmpEl.find(".form-control").attr("aria-expanded","false"),this.trigger("hide:after",this,t,e),Common.NotificationCenter.trigger("menu:hide",this,e),this.options.takeFocusOnClose){var i=this;i._input&&i._input.length>0&&!i.editable&&i._input[0].selectionStart===i._input[0].selectionEnd&&setTimeout((function(){i._input[0].selectionStart=i._input[0].selectionEnd=0}),1),setTimeout((function(){i.focus()}),1)}},onAfterKeydownMenu:function(t){var e=this;if(t.keyCode==Common.UI.Keys.DOWN&&!this.editable&&!this.isMenuOpen())return this.onBeforeShowMenu(),this.openMenu(0,(function(){e.onAfterShowMenu()})),!1;if(this.focusWhenNoSelection||t.keyCode!=Common.UI.Keys.DOWN&&t.keyCode!=Common.UI.Keys.UP){if(t.keyCode==Common.UI.Keys.RETURN&&(this.editable||this.isMenuOpen())){var i=this.isMenuOpen();return $(t.target).click(),this.rendered&&(Common.Utils.isIE?this._input.trigger("change",{onkeydown:!0}):this._input.blur()),!i}if(t.keyCode==Common.UI.Keys.ESC&&this.isMenuOpen())return this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t),!1;if(this.search&&t.keyCode>64&&t.keyCode<91&&t.key){if("object"!=typeof this._search)return;clearTimeout(this._search.timer),this._search.timer=setTimeout((function(){e._search={}}),1e3),!this._search.text&&(this._search.text=""),!this._search.char&&(this._search.char=t.key),this._search.char!==t.key&&(this._search.full=!0),this._search.text+=t.key,void 0===this._search.index&&(n=this.cmpEl.find("ul > li").find("> a"),this._search.index=n.index(n.filter(":focus"))),this.selectCandidate()}}else{var n;0===(n=this.cmpEl.find("ul > li a")).filter(":focus").length&&n.length>0&&setTimeout((function(){n[t.keyCode==Common.UI.Keys.DOWN?0:n.length-1].focus()}),1)}},selectCandidate:function(){for(var t,e,i=this,n=this._search.index&&-1!=this._search.index?this._search.index:0,o=new RegExp("^"+(this._search.full?this._search.text:this._search.char),"i"),s=this.searchFields.some((function(t){return o.test(i.store.at(n).get(t))})),a=0;a<this.store.length;a++){var r=this.store.at(a),l=!1;if(this.searchFields.forEach((function(c){if(r.get(c)&&o.test(r.get(c))){if(!t&&(t=r,e=a,!s))return void(l=!0);if(i._search.full&&a==n||a>n)return t=r,e=a,void(l=!0)}})),l)break}if(t){if(this._search.index=e,r=$("#"+t.get("id")+" a",$(this.el)),this.scroller){this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible});var c=$(this.el).find("ul"),h=Common.Utils.getPosition(r).top,d=r.outerHeight(),u=c.outerHeight();if(h<0||h+d>u){var m=c.scrollTop()+h;m=Math.floor(m/d)*d,c.scrollTop(m)}}r.focus()}},onInputKeyDown:function(t){var e=this;t.keyCode==Common.UI.Keys.ESC?(this._input.val(this.lastValue),this.closeMenu(),this.onAfterHideMenu(t)):t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN?(this.isMenuOpen()||this.openMenu(0,(function(){e.onAfterShowMenu()})),_.delay((function(){e._skipInputChange=!0,e.cmpEl.find("ul li:first a").focus()}),10)):t.keyCode==Common.UI.Keys.RETURN&&$(t.target).val()===e.lastValue?this._input.trigger("change",{reapply:!0}):e._skipInputChange=!1},onInputFocusIn:function(t){this.trigger("combo:focusin",this,t)},onInputChanged:function(t,e){if(!e||!e.synthetic)if(this._skipInputChange)this._skipInputChange=!1;else{var i=$(t.target).val(),n={};if(this.lastValue!==i||e&&e.reapply){if(n[this.valueField]=i,this.trigger("changed:before",this,n,t),!t.isDefaultPrevented()){var o;if(this._selectedItem=this.store.findWhere(((o={})[this.displayField]=i,o)),this._selectedItem){n=this._selectedItem.toJSON();var s=$(".selected",$(this.el));s.removeClass("selected"),s.find("a").attr("aria-checked",!1);var a=$("#"+this._selectedItem.get("id"),$(this.el));a.addClass("selected"),a.find("a").attr("aria-checked",!0)}this.trigger("changed:after",this,n,t)}}else e&&e.onkeydown&&this.trigger("combo:blur",this,t)}},onInputChanging:function(t,e){var i=$(t.target).val();t.isDefaultPrevented()||this.trigger("changing",this,i,t)},onInputClick:function(t){this._button&&this._button.dropdown("toggle"),t.preventDefault(),t.stopPropagation()},onEditableInputClick:function(t){if(this.options.hint){var e=this.cmpEl.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.hide())}this.isMenuOpen()&&1==t.which&&t.stopPropagation()},setDefaultSelection:function(){if(this.rendered){var t,e=this._input.val();if(e&&(this._selectedItem=this.store.findWhere(((t={})[this.displayField]=e,t)),this._selectedItem)){var i=$(".selected",$(this.el)),n=$("#"+this._selectedItem.get("id"),$(this.el));i.removeClass("selected"),i.find("a").attr("aria-checked",!1),n.addClass("selected"),n.find("a").attr("aria-checked",!0)}}},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},setRawValue:function(t){this.rendered&&(this._input.val(t).trigger("change",{synthetic:!0}),this.lastValue=null!=t?t.toString():t)},getRawValue:function(){return this.rendered?this._input.val():null},setValue:function(t,e){if(this.rendered){var i;this._selectedItem=this.store.findWhere(((i={})[this.valueField]=t,i));var n=$(".selected",$(this.el));if(n.removeClass("selected"),n.find("a").attr("aria-checked",!1),this._selectedItem){this.setRawValue(this._selectedItem.get(this.displayField));var o=$("#"+this._selectedItem.get("id"),$(this.el));o.addClass("selected"),o.find("a").attr("aria-checked",!0)}else this.setRawValue(void 0!==e?e:t)}},getValue:function(){return this.rendered?this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?this._selectedItem.get(this.valueField):this._input.val():null},getDisplayValue:function(t){return Common.Utils.String.htmlEncode(t[this.displayField])},getSelectedRecord:function(){return this.rendered&&this._selectedItem&&!_.isUndefined(this._selectedItem.get(this.valueField))?_.extend({},this._selectedItem.toJSON()):null},selectRecord:function(t){if(this.rendered&&t){this._selectedItem=t;var e=$(".selected",$(this.el));e.removeClass("selected"),e.find("a").attr("aria-checked",!1),this.setRawValue(this._selectedItem.get(this.displayField));var i=$("#"+this._selectedItem.get("id"),$(this.el));i.addClass("selected"),i.find("a").attr("aria-checked",!0)}},clearSelection:function(){var t=$(".selected",$(this.el));t.removeClass("selected"),t.find("a").attr("aria-checked",!1),this._selectedItem=null},itemClicked:function(t){var e=$(t.target).closest("li");if(this._selectedItem=this.store.findWhere({id:e.attr("id")}),this._selectedItem){this.lastValue=this._selectedItem.get(this.displayField),this._input.val(this.lastValue).trigger("change",{synthetic:!0});var i=$(".selected",$(this.el));i.removeClass("selected"),i.find("a").attr("aria-checked",!1),e.addClass("selected"),e.find("a").attr("aria-checked",!0),this.trigger("selected",this,_.extend({},this._selectedItem.toJSON()),t),t.preventDefault()}this._isMouseDownMenu=!1},itemMouseDown:function(t){if(1!=t.which)return t.preventDefault(),t.stopPropagation(),!1;this._isMouseDownMenu=!0},onResetItems:function(){this.itemsTemplate?$(this.el).find("ul").html($(this.itemsTemplate({items:this.store.toJSON(),scope:this}))):this.itemTemplate?$(this.el).find("ul").html($(_.template(["<% _.each(items, function(item) { %>","<%= itemTemplate(item) %>","<% }); %>"].join(""))({items:this.store.toJSON(),itemTemplate:this.itemTemplate,scope:this}))):$(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false"><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""))({items:this.store.toJSON(),scope:this})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller(_.extend({el:$(".dropdown-menu",this.cmpEl),minScrollbarLength:40,includePadding:!0,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible},this.options.scroller))},focus:function(){this._input&&this._input.focus()}}),Common.UI.ComboBoxCustom=Common.UI.ComboBox.extend(_.extend({itemClicked:function(t){Common.UI.ComboBox.prototype.itemClicked.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},setValue:function(t,e){Common.UI.ComboBox.prototype.setValue.call(this,t,e),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem,e)},selectRecord:function(t){Common.UI.ComboBox.prototype.selectRecord.call(this,t),this.options.updateFormControl&&this.options.updateFormControl.call(this,this._selectedItem)},setWidth:function(t){this.cmpEl&&this.cmpEl.width(t)},focus:function(){this.cmpEl&&this.cmpEl.find(".form-control").focus()}},Common.UI.ComboBoxCustom||{})),Common.UI.ComboBoxRecent=Common.UI.ComboBox.extend(_.extend({initialize:function(t){this.setRecent(t.recent),Common.UI.ComboBox.prototype.initialize.call(this,t)},render:function(t){return Common.UI.ComboBox.prototype.render.call(this,t),$(this.el).find("ul").prepend($('<li class="divider">')),this.loadRecent(),this},setData:function(t){Common.UI.ComboBox.prototype.setData.call(this,t),$(this.el).find("ul").prepend($('<li class="divider">')),this.loadRecent()},itemClicked:function(t){Common.UI.ComboBox.prototype.itemClicked.call(this,t),this._selectedItem&&this.addItemToRecent(this._selectedItem)},onAfterShowMenu:function(t){this.recent&&this.recentArr&&this.recentArr.length?(this.alignMenuPosition(),$(this.el).find("ul").scrollTop(0),this.scroller&&this.scroller.update({alwaysVisibleY:this.scrollAlwaysVisible}),this.cmpEl.find(".form-control").attr("aria-expanded","true"),this.trigger("show:after",this,t,{fromKeyDown:void 0===t}),this._search={}):Common.UI.ComboBox.prototype.onAfterShowMenu.apply(this,arguments)},onBeforeShowMenu:function(t){if(this.loadRecent(),Common.UI.ComboBox.prototype.onBeforeShowMenu.apply(this,arguments),this._selectedItem){let t,e=this.store.findWhere((t={},t[this.valueField]=this._selectedItem.get(this.valueField),t));e&&this.selectRecord(e)}},setRecent:function(t){var e=Common.localStorage.getKeysFilter();this.recent=!!t&&{count:t.count||5,key:t.key||(e&&e.length?e.split(",")[0]:"")+this.id,offset:t.offset||0,valueField:t.valueField||"value"}},loadRecent:function(){if(this.recent){this.recentArr||(this.recentArr=[],this.store.on("add",this.onInsertRecentItem,this),this.store.on("remove",this.onRemoveRecentItem,this)),this.store.remove(this.store.where({isRecent:!0}));var t=this,e=Common.localStorage.getItem(this.recent.key);(e=e?e.split(";"):[]).reverse().forEach((function(e){let i;e&&t.addItemToRecent(t.store.findWhere((i={},i[t.recent.valueField]=e,i)),!0,0)})),this.recentArr=e}},addItemToRecent:function(t,e,i){if(!t||!this.recent)return;let n,o=this,s=this.store.findWhere((n={isRecent:!0},n[this.recent.valueField]=t.get(this.recent.valueField),n));if(!(s&&this.store.indexOf(s)<this.recent.offset)){s&&this.store.remove(s);var a=this.store.where({isRecent:!0});a.length<this.recent.count||this.store.remove(a[this.recent.count-1]);var r=t.clone();if(r.set({isRecent:!0,id:Common.UI.getId(),cloneid:t.id}),this.store.add(r,{at:void 0!==i?i:this.recent.offset}),!e){var l=[];this.store.where({isRecent:!0}).forEach((function(t){l.push(t.get(o.recent.valueField))})),this.recentArr=l,Common.localStorage.setItem(this.recent.key,l.join(";"))}}},onInsertRecentItem:function(t,e,i){var n=$(this.el).find("ul > li").eq(i&&i.at||0);this.itemTemplate?n.before($(this.itemTemplate(t.attributes))):n.before(_.template(['<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false"><%= scope.getDisplayValue(item) %></a></li>'].join(""))({item:t.attributes,scope:this}))},onRemoveRecentItem:function(t,e,i){$(this.el).find("ul > li#"+t.id).remove()}},Common.UI.ComboBoxRecent||{}))})),void 0===Common)var Common={};if(define("common/main/lib/component/DataView",["common/main/lib/component/BaseView","common/main/lib/component/Scroller"],(function(){"use strict";Common.UI.DataViewGroupModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),caption:"",inline:!1,headername:void 0}}}),Common.UI.DataViewGroupStore=Backbone.Collection.extend({model:Common.UI.DataViewGroupModel}),Common.UI.DataViewModel=Backbone.Model.extend({defaults:function(){return{id:Common.UI.getId(),selected:!1,allowSelected:!0,value:null,disabled:!1}}}),Common.UI.DataViewStore=Backbone.Collection.extend({model:Common.UI.DataViewModel}),Common.UI.DataViewItem=Common.UI.BaseView.extend({options:{},template:_.template(['<div id="<%= id %>"><%= value %></div>'].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.dataHint=e.options.dataHint||"",e.dataHintDirection=e.options.dataHintDirection||"",e.dataHintOffset=e.options.dataHintOffset||"",e.scaling=e.options.scaling,e.listenTo(e.model,"change",this.model.get("skipRenderOnChange")?e.onChange:e.render),e.listenTo(e.model,"change:selected",e.onSelectChange),e.listenTo(e.model,"change:tip",e.onTipChange),e.listenTo(e.model,"remove",e.remove)},render:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);t.html(this.template(this.model.toJSON())),t.addClass("item canfocused"),t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.attr("tabindex",this.options.tabindex||0),t.attr("role",this.options.role?this.options.role:"listitem"),""!==this.dataHint&&(t.attr("data-hint",this.dataHint),t.attr("data-hint-direction",this.dataHintDirection),t.attr("data-hint-offset",this.dataHintOffset)),_.isUndefined(this.model.get("contentTarget"))||t.attr("content-target",this.model.get("contentTarget")),t.off("click dblclick contextmenu"),t.on({click:_.bind(this.onClick,this),dblclick:_.bind(this.onDblClick,this),contextmenu:_.bind(this.onContextMenu,this)}),t.toggleClass("disabled",!!this.model.get("disabled")),_.isUndefined(this.model.get("cls"))||t.addClass(this.model.get("cls"));var e=t.data("bs.tooltip");return e&&void 0===e.dontShow&&t.is(":hover")&&(e.dontShow=!0),!1!==this.scaling&&t.find(".options__icon").length&&(t.attr("ratio","ratio"),this.applyScaling(Common.UI.Scaling.currentRatio()),t.on("app:scaling",_.bind((function(t,e){this.scaling!=e.ratio&&this.applyScaling(e.ratio)}),this))),this.trigger("change",this,this.model),this},remove:function(){this.stopListening(this.model),this.trigger("remove",this,this.model),Common.UI.BaseView.prototype.remove.call(this)},onClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("click",this,this.model,t)},onDblClick:function(t){if(this.model.get("disabled"))return!1;this.trigger("dblclick",this,this.model,t)},onContextMenu:function(t){this.trigger("contextmenu",this,this.model,t)},onSelectChange:function(t,e){this.trigger("select",this,t,e)},onTipChange:function(t,e){this.trigger("tipchange",this,t)},onChange:function(){if(_.isUndefined(this.model.id))return this;var t=this.$el||$(this.el);return t.toggleClass("selected",this.model.get("selected")&&this.model.get("allowSelected")),t.toggleClass("disabled",!!this.model.get("disabled")),this.trigger("change",this,this.model),this},applyScaling:function(t){if(this.scaling=t,t>2){var e=this.$el||$(this.el),i=e.find(".options__icon");if(i.length>0&&!e.find("svg.icon").length){var n=i.attr("class"),o=/btn-[^\s]+/.exec(n),s=o?o[0]:"null",a='<svg class="icon"><use class="zoom-int" href="#%iconname"></use></svg>'.replace("%iconname",s);i.after(a)}}}}),Common.UI.DataView=Common.UI.BaseView.extend({options:{multiSelect:!1,handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,emptyText:"",listenStoreEvents:!0,allowScrollbar:!0,scrollAlwaysVisible:!1,minScrollbarLength:40,scrollYStyle:null,showLast:!0,useBSKeydown:!1,cls:"",role:"list"},template:_.template(['<div class="dataview inner <%= cls %>" style="<%= style %>" role="<%= options.role %>">',"<% _.each(groups, function(group) { %>","<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.groups=e.options.groups||null,e.itemTemplate=e.options.itemTemplate||null,e.itemDataHint=e.options.itemDataHint||"",e.itemDataHintDirection=e.options.itemDataHintDirection||"",e.itemDataHintOffset=e.options.itemDataHintOffset||"",e.multiSelect=e.options.multiSelect,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.outerMenu=e.options.outerMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.showLast=e.options.showLast,e.style=e.options.style||"",e.cls=e.options.cls||"",e.emptyText=e.options.emptyText||"",e.listenStoreEvents=void 0===e.options.listenStoreEvents||e.options.listenStoreEvents,e.allowScrollbar=void 0===e.options.allowScrollbar||e.options.allowScrollbar,e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.minScrollbarLength=e.options.minScrollbarLength||40,e.scrollYStyle=e.options.scrollYStyle,e.tabindex=e.options.tabindex||0,e.itemTabindex=void 0!==e.options.itemTabindex?e.options.itemTabindex:e.tabindex>0?-1:0,e.delayRenderTips=e.options.delayRenderTips||!1,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.delaySelect=e.options.delaySelect||!1,e.rendered=!1,e.dataViewItems=[],"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],!1===e.options.scaling&&(e.cls=e.options.cls+" scaling-off"),e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({groups:e.groups?e.groups.toJSON():null,style:e.style,cls:e.cls,options:e.options})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems),this.groups&&(this.listenTo(this.groups,"add",this.onAddGroup),this.listenTo(this.groups,"remove",this.onRemoveGroup))),this.onResetItems(),this.parentMenu&&(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this))),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(e.showLast||this.parentMenu.on("show:before",(function(t){e.deselectAll()})),this.parentMenu.on("show:after",(function(t,i){i&&t.el!==i.target||(e.showLast&&e.showLastSelected(),e.outerMenu&&!1===e.outerMenu.focusOnShow||(Common.NotificationCenter.trigger("dataview:focus"),_.delay((function(){t.cmpEl.find(".dataview").focus()}),10)))})).on("hide:after",(function(){Common.NotificationCenter.trigger("dataview:blur")})))),_.isUndefined(this.scroller)&&this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,(this.$el||$(this.el)).on("click",(function(t){if(/dataview|grouped-data|group-items-container/.test(t.target.className)||$(t.target).closest(".group-description").length>0)return!1})),this.trigger("render:after",this),this},setStore:function(t){t&&(this.stopListening(this.store),this.store=t,this.listenStoreEvents&&(this.listenTo(this.store,"add",this.onAddItem),this.listenTo(this.store,"reset",this.onResetItems)))},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.extremeSeletedRec=t,!this.multiSelect||!this.pressedShift&&!this.pressedCtrl||!this.currentSelectedRec||this.pressedShift&&this.currentSelectedRec==t)_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),t&&(t.set({selected:!0}),this.currentSelectedRec=t);else if(t)if(this.pressedCtrl)t.set({selected:!t.get("selected")}),this.currentSelectedRec=t;else if(this.pressedShift){var i=this,n=!1;_.each(i.store.models,(function(e){i.currentSelectedRec==e||t==e?(n=!n,e.set({selected:!0})):e.set({selected:n})}))}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),this.lastSelectedRec=null,t&&this.resumeEvents()},getSelectedRec:function(){return this.multiSelect?this.store.where({selected:!0}):this.store.findWhere({selected:!0})},onAddItem:function(t,e,i){var n=new Common.UI.DataViewItem({template:this.itemTemplate,model:t,scaling:this.options.scaling,dataHint:this.itemDataHint,dataHintDirection:this.itemDataHintDirection,dataHintOffset:this.itemDataHintOffset,tabindex:this.itemTabindex});if(n){var o=$(this.el).find(".inner").addBack().filter(".inner");if(this.groups&&this.groups.length>0){var s=this.groups.findWhere({id:t.get("group")});s&&(o=o.find("#"+s.id+" .group-items-container"))}var a=_.indexOf(this.store.models,t);if(o){if(i&&"number"==typeof i.at&&i.at>=0)if(0==i.at)o.prepend(n.render().el);else if(this.groups&&this.groups.length>0)o.append(n.render().el);else{var r=o.find("> div");a>0?$(r.get(a-1)).after(n.render().el):r.length>0?$(r[a]).before(n.render().el):o.append(n.render().el)}else o.append(n.render().el);this.dataViewItems.length<1&&o.find(".empty-text").remove(),this.dataViewItems=this.dataViewItems.slice(0,a).concat(n).concat(this.dataViewItems.slice(a));var l=this,c=$(n.el),h=t.get("tip");null!=h&&(this.delayRenderTips?(c.one("mouseenter",(function(){c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}),c.mouseenter()})),c.attr("aria-label",t.get("tip"))):(c.attr("data-toggle","tooltip"),c.tooltip({title:t.get("tip"),placement:"cursor",zIndex:l.tipZIndex}),c.attr("aria-label",t.get("tip")))),this.listenTo(n,"change",this.onChangeItem),this.listenTo(n,"remove",this.onRemoveItem),this.listenTo(n,"click",this.onClickItem),this.listenTo(n,"dblclick",this.onDblClickItem),this.listenTo(n,"select",this.onSelectItem),this.listenTo(n,"contextmenu",this.onContextMenuItem),null==h&&this.listenTo(n,"tipchange",this.onInitItemTip),this.isSuspendEvents||this.trigger("item:add",this,n,t)}}this._layoutParams=void 0},onAddGroup:function(t){var e=$(_.template(["<% if (group.headername !== undefined) { %>",'<div class="header-name"><%= group.headername %></div>',"<% } %>",'<div class="grouped-data <% if (group.inline) { %> group.inline <% } %> <% if (!_.isEmpty(group.caption)) { %> margin <% } %>" id="<%= group.id %>">',"<% if (!_.isEmpty(group.caption)) { %>",'<div class="group-description">',"<span><%= group.caption %></span>","</div>","<% } %>",'<div class="group-items-container">',"</div>","</div>"].join(""))({group:t.toJSON()})),i=$(this.el).find(".inner").addBack().filter(".inner");if(i){var n=_.indexOf(this.groups.models,t),o=i.find(".grouped-data");n>0?$(o.get(n-1)).after(e):o.length>0?$(o[n]).before(e):i.append(e)}},onRemoveGroup:function(t){var e=$(this.el).find(".inner").addBack().filter(".inner");if(e){var i=e.find("#"+t.get("id")+".grouped-data");i&&i.remove()}this._layoutParams=void 0},onResetItems:function(){this.trigger("reset:before",this),_.each(this.dataViewItems,(function(t){var e=t.$el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())}),this),$(this.el).html(this.template({groups:this.groups?this.groups.toJSON():null,style:this.style,cls:this.cls,options:this.options})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.store.length<1&&this.emptyText.length>0&&$(this.el).find(".inner").addBack().filter(".inner").append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>"),_.each(this.dataViewItems,(function(t){this.stopListening(t),t.stopListening(t.model)}),this),this.dataViewItems=[];var t=this;this.store.each((function(e){t.onAddItem(e,t.store)}),this),this.allowScrollbar&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.disabled&&this.setDisabled(this.disabled),this.attachKeyEvents(),this.lastSelectedRec=null,this._layoutParams=void 0},onChangeItem:function(t,e){this.isSuspendEvents||this.trigger("item:change",this,t,e)},onInitItemTip:function(t,e){var i=this,n=$(t.el),o=n.data("bs.tooltip");null!=o&&n.removeData("bs.tooltip"),this.delayRenderTips?(n.one("mouseenter",(function(){n.attr("data-toggle","tooltip"),n.tooltip({title:e.get("tip"),placement:"cursor",zIndex:i.tipZIndex}),n.mouseenter()})),n.attr("aria-label",e.get("tip"))):(n.attr("data-toggle","tooltip"),n.tooltip({title:e.get("tip"),placement:"cursor",zIndex:i.tipZIndex}),n.attr("aria-label",e.get("tip")))},onRemoveItem:function(t,e){var i=t.$el.data("bs.tooltip");if(i&&(void 0===i.dontShow&&(i.dontShow=!0),i.tip().remove()),this.stopListening(t),t.stopListening(),this.store.length<1&&this.emptyText.length>0){var n=$(this.el).find(".inner").addBack().filter(".inner");n.find(".empty-text").length<=0&&n.append('<table cellpadding="10" class="empty-text"><tr><td>'+this.emptyText+"</td></tr></table>")}for(var o=0;o<this.dataViewItems.length;o++)if(_.isEqual(t,this.dataViewItems[o])){this.dataViewItems.splice(o,1);break}this.isSuspendEvents||this.trigger("item:remove",this,t,e),this._layoutParams=void 0},onClickItem:function(t,e,i){if(!this.disabled){window._event=i,this.multiSelect&&(i&&i.ctrlKey?this.pressedCtrl=!0:i&&i.shiftKey&&(this.pressedShift=!0)),this.showLast&&(this.delaySelect?(_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),e&&setTimeout(_.bind((function(){e.set({selected:!0}),this.trigger("item:click",this,t,e,i)}),this),300)):this.selectRecord(e)),this.lastSelectedRec=null;var n=t.$el.data("bs.tooltip");n&&n.tip().remove(),this.isSuspendEvents||this.delaySelect||this.trigger("item:click",this,t,e,i)}},onDblClickItem:function(t,e,i){this.disabled||(window._event=i,this.showLast&&this.selectRecord(e),this.lastSelectedRec=null,this.isSuspendEvents||this.trigger("item:dblclick",this,t,e,i))},onSelectItem:function(t,e,i){this.isSuspendEvents||this.trigger(i?"item:select":"item:deselect",this,t,e,this._fromKeyDown)},onContextMenuItem:function(t,e,i){this.isSuspendEvents||this.trigger("item:contextmenu",this,t,e,i)},scrollToRecord:function(t,e,i){if(t){var n=$(this.el).find(".inner"),o=Common.Utils.getOffset(n).top+(i||0),s=_.indexOf(this.store.models,t),a=s>=0&&this.dataViewItems.length>s?$(this.dataViewItems[s].el):n.find("#"+t.get("id"));if(!(a.length<=0)){var r=Common.Utils.getOffset(a).top,l=$(this.dataViewItems[0].el),c=l.length>0?l[0].clientTop:0;(e||r<o+c||r+.9*a.outerHeight()>o+c+n.height())&&(this.scroller&&this.allowScrollbar?this.scroller.scrollTop(n.scrollTop()+r-o-c,0):n.scrollTop(n.scrollTop()+r-o-c))}}},onKeyDown:function(t,e){if(!this.disabled&&(void 0===e&&(e=t),!e.isDefaultPrevented()&&this.enableKeyEvents))if(this.multiSelect&&(e.keyCode==Common.UI.Keys.CTRL?this.pressedCtrl=!0:e.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!0)),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.multiSelect?this.extremeSeletedRec:this.getSelectedRec();if(null===this.lastSelectedRec&&(this.lastSelectedRec=i),e.keyCode==Common.UI.Keys.RETURN)this.lastSelectedRec=null,this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.trigger("item:click",this,this,i,t),this.trigger("item:select",this,this,i,t),this.trigger("entervalue",this,i,t),this.parentMenu&&this.parentMenu.hide();else{function c(){if(0===this.dataViewItems.length)return 0;for(var t=0;!this.dataViewItems[t]||!this.dataViewItems[t].$el||this.dataViewItems[t].$el.hasClass("disabled");)t++;return t}function h(){if(0===this.dataViewItems.length)return 0;for(var t=this.dataViewItems.length-1;!this.dataViewItems[t]||!this.dataViewItems[t].$el||this.dataViewItems[t].$el.hasClass("disabled");)t--;return t}this.pressedCtrl=!1;var n=_.indexOf(this.store.models,i);if(n<0)if(e.keyCode==Common.UI.Keys.LEFT)(a=$(t.target).closest(".dropdown-submenu.over")).length>0?(a.removeClass("over"),a.find("> a").focus()):n=c.call(this);else n=c.call(this);else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o=this.dataViewItems[n].topIdx,s=this.dataViewItems[n].leftIdx;function d(){var t=this.dataViewItems[this._layoutParams.itemsIndexes[o][s]];if(t&&t.$el&&!t.$el.hasClass("disabled"))return this._layoutParams.itemsIndexes[o][s]}if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--s<0){var a;if((a=$(t.target).closest(".dropdown-submenu.over")).length>0){a.removeClass("over"),a.find("> a").focus();break}s=this._layoutParams.columns-1}n=d.call(this)}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++s>this._layoutParams.columns-1&&(s=0),n=d.call(this);else if(e.keyCode==Common.UI.Keys.UP){if(0==o&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)--o<0&&(o=this._layoutParams.rows-1),n=d.call(this)}else{if(o==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)++o>this._layoutParams.rows-1&&(o=0),n=d.call(this)}}else{o=n;var r=c.call(this),l=h.call(this);function u(){var t=this.dataViewItems[o];if(t&&t.$el&&!t.$el.hasClass("disabled"))return o}for(n=void 0;void 0===n;)o=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(r,o-1):Math.min(l,o+1),n=u.call(this)}void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),-1!==this.itemTabindex&&this.dataViewItems[n]&&this.dataViewItems[n].$el.focus(),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},onKeyUp:function(t){this.enableKeyEvents&&(t.keyCode==Common.UI.Keys.SHIFT&&(this.pressedShift=!1),t.keyCode==Common.UI.Keys.CTRL&&(this.pressedCtrl=!1),this.trigger("item:keyup",this,t))},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this)),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keyup":"keyup",_.bind(this.onKeyUp,this))}},showLastSelected:function(){if(this.lastSelectedRec)this.selectRecord(this.lastSelectedRec,!0),this.scrollToRecord(this.lastSelectedRec),this.lastSelectedRec=null;else{var t=this.getSelectedRec();this.multiSelect?t&&t.length>0&&this.scrollToRecord(t[t.length-1]):this.scrollToRecord(t)}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},setEmptyText:function(t){if(this.emptyText=t,this.store.length<1){var e=$(this.el).find(".inner").addBack().filter(".inner").find(".empty-text td");e.length>0&&e.text(this.emptyText)}},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=t.outerHeight(),o=i.height(),s=Math.max(n-o,0),a=parseInt(t.css("top")),r={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(r.alwaysVisibleY=this.scrollAlwaysVisible),a+n>e?(i.css("max-height",e-a-s+"px"),this.allowScrollbar&&this.scroller.update(r)):a+n<e&&o<this.options.restoreHeight&&(i.css("max-height",Math.min(e-a-s,this.options.restoreHeight)+"px"),this.allowScrollbar&&this.scroller.update(r))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=$(this.dataViewItems[0].el),e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=Common.Utils.getOffset(this.$el).left,n=Common.Utils.getOffset(t).top,o=-1,s=0,a=0,r=0;r<this.dataViewItems.length;r++){var l=Common.Utils.getOffset($(this.dataViewItems[r].el)).top-n;a=Math.floor((Common.Utils.getOffset($(this.dataViewItems[r].el)).left-i)/e+.01),l>o&&(o=l,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][a]=r,this.dataViewItems[r].topIdx=s,this.dataViewItems[r].leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},setMultiselectMode:function(t){this.pressedCtrl=!!t},onResize:function(){this._layoutParams=void 0},focus:function(t){var e;$(this.el).find(".inner").addBack().filter(".inner").focus(),"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),Common.UI.DataViewSimple=Common.UI.BaseView.extend({options:{handleSelect:!0,enableKeyEvents:!0,keyMoveDirection:"both",restoreHeight:0,scrollAlwaysVisible:!1,useBSKeydown:!1},template:_.template(['<div class="dataview inner" style="<%= style %>" role="list">',"<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" role="listitem" <% if(typeof itemTabindex !== undefined) { %> tabindex="<%= itemTabindex %>" <% } %> <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.store=e.options.store||new Common.UI.DataViewStore,e.itemTemplate=e.options.itemTemplate||null,e.handleSelect=e.options.handleSelect,e.parentMenu=e.options.parentMenu,e.outerMenu=e.options.outerMenu,e.enableKeyEvents=e.options.enableKeyEvents,e.useBSKeydown=e.options.useBSKeydown,e.style=e.options.style||"",e.scrollAlwaysVisible=e.options.scrollAlwaysVisible||!1,e.tabindex=e.options.tabindex||0,e.itemTabindex=void 0!==e.options.itemTabindex?e.options.itemTabindex:e.tabindex>0?-1:0,e.parentMenu&&(e.parentMenu.options.restoreHeight=e.options.restoreHeight>0),e.rendered=!1,"vertical"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN]:"horizontal"==e.options.keyMoveDirection?e.moveKeys=[Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT]:e.moveKeys=[Common.UI.Keys.UP,Common.UI.Keys.DOWN,Common.UI.Keys.LEFT,Common.UI.Keys.RIGHT],e.options.el&&e.render()},render:function(t){var e=this;this.trigger("render:before",this),t?(this.setElement(t,!1),this.cmpEl=$(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,itemTabindex:e.itemTabindex||0})),t.html(this.cmpEl)):(this.cmpEl=e.$el||$(this.el),this.cmpEl.html(this.template({items:e.store.toJSON(),itemTemplate:e.itemTemplate,style:e.style,options:e.options,itemTabindex:e.itemTabindex||0})));var i=this.cmpEl.closest(".asc-window");return i.length<1&&(i=this.cmpEl.closest('[id^="menu-container-"]')),i.length>0&&(this.tipZIndex=parseInt(i.css("z-index"))+10),this.rendered||(this.parentMenu?(this.cmpEl.closest("li").css("height","100%"),this.cmpEl.css("height","100%"),this.parentMenu.on("show:after",_.bind(this.alignPosition,this)),this.parentMenu.on("show:after",_.bind(this.onAfterShowMenu,this))):this.store.length>0&&this.onAfterShowMenu(),this.enableKeyEvents&&this.parentMenu&&this.handleSelect&&(this.parentMenu.on("show:before",(function(t){e.deselectAll()})),this.parentMenu.on("show:after",(function(t){Common.NotificationCenter.trigger("dataview:focus"),_.delay((function(){t.cmpEl.find(".dataview").focus()}),10)})).on("hide:after",(function(){Common.NotificationCenter.trigger("dataview:blur")}))),this.attachKeyEvents(),this.cmpEl.on("click","div.item",_.bind(e.onClickItem,e))),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible})),this.rendered=!0,(this.$el||$(this.el)).on("click",(function(t){if(/dataview|grouped-data|group-items-container/.test(t.target.className)||$(t.target).closest(".group-description").length>0)return!1})),this.trigger("render:after",this),this},selectRecord:function(t,e){if(this.handleSelect){if(e&&this.suspendEvents(),this.deselectAll(e),t){t.set({selected:!0});var i=_.indexOf(this.store.models,t);i>=0&&this.dataViewItems&&this.dataViewItems.length>i&&this.dataViewItems[i].el.addClass("selected")}return e&&this.resumeEvents(),t}},selectByIndex:function(t,e){if(this.store.length>0&&t>-1&&t<this.store.length)return this.selectRecord(this.store.at(t),e)},deselectAll:function(t){t&&this.suspendEvents(),_.each(this.store.where({selected:!0}),(function(t){t.set({selected:!1})})),this.cmpEl.find(".item.selected").removeClass("selected"),this.lastSelectedRec=null,t&&this.resumeEvents()},getSelectedRec:function(){return this.store.findWhere({selected:!0})},onResetItems:function(){this.dataViewItems&&_.each(this.dataViewItems,(function(t){var e=t.el.data("bs.tooltip");e&&(void 0===e.dontShow&&(e.dontShow=!0),e.tip().remove())}),this),this.dataViewItems=null;var t=_.template(["<% _.each(items, function(item) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item" role="listitem" <% if(typeof itemTabindex !== undefined) { %> tabindex="<%= itemTabindex %>" <% } %> <% if(!!item.tip) { %> data-toggle="tooltip" <% } %> data-hint="<%= item.dataHint %>" data-hint-direction="<%= item.dataHintDirection %>" data-hint-offset="<%= item.dataHintOffset %>"><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));this.cmpEl&&this.cmpEl.find(".inner").html(t({items:this.store.toJSON(),itemTemplate:this.itemTemplate,style:this.style,itemTabindex:this.itemTabindex||0})),_.isUndefined(this.scroller)||(this.scroller.destroy(),delete this.scroller),this.scroller=new Common.UI.Scroller({el:$(this.el).find(".inner").addBack().filter(".inner"),useKeyboard:this.enableKeyEvents&&!this.handleSelect,minScrollbarLength:this.minScrollbarLength,scrollYStyle:this.scrollYStyle,wheelSpeed:10,alwaysVisibleY:this.scrollAlwaysVisible}),!this.parentMenu&&this.store.length>0&&this.onAfterShowMenu(),this._layoutParams=void 0},setStore:function(t){t&&(this.store=t,this.onResetItems())},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.item").index(),i=e>=0?this.store.at(e):null,n=e>=0?this.dataViewItems[e]:null;if(i&&n){i.set({selected:!0});var o=n.el.data("bs.tooltip");o&&o.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,n.el,i,t)}}},onAfterShowMenu:function(t){if(!this.dataViewItems){var e=this;this.dataViewItems=[],_.each(this.cmpEl.find("div.item"),(function(t,i){var n=$(t),o=e.store.at(i);e.dataViewItems.push({el:n});var s=o.get("tip");s&&(n.tooltip({title:s,placement:"cursor",zIndex:e.tipZIndex}),n.attr("aria-label",s))}))}},scrollToRecord:function(t){if(t){var e=$(this.el).find(".inner"),i=Common.Utils.getOffset(e).top,n=_.indexOf(this.store.models,t),o=n>=0&&this.dataViewItems.length>n?this.dataViewItems[n].el:e.find("#"+t.get("id"));if(!(o.length<=0)){var s=Common.Utils.getOffset(o).top,a=this.dataViewItems[0].el,r=a.length>0?a[0].offsetTop:0;(s<i+r||s+o.outerHeight()>i+e.height())&&(this.scroller?this.scroller.scrollTop(e.scrollTop()+s-i-r,0):e.scrollTop(e.scrollTop()+s-i-r))}}},onKeyDown:function(t,e){if(!this.disabled)if(void 0===e&&(e=t),_.indexOf(this.moveKeys,e.keyCode)>-1||e.keyCode==Common.UI.Keys.RETURN){e.preventDefault(),e.stopPropagation();var i=this.getSelectedRec();if(e.keyCode==Common.UI.Keys.RETURN)this.selectedBeforeHideRec&&(i=this.selectedBeforeHideRec),this.canAddRecents&&this.addRecentItem(i),this.trigger("item:click",this,this,i,t),this.parentMenu&&this.parentMenu.hide();else{var n=_.indexOf(this.store.models,i);if(n<0){function r(){if(0===this.dataViewItems.length)return 0;for(var t=0;!this.dataViewItems[t].el.is(":visible");)t++;return t}if(e.keyCode==Common.UI.Keys.LEFT)(a=$(t.target).closest(".dropdown-submenu.over")).length>0?(a.removeClass("over"),a.find("> a").focus()):n=r.call(this);else n=r.call(this)}else if("both"==this.options.keyMoveDirection){void 0===this._layoutParams&&this.fillIndexesArray();var o=this.dataViewItems[n].topIdx,s=this.dataViewItems[n].leftIdx;if(n=void 0,e.keyCode==Common.UI.Keys.LEFT)for(;void 0===n;){if(--s<0){var a;if((a=$(t.target).closest(".dropdown-submenu.over")).length>0){a.removeClass("over"),a.find("> a").focus();break}s=this._layoutParams.columns-1}n=this._layoutParams.itemsIndexes[o][s]}else if(e.keyCode==Common.UI.Keys.RIGHT)for(;void 0===n;)++s>this._layoutParams.columns-1&&(s=0),n=this._layoutParams.itemsIndexes[o][s];else if(e.keyCode==Common.UI.Keys.UP){if(0==o&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)--o<0&&(o=this._layoutParams.rows-1),n=this._layoutParams.itemsIndexes[o][s]}else{if(o==this._layoutParams.rows-1&&this.outerMenu&&this.outerMenu.menu)return this.deselectAll(!0),void(this.outerMenu.menu.focusOuter&&this.outerMenu.menu.focusOuter(e,this.outerMenu.index));for(;void 0===n;)++o>this._layoutParams.rows-1&&(o=0),n=this._layoutParams.itemsIndexes[o][s]}}else n=e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.LEFT?Math.max(0,n-1):Math.min(this.store.length-1,n+1);void 0!==n&&n>=0&&(i=this.store.at(n)),i&&(this._fromKeyDown=!0,this.selectRecord(i),this.scrollToRecord(i),-1!==this.itemTabindex&&this.dataViewItems[n]&&$(this.dataViewItems[n].el).focus(),this._fromKeyDown=!1)}}else this.trigger("item:keydown",this,i,t)},attachKeyEvents:function(){if(this.enableKeyEvents&&this.handleSelect){var t=$(this.el).find(".inner").addBack().filter(".inner");t.addClass("canfocused"),t.attr("tabindex",this.tabindex.toString()),t.on(this.parentMenu&&this.useBSKeydown?"dataview:keydown":"keydown",_.bind(this.onKeyDown,this))}},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).find(".inner").addBack().filter(".inner").toggleClass("disabled",t)},isDisabled:function(){return this.disabled},alignPosition:function(){var t="menu"===this.parentMenu.cmpEl.attr("role")?this.parentMenu.cmpEl:this.parentMenu.cmpEl.find("[role=menu]"),e=Common.Utils.innerHeight()-10,i=$(this.el).find(".inner").addBack().filter(".inner"),n=i.parent(),o=parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+parseInt(t.css("margin-top")),s=parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),a=t.outerHeight(),r=parseInt(t.css("top")),l={minScrollbarLength:this.minScrollbarLength};this.scrollAlwaysVisible&&(l.alwaysVisibleY=this.scrollAlwaysVisible);var c=!1;if(this.parentMenu.menuAlign){var h=this.parentMenu.menuAlign.match(/^([a-z]+)-([a-z]+)/);c="bl"===h[1]||"br"===h[1]}if(c){var d=r+a;r<0?(i.css("max-height",d-s-o+"px"),t.css("top",0),this.scroller.update(l)):r>0&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(d-s-o,this.options.restoreHeight)+"px"),t.css("top",d-t.outerHeight()),this.scroller.update(l))}else r+a>e?(i.css("max-height",e-r-s-o+"px"),this.scroller.update(l)):r+a<e&&i.height()<this.options.restoreHeight&&(i.css("max-height",Math.min(e-r-s-o,this.options.restoreHeight)+"px"),this.scroller.update(l))},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=t.outerWidth()+parseFloat(t.css("margin-left"))+parseFloat(t.css("margin-right")),i=Common.Utils.getOffset(this.$el).left,n=Common.Utils.getOffset(t).top,o=-1,s=0,a=0,r=0;r<this.dataViewItems.length;r++){var l=this.dataViewItems[r],c=Common.Utils.getOffset(l.el).top-n;a=Math.floor((Common.Utils.getOffset(l.el).left-i)/e),c>o&&(o=c,this._layoutParams.itemsIndexes.push([]),s=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[s][a]=r,l.topIdx=s,l.leftIdx=a,this._layoutParams.columns<a&&(this._layoutParams.columns=a)}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},onResize:function(){this._layoutParams=void 0},focus:function(t){var e;this.cmpEl&&this.cmpEl.find(".dataview").focus(),"string"==typeof t?"first"==t?e=this.selectByIndex(0,!0):"last"==t&&(void 0===this._layoutParams&&this.fillIndexesArray(),e=this.selectByIndex(this._layoutParams.itemsIndexes[this._layoutParams.rows-1][0],!0)):void 0!==t&&(e=this.selectByIndex(t,!0)),this.scrollToRecord(e)},focusInner:function(t){this.focus(t.keyCode==Common.UI.Keys.DOWN?"first":"last")}}),$(document).on("keydown.dataview","[data-toggle=dropdown], [role=menu]",(function(t){t.keyCode!==Common.UI.Keys.UP&&t.keyCode!==Common.UI.Keys.DOWN&&t.keyCode!==Common.UI.Keys.LEFT&&t.keyCode!==Common.UI.Keys.RIGHT&&t.keyCode!==Common.UI.Keys.RETURN||_.defer((function(){var e=$(t.target).closest(".dropdown-toggle");e.length?e.parent().find(".inner.canfocused").trigger("dataview:keydown",t):$(t.target).closest(".dropdown-submenu").find(".inner.canfocused").trigger("dataview:keydown",t)}),100)})),Common.UI.DataViewShape=Common.UI.DataViewSimple.extend(_.extend({template:_.template(['<div class="dataview inner" style="<%= style %>" role="list">',"<% _.each(options.groupsWithRecent, function(group, index) { %>",'<div class="grouped-data <% if (index === 0) { %> recent-group <% } %> " id="<%= group.id %>" >',"<% if (!_.isEmpty(group.groupName)) { %>",'<div class="group-description">',"<span><%= group.groupName %></span>","</div>","<% } %>",'<div class="group-items-container <% if (index === 0) { %> recent-items <% } %>">',"<% _.each(group.groupStore.toJSON(), function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item canfocused" role="listitem" <% if (typeof itemTabindex !== undefined) { %> tabindex="<%= itemTabindex %>" <% } %> data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }); %>","</div>","</div>","<% }); %>","</div>"].join("")),initialize:function(t){var e=this;this.canAddRecents=!0,this._state={hideTextRect:t.hideTextRect,hideLines:t.hideLines};var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"",e.groups=t.groups.toJSON();var n=new Common.UI.DataViewGroupStore,o=t.recentShapes||[],s=o.length>18?7:6,a=35*Math.ceil(o.length/s)+3,r=30*s;if((e.recentShapes=o,e.recentShapes.length>0)&&!_.findWhere(e.groups,{groupName:e.recentShapes[0].groupName})){for(var l=0;l<e.recentShapes.length;l++)for(var c,h=e.recentShapes[l].data.shapeType,d=0;d<e.groups.length;d++){for(var u=e.groups[d].groupStore,m=e.groups[d].groupName,p=0;p<u.length;p++)if(u.at(p).get("data").shapeType===h){c=u.at(p).toJSON(),e.recentShapes[l]={data:c.data,tip:c.tip,allowSelected:c.allowSelected,selected:!1,groupName:m};break}if(c){c=void 0;break}}Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(e.recentShapes))}if(e.recentShapes.length<12){var f=12-e.recentShapes.length,g=[],b=function(t,e){var i=t.toJSON(),n={data:i.data,tip:i.tip,allowSelected:i.allowSelected,selected:!1,groupName:e};g.push(n)};for(p=0;p<e.groups.length&&f>0;p++){var v=e.groups[p].groupStore;m=e.groups[p].groupName;0===p?(b(v.at(1),m),--f>0&&(b(v.at(2),m),f--)):3!==p&&6!==p&&7!==p&&(b(v.at(0),m),--f>0&&(b(v.at(1),m),f--))}e.recentShapes=e.recentShapes.concat(g)}n.add(e.recentShapes),e.groups.unshift({groupName:t.textRecentlyUsed,groupStore:n,groupWidth:r,groupHeight:a}),e.options.groupsWithRecent=e.groups;u=new Common.UI.DataViewStore;_.each(e.groups,(function(t,e){var i=t.groupStore.models;if(e>0)for(var n=0;n<i.length;n++)i[n].set({groupName:t.groupName});u.add(i)})),t.store=u,Common.UI.DataViewSimple.prototype.initialize.call(this,t),e.parentMenu.on("show:before",(function(){e.updateRecents()})),e._state.hideLines&&e.hideLinesGroup()},onAfterShowMenu:function(t){var e=this,i=!1;if(e.dataViewItems||(e.dataViewItems=[],_.each(e.cmpEl.find("div.grouped-data"),(function(t,i){_.each($(t).find("div.item"),(function(t,n){var o=$(t),s=e.groups[i].groupStore.at(n);e.dataViewItems.push({el:o,groupIndex:i,index:n});var a=s.get("tip");a&&(o.one("mouseenter",(function(){o.attr("data-toggle","tooltip"),o.tooltip({title:a,placement:"cursor",zIndex:e.tipZIndex}),o.mouseenter()})),o.attr("aria-label",a))}))})),i=!0),e.updateDataViewItems&&e.cmpEl.is(":visible")){for(var n=_.where(e.dataViewItems,{groupIndex:0}),o=n?n.length:0,s=0;s<o;s++){var a=e.dataViewItems[s].el.data("bs.tooltip");a&&(void 0===a.dontShow&&(a.dontShow=!0),a.tip().remove())}e.dataViewItems=e.dataViewItems.slice(o);var r=[];_.each(e.cmpEl.find(".recent-group div.item"),(function(t,i){var n=$(t),o=e.recentShapes[i];r.push({el:n,groupIndex:0,index:i});var s=o.tip;s&&(n.one("mouseenter",(function(){n.attr("data-toggle","tooltip"),n.tooltip({title:s,placement:"cursor",zIndex:e.tipZIndex}),n.mouseenter()})),n.attr("aria-label",s))})),e.dataViewItems=r.concat(e.dataViewItems),1===e.recentShapes.length&&$(".recent-group").show(),e.updateDataViewItems=!1,i=!0}this._state.hideLines&&e.hideLines(),i&&e.hideTextRect(e._state.hideTextRect),e.fillIndexesArray()},onClickItem:function(t){if(!this.disabled){window._event=t;var e=$(t.currentTarget).closest("div.grouped-data").index(),i=$(t.currentTarget).closest("div.item").data("index"),n=_.findIndex(this.dataViewItems,(function(t){return t.groupIndex===e&&t.index===i})),o=n>=0?this.store.at(n):null,s=n>=0?this.dataViewItems[n]:null;if(o&&s){o.set({selected:!0});var a=s.el.data("bs.tooltip");a&&a.tip().remove(),this.isSuspendEvents||this.trigger("item:click",this,s.el,o,t),this.addRecentItem(o)}}},addRecentItem:function(t){for(var e=this,i=!1,n=t.get("data").shapeType,o=t.get("groupName"),s=0;s<e.recentShapes.length;s++)if(e.recentShapes[s].data.shapeType===n){i=!0;break}if(!i){var a=t.toJSON(),r=[{data:a.data,tip:a.tip,allowSelected:a.allowSelected,selected:!1,groupName:o}].concat(e.recentShapes.slice(0,11));Common.localStorage.setItem(this.appPrefix+"recent-shapes",JSON.stringify(r)),e.recentShapes=void 0}},updateRecents:function(){var t=this,e=Common.localStorage.getItem(this.appPrefix+"recent-shapes");e=e?JSON.parse(e):[];var i=!1;if(t.recentShapes)for(var n=0;n<e.length;n++)(!t.recentShapes[n]||t.recentShapes[n]&&e[n].tip!==t.recentShapes[n].tip)&&(i=!0);else i=!0;if(e.length>0&&i){t.recentShapes=e;var o=new Common.UI.DataViewStore;_.each(t.recentShapes,(function(t){var e={data:{shapeType:t.data.shapeType},tip:t.tip,allowSelected:t.allowSelected,selected:t.selected,groupName:t.groupName};o.push(e)})),t.groups[0].groupStore=o;var s=new Common.UI.DataViewStore;_.each(t.groups,(function(t){s.add(t.groupStore.models)})),t.store=s;var a=_.template(["<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div class="item canfocused" role="listitem" <% if (typeof itemTabindex !== undefined) { %> tabindex="<%= itemTabindex %>" <% } %> data-index="<%= index %>"<% if(!!item.tip) { %> data-toggle="tooltip" <% } %> ><%= itemTemplate(item) %></div>',"<% }) %>"].join(""));t.cmpEl&&t.cmpEl.find(".recent-items").html(a({items:t.recentShapes,itemTemplate:this.itemTemplate,style:this.style,itemTabindex:this.itemTabindex||0})),t.updateDataViewItems=!0}},fillIndexesArray:function(){if(!(this.dataViewItems.length<=0)){this._layoutParams={itemsIndexes:[],columns:0,rows:0};for(var t=this.dataViewItems[0].el,e=0;!this.dataViewItems[e].el.is(":visible");){if(e++,!this.dataViewItems[e])return;t=this.dataViewItems[e].el}for(var i=t.outerWidth()+parseInt(t.css("margin-left"))+parseInt(t.css("margin-right")),n=Common.Utils.getOffset(this.$el).left,o=Common.Utils.getOffset(t).top,s=-1,a=0,r=e,l=0;l<this.dataViewItems.length;l++){var c=this.dataViewItems[l];if(c.el.is(":visible")){var h=Common.Utils.getOffset(c.el).top-o;r=Math.floor((Common.Utils.getOffset(c.el).left-n)/i),h>s&&(s=h,this._layoutParams.itemsIndexes.push([]),a=this._layoutParams.itemsIndexes.length-1),this._layoutParams.itemsIndexes[a][r]=l,c.topIdx=a,c.leftIdx=r,this._layoutParams.columns<r&&(this._layoutParams.columns=r)}else c.topIdx=-1,c.leftIdx=-1}this._layoutParams.rows=this._layoutParams.itemsIndexes.length,this._layoutParams.columns++}},hideTextRect:function(t){var e=this;this.dataViewItems&&this.store.each((function(i,n){"textRect"===i.get("data").shapeType&&e.dataViewItems[n]&&e.dataViewItems[n].el&&e.dataViewItems[n].el[t?"addClass":"removeClass"]("hidden")}),this),this._state.hideTextRect=t},hideLinesGroup:function(){$(this.cmpEl.find("div.grouped-data")[9]).hide()},hideLines:function(){var t=this;this.store.each((function(e,i){if("Lines"===e.get("groupName")){var n=t.dataViewItems[i].el;n&&n.is(":visible")&&n.addClass("hidden")}}),this)}}))})),void 0===Common)var Common={};if(define("common/main/lib/component/SynchronizeTip",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.SynchronizeTip=Common.UI.BaseView.extend(_.extend({options:{target:$(document.body),text:"",placement:"right-bottom",showLink:!0,showButton:!1,closable:!0,textHeader:""},template:_.template(['<div class="synch-tip-root <% if (!!scope.options.extCls) {print(scope.options.extCls + " ");} %><%= scope.placement %>" style="<%= scope.style %>">','<div class="asc-synchronizetip">','<div class="tip-arrow <%= scope.placement %>"></div>',"<div>",'<div class="tip-text">','<% if ( scope.textHeader !== "" ) { %>','<label class="tip-header"><%= scope.textHeader %></label><br>',"<% } %>","<%= scope.text %></div>","<% if ( scope.closable ) { %>",'<div class="close"></div>',"<% } %>","</div>","<% if ( scope.showLink ) { %>",'<div class="show-link"><label><%= scope.textLink %></label></div>',"<% } %>","<% if ( scope.showButton ) { %>",'<div class="btn-div"><%= scope.textButton %></div>',"<% } %>","</div>","</div>"].join("")),initialize:function(t){this.textSynchronize+=Common.Utils.String.platformKey("Ctrl+S"),Common.UI.BaseView.prototype.initialize.call(this,t),this.target=this.options.target,this.text=_.isEmpty(this.options.text)?this.textSynchronize:this.options.text,this.textLink=_.isEmpty(this.options.textLink)?this.textDontShow:this.options.textLink,this.placement=this.options.placement,this.showLink=this.options.showLink,this.showButton=this.options.showButton,this.closable=this.options.closable,this.textButton=this.options.textButton||this.textGotIt,this.textHeader=this.options.textHeader||"",this.position=this.options.position,this.offset=this.options.offset,this.style=this.options.style||"",this.automove=this.options.automove,this.binding={}},render:function(){return this.cmpEl||(this.cmpEl=$(this.template({scope:this})),$(document.body).append(this.cmpEl),this.cmpEl.find(".close").on("click",_.bind((function(){this.trigger("closeclick")}),this)),this.cmpEl.find(".show-link label").on("click",_.bind((function(){this.trigger("dontshowclick")}),this)),this.cmpEl.find(".btn-div").on("click",_.bind((function(){this.trigger("buttonclick")}),this)),this.closable&&this.cmpEl.addClass("closable"),this.binding.windowresize=_.bind(this.applyPlacement,this)),this.applyPlacement(),this},show:function(){this.cmpEl?(this.applyPlacement(),this.cmpEl.show()):this.render(),this.automove&&$(window).on("resize",this.binding.windowresize)},hide:function(){this.cmpEl&&this.cmpEl.hide(),this.trigger("hide"),this.automove&&$(window).off("resize",this.binding.windowresize)},close:function(){this.cmpEl&&this.cmpEl.remove(),this.trigger("close"),this.automove&&$(window).off("resize",this.binding.windowresize)},applyPlacement:function(){var t=this.target&&this.target.length>0?this.target:$(document.body),e=Common.Utils.getOffset(t),i=this.offset||{x:0,y:0};if("target"!=this.placement||this.position){if(this.position&&"object"==typeof this.position){var n=this.position.top,o=this.position.left,s=this.position.bottom,a=this.position.right;return void 0!==s||void 0!==n?o=e.left+(t.width()-this.cmpEl.width())/2:n=e.top+(t.height()-this.cmpEl.height())/2,n=void 0!==n?n+"px":"auto",s=void 0!==s?s+"px":"auto",a=void 0!==a?a+"px":"auto",o=void 0!==o?o+"px":"auto",void this.cmpEl.css({top:n,left:o,right:a,bottom:s})}var r=this.placement.split("-");if(r.length>0){var l=r[0];if("top"==l?s=Common.Utils.innerHeight()-e.top+i.y:"bottom"==l?n=e.top+t.height()+i.y:"left"==l?a=Common.Utils.innerWidth()-e.left+i.x:"right"==l&&(o=e.left+t.width()+i.x),"top"==(l=r[1]))s=Common.Utils.innerHeight()-e.top-t.height()/2+i.y;else if("bottom"==l){n=e.top+t.height()/2+i.y;var c=this.cmpEl.height();n+c>Common.Utils.innerHeight()&&(n=Common.Utils.innerHeight()-c-10)}else"left"==l?a=Common.Utils.innerWidth()-e.left-t.width()/2+i.x:"right"==l?o=e.left+t.width()/2+i.x:void 0!==s||void 0!==n?o=e.left+(t.width()-this.cmpEl.width())/2+i.x:n=e.top+(t.height()-this.cmpEl.height())/2+i.y;if(n=void 0!==n?n+"px":"auto",s=void 0!==s?s+"px":"auto",a=void 0!==a?a+"px":"auto",void 0!==o){var h=this.cmpEl.width();o+h>Common.Utils.innerWidth()&&(o=Common.Utils.innerWidth()-h-10),o+="px"}else o="auto";this.cmpEl.css({top:n,left:o,right:a,bottom:s})}}else this.cmpEl.css({top:e.top+5+i.y+"px",left:e.left+5+i.x+"px"})},isVisible:function(){return this.cmpEl&&this.cmpEl.is(":visible")},setText:function(t){this.text!==t&&(this.text=t,this.cmpEl.find(".tip-text").text(t))},textDontShow:"Don't show this message again",textSynchronize:"The document has been changed by another user.<br>Please click to save your changes and reload the updates.",textGotIt:"Got it"},Common.UI.SynchronizeTip||{})),Common.UI.TooltipManager=new function(){var t={},e={},i=function(e){return t[e]&&!(t[e].name&&Common.localStorage.getItem(t[e].name))},n=function(o){if("object"==typeof o&&o.step&&(t[o.step]?t[o.step].text=o.text:t[o.step]=o,o=o.step),t[o]){if(i(o)&&(!t[o].prev||!i(t[o].prev))){var s=t[o],a=s.target,r=function(t){if("string"==typeof t){e[t]||(e[t]=[]);for(let i=e[t].length-1;i>=0;i--){if(e[t][i])return e[t][i];e[t].pop()}return $(t)}return t}(a);if(s.tip&&s.tip.isVisible())return!0;if(!(r&&r.length&&r.is(":visible")))return!1;var l=s.placement||"bottom";Common.UI.isRTL()&&(l=l.indexOf("right")>-1?l.replace("right","left"):l.replace("left","right")),!s.noHighlight&&r.addClass("highlight-tip"),s.isNewFeature&&(s.header="<span>"+(Common.UI.SynchronizeTip.prototype.textNew||"New")+"</span>"+s.header),s.tip=new Common.UI.SynchronizeTip({extCls:"colored"+(s.extCls?" "+s.extCls:"")+(s.noHighlight?" no-arrow":""),style:"min-width:200px;max-width:"+(s.maxwidth?s.maxwidth+("number"==typeof s.maxwidth?"px;":";"):"250px;"),placement:l,position:s.position,offset:s.offset,target:r,text:s.text,textHeader:s.header,showLink:!!s.link,textLink:s.link?s.link.text:"",closable:!1!==s.closable,showButton:!1!==s.showButton,automove:!!s.automove}),s.tip.on({buttonclick:function(){s.tip&&s.tip.close(),s.tip=void 0},closeclick:function(){s.tip&&s.tip.close(),s.tip=void 0},dontshowclick:function(){s.link.url?window.open(s.link.url,"_blank"):Common.NotificationCenter.trigger("file:help",s.link.src)},close:function(){r.removeClass("highlight-tip"),s.name&&Common.localStorage.setItem(s.name,1),s.callback&&s.callback(),s.next&&n(s.next),!s.multiple&&delete t[o],"string"==typeof a&&s.stackIdx&&(e[a][s.stackIdx-1]=void 0,s.stackIdx=void 0)}}),s.tip.show(),"string"==typeof a&&(e[a].push(s.tip.cmpEl),s.stackIdx=e[a].length)}return!0}};return{showTip:n,closeTip:function(e,i,n){var o=t[e];o&&(n&&(o.next=void 0),o.tip&&o.tip.close(),o.tip=void 0,i&&o.name&&Common.localStorage.setItem(o.name,1))},removeTip:function(e){t[e]&&(delete t[e],t[e]=void 0)},addTips:function(e){for(var i in e)!e.hasOwnProperty(i)||Common.localStorage.getItem(e[i].name)||t[i]&&t[i].tip&&t[i].tip.isVisible()||(t[i]=e[i])},getNeedShow:i}}})),function(t){"use strict";t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",(function(){i=!0}));return setTimeout((function(){i||t(n).trigger(t.support.transition.end)}),e),this},t((function(){t.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})}))}(jQuery),define("common/main/lib/mods/transition",(function(){})),define("common/main/lib/component/Mixtbar",["backbone","common/main/lib/component/BaseView","common/main/lib/mods/transition"],(function(t){"use strict";Common.UI.Mixtbar=Common.UI.BaseView.extend(function(){var t,e,i,n={timeout:2e3},o={},s=[];function a(){var n=t.scrollLeft();(Common.UI.isRTL()?i:e).toggleClass("disabled",Math.abs(Math.floor(n))<=(Common.UI.isRTL()?1:0)),(Common.UI.isRTL()?e:i).toggleClass("disabled",Math.abs(Math.ceil(n))>=t[0].scrollWidth-t[0].clientWidth-(Common.UI.isRTL()?1:0))}var r=function(e,i){if(!$(i.target).hasClass("disabled")){var n=t.scrollLeft();(n||"right"==e||Common.UI.isRTL()&&"left"==e)&&t.animate({scrollLeft:"left"==e?n-100:n+100},200,a)}},l=function(e){e.preventDefault();var i=e.deltaX||e.detail||e.deltaY;t.scrollLeft(t.scrollLeft()+60*i),a()};function c(t){var e=$(t.currentTarget).find("> a[data-tab]").data("tab");this.dblclick_el==e&&(this.fireEvent("change:compact",[e]),this.dblclick_el=void 0)}function h(t){this.isFolded&&($(t.target).parents(".toolbar, #file-menu-panel").length||n.$bar&&n.$bar.hasClass("expanded")&&this.collapse())}return{$tabs:void 0,$panels:void 0,isFolded:!1,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=Common.UI.isRTL()?'<section class="tabs"><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a><ul role="tablist"><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a role="tab" id="<%= items[i].action %>" data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a></section>':'<section class="tabs"><a class="scroll left" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="V"></a><ul role="tablist"><% for(var i in items) { %><% if (typeof items[i] == "object") { %><li class="ribtab<% if (items[i].haspanel===false) print(" x-lone") %><% if (items[i].extcls) print(\' \' + items[i].extcls) %>"<% if (typeof items[i].layoutname == "string") print(" data-layout-name=" + \' \' +  items[i].layoutname) + \' \' %>><a role="tab" id="<%= items[i].action %>" data-tab="<%= items[i].action %>" data-title="<%= items[i].caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof items[i].dataHintTitle !== "undefined") { %> data-hint-title="<%= items[i].dataHintTitle %>" <% } %>><%= items[i].caption %></a></li><% } %><% } %></ul><a class="scroll right" data-hint="0" data-hint-direction="bottom" data-hint-offset="-7, 0" data-hint-title="R"></a></section>';this.$layout=$(t.template({tabsmarkup:_.template(e)({items:t.tabs}),isRTL:Common.UI.isRTL(),config:t.config})),o.tabs=t.tabs,$(document.body).on("click",h.bind(this)),Common.NotificationCenter.on("tab:visible",_.bind((function(t,e){this.setVisible(t,e)}),this)),Common.NotificationCenter.on("tab:resize",_.bind(this.onResizeTabs,this)),Common.NotificationCenter.on("app:repaint",_.bind((function(){this.repaintMoreBtns()}),this)),Common.NotificationCenter.on("uitheme:changed",_.bind((function(){this.clearActiveData(),this.processPanelVisible()}),this))},afterRender:function(){var o=this;t=o.$(".tabs > ul"),o.$tabs=t.find("> li"),o.$boxpanels=o.$(".box-panels"),o.$panels=o.$boxpanels.find("> .panel"),n.$bar=o.$(".toolbar"),i=o.$(".tabs .scroll.right"),(e=o.$(".tabs .scroll.left")).on("click",r.bind(this,"left")),i.on("click",r.bind(this,"right")),t.on("dblclick","> .ribtab",c.bind(this)),t.on("click","> .ribtab",o.onTabClick.bind(this)),t.on("mousewheel",l)},isTabActive:function(t){var e=this.$tabs.filter(".active").find("> a");return e.length&&e.data("tab")==t},setFolded:function(t){this.isFolded=t;var e=this;if(this.isFolded)n.$box||(n.$box=e.$el.find(".box-controls")),n.$bar.addClass("folded z-clear").toggleClass("expanded",!1),n.$bar.find(".tabs .ribtab").removeClass("active"),n.$bar.on($.support.transition.end,(function(t){n.$bar.hasClass("folded")&&!n.$bar.hasClass("expanded")&&n.$bar.toggleClass("z-clear",!0)})),n.$box.on({mouseleave:function(t){},mouseenter:function(t){}});else{n.$bar.removeClass("folded z-clear"),n.$box.off();var i=n.$box.find(".panel.active");if(i.length){var o=i.data("tab");e.$tabs.find("> a[data-tab="+o+"]").parent().toggleClass("active",!0)}else o=e.$tabs.siblings(":not(.x-lone):visible").first().find("> a[data-tab]").data("tab"),e.setTab(o)}},collapse:function(){Common.UI.Menu.Manager.hideAll(),this.isFolded&&n.$bar&&(n.$bar.removeClass("expanded"),n.$bar.find(".tabs .ribtab").removeClass("active")),this.fireEvent("tab:collapse")},expand:function(){n.$bar.removeClass("z-clear"),n.$bar.addClass("expanded")},onResizeTabs:function(e){this.hasTabInvisible()?t.parent().hasClass("short")||(t.parent().addClass("short"),a()):t.parent().hasClass("short")&&t.parent().removeClass("short")},onResize:function(t){this.onResizeTabs(),this.hideMoreBtns(),this.processPanelVisible()},onTabClick:function(t){var e=this,i=$(t.currentTarget),n=i.find("> a[data-tab]").data("tab");i.hasClass("x-lone")?e.isFolded&&e.collapse():i.hasClass("active")?e._timerSetTab||(e.dblclick_el=n,e.isFolded&&(e.collapse(),setTimeout((function(){e.dblclick_el=void 0}),500))):(e._timerSetTab=!0,setTimeout((function(){e._timerSetTab=!1}),500),e.setTab(n),e.fireEvent("tab:click",[n]),e.isFolded?e.dblclick_el=n:(e.dblclick_timer&&clearTimeout(e.dblclick_timer),e.dblclick_timer=setTimeout((function(){e.dblclick_el=n,delete e.dblclick_timer}),500)))},setTab:function(t){var e=this;if(t||(this.isFolded?this.collapse():t=this.lastPanel),t){this.fireEvent("tab:active:before",[t]),e.$tabs.removeClass("active"),e.$panels.removeClass("active"),e.hideMoreBtns();var i=this.$panels.filter("[data-tab="+t+"]");i.length&&(this.lastPanel=t,i.addClass("active"),e.setMoreButton(t,i),e.processPanelVisible(null,!0)),i.length?e.isFolded&&e.expand():e.isFolded&&e.collapse();var n=this.$tabs.find("> a[data-tab="+t+"]").parent();n.length&&n.addClass("active"),this.fireEvent("tab:active",[t]),Common.NotificationCenter.trigger("tab:active",[t])}},addTab:function(e,i,n){var s=_.template('<li class="ribtab" style="display: none;" <% if (typeof layoutname == "string") print(" data-layout-name=" + \' \' +  layoutname) + \' \' %>><a role="tab" id="<%= action %>" data-tab="<%= action %>" data-title="<%= caption %>" data-hint="0" data-hint-direction="bottom" data-hint-offset="small" <% if (typeof dataHintTitle !== "undefined") { %> data-hint-title="<%= dataHintTitle %>" <% } %> ><%= caption %></a></li>');o.tabs[n+1]=e;var a=function t(e){return o.tabs[e]?o.tabs[e].action:t(--e)}(n),r=this.$tabs||this.$layout.find(".tabs"),l=r.find("a[data-tab="+a+"]");l.length&&(l.parent().after(s(e)),i&&((l=(r=this.$panels||this.$layout.find(".box-panels > .panel")).filter("[data-tab="+a+"]")).length?l.after(i):i.appendTo(this.$layout.find(".box-panels"))),this.$tabs&&(this.$tabs=t.find("> li")),this.$panels&&(this.$panels=this.$el.find(".box-panels > .panel")))},getTab:function(t){if(t&&this.$panels){var e=this.$panels.filter("[data-tab="+t+"]");return e.length?e:void 0}},createTab:function(t,e){if(t.action&&t.caption){var i=$('<section id="'+t.action+'" class="panel" data-tab="'+t.action+'"></section>');return this.addTab(t,i,this.getLastTabIdx()),this.setVisible(t.action,!!e),i}},getMorePanel:function(t){return t&&s[t]?s[t].panel:null},getLastTabIdx:function(){return o.tabs.length},isCompact:function(){return this.isFolded},isExpanded:function(){return!this.isFolded||n.$bar&&n.$bar.hasClass("expanded")},hasTabInvisible:function(){if(t.length<1)return!1;var e=Math.round(Common.Utils.getOffset(t).left),i=Math.round(e+t.width()),n=this.$tabs.filter(Common.UI.isRTL()?":visible:last":":visible:first").get(0);if(!n)return!1;var o=Common.Utils.getBoundingClientRect(n);return Math.round(o.left)<e||(n=this.$tabs.filter(Common.UI.isRTL()?":visible:first":":visible:last").get(0),o=Common.Utils.getBoundingClientRect(n),Math.round(o.right)>i)},processPanelVisible:function(t,e){var i=this;function n(){var n=t||i.$panels.filter(".active");if(n&&n.length){var o=n.parents(".box-controls").width(),a=n.parents(".box-controls").find(".panel.static").outerWidth();a||(a=0);var r=n.data(),l=r.rightedge,c=r.buttons,h=r.flex,d=n.find(".more-box");if(0===d.length&&i.setMoreButton(n.attr("data-tab"),n),l||(l=n.outerWidth()+a),c||(c=[],_.each(n.find(".btn-slot .x-huge"),(function(t){c.push($(t).closest(".btn-slot"))})),s[r.tab]&&s[r.tab].panel&&_.each(s[r.tab].panel.find(".btn-slot .x-huge"),(function(t){c.push($(t).closest(".btn-slot"))})),r.buttons=c),h||(h=[],_.each(n.find(".group.flex"),(function(t){var e=$(t);h.push({el:e,width:e.attr("data-group-width")||e.attr("max-width")})})),r.flex=h),l>o){if(!d.is(":visible")){if(h.length>0)for(var u=0;u<h.length;u++){var m=h[u].el;if(l=n.outerWidth()+a,Math.floor(m.outerWidth())>parseInt(m.css("min-width")))return void(r.rightedge=l);m.css("width",m.css("min-width"))}for(u=c.length-1;u>=0;u--){if(!(p=c[u]).hasClass("compactwidth")&&!p.hasClass("slot-btn-more")&&(p.addClass("compactwidth"),(l=n.outerWidth()+a)<=o))break}r.rightedge=l}i.resizeToolbar(e)}else if(d.is(":visible")&&i.resizeToolbar(e),!d.is(":visible")){for(u=0;u<c.length;u++){var p;if((p=c[u]).hasClass("compactwidth")&&(p.removeClass("compactwidth"),(l=n.outerWidth()+a)>o)){p.addClass("compactwidth"),l=n.outerWidth()+a;break}}if(r.rightedge=l,h.length>0&&n.find(".btn-slot.compactwidth").length<1)for(u=0;u<h.length;u++){var f;(m=h[u]).el.find(".combo-dataview").hasClass("auto-width")&&(f=Common.UI.ComboDataView.prototype.checkAutoWidth(m.el,i.$boxpanels.width()-n.outerWidth()+m.el.width())),m.el.css("width",f?f+parseFloat(m.el.css("padding-left"))+parseFloat(m.el.css("padding-right"))+"px":m.width),r.rightedge=Common.Utils.getBoundingClientRect(n.get(0)).right}}}}i._timer_id?i._needProcessPanel=!0:(n(),i._needProcessPanel=!1,i._timer_id=setInterval((function(){i._needProcessPanel?(n(),i._needProcessPanel=!1):(clearInterval(i._timer_id),delete i._timer_id)}),100))},setExtra:function(t,e){e&&(this.$tabs||("right"==t?this.$layout.find(".extra.right").html(e):"left"==t&&this.$layout.find(".extra.left").html(e)))},setVisible:function(t,e){t&&this.$tabs&&(this.$tabs.find("> a[data-tab="+t+"]").parent().css("display",e?"":"none"),this.onResize())},setMoreButton:function(t,e){var i=this;if(!s[t]){var o=Common.Utils.getPosition(e).top,a=$('<div class="more-box" style="top:'+o+'px;"><div class="separator long" style="position: relative;display: table-cell;"></div><div class="group" style=""><span class="btn-slot text x-huge slot-btn-more"></span></div></div>');e.append(a),s[t]=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top dropdown-manual",caption:Common.Locale.get("textMoreButton",{name:"Common.Translation",default:"More"}),iconCls:"toolbar__icon btn-big-more",enableToggle:!0}),s[t].render(a.find(".slot-btn-more")),s[t].on("toggle",(function(t,e,n){e?i.onMoreShow(t,n):i.onMoreHide(t,n),Common.NotificationCenter.trigger("more:toggle",t,e)}));var r=$('<div class="dropdown-menu more-container" data-tab="'+t+'"><div style="display: inline;"></div></div>');n.$bar.append(r),s[t].panel=r.find("div")}this.$moreBar=s[t].panel},repaintMoreBtns:function(){for(var t in s)if(s[t]&&s[t].cmpEl){var e=s[t].cmpEl.closest(".more-box");e.css("top",Common.Utils.getPosition(e.parent()).top)}},clearMoreButton:function(t){var e=this.$panels.filter("[data-tab="+t+"]");if(e.length){var i=e.data();i.buttons=i.flex=i.rightedge=i.leftedge=void 0,e.find(".more-box").remove()}s[t]&&(n.$bar.find('.more-container[data-tab="'+t+'"]').remove(),s[t].remove(),delete s[t])},clearActiveData:function(t){var e=t?this.$panels.filter("[data-tab="+t+"]"):this.$panels.filter(".active");if(e.length){var i=e.data();i.buttons=i.flex=i.rightedge=i.leftedge=void 0}},addCustomControls:function(t,e,i){if(t.action){var n=t.action?this.getTab(t.action)||this.createTab(t,!0)||this.getTab("plugins"):null,o=this.getMorePanel(t.action),a=n?n.find(".more-box"):null,r="";a.length<1&&(a=null),n&&(i&&(i.forEach((function(e,i){if(e.cmpEl){var n=e.cmpEl.closest(".group");if(e.cmpEl.closest(".btn-slot").remove(),n.children().length<1){var r=n.closest(".more-container").length>0;r?n.next(".separator").remove():n.prev(".separator").remove(),n.remove(),r&&0===o.children().filter(".group").length&&(s[t.action]&&s[t.action].isActive()&&s[t.action].toggle(!1),a&&a.css("display","none"))}}})),n.find(".btn-slot:not(.slot-btn-more).x-huge").last().hasClass("compactwidth")&&(r="compactwidth")),e&&e.forEach((function(t,e){var i,s;if(o&&(i=o.children().filter(".group")).length>0&&(a=null,n=o,r="compactwidth"),(!i||i.length<1)&&(i=n.children().filter(".group")),i.length>0&&!t.options.separator&&e>0)s=$(i[i.length-1]);else{if(t.options.separator){var l=$('<div class="separator long"></div>');a?a.before(l):l.appendTo(n)}s=$('<div class="group"></div>'),a?a.before(s):s.appendTo(n)}var c=$('<span class="btn-slot text x-huge '+((t.options.caption||"").trim()?" ":"nocaption ")+r+'"></span>').appendTo(s);t.render(c)}))),this.clearActiveData(t.action),this.processPanelVisible(null,!0);var l=!this.isTabEmpty(t.action)&&Common.UI.LayoutManager.isElementVisible("toolbar-"+t.action);this.setVisible(t.action,l),!l&&this.isTabActive(t.action)&&this.isExpanded()&&(this.getTab("home")?this.setTab("home"):(t=this.$tabs.siblings(":not(.x-lone):visible").first().find("> a[data-tab]").data("tab"),this.setTab(t)))}},isTabEmpty:function(t){var e=this.getTab(t),i=this.getMorePanel(t),n=e?e.find(".more-box"):null;return n.length<1&&(n=null),!!e&&!(e.find("> .group").length>0||i&&i.find(".group").length>0)},resizeToolbar:function(t){var e=this.$panels.filter(".active"),i=e.find(".more-box");0===i.length&&this.setMoreButton(e.attr("data-tab"),e);var n=parseInt(i.css("width"))||0,o=e.parents(".box-controls").width(),s=e.parents(".box-controls").find(".panel.static").outerWidth(),a=o;s||(s=0);var r=e.outerWidth()+s,l=this._prevBoxWidth?a-this._prevBoxWidth:-1,c=!1;if(this._prevBoxWidth=a,i.is(":visible")&&(a-=n),this.$moreBar&&this.$moreBar.parent().is(":visible")&&this.$moreBar.parent().css("max-width",Common.Utils.innerWidth()),(t||l<0)&&r>a){i.is(":visible")||(i.css("display","block"),a-=parseInt(i.css("width")));var h=null,d=null;(x=this.$moreBar.children().filter("[data-hidden-tb-item!=true]")).length>0&&((x=$(x[0])).hasClass("separator")&&(h=x),x.hasClass("group")&&"open"==x.attr("group-state")&&(d=x));for(var u=!1,m=(_=e.find("> div:not(.more-box)")).length-1;m>=0;m--){if((I=$(_[m])).is(":visible")||I.attr("hidden-on-resize"))if(I.hasClass("group")){if((r=e.outerWidth()+s)<=a)break;var p=Common.Utils.getBoundingClientRect(I.get(0)),f=I.outerWidth(),g=I.children();if(!I.attr("inner-width")&&"open"!==I.attr("group-state")){I.attr("inner-width",f);for(var b=g.length-1;b>=0;b--){(E=$(g[b])).attr("inner-width",E.outerWidth())}}if((p.left>a||Common.UI.isRTL()&&o-p.right>a||1==g.length)&&"open"!=I.attr("group-state"))this.$moreBar.prepend(I),h&&(h.css("display",""),h.removeAttr("hidden-on-resize")),c=!0;else{if(!((Common.UI.isRTL()?o-p.right:p.left)+f>a))break;for(b=g.length-1;b>=0;b--){if((E=$(g[b])).hasClass("elset")){this.$moreBar.prepend(I),h&&(h.css("display",""),h.removeAttr("hidden-on-resize")),c=!0;break}var v=Common.Utils.getBoundingClientRect(E.get(0)),C=E.outerWidth();if(!((Common.UI.isRTL()?o-v.right:v.left)+C>a)){u=!0;break}if(!d){(d=$("<div></div>")).addClass(_[m].className);for(var w=_[m].attributes,y=0;y<w.length;y++)d.attr(w[y].name,w[y].value);this.$moreBar.prepend(d),h&&(h.css("display",""),h.removeAttr("hidden-on-resize"))}d.prepend(E),c=!0}if(I.children().length<1?(I.remove(),d&&d.removeAttr("group-state").attr("inner-width",I.attr("inner-width")),d=null):d&&d.attr("group-state","open")&&I.attr("group-state","open"),u)break}h=null}else I.hasClass("separator")&&(this.$moreBar.prepend(I),I.css("display","none"),I.attr("hidden-on-resize",!0),h=I,c=!0);else I.attr("data-hidden-tb-item",!0),this.$moreBar.prepend(I),c=!0}}else if((t||l>0)&&i.is(":visible")){h=null,d=null;var x,_,k=0;if((x=e.find("> div:not(.more-box)")).length>0&&((x=$(x[x.length-1])).hasClass("separator")&&(h=x,k=parseInt(h.css("margin-left"))+parseInt(h.css("margin-right"))+1),x.hasClass("group")&&"open"==x.attr("group-state")&&(d=x)),(_=this.$moreBar.children()).length>0)for(m=0;m<_.length;m++){var I=$(_[m]);if(r=e.outerWidth()+s,!I.is(":visible")&&I.attr("data-hidden-tb-item"))I.removeAttr("data-hidden-tb-item"),i.before(I),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"));else if(I.hasClass("group")){var S=!1;if(1==this.$moreBar.children().filter(".group").length&&(a=o,S=!0),r+k+(f=parseInt(I.attr("inner-width")||0))<a&&"open"!=I.attr("group-state"))i.before(I),h&&(h.css("display",""),h.removeAttr("hidden-on-resize")),0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none")),c=!0;else{if(!(r+k<a))break;g=I.children();a=o-n;for(b=0;b<g.length;b++){var E;if(S&&b==g.length-1&&(a=o),r=e.outerWidth()+s,(E=$(g[b])).hasClass("elset")){u=!0;break}if(!(r+k+(C=parseInt(E.attr("inner-width")||0)+(d?0:parseInt(I.css("padding-left"))))<a)){u=!0;break}if(!d){(d=$("<div></div>")).addClass(_[m].className);for(w=_[m].attributes,y=0;y<w.length;y++)d.attr(w[y].name,w[y].value);d.hasClass("flex")&&(e.data().flex=null),i.before(d),h&&(h.css("display",""),h.removeAttr("hidden-on-resize"))}d.append(E),c=!0}if(I.children().length<1?(I.remove(),d&&d.removeAttr("group-state").attr("inner-width",I.attr("inner-width")),d=null,0==this.$moreBar.children().filter(".group").length&&(this.hideMoreBtns(),i.css("display","none"))):d&&d.attr("group-state","open")&&I.attr("group-state","open"),u)break}h=null,k=0}else I.hasClass("separator")&&(i.before(I),I.css("display","none"),I.attr("hidden-on-resize",!0),h=I,k=parseInt(h.css("margin-left"))+parseInt(h.css("margin-right"))+1,c=!0)}else this.hideMoreBtns(),i.css("display","none")}c&&Common.UI.Menu.Manager.hideAll()},onMoreHide:function(t,e){var i=t.panel.parent();t.pressed&&t.toggle(!1,!0),i.is(":visible")&&(i.hide(),Common.NotificationCenter.trigger("edit:complete",this.toolbar,t))},onMoreShow:function(t,e){var i=t.panel.parent(),n=Common.Utils.getOffset(i.parent()),o=t.$el,s=Common.Utils.getOffset(o),a=Common.Utils.innerWidth()-(s.left-n.left+o.width()),r=s.top-n.top+o.height()+10,l=Common.UI.isRTL()?{left:"6px",right:"auto",top:r,"max-width":Common.Utils.innerWidth()+"px"}:{right:a,left:"auto",top:r,"max-width":Common.Utils.innerWidth()+"px"};i.css(l),i.show()},hideMoreBtns:function(){for(var t in s)s[t]&&s[t].isActive()&&s[t].toggle(!1)}}}())})),void 0===Common)var Common={};define("visioeditor/main/app/view/Toolbar",["jquery","underscore","backbone","text!visioeditor/main/app/template/Toolbar.template","text!visioeditor/main/app/template/ToolbarView.template","common/main/lib/component/Button","common/main/lib/component/ComboBox","common/main/lib/component/DataView","common/main/lib/component/Menu","common/main/lib/component/Window","common/main/lib/component/SynchronizeTip","common/main/lib/component/Mixtbar"],(function(t,e,i,n,o){"use strict";Common.enumLock||(Common.enumLock={});var s={cantPrint:"cant-print",lostConnect:"disconnect",disableOnStart:"on-start",fileMenuOpened:"file-menu-opened"};for(var a in s)s.hasOwnProperty(a)&&(Common.enumLock[a]=s[a]);VE.Views.Toolbar=Common.UI.Mixtbar.extend(e.extend({el:"#toolbar",events:{},initialize:function(){return this._state={},Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),this},applyLayoutEdit:function(t){if(t.isEdit){Common.enumLock;var e=[];return Common.UI.LayoutManager.addControls(e),e}},applyLayout:function(t){return this.lockControls=[],Common.enumLock,t.isEdit||Common.UI.Mixtbar.prototype.initialize.call(this,{template:e.template(o),tabs:[{caption:this.textTabFile,action:"file",layoutname:"toolbar-file",haspanel:!1,dataHintTitle:"F"}]}),this},render:function(t){var e=this;return this.fireEvent("render:before",[this]),e.isCompactView=t.compactview,t.isEdit||(e.$layout.find(".canedit").hide(),e.$layout.addClass("folded"),e.$el.html(e.$layout)),this.fireEvent("render:after",[this]),Common.UI.Mixtbar.prototype.afterRender.call(this),Common.NotificationCenter.on({"window:resize":function(){Common.UI.Mixtbar.prototype.onResize.apply(e,arguments)}}),t.isEdit,e.isCompactView&&e.setFolded(!0),this},onTabClick:function(e){var i=this,n=t(e.currentTarget).find("> a[data-tab]").data("tab"),o=i.isTabActive("file");i._isDocReady&&("file"!==n||Common.Controllers.LaunchController.isScriptLoaded())&&(Common.UI.Mixtbar.prototype.onTabClick.apply(i,arguments),o?i.fireEvent("file:close"):"file"==n&&(i.fireEvent("file:open"),i.setTab(n)))},rendererComponentsEdit:function(t,e){},rendererComponentsCommon:function(t){},rendererComponents:function(e,i){var n=t(e);return this.rendererComponentsCommon(n),i.isEdit&&this.rendererComponentsEdit(n,i),n},onAppReady:function(t){this._isDocReady=!0,new Promise((function(t,e){t()})).then((function(){}))},createDelayedElementsCommon:function(){},createDelayedElementsEdit:function(){this.mode.isEdit},createDelayedElements:function(){this.createDelayedElementsCommon(),this.mode.isEdit&&this.createDelayedElementsEdit()},onToolbarAfterRender:function(t){},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onAuthParticipantsChanged",e.bind(this.onApiUsersChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",e.bind(this.onApiUsersChanged,this)),this},setMode:function(t){t.isDisconnected?(this.lockToolbar(Common.enumLock.lostConnect,!0),t.enableDownload||this.toolbar.fireEvent("print:disabled",[!0])):this.toolbar.fireEvent("print:disabled",[!t.canPrint]),this.mode=t},onApiUsersChanged:function(t){},onDesktopWindow:function(){},lockToolbar:function(t,e,i){Common.Utils.lockControls(t,e,i,this.lockControls)}},VE.Views.Toolbar||{}))})),define("visioeditor/main/app/controller/Toolbar",["core","common/main/lib/component/Window","visioeditor/main/app/view/Toolbar"],(function(){"use strict";VE.Controllers.Toolbar=Backbone.Controller.extend(_.extend({models:[],collections:[],controllers:[],views:["Toolbar"],initialize:function(){this._state={activated:!1,initEditing:!0},this.editMode=!0,this.binding={},this.addListeners({Toolbar:{"change:compact":this.onClickChangeCompact,"tab:collapse":this.onTabCollapse},FileMenu:{"menu:hide":this.onFileMenu.bind(this,"hide"),"menu:show":this.onFileMenu.bind(this,"show")},"Common.Views.Header":{print:function(t){this.getApplication().getController("Main").onPrint()},"print-quick":function(t){this.getApplication().getController("Main").onPrintQuick()},downloadas:function(t){var e,i=this.getApplication().getController("Main"),n=i.document.fileType;n&&(e=Asc.c_oAscFileType[n.toUpperCase()]);var o=[Asc.c_oAscFileType.VSDX,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.PNG,Asc.c_oAscFileType.JPG];(!e||o.indexOf(e)<0)&&(e=Asc.c_oAscFileType.PDF),i.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(e))},"go:editor":function(){}},ViewTab:{"toolbar:setcompact":this.onChangeCompactView.bind(this)}}),Common.NotificationCenter.on("toolbar:collapse",_.bind((function(){this.toolbar.collapse()}),this)),Common.NotificationCenter.on("tab:set-active",_.bind((function(t){this.toolbar.setTab(t),this.onChangeCompactView(null,!1,!0)}),this))},onLaunch:function(){this.toolbar=this.createView("Toolbar"),this.toolbar.on("render:before",(function(t){})),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this))},setMode:function(t){var e=this.getApplication().getController("Main");this.mode=t,this.toolbar.applyLayout(t),Common.UI.TooltipManager.addTips({refreshFile:{text:e.textUpdateVersion,header:e.textUpdating,target:"#toolbar",maxwidth:"none",showButton:!1,automove:!0,noHighlight:!0,multiple:!0},disconnect:{text:e.textConnectionLost,header:e.textDisconnect,target:"#toolbar",maxwidth:"none",showButton:!1,automove:!0,noHighlight:!0,multiple:!0},updateVersion:{text:e.errorUpdateVersionOnDisconnect,header:e.titleUpdateVersion,target:"#toolbar",maxwidth:600,showButton:!1,automove:!0,noHighlight:!0,multiple:!0},sessionIdle:{text:e.errorSessionIdle,target:"#toolbar",maxwidth:600,showButton:!1,automove:!0,noHighlight:!0,multiple:!0},sessionToken:{text:e.errorSessionToken,target:"#toolbar",maxwidth:600,showButton:!1,automove:!0,noHighlight:!0,multiple:!0}})},attachCommonUIEvents:function(t){},attachEditUIEvents:function(t){this.mode&&this.mode.isEdit},attachUIEvents:function(t){this.attachCommonUIEvents(t),this.mode.isEdit&&this.attachEditUIEvents(t)},attachCommonApiEvents:function(){this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("onPluginToolbarMenu",_.bind(this.onPluginToolbarMenu,this)),this.api.asc_registerCallback("onPluginToolbarCustomMenuItems",_.bind(this.onPluginToolbarCustomMenuItems,this)),this.api.asc_registerCallback("onPluginUpdateToolbarMenu",_.bind(this.onPluginUpdateToolbarMenu,this)),Common.NotificationCenter.on("document:ready",_.bind(this.onDocumentReady,this))},attachEditApiEvents:function(){this.mode.isEdit},setApi:function(t){this.api=t,this.attachCommonApiEvents(),this.mode.isEdit&&this.attachEditApiEvents()},onChangeCompactView:function(t,e,i){this.toolbar.setFolded(e),this.toolbar.fireEvent("view:compact",[this,e]),e&&this.onTabCollapse(),!i&&Common.localStorage.setBool(this.mode.isEdit?"ve-compact-toolbar":"ve-view-compact-toolbar",e),Common.NotificationCenter.trigger("layout:changed","toolbar"),Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onClickChangeCompact:function(t){if("file"!=t){var e=this;setTimeout((function(){e.onChangeCompactView(null,!e.toolbar.isCompact())}),0)}},onNewDocument:function(t,e){this.api&&this.api.OpenNewDocument(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","New Document")},onOpenDocument:function(t,e){this.api&&this.api.LoadDocumentFromDisk(),Common.NotificationCenter.trigger("edit:complete",this.toolbar),Common.component.Analytics.trackEvent("ToolBar","Open Document")},onDownloadUrl:function(t,e){if(this._state.isFromToolbarDownloadAs){var i=this,n=this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption();!n&&(n=i.txtUntitled),i.toolbar.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.toolbar.mode.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",(function(t,e){Common.UI.warning({closable:!1,msg:e,callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}})})).on("close",(function(t){i._saveCopyDlg=void 0})),i._saveCopyDlg.show())}this._state.isFromToolbarDownloadAs=!1},activateControls:function(){this.toolbar.lockToolbar(Common.enumLock.disableOnStart,!1),this._state.activated=!0},onHideMenus:function(t){Common.NotificationCenter.trigger("edit:complete",this.toolbar)},onApiCoAuthoringDisconnect:function(t){this.mode.isEdit&&this.toolbar.setMode({isDisconnected:!0,enableDownload:!!t}),this.editMode=!1,this.DisableToolbar(!0,!0)},DisableToolbar:function(t,e){void 0!==e&&(this.editMode=!e),t=t||!this.editMode;var i=$(".toolbar-mask");if(!(t&&i.length>0||!t&&0==i.length)){var n=this.toolbar;n.hideMoreBtns(),n.$el.find(".toolbar").toggleClass("masked",t),t?i=$("<div class='toolbar-mask'>").appendTo(n.$el.find(".toolbar")):i.remove()}},createDelayedElements:function(){this.toolbar.createDelayedElements(),this.attachUIEvents(this.toolbar),Common.Utils.injectSvgIcons()},onAppShowed:function(t){var e=this,i=t.isEdit,n=!i;Common.localStorage.itemExists(i?"ve-compact-toolbar":"ve-view-compact-toolbar")?n=Common.localStorage.getBool(i?"ve-compact-toolbar":"ve-view-compact-toolbar"):t.customization&&(n=i?!!t.customization.compactToolbar:!1!==t.customization.compactToolbar),Common.Utils.InternalSettings.set("toolbar-active-tab",!i&&!n),e.toolbar.render(_.extend({compactview:!i||n},t)),t.isEdit&&(e.toolbar.setMode(t),t.compactHeader||e.toolbar.processPanelVisible(null,!0));var o={caption:e.toolbar.textTabView,action:"view",extcls:t.isEdit?"canedit":"",layoutname:"toolbar-view",dataHintTitle:"W"},s=e.getApplication().getController("ViewTab");s.setApi(e.api).setConfig({toolbar:e,mode:t});var a=s.createToolbarPanel();if(a){var r=Common.UI.LayoutManager.isElementVisible("toolbar-view");e.toolbar.addTab(o,a,8),e.toolbar.setVisible("view",r),!i&&!n&&r&&Common.Utils.InternalSettings.set("toolbar-active-tab","view")}},onAppReady:function(t){this.appOptions=t,new Promise((function(t){t()})).then((function(){}))},getView:function(t){return t?Backbone.Controller.prototype.getView.apply(this,arguments):this.toolbar},onFileMenu:function(t){"show"==t?this.toolbar.isTabActive("file")||this.toolbar.setTab("file"):this.toolbar.isTabActive("file")&&this.toolbar.setTab()},onTabCollapse:function(t){},onPluginToolbarMenu:function(t){var e=this.api;this.toolbar&&Array.prototype.push.apply(this.toolbar.lockControls,Common.UI.LayoutManager.addCustomControls(this.toolbar,t,(function(t,i,n){e&&e.onPluginToolbarMenuItemClick(t,i,n)})))},onPluginToolbarCustomMenuItems:function(t,e){if(this._isDocReady){var i=this.api;this.toolbar&&Common.UI.LayoutManager.addCustomMenuItems(t,e,(function(t,e){i&&i.onPluginContextMenuItemClick(t,e)}))}else this._state.customPluginData=(this._state.customPluginData||[]).concat([{action:t,data:e}])},onPluginUpdateToolbarMenu:function(t){var e=this.api;this.toolbar&&Array.prototype.push.apply(this.toolbar.lockControls,Common.UI.LayoutManager.addCustomControls(this.toolbar,t,(function(t,i,n){e&&e.onPluginToolbarMenuItemClick(t,i,n)}),!0))},onDocumentReady:function(){this._isDocReady=!0;var t=this;this._state.customPluginData&&this._state.customPluginData.forEach((function(e){t.onPluginToolbarCustomMenuItems(e.action,e.data)})),this._state.customPluginData=null},txtUntitled:"Untitled"},VE.Controllers.Toolbar||{}))})),define("text!visioeditor/main/app/template/StatusBar.template",[],(function(){return'<div class="statusbar">\n    <div id="status-tabs-scroll" class="status-group cnt-flex-center" dir="ltr">\n        <button id="status-btn-tabback" type="button" class="btn small btn-toolbar" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="G"><i class="icon toolbar__icon btn-previtem">&nbsp;</i></button>\n        <button id="status-btn-tabnext" type="button" class="btn small btn-toolbar" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="J"><i class="icon toolbar__icon btn-nextitem">&nbsp;</i></button>\n    </div>\n    <div id="status-addtabs-box" class="status-group cnt-flex-center">\n        <div class="cnt-tabslist">\n            <button id="status-btn-tabslist" type="button" class="btn small btn-toolbar dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top" data-hint-offset="small" data-hint-title="N"><i class="icon toolbar__icon btn-sheet-list">&nbsp;</i></button>\n        </div>\n    </div>\n    <div id="status-zoom-box" class="status-group cnt-flex-center">\n        <div class="separator short"></div>\n        <button id="status-btn-zoom-topage" type="button" class="btn small btn-toolbar" aria-pressed="false" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtoslide">&nbsp;</i></button>\n        <button id="status-btn-zoom-towidth" type="button" class="btn small btn-toolbar" aria-pressed="false" data-hint="0" data-hint-direction="top" data-hint-offset="small"><i class="icon toolbar__icon btn-ic-zoomtowidth">&nbsp;</i></button>\n        <button id="status-btn-zoomdown" type="button" class="btn small btn-toolbar"><i class="icon toolbar__icon btn-zoomdown">&nbsp;</i></button>\n        <div class="cnt-zoom">\n            <div class="dropdown-toggle" data-toggle="dropdown" data-hint="0" data-hint-direction="top" role="button" aria-haspopup="menu" aria-expanded="false">\n                <label id="status-label-zoom" class="status-label">Zoom 100%</label>\n            </div>\n        </div>\n        <button id="status-btn-zoomup" type="button" class="btn small btn-toolbar"><i class="icon toolbar__icon btn-zoomup">&nbsp;</i></button>\n    </div>\n    <div id="status-sheets-bar-box">\n        <div id="status-sheets-bar" class="status-group">\n        </div>\n    </div>\n    <div id="status-number-of-sheet cnt-flex-center">\n        <label id="label-sheets" class="status-label"></label>\n    </div>\n    <div id="status-action">\n        <div class="separator short"></div>\n        <label id="label-action" class="status-label"></label>\n    </div>\n</div>\n'}));const tip=function(t){var e=t.fn.tooltip;e.prototype=t.fn.tooltip.Constructor.prototype,t.extend(t.fn.tooltip.Constructor.DEFAULTS,{container:"body",delay:{show:500},arrow:!1});var i=function(t,e){this.init("tooltip",t,e)};i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:i,init:function(){e.prototype.init.apply(this,arguments),"cursor"==this.options.placement&&/hover/.exec(this.options.trigger)&&this.$element.on("mousemove.tooltip",this.options.selector,t.proxy(this.mousemove,this)),this.options.zIndex&&this.tip().css("z-index",this.options.zIndex);var i=this;Common.NotificationCenter.on({"layout:changed":function(t){i.options.keepvisible||i.options.hideonclick||!i.tip().is(":visible")||i.hide()}}),this.isDesktopApp=Common.Controllers.Desktop.isActive()},mousemove:function(t){var e=t.clientX*Common.Utils.zoom(),i=t.clientY*Common.Utils.zoom();this.targetXY=[e,this.isDesktopApp?Math.max(i,14):i]},leave:function(t){e.prototype.leave.apply(this,arguments),this.dontShow=void 0},show:function(i){if(this.hasContent()&&this.enabled&&!this.dontShow){if(!this.$element.is(":visible")&&this.$element.closest("[role=menu]").length>0)return;var n=this.tip();!1===this.options.arrow&&n.addClass("arrow-free"),this.options.cls&&n.addClass(this.options.cls);var o="function"!=typeof this.options.placement?/^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(this.options.placement):null;if(i||!o||o[2].length){var s=t.Event("show.bs.tooltip");if(this.$element.trigger(s),s.isDefaultPrevented())return;if(this.setContent(),this.options.animation&&n.addClass("fade"),n.detach().css({top:0,left:0,display:"block"}),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element),"function"==typeof this.options.placement)this.options.placement.call(this,n[0],this.$element[0]);else if("object"==typeof i){var a={top:i[1]+15,left:Common.UI.isRTL()?i[0]-n.width()-9:i[0]+18},r=Common.Utils.innerWidth(),l=Common.Utils.innerHeight();a.left<0&&(a.left=i[0]+18),a.left+n.width()>r&&(a.left=r-n.width()-30),a.top+n.height()>l&&(a.top=l-n.height()-30),Common.Utils.setOffset(n,a).addClass("in")}else{var c=this.getPosition(),h=n[0].offsetWidth,d=n[0].offsetHeight;switch(o[1]){case"bottom":a={top:c.top+c.height+10};break;case"top":a={top:c.top-d-10}}switch(o[2]){case"left":a.left=c.left,this.$element.outerWidth()<=18&&(a.left-=4);break;case"right":a.left=c.left+c.width-h,this.$element.outerWidth()<=18&&(a.left+=4)}this.applyPlacement(a,o[1]),this.moveArrow(),n.addClass(o[1]).addClass(o[0])}this.$element.trigger("shown.bs.tooltip")}else e.prototype.show.apply(this,arguments);var u=this;clearTimeout(u.timeout),u.timeout=setTimeout((function(){"in"==u.hoverState&&u.hide(),u.dontShow=!1}),5e3)}},moveArrow:function(){var t=this.tip().find(".tooltip-arrow, .arrow");switch(this.options.placement){case"top-left":case"bottom-left":t.css("left",10);break;case"top-right":case"bottom-right":t.css("right",10)}},enter:function(e){if("mouseenter"===e.type){var i=t(e.target);if(!(i.is("[role=menu]")||i.parentsUntil(e.currentTarget,"[role=menu]").length&&e.target!==e.currentTarget||this.tip().is(":visible"))){var n=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip");clearTimeout(n.timeout),n.hoverState="in",void 0!==this._updateTitle&&(this.tip().find(".tooltip-inner")[this.options.html?"html":"text"](this.options.title),this._updateTitle=void 0),n.options.delay&&n.options.delay.show?n.timeout=setTimeout((function(){"in"==n.hoverState&&n.show("cursor"==n.options.placement?n.targetXY:void 0)}),n.options.delay.show):n.show()}}},replaceArrow:function(t,i,n){!1===this.options.arrow?this.arrow().hide():e.prototype.replaceArrow.apply(this,arguments)},getCalculatedOffset:function(t,i,n,o){var s=e.prototype.getCalculatedOffset.apply(this,arguments);if(this.options.offset>0||this.options.offset<0)switch(/(bottom|top)/.exec(t)[1]){case"bottom":s.top+=this.options.offset;break;case"top":s.top-=this.options.offset}return s},updateTitle:function(t){this.options.title=t,this._updateTitle=t}});var n=t.fn.tooltip;t.fn.tooltip=function(e){return this.each((function(){var n=t(this),o=n.data("bs.tooltip"),s="object"==typeof e&&e;o||n.data("bs.tooltip",o=new i(this,s)),"string"==typeof e&&o[e]()}))},t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}};if(tip(window.jQuery),define("tip",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/Tab",["common/main/lib/component/BaseView"],(function(t){"use strict";var e=function(t){return this.active=!1,this.label="Tab",this.cls="",this.iconCls="",this.iconVisible=!1,this.iconTitle="",this.index=-1,this.template=_.template(['<li class="list-item <% if(active){ %>active selected<% } %> <% if(cls.length){%><%= cls %><%}%><% if(iconVisible){%> icon-visible <%}%>" data-label="<%- label %>">','<span tabtitle="<%- label %>" draggable="true" oo_editor_input="true" tabindex="-1" data-index="<%= index %>">','<div class="toolbar__icon <% if(iconCls.length){%><%= iconCls %><%}%>" title="<% if(iconTitle.length){%><%=Common.Utils.String.htmlEncode(iconTitle)%><%}%>"></div>',"<%- label %>","</span>","</li>"].join("")),this.initialize.call(this,t),this};_.extend(e.prototype,{initialize:function(t){_.extend(this,t)},render:function(){var t=this.template(this);return this.$el=$(t),this.rendered=!0,this.disable(this.disabled),this},isActive:function(){return this.$el.hasClass("active")},activate:function(){this.$el.hasClass("active")||this.$el.addClass("active")},isSelected:function(){return this.$el.hasClass("selected")},deactivate:function(){this.$el.removeClass("active")},on:function(){this.$el.on.apply(this,arguments)},disable:function(t){this.disabled=t,this.rendered&&(t&&!this.$el.hasClass("disabled")?this.$el.addClass("disabled"):this.$el.removeClass("disabled"))},addClass:function(t){t.length&&!this.$el.hasClass(t)&&this.$el.addClass(t)},removeClass:function(t){t.length&&this.$el.hasClass(t)&&this.$el.removeClass(t)},toggleClass:function(t){t.length&&this.$el.toggleClass(t)},hasClass:function(t){return this.$el.hasClass(t)},setCaption:function(t){this.$el.find("> span").text(t)},changeIconState:function(t,e){this.iconCls.length&&(this.iconVisible=t,this.iconTitle=e||"",this[t?"addClass":"removeClass"]("icon-visible"),e&&this.$el.find("."+this.iconCls).attr("title",e))}}),Common.UI.Tab=e})),define("common/main/lib/component/TabBar",["common/main/lib/component/BaseView","common/main/lib/component/Tab"],(function(){"use strict";var t={bind:function(){this.o||(this.o=$({})),this.o.on.apply(this.o,arguments)},unbind:function(){this.o&&this.o.off.apply(this.o,arguments)},trigger:function(){this.o||(this.o=$({})),this.o.trigger.apply(this.o,arguments)}},e=function(t){this.initialize.call(this,t)};_.extend(e.prototype,t),e.prototype.initialize=function(t){this.bar=t.bar},e.prototype.attach=function(t){t.changeState=$.proxy((function(e){if(e){t.toggleClass("selected");var i=_.find(this.bar.selectTabs,(function(e){return e.sheetindex===t.sheetindex}));i?this.bar.selectTabs=_.without(this.bar.selectTabs,i):this.bar.selectTabs.push(t)}else t.isSelected()||(this.bar.$el.find("ul > li.selected").removeClass("selected"),t.addClass("selected"),this.bar.selectTabs.length=0,this.bar.selectTabs.push(t)),this.trigger("tab:change",t),this.bar.$el.find("ul > li.active").removeClass("active"),t.activate(),this.bar.trigger("tab:changed",this.bar,this.bar.tabs.indexOf(t),t)}),this);new function(){};t.$el.on({click:$.proxy((function(e){if(!t.disabled)if(e.ctrlKey||e.metaKey)t.isActive()||t.changeState(!0);else if(e.shiftKey){this.bar.$el.find("ul > li.selected").removeClass("selected"),this.bar.selectTabs.length=0;for(var i=this.bar.$el.find("ul > li.active").index(),n=this.bar.tabs.indexOf(t),o=n>i?n:i,s=n>i?i:n;s<=o;s++)this.bar.tabs[s].changeState(!0)}else t.$el.hasClass("active")||(this.bar.tabs.length===this.bar.selectTabs.length&&(this.bar.$el.find("ul > li.selected").removeClass("selected"),this.bar.selectTabs.length=0),"manual"==t.control?this.bar.trigger("tab:manual",this.bar,this.bar.tabs.indexOf(t),t):(t.changeState(),this.bar.isEditFormula&&setTimeout((function(){$("#ce-cell-content").focus();var t=$("#ce-cell-content")[0];t.selectionStart=t.selectionEnd=t.value.length}),500)));!t.disabled&&Common.NotificationCenter.trigger("edit:complete","tab")}),this),dblclick:$.proxy((function(){this.trigger("tab:dblclick",this,this.tabs.indexOf(t),t)}),this.bar),contextmenu:$.proxy((function(){this.trigger("tab:contextmenu",this,this.tabs.indexOf(t),t,this.selectTabs)}),this.bar),mousedown:$.proxy((function(e){if(3===e.which||e.shiftKey)this.bar.$el.find("ul > li > span").attr("draggable","false");else{var i=t.isLockTheDrag;this.bar.selectTabs.forEach((function(t){t.isLockTheDrag&&(i=!0)})),(this.bar.selectTabs.length!==this.bar.tabs.length&&1!==this.bar.tabs.length||e.ctrlKey||Common.Utils.isMac&&e.altKey)&&!this.bar.isEditFormula||(i=!0),!(this.bar.selectTabs.length===this.bar.tabs.length&&this.bar.tabs.length>1)||e.ctrlKey||Common.Utils.isMac&&e.altKey||(i=!1,this.bar.$el.find("ul > li.selected").removeClass("selected")),this.bar.$el.find("ul > li > span").attr("draggable",!i),i||e.ctrlKey||e.metaKey||t.changeState()}$("#ce-cell-content").is(":focus")&&(this.bar.isEditFormula?setTimeout((function(){$("#ce-cell-content").focus()}),500):$("#ce-cell-content").blur())}),this)}),t.$el.children().on({dragstart:$.proxy((function(t){var e=t.originalEvent;if(Common.Utils.isIE||Common.Utils.isSafari)Common.Utils.isIE&&this.bar.selectTabs.forEach((function(t){t.$el.find("span").prop("tabtitle","")}));else{var i=document.createElement("div");e.dataTransfer.setDragImage(i,0,0)}e.dataTransfer.effectAllowed="copyMove",this.bar.preventCutTab=!1,this.bar.trigger("tab:dragstart",e.dataTransfer,this.bar.selectTabs)}),this),dragenter:$.proxy((function(t){var e=t.originalEvent;this.bar.isEditFormula?e.dataTransfer.dropEffect="none":(this.bar.$el.find(".mousemove").removeClass("mousemove right"),$(t.currentTarget).parent().addClass("mousemove"),e.dataTransfer.dropEffect=e.ctrlKey||Common.Utils.isMac&&e.altKey?"copy":"move")}),this),dragover:$.proxy((function(t){var e=t.originalEvent;return e.preventDefault&&e.preventDefault(),this.bar.isEditFormula?e.dataTransfer.dropEffect="none":(this.bar.$el.find(".mousemove").removeClass("mousemove right"),$(t.currentTarget).parent().addClass("mousemove"),e.dataTransfer.dropEffect=e.ctrlKey||Common.Utils.isMac&&e.altKey?"copy":"move"),!1}),this),dragleave:$.proxy((function(t){$(t.currentTarget).parent().removeClass("mousemove right")}),this),dragend:$.proxy((function(t){Common.Utils.isMac&&t.altKey&&(this.bar.isDragDrop=!0);var e=t.originalEvent;this.bar.trigger("tab:dragend",!this.bar.preventCutTab&&"move"===e.dataTransfer.dropEffect&&!e.dataTransfer.mozUserCancelled),this.bar.$el.find(".mousemove").removeClass("mousemove right")}),this),drop:$.proxy((function(t){Common.Utils.isMac&&t.altKey&&(this.bar.isDragDrop=!0);var e=t.originalEvent,i=$(e.currentTarget).data("index");this.bar.$el.find(".mousemove").removeClass("mousemove right"),this.bar.trigger("tab:drop",e.dataTransfer,i,e.ctrlKey||Common.Utils.isMac&&e.altKey),this.bar.isDrop=!0,this.bar.preventCutTab=!0}),this)})},e.prototype.detach=function(t){t.$el.off()},Common.UI.TabBar=Common.UI.BaseView.extend({config:{placement:"top",items:[],draggable:!1},tabs:[],template:_.template('<ul id="statusbar_bottom" class="nav nav-tabs <%= placement %>"></ul>'),selectTabs:[],initialize:function(t){_.extend(this.config,t),Common.UI.BaseView.prototype.initialize.call(this,t),this.saved=[],this.isRTL=t.isRTL||!1},render:function(){this.$el.html(this.template(this.config)),this.$bar=this.$el.find("ul");var t=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)},i=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";return t(this.$bar[0],i,_.bind(this._onMouseWheel,this)),t(this.$bar[0],"dragstart",_.bind((function(t){t.dataTransfer.effectAllowed="copyMove"}),this)),t(this.$bar[0],"dragenter",_.bind((function(t){this.isEditFormula?t.dataTransfer.dropEffect="none":t.dataTransfer.dropEffect=t.ctrlKey||Common.Utils.isMac&&t.altKey?"copy":"move"}),this)),t(this.$bar[0],"dragover",_.bind((function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect=this.isEditFormula?"none":t.ctrlKey||Common.Utils.isMac&&t.altKey?"copy":"move",!this.isEditFormula&&this.tabs[this.tabs.length-1].$el.addClass("mousemove right"),!1}),this)),t(this.$bar[0],"dragleave",_.bind((function(t){t.dataTransfer.dropEffect="none",this.tabs[this.tabs.length-1].$el.removeClass("mousemove right")}),this)),t(this.$bar[0],"drop",_.bind((function(t){this.$el.find(".mousemove").removeClass("mousemove right"),void 0===this.isDrop?(Common.Utils.isMac&&t.altKey&&(this.isDragDrop=!0),this.trigger("tab:drop",t.dataTransfer,"last",t.ctrlKey||Common.Utils.isMac&&t.altKey)):this.isDrop=void 0}),this)),this.manager=new e({bar:this}),this.insert(-1,this.config.items),this.insert(-1,this.saved),delete this.saved,Common.Gateway.on("processmouse",_.bind(this.onProcessMouse,this)),this.rendered=!0,this},_onMouseWheel:function(t){var e=this.checkInvisible(!0);(t.detail&&-t.detail||t.wheelDelta)<0?e.last&&this.setTabVisible("forward"):e.first&&this.setTabVisible("backward"),Common.NotificationCenter.trigger("hints:clear")},onProcessMouse:function(t){if("mouseup"==t.type&&this.dragging){var e=this.getActive(!0);e&&e.mouseup()}},add:function(t){return this.insert(-1,t)>0},insert:function(t,e){var i=0;if(e&&(e instanceof Array||(e=[e]),e.length)){if(i=e.length,this.rendered){var n,o=this;if(t<0||t>o.tabs.length)for(var s=0;s<e.length;s++)n=new Common.UI.Tab(e[s]),o.$bar.append(n.render().$el),o.tabs.push(n),o.manager.attach(n),n.isActive()&&(o.selectTabs.length=0,o.selectTabs.push(n));else for(s=e.length;s-- >0;)n=new Common.UI.Tab(e[s]),0===t?(o.$bar.prepend(n.render().$el),o.tabs.unshift(n)):(o.$bar.find("li:nth-child("+t+")").before(n.render().$el),o.tabs.splice(t,0,n)),n.isActive()&&(o.selectTabs.length=0,o.selectTabs.push(n)),o.manager.attach(n)}else this.saved.push(e);this.checkInvisible()}return i},remove:function(t){if(t>=0&&t<this.tabs.length){var e=this.tabs.splice(t,1)[0];this.manager.detach(e),e.$el.remove(),this.checkInvisible()}},empty:function(t){var e=this;this.tabs.forEach((function(t){e.manager.detach(t)})),this.$bar.empty(),e.tabs=[],this.checkInvisible(t)},setActive:function(t){if(t instanceof Common.UI.Tab)e=t;else if("number"==typeof t&&t>=0&&t<this.tabs.length)var e=this.tabs[t];!e||"manual"==e.control||e.disabled||e.$el.hasClass("active")||e.changeState(),this.checkInvisible()},setSelectAll:function(t){var e=this;e.selectTabs.length=0,t?e.tabs.forEach((function(t){t.isSelected()||t.addClass("selected"),e.selectTabs.push(t)})):e.tabs.forEach((function(t){t.isActive()?e.selectTabs.push(t):t.isSelected()&&t.removeClass("selected")}))},getActive:function(t){return t?this.$bar.find("> li.active"):this.$bar.find("> li.active").index()},getAt:function(t){return t>=0&&t<this.tabs.length?this.tabs[t]:void 0},getCount:function(){return this.tabs.length},addClass:function(t){t.length&&!this.$bar.hasClass(t)&&this.$bar.addClass(t)},removeClass:function(t){t.length&&this.$bar.hasClass(t)&&this.$bar.removeClass(t)},hasClass:function(t){return this.$bar.hasClass(t)},setTabVisible:function(t,e){if(t<=0)this.$bar.scrollLeft(0),this.checkInvisible(e);else if(t>=this.tabs.length-1){var i=this.tabs[this.tabs.length-1].$el;0===this.$bar.find(".separator-item").length&&this.$bar.append('<li class="separator-item"><span></span></li>'),this.$bar.scrollLeft(this.$bar.scrollLeft()+(Common.Utils.getPosition(i).left+parseInt(i.css("width"))-this.$bar.width())+(this.$bar.width()>400?20:5)),this.checkInvisible(e)}else{this.isTabVisible(this.tabs.length-1)||0!==this.$bar.find(".separator-item").length||this.$bar.append('<li class="separator-item"><span></span></li>');var n,o,s=this.$bar.width();if(this.isRTL)if("forward"==t){for(var a=this.tabs.length-1;a>=0;a--)if(i=this.tabs[a].$el,(n=Common.Utils.getPosition(i).left+parseInt(i.css("width")))>s){this.$bar.scrollLeft(this.$bar.scrollLeft()+(n-s)+(s>400?20:5)),this.checkInvisible(e);break}}else if("backward"==t){for(a=0;a<this.tabs.length;a++)if(i=this.tabs[a].$el,(o=Common.Utils.getPosition(i).left)<0){this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e);break}}else"number"==typeof t&&(i=this.tabs[t].$el,(n=(o=Common.Utils.getPosition(i).left)+parseInt(i.css("width")))>s?(this.$bar.scrollLeft(this.$bar.scrollLeft()+(n-s)+20),this.checkInvisible(e)):o<0&&(this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e)));else if("forward"==t){for(a=0;a<this.tabs.length;a++)if(i=this.tabs[a].$el,(n=Common.Utils.getPosition(i).left+parseInt(i.css("width")))>s){this.$bar.scrollLeft(this.$bar.scrollLeft()+(n-s)+(this.$bar.width()>400?20:5)),this.checkInvisible(e);break}}else if("backward"==t){for(a=this.tabs.length;a-- >0;)if(i=this.tabs[a].$el,(o=Common.Utils.getPosition(i).left)<0){this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e);break}}else"number"==typeof t&&(i=this.tabs[t].$el,n=(o=Common.Utils.getPosition(i).left)+parseInt(i.css("width")),o<0?(this.$bar.scrollLeft(this.$bar.scrollLeft()+o-26),this.checkInvisible(e)):n>s&&(this.$bar.scrollLeft(this.$bar.scrollLeft()+(n-s)+20),this.checkInvisible(e)))}},checkInvisible:function(t){var e={first:!this.isTabVisible(this.isRTL?this.tabs.length-1:0),last:!this.isTabVisible(this.isRTL?0:this.tabs.length-1)};return!t&&this.fireEvent("tab:invisible",this,e),e},hasInvisible:function(){for(var t=Common.Utils.getOffset(this.$bar).left,e=t+this.$bar.width(),i=this.tabs.length;i-- >0;)if(!this.isTabVisible(i,t,e))return!0;return!1},isTabVisible:function(t){var e,i,n,o,s=arguments[1]||Common.Utils.getOffset(this.$bar).left,a=arguments[2]||s+this.$bar.width();return t<this.tabs.length&&t>=0&&(n=this.tabs[t].$el,e=(o=Common.Utils.getBoundingClientRect(n.get(0))).left,i=o.right,!(e<s||i-a>.5))},addDataHint:function(t,e){var i=this.$bar.find("[data-hint]");i.length>0&&(i.removeAttr("data-hint"),i.removeAttr("data-hint-direction"),i.removeAttr("data-hint-offset"),i.removeAttr("data-hint-title"));var n=this.tabs[t].$el;n.attr("data-hint",e||"0"),n.attr("data-hint-direction","top"),n.attr("data-hint-offset","medium"),n.attr("data-hint-title","M")},getWidth:function(){var t=21;return this.tabs.forEach((function(e){t+=e.$el.width()})),t},setDirection:function(t){this.isRTL=t}})})),define("visioeditor/main/app/view/Statusbar",["text!visioeditor/main/app/template/StatusBar.template","jquery","underscore","backbone","tip","common/main/lib/component/TabBar","common/main/lib/component/Menu","common/main/lib/component/Window"],(function(t,e,i,n){"use strict";function o(t){this._state.pageCurrent=t}function s(t){var e=this;e.btnScrollBack.updateHint(e.tipPrev),e.btnScrollNext.updateHint(e.tipNext),e.btnZoomToPage.updateHint(e.tipFitPage),e.btnZoomToWidth.updateHint(e.tipFitWidth),e.btnZoomDown.updateHint(e.tipZoomOut+Common.Utils.String.platformKey("Ctrl+-")),e.btnZoomUp.updateHint(e.tipZoomIn+Common.Utils.String.platformKey("Ctrl++")),e.cntSheetList.updateHint(e.tipListOfSheets),e.cntZoom.updateHint(e.tipZoomFactor),e.cntZoom.cmpEl.on({"show.bs.dropdown":function(){i.defer((function(){e.cntZoom.cmpEl.find("ul").focus()}),100)},"hide.bs.dropdown":function(){i.defer((function(){e.api.asc_enableKeyEvents(!0)}),100)}}),e.tabbar.on({"tab:invisible":i.bind(e.onTabInvisible,e),"tab:changed":i.bind(e.onSheetChanged,e)})}VE.Views.Statusbar=Common.UI.BaseView.extend(i.extend({el:"#statusbar",template:i.template(t),events:function(){return{"click #status-btn-tabback":i.bind(this.onBtnTabScroll,this,"backward"),"click #status-btn-tabnext":i.bind(this.onBtnTabScroll,this,"forward")}},api:void 0,initialize:function(t){i.extend(this,t),this._state={pageCurrent:0},this._isDisabled=!1;var e=new Promise((function(t,e){t()}));Common.NotificationCenter.on("app:ready",function(t){e.then(s.bind(this,t))}.bind(this)),Common.NotificationCenter.on("uitheme:changed",i.bind((function(){this.setMode()}),this))},render:function(t){var n=this;e(this.el).html(this.template({scope:this})),this.cntStatusbar=e(".statusbar",this.el),this.isCompact=Common.localStorage.getBool("ve-compact-statusbar",!0),this.isCompact||this.cntStatusbar.addClass("no-compact"),this.editMode=!1,this.isRtlSheet=Common.UI.isRTL(),this.tabBarDefPosition=106,this.btnZoomDown=new Common.UI.Button({el:e("#status-btn-zoomdown",this.el),hintAnchor:"top"}),this.btnZoomUp=new Common.UI.Button({el:e("#status-btn-zoomup",this.el),hintAnchor:"top-right"}),this.btnZoomToPage=new Common.UI.Button({el:e("#status-btn-zoom-topage",this.el),hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.btnZoomToWidth=new Common.UI.Button({el:e("#status-btn-zoom-towidth",this.el),hintAnchor:"top",toggleGroup:"status-zoom",enableToggle:!0}),this.btnScrollBack=new Common.UI.Button({el:e("#status-btn-tabback",this.el),disabled:!0,hintAnchor:"top"}),this.btnScrollNext=new Common.UI.Button({el:e("#status-btn-tabnext",this.el),disabled:!0,hintAnchor:"top"});var o=e(".cnt-tabslist",this.el);return this.cntSheetList=new Common.UI.Button({el:o,hintAnchor:"top"}),this.btnSheetList=e("#status-btn-tabslist",this.$el),this.sheetListMenu=new Common.UI.Menu({style:"margin-top:-3px;",menuAlign:"bl-tl",maxHeight:300}),this.sheetListMenu.on("item:click",(function(t,e){n.fireEvent("show:tab",[e.value])})),this.cntSheetList.cmpEl.on({"show.bs.dropdown":function(){i.defer((function(){n.cntSheetList.cmpEl.find("ul").focus()}),100)},"hide.bs.dropdown":function(){i.defer((function(){n.api.asc_enableKeyEvents(!0)}),100)}}),this.sheetListMenu.render(o),this.sheetListMenu.cmpEl.attr({tabindex:-1}),o.on("app:scaling",(function(){n.setMode()})),this.cntZoom=new Common.UI.Button({el:e(".cnt-zoom",this.el),hintAnchor:"top"}),this.zoomMenu=new Common.UI.Menu({style:"margin-top:-5px;",menuAlign:"bl-tl",items:[{caption:"50%",value:50},{caption:"75%",value:75},{caption:"100%",value:100},{caption:"125%",value:125},{caption:"150%",value:150},{caption:"175%",value:175},{caption:"200%",value:200},{caption:"300%",value:300},{caption:"400%",value:400},{caption:"500%",value:500}]}),this.zoomMenu.render(e(".cnt-zoom",this.el)),this.zoomMenu.cmpEl.attr({tabindex:-1}),this.labelZoom=e("#status-label-zoom",this.$el),this.tabBarBox=e("#status-sheets-bar-box",this.el),this.tabbar=new Common.UI.TabBar({el:"#status-sheets-bar",placement:"bottom",draggable:!1}).render(),this.boxZoom=e("#status-zoom-box",this.el),this.boxZoom.find(".separator").css("border-left-color","transparent"),this.boxNumberSheets=e("#status-number-of-sheet",this.el),this.isCompact&&this.boxNumberSheets.hide(),this.labelNumberSheets=e("#label-sheets",this.boxNumberSheets),this.boxAction=e("#status-action",this.el),this.boxAction.hide(),this.labelAction=e("#label-action",this.boxAction),this.updateRtlSheet(),this.fireEvent("render:after",[this]),this},setApi:function(t){return this.api=t,this.api&&this.api.asc_registerCallback("asc_onCurrentPage",i.bind(o,this)),this},setMode:function(t){this.mode=t,this.tabBarDefPosition=parseInt(e("#status-tabs-scroll").css("width"))+parseInt(this.cntStatusbar.css("padding-left")),this.tabBarDefPosition+=parseFloat(e("#status-addtabs-box").css("width")),this.updateTabbarBorders()},setVisible:function(t){t?this.show():this.hide()},isVisible:function(){return this.$el&&this.$el.is(":visible")},update:function(){var t=this;if(this.tabbar.empty(!0),this.sheetListMenu.removeAll(),this.api){for(var e,n=this.api.getCountPages(),o=-1,s=[],a=this._state.pageCurrent;++o<n;)e={sheetindex:o,index:s.length,active:a==o,label:this.api.asc_getPageName(o)||t.txtPage+(o+1),isLockTheDrag:!0},s.push(e);this.tabbar.add(s),s.forEach((function(e){t.sheetListMenu.addItem(new Common.UI.MenuItem({style:"white-space: pre",caption:Common.Utils.String.htmlEncode(e.label),value:e.sheetindex,checkable:!0,checked:e.active,hidden:false,visible:!0,textHidden:t.itemHidden,template:i.template(['<a id="<%= id %>" style="<%= style %>" tabindex="-1" type="menuitem" <% if (options.hidden) { %> data-hidden="true" <% } %>>','<div class="color"></div>','<span class="name"><%= caption %></span>','<span class="hidden-mark"><% if (options.hidden) { %><%=  options.textHidden %><% } else { %><% } %></span>',"</a>"].join(""))}))})),i.isUndefined(this.tabBarScroll)||(this.tabbar.$bar.scrollLeft(this.tabBarScroll.scrollLeft),this.tabBarScroll=void 0),this.tabbar.isTabVisible(a)||this.tabbar.setTabVisible(a),this.updateRtlSheet(),this.updateNumberOfSheet(a,n),this.updateTabbarBorders(),t.fireEvent("sheet:changed",[t,a])}},updateRtlSheet:function(){this.isRtlSheet=Common.UI.isRTL(),this.cntStatusbar.toggleClass("rtl-sheet",this.isRtlSheet),this.cntStatusbar.attr({dir:this.isRtlSheet?"rtl":"ltr"}),this.tabbar.setDirection(this.isRtlSheet);var t=(this.isCompact?this.isRtlSheet:Common.UI.isRTL())?"rtl":"ltr";this.boxZoom.attr({dir:t})},onSheetChanged:function(t,e,i){this.api.goToPage(i.sheetindex),this.updateNumberOfSheet(i.sheetindex,this.api.getCountPages()),this.hasTabInvisible&&!this.tabbar.isTabVisible(e)&&this.tabbar.setTabVisible(e),this.updateRtlSheet(),this.updateTabbarBorders(),this.fireEvent("sheet:changed",[this,i.sheetindex])},onTabInvisible:function(t,e){this.btnScrollBack.isDisabled()!==!e.first&&this.btnScrollBack.setDisabled(!e.first),this.btnScrollNext.isDisabled()!==!e.last&&this.btnScrollNext.setDisabled(!e.last),this.hasTabInvisible=e.first||e.last},onBtnTabScroll:function(t,e){this.tabbar.setTabVisible(t)},updateTabbarBorders:function(){var t=!1,e=parseFloat(this.boxZoom.css("width"));if(this.isCompact){var i=this.tabbar.getWidth();if(this.boxAction.is(":visible")){var n=this.actionWidth||140;if(Common.Utils.innerWidth()-e-this.tabBarDefPosition-n-i>0){var o=i+this.tabBarDefPosition;this.isRtlSheet?(this.boxAction.css({left:e+"px",right:o+"px",width:"auto"}),this.boxAction.find(".separator").css("border-right-color","transparent")):(this.boxAction.css({right:e+"px",left:o+"px",width:"auto"}),this.boxAction.find(".separator").css("border-left-color","transparent"))}else this.isRtlSheet?(this.boxAction.css({left:e+"px",right:"auto",width:n+"px"}),this.boxAction.find(".separator").css("border-right-color","")):(this.boxAction.css({right:e+"px",left:"auto",width:n+"px"}),this.boxAction.find(".separator").css("border-left-color","")),t=!0;e+=parseInt(this.boxAction.css("width"))}else Common.Utils.innerWidth()-e-this.tabBarDefPosition-i<=0&&(t=!0);this.boxZoom.css({top:"0px",bottom:"auto"}),this.isRtlSheet?(this.tabBarBox.css("left",e+"px"),this.tabBarBox.css("right",this.tabBarDefPosition+"px"),this.boxZoom.find(".separator").css("border-right-color",t?"":"transparent")):(this.tabBarBox.css("left",this.tabBarDefPosition+"px"),this.tabBarBox.css("right",e+"px"),this.boxZoom.find(".separator").css("border-left-color",t?"":"transparent"))}else this.boxAction.is(":visible")&&(Common.UI.isRTL()?(this.boxAction.css({left:e+"px",right:"135px",width:"auto"}),this.boxAction.find(".separator").css("border-right-color","transparent")):(this.boxAction.css({right:e+"px",left:"135px",width:"auto"}),this.boxAction.find(".separator").css("border-left-color","transparent"))),this.boxZoom.css({top:"auto",bottom:"0px"}),this.boxZoom.find(".separator").css(Common.UI.isRTL()?"border-right-color":"border-left-color",t?"":"transparent"),this.isRtlSheet?(this.tabBarBox.css("left","0px"),this.tabBarBox.css("right",this.tabBarDefPosition+"px")):(this.tabBarBox.css("left",this.tabBarDefPosition+"px"),this.tabBarBox.css("right","0px"));if(this.statusMessage){var s=this.getStatusMessage(this.statusMessage);s!==this.boxAction.text().trim()&&this.labelAction.text(s)}},changeViewMode:function(t){var e=t.isEdit,i=this.isRtlSheet?"right":"left";e?this.tabBarBox.css(i,this.tabBarDefPosition+"px"):this.tabBarBox.css(i,""),this.tabbar.options.draggable=e,this.editMode=e},onChangeCompact:function(t){this.isCompact=t,t?(this.cntStatusbar.removeClass("no-compact"),this.boxNumberSheets.hide()):(this.cntStatusbar.addClass("no-compact"),this.boxNumberSheets.show()),this.updateRtlSheet(),this.updateTabbarBorders(),this.tabbar.getCount()>0&&this.onTabInvisible(void 0,this.tabbar.checkInvisible(!0))},updateNumberOfSheet:function(t,e){this.labelNumberSheets.text(Common.Utils.String.format(this.sheetIndexText,t+1,e))},getStatusMessage:function(t){return this.isCompact&&t.length>23&&this.boxAction.width()<180?t.substr(0,23).trim()+"...":t},getStatusLabel:function(){return this.labelAction},showStatusMessage:function(t,e){this.statusMessage=t,this.actionWidth||(this.actionWidth=t.length>22?166:140),this.labelAction.text(this.getStatusMessage(t)),this.boxAction.is(":visible")||this.boxAction.show();var n=this;i.delay((function(){n.updateTabbarBorders(),n.onTabInvisible(void 0,n.tabbar.checkInvisible(!0)),e&&e()}),30)},clearStatusMessage:function(){this.labelAction.text(""),this.statusMessage=void 0},SetDisabled:function(t){this._isDisabled=t},tipFitPage:"Fit to Page",tipFitWidth:"Fit to Width",tipZoomIn:"Zoom In",tipZoomOut:"Zoom Out",tipZoomFactor:"Magnification",txtPage:"Page",sheetIndexText:"Page {0} of {1}",tipPrev:"Previous page",tipNext:"Next page",tipListOfSheets:"List of pages"},VE.Views.Statusbar||{}))})),void 0===window.Common&&(window.Common={}),Common.util=Common.util||{},Common.util.LanguageInfo=new function(){var t={54:["af","Afrikaans"],1078:["af-ZA","Afrikaans (Suid Afrika)","Afrikaans (South Africa)"],28:["sq","Shqipe"],1052:["sq-AL","Shqipe (ShqipÃ«ria)","Albanian (Albania)"],132:["gsw","ElsÃ¤ssisch"],1156:["gsw-FR","ElsÃ¤ssisch (FrÃ nkrisch)","Alsatian (France)"],94:["am","á áá­á"],1118:["am-ET","á áá­á (á¢áµá®áµá«)","Amharic (Ethiopia)"],1:["ar","Ø§ÙØ¹Ø±Ø¨ÙØ©â"],5121:["ar-DZ","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¬Ø²Ø§Ø¦Ø±)â","Arabic (Algeria)"],15361:["ar-BH","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¨Ø­Ø±ÙÙ)â","Arabic (Bahrain)"],3073:["ar-EG","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØµØ±)â","Arabic (Egypt)"],2049:["ar-IQ","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¹Ø±Ø§Ù)â","Arabic (Iraq)"],11265:["ar-JO","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ£Ø±Ø¯Ù)â","Arabic (Jordan)"],13313:["ar-KW","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙØª)â","Arabic (Kuwait)"],12289:["ar-LB","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ¨ÙØ§Ù)â","Arabic (Lebanon)"],4097:["ar-LY","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙÙØ¨ÙØ§)â","Arabic (Libya)"],6145:["ar-MA","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙÙØºØ±Ø¨ÙØ©)â","Arabic (Morocco)"],8193:["ar-OM","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¹ÙØ§Ù)â","Arabic (Oman)"],16385:["ar-QA","Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ·Ø±)â","Arabic (Qatar)"],1025:["ar-SA","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©)â","Arabic (Saudi Arabia)"],10241:["ar-SY","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø³ÙØ±ÙØ§)â","Arabic (Syria)"],7169:["ar-TN","Ø§ÙØ¹Ø±Ø¨ÙØ© (ØªÙÙØ³)â","Arabic (Tunisia)"],14337:["ar-AE","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¥ÙØ§Ø±Ø§Øª Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙÙØªØ­Ø¯Ø©)â","Arabic (U.A.E.)"],9217:["ar-YE","Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙ)â","Arabic (Yemen)"],43:["hy","ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶"],1067:["hy-AM","ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶ (ÕÕ¡ÕµÕ¡Õ½Õ¿Õ¡Õ¶)","Armenian (Armenia)"],77:["as","à¦à¦¸à¦®à§à§à¦¾"],1101:["as-IN","à¦à¦¸à¦®à§à§à¦¾ (à¦­à¦¾à§°à¦¤)","Assamese (India)"],44:["az","AzÉrbaycanÂ­Ä±lÄ±"],29740:["az-Cyrl","ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½Â Ð´Ð¸Ð»Ð¸"],2092:["az-Cyrl-AZ","ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½ (ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½)","Azeri (Cyrillic, Azerbaijan)"],30764:["az-Latn","AzÉrbaycanÂ­Ä±lÄ±"],1068:["az-Latn-AZ","AzÉrbaycanÂ­Ä±lÄ± (AzÉrbaycan)","Azeri (Latin, Azerbaijan)"],109:["ba","ÐÐ°ÑÒ¡Ð¾ÑÑ"],1133:["ba-RU","ÐÐ°ÑÒ¡Ð¾ÑÑ (Ð Ð¾ÑÑÐ¸Ñ)","Bashkir (Russia)"],45:["eu","Euskara"],1069:["eu-ES","Euskara (Euskara)","Basque (Basque)"],35:["be","ÐÐµÐ»Ð°ÑÑÑÐºÐ°Ñ"],1059:["be-BY","ÐÐµÐ»Ð°ÑÑÑÐºÐ°Ñ (ÐÐµÐ»Ð°ÑÑÑÑ)","Belarusian (Belarus)"],69:["bn","à¦¬à¦¾à¦à¦²à¦¾"],2117:["bn-BD","à¦¬à¦¾à¦à¦²à¦¾ (à¦¬à¦¾à¦à¦²à¦¾à¦¦à§à¦¶)","Bengali (Bangladesh)"],1093:["bn-IN","à¦¬à¦¾à¦à¦²à¦¾ (à¦­à¦¾à¦°à¦¤)","Bengali (India)"],30746:["bs","bosanski"],25626:["bs-Cyrl","ÐÐ¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],8218:["bs-Cyrl-BA","ÐÐ¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°)","Bosnian (Cyrillic, Bosnia and Herzegovina)"],26650:["bs-Latn","Bosanski (Latinica)"],5146:["bs-Latn-BA","Bosanski (Bosna i Hercegovina)","Bosnian (Latin, Bosnia and Herzegovina)"],126:["br","Brezhoneg"],1150:["br-FR","Brezhoneg (FraÃ±s)","Breton (France)"],2:["bg","ÐÑÐ»Ð³Ð°ÑÑÐºÐ¸"],1026:["bg-BG","ÐÑÐ»Ð³Ð°ÑÑÐºÐ¸ (ÐÑÐ»Ð³Ð°ÑÐ¸Ñ)","Bulgarian (Bulgaria)"],3:["ca","CatalÃ "],1027:["ca-ES","CatalÃ  (CatalÃ )","Catalan (Catalan)"],2051:["ca-ES-valencia","CatalÃ  (ValenciÃ )","Catalan (Valencia)"],30724:["zh","ä¸­æ"],4:["zh-Hans","ä¸­æ(ç®ä½)","Chinese (Simplified)"],2052:["zh-CN","ä¸­æ(ä¸­åäººæ°å±åå½)","Chinese (People's Republic of China)"],4100:["zh-SG","ä¸­æ(æ°å å¡)","Chinese (Simplified, Singapore)"],31748:["zh-Hant","ä¸­æ(ç¹é«)","Chinese (Traditional)"],3076:["zh-HK","ä¸­æ(é¦æ¸¯ç¹å¥è¡æ¿å)","Chinese (Traditional, Hong Kong S.A.R.)"],5124:["zh-MO","ä¸­æ(æ¾³éç¹å¥è¡æ¿å)","Chinese (Traditional, Macao S.A.R.)"],1028:["zh-TW","ä¸­æ(å°ç£)","Chinese (Traditional, Taiwan)"],131:["co","Corsu"],1155:["co-FR","Corsu (France)","Corsican (France)"],26:["hr","Hrvatski"],1050:["hr-HR","Hrvatski (Hrvatska)","Croatian (Croatia)"],4122:["hr-BA","Hrvatski (Bosna i Hercegovina)","Croatian (Bosnia and Herzegovina)"],5:["cs","ÄeÅ¡tina"],1029:["cs-CZ","ÄeÅ¡tina (ÄeskÃ¡Â republika)","Czech (Czech Republic)"],6:["da","Dansk"],1030:["da-DK","Dansk (Danmark)","Danish (Denmark)"],140:["prs","Ø¯Ø±Ùâ"],1164:["prs-AF","Ø¯Ø±Ù (Ø§ÙØºØ§ÙØ³ØªØ§Ù)â","Dari (Afghanistan)"],101:["dv","ÞÞ¨ÞÞ¬ÞÞ¨ÞÞ¦ÞÞ°â"],1125:["dv-MV","ÞÞ¨ÞÞ¬ÞÞ¨ÞÞ¦ÞÞ° (ÞÞ¨ÞÞ¬ÞÞ¨ ÞÞ§ÞÞ°ÞÞ¬)â","Divehi (Maldives)"],19:["nl","Nederlands"],2067:["nl-BE","Nederlands (BelgiÃ«)","Dutch (Belgium)"],1043:["nl-NL","Nederlands (Nederland)","Dutch (Netherlands)"],9:["en","English"],3081:["en-AU","English (Australia)","English (Australia)"],10249:["en-BZ","English (Belize)","English (Belize)"],4105:["en-CA","English (Canada)","English (Canada)"],9225:["en-029","English (Caribbean)","English (Caribbean)"],16393:["en-IN","English (India)","English (India)"],6153:["en-IE","English (Ireland)","English (Ireland)"],8201:["en-JM","English (Jamaica)","English (Jamaica)"],17417:["en-MY","English (Malaysia)","English (Malaysia)"],5129:["en-NZ","English (New Zealand)","English (New Zealand)"],13321:["en-PH","English (Philippines)","English (Philippines)"],18441:["en-SG","English (Singapore)","English (Singapore)"],7177:["en-ZA","English (South Africa)","English (South Africa)"],11273:["en-TT","English (Trinidad y Tobago)","English (Trinidad y Tobago)"],2057:["en-GB","English (United Kingdom)","English (United Kingdom)"],1033:["en-US","English (United States)","English (United States)"],12297:["en-ZW","English (Zimbabwe)","English (Zimbabwe)"],15369:["en-HK","English (Hong Kong)","English (Hong Kong)"],14345:["en-ID","English (Indonesia)","English (Indonesia)"],37:["et","Eesti"],1061:["et-EE","Eesti (Eesti)","Estonian (Estonia)"],56:["fo","FÃ¸royskt"],1080:["fo-FO","FÃ¸royskt (FÃ¸royar)","Faroese (Faroe Islands)"],100:["fil","Filipino"],1124:["fil-PH","Filipino (Pilipinas)","Filipino (Philippines)"],11:["fi","Suomi"],1035:["fi-FI","Suomi (Suomi)","Finnish (Finland)"],12:["fr","FranÃ§ais"],2060:["fr-BE","FranÃ§ais (Belgique)","French (Belgium)"],3084:["fr-CA","FranÃ§ais (Canada)","French (Canada)"],1036:["fr-FR","FranÃ§ais (France)","French (France)"],5132:["fr-LU","FranÃ§ais (Luxembourg)","French (Luxembourg)"],6156:["fr-MC","FranÃ§ais (PrincipautÃ© de Monaco)","French (Principality of Monaco)"],4108:["fr-CH","FranÃ§ais (Suisse)","French (Switzerland)"],15372:["fr-HT","FranÃ§ais (HaÃ¯ti)","French (Haiti)"],9228:["fr-CG","FranÃ§ais (Congo-Brazzaville)","French (Congo)"],12300:["fr-CI","FranÃ§ais (CÃ´te dâIvoire)","French (Cote d'Ivoire)"],11276:["fr-CM","FranÃ§ais (Cameroun)","French (Cameroon)"],14348:["fr-MA","FranÃ§ais (Maroc)","French (Morocco)"],13324:["fr-ML","FranÃ§ais (Mali)","French (Mali)"],8204:["fr-RE","FranÃ§ais (La RÃ©union)","French (Reunion)"],10252:["fr-SN","FranÃ§ais (SÃ©nÃ©gal)","French (Senegal)"],7180:["fr-West","French"],98:["fy","Frysk"],1122:["fy-NL","Frysk (NederlÃ¢n)","Frisian (Netherlands)"],86:["gl","Galego"],1110:["gl-ES","Galego (Galego)","Galician (Galician)"],55:["ka","á¥áá áá£áá"],1079:["ka-GE","á¥áá áá£áá (á¡áá¥áá ááááá)","Georgian (Georgia)"],7:["de","Deutsch"],3079:["de-AT","Deutsch (Ãsterreich)","German (Austria)"],1031:["de-DE","Deutsch (Deutschland)","German (Germany)"],5127:["de-LI","Deutsch (Liechtenstein)","German (Liechtenstein)"],4103:["de-LU","Deutsch (Luxemburg)","German (Luxembourg)"],2055:["de-CH","Deutsch (Schweiz)","German (Switzerland)"],8:["el","ÎÎ»Î»Î·Î½Î¹ÎºÎ¬"],1032:["el-GR","ÎÎ»Î»Î·Î½Î¹ÎºÎ¬ (ÎÎ»Î»Î¬Î´Î±)","Greek (Greece)"],111:["kl","Kalaallisut"],1135:["kl-GL","Kalaallisut (Kalaallit Nunaat)","Greenlandic (Greenland)"],71:["gu","àªà«àªàª°àª¾àª¤à«"],1095:["gu-IN","àªà«àªàª°àª¾àª¤à« (àª­àª¾àª°àª¤)","Gujarati (India)"],104:["ha","Hausa"],31848:["ha-Latn","Hausa (Latin)"],1128:["ha-Latn-NG","Hausa (Nigeria)","Hausa (Latin, Nigeria)"],13:["he","×¢××¨××ªâ"],1037:["he-IL","×¢××¨××ª (××©×¨××)â","Hebrew (Israel)"],57:["hi","à¤¹à¤¿à¤à¤¦à¥"],1081:["hi-IN","à¤¹à¤¿à¤à¤¦à¥ (à¤­à¤¾à¤°à¤¤)","Hindi (India)"],14:["hu","Magyar"],1038:["hu-HU","Magyar (MagyarorszÃ¡g)","Hungarian (Hungary)"],15:["is","Ãslenska"],1039:["is-IS","Ãslenska (Ãsland)","Icelandic (Iceland)"],112:["ig","Igbo"],1136:["ig-NG","Igbo (Nigeria)","Igbo (Nigeria)"],33:["id","Bahasa Indonesia"],1057:["id-ID","Bahasa Indonesia (Indonesia)","Indonesian (Indonesia)"],93:["iu","Inuktitut"],31837:["iu-Latn","Inuktitut (Qaliujaaqpait)"],2141:["iu-Latn-CA","Inuktitut (Kanatami, kanata)","Inuktitut (Latin, Canada)"],30813:["iu-Cans","áááááá¦ (áááá®áá¸áá¦)"],1117:["iu-Cans-CA","áááááá¦ (á²ááá¥)","Inuktitut (Canada)"],60:["ga","Gaeilge"],2108:["ga-IE","Gaeilge (Ãire)","Irish (Ireland)"],52:["xh","isiXhosa"],1076:["xh-ZA","isiXhosa (uMzantsi Afrika)","isiXhosa (South Africa)"],53:["zu","isiZulu"],1077:["zu-ZA","isiZulu (iNingizimu Afrika)","isiZulu (South Africa)"],16:["it","Italiano"],1040:["it-IT","Italiano (Italia)","Italian (Italy)"],2064:["it-CH","Italiano (Svizzera)","Italian (Switzerland)"],17:["ja","æ¥æ¬èª"],1041:["ja-JP","æ¥æ¬èª (æ¥æ¬)","Japanese (Japan)"],75:["kn","à²à²¨à³à²¨à²¡"],1099:["kn-IN","à²à²¨à³à²¨à²¡ (à²­à²¾à²°à²¤)","Kannada (India)"],63:["kk","ÒÐ°Ð·Ð°Ò"],1087:["kk-KZ","ÒÐ°Ð·Ð°Ò (ÒÐ°Ð·Ð°ÒÑÑÐ°Ð½)","Kazakh (Kazakhstan)"],83:["km","ááááá"],1107:["km-KH","ááááá (ááááá»áá¶)","Khmer (Cambodia)"],134:["qut","K'iche"],1158:["qut-GT","K'iche (Guatemala)","K'iche (Guatemala)"],135:["rw","Kinyarwanda"],1159:["rw-RW","Kinyarwanda (Rwanda)","Kinyarwanda (Rwanda)"],65:["sw","Kiswahili"],1089:["sw-KE","Kiswahili (Kenya)","Kiswahili (Kenya)"],87:["kok","à¤à¥à¤à¤à¤£à¥"],1111:["kok-IN","à¤à¥à¤à¤à¤£à¥ (à¤­à¤¾à¤°à¤¤)","Konkani (India)"],18:["ko","íêµ­ì´"],1042:["ko-KR","íêµ­ì´ (ëíë¯¼êµ­)","Korean (Korea)"],64:["ky","ÐÑÑÐ³ÑÐ·"],1088:["ky-KG","ÐÑÑÐ³ÑÐ· (ÐÑÑÐ³ÑÐ·ÑÑÐ°Ð½)","Kyrgyz (Kyrgyzstan)"],84:["lo","àº¥àº²àº§"],1108:["lo-LA","àº¥àº²àº§ (àºª.àº.àº. àº¥àº²àº§)","Lao (Lao P.D.R.)"],38:["lv","LatvieÅ¡u"],1062:["lv-LV","LatvieÅ¡u (Latvija)","Latvian (Latvia)"],39:["lt","LietuviÅ³"],1063:["lt-LT","LietuviÅ³ (Lietuva)","Lithuanian (Lithuania)"],31790:["dsb","DolnoserbÅ¡Äina"],2094:["dsb-DE","DolnoserbÅ¡Äina (Nimska)","Lower Sorbian (Germany)"],110:["lb","LÃ«tzebuergesch"],1134:["lb-LU","LÃ«tzebuergesch (Luxembourg)","Luxembourgish (Luxembourg)"],1071:["mk-MK","ÐÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ ÑÐ°Ð·Ð¸Ðº (ÐÐ°ÐºÐµÐ´Ð¾Ð½Ð¸ÑÐ°)","Macedonian (Macedonia)"],47:["mk","ÐÐ°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ ÑÐ°Ð·Ð¸Ðº"],62:["ms","Bahasa Melayu"],2110:["ms-BN","Bahasa Melayu (Brunei Darussalam)","Malay (Brunei Darussalam)"],1086:["ms-MY","Bahasa Melayu (Malaysia)","Malay (Malaysia)"],76:["ml","à´®à´²à´¯à´¾à´³à´"],1100:["ml-IN","à´®à´²à´¯à´¾à´³à´ (à´­à´¾à´°à´¤à´)","Malayalam (India)"],58:["mt","Malti"],1082:["mt-MT","Malti (Malta)","Maltese (Malta)"],129:["mi","Reo MÄori"],1153:["mi-NZ","Reo MÄori (Aotearoa)","Maori (New Zealand)"],122:["arn","Mapudungun"],1146:["arn-CL","Mapudungun (Chile)","Mapudungun (Chile)"],78:["mr","à¤®à¤°à¤¾à¤ à¥"],1102:["mr-IN","à¤®à¤°à¤¾à¤ à¥ (à¤­à¤¾à¤°à¤¤)","Marathi (India)"],124:["moh","Kanien'kÃ©ha"],1148:["moh-CA","Kanien'kÃ©ha (Canada)","Mohawk (Canada)"],80:["mn","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ»"],30800:["mn-Cyrl","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ»"],1104:["mn-MN","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ» (ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÐ»Ñ)","Mongolian (Cyrillic, Mongolia)"],31824:["mn-Mong","á ®á ¤á ¨á ­á ­á ¤á ¯ á ¬á ¡á ¯á ¡"],2128:["mn-Mong-CN","á ®á ¤á ¨á ­á ­á ¤á ¯ á ¬á ¡á ¯á ¡ (á ªá ¦á ­á ¦á ³á ¡ á ¨á  á ¢á ·á  á ®á ³á  á ¬á ¤ á ³á ¤á ®á ³á  á ³á ¤ á  á ·á  á ³ á £á ¯á £á °)","Mongolian (People's Republic of China)"],97:["ne","à¤¨à¥à¤ªà¤¾à¤²à¥"],1121:["ne-NP","à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤¨à¥à¤ªà¤¾à¤²)","Nepali (Nepal)"],2145:["ne-IN","à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤­à¤¾à¤°à¤¤)","Nepali (India)"],20:["no","Norsk"],31764:["nb","Norsk (bokmÃ¥l)"],1044:["nb-NO","Norsk, bokmÃ¥l (Norge)","Norwegian, BokmÃ¥l (Norway)"],30740:["nn","Norsk (Nynorsk)"],2068:["nn-NO","Norsk, nynorsk (Noreg)","Norwegian, Nynorsk (Norway)"],130:["oc","Occitan"],1154:["oc-FR","Occitan (FranÃ§a)","Occitan (France)"],72:["or","à¬à­à¬¿à¬"],1096:["or-IN","à¬à­à¬¿à¬ (à¬­à¬¾à¬°à¬¤)","Oriya (India)"],99:["ps","Ù¾ÚØªÙâ"],1123:["ps-AF","Ù¾ÚØªÙ (Ø§ÙØºØ§ÙØ³ØªØ§Ù)â","Pashto (Afghanistan)"],41:["fa","ÙØ§Ø±Ø³Ùâ"],1065:["fa-IR","ÙØ§Ø±Ø³Ù (Ø§ÛØ±Ø§Ù)â","Persian (Iran)"],21:["pl","Polski"],1045:["pl-PL","Polski (Polska)","Polish (Poland)"],22:["pt","PortuguÃªs"],1046:["pt-BR","PortuguÃªs (Brasil)","Portuguese (Brazil)"],2070:["pt-PT","PortuguÃªs (Portugal)","Portuguese (Portugal)"],70:["pa","à¨ªà©°à¨à¨¾à¨¬à©"],1094:["pa-IN","à¨ªà©°à¨à¨¾à¨¬à© (à¨­à¨¾à¨°à¨¤)","Punjabi (India)"],107:["quz","Runasimi"],1131:["quz-BO","Runasimi (Qullasuyu)","Quechua (Bolivia)"],2155:["quz-EC","Runasimi (Ecuador)","Quechua (Ecuador)"],3179:["quz-PE","Runasimi (Piruw)","Quechua (Peru)"],24:["ro","RomÃ¢nÄ"],1048:["ro-RO","RomÃ¢nÄ (RomÃ¢nia)","Romanian (Romania)"],2072:["ro-MD","RomÃ¢nÄ (Moldova)","Romanian (Republic of Moldova)"],23:["rm","Rumantsch"],1047:["rm-CH","Rumantsch (Svizra)","Romansh (Switzerland)"],25:["ru","Ð ÑÑÑÐºÐ¸Ð¹"],1049:["ru-RU","Ð ÑÑÑÐºÐ¸Ð¹ (Ð Ð¾ÑÑÐ¸Ñ)","Russian (Russia)"],2073:["ru-MD","Ð ÑÑÑÐºÐ¸Ð¹ (ÐÐ¾Ð»Ð´Ð°Ð²Ð¸Ñ)","Russian (Republic of Moldova)"],28731:["smn","SÃ¤mikielÃ¢"],9275:["smn-FI","SÃ¤mikielÃ¢ (SuomÃ¢)","Sami (Inari, Finland)"],31803:["smj","JulevusÃ¡megiella"],4155:["smj-NO","JulevusÃ¡megiella (Vuodna)","Sami (Lule, Norway)"],5179:["smj-SE","JulevusÃ¡megiella (Svierik)","Sami (Lule, Sweden)"],59:["se","DavvisÃ¡megiella"],3131:["se-FI","DavvisÃ¡megiella (Suopma)","Sami (Northern, Finland)"],1083:["se-NO","DavvisÃ¡megiella (Norga)","Sami (Northern, Norway)"],2107:["se-SE","DavvisÃ¡megiella (RuoÅ§Å§a)","Sami (Northern, Sweden)"],29755:["sms","SÃ¤Ã¤mÂ´Ç©iÃµll"],8251:["sms-FI","SÃ¤Ã¤mÂ´Ç©iÃµll (LÃ¤Ã¤Â´ddjÃ¢nnam)","Sami (Skolt, Finland)"],30779:["sma","Ã¥arjelsaemiengiele"],6203:["sma-NO","Ã¥arjelsaemiengiele (NÃ¶Ã¶rje)","Sami (Southern, Norway)"],7227:["sma-SE","Ã¥arjelsaemiengiele (Sveerje)","Sami (Southern, Sweden)"],79:["sa","à¤¸à¤à¤¸à¥à¤à¥à¤¤"],1103:["sa-IN","à¤¸à¤à¤¸à¥à¤à¥à¤¤ (à¤­à¤¾à¤°à¤¤à¤®à¥)","Sanskrit (India)"],145:["gd","GÃ idhlig"],1169:["gd-GB","GÃ idhlig (An RÃ¬oghachd Aonaichte)","Scottish Gaelic (United Kingdom)"],31770:["sr","Srpski"],27674:["sr-Cyrl","Ð¡ÑÐ¿ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],7194:["sr-Cyrl-BA","Ð¡ÑÐ¿ÑÐºÐ¸ (ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°)","Serbian (Cyrillic, Bosnia and Herzegovina)"],12314:["sr-Cyrl-ME","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ°)","Serbian (Cyrillic, Montenegro)"],3098:["sr-Cyrl-CS","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¡ÑÐ±Ð¸ÑÐ° Ð¸ Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ° (ÐÑÐµÑÑÐ¾Ð´Ð½Ð¾))","Serbian (Cyrillic, Serbia and Montenegro (Former))"],10266:["sr-Cyrl-RS","Ð¡ÑÐ¿ÑÐºÐ¸ (Ð¡ÑÐ±Ð¸ÑÐ°)","Serbian (Cyrillic, Serbia)"],28698:["sr-Latn","Srpski (Latinica)"],6170:["sr-Latn-BA","Srpski (Bosna i Hercegovina)","Serbian (Latin, Bosnia and Herzegovina)"],11290:["sr-Latn-ME","Srpski (Crna Gora)","Serbian (Latin, Montenegro)"],2074:["sr-Latn-CS","Srpski (Srbija i Crna Gora (Prethodno))","Serbian (Latin, Serbia and Montenegro (Former))"],9242:["sr-Latn-RS","Srpski (Srbija, Latinica)","Serbian (Latin, Serbia)"],108:["nso","Sesotho sa Leboa"],1132:["nso-ZA","Sesotho sa Leboa (Afrika Borwa)","Sesotho sa Leboa (South Africa)"],50:["tn","Setswana"],1074:["tn-ZA","Setswana (Aforika Borwa)","Setswana (South Africa)"],91:["si","à·à·à¶à·"],1115:["si-LK","à·à·à¶à·à¶½ (à·à·âà¶»à· à¶½à¶à¶à·à·)","Sinhala (Sri Lanka)"],27:["sk","SlovenÄina"],1051:["sk-SK","SlovenÄina (SlovenskÃ¡ republika)","Slovak (Slovakia)"],36:["sl","Slovenski"],1060:["sl-SI","Slovenski (Slovenija)","Slovenian (Slovenia)"],10:["es","EspaÃ±ol"],11274:["es-AR","EspaÃ±ol (Argentina)","Spanish (Argentina)"],16394:["es-BO","EspaÃ±ol (Bolivia)","Spanish (Bolivia)"],13322:["es-CL","EspaÃ±ol (Chile)","Spanish (Chile)"],9226:["es-CO","EspaÃ±ol (Colombia)","Spanish (Colombia)"],5130:["es-CR","EspaÃ±ol (Costa Rica)","Spanish (Costa Rica)"],7178:["es-DO","EspaÃ±ol (RepÃºblica Dominicana)","Spanish (Dominican Republic)"],12298:["es-EC","EspaÃ±ol (Ecuador)","Spanish (Ecuador)"],17418:["es-SV","EspaÃ±ol (El Salvador)","Spanish (El Salvador)"],4106:["es-GT","EspaÃ±ol (Guatemala)","Spanish (Guatemala)"],18442:["es-HN","EspaÃ±ol (Honduras)","Spanish (Honduras)"],2058:["es-MX","EspaÃ±ol (MÃ©xico)","Spanish (Mexico)"],19466:["es-NI","EspaÃ±ol (Nicaragua)","Spanish (Nicaragua)"],6154:["es-PA","EspaÃ±ol (PanamÃ¡)","Spanish (Panama)"],15370:["es-PY","EspaÃ±ol (Paraguay)","Spanish (Paraguay)"],10250:["es-PE","EspaÃ±ol (PerÃº)","Spanish (Peru)"],20490:["es-PR","EspaÃ±ol (Puerto Rico)","Spanish (Puerto Rico)"],3082:["es-ES","EspaÃ±ol (EspaÃ±a, alfabetizaciÃ³n internacional)","Spanish (Spain)"],21514:["es-US","EspaÃ±ol (Estados Unidos)","Spanish (United States)"],14346:["es-UY","EspaÃ±ol (Uruguay)","Spanish (Uruguay)"],8202:["es-VE","EspaÃ±ol (Republica Bolivariana de Venezuela)","Spanish (Venezuela)"],1034:["es-ES_tradnl","Spanish"],22538:["es-419","EspaÃ±ol (AmÃ©rica Latina y el Caribe)","Spanish (Latin America and the Caribbean)"],23562:["es-CU","EspaÃ±ol (Cuba)","Spanish (Cuba)"],29:["sv","Svenska"],2077:["sv-FI","Svenska (Finland)","Swedish (Finland)"],1053:["sv-SE","Svenska (Sverige)","Swedish (Sweden)"],90:["syr","Ü£ÜÜªÜÜÜâ"],1114:["syr-SY","Ü£ÜÜªÜÜÜ (Ø³ÙØ±ÙØ§)â","Syriac (Syria)"],40:["tg","Ð¢Ð¾Ò·Ð¸ÐºÓ£"],31784:["tg-Cyrl","Ð¢Ð¾Ò·Ð¸ÐºÓ£"],1064:["tg-Cyrl-TJ","Ð¢Ð¾Ò·Ð¸ÐºÓ£ (Ð¢Ð¾Ò·Ð¸ÐºÐ¸ÑÑÐ¾Ð½)","Tajik (Cyrillic, Tajikistan)"],95:["tzm","Tamazight"],31839:["tzm-Latn","Tamazight (Latin)"],2143:["tzm-Latn-DZ","Tamazight (DjazaÃ¯r)","Tamazight (Latin, Algeria)"],73:["ta","à®¤à®®à®¿à®´à¯"],1097:["ta-IN","à®¤à®®à®¿à®´à¯ (à®à®¨à¯à®¤à®¿à®¯à®¾)","Tamil (India)"],68:["tt","Ð¢Ð°ÑÐ°Ñ"],1092:["tt-RU","Ð¢Ð°ÑÐ°Ñ (Ð Ð¾ÑÑÐ¸Ñ)","Tatar (Russia)"],74:["te","à°¤à±à°²à±à°à±"],1098:["te-IN","à°¤à±à°²à±à°à± (à°­à°¾à°°à°¤Â à°¦à±à°¶à°)","Telugu (India)"],30:["th","à¹à¸à¸¢"],1054:["th-TH","à¹à¸à¸¢ (à¹à¸à¸¢)","Thai (Thailand)"],81:["bo","à½à½¼à½à¼à½¡à½²à½"],1105:["bo-CN","à½à½¼à½à¼à½¡à½²à½ (à½à¾²à½´à½à¼à½§à¾­à¼à½à½²à¼à½à½à½à½¦à¼à½¦à¾¤à¾±à½²à¼à½à½à½´à½à¼à½¢à¾à¾±à½£à¼à½à½à¼)","Tibetan (People's Republic of China)"],2129:["bo-BT","Tibetan (Bhutan)","Tibetan (Bhutan)"],31:["tr","TÃ¼rkÃ§e"],1055:["tr-TR","TÃ¼rkÃ§e (TÃ¼rkiye)","Turkish (Turkey)"],66:["tk","TÃ¼rkmenÃ§e"],1090:["tk-TM","TÃ¼rkmenÃ§e (TÃ¼rkmenistan)","Turkmen (Turkmenistan)"],34:["uk","Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°"],1058:["uk-UA","Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ° (Ð£ÐºÑÐ°ÑÐ½Ð°)","Ukrainian (Ukraine)"],46:["hsb","HornjoserbÅ¡Äina"],1070:["hsb-DE","HornjoserbÅ¡Äina (NÄmska)","Upper Sorbian (Germany)"],32:["ur","Ø§ÙØ±Ø¯Ùâ"],1056:["ur-PK","Ø§ÙØ±Ø¯Ù (Ù¾Ø§Ú©Ø³ØªØ§Ù)â","Urdu (Islamic Republic of Pakistan)"],2080:["ur-IN","Ø§ÙØ±Ø¯Ù (Ø¨Ú¾Ø§Ø±Øª)â","Urdu (India)"],128:["ug","Ø¦ÛÙØºÛØ± ÙÛØ²ÙÙÙâ"],1152:["ug-CN","Ø¦ÛÙØºÛØ± ÙÛØ²ÙÙÙ (Ø¬ÛÚ­Ø®ÛØ§ Ø®ÛÙÙ Ø¬ÛÙÚ¾ÛØ±ÙÙÙØªÙ)â","Uighur (People's Republic of China)"],30787:["uz-Cyrl","ÐÐ·Ð±ÐµÐº"],2115:["uz-Cyrl-UZ","ÐÐ·Ð±ÐµÐº (ÐÐ·Ð±ÐµÐºÐ¸ÑÑÐ¾Ð½)","Uzbek (Cyrillic, Uzbekistan)"],67:["uz","U'zbek"],31811:["uz-Latn","U'zbek"],1091:["uz-Latn-UZ","U'zbek (U'zbekiston Respublikasi)","Uzbek (Latin, Uzbekistan)"],42:["vi","TiÃªÌng Viá»t"],1066:["vi-VN","TiÃªÌng Viá»t (Viá»t Nam)","Vietnamese (Vietnam)"],82:["cy","Cymraeg"],1106:["cy-GB","Cymraeg (y Deyrnas Unedig)","Welsh (United Kingdom)"],136:["wo","Wolof"],1160:["wo-SN","Wolof (SÃ©nÃ©gal)","Wolof (Senegal)"],133:["sah","Ð¡Ð°ÑÐ°"],1157:["sah-RU","Ð¡Ð°ÑÐ° (Ð Ð¾ÑÑÐ¸Ñ)","Yakut (Russia)"],120:["ii","êê ê±ê·"],1144:["ii-CN","êê ê±ê· (êê¸êê±ê­ê¼ê©)","Yi (People's Republic of China)"],106:["yo","Yoruba"],1130:["yo-NG","Yoruba (Nigeria)","Yoruba (Nigeria)"],1126:["bin-NG","Bini (Nigeria)","Bini (Nigeria)"],1116:["chr-US","á£á³á© (áá á¢á³á¾áµááá áá¦áá©)","Cherokee (United States)"],1127:["fuv-NG","Nigerian Fulfulde (Nigeria)","Nigerian Fulfulde (Nigeria)"],1138:["gaz-ET","West Central Oromo (Ethiopia)","West Central Oromo (Ethiopia)"],1140:["gn-PY","Guarani (Paraguay)","Guarani (Paraguay)"],1141:["haw-US","Ê»Ålelo HawaiÊ»i (Ê»Amelika Hui PÅ« Ê»Ia)","Hawaiian (United States)"],1129:["ibb-NG","Ibibio (Nigeria)","Ibibio (Nigeria)"],1137:["kr-NG","Kanuri (Nigeria)","Kanuri (Nigeria)"],1112:["mni","Manipuri","Manipuri"],1109:["my-MM","Burmese (Myanmar)","Burmese (Myanmar)"],1145:["pap-AN","Papiamento, Netherlands Antilles","Papiamento, Netherlands Antilles"],2118:["pa-PK","Panjabi (Pakistan)","Panjabi (Pakistan)"],1165:["plt-MG","Plateau Malagasy (Madagascar)","Plateau Malagasy (Madagascar)"],1113:["sd-IN","Sindhi (India)","Sindhi (India)"],2137:["sd-PK","Sindhi (Pakistan)","Sindhi (Pakistan)"],1143:["so-SO","Soomaali (Soomaaliya)","Somali (Somalia)"],1072:["st-ZA","Southern Sotho (South Africa)","Southern Sotho (South Africa)"],1139:["ti-ER","áµáá­á (á¤á­áµá«)","Tigrinya (Eritrea)"],2163:["ti-ET","áµáá­á (á¢áµá®áµá«)","Tigrinya (Ethiopia)"],1119:["tmz","Tamanaku"],3167:["tmz-MA","TamaziÉ£t n laá¹­laá¹£ (Meá¹á¹uk)","Tamanaku (Morocco)"],1073:["ts-ZA","Tsonga (South Africa)","Tsonga (South Africa)"],1075:["ven-ZA","South Africa","South Africa"]},e={ar:1025,az:1068,en:1033,sr:9242,zh:4},i=function(e){if(e)for(var i in t)if(t[i][0].toLowerCase()===e.toLowerCase())return i;return null};return{getLocalLanguageName:function(e){return t[e]||["",e]},getLocalLanguageCode:i,getLocalLanguageDisplayName:function(e){var i=t[e];if(i){var n=i[1],o=i[2];function s(t){let e=t.replace("(","â "),i=e.lastIndexOf(")");return-1!==i&&(e=e.slice(0,i)+e.slice(i+1)),e}return o?{native:s(n),english:s(o)}:{native:n,english:""}}return null},getDefaultLanguageCode:function(t){return t=t.toLowerCase(),e[t]?e[t]:(t+="-"+t.toUpperCase(),i(t))},getLanguages:function(){return t}}},define("common/main/lib/util/LanguageInfo",(function(){})),define("common/main/lib/component/Tooltip",["tip","backbone"],(function(){"use strict";var t=function(t){this.$element=this.placement=void 0,this.init.call(this,t)};_.extend(t.prototype,Backbone.Events,{init:function(t){if(this.$element=t.owner instanceof Backbone.View?t.owner.$el:$(t.owner),this.placement=t.placement,this.$element.data("bs.tooltip")&&this.$element.removeData("bs.tooltip"),this.$element.tooltip({title:t.title,trigger:"manual",placement:t.placement,offset:t.offset,cls:t.cls,html:t.html,hideonclick:t.hideonclick,keepvisible:t.keepvisible}),t.hideonclick){var e=this,i=this.$element.data("bs.tooltip");i&&i.tip().on("click",(function(){i.hide(),e.trigger("tooltip:hideonclick",this)}))}this.$element.on("shown.bs.tooltip",_.bind(this.onTipShown,this)),this.$element.on("hidden.bs.tooltip",_.bind(this.onTipHidden,this))},show:function(t){this.getBSTip().show(t)},hide:function(t){this.getBSTip().hide(t)},setTitle:function(t){var e=this.getBSTip();e&&(e.options.title=t)},updateTitle:function(){var t=this.getBSTip();t.$tip.find(".tooltip-inner")[t.options.html?"html":"text"](t.options.title)},getBSTip:function(){return this.$element.data("bs.tooltip")},onTipShown:function(){this.trigger("tooltip:show",this)},onTipHidden:function(){this.trigger("tooltip:hide",this)},isVisible:function(){return this.getBSTip().tip().is(":visible")}}),Common.UI=Common.UI||{},Common.UI.Tooltip=t})),void 0===Common)var Common={};if(define("common/main/lib/component/InputField",["common/main/lib/component/BaseView","common/main/lib/component/Tooltip","common/main/lib/component/Button"],(function(){"use strict";Common.UI.InputField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,hideErrorOnInput:!1},template:_.template(['<div class="input-field" style="<%= style %>">',"<input ",'type="<%= type %>" ','name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','data-hint="<%= dataHint %>"','data-hint-direction="<%= dataHintDirection %>"','data-hint-offset="<%= dataHintOffset %>"',">",'<span class="input-error"></span>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.type=e.options.type,this.name=e.options.name,this.validation=e.options.validation,this.allowBlank=e.options.allowBlank,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.editable=e.options.editable,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.blankError=e.options.blankError||e.txtEmpty,this.validateOnChange=e.options.validateOnChange,this.validateOnBlur=e.options.validateOnBlur,this.maxLength=e.options.maxLength,this.hideErrorOnInput=e.options.hideErrorOnInput,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._input=this.cmpEl.find("input").addBack().filter("input").first(),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n});var o=this.options.ariaLabel?this.options.ariaLabel:this.placeHolder;o&&this._input.attr("aria-label",o)}return e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),n=this.value;this.trigger("changed:before",this,i,n,t),t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changed:after",this,i,n,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onInputChanging:function(t,e){var i=$(t.target).val(),n=this.value;t.isDefaultPrevented()||(this.value=i,this.validateOnBlur&&this.checkValidate(),this.trigger("changing",this,i,n,t))},onKeyPress:function(t){if(this.trigger("keypress:before",this,t),!t.isDefaultPrevented()){if(this.options.maskExp&&!_.isEmpty(this.options.maskExp.source)){var e=String.fromCharCode(t.which);this.options.maskExp.test(e)||t.ctrlKey||t.keyCode===Common.UI.Keys.RETURN||(t.preventDefault(),t.stopPropagation())}this.trigger("keypress:after",this,t)}},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&this._doChange(t),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode!=Common.UI.Keys.RETURN&&t.keyCode!=Common.UI.Keys.ESC||this.trigger("inputleave",this))},onKeyUp:function(t){this.trigger("keyup:before",this,t),t.isDefaultPrevented()||this.trigger("keyup:after",this,t)},setEditable:function(t){var e=this._input;this.editable=t,t&&e?(e.removeAttr("readonly"),e.removeAttr("data-can-copy")):(e.attr("readonly","readonly"),e.attr("data-can-copy",!1))},isEditable:function(){return this.editable},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),this._input&&(t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"))},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input&&this._input.focus()},checkValidate:function(){var t=this,e=[];if(!t.allowBlank&&_.isEmpty(t.value)&&e.push(t.blankError),_.isFunction(t.validation)){var i=t.validation.call(t,t.value);!0!==i&&(e=_.flatten(e.concat(i)))}if(!_.isEmpty(e)){if(t.cmpEl.hasClass("error"))return(n=t.cmpEl.find(".input-error").data("bs.tooltip"))&&(n.options.title=e.join("\n"),n.setContent()),e;t.cmpEl.addClass("error");var n,o=t.cmpEl.find(".input-error"),s=o.closest(".asc-window");return(n=o.data("bs.tooltip"))&&n.tip().remove(),o.attr("data-toggle","tooltip"),o.removeData("bs.tooltip"),o.tooltip({title:e.join("\n"),placement:"cursor"}),s.length>0&&o.data("bs.tooltip").tip().css("z-index",parseInt(s.css("z-index"))+10),t.hideErrorOnInput&&t._input.one("input",(function(){t.showError()})),e}return t.cmpEl.removeClass("error"),!0},showError:function(t,e){var i=this;if(_.isEmpty(t))i.cmpEl.removeClass("error"),i.cmpEl.removeClass("warning");else{i.cmpEl.addClass(e?"warning":"error");var n=i.cmpEl.find(".input-error"),o=n.closest(".asc-window"),s=n.data("bs.tooltip");s&&s.tip().remove(),n.attr("data-toggle","tooltip"),n.removeData("bs.tooltip"),n.tooltip({title:t.join("\n"),placement:"cursor"}),o.length>0&&n.data("bs.tooltip").tip().css("z-index",parseInt(o.css("z-index"))+10),i.hideErrorOnInput&&i._input.one("input",(function(){i.showError()}))}},showWarning:function(t){this.showError(t,!0)},txtEmpty:"This field is required"}),Common.UI.InputFieldBtn=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-select-range",btnHint:""},template:_.template(['<div class="input-field input-field-btn" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<div class="select-button"></div>',"</div>"].join("")),render:function(t){var e=this;if(e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,value:this.value,type:this.type,name:this.name,placeHolder:this.placeHolder,spellcheck:this.spellcheck,scope:e,dataHint:this.options.dataHint,dataHintOffset:this.options.dataHintOffset,dataHintDirection:this.options.dataHintDirection})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;if(this._button=new Common.UI.Button({cls:"btn-toolbar",iconCls:this.options.iconCls,hint:this.options.btnHint||"",menu:this.options.menu}),this._button.render(this.cmpEl.find(".select-button")),this._button.on("click",_.bind(this.onButtonClick,this)),this._input=this.cmpEl.find("input").addBack().filter("input"),this.editable&&(this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keypress",_.bind(this.onKeyPress,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this._input.on("keyup",_.bind(this.onKeyUp,this)),this.validateOnChange&&this._input.on("input",_.bind(this.onInputChanging,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength)),this.setEditable(this.editable),this.disabled&&this.setDisabled(this.disabled),this._input.closest(".asc-window").length>0)var n=function(){var t=i.find(".input-error").data("bs.tooltip");t&&t.tip().remove(),Common.NotificationCenter.off({"modal:close":n})};Common.NotificationCenter.on({"modal:close":n});var o=this.options.ariaLabel?this.options.ariaLabel:this.placeHolder;o&&this._input.attr("aria-label",o)}return e.rendered=!0,e.value&&e.setValue(e.value),this},onButtonClick:function(t,e){this.trigger("button:click",this,e)},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled"),this._button.setDisabled(t)},setBtnDisabled:function(t){this._button.setDisabled(t)},updateBtnHint:function(t){this.options.hint=t,this.rendered&&this._button.updateHint(this.options.hint)}}),Common.UI.InputFieldBtnPassword=Common.UI.InputFieldBtn.extend(_.extend({options:{id:null,cls:"",style:"",value:"",name:"",type:"password",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,showCls:"toolbar__icon btn-sheet-view",hideCls:"toolbar__icon btn-hide-password",btnHint:"",repeatInput:null,showPwdOnClick:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||(t.showPwdOnClick?this.textHintShowPwd:this.textHintHold),t.iconCls=t.showCls||this.options.showCls,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.hidePwd=!0,this.repeatInput=this.options.repeatInput},render:function(t){return Common.UI.InputFieldBtn.prototype.render.call(this,t),this._btnElm=this._button.$el,this.options.showPwdOnClick?this._button.on("click",_.bind(this.passwordClick,this)):this._btnElm.on("mousedown",_.bind(this.passwordShow,this)),this},passwordClick:function(t){this.hidePwd?(this.passwordShow(t),this.hidePwd=!1):(this.passwordHide(t),this.hidePwd=!0);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout((function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n}),1)},passwordShow:function(t){this.disabled||(this._button.setIconCls(this.options.hideCls),this.type="text",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick?this._button.updateHint(this.textHintHidePwd):(this._btnElm.on("mouseup",_.bind(this.passwordHide,this)),this._btnElm.on("mouseout",_.bind(this.passwordHide,this))))},passwordHide:function(t){if(this._button.setIconCls(this.options.showCls),this.type="password",this._input.attr("type",this.type),this.repeatInput&&(this.repeatInput.type=this.type,this.repeatInput._input.attr("type",this.type)),this.options.showPwdOnClick)this._button.updateHint(this.textHintShowPwd);else{this._btnElm.off("mouseup",this.passwordHide),this._btnElm.off("mouseout",this.passwordHide);var e=this,i=e._input[0].selectionStart,n=e._input[0].selectionEnd;setTimeout((function(){e.focus(),e._input[0].selectionStart=i,e._input[0].selectionEnd=n}),1)}},textHintShowPwd:"Show password",textHintHidePwd:"Hide password",textHintHold:"Press and hold to show password"},Common.UI.InputFieldBtnPassword||{})),Common.UI.InputFieldBtnCalendar=Common.UI.InputFieldBtn.extend({options:{id:null,cls:"",style:"",value:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,iconCls:"toolbar__icon btn-date",btnHint:"",menu:!0},initialize:function(t){(t=t||{}).btnHint=t.btnHint||this.textDate,Common.UI.InputFieldBtn.prototype.initialize.call(this,t),this.dateValue=void 0},render:function(t){var e=this;Common.UI.InputFieldBtn.prototype.render.call(this,t);var i="id-"+Common.UI.getId()+"input-field-datetime",n=new Common.UI.Menu({menuAlign:"tr-br",style:"border: none; padding: 0;",items:[{template:_.template('<div id="'+i+'" style=""></div>'),stopPropagation:!0}]});$("button",this._button.cmpEl).addClass("no-caret"),this._button.setMenu(n),this._button.menu.on("show:after",(function(t){e.cmpCalendar||(e.cmpCalendar=new Common.UI.Calendar({el:e.cmpEl.find("#"+i),enableKeyEvents:!0,firstday:1}),e.cmpCalendar.on("date:click",(function(i,n){e.dateValue=n,e.trigger("date:click",e,n),t.hide()})),e.dateValue&&e.cmpCalendar.setDate(e.dateValue),t.alignPosition()),e.cmpCalendar.focus()})),this._input.on("input",(function(){e.dateValue=void 0}))},setDate:function(t){t&&t instanceof Date&&!isNaN(t)&&(this.cmpCalendar&&this.cmpCalendar.setDate(t),this.dateValue=t)},getDate:function(){return this.dateValue},textDate:"Select date"}),Common.UI.InputFieldFixed=Common.UI.InputField.extend({options:{id:null,cls:"",style:"",value:"",fixedValue:"",fixedWidth:"",fixedCls:"",type:"text",name:"",validation:null,allowBlank:!0,placeHolder:"",blankError:null,spellcheck:!1,maskExp:"",validateOnChange:!1,validateOnBlur:!0,disabled:!1,editable:!0,btnHint:""},template:_.template(['<div class="input-field input-field-fixed" style="<%= style %>">',"<input ","type=<%= type %> ",'name="<%= name %>" ','spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ','value="<%= value %>"','data-hint="<%= dataHint %>"','data-hint-offset="<%= dataHintOffset %>"','data-hint-direction="<%= dataHintDirection %>"',">",'<span class="input-error"></span>','<input class="fixed-text form-control" type="text" readonly="readonly"></div>'].join("")),initialize:function(t){this.fixedValue=t.fixedValue,this.fixedWidth=t.fixedWidth||"calc(50% + 4px)",this.fixedCls=t.fixedCls||"",Common.UI.InputField.prototype.initialize.call(this,t)},render:function(t){return Common.UI.InputField.prototype.render.call(this,t),this._input.css({"padding-left":Common.UI.isRTL()?this.fixedWidth:0,"padding-right":Common.UI.isRTL()?0:this.fixedWidth}),this.cmpEl.find("input.fixed-text").css({width:this.fixedWidth}).addClass(this.fixedCls),this.fixedValue&&this.setFixedValue(this.fixedValue),this},setFixedValue:function(t){this.fixedValue=t,this.rendered&&this.cmpEl.find("input.fixed-text").addBack().filter("input.fixed-text").val(t)},setDisabled:function(t){if(t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),this.cmpEl){var e=this.cmpEl.find("input").addBack().filter("input");t?e.attr("disabled",!0):e.removeAttr("disabled")}}})})),define("visioeditor/main/app/controller/Statusbar",["core","visioeditor/main/app/view/Statusbar","common/main/lib/util/LanguageInfo","common/main/lib/component/InputField"],(function(){"use strict";VE.Controllers.Statusbar=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["Statusbar"],initialize:function(){var t=this;this.addListeners({Statusbar:{"show:tab":_.bind(this.showTab,this)},ViewTab:{"statusbar:hide":_.bind(t.onChangeCompactView,t),"statusbar:setcompact":_.bind(t.onChangeViewMode,t)}}),this._state={zoom_type:void 0,zoom_percent:void 0}},events:function(){return{"click #status-btn-zoomdown":_.bind(this.zoomDocument,this,"down"),"click #status-btn-zoomup":_.bind(this.zoomDocument,this,"up"),"click .cnt-zoom":_.bind(this.onZoomShow,this)}},onLaunch:function(){this.statusbar=this.createView("Statusbar").render(),this.statusbar.$el.css("z-index",10),this.statusbar.labelZoom.css("min-width",80),this.statusbar.labelZoom.text(Common.Utils.String.format(this.zoomText,100)),this.statusbar.btnZoomToPage.on("click",_.bind(this.onBtnZoomTo,this,"topage")),this.statusbar.btnZoomToWidth.on("click",_.bind(this.onBtnZoomTo,this,"towidth")),this.statusbar.zoomMenu.on("item:click",_.bind(this.menuZoomClick,this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},onAppReady:function(t){var e=this;e._isDocReady=!0,new Promise((function(t){t()})).then((function(){e.bindViewEvents(e.statusbar,e.events),e.statusbar.update()}))},onChangeCompactView:function(t,e){this.statusbar.setVisible(!e),Common.localStorage.setBool("ve-hidden-status",e),"slot-btn-options"===t.$el.closest(".btn-slot").prop("id")&&this.statusbar.fireEvent("view:hide",[this,e]),Common.NotificationCenter.trigger("layout:changed","status"),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this._onZoomChange,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiDisconnect,this)),this.api.asc_registerCallback("asc_onCurrentPage",_.bind(this.onCurrentPage,this)),this.statusbar.setApi(t)},onBtnZoomTo:function(t,e,i){this._state.zoom_type=void 0,this._state.zoom_percent=void 0,e.pressed?this.api["topage"==t?"zoomFitToPage":"zoomFitToWidth"]():this.api.zoomCustomMode(),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},zoomDocument:function(t,e){switch(this._state.zoom_type=void 0,this._state.zoom_percent=void 0,t){case"up":this.api.zoomIn();break;case"down":this.api.zoomOut()}Common.NotificationCenter.trigger("edit:complete",this.statusbar)},menuZoomClick:function(t,e){this._state.zoom_type=void 0,this._state.zoom_percent=void 0,this.api.zoom(e.value),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},onZoomShow:function(t){if(t.target.classList.contains("disabled"))return!1},_onZoomChange:function(t,e){if(this._state.zoom_type!==e&&(this.statusbar.btnZoomToPage.toggle(2==e,!0),this.statusbar.btnZoomToWidth.toggle(1==e,!0),this._state.zoom_type=e),this._state.zoom_percent!==t){if(this.statusbar.labelZoom.text(Common.Utils.String.format(this.zoomText,t)),this._state.zoom_percent=t,!this._isDocReady)return;var i=void 0!==this._state.zoom_type?2==this._state.zoom_type?-1:1==this._state.zoom_type?-2:t:t;Common.localStorage.setItem("ve-last-zoom",i),Common.Utils.InternalSettings.set("ve-last-zoom",i)}},setStatusCaption:function(t,e,i,n){this.timerCaption&&(new Date<this.timerCaption||0==t.length)&&!e||(this.timerCaption=void 0,t.length?(this.statusbar.showStatusMessage(t),n&&n(),i>0&&(this.timerCaption=(new Date).getTime()+i)):this.statusbar.clearStatusMessage())},createDelayedElements:function(){this.statusbar.$el.css("z-index",""),Common.UI.LayoutManager.isElementVisible("statusBar-actionStatus")||this.statusbar.boxAction.addClass("hide"),Common.NotificationCenter.on("window:resize",_.bind(this.onWindowResize,this))},onWindowResize:function(t){this.statusbar.updateTabbarBorders(),this.statusbar.onTabInvisible(void 0,this.statusbar.tabbar.checkInvisible(!0))},showTab:function(t){this.api&&this._state.pageCurrent!==t&&this.api.goToPage(t);var e=this;setTimeout((function(){e.statusbar.sheetListMenu.hide()}),1)},showDisconnectTip:function(t){var e=this;if(t=t||this.textDisconnect,this.disconnectTip)this.disconnectTip.setText(t);else{var i=this.statusbar.getStatusLabel();i=i.is(":visible")?i.parent():this.statusbar.isVisible()?this.statusbar.$el:$(document.body),this.disconnectTip=new Common.UI.SynchronizeTip({target:i,text:t,placement:"top",position:this.statusbar.isVisible()?void 0:{bottom:0},showLink:!1,style:"max-width: 310px;"}),this.disconnectTip.on({closeclick:function(){e.disconnectTip.hide(),e.disconnectTip=null}})}this.disconnectTip.show()},hideDisconnectTip:function(){this.disconnectTip&&this.disconnectTip.hide(),this.disconnectTip=null},onApiDisconnect:function(){this.SetDisabled(!0)},SetDisabled:function(t){this.statusbar.setMode({isDisconnected:t}),this.statusbar.update()},onCurrentPage:function(t){this.statusbar.sheetListMenu.hide(),this.statusbar.sheetListMenu.items[t]&&(this.statusbar.sheetListMenu.clearAll(),this.statusbar.sheetListMenu.items[t].setChecked(!0));var e=_.findWhere(this.statusbar.tabbar.tabs,{sheetindex:t});e&&this.statusbar.tabbar.setActive(e)},onChangeViewMode:function(t,e,i){this.statusbar.fireEvent("view:compact",[this.statusbar,e]),!i&&Common.localStorage.setBool("ve-compact-statusbar",e),Common.NotificationCenter.trigger("layout:changed","status"),this.statusbar.onChangeCompact(e),Common.NotificationCenter.trigger("edit:complete",this.statusbar)},zoomText:"Zoom {0}%",textDisconnect:"<b>Connection is lost</b><br>Trying to connect. Please check connection settings."},VE.Controllers.Statusbar||{}))})),function(t){var e,i,n,o={},s={16:!1,18:!1,17:!1,91:!1},a="all",r={"â§":16,shift:16,"â¥":18,alt:18,option:18,"â":17,ctrl:17,control:17,"â":91,command:91},l={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,"ff-":173,"ff=":61,numplus:107,numminus:109,0:48},c=function(t){return l[t]||t.toUpperCase().charCodeAt(0)},h=[];for(e=1;e<20;e++)l["f"+e]=111+e;function d(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function u(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var m={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function p(t){for(e in s)s[e]=t[m[e]]}function f(t,e,i){var n,s;n=b(t),void 0===i&&(i=e,e="all");for(var a=0;a<n.length;a++)s=[],(t=n[a].split("+")).length>1&&(s=v(t),t=[t[t.length-1]]),t=t[0],(t=c(t))in o||(o[t]=[]),o[t].push({shortcut:n[a],scope:e,method:i,key:n[a],mods:s})}for(e in r)f[e]=!1;function g(){return a||"all"}function b(t){var e;return""==(e=(t=t.replace(/\s/g,"")).split(","))[e.length-1]&&(e[e.length-2]+=","),e}function v(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=r[e[i]];return e}function C(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,(function(){i(window.event)}))}C(document,"keydown",(function(t){!function(t){var e,a,l,c,u,m;if(e=t.keyCode,Common.UI.HintManager&&Common.UI.HintManager.isHintVisible())if(112===e)Common.UI.HintManager.clearHints();else if(27!==e)return;if(-1==d(h,e)&&h.push(e),93!=e&&224!=e||(e=91),e in s)for(l in s[e]=!0,r)r[l]==e&&(f[l]=!0);else if(p(t),f.filter.call(this,t)&&e in o)for(m=g(),c=0;c<o[e].length;c++)if((a=o[e][c]).scope==m||"all"==a.scope){for(l in u=a.mods.length>0,s)(!s[l]&&d(a.mods,+l)>-1||s[l]&&-1==d(a.mods,+l))&&(u=!1);if((0==a.mods.length&&!s[16]&&!s[18]&&!s[17]&&!s[91]||u)&&(!0===i||a.locked||!1===a.method(t,a))){if(!0===i&&n||a.locked&&a.propagate)continue;t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)}}}(t)})),C(document,"keyup",(function(t){var e,i=t.keyCode,n=d(h,i);if(n>=0&&h.splice(n,1),93!=i&&224!=i||(i=91),i in s)for(e in s[i]=!1,r)r[e]==i&&(f[e]=!1)})),C(window,"focus",(function(){for(e in s)s[e]=!1;for(e in r)f[e]=!1}));var w=t.key;function y(t,e,i,n){for(var s,a,r,l=[],h=b(t),d=h.length;d--;)if((s=h[d].split("+")).length>1&&(l=v(s)),s.length>0&&(t=s[s.length-1]),t=c(t),void 0===e&&(e=g()),o[t])for(a in o[t])(r=o[t][a]).scope===e&&u(r.mods,l)&&(o[t][a][i]=n)}t.key=f,t.key.setScope=function(t){a=t||"all"},t.key.getScope=g,t.key.deleteScope=function(t){var e,i,n;for(e in o)for(i=o[e],n=0;n<i.length;)i[n].scope===t?i.splice(n,1):n++},t.key.filter=function(t){var e=(t.target||t.srcElement).tagName;return!("INPUT"==e||"SELECT"==e||"TEXTAREA"==e)},t.key.isPressed=function(t){return"string"==typeof t&&(t=c(t)),-1!=d(h,t)},t.key.getPressedKeyCodes=function(){return h.slice(0)},t.key.noConflict=function(){var e=t.key;return t.key=w,e},t.key.unbind=function(t,e){var i,n,s,a,r,l=[];for(i=b(t),a=0;a<i.length;a++){if((n=i[a].split("+")).length>1&&(l=v(n)),n.length>0&&(t=n[n.length-1]),t=c(t),void 0===e&&(e=g()),!o[t])return;for(s in o[t])(r=o[t][s]).scope===e&&u(r.mods,l)&&(o[t][s]={})}},t.key.suspend=function(t,e,o){t?(y(t,e,"locked",!0),o&&y(t,e,"propagate",!0)):(i=!0,o&&(n=!0))},t.key.resume=function(t,e){t?(y(t,e,"locked",!1),y(t,e,"propagate",!1)):i=n=!1},"undefined"!=typeof module&&(module.exports=key)}(this),define("keymaster",(function(){})),void 0===Common)var Common={};if(Common.util=Common.util||{},define("common/main/lib/util/Shortcuts",["backbone","keymaster","notification"],(function(t){"use strict";var e=function(t){return this.cid=_.uniqueId("shortcuts"),this.initialize.apply(this,arguments),this};_.extend(e.prototype,t.Events,{initialize:function(){window.key.filter=function(t){return!0},Common.NotificationCenter.on({"modal:show":function(t){window.key.suspend()},"modal:close":function(t,e){e&&window.key.resume()},"modal:hide":function(t,e){e&&window.key.resume()}})},delegateShortcuts:function(t){if(t&&t.shortcuts){var e,i,n,o,s,a;this.removeShortcuts(t);var r=[];for(s in t.shortcuts){if(e=t.shortcuts[s],_.isFunction(e))n=e;else if(!(n=t[e]))throw new Error("Method "+e+" does not exist");a=(i=s.match(/^(\S+)\s*(.*)$/))[1],o=i[2].length?i[2]:"all",n=_.bind(n,this),r.push(window.key(a,o,n))}}},removeShortcuts:function(t){if(t&&t.shortcuts){var e,i,n,o;for(n in t.shortcuts)o=(e=n.match(/^(\S+)\s*(.*)$/))[1],i=e[2].length?e[2]:"all",window.key.unbind(o,i)}},suspendEvents:function(t,e,i){window.key.suspend(t,e,i)},resumeEvents:function(t,e){window.key.resume(t,e)}}),e.extend=t.View.extend,Common.util.Shortcuts=new e})),define("visioeditor/main/app/view/ViewTab",["common/main/lib/util/utils","common/main/lib/component/BaseView","common/main/lib/component/Layout"],(function(){"use strict";VE.Views.ViewTab=Common.UI.BaseView.extend(_.extend({options:{},setEvents:function(){var t=this;t.btnFitToSlide&&t.btnFitToSlide.on("click",(function(){t.fireEvent("zoom:toslide",[t.btnFitToSlide])})),t.btnFitToWidth&&t.btnFitToWidth.on("click",(function(){t.fireEvent("zoom:towidth",[t.btnFitToWidth])})),t.chToolbar&&t.chToolbar.on("change",_.bind((function(e,i){t.fireEvent("toolbar:setcompact",[t.chToolbar,"checked"!==i])}),t)),t.chStatusbar&&t.chStatusbar.on("change",_.bind((function(e,i){t.fireEvent("statusbar:hide",[t.chStatusbar,"checked"!==i])}),t)),t.cmbZoom.on("selected",(function(e,i){t.fireEvent("zoom:selected",[e,i])})).on("changed:before",(function(e,i){t.fireEvent("zoom:changedbefore",[!0,e,i])})).on("changed:after",(function(e,i){t.fireEvent("zoom:changedafter",[!1,e,i])})).on("combo:blur",(function(){t.fireEvent("editcomplete",t)})).on("combo:focusin",_.bind(this.onComboOpen,this,!1)).on("show:after",_.bind(this.onComboOpen,this,!0)),t.chLeftMenu.on("change",_.bind((function(e,i){t.fireEvent("leftmenu:hide",[t.chLeftMenu,"checked"===i])}),t))},initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this),this.toolbar=t.toolbar,this.appConfig=t.mode;var e=Common.enumLock;this.lockedControls=[],this.cmbZoom=new Common.UI.ComboBox({cls:"input-group-nr",menuStyle:"min-width: 55px;",editable:!0,lock:[e.disableOnStart],data:[{displayValue:"50%",value:50},{displayValue:"75%",value:75},{displayValue:"100%",value:100},{displayValue:"125%",value:125},{displayValue:"150%",value:150},{displayValue:"175%",value:175},{displayValue:"200%",value:200},{displayValue:"300%",value:300},{displayValue:"400%",value:400},{displayValue:"500%",value:500}],dataHint:"1",dataHintDirection:"top",dataHintOffset:"small"}),this.cmbZoom.setValue(100),this.lockedControls.push(this.cmbZoom),this.btnFitToSlide=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtoslide",caption:this.textFitPage,lock:[e.disableOnStart],toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnFitToSlide),this.btnFitToWidth=new Common.UI.Button({cls:"btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtowidth",caption:this.textFitWidth,lock:[e.disableOnStart],toggleGroup:"view-zoom",enableToggle:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"medium"}),this.lockedControls.push(this.btnFitToWidth),this.btnInterfaceTheme=new Common.UI.Button({cls:"btn-toolbar x-huge icon-top",iconCls:"toolbar__icon btn-day",caption:this.textInterfaceTheme,lock:[e.disableOnStart],menu:!0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small",action:"interface-theme"}),this.lockedControls.push(this.btnInterfaceTheme),this.chStatusbar=new Common.UI.CheckBox({labelText:this.textStatusBar,value:!Common.localStorage.getBool("ve-hidden-status"),lock:[e.disableOnStart],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chStatusbar),this.chToolbar=new Common.UI.CheckBox({labelText:this.textAlwaysShowToolbar,value:!t.compactToolbar,lock:[e.disableOnStart],dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chToolbar),this.chLeftMenu=new Common.UI.CheckBox({lock:[e.disableOnStart],labelText:Common.UI.isRTL()?this.textRightMenu:this.textLeftMenu,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.lockedControls.push(this.chLeftMenu),Common.UI.LayoutManager.addControls(this.lockedControls),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this))},render:function(t){return t&&t.html(this.getPanel()),this},getPanel:function(){this.$el=$(_.template('<section class="panel" data-tab="view" role="tabpanel" aria-labelledby="view"><div class="group small"><div class="elset" style="display: flex;"><span class="btn-slot" id="slot-field-zoom" style="flex-grow: 1;"></span></div><div class="elset" style="text-align: center;"><span class="btn-slot text font-size-normal" id="slot-lbl-zoom" style="text-align: center;margin-top: 4px;"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-btn-fts" style="text-align: center;"></span></div><div class="elset"><span class="btn-slot text" id="slot-btn-ftw" style="text-align: center;"></span></div></div><div class="separator long"></div><div class="group"><span class="btn-slot text x-huge" id="slot-btn-interface-theme"></span></div><div class="separator long separator-theme"></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-toolbar"></span></div><div class="elset"><span class="btn-slot text" id="slot-chk-statusbar"></span></div></div><div class="group small"><div class="elset"><span class="btn-slot text" id="slot-chk-leftmenu"></span></div><div class="elset"></div></div></section>')({}));var t=this.$el;return this.cmbZoom.render(t.find("#slot-field-zoom")),t.find("#slot-lbl-zoom").text(this.textZoom),this.btnFitToSlide.render(t.find("#slot-btn-fts")),this.btnFitToWidth.render(t.find("#slot-btn-ftw")),this.btnInterfaceTheme.render(t.find("#slot-btn-interface-theme")),this.chStatusbar.render(t.find("#slot-chk-statusbar")),this.chToolbar.render(t.find("#slot-chk-toolbar")),this.chLeftMenu.render(t.find("#slot-chk-leftmenu")),this.$el},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){e.btnFitToSlide.updateHint(e.tipFitPage),e.btnFitToWidth.updateHint(e.tipFitWidth),e.btnInterfaceTheme.updateHint(e.tipInterfaceTheme),Common.UI.Themes.available()||(e.btnInterfaceTheme.$el.closest(".group").remove(),e.$el.find(".separator-theme").remove());var i=[];if((t.canBrandingExt&&t.customization&&!1===t.customization.statusBar||!Common.UI.LayoutManager.isElementVisible("statusBar"))&&(i.push(e.chStatusbar.$el.closest(".elset")),e.chStatusbar.$el.remove()),t.canBrandingExt&&t.customization&&!1===t.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")?(i.push(e.chLeftMenu.$el.closest(".elset")),e.chLeftMenu.$el.remove()):i.length>0&&(i.push(e.chLeftMenu.$el.closest(".elset")),i.shift().append(e.chLeftMenu.$el[0])),i.length>1&&i[i.length-1].closest(".group").remove(),Common.UI.Themes.available()){function o(){let t=this.btnInterfaceTheme;"object"==typeof t.menu?t.menu.removeAll(!0):t.setMenu(new Common.UI.Menu);var e=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId(),i=0;for(var n in Common.UI.Themes.map())t.menu.insertItem(i++,{value:n,caption:Common.UI.Themes.get(n).text,checked:n===e,checkable:!0,toggleGroup:"interface-theme"})}Common.NotificationCenter.on("uitheme:countchanged",o.bind(e)),o.call(e),e.btnInterfaceTheme.menu.getItemsLength(!0)&&e.btnInterfaceTheme.menu.on("item:click",_.bind((function(t,e){var i=e.value;Common.UI.Themes.setTheme(i)}),e))}var n=Common.UI.LayoutManager.getInitValue("leftMenu");n=void 0!==n&&!n,e.chLeftMenu.setValue(!Common.localStorage.getBool("ve-hidden-leftmenu",n)),e.setEvents(),"view"===Common.Utils.InternalSettings.get("toolbar-active-tab")&&Common.NotificationCenter.trigger("tab:set-active","view")}))},show:function(){Common.UI.BaseView.prototype.show.call(this),this.fireEvent("show",this)},getButtons:function(t){return void 0===t?this.lockedControls:[]},SetDisabled:function(t){this.lockedControls&&this.lockedControls.forEach((function(e){e&&e.setDisabled(t)}),this)},onComboOpen:function(t,e,i,n){n&&n.fromKeyDown||_.delay((function(){var i=$("input",e.cmpEl).select();t?i.focus():e.isMenuOpen()||i.one("mouseup",(function(t){t.preventDefault()}))}),10)},textZoom:"Zoom",textFitPage:"Fit To Page",textFitWidth:"Fit To Width",textInterfaceTheme:"Interface theme",textStatusBar:"Status Bar",textAlwaysShowToolbar:"Always show toolbar",tipFitPage:"Fit to page",tipFitWidth:"Fit to width",tipInterfaceTheme:"Interface theme",textLeftMenu:"Left panel",textTabStyle:"Tab style",textFill:"Fill",textLine:"Line"},VE.Views.ViewTab||{}))})),define("visioeditor/main/app/controller/LeftMenu",["core","common/main/lib/util/Shortcuts","visioeditor/main/app/view/LeftMenu","visioeditor/main/app/view/FileMenu","visioeditor/main/app/view/ViewTab"],(function(){"use strict";VE.Controllers.LeftMenu=Backbone.Controller.extend(_.extend({views:["LeftMenu","FileMenu","ViewTab"],initialize:function(){this.addListeners({"Common.Views.Chat":{hide:_.bind(this.onHideChat,this)},"Common.Views.Header":{rename:_.bind((function(t){this.mode&&this.mode.wopi&&this.api?this.api.asc_wopi_renameFile(t):Common.Gateway.requestRename(t)}),this)},"Common.Views.About":{show:_.bind(this.aboutShowHide,this,!1),hide:_.bind(this.aboutShowHide,this,!0)},"Common.Views.Plugins":{"plugins:addtoleft":_.bind(this.addNewPlugin,this),"pluginsleft:open":_.bind(this.openPlugin,this),"pluginsleft:close":_.bind(this.closePlugin,this),"pluginsleft:hide":_.bind(this.onHidePlugins,this),"pluginsleft:updateicons":_.bind(this.updatePluginButtonsIcons,this)},LeftMenu:{"panel:show":_.bind(this.menuExpand,this),"button:click":_.bind(this.onBtnCategoryClick,this)},FileMenu:{"menu:hide":_.bind(this.menuFilesShowHide,this,"hide"),"menu:show":_.bind(this.menuFilesShowHide,this,"show"),"item:click":_.bind(this.clickMenuFileItem,this),"saveas:format":_.bind(this.clickSaveAsFormat,this),"savecopy:format":_.bind((function(t,e,i){this.mode&&this.mode.wopi&&void 0!==i?this.saveAsInWopi(t,e,i):this.clickSaveCopyAsFormat(t,e,i)}),this),"settings:apply":_.bind(this.applySettings,this),"create:new":_.bind(this.onCreateNew,this),"recent:open":_.bind(this.onOpenRecent,this)},Toolbar:{"file:settings":_.bind(this.clickToolbarSettings,this),"file:open":this.clickToolbarTab.bind(this,"file"),"file:close":this.clickToolbarTab.bind(this,"other")},ViewTab:{"leftmenu:hide":_.bind(this.onLeftMenuHide,this)}}),Common.NotificationCenter.on("leftmenu:change",_.bind(this.onMenuChange,this)),Common.NotificationCenter.on("file:print",_.bind(this.clickToolbarPrint,this))},onLaunch:function(){this.leftMenu=this.createView("LeftMenu").render(),this.leftMenu.btnThumbs.on("toggle",_.bind(this.onShowTumbnails,this)),this.leftMenu.btnSearchBar.on("toggle",_.bind(this.onMenuSearchBar,this)),this._state={disableEditing:!1};var t={"command+shift+s,ctrl+shift+s":_.bind(this.onShortcut,this,"save"),esc:_.bind(this.onShortcut,this,"escape"),f1:_.bind(this.onShortcut,this,"help")};t[Common.Utils.isMac?"ctrl+alt+f":"alt+f"]=_.bind(this.onShortcut,this,"file"),t[Common.Utils.isMac?"ctrl+alt+q":"alt+q"]=_.bind(this.onShortcut,this,"chat"),Common.util.Shortcuts.delegateShortcuts({shortcuts:t}),Common.util.Shortcuts.suspendEvents()},setApi:function(t){this.api=t,this.api.asc_registerCallback("asc_onThumbnailsShow",_.bind(this.onThumbnailsShow,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onApiServerDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onApiServerDisconnect,this)),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onApiChatMessage,this));var e=Common.UI.LayoutManager.getInitValue("leftMenu");return e=void 0!==e&&!e,this.isThumbsShown=!Common.localStorage.getBool("ve-hidden-leftmenu",e),this.leftMenu.btnThumbs.toggle(this.isThumbsShown),this.leftMenu.getMenu("file").setApi(t),this},setMode:function(t){return this.mode=t,this.leftMenu.setMode(t),this.leftMenu.getMenu("file").setMode(t),this},createDelayedElements:function(){return this.mode.canCoAuthoring?(this.leftMenu.btnChat[this.mode.canChat&&!this.mode.isLightVersion?"show":"hide"](),this.mode.canChat&&this.leftMenu.setOptionsPanel("chat",this.getApplication().getController("Common.Controllers.Chat").getView("Common.Views.Chat"))):this.leftMenu.btnChat.hide(),(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion),Common.util.Shortcuts.resumeEvents(),this.leftMenu.setButtons(),this.leftMenu.setMoreButton(),this},enablePlugins:function(){(this.mode.trialMode||this.mode.isBeta)&&this.leftMenu.setDeveloperMode(this.mode.trialMode,this.mode.isBeta,this.mode.buildVersion)},clickMenuFileItem:function(t,e,i){var n=!0;switch(e){case"back":case"edit":break;case"save-desktop":this.api.asc_DownloadAs();break;case"saveas":i?n=!1:this.clickSaveAsFormat();break;case"save-copy":i?n=!1:this.clickSaveAsFormat(void 0,void 0,!0);break;case"print":this.api.asc_Print(new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86));break;case"exit":Common.NotificationCenter.trigger("goback");break;case"new":i?n=!1:this.onCreateNew(void 0,"blank");break;case"rename":var o=this,s=o.api.asc_getDocumentName();new Common.Views.RenameDialog({filename:s,maxLength:this.mode.wopi?this.mode.wopi.FileNameMaxLength:void 0,handler:function(t,e){"ok"!=t||_.isEmpty(e.trim())||s===e.trim()||(o.mode.wopi?o.api.asc_wopi_renameFile(e):Common.Gateway.requestRename(e)),Common.NotificationCenter.trigger("edit:complete",o)}}).show();break;case"external-help":n=!!i;break;case"close-editor":Common.NotificationCenter.trigger("close");break;case"switch:mobile":Common.Gateway.switchEditorType("mobile",!0);break;default:n=!1}n&&t&&t.hide()},clickSaveAsFormat:function(t,e){this.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(e)),t.hide()},clickSaveCopyAsFormat:function(t,e,i,n){this.isFromFileDownloadAs=i;var o=new Asc.asc_CDownloadOptions(e,!0);o.asc_setIsSaveAs(!0),n&&o.asc_setWopiSaveAsPath(n),this.api.asc_DownloadAs(o),t.hide()},saveAsInWopi:function(t,e,i){var n=this,o=this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption();!o&&(o=n.txtUntitled);var s=o.lastIndexOf(".");s>0&&(o=o.substring(0,s)),new Common.Views.TextInputDialog({label:n.textSelectPath,value:o||"",inputFixedConfig:{fixedValue:i,fixedWidth:40},inputConfig:{maxLength:n.mode.wopi.FileNameMaxLength},handler:function(o,s){"ok"==o&&("string"==typeof i&&(s+=i),n.clickSaveAsFormat(t,e,i,s))}}).show()},onDownloadUrl:function(t,e){if(this.isFromFileDownloadAs){var i=this,n=this.getApplication().getController("Viewport").getView("Common.Views.Header").getDocumentCaption();if(!n&&(n=i.txtUntitled),"string"==typeof this.isFromFileDownloadAs){var o=n.lastIndexOf(".");o>0&&(n=n.substring(0,o)+this.isFromFileDownloadAs)}i.mode.canRequestSaveAs?Common.Gateway.requestSaveAs(t,n,e):(i._saveCopyDlg=new Common.Views.SaveAsDlg({saveFolderUrl:i.mode.saveAsUrl,saveFileUrl:t,defFileName:n}),i._saveCopyDlg.on("saveaserror",(function(t,e){var n={closable:!1,title:i.notcriticalErrorTitle,msg:e,iconCls:"warn",buttons:["ok"],callback:function(t){Common.NotificationCenter.trigger("edit:complete",i)}};Common.UI.alert(n)})).on("close",(function(t){i._saveCopyDlg=void 0})),i._saveCopyDlg.show())}this.isFromFileDownloadAs=!1},applySettings:function(t){var e=Common.localStorage.getBool("ve-settings-cachemode",!0);Common.Utils.InternalSettings.set("ve-settings-cachemode",e),this.api.asc_setDefaultBlitMode(e),e=Common.localStorage.getItem("ve-settings-fontrender"),Common.Utils.InternalSettings.set("ve-settings-fontrender",e),this.api.SetFontRenderingMode(parseInt(e)),e=Common.localStorage.getBool("app-settings-screen-reader"),Common.Utils.InternalSettings.set("app-settings-screen-reader",e),this.api.setSpeechEnabled(e);var i=Common.localStorage.getItem("ve-settings-zoom"),n=Common.Utils.InternalSettings.get("ve-settings-zoom"),o=Common.Utils.InternalSettings.get("ve-last-zoom");null!==n&&n!=o&&-3!=n||(-1==i?this.api.zoomFitToPage():-2==i?this.api.zoomFitToWidth():i>0&&this.api.zoom(i)),Common.Utils.InternalSettings.set("ve-settings-zoom",i),t.hide()},onCreateNew:function(t,e){if(!Common.Controllers.Desktop.process("create:new"))if("blank"==e&&this.mode.canRequestCreateNew)Common.Gateway.requestCreateNew();else{var i=window.open("blank"==e?this.mode.createUrl:e,"_blank");i&&i.focus()}t&&t.hide()},onOpenRecent:function(t,e){t&&t.hide();var i=window.open(e);i&&i.focus(),Common.component.Analytics.trackEvent("Open Recent")},clickToolbarSettings:function(t){this.leftMenu.showMenu("file:opts")},clickToolbarTab:function(t,e){"file"==t?this.leftMenu.showMenu("file"):this.leftMenu.menuFile.hide()},clickToolbarPrint:function(){this.mode.canPrint&&this.clickMenuFileItem(null,"print")},onHideChat:function(){$(this.leftMenu.btnChat.el).blur(),Common.NotificationCenter.trigger("layout:changed","leftmenu")},onHidePlugins:function(){Common.NotificationCenter.trigger("layout:changed","leftmenu")},addNewPlugin:function(t,e,i){this.leftMenu.insertButton(t,e),this.leftMenu.insertPanel(i)},onBtnCategoryClick:function(t){"plugin"!==t.options.type||t.isDisabled()||(t.pressed?(this.tryToShowLeftMenu(),this.leftMenu.fireEvent("plugins:showpanel",[t.options.value])):this.leftMenu.fireEvent("plugins:hidepanel",[t.options.value]),this.leftMenu.onBtnMenuClick(t))},openPlugin:function(t){this.leftMenu.openPlugin(t)},closePlugin:function(t){this.leftMenu.closePlugin(t),Common.NotificationCenter.trigger("layout:changed","leftmenu")},updatePluginButtonsIcons:function(t){this.leftMenu.updatePluginButtonsIcons(t)},onApiServerDisconnect:function(t){this.mode.isEdit=!1,this.leftMenu.close(),this.leftMenu.btnChat.setDisabled(!0),this.leftMenu.setDisabledPluginButtons(!0),this.leftMenu.getMenu("file").setMode({isDisconnected:!0,enableDownload:!!t})},setPreviewMode:function(t){this._state.disableEditing=t,this.updatePreviewMode()},updatePreviewMode:function(){var t=this._state.disableEditing;this.viewmode!==t&&(this.viewmode=t,this.leftMenu.setDisabledPluginButtons(this.viewmode))},SetDisabled:function(t,e){this.leftMenu._state.disabled!==t&&(this.leftMenu._state.disabled=t,this.mode&&(t?(this.previsEdit=this.mode.isEdit,this.prevcanEdit=this.mode.canEdit,this.mode.isEdit=this.mode.canEdit=!t):(this.mode.isEdit=this.previsEdit,this.mode.canEdit=this.prevcanEdit))),t&&this.leftMenu.close(),e&&!e.chat||this.leftMenu.btnChat.setDisabled(t),this.leftMenu.btnThumbs.setDisabled(t),this.leftMenu.setDisabledPluginButtons(t)},onApiChatMessage:function(){this.leftMenu.markCoauthOptions("chat")},aboutShowHide:function(t){this.api&&this.api.asc_enableKeyEvents(t),t&&$(this.leftMenu.btnAbout.el).blur(),t&&this.leftMenu._state.pluginIsRunning&&(this.leftMenu.panelPlugins.show(),this.mode.canCoAuthoring&&this.mode.canChat&&this.leftMenu.panelChat.hide())},menuFilesShowHide:function(t){"hide"===t&&Common.NotificationCenter.trigger("menu:hide")},onMenuChange:function(t){"hide"===t&&this.api&&(this.leftMenu.btnSearchBar.isActive()?(this.leftMenu.btnSearchBar.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar)):this.leftMenu.btnChat.isActive()&&(this.leftMenu.btnChat.toggle(!1),this.leftMenu.onBtnMenuClick(this.leftMenu.btnChat)))},onShortcut:function(t,e){if(this.mode)switch(t){case"search":return!1;case"save":return this.mode.canDownload&&(this.mode.isDesktopApp&&this.mode.isOffline?this.api.asc_DownloadAs():this.mode.canDownload&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:saveas"))),!1;case"help":return this.mode.canHelp&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file:help")),!1;case"file":return Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("file"),!1;case"escape":var i=this.getApplication().getController("Viewport").header.btnSearch;if(i.pressed&&i.toggle(!1),this.leftMenu.menuFile.isVisible())return Common.UI.HintManager.needCloseFileMenu()&&this.leftMenu.menuFile.hide(),!1;var n=VE.getController("Statusbar").statusbar.$el.find('.open > [data-toggle="dropdown"]');if(n.length)return $.fn.dropdown.Constructor.prototype.keydown.call(n[0],e),!1;if(this.mode.canPlugins&&this.leftMenu.panelPlugins&&(n=this.leftMenu.panelPlugins.$el.find('#menu-plugin-container.open > [data-toggle="dropdown"]')).length)return $.fn.dropdown.Constructor.prototype.keydown.call(n[0],e),!1;if(this.leftMenu.btnAbout.pressed)return Common.UI.HintManager.isHintVisible()||(this.leftMenu.close(),Common.NotificationCenter.trigger("layout:changed","leftmenu")),!1;break;case"chat":return this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(Common.UI.Menu.Manager.hideAll(),this.leftMenu.showMenu("chat")),!1}},onPluginOpen:function(t,e,i){"onboard"==e&&("open"==i?(this.tryToShowLeftMenu(),this.leftMenu.close(),this.leftMenu.panelPlugins.show(),this.leftMenu.onBtnMenuClick({pressed:!0,options:{action:"plugins"}}),this.leftMenu._state.pluginIsRunning=!0):(this.leftMenu._state.pluginIsRunning=!1,this.leftMenu.close()))},onShowHideChat:function(t){this.mode.canCoAuthoring&&this.mode.canChat&&!this.mode.isLightVersion&&(t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("chat")):(this.leftMenu.btnChat.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnChat)))},onShowHideSearch:function(t,e){t?(Common.UI.Menu.Manager.hideAll(),this.tryToShowLeftMenu(),this.leftMenu.showMenu("advancedsearch",void 0,!0),this.leftMenu.fireEvent("search:aftershow",this.leftMenu,e)):(this.leftMenu.btnSearchBar.toggle(!1,!0),this.leftMenu.onBtnMenuClick(this.leftMenu.btnSearchBar))},onMenuSearchBar:function(t,e){e&&this.leftMenu.panelSearch.setSearchMode("no-replace")},isSearchPanelVisible:function(){return this.leftMenu&&this.leftMenu.panelSearch&&this.leftMenu.panelSearch.isVisible()},onLeftMenuHide:function(t,e){this.leftMenu&&(e?this.leftMenu.show():(this.menuExpand(this,"thumbs",!1),this.leftMenu.close(),this.leftMenu.hide()),Common.localStorage.setBool("ve-hidden-leftmenu",!e),!t&&this.leftMenu.fireEvent("view:hide",[this,!e])),Common.NotificationCenter.trigger("layout:changed","main"),Common.NotificationCenter.trigger("edit:complete",this.leftMenu)},tryToShowLeftMenu:function(){this.mode.canBrandingExt&&this.mode.customization&&!1===this.mode.customization.leftMenu||!Common.UI.LayoutManager.isElementVisible("leftMenu")||this.onLeftMenuHide(null,!0)},onShowTumbnails:function(t,e){this.api.ShowThumbnails(e)},onThumbnailsShow:function(t){t&&!this.isThumbsShown?this.leftMenu.btnThumbs.toggle(!0,!1):!t&&this.isThumbsShown&&this.leftMenu.btnThumbs.toggle(!1,!1),this.isThumbsShown=t},menuExpand:function(t,e,i){"thumbs"==e?this.isThumbsShown=i:i||!this.isThumbsShown||this.leftMenu._state.pluginIsRunning||this.leftMenu._state.historyIsRunning||this.leftMenu.btnThumbs.toggle(!0,!1)},textNoTextFound:"Text not found",newDocumentTitle:"Unnamed document",requestEditRightsText:"Requesting editing rights...",notcriticalErrorTitle:"Warning",txtUntitled:"Untitled",textSelectPath:"Enter a new name for saving the file copy"},VE.Controllers.LeftMenu||{}))})),void 0===Common)var Common={};if(Common.IrregularStack=function(t){var e=[],i=function(t,e){return"object"==typeof t&&"object"==typeof e&&window.JSON?window.JSON.stringify(t)===window.JSON.stringify(e):t===e},n=(t=t||{}).strongCompare||i,o=t.weakCompare||i,s=function(t,i){for(var n=e.length-1;n>=0;n--)if(i(e[n],t))return n;return-1};return{push:function(t){e.push(t)},pop:function(t){var i=s(t,n);if(-1!=i)return e.splice(i,1)[0]},get:function(t){var i="object"==typeof t?s(t,o):t;if(-1!=i)return e[i]},exist:function(t){return!(s(t,n)<0)},length:function(){return e.length}}},define("irregularstack",(function(){})),void 0===Common)var Common={};if(define("common/main/lib/component/LoadMask",["common/main/lib/component/BaseView"],(function(){"use strict";Common.UI.LoadMask=Common.UI.BaseView.extend({options:{cls:"",style:"",title:"Loading...",owner:document.body},template:_.template(['<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">','<i id="loadmask-spinner" class="asc-loadmask-image"></i>','<div class="asc-loadmask-title"><%- title %></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.template=this.options.template||this.template,this.title=this.options.title,this.ownerEl=this.options.owner instanceof Common.UI.BaseView?$(this.options.owner.el):$(this.options.owner),this.loaderEl=$(this.template({id:this.id,cls:this.options.cls,style:this.options.style,title:this.title})),this.maskeEl=$('<div class="asc-loadmask"></div>'),this.timerId=0},render:function(){return this},internalShowLoader:function(){this.ownerEl.append(this.loaderEl),this.loaderEl.css("min-width",$(".asc-loadmask-title",this.loaderEl).width()+105),this.ownerEl&&0==this.ownerEl.closest(".asc-window.modal").length&&Common.util.Shortcuts.suspendEvents()},internalShowMask:function(){this.ownerEl.ismasked||(this.ownerEl.ismasked=!0,this.ownerEl.append(this.maskeEl))},show:function(t){if(this.internalShowMask(),this.ownerEl.hasloader)return this;this.ownerEl.hasloader=!0;var e=this;return e.title!=e.options.title&&(e.options.title=e.title,$(".asc-loadmask-title",this.loaderEl).html(Common.Utils.String.htmlEncode(e.title))),t?e.internalShowLoader():e.timerId||(e.timerId=setTimeout((function(){e.internalShowLoader()}),500)),this},hide:function(){var t=this.ownerEl;this.timerId&&(clearTimeout(this.timerId),this.timerId=0),t&&t.ismasked&&this.maskeEl&&this.maskeEl.remove(),delete t.ismasked,t&&t.hasloader&&(0!=t.closest(".asc-window.modal").length||Common.Utils.ModalWindow.isVisible()||Common.util.Shortcuts.resumeEvents(),this.loaderEl&&this.loaderEl.remove()),delete t.hasloader},setTitle:function(t){if(this.title=t,this.ownerEl&&this.ownerEl.hasloader&&this.loaderEl){var e=$(".asc-loadmask-title",this.loaderEl);e.html(Common.Utils.String.htmlEncode(t)),this.loaderEl.css("min-width",e.width()+105)}},isVisible:function(){return!!this.ownerEl.ismasked},updatePosition:function(){var t=this.ownerEl,e=this.loaderEl;t&&t.hasloader&&e&&(e.css({top:Math.round(t.height()/2-(e.height()+parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")))/2)+"px",left:Math.round(t.width()/2-(e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")))/2)+"px"}),e.css({visibility:"visible"}))}})})),define("common/main/lib/controller/LaunchController",[],(function(){!Common.Controllers&&(Common.Controllers={}),Common.Controllers.LaunchController=new function(){let t=!1;const e=function(){const e=this,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE;!i.postLaunchScripts&&(i.postLaunchScripts=[]),require({waitSeconds:0},i.postLaunchScripts,(()=>{Common.UI.ScreenReaderFocusManager&&Common.UI.ScreenReaderFocusManager.init(e.api),window.less&&(t=!0,Common.NotificationCenter.trigger("script:loaded"))}))},i=function(e){t=!0,Common.NotificationCenter.trigger("script:loaded")},n=function(t){e.call(this)},o=function(t){};return{init:function(t){this.api=t,Common.NotificationCenter.on("app:ready",n.bind(this)),Common.NotificationCenter.on("app:face",o.bind(this)),Common.NotificationCenter.on("app-pack:loaded",i.bind(this))},isScriptLoaded:function(){return t}}}})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.HintManager=new function(){var t,e,i,n="en",o=[],s=[],a=[],r=[],l=!1,c=!1,h=0,d=document,u=[],m=[],p="",f=!1,g=!1,b=!1,v=!1,C=!0,w=[],y={"scroll-right":"R","scroll-left":"V"},x=function(t,e){e?d=e:"esc"!==t?d=v?[$(window.parent.document).find(".advanced-settings-dlg:visible")[0],window.document]:$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):t&&t.closest(".hint-section")||document:0===h&&(d=document)},k=function(t){!i||!t&&Common.Utils.ModalWindow.isVisible()||(g=t,i.asc_enableKeyEvents(!t))},I=function(){p="",0===h&&Common.NotificationCenter.trigger("toolbar:collapse"),(0===m.length||$("#file-menu-panel").is(":visible")&&1===h)&&U(),m.length>0?(!g&&k(!0),c=!0,m.forEach((function(t){t.show()})),t=setInterval((function(){p.length>0&&(p="")}),5e3)):c=!1,Common.NotificationCenter.trigger("hints:show",c,h)},S=function(){c=!1,m&&m.forEach((function(t){t.remove()})),clearInterval(t),Common.NotificationCenter.trigger("hints:show",!1)},E=function(t){D(),m.length=0,u.length=0,void 0!==t?h=t:h++},T=function(t){var e=t;if(-1===o.indexOf(e)){var i=s.indexOf(e);e=o[i]}return e},M=function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")},A=function(){u=[],w=[];var t=[],e=[],i=[];_.isArray(d)?d.forEach((function(n){t=t.concat($(n).find("[data-hint="+h+"]").toArray()),i=i.concat($(n).find("[data-hint-title][data-hint="+h+"]").toArray()),e=e.concat($(n).find("[data-hint-title-lang][data-hint="+h+"]").toArray())})):(t=$(d).find("[data-hint="+h+"]").toArray(),i=$(d).find("[data-hint-title][data-hint="+h+"]").toArray(),e=$(d).find("[data-hint-title-lang][data-hint="+h+"]").toArray());var a=t.filter((function(t){return $(t).is(":visible")})),r=e.filter((function(t){return $(t).is(":visible")})),l=i.filter((function(t){return $(t).is(":visible")}));if(a.length!==r.length){var c=[],m=[];if(0===h)for(var p in y){var f=y[p].charAt(0).toLowerCase();w.push(f);var g=o.indexOf(f);m.indexOf(g)<0&&m.push(g)}if(a.length+(0===h?_.size(y):0)>o.length?(l.forEach((function(t){var e=$(t).data("hint-title").charAt(0).toLowerCase();e=T(e),w.indexOf(e)<0&&w.push(e)})),c=function(t){for(var e,i,n=o.slice(),s=0;s<o.length&&(-1===w.indexOf(o[s])&&(e=o[s],i=s),!e);s++);if(e){for(n[i]=e+o[0],s=0;n.length<t;s++)e+o[s]!==n[i]&&n.push(e+o[s]);return n}return!1}(a.length+(0===h?_.size(y):0))):c=o.slice(),c.length){l.forEach((function(t){var e=$(t),i=e.attr("data-hint-title");if(i){var o,a=(i=i.toLowerCase()).charAt(0),r=s.indexOf(a);if(m.indexOf(r)<0&&m.push(r),"en"===n)e.attr("data-hint-title-lang",i.toUpperCase());else{var l="";for(o=0;o<i.length;o++)l+=T(i.charAt(o));e.attr("data-hint-title-lang",l.toUpperCase())}}}));var b=0;a.forEach((function(t){for(var e=$(t);-1!==m.indexOf(b);)b++;e.attr("data-hint-title")||b>c.length||(e.attr("data-hint-title-lang",c[b].toUpperCase()),b++),u.push(e)}))}}else a.forEach((function(t){u.push($(t))}))},U=function(){var t=v?window.parent.innerHeight*Common.Utils.zoom():Common.Utils.innerHeight()-20,e=v?window.parent.innerWidth*Common.Utils.zoom():Common.Utils.innerWidth(),i=v?d[0]:d,n=0!==h&&$(i).length>0&&!v?Common.Utils.getOffset($(i)).top:0,o=0!==h&&$(i).length>0&&!v?n+$(i).height():t;"toolbar"===$(i).prop("id")&&$(i).outerHeight()<$(i).find(".box-controls").outerHeight()&&(o+=$(i).find(".box-controls").outerHeight()),0===u.length&&A(),u.forEach((function(i,s){if(!M(i)){var a=0,r=e;if(!v&&"toolbar"===$(d).prop("id")&&$(d).find(".toolbar-mask").length>0||$("#about-menu-panel").is(":visible")&&"right-menu"===i.closest(".hint-section").prop("id"))return;if(window.SSE&&"statusbar_bottom"===i.parent().prop("id")){var l=i.parent();if(Common.Utils.getOffset(i).left>Common.Utils.getOffset(l).left+l.width())return}if(0===h&&i.closest(".tabs.short").length>0){var c=i.closest(".tabs.short");r=(a=Common.Utils.getOffset(c).left)+c.width(),i.hasClass("scroll")||(a+=20,r-=20)}var u=$('<div style="" class="hint-div">'+i.attr("data-hint-title-lang")+"</div>"),p=i.attr("data-hint-direction");Common.UI.isRTL()&&p&&(p.indexOf("left")>-1?p=p.replace("left","right"):p.indexOf("right")>-1&&(p=p.replace("right","left"))),window.SSE&&!v&&9!==d.nodeType&&"toolbar"===d.prop("id")&&"data"===i.closest(".panel").attr("data-tab")&&(i.parent().hasClass("slot-sortdesc")||i.parent().hasClass("slot-btn-setfilter")?(p="top",i.attr("data-hint-direction","top")):(i.parent().hasClass("slot-btn-clear-filter")||i.parent().hasClass("slot-sortasc"))&&(p="bottom",i.attr("data-hint-direction","bottom")));var f=t;$("#file-menu-panel").is(":visible")&&h>1&&($(".fms-flex-apply").is(":visible")||$("#fms-flex-apply").is(":visible"))&&i.closest(".fms-flex-apply").length<1&&i.closest("#fms-flex-apply").length<1&&(f=t-$(".fms-flex-apply").height());var g=i.attr("data-hint-offset"),b="big"===g?6:"medium"===g?4:"small"===g?2:0;if(b)switch(p){case"bottom":g=[-b,0];break;case"top":g=[b,0];break;case"right":g=[0,-b];break;case"left":g=[0,b]}else g=g?i.attr("data-hint-offset").split(",").map((function(t){return parseInt(t)})):[0,0],Common.UI.isRTL()&&(g[1]=-g[1]);var C,w,y=Common.Utils.getOffset(i);"left-top"===p?(C=y.top-10+g[0],w=y.left-10+g[1]):"right-top"===p?(C=y.top-10+g[0],w=y.left+(i.outerWidth()-18)+10+g[1]):"top"===p?(C=y.top-18+g[0],w=y.left+(i.outerWidth()-18)/2+g[1]):"right"===p?(C=y.top+(i.outerHeight()-18)/2+g[0],w=y.left+i.outerWidth()+g[1]):"left"===p?(C=y.top+(i.outerHeight()-18)/2+g[0],w=y.left-18+g[1]):(C=y.top+i.outerHeight()+g[0],w=y.left+(i.outerWidth()-18)/2+g[1]),C<f&&w<e&&C>n&&C<o&&w>a&&w+18<r&&(u.css({top:C,left:w}),v&&s<2?(u.css("z-index","1060"),$(window.parent.document.body).append(u)):$(document.body).append(u)),m.push(u)}}))},D=function(){m&&m.forEach((function(t){t.remove()}))},P=function(){h=$("#file-menu-panel").is(":visible")||v?1:0,x(),m.length=0,u.length=0},L=function(t){Common.Utils.loadConfig("../../common/main/resources/alphabetletters/alphabetletters.json",(function(e){s=e.en;var i=function(t){return n=t,o=e[t]},a=!!i(t)||(!!i(t.split(/[\-_]/)[0])||i("en"));if(a&&"en"!==n)for(var r in y){var l=T(y[r].toLowerCase());l&&(y[r]=l.toUpperCase())}return a})),Common.Utils.loadConfig("../../common/main/resources/alphabetletters/qwertyletters.json",(function(t){a=t[n],"en"!==n&&(r=t.en)}))},O=function(t,e){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)&&(c&&S(),m.length>0&&P(),!e&&g&&k(!1),t&&(f=!0),$(".hint-div").length>0&&$(".hint-div").remove(),$("iframe").length>0))try{$("iframe").contents().find(".hint-div").remove()}catch(t){}},R=function(t){C!==t&&(C=t)};return{init:function(t){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){i=t;var s=Common.localStorage.getKeysFilter();e=s&&s.length?s.split(",")[0]:"",Common.NotificationCenter.on({"app:ready":function(t){var e=t.lang?t.lang.toLowerCase():"en";L(e),b=!0},"hints:clear":O,"window:resize":O}),$("#editor_sdk").on("click",(function(){O()})),$(document).on("mousedown",(function(){O()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!l||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?c&&t.preventDefault():(t.preventDefault(),c?(S(),P(),g&&(g=!1,i.asc_enableKeyEvents(!0))):($("input:focus").blur(),h=$("#file-menu-panel").is(":visible")||v?1:0,x(),I())),l=!1})),$(document).on("keydown",(function(t){if(c)if(t.preventDefault(),t.keyCode==Common.UI.Keys.ESC)setTimeout((function(){0===h?(S(),P(),k(!1)):(D(),m.length=0,u.length=0,h--,x("esc"),I())}),10);else{var i=null,s=!1,g=t.keyCode;if(16!==g&&17!==g&&18!==g&&91!==g&&(i="en"===n?g>47&&g<58||g>64&&g<91?String.fromCharCode(t.keyCode):null:/[.*+?^${}()|[\]\\]/g.test(t.key)?null:t.key),i){var w;if("en"!==n&&-1===o.indexOf(i.toLowerCase())){var y=r.indexOf(i.toLowerCase());-1!==y&&(i=a[y])}p+=i.toUpperCase();for(var _=0;_<u.length;_++){var T=u[_];if(!M(T)){var A=T.attr("data-hint-title-lang");if(new RegExp("^"+p).test(A)&&(s=!0),A===p){w=T;break}}}if(w){Common.UI.ScreenReaderFocusManager&&Common.UI.ScreenReaderFocusManager.exitFocusMode();var U=w.prop("tagName").toLowerCase();if(window.SSE&&"statusbar_bottom"===w.parent().prop("id"))S(),w.contextmenu(),P();else if("input"===U||"textarea"===U)S(),w.trigger(jQuery.Event("click",{which:1})),w.focus(),P();else if(w.hasClass("listview"))S(),w.focus(),P();else{if(f=!1,S(),!v&&"toolbar"===$(d).prop("id")&&$(d).find(".toolbar-mask").length>0)return void P();var L=w.attr("content-target")&&!$("#"+w.attr("content-target")).is(":visible")||"slot-btn-chat"===w.parent().prop("id")&&!$("#left-panel-chat").is(":visible")||w.parent().hasClass("ribtab")&&!$("#toolbar").children(".toolbar").hasClass("expanded");if((!w.attr("content-target")&&"slot-btn-chat"!==w.parent().prop("id")||L)&&($("#file-menu-panel").is(":visible")&&("fm-btn-info"===w.parent().prop("id")&&$("#panel-info").is(":visible")||"fm-btn-settings"===w.parent().prop("id")&&$("#panel-settings").is(":visible"))||(w.attr("for")?$("#"+w.attr("for")).trigger(jQuery.Event("click",{which:1})):(w.trigger(jQuery.Event("click",{which:1})),L&&(f=!1)))),"btn-go-back"===w.prop("id")||"slot-btn-options"===w.closest(".btn-slot").prop("id")||"slot-btn-mode"===w.closest(".btn-slot").prop("id")||"id-btn-favorite"===w.prop("id")||"tlb-box-users"===w.parent().prop("id")||"left-btn-thumbs"===w.prop("id")||w.hasClass("scroll")||"left-btn-about"===w.prop("id")||"left-btn-support"===w.prop("id")||"slot-btn-search"===w.closest(".btn-slot").prop("id")||"slot-btn-edit-mode"===w.closest(".btn-slot").prop("id"))return void P();if("add-comment-doc"===w.prop("id"))return D(),m.length=0,u.length=0,void I();f||("slot-btn-chat"===w.parent().prop("id")?(E(1),x(void 0,$("#left-menu.hint-section"))):"id-right-menu-signature"===w.prop("id")?(E(2),x(w)):(E(),x(w)),I(),m.length<1&&P())}}else s||(p="")}}l=Common.Utils.InternalSettings.get(e+"settings-show-alt-hints")&&!t.shiftKey&&t.keyCode==Common.UI.Keys.ALT&&!Common.Utils.ModalWindow.isVisible()&&b&&o.length>0&&!(window.PE&&$("#pe-preview").is(":visible"))&&!(Common.UI.ScreenReaderFocusManager&&Common.UI.ScreenReaderFocusManager.isFocusMode()),Common.Utils.InternalSettings.get(e+"settings-show-alt-hints")&&t.altKey&&115!==t.keyCode&&C&&t.preventDefault()}))}},setMode:function(t){v=t.isEditDiagram||t.isEditMailMerge||t.isEditOle,R(!!v)},clearHints:O,needCloseFileMenu:function(){return!(c&&h>1)},isHintVisible:function(){return c},getStaticHint:function(t){return y[t]},setInternalEditorLoading:R}},define("common/main/lib/controller/HintManager",(function(){})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.LayoutManager=new function(){var t,e,i,n=[],o=[],s=0,a=[],r=function(i,n,o){if(!i&&(i=t),e&&i)for(var s in i)if(i.hasOwnProperty(s))if("object"==typeof i[s])r(i[s],n,(o||"")+s+"-");else if(!1===i[s]){var a="[data-layout-name="+(o||"")+s+"]",l=n?n.find(a):$(a);l&&l.hide&&l.hide()}},l=function(i,n,o){if(!n&&(n=t),!e||!n)return!0;var s=!0;for(var a in n)if(n.hasOwnProperty(a)&&("object"==typeof n[a]?s=l(i,n[a],(o||"")+a+"-"):i===(o||"")+a&&(s=n[a]),!1===s))return s;return s},c=function(t,e,i,n){var o=[];if(t&&t.customButtonsArr&&t.customButtonsArr[i])if(!n||n.length<1)o=t.customButtonsArr[i],t.customButtonsArr[i]=void 0;else for(var s=0;s<t.customButtonsArr[i].length;s++){var a=t.customButtonsArr[i][s];a.options.tabid!==e||_.findWhere(n,{id:a.options.value})||(o.push(a),t.customButtonsArr[i].splice(s,1),s--)}return o},h=function(t,e,i,n){n?n.removeAll():(n=new Common.UI.Menu({menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,n){i&&i(e.options.guid,e.value)}));var o=!1;return t.forEach((function(t){t.separator&&n.addItem(new Common.UI.MenuItemCustom({caption:"--"})),t.text&&n.addItem(new Common.UI.MenuItemCustom({caption:t.text||"",value:t.id,menu:!!t.items&&h(t.items,e,i),baseUrl:"",iconsSet:t.icons,guid:e})),o=o||!!t.icons})),o&&(n.cmpEl?n.cmpEl.toggleClass("shifted-right",!0):n.options.cls="shifted-right"),n},d=function(t,e,i){if(e){var n=m(t);n&&0!=n.length?n.forEach((function(n){var o=t;if("object"==typeof n.menu)g(o,n.menu,e,i);else if(n.menu){let t=e,s=i;n.on("menu:created",(function(){g(o,n.menu,t,s)}))}})):o.push({action:t,data:e,callback:i})}},u=function(){if(s)return void(s=2);s=1;let t=o.length;for(;t>0;){let e=o.shift();d(e.action,e.data,e.callback),t--}2===s?(s=0,u()):s=0},m=function(t){if(n){var e=[];return n.forEach((function(i){i instanceof Common.UI.Button&&i.action===t&&e.push(i)})),e}},p=function(t,e,i){if(t&&t.items.length>0)for(var n=t.items.length-1;n>=0;n--)if(t.items[n].isCustomItem&&(void 0===i&&t.items[n].options.guid===e||t.items[n].options.guid===e&&t.items[n].value===i))return t.items[n]},f=function(t,e,i,n){var o=this,s=!1;return n?n.removeAll():((n=new Common.UI.Menu({menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,n){!o._preventCustomClick&&i&&i(e.options.guid,e.value)})),n.on("menu:click",(function(t,e){o._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&n.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&n.addItem(new Common.UI.MenuItemCustom({caption:t.text||"",value:t.id,menu:!!t.items&&f(t.items,e,i),iconsSet:t.icons,baseUrl:"",guid:e,disabled:!!t.disabled})),s=s||!!t.icons})),s&&(n.cmpEl?n.cmpEl.toggleClass("shifted-right",!0):n.options.cls=n.cls="shifted-right"),n},g=function(t,e,i,n){if(e){if(!i||i.length<1)return _removeCustomMenuItems(e),void(e._hasCustomItems=!1);var o=this;o._preventCustomClick&&clearTimeout(o._preventCustomClick),e._hasCustomItems&&(o._preventCustomClick=setTimeout((function(){o._preventCustomClick=null}),500));var s,r=!1,l=[];if(e._hasCustomItems=!1,i.forEach((function(i){a[i.guid]||(a[i.guid]={actions:[],tabs:[]}),_.indexOf(a[i.guid].actions,t)<0&&a[i.guid].actions.push(t),_removeCustomMenuItems(e,i.guid,i.items);var c=!p(e,i.guid);i&&i.items&&i.items.length>0&&(e._hasCustomItems=!0,i.items.forEach((function(t){if(t.separator&&c&&e.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:i.guid})),t.text){var a=p(e,i.guid,t.id),h=t.text||"";if(a)a.setCaption(h),a.setDisabled(!!t.disabled),t.items&&(a.menu?(a.menu.isVisible()&&a.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(a.menu.isOver=!0,s=a.cmpEl),f(t.items,i.guid,n,a.menu)):a.setMenu(f(t.items,i.guid,n)));else{a=new Common.UI.MenuItemCustom({caption:h,value:t.id,guid:i.guid,menu:!!(t.items&&t.items.length>=0)&&f(t.items,i.guid,n),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled}).on("click",(function(t,e){!o._preventCustomClick&&n&&n(t.options.guid,t.value)}));r=r||!!t.icons,e.addItem(a),l.push(a)}}})))})),s){var c=$("> [role=menu]",s).find("> li:not(.divider):not(.disabled):visible > a");c.length>0&&c.eq(0).focus()}if(r)for(var h=0;h<l.length;h++)r&&(l[h].cmpEl?l[h].cmpEl.toggleClass("shifted-right",!0):l[h].options.cls=l[h].cls="shifted-right");e.rendered&&e.alignPosition()}};return _removeCustomMenuItems=function(t,e,i){if(t&&t.items.length>0)for(var n=0;n<t.items.length;n++)t.items[n].isCustomItem&&(void 0===e||t.items[n].options.guid===e&&!_.findWhere(i||[],{id:t.items[n].options.value}))&&(t.removeItem(t.items[n]),n--)},{init:function(i,n,o){t=i,e=n,o},applyCustomization:r,isElementVisible:l,getInitValue:function(i){if(e&&t){var n=i.split("-"),o=0,s=t;for(o=0;o<n.length&&("object"==typeof s[n[o]]&&s[n[o]]);o++)s=s[n[o]];if(o===n.length)return"object"==typeof s&&s?s.mode:s}},lastTabIdx:10,addControls:function(t){"[object Array]"===Object.prototype.toString.call(t)||t instanceof Array?Array.prototype.push.apply(n,t):Array.prototype.push.apply(n,[t]),o.length&&u()},getControls:function(){return n},addCustomControls:function(t,e,n,o){if(e){i=t;var s=[];return e.forEach((function(e){e.tabs&&e.tabs.forEach((function(i){if(i){var r=[],l=o?[]:c(t,i.id,e.guid,i.items);a[e.guid]||(a[e.guid]={actions:[],tabs:[]}),_.indexOf(a[e.guid].tabs,i)<0&&a[e.guid].tabs.push(i.id),i.items&&i.items.forEach((function(o,s){if(o.removed){let n=function(t,e,i,n){if(t&&t.customButtonsArr&&t.customButtonsArr[i])for(var o=0;o<t.customButtonsArr[i].length;o++){var s=t.customButtonsArr[i][o];if(s.options.tabid===e&&s.options.guid===i&&s.options.value===n)return t.customButtonsArr[i].splice(o,1),s}}(t,i.id,e.guid,o.id);return void(n&&l.push(n))}let a=function(t,e,i,n){if(t&&t.customButtonsArr&&t.customButtonsArr[i])for(var o=0;o<t.customButtonsArr[i].length;o++){var s=t.customButtonsArr[i][o];if(s.options.tabid===e&&s.options.guid===i&&s.options.value===n)return s}}(t,i.id,e.guid,o.id),c=Common.enumLock;if(a){if(a instanceof Common.UI.Button){var d=o.text||"";a.options.caption!==(d||" ")&&(a.cmpEl.closest(".btn-slot.x-huge").toggleClass("nocaption",!d),a.setCaption(d||" "),a.options.caption=d||" "),a.updateHint(o.hint||""),void 0!==o.disabled&&Common.Utils.lockControls(c.customLock,!!o.disabled,{array:[a]}),a.menu&&o.items&&o.items.length>0&&("object"!=typeof a.menu&&(a.setMenu(new Common.UI.Menu({items:[]})),a.menu.on("item:custom-click",(function(t,e,i){n&&n(e.options.guid,e.value)}))),h(o.items,e.guid,n,a.menu))}}else"button"!==o.type&&"big-button"!==o.type||(a=new Common.UI.ButtonCustom({cls:"btn-toolbar x-huge icon-top",iconsSet:o.icons,baseUrl:"",caption:o.text||" ",menu:o.items,split:o.items&&!!o.split,enableToggle:o.enableToggle&&(!o.items||!!o.split),value:o.id,guid:e.guid,tabid:i.id,separator:o.separator,hint:o.hint||"",lock:o.lockInViewMode?[c.customLock,c.viewMode,c.previewReviewMode,c.viewFormMode,c.docLockView,c.docLockForms,c.docLockComments,c.selRangeEdit,c.editFormula]:[c.customLock],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"small"}),o.items&&"object"==typeof o.items&&(a.setMenu(new Common.UI.Menu({items:[]})),a.menu.on("item:custom-click",(function(t,e,i){n&&n(e.options.guid,e.value)})),h(o.items,e.guid,n,a.menu)),a.menu&&!a.split||a.on("click",(function(t,e){n&&n(t.options.guid,t.options.value,t.pressed)})),r.push(a),o.disabled&&Common.Utils.lockControls(c.customLock,o.disabled,{array:[a]}))})),t.addCustomControls({action:i.id,caption:i.text||""},r,l),t.customButtonsArr||(t.customButtonsArr=[]),t.customButtonsArr[e.guid]||(t.customButtonsArr[e.guid]=[]),Array.prototype.push.apply(t.customButtonsArr[e.guid],r),Array.prototype.push.apply(s,r)}}))})),s}},clearCustomControls:function(t){i&&a[t]&&a[t].tabs&&(a[t].tabs.forEach((function(e){i.addCustomControls({action:e},void 0,c(i,e,t))})),a[t].tabs=[])},addCustomMenuItems:d,clearCustomMenuItems:function(t){a[t]&&a[t].actions&&(a[t].actions.forEach((function(e){var i=m(e);i&&i.forEach((function(e){"object"==typeof e.menu&&_removeCustomMenuItems(e.menu,t)}))})),a[t].actions=[])}}},Common.UI.FeaturesManager=new function(){var t,e;return{init:function(i,n){t=i,e=n},canChange:function(i,n){return!((e||n)&&t&&"object"==typeof t[i]&&t[i]&&!1===t[i].change)},getInitValue:function(i,n){if((e||n)&&t&&void 0!==t[i]){if("object"!=typeof t[i]||!t[i])return t[i];if(void 0!==t[i].mode)return t[i].mode}},isFeatureEnabled:function(i,n){return!e&&!n||!t||!1!==t[i]}}},define("common/main/lib/controller/LayoutManager",(function(){})),void 0===Common)var Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ExternalUsers=new function(){var t,e=[],i=!1,n=[],o=!1,s=[],a=[],r=function(t,n,o,s,a){if("info"===t)if("object"!=typeof n&&(n=[n]),n&&(n=_.uniq(n)),n.length>100)for(;n.length>0;)Common.Gateway.requestUsers("info",n.splice(0,100));else Common.Gateway.requestUsers("info",n);else{if(i)return;void 0===e[t=t||"mention"]?(i=!0,Common.Gateway.requestUsers(t||"mention",void 0,o||0,s||100,a||"")):Common.NotificationCenter.trigger("mentions:setusers",t,e[t])}},l=function(t){if("info"===t.c)if(o)s.push(t);else{o=!0;var e=[];t.users&&_.each(t.users,(function(t){var i=_.findWhere(n,{id:t.id});i?(i.image=t.image,i.name=t.name,i.email=t.email):e.push(t)})),n=n.concat(e),Common.NotificationCenter.trigger("mentions:setusers",t.c,t.users),o=!1,s.length>0&&l(s.shift())}};return{init:function(n,o){Common.Gateway.on("setusers",l),t=o,n&&(Common.Gateway.on("setusers",(function(t){if("info"!==t.c)if(null!==t.users){var n=t.c||"mention",o=t.users||[];void 0===t.total&&(e[n]=o),i=!1,Common.NotificationCenter.trigger("mentions:setusers",n,o,t.total)}else e=[]})),Common.NotificationCenter.on("mentions:clearusers",(function(t){"info"!==t&&(e[t||"mention"]=void 0)})))},get:r,getImage:function(t,e){var i,o=_.findWhere(n,{id:t});return o&&(i=o.image),e&&void 0===i&&r("info",[t]),i},setImage:function(t,e){var i=_.findWhere(n,{id:t});i?i.image=e:n.push({id:t,image:e})},getColor:function(e,i){if(!a[e]){var n=t.asc_getUserColorById(e);a[e]=["#"+("000000"+n.toString(16)).substr(-6),n]}return i?a[e][1]:a[e][0]}}},define("common/main/lib/controller/ExternalUsers",(function(){})),define("common/main/lib/view/OpenDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.OpenDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{closable:!1,preview:t.preview,warning:t.warning,codepages:t.codepages,warningMsg:t.warningMsg,width:t.preview?414:t.type!==Common.Utils.importTextType.DRM?340:t.warning?420:280,header:!0,cls:"modal-dlg open-dlg",contentTemplate:"",toolcallback:_.bind(e.onToolClose,e),closeFile:!1,buttons:["ok"].concat(t.closeFile?[{value:"cancel",caption:this.closeButtonText}]:[]).concat(t.closable?["cancel"]:[])},t),this.txtOpenFile=t.txtOpenFile||this.txtOpenFile,this.template=t.template||['<div class="box">','<div class="content-panel" >',"<% if (type == Common.Utils.importTextType.DRM) { %>","<% if (warning) { %>","<div>",'<div class="icon warn"></div>','<div class="padding-left-50"><div style="font-size: 12px;word-break:break-word;">'+("string"==typeof i.warningMsg?i.warningMsg:e.txtProtected)+"</div>",'<label class="header" style="margin-top: 15px;">'+e.txtPassword+"</label>",'<div id="id-password-txt" style="width: 290px;"></div></div>',"</div>","<% } else { %>","<div>",'<label class="">'+e.txtOpenFile+"</label>",'<div id="id-password-txt"></div>',"</div>","<% } %>","<% } else { %>","<% if (codepages && codepages.length>0) { %>",'<div <% if (!!preview && (type == Common.Utils.importTextType.CSV || type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns)) { %> class="margin-right-10" style="width: 230px;display: inline-block;" <% } else { %> style="width: 100%;"<% } %> >','<label class="header">'+e.txtEncoding+"</label>","<div>",'<div id="id-codepages-combo" class="input-group-nr" style="width: 100%; display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.CSV) { %>",'<div style="display: inline-block; <% if (!preview) { %> margin-top:15px;<% } %>">','<label class="header">'+e.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Paste || type == Common.Utils.importTextType.Columns || type == Common.Utils.importTextType.Data) { %>",'<div style="display: inline-block; <% if (codepages && codepages.length>0) { %>margin-top:15px;<% } %>width: 100%;">','<label class="header">'+e.txtDelimiter+"</label>","<div>",'<div id="id-delimiters-combo" class="input-group-nr" style="max-width: 100px;display: inline-block; vertical-align: middle;"></div>','<div id="id-delimiter-other" class="input-row margin-left-10" style="display: inline-block; vertical-align: middle;"></div>','<button type="button" class="btn auto btn-text-default float-right" id="id-delimiters-advanced" style="min-width:100px; display: inline-block;">'+e.txtAdvanced+"</button>","</div>","</div>","<% } %>","<% if (!!preview) { %>",'<div style="margin-top:15px;">','<label class="header">'+e.txtPreview+"</label>",'<div style="position: relative;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data"></div></div>',"</div>","</div>","</div>","</div>","</div>","<% } %>","<% if (type == Common.Utils.importTextType.Data) { %>",'<label class="header" style="margin-top:15px;">'+e.txtDestData+"</label>",'<div id="id-open-data-range" class="input-row" style="width: 100%;"></div>',"<% } %>","<% } %>","</div>","</div>"].join(""),this.handler=i.handler,this.type=i.type,this.preview=i.preview,this.previewData=i.previewData,this.warning=i.warning||!1,this.closable=i.closable,this.codepages=i.codepages,this.settings=i.settings,this.api=i.api,this.validatePwd=i.validatePwd||!1,this.detectedDelimiter=!1,i.tpl=_.template(this.template)(i),this._previewTdWidth=[],this._previewTdMaxLength=0,Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.closable||this.$window.find(".tool").hide(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.type==Common.Utils.importTextType.DRM?this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",showCls:("svg"===this.options.iconType?"svg-icon":"toolbar__icon")+" btn-sheet-view",hideCls:"svg"===this.options.iconType?"svg-icon hide-password":"toolbar__icon btn-hide-password",maxLength:this.options.maxPasswordLength,validateOnBlur:!1,showPwdOnClick:!1,validation:function(e){return t.txtIncorrectPwd}}):(this.initCodePages(),this.preview&&(this.previewData?this.textCallback(this.previewData):this.updatePreview())),this.type==Common.Utils.importTextType.Data&&(this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#id-open-data-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this)),this.dataDestValid=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!0),this.txtDestRange.setValue(this.dataDestValid)),this.onPrimary=function(){return t._handleInput("ok"),!1}}},getFocusedComponents:function(){var t=[];return this.inputPwd&&t.push(this.inputPwd),this.cmbEncoding&&t.push(this.cmbEncoding),this.cmbDelimiter&&t.push(this.cmbDelimiter),this.inputDelimiter&&t.push(this.inputDelimiter),this.btnAdvanced&&t.push(this.btnAdvanced),this.txtDestRange&&t.push(this.txtDestRange),t.concat(this.getFooterButtons())},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;if(this.type==Common.Utils.importTextType.DRM)setTimeout((function(){t.inputPwd.focus(),t.validatePwd&&t.inputPwd.checkValidate()}),500);else{var e=t.txtDestRange?t.txtDestRange:t.cmbEncoding?t.cmbEncoding:t.cmbDelimiter;e&&setTimeout((function(){e.focus()}),500)}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onToolClose:function(){this._handleInput("cancel")},_handleInput:function(t){if(this.handler)if(this.type==Common.Utils.importTextType.DRM)this.handler.call(this,t,{drmOptions:new Asc.asc_CDRMAdvancedOptions(this.inputPwd.getValue())});else{if(this.type==Common.Utils.importTextType.Data&&"ok"==t&&!this.isRangeValid())return;var e=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0,i=this.cmbDelimiter?this.cmbDelimiter.getValue():null,n=-1==i?this.inputDelimiter.getValue():null;-1==i&&(i=null),this.type===Common.Utils.importTextType.TXT?this._isEncodingChanged&&Common.localStorage.setItem("de-settings-open-encoding",e):this.type===Common.Utils.importTextType.CSV?(this._isDelimChanged&&Common.localStorage.setItem("sse-settings-csv-delimiter",null===i?-1:i),this._isDelimCharChanged&&Common.localStorage.setItem("sse-settings-csv-delimiter-char",n||""),this._isEncodingChanged&&Common.localStorage.setItem("sse-settings-csv-encoding",e)):this.type!==Common.Utils.importTextType.Paste&&this.type!==Common.Utils.importTextType.Columns&&this.type!==Common.Utils.importTextType.Data||(this._isDelimChanged&&Common.localStorage.setItem("sse-settings-data-delimiter",null===i?-1:i),this._isDelimCharChanged&&Common.localStorage.setItem("sse-settings-data-delimiter-char",n||""),this._isEncodingChanged&&Common.localStorage.setItem("sse-settings-data-encoding",e));var o=this.separatorOptions?this.separatorOptions.decimal:void 0,s=this.separatorOptions?this.separatorOptions.thousands:void 0,a=this.separatorOptions?this.separatorOptions.qualifier:'"',r=new Asc.asc_CTextOptions(e,i,n);o&&r.asc_setNumberDecimalSeparator(o),s&&r.asc_setNumberGroupSeparator(s),a&&r.asc_setTextQualifier(a),this.handler.call(this,t,{textOptions:r,range:this.txtDestRange?this.txtDestRange.getValue():"",data:this.data})}this.close()},initCodePages:function(){var t,e,i,n,o=[],s=[],a=0,r=0;if(this.codepages){for(o=[],t=0;t<this.codepages.length;++t)i=this.codepages[t],(e=[])[0]=i.asc_getCodePage(),e[1]=i.asc_getCodePageName(),e[2]=i.asc_getLcid(),65001===e[2]&&(r=t),o.push(e);a=50}if(n=o.length){for(t=0;t<n;++t)s.push({value:o[t][0],displayValue:Common.Utils.String.htmlEncode(o[t][1]),lcid:o[t][2]||""});var l=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="display: inline-block;"><%= item.displayValue %></div>','<label class="text-align-right" style="width:'+a+'px;"><%= item.lcid %></label>',"</a></li>","<% }); %>"].join(""));this.cmbEncoding=new Common.UI.ComboBox({el:$("#id-codepages-combo",this.$window),style:"width: 100%;",menuStyle:"min-width: 100%; max-height: 200px;",cls:"input-group-nr",menuCls:"scrollable-menu",data:s,editable:!1,disabled:!0,search:!0,itemsTemplate:l,takeFocusOnClose:!0}),this.cmbEncoding.setDisabled(!1);var c=this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():o[r][0];if(-1===c){if(this.type==Common.Utils.importTextType.TXT)(m=Common.localStorage.getItem("de-settings-open-encoding"))&&(c=parseInt(m));else if(this.type===Common.Utils.importTextType.CSV){(m=Common.localStorage.getItem("sse-settings-csv-encoding"))&&(c=parseInt(m))}else if(this.type===Common.Utils.importTextType.Data){(m=Common.localStorage.getItem("sse-settings-data-encoding"))&&(c=parseInt(m))}-1===c&&(c=o[r][0])}this.cmbEncoding.setValue(c),this.cmbEncoding.on("selected",_.bind(this.onCmbEncodingSelect,this));var h=this.cmbEncoding.cmpEl.find("ul"),d=h.find("li:nth(0) a"),u=h.width()-parseInt(d.css("padding-left"))-parseInt(d.css("padding-right"))-50;h.find("li div").width(u)}if(this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){var m,p="",f="";if(!this.preview)p=this.settings&&this.settings.asc_getDelimiter()?this.settings.asc_getDelimiter():4,f=this.settings&&this.settings.asc_getDelimiterChar()?this.settings.asc_getDelimiterChar():"",(m=Common.localStorage.getItem(this.type==Common.Utils.importTextType.CSV?"sse-settings-csv-delimiter":"sse-settings-data-delimiter"))&&(m=parseInt(m),isNaN(m)||-1===(p=m)&&(f=Common.localStorage.getItem(this.type==Common.Utils.importTextType.CSV?"sse-settings-csv-delimiter-char":"sse-settings-data-delimiter-char")||""));this.cmbDelimiter=new Common.UI.ComboBox({el:$("#id-delimiters-combo",this.$window),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:4,displayValue:this.txtComma},{value:2,displayValue:this.txtSemicolon},{value:3,displayValue:this.txtColon},{value:1,displayValue:this.txtTab},{value:5,displayValue:this.txtSpace},{value:-1,displayValue:this.txtOther}],editable:!1,takeFocusOnClose:!0}),this.cmbDelimiter.setValue(p),this.cmbDelimiter.on("selected",_.bind(this.onCmbDelimiterSelect,this)),this.inputDelimiter=new Common.UI.InputField({el:$("#id-delimiter-other"),style:"width: 30px;",maxLength:1,validateOnChange:!0,validateOnBlur:!1,value:f}),this.inputDelimiter.setVisible(-1===p),this.inputDelimiter.on("changing",_.bind(this.onInputCharChanging,this)),this.type!=Common.Utils.importTextType.Paste&&this.type!=Common.Utils.importTextType.Columns&&this.type!=Common.Utils.importTextType.Data||(this.btnAdvanced=new Common.UI.Button({el:$("#id-delimiters-advanced")}),this.btnAdvanced.on("click",_.bind(this.onAdvancedClick,this)))}},updatePreview:function(){this._previewTdWidth=[],this._previewTdMaxLength=0;var t=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0;switch(this.type){case Common.Utils.importTextType.CSV:case Common.Utils.importTextType.TXT:case Common.Utils.importTextType.Data:this.api.asc_decodeBuffer(this.preview,t,_.bind(this.textCallback,this));break;case Common.Utils.importTextType.Paste:case Common.Utils.importTextType.Columns:this.api.asc_TextImport(t,_.bind(this.textCallback,this),this.type==Common.Utils.importTextType.Paste)}},textCallback:function(t){var e,i,n=this.cmbEncoding&&!this.cmbEncoding.isDisabled()?this.cmbEncoding.getValue():this.settings&&this.settings.asc_getCodePage()?this.settings.asc_getCodePage():0;if(this.detectedDelimiter||this.type===Common.Utils.importTextType.TXT)i=-1==(e=this.cmbDelimiter?this.cmbDelimiter.getValue():null)?this.inputDelimiter.getValue():null;else{var o=this.api.asc_getCSVDelimiter(t);t=o.text,i=-1===(e=o.delimiter||-1)&&o.delimiterChar||"",this.cmbDelimiter.setValue(e),this.inputDelimiter.setVisible(-1===e),this.inputDelimiter.setValue(i),this.detectedDelimiter=!0}var s=new Asc.asc_CTextOptions(n,e,i);this.separatorOptions&&(s.asc_setNumberDecimalSeparator(this.separatorOptions.decimal),s.asc_setNumberGroupSeparator(this.separatorOptions.thousands),s.asc_setTextQualifier(this.separatorOptions.qualifier)),this.previewCallback(this.api.asc_parseText(t,s))},previewCallback:function(t){t&&t.length&&(this.data=t,this.previewInner.height(17*t.length),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,alwaysVisibleY:!0,alwaysVisibleX:!0,onChange:_.bind((function(){if(this.scrollerY){var t=this.scrollerY.getScrollTop(),e=Math.floor(t/17+.5),i=e+Math.min(6,this.data.length);i>this.data.length&&(i=this.data.length,t=17*(e=this.data.length-6)),this.previewParent.height(108),this.previewParent.css({top:t}),this.previewDataBlock(this.data.slice(e,i))}}),this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0))},previewDataBlock:function(t){if(_.isUndefined(this.scrollerX)||(this.scrollerX.destroy(),delete this.scrollerX),this.type==Common.Utils.importTextType.CSV||this.type==Common.Utils.importTextType.Paste||this.type==Common.Utils.importTextType.Columns||this.type==Common.Utils.importTextType.Data){for(var e=0,i=0;i<t.length;i++){(o=t[i]||"").length>e&&(e=o.length)}this._previewTdMaxLength=Math.max(this._previewTdMaxLength,e);var n="<table>";for(i=0;i<t.length;i++){var o=t[i]||"";n+='<tr style="vertical-align: top;">';for(var s=0;s<o.length;s++){var a="";0==i&&this._previewTdWidth[s]&&(a='style="min-width:'+this._previewTdWidth[s]+'px;"'),n+="<td "+a+">"+Common.Utils.String.htmlEncode(o[s])+"</td>"}for(s=o.length;s<this._previewTdMaxLength;s++){a="";0==i&&this._previewTdWidth[s]&&(a='style="min-width:'+this._previewTdWidth[s]+'px;"'),n+="<td "+a+"></td>"}n+="</tr>"}n+="</table>"}else{for(n="<table>",i=0;i<t.length;i++){o=t[i]||"";n+='<tr style="vertical-align: top;"><td>'+Common.Utils.String.htmlEncode(o)+"</td></tr>"}n+="</table>"}if(this.previewPanel.html(n),t.length>0){var r=this;0===this._previewTdWidth.length&&this.previewScrolled.scrollLeft(0),this.previewPanel.find("tr:first td").each((function(t,e){r._previewTdWidth[t]=Math.max(Math.max(Math.ceil($(e).outerWidth()),30),r._previewTdWidth[t]||0)}))}this.scrollerX=new Common.UI.Scroller({el:this.previewPanel,suppressScrollY:!0,alwaysVisibleX:!0,minScrollbarLength:20})},onCmbDelimiterSelect:function(t,e){this.inputDelimiter.setVisible(-1==e.value);var i=this;-1==e.value&&setTimeout((function(){i.inputDelimiter.focus()}),10),this.preview&&this.updatePreview(),this._isDelimChanged=!0},onInputCharChanging:function(){this.preview&&this.updatePreview(),this._isDelimCharChanged=!0},onCmbEncodingSelect:function(t,e){this.preview&&this.updatePreview(),this._isEncodingChanged=!0},onAdvancedClick:function(){if(SSE){var t=this,e=this.separatorOptions?this.separatorOptions.decimal:this.api.asc_getDecimalSeparator(),i=this.separatorOptions?this.separatorOptions.thousands:this.api.asc_getGroupSeparator(),n=this.separatorOptions?this.separatorOptions.qualifier:(this.settings||new Asc.asc_CTextOptions).asc_getTextQualifier();new SSE.Views.AdvancedSeparatorDialog({props:{decimal:e,thousands:i,qualifier:n},handler:function(n,o){"ok"==n&&(t.separatorOptions={decimal:o.decimal.length>0?o.decimal:e,thousands:o.thousands.length>0?o.thousands:i,qualifier:o.qualifier},t.preview&&t.updatePreview())}}).on("close",(function(){t.btnAdvanced.focus()})).show()}},onSelectData:function(t){var e=this,i=e.txtDestRange;if(e.api){var n=new SSE.Views.CellRangeDialog({handler:function(t,n){if("ok"==n){var o=t.getSettings();e.dataDestValid=o,i.setValue(o),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),o=Common.Utils.getOffset(e.$window);e.hide(),n.show(e.$window,o),n.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?e.dataDestValid:i.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus(),t)},txtDelimiter:"Delimiter",txtEncoding:"Encoding ",txtSpace:"Space",txtTab:"Tab",txtTitle:"Choose %1 options",txtPassword:"Password",txtTitleProtected:"Protected File",txtOther:"Other",txtIncorrectPwd:"Password is incorrect.",closeButtonText:"Close File",txtPreview:"Preview",txtComma:"Comma",txtColon:"Colon",txtSemicolon:"Semicolon",txtProtected:"Once you enter the password and open the file, the current password to the file will be reset.",txtAdvanced:"Advanced",txtOpenFile:"Enter a password to open the file",textSelectData:"Select data",txtDestData:"Choose where to put the data",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},Common.Views.OpenDialog||{}))})),define("common/main/lib/view/UserNameDialog",["common/main/lib/component/Window"],(function(){"use strict";Common.Views.UserNameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,modal:!1,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div style="margin-bottom: 2px;">'+(this.options.label?this.options.label:this.textLabel)+"</div>",'<div id="id-dlg-username-caption" class="input-row"></div>','<div id="id-dlg-username-chk-use" class="" style="margin-top: 10px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=new Common.UI.InputField({el:$("#id-dlg-username-caption"),allowBlank:!0,style:"width: 100%;",maxLength:128,validateOnBlur:!1,validation:t.options.validation||function(t){return!!t||""}}),t.inputLabel.setValue(this.options.value||""),t.chDontShow=new Common.UI.CheckBox({el:$("#id-dlg-username-chk-use"),labelText:this.textDontShow,value:this.options.check}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,{input:this.inputLabel.getValue(),checkbox:"checked"==this.chDontShow.getValue()})}this.close()},textLabel:"Label:",textLabelError:"Label must not be empty.",textDontShow:"Don't ask me again"},Common.Views.UserNameDialog||{}))})),define("visioeditor/main/app/controller/Main",["core","irregularstack","common/main/lib/component/Window","common/main/lib/component/LoadMask","common/main/lib/component/Tooltip","common/main/lib/util/LocalStorage","common/main/lib/controller/FocusManager","common/main/lib/controller/LaunchController","common/main/lib/controller/HintManager","common/main/lib/controller/LayoutManager","common/main/lib/controller/ExternalUsers","common/main/lib/view/OpenDialog","common/main/lib/view/UserNameDialog"],(function(){"use strict";var t,e,i,n;VE.Controllers.Main=Backbone.Controller.extend(_.extend((e=-256,i={about:"button#left-btn-about",feedback:"button#left-btn-support"},n={toolbar:"#viewport #toolbar",leftMenu:"#viewport #left-menu, #viewport #id-toolbar-full-placeholder-btn-settings, #viewport #id-toolbar-short-placeholder-btn-settings",statusBar:"#statusbar"},Common.localStorage.setId("visio"),Common.localStorage.setKeysFilter("ve-,asc.visio"),Common.localStorage.sync(),{models:[],collections:[],views:[],initialize:function(){this.addListeners({FileMenu:{"settings:apply":_.bind(this.applySettings,this)}}),this.translationTable={}},onLaunch:function(){var t=this;if(this.stackLongActions=new Common.IrregularStack({strongCompare:function(t,e){return t.id===e.id&&t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackDisableActions=new Common.IrregularStack({strongCompare:function(t,e){return t.type===e.type},weakCompare:function(t,e){return t.type===e.type}}),this.stackMacrosRequests=[],this._state={isDisconnected:!1,usersCount:1,fastCoauth:!0,lostEditingRights:!1,licenseType:!1,isDocModified:!1,requireUserAction:!0},this.languages=null,!Common.Utils.isBrowserSupported())return Common.Utils.showBrowserRestriction(),void Common.Gateway.reportError(void 0,this.unsupportedBrowserErrorText);if(window.flat_desine=!0,this.api=this.getApplication().getController("Viewport").getApi(),Common.UI.FocusManager.init(),Common.UI.HintManager.init(this.api),Common.UI.Themes.init(this.api),Common.Controllers.LaunchController.init(this.api),this.api){this.api.SetDrawingFreeze(!0);var e=Common.localStorage.getBool("ve-settings-cachemode",!0);switch(Common.Utils.InternalSettings.set("ve-settings-cachemode",e),this.api.asc_setDefaultBlitMode(!!e),null===(e=Common.localStorage.getItem("ve-settings-fontrender"))&&(e="0"),Common.Utils.InternalSettings.set("ve-settings-fontrender",e),e){case"0":this.api.SetFontRenderingMode(3);break;case"1":this.api.SetFontRenderingMode(1);break;case"2":this.api.SetFontRenderingMode(2)}if(e=Common.localStorage.getBool("app-settings-screen-reader"),Common.Utils.InternalSettings.set("app-settings-screen-reader",e),this.api.setSpeechEnabled(e),!Common.Utils.isIE&&/^https?:\/\//.test("{{HELP_CENTER_WEB_VE}}")){const t=new URL("{{HELP_CENTER_WEB_VE}}");t.searchParams&&t.searchParams.set("lang",Common.Locale.getCurrentLanguage()),Common.Utils.InternalSettings.set("url-help-center",t.toString())}this.api.asc_registerCallback("asc_onError",_.bind(this.onError,this)),this.api.asc_registerCallback("asc_onDocumentContentReady",_.bind(this.onDocumentContentReady,this)),this.api.asc_registerCallback("asc_onOpenDocumentProgress",_.bind(this.onOpenDocument,this)),this.api.asc_registerCallback("asc_onDocumentUpdateVersion",_.bind(this.onUpdateVersion,this)),this.api.asc_registerCallback("asc_onServerVersion",_.bind(this.onServerVersion,this)),this.api.asc_registerCallback("asc_onAdvancedOptions",_.bind(this.onAdvancedOptions,this)),this.api.asc_registerCallback("asc_onDocumentName",_.bind(this.onDocumentName,this)),this.api.asc_registerCallback("asc_onPrintUrl",_.bind(this.onPrintUrl,this)),this.api.asc_registerCallback("asc_onMeta",_.bind(this.onMeta,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("goback",_.bind(this.goBack,this)),Common.NotificationCenter.on("close",_.bind(this.closeEditor,this)),Common.NotificationCenter.on("markfavorite",_.bind(this.markFavorite,this)),Common.NotificationCenter.on("download:advanced",_.bind(this.onAdvancedOptions,this)),Common.NotificationCenter.on("showmessage",_.bind(this.onExternalMessage,this)),Common.NotificationCenter.on("showerror",_.bind(this.onError,this)),Common.NotificationCenter.on("editing:disable",_.bind(this.onEditingDisable,this)),this.isShowOpenDialog=!1,this.editorConfig={},this.appOptions={},Common.Gateway.on("init",_.bind(this.loadConfig,this)),Common.Gateway.on("showmessage",_.bind(this.onExternalMessage,this)),Common.Gateway.on("opendocument",_.bind(this.loadDocument,this)),Common.Gateway.on("opendocumentfrombinary",_.bind(this.loadBinary,this)),Common.Gateway.on("grabfocus",_.bind(this.onGrabFocus,this)),Common.Gateway.appReady(),this.getApplication().getController("Viewport").setApi(this.api),this.getApplication().getController("Statusbar").setApi(this.api),$(document.body).on("focus","input, textarea",(function(e){/area_id/.test(e.target.id)||/msg-reply/.test(e.target.className)||(/textarea-control/.test(e.target.className)?t.inTextareaControl=!0:!Common.Utils.ModalWindow.isVisible()&&/form-control/.test(e.target.className)&&(t.inFormControl=!0))})),$(document.body).on("blur","input, textarea",(function(e){if(!Common.Utils.ModalWindow.isVisible()){if(/form-control/.test(e.target.className)&&(t.inFormControl=!1),t.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file").isVisible())return;if(!e.relatedTarget||!/area_id/.test(e.target.id)&&!("input"==e.target.localName&&$(e.target).parent().find(e.relatedTarget).length>0)&&!("textarea"==e.target.localName&&$(e.target).closest(".asc-window").find(".dropdown-menu").find(e.relatedTarget).length>0)&&("input"!=e.relatedTarget.localName||!/form-control/.test(e.relatedTarget.className))&&("textarea"!=e.relatedTarget.localName||/area_id/.test(e.relatedTarget.id))){if(Common.Utils.isIE&&e.originalEvent&&e.originalEvent.target&&/area_id/.test(e.originalEvent.target.id)&&e.originalEvent.target===e.originalEvent.srcElement)return;Common.Utils.isLinux&&t.appOptions&&t.appOptions.isDesktopApp?(e.relatedTarget||!e.originalEvent||e.originalEvent.sourceCapabilities)&&t.api.asc_enableKeyEvents(!0):t.api.asc_enableKeyEvents(!0),/textarea-control/.test(e.target.className)&&(t.inTextareaControl=!1)}}})).on("dragover",(function(t){var e=t.originalEvent;if(e.target&&$(e.target).closest("#editor_sdk").length<1)return e.preventDefault(),e.dataTransfer.dropEffect="none",!1})).on("dragstart",(function(t){var e=t.originalEvent;if(e.target){var i=$(e.target);(i.closest(".combobox").length>0||i.closest(".dropdown-menu").length>0||i.closest(".input-field").length>0||i.closest(".spinner").length>0||i.closest(".textarea-field").length>0||i.closest(".ribtab").length>0||i.closest(".combo-dataview").length>0)&&e.preventDefault()}})).on("mouseup",(function(t){})),Common.Utils.isChrome&&$(document.body).on("keydown","textarea",(function(t){t.keyCode!==Common.UI.Keys.PAGEUP&&t.keyCode!==Common.UI.Keys.PAGEDOWN||setTimeout((function(){$("#viewport").scrollLeft(0),$("#viewport").scrollTop(0)}),0)})),Common.NotificationCenter.on({"modal:show":function(){Common.Utils.ModalWindow.show(),t.api.asc_enableKeyEvents(!1)},"modal:close":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"modal:hide":function(e){Common.Utils.ModalWindow.close(),Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"dataview:focus":function(t){},"dataview:blur":function(e){Common.Utils.ModalWindow.isVisible()||t.api.asc_enableKeyEvents(!0)},"menu:show":function(t){},"menu:hide":function(e,i){Common.Utils.ModalWindow.isVisible()||i||t.api.asc_enableKeyEvents(!0)},"edit:complete":_.bind(t.onEditComplete,t)}),Common.util.Shortcuts.delegateShortcuts({shortcuts:{"command+s,ctrl+s,command+p,ctrl+p,command+d,ctrl+d":_.bind((function(t){t.preventDefault(),t.stopPropagation()}),this)}})}t.defaultTitleText="ONLYOFFICE",t.warnNoLicense=(t.warnNoLicense||"").replace(/%1/g,"KKK"),t.warnNoLicenseUsers=(t.warnNoLicenseUsers||"").replace(/%1/g,"KKK"),t.textNoLicenseTitle=(t.textNoLicenseTitle||"").replace(/%1/g,"KKK"),t.warnLicenseExceeded=(t.warnLicenseExceeded||"").replace(/%1/g,"KKK"),t.warnLicenseUsersExceeded=(t.warnLicenseUsersExceeded||"").replace(/%1/g,"KKK")},loadConfig:function(e){var i;if(this.editorConfig=$.extend(this.editorConfig,e.config),this.appOptions.customization=this.editorConfig.customization,this.appOptions.canRenameAnonymous=!("object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&!1===this.appOptions.customization.anonymous.request),this.appOptions.guestName="object"==typeof this.appOptions.customization&&"object"==typeof this.appOptions.customization.anonymous&&"string"==typeof this.appOptions.customization.anonymous.label&&""!==this.appOptions.customization.anonymous.label.trim()?Common.Utils.String.htmlEncode(this.appOptions.customization.anonymous.label):this.textGuest,this.appOptions.canRenameAnonymous&&(i=Common.localStorage.getItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",i),Common.Utils.InternalSettings.set("save-guest-username",!!i)),this.appOptions.customization.font){if(this.appOptions.customization.font.name&&"string"==typeof this.appOptions.customization.font.name){for(var n=this.appOptions.customization.font.name.split(","),o=0;o<n.length;o++){var s=n[o].trim();s&&/[\s0-9\.]/.test(s)&&(n[o]="'"+s+"'")}document.documentElement.style.setProperty("--font-family-base-custom",n.join(","))}if(this.appOptions.customization.font.size){var a=parseInt(this.appOptions.customization.font.size);!isNaN(a)&&document.documentElement.style.setProperty("--font-size-base-app-custom",a+"px")}}this.editorConfig.user=this.appOptions.user=Common.Utils.fillUserInfo(this.editorConfig.user,this.editorConfig.lang,i?i+" ("+this.appOptions.guestName+")":this.textAnonymous,Common.localStorage.getItem("guest-id")||"uid-"+Date.now()),this.appOptions.user.anonymous&&Common.localStorage.setItem("guest-id",this.appOptions.user.id),this.appOptions.isDesktopApp="desktop"==this.editorConfig.targetApp||Common.Controllers.Desktop.isActive(),Common.Controllers.Desktop.isActive()&&!this.editorConfig.recent&&(this.editorConfig.recent=[]),this.appOptions.canCreateNew=this.editorConfig.canRequestCreateNew||this.editorConfig.templates&&this.editorConfig.templates.length,this.appOptions.canOpenRecent=void 0!==this.editorConfig.recent,this.appOptions.templates=this.editorConfig.templates,this.appOptions.recent=this.editorConfig.recent,this.appOptions.createUrl=this.editorConfig.createUrl,this.appOptions.canRequestCreateNew=this.editorConfig.canRequestCreateNew,this.appOptions.lang=this.editorConfig.lang,this.appOptions.location="string"==typeof this.editorConfig.location?this.editorConfig.location.toLowerCase():"",this.appOptions.region="string"==typeof this.editorConfig.region?this.editorConfig.region.toLowerCase():this.editorConfig.region,this.appOptions.sharingSettingsUrl=this.editorConfig.sharingSettingsUrl,this.appOptions.fileChoiceUrl=this.editorConfig.fileChoiceUrl,this.appOptions.saveAsUrl=this.editorConfig.saveAsUrl,this.appOptions.canAnalytics=!1,this.appOptions.canPlugins=!1,this.appOptions.canMakeActionLink=!1,this.appOptions.canRequestUsers=this.editorConfig.canRequestUsers,this.appOptions.canRequestSendNotify=this.editorConfig.canRequestSendNotify,this.appOptions.canRequestSaveAs=this.editorConfig.canRequestSaveAs,this.appOptions.canRequestInsertImage=!1,this.appOptions.canRequestSharingSettings=this.editorConfig.canRequestSharingSettings,this.appOptions.compatibleFeatures=!0,this.appOptions.mentionShare=!("object"==typeof this.appOptions.customization&&0==this.appOptions.customization.mentionShare),this.appOptions.canSaveDocumentToBinary=this.editorConfig.canSaveDocumentToBinary,this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&Common.NotificationCenter.on("user:rename",_.bind(this.showRenameUserDialog,this)),this.appOptions.canRequestClose=this.editorConfig.canRequestClose,this.appOptions.canCloseEditor=!1,this.appOptions.canSwitchToMobile=this.editorConfig.forceDesktop;var r=!1;"object"==typeof this.appOptions.customization&&("object"==typeof this.appOptions.customization.goback&&!1!==this.editorConfig.canBackToFolder&&(r=void 0===this.appOptions.customization.close?!_.isEmpty(this.editorConfig.customization.goback.url)||this.editorConfig.customization.goback.requestClose&&this.appOptions.canRequestClose:!_.isEmpty(this.editorConfig.customization.goback.url)&&!this.editorConfig.customization.goback.requestClose,this.appOptions.customization.goback.requestClose&&console.log("Obsolete: The 'requestClose' parameter of the 'customization.goback' section is deprecated. Please use 'close' parameter in the 'customization' section instead.")),this.appOptions.customization.close&&"object"==typeof this.appOptions.customization.close&&(this.appOptions.canCloseEditor=!1!==this.appOptions.customization.close.visible&&this.appOptions.canRequestClose&&!this.appOptions.isDesktopApp)),this.appOptions.canBack=this.appOptions.canBackToFolder=!!r,(t=this.getApplication().getController("Viewport").getView("Common.Views.Header")).setCanBack(this.appOptions.canBack,this.appOptions.canBack?this.editorConfig.customization.goback.text:""),this.editorConfig.lang&&this.api.asc_setLocale(this.editorConfig.lang),this.loadDefaultMetricSettings(),this.appOptions.wopi=this.editorConfig.wopi,t.setWopi(this.appOptions.wopi),this.editorConfig.canRequestRefreshFile&&(Common.Gateway.on("refreshfile",_.bind(this.onRefreshFile,this)),this.api.asc_registerCallback("asc_onRequestRefreshFile",_.bind(this.onRequestRefreshFile,this))),Common.Controllers.Desktop.init(this.appOptions),Common.UI.HintManager.setMode(this.appOptions)},loadDocument:function(e){this.permissions={},this.document=e.doc;var i={};if(e.doc){this.permissions=$.extend(this.permissions,e.doc.permissions);var n=$.extend({},e.doc.options,this.editorConfig.actionLink||{}),o=new Asc.asc_CUserInfo;o.put_Id(this.appOptions.user.id),o.put_FullName(this.appOptions.user.fullname),o.put_IsAnonymousUser(!!this.appOptions.user.anonymous),(i=new Asc.asc_CDocInfo).put_Id(e.doc.key),i.put_Url(e.doc.url),i.put_DirectUrl(e.doc.directUrl),i.put_Title(e.doc.title),i.put_Format(e.doc.fileType),i.put_VKey(e.doc.vkey),i.put_Options(n),i.put_UserInfo(o),i.put_CallbackUrl(this.editorConfig.callbackUrl),i.put_Token(e.doc.token),i.put_Permissions(e.doc.permissions),i.put_EncryptedInfo(this.editorConfig.encryptionKeys),i.put_Lang(this.editorConfig.lang),i.put_Mode(this.editorConfig.mode),i.put_SupportsOnSaveDocument(this.editorConfig.canSaveDocumentToBinary),i.put_Wopi(this.editorConfig.wopi),this.editorConfig.shardkey&&i.put_Shardkey(this.editorConfig.shardkey);var s=!this.editorConfig.customization||!1!==this.editorConfig.customization.macros;i.asc_putIsEnabledMacroses(!!s),s=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins,i.asc_putIsEnabledPlugins(!!s),i.put_CoEditingMode("strict")}this.editorConfig.customization&&(this.editorConfig.customization.toolbarNoTabs||"desktop"!==this.editorConfig.targetApp&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo))||$("#editor-container").append('<div class="doc-placeholder"><div class="slide-h"><div class="slide-v"><div class="slide-container"></div></div></div></div>'),this.api.asc_registerCallback("asc_onGetEditorPermissions",_.bind(this.onEditorPermissions,this)),this.api.asc_registerCallback("asc_onLicenseChanged",_.bind(this.onLicenseChanged,this)),this.api.asc_setDocInfo(i),this.api.asc_getEditorPermissions(this.editorConfig.licenseUrl,this.editorConfig.customerId),e.doc&&t.setDocumentCaption(e.doc.title)},onRunAutostartMacroses:function(){this.editorConfig.customization&&!1===this.editorConfig.customization.macros||this.api.asc_runAutostartMacroses()},onProcessRightsChange:function(t){if(t&&!1===t.enabled){var e=this,i=this._state.lostEditingRights;this._state.lostEditingRights=!this._state.lostEditingRights,this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("collaboration:sharingdeny"),Common.NotificationCenter.trigger("api:disconnect"),!i&&Common.UI.TooltipManager.showTip({step:"changeRights",text:_.isEmpty(t.message)?this.warnProcessRightsChange:t.message,target:"#toolbar",maxwidth:600,showButton:!1,automove:!0,noHighlight:!0,multiple:!0,callback:function(){e._state.lostEditingRights=!1}})}},onDownloadAs:function(t){if(this.appOptions.canDownload||this.appOptions.canDownloadOrigin){this._state.isFromGatewayDownloadAs=!0;var e=t&&"string"==typeof t?Asc.c_oAscFileType[t.toUpperCase()]:null,i=[Asc.c_oAscFileType.VSDX,Asc.c_oAscFileType.PDF,Asc.c_oAscFileType.PDFA,Asc.c_oAscFileType.PNG,Asc.c_oAscFileType.JPG];(!e||i.indexOf(e)<0)&&(e=Asc.c_oAscFileType.VSDX);var n=new Asc.asc_CDownloadOptions(e,!0);n.asc_setIsSaveAs(!0),this.api.asc_DownloadAs(n)}else Common.Gateway.reportError(Asc.c_oAscError.ID.AccessDeny,this.errorAccessDeny)},onProcessMouse:function(t){if("mouseup"==t.type){var e=document.getElementById("editor_sdk");if(e){var i=Common.Utils.getBoundingClientRect(e);this.api.OnMouseUp(t.x-i.left,t.y-i.top)}}},disableEditing:function(t,e){!e&&(e="disconnect");var i="reconnect"===e||"refresh-file"===e;Common.NotificationCenter.trigger("editing:disable",t,{viewMode:t,statusBar:!0,leftMenu:{disable:!0,previewMode:!0},fileMenu:{protect:!0},chat:!0,viewport:!0,documentHolder:{clear:!i,disable:!0},toolbar:!0,plugins:!1,header:{search:"not-loaded"===e},shortcuts:"not-loaded"===e},e||"disconnect")},onEditingDisable:function(e,i,n){var o=this.getApplication(),s={type:n,disable:e,options:i};e&&!this.stackDisableActions.get({type:n})&&this.stackDisableActions.push(s),!e&&this.stackDisableActions.pop({type:n});var a=!e&&this.stackDisableActions.length()>0?this.stackDisableActions.get(this.stackDisableActions.length()-1):null;i.statusBar&&o.getController("Statusbar").getView("Statusbar").SetDisabled(e),i.viewport&&o.getController("Viewport").SetDisabled(e),i.toolbar&&o.getController("Toolbar").DisableToolbar(e,i.viewMode),i.documentHolder&&(i.documentHolder.clear&&o.getController("DocumentHolder").clearSelection(),i.documentHolder.disable&&o.getController("DocumentHolder").SetDisabled(e)),i.leftMenu&&(i.leftMenu.disable&&o.getController("LeftMenu").SetDisabled(e,i),i.leftMenu.previewMode&&o.getController("LeftMenu").setPreviewMode(e)),i.fileMenu&&(o.getController("LeftMenu").leftMenu.getMenu("file").SetDisabled(e,i.fileMenu),i.leftMenu.disable&&o.getController("LeftMenu").leftMenu.getMenu("file").applyMode()),i.plugins&&o.getController("Common.Controllers.Plugins").getView("Common.Views.Plugins").SetDisabled(e),i.header&&(i.header.search&&t&&t.lockHeaderBtns("search",e),t&&t.lockHeaderBtns("undo",i.viewMode,Common.enumLock.lostConnect),t&&t.lockHeaderBtns("redo",i.viewMode,Common.enumLock.lostConnect)),i.shortcuts&&(e?Common.util.Shortcuts.suspendEvents():Common.util.Shortcuts.resumeEvents()),a&&this.onEditingDisable(a.disable,a.options,a.type)},disableLiveViewing:function(t){this.appOptions.canLiveView=!t,this.api.asc_SetFastCollaborative(!t),Common.Utils.InternalSettings.set("ve-settings-coauthmode",!t)},onRequestClose:function(){var t=this;this.api.isDocumentModified()?(this.api.asc_stopSaving(),Common.UI.warning({closable:!1,width:500,title:this.notcriticalErrorTitle,msg:this.leavePageTextOnClose,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e?(t.api.asc_undoAllChanges(),t.api.asc_continueSaving(),Common.Gateway.requestClose()):t.api.asc_continueSaving()}})):Common.Gateway.requestClose()},goBack:function(t){if(!Common.Controllers.Desktop.process("goback"))if(this.appOptions.customization.goback.requestClose&&this.appOptions.canRequestClose)this.onRequestClose();else{var e=this.appOptions.customization.goback.url;t||!1===this.appOptions.customization.goback.blank?parent.location.href=e:window.open(e,"_blank")}},closeEditor:function(){this.appOptions.canRequestClose&&this.onRequestClose()},markFavorite:function(t){Common.Controllers.Desktop.process("markfavorite")||Common.Gateway.metaChange({favorite:t})},onSetFavorite:function(e){this.appOptions.canFavorite&&t.setFavorite(!!e)},onEditComplete:function(t){var e=this.getApplication();e.getController("Toolbar").getView(),e.getController("DocumentHolder").getView().focus(),Common.UI.HintManager.clearHints(!0)},onLongActionBegin:function(t,e){var i={id:e,type:t};this.stackLongActions.push(i),this.setLongActionView(i)},onLongActionEnd:function(e,i){var n={id:i,type:e};if(this.stackLongActions.pop(n),t&&t.setDocumentCaption(this.api.asc_getDocumentName()),this.updateWindowTitle(!0),n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.Information}))this.setLongActionView(n);else{var o=this;i!=Asc.c_oAscAsyncAction.Save&&i!=Asc.c_oAscAsyncAction.ForceSaveButton||this.appOptions.isOffline?this.getApplication().getController("Statusbar").setStatusCaption(""):this._state.fastCoauth&&this._state.usersCount>1?o._state.timerSave=setTimeout((function(){o.getApplication().getController("Statusbar").setStatusCaption(o.textChangesSaved,!1,3e3)}),500):o.getApplication().getController("Statusbar").setStatusCaption(o.textChangesSaved,!1,3e3)}(n=this.stackLongActions.get({type:Asc.c_oAscAsyncActionType.BlockInteraction}))?this.setLongActionView(n):this.loadMask&&this.loadMask.hide(),i==Asc.c_oAscAsyncAction.Disconnect?(this._state.timerDisconnect&&clearTimeout(this._state.timerDisconnect),this.disableEditing(!1,"reconnect"),Common.UI.TooltipManager.closeTip("disconnect"),this.getApplication().getController("Statusbar").setStatusCaption(this.textReconnect)):i===Asc.c_oAscAsyncAction.RefreshFile&&(this.disableEditing(!1,"refresh-file"),Common.UI.TooltipManager.closeTip("refreshFile"),this.getApplication().getController("Statusbar").setStatusCaption("")),e!=Asc.c_oAscAsyncActionType.BlockInteraction||this.getApplication().getController("LeftMenu").dlgSearch&&this.getApplication().getController("LeftMenu").dlgSearch.isVisible()||this.getApplication().getController("Toolbar").dlgSymbolTable&&this.getApplication().getController("Toolbar").dlgSymbolTable.isVisible()||(i==Asc.c_oAscAsyncAction.LoadDocumentFonts||i==Asc.c_oAscAsyncAction.LoadFonts||i==Asc.c_oAscAsyncAction.ApplyChanges||i==Asc.c_oAscAsyncAction.DownloadAs)&&(this.inTextareaControl||Common.Utils.ModalWindow.isVisible()||this.inFormControl)||this.api.asc_enableKeyEvents(!0)},setLongActionView:function(t){var i="",n="",o=!1;switch(t.id){case Asc.c_oAscAsyncAction.Open:i=this.openTitleText,n=this.openTextText;break;case Asc.c_oAscAsyncAction.Save:case Asc.c_oAscAsyncAction.ForceSaveButton:clearTimeout(this._state.timerSave),o=!0,i=this.saveTitleText,n=this.appOptions.isOffline?"":this.saveTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentFonts:i=this.loadFontsTitleText,n=this.loadFontsTextText;break;case Asc.c_oAscAsyncAction.LoadDocumentImages:i=this.loadImagesTitleText,n=this.loadImagesTextText;break;case Asc.c_oAscAsyncAction.LoadFont:i=this.loadFontTitleText,n=this.loadFontTextText;break;case Asc.c_oAscAsyncAction.LoadImage:i=this.loadImageTitleText,n=this.loadImageTextText;break;case Asc.c_oAscAsyncAction.DownloadAs:i=this.downloadTitleText,n=this.downloadTextText;break;case Asc.c_oAscAsyncAction.Print:i=this.printTitleText,n=this.printTextText;break;case Asc.c_oAscAsyncAction.UploadImage:i=this.uploadImageTitleText,n=this.uploadImageTextText;break;case Asc.c_oAscAsyncAction.ApplyChanges:i=this.applyChangesTitleText,n=this.applyChangesTextText;break;case Asc.c_oAscAsyncAction.Waiting:i=this.waitText,n=this.waitText;break;case-255:i=this.txtEditingMode,n=this.txtEditingMode;break;case e:i=this.loadingDocumentTitleText+"           ",n=this.loadingDocumentTextText;break;case Asc.c_oAscAsyncAction.Disconnect:return n=this.textDisconnect,Common.UI.Menu.Manager.hideAll(),this.disableEditing(!0,"reconnect"),this._state.timerDisconnect=setTimeout((function(){Common.UI.TooltipManager.showTip("disconnect")}),this._state.unloadTimer||0),void this.getApplication().getController("Statusbar").setStatusCaption(n);case Asc.c_oAscAsyncAction.RefreshFile:return i=this.textUpdating,n=this.textUpdating,Common.UI.Menu.Manager.hideAll(),this.disableEditing(!0,"refresh-file"),Common.UI.TooltipManager.showTip("refreshFile"),void this.getApplication().getController("Statusbar").setStatusCaption(n);default:"string"==typeof t.id&&(i=t.id,n=t.id)}t.type==Asc.c_oAscAsyncActionType.BlockInteraction?(this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:$("#viewport")})),this.loadMask.setTitle(i),this.isShowOpenDialog||this.loadMask.show(t.id===Asc.c_oAscAsyncAction.Open)):this.getApplication().getController("Statusbar").setStatusCaption(n,o,0,null)},onApplyEditRights:function(t){this.getApplication().getController("Statusbar").setStatusCaption(""),t&&!t.allowed&&Common.UI.info({title:this.requestEditFailedTitleText,msg:t.message||this.requestEditFailedMessageText})},onDocumentContentReady:function(){if(!this._isDocReady){this._state.openDlg&&this._state.openDlg.close();var i,n=this;i=Common.localStorage.getItem("ve-settings-zoom"),Common.Utils.InternalSettings.set("ve-settings-zoom",i);var o=null!==i?parseInt(i):this.appOptions.customization&&this.appOptions.customization.zoom?parseInt(this.appOptions.customization.zoom):-1,s=null!==(i=Common.localStorage.getItem("ve-last-zoom"))?parseInt(i):0;n._isDocReady=!0,Common.NotificationCenter.trigger("app:ready",this.appOptions),n.api.SetDrawingFreeze(!1),n.hidePreloader(),n.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,e),-1==o?this.api.zoomFitToPage():-2==o?this.api.zoomFitToWidth():-3==o?s>0?this.api.zoom(s):-1==s?this.api.zoomFitToPage():-2==s&&this.api.zoomFitToWidth():this.api.zoom(o>0?o:100),i=Common.localStorage.getBool("ve-settings-compatible",!1),Common.Utils.InternalSettings.set("ve-settings-compatible",i),void 0!==document.hidden&&document.hidden?document.addEventListener("visibilitychange",p):p(),n.api.asc_registerCallback("asc_onStartAction",_.bind(n.onLongActionBegin,n)),n.api.asc_registerCallback("asc_onEndAction",_.bind(n.onLongActionEnd,n)),n.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(n.onCoAuthoringDisconnect,n)),n.api.asc_registerCallback("asc_onPrint",_.bind(n.onPrint,n)),t.setDocumentCaption(n.api.asc_getDocumentName()),n.updateWindowTitle(!0),i=Common.localStorage.getBool("ve-settings-show-alt-hints",!Common.Utils.isMac),Common.Utils.InternalSettings.set("ve-settings-show-alt-hints",i),n.onCoAuthApply();var a=n.getApplication(),r=a.getController("Toolbar"),l=a.getController("Statusbar"),c=a.getController("DocumentHolder"),h=a.getController("LeftMenu"),d=a.getController("Common.Controllers.Chat"),u=a.getController("Common.Controllers.Plugins");h.getView("LeftMenu").getMenu("file").loadDocument({doc:n.document}),h.createDelayedElements().setApi(n.api),d.setApi(this.api).setMode(this.appOptions),u.setApi(n.api),c.setApi(n.api),l.createDelayedElements(),h.getView("LeftMenu").disableMenu("all",!1),n.appOptions.canBranding&&n.getApplication().getController("LeftMenu").leftMenu.getMenu("about").setLicInfo(n.editorConfig.customization),c.getView().on("editcomplete",_.bind(n.onEditComplete,n)),n.appOptions.isEdit?(n.needToUpdateVersion&&Common.NotificationCenter.trigger("api:disconnect"),setTimeout((function(){r.createDelayedElements(),r.activateControls(),c.applyEditorMode(),n.needToUpdateVersion&&r.onApiCoAuthoringDisconnect(),r.onApiFocusObject([]),n.api.UpdateInterfaceState(),Common.NotificationCenter.trigger("document:ready","main"),n.applyLicense()}),500)):(Common.NotificationCenter.trigger("document:ready","main"),Common.Utils.injectSvgIcons(),n.applyLicense());var m=~~(1e6*Math.random());$(".toolbar").prepend(Common.Utils.String.format('<div class="lazy-{0} x-huge"><div class="toolbar__icon" style="position: absolute; width: 1px; height: 1px;"></div>',m)),setTimeout((function(){$(Common.Utils.String.format(".toolbar .lazy-{0}",m)).remove()}),10),this.appOptions.canAnalytics,Common.Gateway.on("applyeditrights",_.bind(n.onApplyEditRights,n)),Common.Gateway.on("processrightschange",_.bind(n.onProcessRightsChange,n)),Common.Gateway.on("processmouse",_.bind(n.onProcessMouse,n)),Common.Gateway.on("downloadas",_.bind(n.onDownloadAs,n)),Common.Gateway.on("setfavorite",_.bind(n.onSetFavorite,n)),Common.Gateway.on("requestclose",_.bind(n.onRequestClose,n)),this.appOptions.canRequestSaveAs&&Common.Gateway.on("internalcommand",(function(t){"wopi:saveAsComplete"==t.command&&n.onExternalMessage({msg:n.txtSaveCopyAsComplete})})),Common.Gateway.sendInfo({mode:n.appOptions.isEdit?"edit":"view"}),(n.appOptions.sharingSettingsUrl&&n.appOptions.sharingSettingsUrl.length||n.appOptions.canRequestSharingSettings)&&(Common.Gateway.on("showsharingsettings",_.bind(n.changeAccessRights,n)),Common.Gateway.on("setsharingsettings",_.bind(n.setSharingSettings,n)),Common.NotificationCenter.on("collaboration:sharing",_.bind(n.changeAccessRights,n)),Common.NotificationCenter.on("collaboration:sharingdeny",_.bind(n.setSharingSettings,n))),$(document).on("contextmenu",_.bind(n.onContextMenu,n)),Common.Gateway.documentReady(),this._state.requireUserAction=!1,$(".doc-placeholder").remove(),this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&null===Common.Utils.InternalSettings.get("guest-username")&&this.showRenameUserDialog(),this._needToSaveAsFile&&this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas")}function p(){if(!Common.Controllers.Desktop.isActive()){var t=[];Common.Utils.isIE9m&&t.push(n.warnBrowserIE9),t.length&&n.showTips(t)}document.removeEventListener("visibilitychange",p)}},onLicenseChanged:function(t){var e=t.asc_getLicenseType();void 0!==e&&(this.appOptions.canEdit||this.appOptions.isRestrictedEdit)&&"view"!==this.editorConfig.mode&&(e===Asc.c_oLicenseResult.Connections||e===Asc.c_oLicenseResult.UsersCount||e===Asc.c_oLicenseResult.ConnectionsOS||e===Asc.c_oLicenseResult.UsersCountOS||e===Asc.c_oLicenseResult.SuccessLimit&&0!=(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited))&&(this._state.licenseType=e),void 0===e||!this.appOptions.canLiveView||e!==Asc.c_oLicenseResult.ConnectionsLive&&e!==Asc.c_oLicenseResult.ConnectionsLiveOS&&e!==Asc.c_oLicenseResult.UsersViewCount&&e!==Asc.c_oLicenseResult.UsersViewCountOS||(this._state.licenseType=e),this._isDocReady&&this.applyLicense()},applyLicense:function(){if("view"===this.editorConfig.mode)this.appOptions.canLiveView&&(this._state.licenseType===Asc.c_oLicenseResult.ConnectionsLive||this._state.licenseType===Asc.c_oLicenseResult.ConnectionsLiveOS||this._state.licenseType===Asc.c_oLicenseResult.UsersViewCount||this._state.licenseType===Asc.c_oLicenseResult.UsersViewCountOS||!this.appOptions.isAnonymousSupport&&this.appOptions.user.anonymous)&&this.disableLiveViewing(!0);else if(!this.appOptions.isAnonymousSupport&&this.appOptions.user.anonymous)this.disableEditing(!0),this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"),Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.warnLicenseAnonymous,buttons:["ok"]});else if(this._state.licenseType){var t=this._state.licenseType,e=["ok"],i="ok";0==(this.appOptions.trialMode&Asc.c_oLicenseMode.Limited)||t!==Asc.c_oLicenseResult.SuccessLimit&&this.appOptions.permissionsLicense!==Asc.c_oLicenseResult.SuccessLimit?t===Asc.c_oLicenseResult.Connections||t===Asc.c_oLicenseResult.UsersCount?t=t===Asc.c_oLicenseResult.Connections?this.warnLicenseExceeded:this.warnLicenseUsersExceeded:(t=t===Asc.c_oLicenseResult.ConnectionsOS?this.warnNoLicense:this.warnNoLicenseUsers,e=[{value:"buynow",caption:this.textBuyNow},{value:"contact",caption:this.textContactUs}],i="buynow"):t=this.warnLicenseLimitedRenewed,this._state.licenseType!==Asc.c_oLicenseResult.SuccessLimit&&(this.appOptions.isEdit||this.appOptions.isRestrictedEdit)&&(this.disableEditing(!0),this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"));var n=Common.localStorage.getItem("ve-license-warning");n=null!==n?parseInt(n):0;var o=(new Date).getTime();o-n>864e5&&Common.UI.info({maxwidth:500,title:this.textNoLicenseTitle,msg:t,buttons:e,primary:i,callback:function(t){Common.localStorage.setItem("ve-license-warning",o),"buynow"==t?window.open("https://www.onlyoffice.com","_blank"):"contact"==t&&window.open("mailto:sales@onlyoffice.com","_blank")}})}else!this.appOptions.isDesktopApp&&!this.appOptions.canBrandingExt&&this.editorConfig&&this.editorConfig.customization&&(this.editorConfig.customization.loaderName||this.editorConfig.customization.loaderLogo||this.editorConfig.customization.font&&(this.editorConfig.customization.font.size||this.editorConfig.customization.font.name))&&Common.UI.warning({title:this.textPaidFeature,msg:this.textCustomLoader,buttons:[{value:"contact",caption:this.textContactUs},{value:"close",caption:this.textClose}],primary:"contact",callback:function(t){"contact"==t&&window.open("mailto:sales@onlyoffice.com","_blank")}})},onOpenDocument:function(t){var e=document.getElementById("loadmask-text"),i=(t.asc_getCurrentFont()+t.asc_getCurrentImage())/(t.asc_getFontsCount()+t.asc_getImagesCount());i=this.textLoadingDocument+": "+Common.Utils.String.fixedDigits(Math.min(Math.round(100*i),100),3,"  ")+"%",e?e.innerHTML=i:this.loadMask&&this.loadMask.setTitle(i)},onEditorPermissions:function(i){var n=i.asc_getLicenseType();if(Asc.c_oLicenseResult.Expired===n||Asc.c_oLicenseResult.Error===n||Asc.c_oLicenseResult.ExpiredTrial===n||Asc.c_oLicenseResult.NotBefore===n||Asc.c_oLicenseResult.ExpiredLimited===n)return Common.UI.warning({title:Asc.c_oLicenseResult.NotBefore===n?this.titleLicenseNotActive:this.titleLicenseExp,msg:Asc.c_oLicenseResult.NotBefore===n?this.warnLicenseBefore:this.warnLicenseExp,buttons:[],closable:!1}),void((this._isDocReady||this._isPermissionsInited)&&(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect")));!this.onServerVersion(i.asc_getBuildVersion())&&this.onLanguageLoaded()&&(this._isDocReady||this._isPermissionsInited||(i.asc_getRights()!==Asc.c_oRights.Edit&&(this.permissions.edit=this.permissions.review=!1),this.appOptions.permissionsLicense=n,this.appOptions.isOffline=this.api.asc_isOffline(),this.appOptions.isCrypted=this.api.asc_isCrypto(),this.appOptions.canLicense=n===Asc.c_oLicenseResult.Success||n===Asc.c_oLicenseResult.SuccessLimit,this.appOptions.isLightVersion=i.asc_getIsLight(),this.appOptions.canCoAuthoring=!this.appOptions.isLightVersion,this.appOptions.canRequestEditRights=this.editorConfig.canRequestEditRights,this.appOptions.canEdit=!1,this.appOptions.isEdit=this.appOptions.canLicense&&this.appOptions.canEdit&&"view"!==this.editorConfig.mode,this.appOptions.canDownload=!1!==this.permissions.download,this.appOptions.canAnalytics=i.asc_getIsAnalyticsEnable(),this.appOptions.canComments=!1,this.appOptions.canComments=!1,this.appOptions.canViewComments=!1,this.appOptions.canChat=this.appOptions.canLicense&&!this.appOptions.isOffline&&!(!1===this.permissions.chat||void 0===this.permissions.chat&&"object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.chat),"object"==typeof this.editorConfig.customization&&void 0!==this.editorConfig.customization.chat&&console.log("Obsolete: The 'chat' parameter of the 'customization' section is deprecated. Please use 'chat' parameter in the permissions instead."),this.appOptions.canPrint=!1!==this.permissions.print,this.appOptions.canPreviewPrint=!1,this.appOptions.canQuickPrint=this.appOptions.canPrint&&!Common.Utils.isMac&&this.appOptions.isDesktopApp,this.appOptions.canRename=this.editorConfig.canRename,this.appOptions.canForcesave=this.appOptions.isEdit&&!this.appOptions.isOffline&&"object"==typeof this.editorConfig.customization&&!!this.editorConfig.customization.forcesave,this.appOptions.forcesave=this.appOptions.canForcesave,this.appOptions.canEditComments=!1,this.appOptions.canDeleteComments=!1,"object"==typeof this.editorConfig.customization&&!0===this.editorConfig.customization.commentAuthorOnly&&(console.log("Obsolete: The 'commentAuthorOnly' parameter of the 'customization' section is deprecated. Please use 'editCommentAuthorOnly' and 'deleteCommentAuthorOnly' parameters in the permissions instead."),void 0===this.permissions.editCommentAuthorOnly&&void 0===this.permissions.deleteCommentAuthorOnly&&(this.appOptions.canEditComments=this.appOptions.canDeleteComments=!1)),this.appOptions.buildVersion=i.asc_getBuildVersion(),this.appOptions.trialMode=i.asc_getLicenseMode(),this.appOptions.isBeta=i.asc_getIsBeta(),this.appOptions.isSignatureSupport=this.appOptions.isEdit&&this.appOptions.isDesktopApp&&this.appOptions.isOffline&&this.api.asc_isSignaturesSupport()&&!1!==this.permissions.protect,this.appOptions.isPasswordSupport=this.appOptions.isEdit&&this.api.asc_isProtectionSupport()&&!1!==this.permissions.protect,this.appOptions.canProtect=!1!==this.permissions.protect,this.appOptions.canHelp=!("object"==typeof this.editorConfig.customization&&!1===this.editorConfig.customization.help),this.appOptions.isRestrictedEdit=!this.appOptions.isEdit&&this.appOptions.canComments,this.appOptions.canSaveToFile=this.appOptions.isEdit||this.appOptions.isRestrictedEdit,this.appOptions.showSaveButton=this.appOptions.isEdit,this.appOptions.compactHeader=this.appOptions.customization&&"object"==typeof this.appOptions.customization&&!!this.appOptions.customization.compactHeader,this.appOptions.twoLevelHeader=this.appOptions.isEdit,this.appOptions.canUseHistory=!1,this.appOptions.canHistoryClose=this.editorConfig.canHistoryClose,this.appOptions.canHistoryRestore=this.editorConfig.canHistoryRestore,this.appOptions.isLightVersion&&(this.appOptions.canUseHistory=!1),this.appOptions.canBrandingExt=i.asc_getCanBranding()&&("object"==typeof this.editorConfig.customization||this.editorConfig.plugins),Common.UI.LayoutManager.init(this.editorConfig.customization?this.editorConfig.customization.layout:null,this.appOptions.canBrandingExt,this.api),this.editorConfig.customization&&Common.UI.FeaturesManager.init(this.editorConfig.customization.features,this.appOptions.canBrandingExt),Common.UI.TabStyler.init(this.editorConfig.customization),this.appOptions.canBranding=i.asc_getCustomization(),this.appOptions.canBranding&&t.setBranding(this.editorConfig.customization,this.appOptions),this.appOptions.canFavorite=this.document.info&&void 0!==this.document.info.favorite&&null!==this.document.info.favorite&&!this.appOptions.isOffline,this.appOptions.canFavorite&&t.setFavorite(this.document.info.favorite),this.appOptions.canUseCommentPermissions=this.appOptions.canLicense&&!!this.permissions.commentGroups,this.appOptions.canUseUserInfoPermissions=this.appOptions.canLicense&&!!this.permissions.userInfoGroups,AscCommon.UserInfoParser.setParser(!0),AscCommon.UserInfoParser.setCurrentName(this.appOptions.user.fullname),this.appOptions.canUseCommentPermissions&&AscCommon.UserInfoParser.setCommentPermissions(this.permissions.commentGroups),this.appOptions.canUseUserInfoPermissions&&AscCommon.UserInfoParser.setUserInfoPermissions(this.permissions.userInfoGroups),t.setUserName(AscCommon.UserInfoParser.getParsedName(AscCommon.UserInfoParser.getCurrentName())),t.setUserId(this.appOptions.user.id),t.setUserAvatar(this.appOptions.user.image),this.appOptions.canRename&&t.setCanRename(!0),this.getApplication().getController("Common.Controllers.Plugins").setMode(this.appOptions),Common.UI.ExternalUsers.init(this.appOptions.canRequestUsers,this.api),this.appOptions.user.image?Common.UI.ExternalUsers.setImage(this.appOptions.user.id,this.appOptions.user.image):Common.UI.ExternalUsers.get("info",this.appOptions.user.id),this.appOptions.canLiveView=!!i.asc_getLiveViewerSupport()&&"view"===this.editorConfig.mode,this.appOptions.canChangeCoAuthoring=this.appOptions.isEdit&&this.appOptions.canCoAuthoring&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change)||this.appOptions.canLiveView&&!(this.editorConfig.coEditing&&"object"==typeof this.editorConfig.coEditing&&!1===this.editorConfig.coEditing.change),this.appOptions.isAnonymousSupport=!!this.api.asc_isAnonymousSupport(),this.loadCoAuthSettings(),this.applyModeCommonElements(),this.applyModeEditorElements(),this._isPermissionsInited=!0,this.appOptions.isEdit||(Common.NotificationCenter.trigger("app:face",this.appOptions),this.hidePreloader(),this.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,e)),this.api.asc_setViewMode(!this.appOptions.isEdit&&!this.appOptions.isRestrictedEdit),this.api.asc_setCanSendChanges(this.appOptions.canSaveToFile),this.appOptions.isRestrictedEdit&&this.appOptions.canComments&&this.api.asc_setRestriction(Asc.c_oAscRestrictionType.OnlyComments)),this.api.asc_LoadDocument())},loadCoAuthSettings:function(){Common.Utils.InternalSettings.set("ve-settings-coauthmode",!1),Common.Utils.InternalSettings.set("ve-settings-autosave",0)},loadDefaultMetricSettings:function(){var t="";if(this.appOptions.location)console.log("Obsolete: The 'location' parameter of the 'editorConfig' section is deprecated. Please use 'region' parameter in the 'editorConfig' section instead."),t=this.appOptions.location;else if(this.appOptions.region){var e=this.appOptions.region;(e=Common.util.LanguageInfo.getLanguages().hasOwnProperty(e)?Common.util.LanguageInfo.getLocalLanguageName(e)[0]:e)&&"string"==typeof e&&(i=e.split(/[\-_]/)).length>1&&(t=i[i.length-1])}else{var i;(i=(this.appOptions.lang||"en").split(/[\-_]/)).length>1&&(t=i[i.length-1]),t||(i=(navigator.language||"").split(/[\-_]/)).length>1&&(t=i[i.length-1])}/^(ca|us)$/i.test(t)&&Common.Utils.Metric.setDefaultMetric(Common.Utils.Metric.c_MetricUnits.inch),Common.Utils.InternalSettings.set("ve-config-region",t)},onCoAuthApply:function(){this.api&&(this._state.fastCoauth=Common.Utils.InternalSettings.get("ve-settings-coauthmode"),this.api.asc_SetFastCollaborative(this._state.fastCoauth),this.api.asc_setAutoSaveGap(Common.Utils.InternalSettings.get("ve-settings-autosave")),this.getApplication().getController("LeftMenu").leftMenu.getMenu("file").applyMode())},applyModeCommonElements:function(){window.editor_elements_prepared=!0;var t=this.getApplication(),e=t.getController("Viewport"),i=t.getController("Statusbar").getView("Statusbar"),n=t.getController("DocumentHolder"),o=t.getController("Toolbar"),s=t.getController("LeftMenu");e&&e.setMode(this.appOptions),i&&i.setMode(this.appOptions),o.setMode(this.appOptions),n.setMode(this.appOptions),s.setMode(this.appOptions),e.applyCommonMode(),this.api.asc_registerCallback("asc_onDownloadUrl",_.bind(this.onDownloadUrl,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onParticipantsChanged",_.bind(this.onAuthParticipantsChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this));var a=Common.localStorage.getItem("ve-settings-unit");void 0===(a=null!==a?parseInt(a):this.appOptions.customization&&this.appOptions.customization.unit?Common.Utils.Metric.c_MetricUnits[this.appOptions.customization.unit.toLocaleLowerCase()]:Common.Utils.Metric.getDefaultMetric())&&(a=Common.Utils.Metric.getDefaultMetric()),Common.Utils.Metric.setCurrentMetric(a),Common.Utils.InternalSettings.set("ve-settings-unit",a),o.setApi(this.api)},applyModeEditorElements:function(){this.getApplication(),this.appOptions.isEdit||(window.onbeforeunload=_.bind(this.onBeforeUnloadView,this))},onExternalMessage:function(t,e){t&&t.msg&&(t.msg=t.msg.toString(),this.showTips([t.msg.charAt(0).toUpperCase()+t.msg.substring(1)],e),Common.component.Analytics.trackEvent("External Error"))},onError:function(t,i,n){switch(t){case Asc.c_oAscError.ID.LoadingScriptError:return this.showTips([this.scriptLoadError]),void(this.tooltip&&this.tooltip.getBSTip().$tip.css("z-index",1e4));case Asc.c_oAscError.ID.CanNotPasteImage:return void this.showTips([this.errorCannotPasteImg],{timeout:7e3,hideCloseTip:!0});case Asc.c_oAscError.ID.UpdateVersion:return void Common.UI.TooltipManager.showTip("updateVersion");case Asc.c_oAscError.ID.SessionIdle:return void Common.UI.TooltipManager.showTip("sessionIdle");case Asc.c_oAscError.ID.SessionToken:return void Common.UI.TooltipManager.showTip("sessionToken");case Asc.c_oAscError.ID.UserDrop:if(this._state.lostEditingRights)return void(this._state.lostEditingRights=!1);this._state.lostEditingRights=!0,Common.NotificationCenter.trigger("collaboration:sharingdeny");var o=this;return void Common.UI.TooltipManager.showTip({step:"userDrop",text:this.errorUserDrop,target:"#toolbar",maxwidth:600,showButton:!1,automove:!0,noHighlight:!0,multiple:!0,callback:function(){o._state.lostEditingRights=!1}})}this.hidePreloader(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,e);var s={closable:!0};switch(t){case Asc.c_oAscError.ID.Unknown:s.msg=this.unknownErrorText;break;case Asc.c_oAscError.ID.ConvertationTimeout:s.msg=this.convertationTimeoutText;break;case Asc.c_oAscError.ID.ConvertationOpenError:s.msg=this.openErrorText;break;case Asc.c_oAscError.ID.ConvertationSaveError:s.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.saveErrorTextDesktop:this.saveErrorText;break;case Asc.c_oAscError.ID.DownloadError:s.msg=this.downloadErrorText;break;case Asc.c_oAscError.ID.UplImageSize:s.msg=this.uploadImageSizeMessage;break;case Asc.c_oAscError.ID.UplImageExt:s.msg=this.uploadImageExtMessage;break;case Asc.c_oAscError.ID.UplImageFileCount:s.msg=this.uploadImageFileCountMessage;break;case Asc.c_oAscError.ID.UplDocumentSize:s.msg=this.uploadDocSizeMessage;break;case Asc.c_oAscError.ID.UplDocumentExt:s.msg=this.uploadDocExtMessage;break;case Asc.c_oAscError.ID.UplDocumentFileCount:s.msg=this.uploadDocFileCountMessage;break;case Asc.c_oAscError.ID.VKeyEncrypt:s.msg=this.errorToken;break;case Asc.c_oAscError.ID.KeyExpire:s.msg=this.errorTokenExpire;break;case Asc.c_oAscError.ID.UserCountExceed:s.msg=this.errorUsersExceed;break;case Asc.c_oAscError.ID.CoAuthoringDisconnect:s.msg=this.errorViewerDisconnect;break;case Asc.c_oAscError.ID.ConvertationPassword:s.msg=this.errorFilePassProtect;break;case Asc.c_oAscError.ID.Database:s.msg=this.errorDatabaseConnection;break;case Asc.c_oAscError.ID.Warning:s.msg=this.errorConnectToServer,s.closable=!1;break;case Asc.c_oAscError.ID.SessionAbsolute:s.msg=this.errorSessionAbsolute;break;case Asc.c_oAscError.ID.AccessDeny:s.msg=this.errorAccessDeny;break;case Asc.c_oAscError.ID.UplImageUrl:s.msg=this.errorBadImageUrl;break;case Asc.c_oAscError.ID.ForceSaveButton:case Asc.c_oAscError.ID.ForceSaveTimeout:s.msg=this.errorForceSave,s.maxwidth=600;break;case Asc.c_oAscError.ID.DataEncrypted:s.msg=this.errorDataEncrypted;break;case Asc.c_oAscError.ID.EditingError:s.msg=this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.errorEditingSaveas:this.errorEditingDownloadas;break;case Asc.c_oAscError.ID.ConvertationOpenLimitError:s.msg=this.errorFileSizeExceed;break;case Asc.c_oAscError.ID.DirectUrl:s.msg=this.errorDirectUrl;break;case Asc.c_oAscError.ID.Password:s.msg=this.errorSetPassword;break;case Asc.c_oAscError.ID.LoadingFontError:s.msg=this.errorLoadingFont;break;case Asc.c_oAscError.ID.PasswordIsNotCorrect:s.msg=this.errorPasswordIsNotCorrect;break;case Asc.c_oAscError.ID.ConvertationOpenFormat:s.maxwidth=600,s.msg="pdf"===n?this.errorInconsistentExtPdf.replace("%1",this.document.fileType||""):"docx"===n?this.errorInconsistentExtDocx.replace("%1",this.document.fileType||""):"xlsx"===n?this.errorInconsistentExtXlsx.replace("%1",this.document.fileType||""):"pptx"===n?this.errorInconsistentExtPptx.replace("%1",this.document.fileType||""):this.errorInconsistentExt;break;default:s.msg="string"==typeof t?t:this.errorDefaultMessage.replace("%1",t)}i==Asc.c_oAscError.Level.Critical?(Common.Gateway.reportError(t,s.msg),s.title=this.criticalErrorTitle,s.iconCls="error",s.closable=!1,this.appOptions.canRequestClose?(s.msg+="<br><br>"+this.criticalErrorExtTextClose,s.callback=function(t){"ok"==t&&(Common.Gateway.requestClose(),Common.Controllers.Desktop.requestClose())}):this.appOptions.canBackToFolder&&!this.appOptions.isDesktopApp&&"string"!=typeof t&&this.appOptions.customization.goback.url&&!1===this.appOptions.customization.goback.blank&&(s.msg+="<br><br>"+this.criticalErrorExtText,s.callback=function(t){"ok"==t&&Common.NotificationCenter.trigger("goback",!0)}),t!=Asc.c_oAscError.ID.DataEncrypted&&t!=Asc.c_oAscError.ID.ConvertationOpenLimitError||(this.api.asc_coAuthoringDisconnect(),Common.NotificationCenter.trigger("api:disconnect"))):(Common.Gateway.reportWarning(t,s.msg),s.title=this.notcriticalErrorTitle,s.iconCls="warn",s.buttons=["ok"],s.callback=_.bind((function(e){t==Asc.c_oAscError.ID.Warning&&"ok"==e&&(this.appOptions.canDownload||this.appOptions.canDownloadOrigin)?(Common.UI.Menu.Manager.hideAll(),this.appOptions.isDesktopApp&&this.appOptions.isOffline?this.api.asc_DownloadAs():this.appOptions.canDownload?this._isDocReady?this.getApplication().getController("LeftMenu").leftMenu.showMenu("file:saveas"):this._needToSaveAsFile=!0:this.api.asc_DownloadOrigin()):t==Asc.c_oAscError.ID.EditingError&&(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect",!0)),this.onEditComplete()}),this)),(!Common.Utils.ModalWindow.isVisible()||$(".asc-window.modal.alert[data-value="+t+"]").length<1)&&Common.UI.alert(s).$window.attr("data-value",t),void 0!==t&&Common.component.Analytics.trackEvent("Internal Error",t.toString())},onCoAuthoringDisconnect:function(){this.getApplication().getController("Viewport").getView("Viewport").setMode({isDisconnected:!0}),t.setCanRename(!1),this.appOptions.canRename=!1,this._state.isDisconnected=!0},showTips:function(t,e){var i=this;function n(t){i.tipTimeout&&clearTimeout(i.tipTimeout),setTimeout(o,300)}function o(){var o=t.shift();o&&(e&&e.hideCloseTip||(o+="\n"+i.textCloseTip),i.tooltip.setTitle(o),i.tooltip.show(),i.tipTimeout&&clearTimeout(i.tipTimeout),e&&e.timeout&&(i.tipTimeout=setTimeout((function(){i.tooltip.hide(),n()}),e.timeout)))}t.length&&("object"!=typeof t&&(t=[t]),this.tooltip||(this.tooltip=new Common.UI.Tooltip({owner:this.getApplication().getController("Toolbar").getView(),hideonclick:!0,placement:"bottom",cls:"main-info",offset:30}),this.tooltip.on("tooltip:hideonclick",n)),o())},updateWindowTitle:function(e){var i=this.api.isDocumentModified();if(this._state.isDocModified!==i||e){var n=this.defaultTitleText;t&&!_.isEmpty(t.getDocumentCaption())&&(n=t.getDocumentCaption()+" - "+n),i&&(clearTimeout(this._state.timerCaption),_.isUndefined(n)||(n="* "+n)),window.document.title!=n&&(window.document.title=n),this._isDocReady&&this._state.isDocModified!==i&&Common.Gateway.setDocumentModified(i),i&&(!this._state.fastCoauth||this._state.usersCount<2)&&this.getApplication().getController("Statusbar").setStatusCaption("",!0),this._state.isDocModified=i}},onContextMenu:function(t){var e=t.target.getAttribute("data-can-copy"),i=t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement;if(i&&"false"===e||!i&&"true"!==e)return t.stopPropagation(),t.preventDefault(),!1},onBeforeUnloadView:function(){Common.localStorage.save(),this._state.unloadTimer=1e4},hidePreloader:function(){var t;this._state.customizationDone||(this._state.customizationDone=!0,this.appOptions.customization&&(this.appOptions.isDesktopApp?this.appOptions.customization.about=!1:this.appOptions.canBrandingExt||(this.appOptions.customization.about=!0)),Common.Utils.applyCustomization(this.appOptions.customization,i),this.appOptions.canBrandingExt&&(Common.Utils.applyCustomization(this.appOptions.customization,n),Common.UI.LayoutManager.applyCustomization(),this.appOptions.customization&&"object"==typeof this.appOptions.customization&&(void 0!==this.appOptions.customization.leftMenu&&console.log("Obsolete: The 'leftMenu' parameter of the 'customization' section is deprecated. Please use 'leftMenu' parameter in the 'customization.layout' section instead."),void 0!==this.appOptions.customization.statusBar&&console.log("Obsolete: The 'statusBar' parameter of the 'customization' section is deprecated. Please use 'statusBar' parameter in the 'customization.layout' section instead."),void 0!==this.appOptions.customization.toolbar&&console.log("Obsolete: The 'toolbar' parameter of the 'customization' section is deprecated. Please use 'toolbar' parameter in the 'customization.layout' section instead.")),t=this.getApplication().getController("Common.Controllers.Plugins").applyUICustomization())),Common.NotificationCenter.trigger("layout:changed","main"),(t||new Promise((function(t,e){t()}))).then((function(){$("#loading-mask").hide().remove(),Common.Controllers.Desktop.process("preloader:hide")}))},onDownloadUrl:function(t,e){this._state.isFromGatewayDownloadAs&&Common.Gateway.downloadAs(t,e),this._state.isFromGatewayDownloadAs=!1},onUpdateVersion:function(t){console.log("Obsolete: The 'onOutdatedVersion' event is deprecated. Please use 'onRequestRefreshFile' event and 'refreshFile' method instead.");var i=this;i.needToUpdateVersion=!0,i.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,e),Common.UI.TooltipManager.showTip({step:"updateVersionReload",text:this.errorUpdateVersion,header:this.titleUpdateVersion,target:"#toolbar",maxwidth:"none",closable:!1,automove:!0,noHighlight:!0,callback:function(){_.defer((function(){Common.Gateway.updateVersion(),t&&t.call(i),i.editorConfig&&i.editorConfig.canUpdateVersion&&i.onLongActionBegin(Asc.c_oAscAsyncActionType.BlockInteraction,e)}))}}),this.disableEditing(!0,"not-loaded"),Common.NotificationCenter.trigger("api:disconnect")},onServerVersion:function(t){if(this.changeServerVersion)return!0;const e=this.getApplication().getController("LeftMenu").leftMenu.getMenu("about").txtVersionNum.match(/^(\d+.\d+.\d+)/);return!(window.compareVersions||e&&e[1]===t||(this.changeServerVersion=!0,Common.UI.warning({title:this.titleServerVersion,msg:this.errorServerVersion,callback:function(){_.defer((function(){Common.Gateway.updateVersion()}))}}),this._isDocReady&&(this.disableEditing(!0),Common.NotificationCenter.trigger("api:disconnect")),0))},onAdvancedOptions:function(t,i,n,o){if(!this._state.openDlg){var s=this;t==Asc.c_oAscAdvancedOptionsID.DRM&&(s._state.openDlg=new Common.Views.OpenDialog({title:Common.Views.OpenDialog.prototype.txtTitleProtected,closeFile:s.appOptions.canRequestClose,type:Common.Utils.importTextType.DRM,warning:!(s.appOptions.isDesktopApp&&s.appOptions.isOffline)&&"string"==typeof i,warningMsg:i,validatePwd:!!s._state.isDRM,handler:function(e,i){s.isShowOpenDialog=!1,"ok"==e?s.api&&(s.api.asc_setAdvancedOptions(t,i.drmOptions),s.loadMask&&s.loadMask.show()):(Common.Gateway.requestClose(),Common.Controllers.Desktop.requestClose()),s._state.openDlg=null}}),s._state.isDRM=!0),s._state.openDlg&&(this.isShowOpenDialog=!0,this.loadMask&&this.loadMask.hide(),this.onLongActionEnd(Asc.c_oAscAsyncActionType.BlockInteraction,e),s._state.openDlg.show()),s._state.requireUserAction&&(Common.Gateway.userActionRequired(),s._state.requireUserAction=!1)}},onAuthParticipantsChanged:function(t){var e=0;_.each(t,(function(t){t.asc_getView()||e++})),this._state.usersCount=e},onUserConnection:function(e){if(e&&this.appOptions.user.guest&&this.appOptions.canRenameAnonymous&&e.asc_getIdOriginal()==this.appOptions.user.id){var i=e.asc_getUserName();if(i&&i!==AscCommon.UserInfoParser.getCurrentName()){this._renameDialog&&this._renameDialog.close(),AscCommon.UserInfoParser.setCurrentName(i),t.setUserName(AscCommon.UserInfoParser.getParsedName(i));var n=i.lastIndexOf("("),o=i.lastIndexOf(")"),s=n>0&&n<o?i.substring(0,n-1):"";null!==Common.localStorage.getItem("guest-username")&&Common.localStorage.setItem("guest-username",s),Common.Utils.InternalSettings.set("guest-username",s)}}},applySettings:function(){},onDocumentName:function(e){t.setDocumentCaption(e),this.updateWindowTitle(!0)},onMeta:function(e){t.setDocumentCaption(e.title),this.updateWindowTitle(!0),this.document.title=e.title;var i=this.getApplication().getController("LeftMenu").getView("LeftMenu").getMenu("file");if(i.loadDocument({doc:this.document}),i.panels&&i.panels.info&&i.panels.info.updateInfo(this.document),Common.Gateway.metaChange(e),this.appOptions.wopi){var n=e.title.lastIndexOf(".");Common.Gateway.requestRename(n>0?e.title.substring(0,n):e.title)}},onPrint:function(){this.appOptions.canPrint&&!Common.Utils.ModalWindow.isVisible()&&(Common.NotificationCenter.trigger("file:print"),Common.component.Analytics.trackEvent("Print"))},onPrintUrl:function(t){if(this.iframePrint&&(this.iframePrint.parentNode.removeChild(this.iframePrint),this.iframePrint=null),!this.iframePrint){var e=this;this.iframePrint=document.createElement("iframe"),this.iframePrint.id="id-print-frame",this.iframePrint.style.display="none",this.iframePrint.style.visibility="hidden",this.iframePrint.style.position="fixed",this.iframePrint.style.right="0",this.iframePrint.style.bottom="0",document.body.appendChild(this.iframePrint),this.iframePrint.onload=function(){try{e.iframePrint.contentWindow.focus(),e.iframePrint.contentWindow.print(),e.iframePrint.contentWindow.blur(),window.focus()}catch(t){e.api.asc_DownloadAs(new Asc.asc_CDownloadOptions(Asc.c_oAscFileType.PDF))}}}t&&(this.iframePrint.src=t)},onPrintQuick:function(){if(this.appOptions.canQuickPrint){var t=Common.localStorage.getBool("ve-hide-quick-print-warning"),e=this,i=function(){var t=new Asc.asc_CAdjustPrint;t.asc_setNativeOptions({quickPrint:!0});var i=new Asc.asc_CDownloadOptions;i.asc_setAdvancedOptions(t),e.api.asc_Print(i),Common.component.Analytics.trackEvent("Print")};t?i.call(this):Common.UI.warning({msg:this.textTryQuickPrint,buttons:["yes","no"],primary:"yes",dontshow:!0,maxwidth:500,callback:function(t,e){e&&Common.localStorage.setBool("ve-hide-quick-print-warning",!0),"yes"===t&&setTimeout(i,1)}})}},warningDocumentIsLocked:function(){var t=this;Common.Utils.warningDocumentIsLocked({disablefunc:function(e){t.disableEditing(e,"reconnect")}})},showRenameUserDialog:function(){if(!this._renameDialog){var t=this;this._renameDialog=new Common.Views.UserNameDialog({label:this.textRenameLabel,error:this.textRenameError,value:Common.Utils.InternalSettings.get("guest-username")||"",check:Common.Utils.InternalSettings.get("save-guest-username")||!1,validation:function(e){return e.length<128||t.textLongName},repaintcallback:function(){this.setPosition(Common.Utils.innerWidth()-this.options.width-15,30)},handler:function(e,i){if("ok"==e){var n=i.input?i.input+" ("+t.appOptions.guestName+")":t.textAnonymous,o=new Asc.asc_CUserInfo;o.put_FullName(n);var s=new Asc.asc_CDocInfo;s.put_UserInfo(o),t.api.asc_changeDocInfo(s),i.checkbox?Common.localStorage.setItem("guest-username",i.input):Common.localStorage.removeItem("guest-username"),Common.Utils.InternalSettings.set("guest-username",i.input),Common.Utils.InternalSettings.set("save-guest-username",i.checkbox)}}}),this._renameDialog.on("close",(function(){t._renameDialog=void 0})),this._renameDialog.show(Common.Utils.innerWidth()-this._renameDialog.options.width-15,30)}},onGrabFocus:function(){this.getApplication().getController("DocumentHolder").getView().focus()},onLanguageLoaded:function(){return!!Common.Locale.getCurrentLanguage()||(Common.UI.warning({msg:this.errorLang,buttons:[],closable:!1}),!1)},onLostEditRights:function(){this._readonlyRights=!0},changeAccessRights:function(t,e,i){if(!this._docAccessDlg&&!this._readonlyRights)if(this.appOptions.canRequestSharingSettings)Common.Gateway.requestSharingSettings();else{var n=this;n._docAccessDlg=new Common.Views.DocumentAccessDialog({settingsurl:this.appOptions.sharingSettingsUrl}),n._docAccessDlg.on("accessrights",(function(t,e){n.setSharingSettings({sharingSettings:e})})).on("close",(function(t){n._docAccessDlg=void 0})),n._docAccessDlg.show()}},setSharingSettings:function(t){t&&(this.document.info.sharingSettings=t.sharingSettings,Common.NotificationCenter.trigger("collaboration:sharingupdate",t.sharingSettings),Common.NotificationCenter.trigger("mentions:clearusers",this))},onSaveDocumentBinary:function(t){Common.Gateway.saveDocument(t)},loadBinary:function(t){t&&this.api.asc_openDocumentFromBytes(new Uint8Array(t))},onRequestRefreshFile:function(){Common.Gateway.requestRefreshFile()},onRefreshFile:function(e){if(e){var i=new Asc.asc_CDocInfo;e.document&&(i.put_Id(e.document.key),i.put_Url(e.document.url),i.put_Title(e.document.title),e.document.title&&(t.setDocumentCaption(e.document.title),this.updateWindowTitle(!0),this.document.title=e.document.title),e.document.referenceData&&i.put_ReferenceData(e.document.referenceData)),e.editorConfig&&i.put_CallbackUrl(e.editorConfig.callbackUrl),e.token&&i.put_Token(e.token);var n=new Asc.asc_CUserInfo;n.put_Id(this.appOptions.user.id),n.put_FullName(this.appOptions.user.fullname),n.put_IsAnonymousUser(!!this.appOptions.user.anonymous),i.put_UserInfo(n);var o=$.extend({},this.document.options,this.editorConfig.actionLink||{});i.put_Options(o),i.put_Format(this.document.fileType),i.put_Lang(this.editorConfig.lang),i.put_Mode(this.editorConfig.mode),i.put_Permissions(this.permissions),i.put_DirectUrl(e.document&&e.document.directUrl?e.document.directUrl:this.document.directUrl),i.put_VKey(e.document&&e.document.vkey?e.document.vkey:this.document.vkey),i.put_EncryptedInfo(e.editorConfig&&e.editorConfig.encryptionKeys?e.editorConfig.encryptionKeys:this.editorConfig.encryptionKeys);var s=!this.editorConfig.customization||!1!==this.editorConfig.customization.macros;i.asc_putIsEnabledMacroses(!!s),s=!this.editorConfig.customization||!1!==this.editorConfig.customization.plugins,i.asc_putIsEnabledPlugins(!!s),i.put_CoEditingMode("strict"),this.api.asc_refreshFile(i)}},errorLang:"The interface language is not loaded.<br>Please contact your Document Server administrator."}),VE.Controllers.Main||{}))})),define("visioeditor/main/app/controller/ViewTab",["core","visioeditor/main/app/view/ViewTab"],(function(){"use strict";VE.Controllers.ViewTab=Backbone.Controller.extend(_.extend({models:[],collections:[],views:["ViewTab"],sdkViewName:"#id_main",initialize:function(){},onLaunch:function(){this._state={zoom_type:void 0,zoom_percent:void 0},Common.NotificationCenter.on("uitheme:changed",this.onThemeChanged.bind(this)),Common.NotificationCenter.on("document:ready",_.bind(this.onDocumentReady,this)),Common.NotificationCenter.on("tabstyle:changed",this.onTabStyleChange.bind(this))},setApi:function(t){return t&&(this.api=t,this.api.asc_registerCallback("asc_onZoomChange",_.bind(this.onZoomChange,this)),this.api.asc_registerCallback("asc_onCoAuthoringDisconnect",_.bind(this.onCoAuthoringDisconnect,this)),Common.NotificationCenter.on("api:disconnect",_.bind(this.onCoAuthoringDisconnect,this))),this},setConfig:function(t){var e=t.mode;this.toolbar=t.toolbar,this.view=this.createView("ViewTab",{toolbar:this.toolbar.toolbar,mode:e,compactToolbar:this.toolbar.toolbar.isCompactView}),this.addListeners({ViewTab:{"zoom:selected":_.bind(this.onSelectedZoomValue,this),"zoom:changedbefore":_.bind(this.onZoomChanged,this),"zoom:changedafter":_.bind(this.onZoomChanged,this),"zoom:toslide":_.bind(this.onBtnZoomTo,this,"toslide"),"zoom:towidth":_.bind(this.onBtnZoomTo,this,"towidth")},Toolbar:{"view:compact":_.bind((function(t,e){this.view.chToolbar.setValue(!e,!0)}),this)},Statusbar:{"view:hide":_.bind((function(t,e){this.view.chStatusbar.setValue(!e,!0)}),this)},LeftMenu:{"view:hide":_.bind((function(t,e){this.view.chLeftMenu.setValue(!e,!0)}),this)}})},SetDisabled:function(t){this.view&&this.view.SetDisabled(t)},createToolbarPanel:function(){return this.view.getPanel()},getView:function(t){return!t&&this.view?this.view:Backbone.Controller.prototype.getView.call(this,t)},onCoAuthoringDisconnect:function(){this.SetDisabled(!0)},onDocumentReady:function(){Common.Utils.lockControls(Common.enumLock.disableOnStart,!1,{array:this.view.lockedControls})},onZoomChange:function(t,e){this._state.zoom_type!==e&&(this.view.btnFitToSlide.toggle(2==e,!0),this.view.btnFitToWidth.toggle(1==e,!0),this._state.zoom_type=e),this._state.zoom_percent!==t&&(this.view.cmbZoom.setValue(t,t+"%"),this._state.zoom_percent=t)},onBtnZoomTo:function(t,e){this._state.zoom_type=void 0,this._state.zoom_percent=void 0,e.pressed?this.api["toslide"===t?"zoomFitToPage":"zoomFitToWidth"]():this.api.zoomCustomMode(),Common.NotificationCenter.trigger("edit:complete",this.view)},onThemeChanged:function(){if(this.view&&Common.UI.Themes.available()&&this.view.btnInterfaceTheme.menu&&"object"==typeof this.view.btnInterfaceTheme.menu){var t=Common.UI.Themes.currentThemeId()||Common.UI.Themes.defaultThemeId(),e=_.findWhere(this.view.btnInterfaceTheme.menu.getItems(!0),{value:t});e&&(this.view.btnInterfaceTheme.menu.clearAll(!0),e.setChecked(!0,!0))}},applyZoom:function(t){this._state.zoom_percent=void 0,this._state.zoom_type=void 0;var e=Math.max(10,Math.min(500,t));this._state.zoomValue===e&&this.view.cmbZoom.setValue(this._state.zoomValue,this._state.zoomValue+"%"),this.api.zoom(e),Common.NotificationCenter.trigger("edit:complete",this.view)},onSelectedZoomValue:function(t,e){this.applyZoom(e.value)},onZoomChanged:function(t,e,i,n){var o=parseFloat(i.value);t?new RegExp("^\\s*(\\d*(\\.|,)?\\d+)\\s*(%)?\\s*$").exec(i.value)||(this.view.cmbZoom.setValue(this._state.zoom_percent,this._state.zoom_percent+"%"),Common.NotificationCenter.trigger("edit:complete",this.view)):this._state.zoom_percent===o||isNaN(o)?i.value!==this._state.zoom_percent+"%"&&this.view.cmbZoom.setValue(this._state.zoom_percent,this._state.zoom_percent+"%"):this.applyZoom(o)},onTabStyleChange:function(){this.view&&this.view.menuTabStyle&&_.each(this.view.menuTabStyle.items,(function(t){t.setChecked(Common.Utils.InternalSettings.get("settings-tab-style")===t.value,!0)}))}},VE.Controllers.ViewTab||{}))})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/User",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.Models.User=e.Model.extend({defaults:function(){return{iid:Common.UI.getId(),id:void 0,idOriginal:void 0,username:"Guest",color:"#fff",colorval:null,online:!1,view:!1,hidden:!1}}})})),define("common/main/lib/collection/Users",["backbone","common/main/lib/model/User"],(function(t){"use strict";Common.Collections=Common.Collections||{},Common.Collections.Users=t.Collection.extend({model:Common.Models.User,getOnlineCount:function(){var t=0;return this.each((function(e){e.get("online")&&++t})),t},getEditingCount:function(){return this.filter((function(t){return t.get("online")&&!t.get("view")})).length},getVisibleEditingCount:function(){return this.filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).length},getEditingOriginalCount:function(){return this.chain().filter((function(t){return t.get("online")&&!t.get("view")})).groupBy((function(t){return t.get("idOriginal")})).size().value()},getVisibleEditingOriginalCount:function(){return this.chain().filter((function(t){return t.get("online")&&!t.get("view")&&!t.get("hidden")})).groupBy((function(t){return t.get("idOriginal")})).size().value()},findUser:function(t){return this.findWhere({id:t})},findOriginalUser:function(t){return this.findWhere({idOriginal:t})},findOriginalUsers:function(t){return this.where({idOriginal:t})}}),Common.Collections.HistoryUsers=t.Collection.extend({model:Common.Models.User,findUser:function(t){return this.findWhere({id:t})}})})),define("common/main/lib/model/ChatMessage",["backbone"],(function(t){"use strict";Common.Models=Common.Models||{},Common.Models.ChatMessage=t.Model.extend({defaults:{type:0,userid:null,username:"",message:""}})})),define("common/main/lib/collection/ChatMessages",["backbone","common/main/lib/model/ChatMessage"],(function(t){"use strict";!Common.Collections&&(Common.Collections={}),Common.Collections.ChatMessages=t.Collection.extend({model:Common.Models.ChatMessage})})),define("common/main/lib/controller/Chat",["core","common/main/lib/collection/Users","common/main/lib/collection/ChatMessages","common/main/lib/view/Chat"],(function(){"use strict";Common.Controllers.Chat=Backbone.Controller.extend(_.extend({models:[],collections:["Common.Collections.Users","Common.Collections.ChatMessages"],views:["Common.Views.Chat"],initialize:function(){this.addListeners({"Common.Views.Chat":{"message:add":_.bind(this.onSendMessage,this)}});var t=this;Common.NotificationCenter.on("layout:changed",(function(e){Common.Utils.asyncCall((function(e){"toolbar"!=e&&"status"!=e||!t.panelChat.$el.is(":visible")||(t.panelChat.updateLayout(!0),t.panelChat.setupAutoSizingTextBox())}),this,e)}))},events:{},onLaunch:function(){this.panelChat=this.createView("Common.Views.Chat",{storeUsers:this.getApplication().getCollection("Common.Collections.Users"),storeMessages:this.getApplication().getCollection("Common.Collections.ChatMessages")}),this.panelChat.on("render:after",_.bind(this.onAfterRender,this))},onAfterRender:function(t){this.getApplication().getController("Viewport").getView("Viewport").hlayout.on("layout:resizedrag",_.bind((function(){t&&t.updateScrolls()}),this))},setMode:function(t){return this.mode=t,this.currentUserId=t.user.id,this.api&&(this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage",_.bind(this.onReceiveMessage,this)),this.mode.isEditDiagram||this.mode.isEditMailMerge||this.mode.isEditOle||(Common.NotificationCenter.on("mentions:setusers",_.bind(this.avatarsUpdate,this)),this.api.asc_registerCallback("asc_onAuthParticipantsChanged",_.bind(this.onUsersChanged,this)),this.api.asc_registerCallback("asc_onConnectionStateChanged",_.bind(this.onUserConnection,this)),this.api.asc_coAuthoringGetUsers()),this.mode.canCoAuthoring&&this.mode.canChat&&this.api.asc_coAuthoringChatGetMessages()),this},setApi:function(t){return this.api=t,this},onUsersChanged:function(t,e){if(!this.mode.canLicense||!this.mode.canCoAuthoring){var i=0;for(o in t)void 0!==o&&i++;if(i>1&&null==this._isCoAuthoringStopped)return this._isCoAuthoringStopped=!0,this.api.asc_coAuthoringDisconnect(),void Common.NotificationCenter.trigger("api:disconnect")}var n=this.getApplication().getCollection("Common.Collections.Users");if(n){var o,s,a=[],r=[];for(o in t)if(void 0!==o&&(s=t[o])){var l=Common.UI.ExternalUsers.getImage(s.asc_getIdOriginal()),c=new Common.Models.User({id:s.asc_getId(),idOriginal:s.asc_getIdOriginal(),username:s.asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(s.asc_getUserName()),initials:Common.Utils.getUserInitials(AscCommon.UserInfoParser.getParsedName(s.asc_getUserName())),online:!0,color:s.asc_getColor(),avatar:l,view:s.asc_getView(),hidden:!(s.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(s.asc_getUserName()))});a[s.asc_getId()==e?"unshift":"push"](c),void 0===l&&r.push(s.asc_getIdOriginal())}n.reset(a),r.length&&Common.UI.ExternalUsers.get("info",r)}},onUserConnection:function(t){var e=this.getApplication().getCollection("Common.Collections.Users");if(e){var i=e.findUser(t.asc_getId()),n=Common.UI.ExternalUsers.getImage(t.asc_getIdOriginal());i?(i.set({online:t.asc_getState()}),i.set({username:t.asc_getUserName()}),i.set({parsedName:AscCommon.UserInfoParser.getParsedName(t.asc_getUserName())}),i.set({initials:Common.Utils.getUserInitials(t.asc_getUserName())}),i.set({avatar:n})):e.add(new Common.Models.User({id:t.asc_getId(),idOriginal:t.asc_getIdOriginal(),username:t.asc_getUserName(),parsedName:AscCommon.UserInfoParser.getParsedName(t.asc_getUserName()),initials:Common.Utils.getUserInitials(AscCommon.UserInfoParser.getParsedName(t.asc_getUserName())),online:t.asc_getState(),color:t.asc_getColor(),avatar:n,view:t.asc_getView(),hidden:!(t.asc_getIdOriginal()===this.currentUserId||AscCommon.UserInfoParser.isUserVisible(t.asc_getUserName()))})),void 0===n&&Common.UI.ExternalUsers.get("info",[t.asc_getIdOriginal()])}},avatarsUpdate:function(t,e){if("info"===t){var i=this.getApplication().getCollection("Common.Collections.Users"),n=this.getApplication().getCollection("Common.Collections.ChatMessages"),o=!1;e&&e.length>0&&_.each(e,(function(t){i&&i.findOriginalUsers(t.id).forEach((function(e){e.set({avatar:t.image})})),n&&n.where({userid:t.id}).forEach((function(e){void 0!==t.image&&t.image!==e.get("avatar")&&(o=!0,e.set("avatar",t.image,{silent:!0}))}))})),o&&this.panelChat&&this.panelChat.renderMessages()}},onReceiveMessage:function(t,e){var i=this.getApplication().getCollection("Common.Collections.ChatMessages");if(i){var n=[];t.forEach((function(t){n.push(new Common.Models.ChatMessage({userid:t.useridoriginal,message:t.message,username:t.username,parsedName:AscCommon.UserInfoParser.getParsedName(t.username)}))})),i[i.size()<1||e?"reset":"add"](n)}},onSendMessage:function(t,e){if(e.length>0){var i=this;(function(t,e){for(var i=[];t;){if(t.length<e){i.push(t);break}i.push(t.substr(0,e)),t=t.substr(e)}return i})(e,2048).forEach((function(t){i.api.asc_coAuthoringChatSendMessage(t)}))}},notcriticalErrorTitle:"Warning"},Common.Controllers.Chat||{}))})),void 0===Common)var Common={};if(Common.Models=Common.Models||{},define("common/main/lib/model/Plugin",["underscore","backbone","common/main/lib/component/BaseView"],(function(t,e){"use strict";Common.Models.PluginVariation=e.Model.extend({defaults:function(){return{description:"",url:"",index:0,icons:void 0,isSystem:!1,isViewer:!1,isDisplayedInViewer:!0,EditorsSupport:["word","cell","slide"],isVisual:!1,isCustomWindow:!1,isModal:!0,isInsideMode:!1,isCanDocked:!1,initDataType:0,initData:"",isUpdateOleOnResize:!1,buttons:[],size:[800,600],initOnSelectionChanged:!1,visible:!0}}}),Common.Models.Plugin=e.Model.extend({defaults:function(){return{id:Common.UI.getId(),name:"",baseUrl:"",guid:Common.UI.getId(),variations:[],currentVariation:0,pluginObj:void 0,allowSelected:!1,selected:!1,visible:!0,groupName:"",groupRank:0}}})})),void 0===Common)var Common={};if(Common.Collections=Common.Collections||{},define("common/main/lib/collection/Plugins",["underscore","backbone","common/main/lib/model/Plugin"],(function(t,e){"use strict";Common.Collections.Plugins=e.Collection.extend({model:Common.Models.Plugin,hasVisible:function(){return!!this.findWhere({visible:!0})}})})),void 0===Common)var Common={};var reqerr;define("common/main/lib/component/Switcher",["common/main/lib/component/BaseView","underscore"],(function(t,e){"use strict";Common.UI.Switcher=Common.UI.BaseView.extend({options:{hint:!1,width:30,thumbWidth:12,value:!1},disabled:!1,template:e.template(['<div class="switcher">','<div class="thumb"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.hint=e.options.hint,e.width=e.options.width,e.thumbWidth=e.options.thumbWidth,e.delta=(e.width-e.thumbWidth-2)/2,e.disabled=e.options.disabled,e.options.el&&e.render(),this.setValue(e.options.value)},render:function(t){var e=this;e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl),this.options.hint&&(this.cmpEl.attr("data-toggle","tooltip"),this.cmpEl.tooltip({title:"string"==typeof this.options.hint?this.options.hint:this.options.hint[0],placement:this.options.hintAnchor||"cursor"}))),this.thumb=this.cmpEl.find(".thumb"),this.cmpEl.width(e.width),this.thumb.width(e.thumbWidth);var i=function(t){if(!e.disabled){t.preventDefault(),t.stopPropagation(),$(document).off("mouseup.switcher",i),$(document).off("mousemove.switcher",n);var o=Math.round(t.pageX*Common.Utils.zoom()-e._dragstart);e.value=e.value?o>-e.delta:o>e.delta,e.cmpEl.toggleClass("on",e.value),e.thumb.css({left:"",right:""}),e.lastValue!==e.value&&e.trigger("change",e,e.value),e._dragstart=void 0}},n=function(t){if(!e.disabled&&void 0!==e._dragstart){t.preventDefault(),t.stopPropagation();var i=Math.round(t.pageX*Common.Utils.zoom()-e._dragstart);e.value?e.thumb.css({right:i<1?Math.min(e.width-e.thumbWidth-4,-i):0,left:"auto"}):e.thumb.css({left:i>-1?Math.min(e.width-e.thumbWidth-4,i):0,right:"auto"}),e._isMouseMove||(e._isMouseMove=Math.abs(i)>0)}};if(!e.rendered){var o=e.cmpEl;o.on("mousedown",".thumb",(function(t){e.disabled||(e._dragstart=t.pageX*Common.Utils.zoom(),e._isMouseMove=!1,e.lastValue=e.value,$(document).on("mouseup.switcher",i),$(document).on("mousemove.switcher",n))})),o.on("click",(function(t){if(e.disabled||e._isMouseMove)e._isMouseMove=!1;else{if(e.options.hint){var i=e.cmpEl.data("bs.tooltip");i&&(void 0===i.dontShow&&(i.dontShow=!0),i.hide())}e.value=!e.value,e.cmpEl.toggleClass("on",e.value),e.trigger("change",e,e.value)}}))}return e.disabled&&e.setDisabled(!(e.disabled=!1)),e.rendered=!0,this},setThumbPosition:function(t){var e=this.value?t<-this.delta:t>this.delta;this.thumb.css(e?{right:0,left:"auto"}:{left:0,right:"auto"})},setValue:function(t){this.value=!0===t,this.cmpEl.toggleClass("on",this.value)},getValue:function(){return this.value},setDisabled:function(t){if(t!==this.disabled){if((t||!Common.Utils.isGecko)&&this.options.hint){var e=this.cmpEl.data("bs.tooltip");e&&(t&&e.hide(),!Common.Utils.isGecko&&(e.enabled=!t))}this.cmpEl.toggleClass("disabled",t)}this.disabled=t},isDisabled:function(){return this.disabled},updateHint:function(t,e){if(this.options.hint=t,this.rendered&&(this.cmpEl.data("bs.tooltip")&&this.cmpEl.removeData("bs.tooltip"),this.cmpEl.tooltip({html:!!e,title:"string"==typeof t?t:t[0],placement:this.options.hintAnchor||"cursor"}),this.disabled||!Common.Utils.isGecko)){var i=this.cmpEl.data("bs.tooltip");i&&(this.disabled&&i.hide(),!Common.Utils.isGecko&&(i.enabled=!this.disabled))}}})})),define("common/main/lib/controller/Plugins",["core","common/main/lib/collection/Plugins","common/main/lib/view/Plugins","common/main/lib/component/Switcher"],(function(){"use strict";Common.Controllers.Plugins=Backbone.Controller.extend(_.extend({models:[],appOptions:{},configPlugins:{autostart:[]},serverPlugins:{autostart:[]},collections:["Common.Collections.Plugins"],views:["Common.Views.Plugins"],initialize:function(){var t=this;this.addListeners({Toolbar:{"render:before":function(e){var i=t.getApplication().getController("Main").appOptions;if(!i.isEditMailMerge&&!i.isEditDiagram&&!i.isEditOle){var n={action:"plugins",caption:t.viewPlugins.groupCaption,dataHintTitle:"E",layoutname:"toolbar-plugins"};t.$toolbarPanelPlugins=t.viewPlugins.getPanel(),t.toolbar=e,e.addTab(n,t.$toolbarPanelPlugins,Common.UI.LayoutManager.lastTabIdx)}},"tab:active":this.onActiveTab},"Common.Views.Plugins":{"plugin:select":function(e,i,n,o){!this.viewPlugins.pluginPanels[e]||this.viewPlugins.pluginPanels[e]&&i>0?!n||i>0?t.api.asc_pluginRun(e,i,""):t.api.asc_pluginStop(e):o?t.onToolClose(this.viewPlugins.pluginPanels[e]):t.openUIPlugin(e)}},LeftMenu:{"plugins:showpanel":function(e){t.viewPlugins.showPluginPanel(!0,e)},"plugins:hidepanel":function(e){t.viewPlugins.showPluginPanel(!1,e)}},RightMenu:{"plugins:showpanel":function(e){t.viewPlugins.showPluginPanel(!0,e)},"plugins:hidepanel":function(e){t.viewPlugins.showPluginPanel(!1,e)}}})},onLaunch:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins");this.viewPlugins=this.createView("Common.Views.Plugins",{storePlugins:t}),t.on({add:this.onAddPlugin.bind(this),reset:this.onResetPlugins.bind(this)}),this.autostart=[],this.pluginsWinToShow=[],this.startOnPostLoad=!1,this.customPluginsDlg=[],this.newInstalledBackgroundPlugins=[],this.customButtonsArr=[],Common.Gateway.on("init",this.loadConfig.bind(this)),Common.NotificationCenter.on("app:face",this.onAppShowed.bind(this)),Common.NotificationCenter.on("uitheme:changed",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("window:resize",this.updatePluginsButtons.bind(this)),Common.NotificationCenter.on("app:ready",this.onAppReady.bind(this)),Common.NotificationCenter.on("doc:mode-changed",this.onChangeDocMode.bind(this)),Common.NotificationCenter.on("modal:close",this.onModalClose.bind(this)),Common.NotificationCenter.on("script:loaded",this.onPostLoadComplete.bind(this))},loadConfig:function(t){var e=this;e.configPlugins.config=t.config.plugins,e.editor=window.PDFE?"pdf":window.DE?"word":window.PE?"slide":window.VE?"diagram":"cell",e.isPDFEditor=!!window.PDFE},loadPlugins:function(){if(this.configPlugins.plugins=this.serverPlugins.plugins=void 0,this.configPlugins.config?(this.getPlugins(this.configPlugins.config.pluginsData).then((function(e){t.configPlugins.plugins=e,t.mergePlugins()})).catch((function(e){t.configPlugins.plugins=!1})),this.configPlugins.config.options&&this.api.setPluginsOptions(this.configPlugins.config.options)):this.configPlugins.plugins=!1,!Common.Controllers.Desktop.isActive()||!Common.Controllers.Desktop.isOffline()){var t=this;Common.Utils.loadConfig("../../../../plugins.json",(function(e){"error"!=e?(t.serverPlugins.config=e,t.getPlugins(t.serverPlugins.config.pluginsData).then((function(e){t.serverPlugins.plugins=e,t.mergePlugins()})).catch((function(e){t.serverPlugins.plugins=!1}))):t.serverPlugins.plugins=!1}))}},onAppShowed:function(t){},onAppReady:function(t){var e=this;new Promise((function(t,e){t()})).then((function(){e.onChangeProtectDocument(),Common.NotificationCenter.on("protect:doclock",_.bind(e.onChangeProtectDocument,e))}))},setApi:function(t){return this.api=t,this.appOptions.customization&&!1===this.appOptions.customization.plugins||(this.api.asc_registerCallback("asc_onPluginShow",_.bind(this.onPluginShow,this)),this.api.asc_registerCallback("asc_onPluginClose",_.bind(this.onPluginClose,this)),this.api.asc_registerCallback("asc_onPluginResize",_.bind(this.onPluginResize,this)),this.api.asc_registerCallback("asc_onPluginsReset",_.bind(this.resetPluginsList,this)),this.api.asc_registerCallback("asc_onPluginsInit",_.bind(this.onPluginsInit,this)),this.api.asc_registerCallback("asc_onPluginShowButton",_.bind(this.onPluginShowButton,this)),this.api.asc_registerCallback("asc_onPluginHideButton",_.bind(this.onPluginHideButton,this)),this.api.asc_registerCallback("asc_onPluginWindowShow",_.bind(this.onApiPluginWindowShow,this)),this.api.asc_registerCallback("asc_onPluginWindowClose",_.bind(this.onPluginWindowClose,this)),this.api.asc_registerCallback("asc_onPluginWindowResize",_.bind(this.onPluginWindowResize,this)),this.api.asc_registerCallback("asc_onPluginWindowActivate",_.bind(this.openUIPlugin,this)),this.loadPlugins()),this},setMode:function(t,e){return this.appOptions=t,this.api=e,this.customPluginsComplete=!this.appOptions.canBrandingExt,this.appOptions.canBrandingExt&&this.getAppCustomPlugins(this.configPlugins),this},onAfterRender:function(t,e,i){var n=this;i&&this.openUIPlugin(e),t.pluginClose.on("click",_.bind(this.onToolClose,this,t)),t.pluginHide&&t.pluginHide.on("click",_.bind(this.onToolHide,this,t)),Common.NotificationCenter.on({"layout:resizestart":function(e){t&&(t.enablePointerEvents&&t.enablePointerEvents(!1),n.api.asc_pluginEnableMouseEvents(!0))},"layout:resizestop":function(e){t&&(t.enablePointerEvents&&t.enablePointerEvents(!0),n.api.asc_pluginEnableMouseEvents(!1))}})},refreshPluginsList:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=[];t.each((function(t){var i=new Asc.CPlugin;i.deserialize(t.get("original")),t.set("pluginObj",i),e.push(i)})),this.api.asc_pluginsRegister("",e),t.hasVisible()&&Common.NotificationCenter.trigger("tab:visible","plugins",Common.UI.LayoutManager.isElementVisible("toolbar-plugins")),Common.Gateway.pluginsReady()},onAddPlugin:function(t){var e=this;if(e.$toolbarPanelPlugins){var i=e.viewPlugins.createPluginButton(t);if(!i)return;var n=$("> .group",e.$toolbarPanelPlugins),o=$('<span class="btn-slot text x-huge"></span>').appendTo(n);i.render(o);var s=e.viewPlugins._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,s.isReadOnly,{array:i}),Common.Utils.lockControls(Common.enumLock.docLockForms,s.isFormsOnly,{array:i}),Common.Utils.lockControls(Common.enumLock.docLockComments,s.isCommentsOnly,{array:i})}},addBackgroundPluginsButton:function(t){t.appendTo(this.$toolbarPanelPlugins),t=$('<div class="group" style="'+(Common.UI.isRTL()?"padding-right: 0;":"padding-left: 0;")+'"></div>'),this.viewPlugins.backgroundBtn=this.viewPlugins.createBackgroundPluginsButton();var e=$('<span class="btn-slot text x-huge"></span>').appendTo(t);return this.viewPlugins.backgroundBtn.render(e),this.viewPlugins.backgroundBtn.hide(),t},turnOffBackgroundPlugin:function(t){var e;if(this.backgroundPluginsSwitchers)return this.backgroundPluginsSwitchers.forEach((function(i){i.options.pluginGuid===t&&(e=i)})),!!e&&(e.updateHint(this.viewPlugins.textStart),e.setValue(!1),!0)},onShowBeforeBackgroundPlugins:function(t){var e=this;e.clickInsideMenu=!1;var i=function(){for(var e=t.cmpEl.find(".dropdown-toggle.active"),i=0;i<e.length;i++){var n=e[i];$(n).parent().toggleClass("open",!1),$(n).trigger($.Event("hide.bs.dropdown"))}};this.backgroundPluginsSwitchers=[];var n=this.api.getUsedBackgroundPlugins();this.backgroundPlugins.forEach((function(o){var s=o.get("variations"),a=s[o.get("currentVariation")].get("icons"),r=e.viewPlugins.parseIcons(a),l=o.get("baseUrl")+r.normal,c=o.get("guid"),h=-1!==_.indexOf(n,c);o.set("parsedIcons",r);var d=new Common.UI.MenuItem({value:c,caption:o.get("name"),iconImg:l,template:_.template(['<div id="<%= id %>" class="menu-item" <% if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% } %> >','<img class="menu-item-icon" src="<%= options.iconImg %>">','<div class="plugin-caption"><%= caption %></div>','<div class="plugin-tools">','<div class="plugin-toggle"></div>','<div class="plugin-settings"></div>',"</span>","</a>"].join("")),stopPropagation:!0});t.addItem(d),o.set("backgroundPlugin",d);var u=new Common.UI.Switcher({el:d.$el.find(".plugin-toggle")[0],value:!!o.isSystem||h,disabled:!!o.isSystem,pluginGuid:c,hint:h?e.viewPlugins.textStop:e.viewPlugins.textStart});u.on("change",(function(t,i){u.updateHint(i?e.viewPlugins.textStop:e.viewPlugins.textStart),e.viewPlugins.fireEvent("plugin:select",[u.options.pluginGuid,0,!i])})),e.backgroundPluginsSwitchers.push(u);var m=[];if(_.each(s,(function(t,e){e>0&&t.get("visible")&&m.push({caption:t.get("description"),value:parseInt(t.get("index"))})})),m.length>0){var p=new Common.UI.Button({parentEl:d.$el.find(".plugin-settings"),cls:"btn-toolbar",iconCls:"menu__icon btn-more",menu:new Common.UI.Menu({menuAlign:"tl-bl",items:m,pluginGuid:c}),onlyIcon:!0,stopPropagation:!0,hint:e.viewPlugins.textSettings});p.menu.on("item:click",(function(t,i,n){Common.UI.Menu.Manager.hideAll(),e.viewPlugins.fireEvent("plugin:select",[t.options.pluginGuid,i.value,!1]),e.clickInsideMenu=!1})),p.menu.on("keydown:before",(function(t,e){e.keyCode==Common.UI.Keys.ESC&&(i(),_.delay((function(){p.cmpEl.closest(".btn-group.open").find("[data-toggle=dropdown]:first").focus()}),10))})),p.menu.cmpEl.find("li").on("mousedown",(function(){e.clickInsideMenu=!0})),p.cmpEl.on("mousedown",(function(){e.clickInsideMenu=!0})),p.on("click",(function(){var t=p.$el.find(".btn-group"),n=t.hasClass("open");n||i(),t.toggleClass("open",!n),$(p.menu.el).trigger($.Event(n?"hide.bs.dropdown":"show.bs.dropdown")),e.clickInsideMenu=!1}))}})),t.cmpEl.find("li").on("mousedown",(function(){e.clickInsideMenu||i()}))},onResetPlugins:function(t){var e=this;if(e.customButtonsArr.forEach((function(t){e.toolbar&&e.toolbar.addCustomControls({action:t.tab},void 0,[t.btn])})),e.customButtonsArr=[],e.appOptions.canPlugins=!t.isEmpty(),e.$toolbarPanelPlugins){e.backgroundPlugins=[],e.$toolbarPanelPlugins.empty(),e.toolbar&&e.toolbar.clearMoreButton("plugins");var i=$('<div class="group"></div>'),n=-1,o=0,s=!1;if(t.each((function(t){var a=t.get("groupRank");if(t.get("isBackgroundPlugin"))e.backgroundPlugins.push(t);else if(t.get("tab")){let i=t.get("tab"),n=e.viewPlugins.createPluginButton(t);n&&(n.options.separator=i.separator,e.toolbar&&e.toolbar.addCustomControls(i,[n]),e.customButtonsArr.push({tab:i.action,btn:n}))}else{0!==a&&2!==a||s||(i=e.addBackgroundPluginsButton(i),s=!0,n=1.5,o++);var r=e.viewPlugins.createPluginButton(t);if(r){a!==n&&n>-1&&o>0?(i.appendTo(e.$toolbarPanelPlugins),$('<div class="separator long"></div>').appendTo(e.$toolbarPanelPlugins),i=$('<div class="group"></div>'),o=0):o>0&&(i.appendTo(e.$toolbarPanelPlugins),$('<div class="separator long invisible"></div>').appendTo(e.$toolbarPanelPlugins),i=$('<div class="group" style="'+(Common.UI.isRTL()?"padding-right: 0;":"padding-left: 0;")+'"></div>'));var l=$('<span class="btn-slot text x-huge"></span>').appendTo(i);r.render(l),o++,n=a}1!==a||s||(i=e.addBackgroundPluginsButton(i),s=!0)}})),i.appendTo(e.$toolbarPanelPlugins),e.backgroundPlugins.length>0){e.viewPlugins.backgroundBtn.show();var a=function(t){e.onShowBeforeBackgroundPlugins(t),t.off("show:before",a)};e.viewPlugins.backgroundBtn.menu.on("show:before",a),e.viewPlugins.backgroundBtn.on("click",(function(){e.closeBackPluginsTip()}))}e.toolbar&&e.toolbar.isTabActive("plugins")&&e.toolbar.processPanelVisible(null,!0);var r=e.viewPlugins._state.docProtection;Common.Utils.lockControls(Common.enumLock.docLockView,r.isReadOnly,{array:e.viewPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,r.isFormsOnly,{array:e.viewPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,r.isCommentsOnly,{array:e.viewPlugins.lockedControls})}else console.error("toolbar panel isnot created")},updatePluginsButtons:function(){var t=this.getApplication().getCollection("Common.Collections.Plugins"),e=this,i=[],n=[];for(var o in t.each((function(t){e.viewPlugins.updatePluginIcons(t);var o=t.get("guid");e.viewPlugins.pluginPanels[o]&&t.get("parsedIcons")&&("right"===e.viewPlugins.pluginPanels[o].menu?n:i).push({guid:o,baseUrl:t.get("baseUrl"),parsedIcons:t.get("parsedIcons")})})),this.viewPlugins.customPluginPanels){var s=this.viewPlugins.customPluginPanels[o];if(s.icons)("right"===s.menu?n:i).push({guid:s.frameId,baseUrl:s.baseUrl,parsedIcons:this.viewPlugins.parseIcons(s.icons)})}i.length>0&&e.viewPlugins.fireEvent("pluginsleft:updateicons",[i]),n.length>0&&e.viewPlugins.fireEvent("pluginsright:updateicons",[n])},onSelectPlugin:function(t,e,i,n){var o=$(n.target);if(o&&o.hasClass("plugin-caret")){var s=this.viewPlugins.pluginMenu;if(s.isVisible())return void s.hide();var a,r=this,l=$(n.currentTarget),c=$(this.viewPlugins.el),h=l.offset(),d=c.offset();if(a=[h.left-d.left+l.width(),h.top-d.top+l.height()/2],null!=i){for(var u=0;u<s.items.length;u++)s.removeItem(s.items[u]),u--;s.removeAll();var m=i.get("variations");for(u=0;u<m.length;u++){var p=m[u],f=new Common.UI.MenuItem({caption:u>0?p.get("description"):r.viewPlugins.textStart,value:parseInt(p.get("index"))}).on("click",(function(t,e){r.api&&r.api.asc_pluginRun(i.get("guid"),t.value,"")}));s.addItem(f)}}var g=c.find("#menu-plugin-container");s.rendered||(g.length<1&&(g=$('<div id="menu-plugin-container" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id),c.append(g)),s.render(g),s.cmpEl.attr({tabindex:"-1"}),s.on({"show:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!0)},"hide:after":function(t){t&&t.menuAlignEl&&t.menuAlignEl.toggleClass("over",!1)}})),g.css({left:a[0],top:a[1]}),s.menuAlignEl=l,s.setOffset(-20,-l.height()/2-3),s.show(),_.delay((function(){s.cmpEl.focus()}),10),n.stopPropagation(),n.preventDefault()}else this.api.asc_pluginRun(i.get("guid"),0,"")},addPluginToSideMenu:function(t,e,i,n,o,s){var a,r=t.get_Guid(),l=this.viewPlugins.storePlugins.findWhere({guid:r}),c=function(t){for(var e=t.toLowerCase().replace(/[^a-z0-9\-_:]/g,"-"),i=e,n=0;!($("#panel-plugins-"+i).length<1);)i=e+"-"+ ++n;return i}(t.get_Name("en")),h=l.get("variations")[l.get("currentVariation")].get("icons");l.set({menu:n}),h||(a="icon toolbar__icon btn-plugin-panel-default");var d=$('<div id="slot-btn-plugins'+c+'"></div>'),u=new Common.UI.ButtonCustom({cls:"btn-category plugin-buttons",hint:i,enableToggle:!0,toggleGroup:"right"===n?"tabpanelbtnsGroup":"leftMenuGroup",iconCls:a,iconsSet:this.viewPlugins.iconsStr2IconsObj(h),baseUrl:l.get("baseUrl"),onlyIcon:!0,value:r,type:"plugin"});u.render(d);var m=$('<div id="panel-plugins-'+c+'" class="plugin-panel content-box" style="height: 100%;"></div>');this.viewPlugins.fireEvent("right"===n?"plugins:addtoright":"plugins:addtoleft",[u,d,m]),this.viewPlugins.pluginPanels[r]=new Common.Views.PluginPanel({el:"#panel-plugins-"+c,menu:n,sideMenuButton:u,isCanDocked:!!e.get_IsCanDocked&&e.get_IsCanDocked()}),this.viewPlugins.pluginPanels[r].on("render:after",_.bind(this.onAfterRender,this,this.viewPlugins.pluginPanels[r],r,!0)),this.viewPlugins.pluginPanels[r].on("docked",_.bind((function(){this.onPluginClose(t),this.addPluginToWindow(t,e,i,n,o,s),this.savePluginDockedPosition(r,Asc.PluginType.Window)}),this)),this.viewPlugins.pluginPanels[t.get_Guid()].openInsideMode(i,s,o,t.get_Guid())||this.api.asc_pluginButtonClick(-1,t.get_Guid())},addPluginToWindow:function(t,e,i,n,o,s){var a=this,r=function(){var r=e.get_CustomWindow(),l=e.get_Buttons(),c=[],h=e.get_Size(),d=e.get_Modal();(!h||h.length<2)&&(h=[800,600]),_.isArray(l)&&_.each(l,(function(t,e){t.visible&&(c[e]={caption:t.text,value:e,primary:t.primary})}));var u=e.get_Help();a.pluginDlg=new Common.Views.PluginDlg({guid:t.get_Guid(),cls:r?"plain":"",header:!r,title:Common.Utils.String.htmlEncode(i),width:h[0],height:h[1],url:s,frameId:o,buttons:r?void 0:c,toolcallback:function(e){a.api.asc_pluginButtonClick(-1,t.get_Guid())},help:!!u,loader:t.get_Loader(),modal:void 0===d||d,isCanDocked:!!e.get_IsCanDocked&&e.get_IsCanDocked()}),a.pluginDlg.on({"render:after":function(e){e.getChild(".footer .dlg-btn").on("click",(function(e){a.api.asc_pluginButtonClick(parseInt(e.currentTarget.attributes.result.value),t.get_Guid())})),a.pluginContainer=a.pluginDlg.$window.find("#id-plugin-container")},close:function(t){a.pluginDlg=void 0},drag:function(t){a.api.asc_pluginEnableMouseEvents("start"==t[1]),t[0].enablePointerEvents("start"!==t[1])},resize:function(t){a.api.asc_pluginEnableMouseEvents("start"==t[1]),t[0].enablePointerEvents("start"!==t[1])},help:function(){u&&window.open(u,"_blank")},docked:function(){a.onPluginClose(t),a.addPluginToSideMenu(t,e,i,n,o,s),a.savePluginDockedPosition(t.get_Guid(),Asc.PluginType.Panel)},"header:click":function(e){a.api.asc_pluginButtonClick(e,t.get_Guid())}}),a.pluginDlg.show()};this.pluginDlg?(this.api.asc_pluginButtonClick(-1,this.pluginDlg.guid),setTimeout(r,10)):r()},closePluginInPanel:function(t){var e=this.viewPlugins.pluginPanels[t];if(e&&e.iframePlugin){e.closeInsideMode(t),this.viewPlugins.pluginPanels[t].$el.remove(),delete this.viewPlugins.pluginPanels[t];var i=this.viewPlugins.storePlugins.findWhere({guid:t});return this.viewPlugins.fireEvent("right"===i.get("menu")?"pluginsright:close":"pluginsleft:close",[t]),!0}return!1},savePluginDockedPosition:function(t,e){var i=Common.localStorage.getItem("plugins-docked-position")||"{}";(i=JSON.parse(i))[t]=e,Common.localStorage.setItem("plugins-docked-position",JSON.stringify(i))},getPluginDockedPosition:function(t){var e=Common.localStorage.getItem("plugins-docked-position")||"{}";return(e=JSON.parse(e))[t]},openUIPlugin:function(t){var e=this.viewPlugins.storePlugins.findWhere({guid:t}),i=e?e.get("menu"):this.viewPlugins.customPluginPanels[t]&&this.viewPlugins.customPluginPanels[t].menu;this.viewPlugins.fireEvent("right"===i?"pluginsright:open":"pluginsleft:open",[t])},onPluginShow:function(t,e,i,n){var o=t.get_Variations()[e];if(o.get_Visual()){var s=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",a=o.get_Url(),r=t.get_Name(s),l=!!o.get_IsCanDocked&&o.get_IsCanDocked(),c=this.getPluginDockedPosition(t.get_Guid()),h=this.isPDFEditor?"left":o.get_Type()===Asc.PluginType.PanelRight?"right":"left",d=o.get_InsideMode();l&&(h=(d=c===Asc.PluginType.Panel||c===Asc.PluginType.PanelRight)?c===Asc.PluginType.PanelRight?"right":"left":h),!h&&(h="left"),a=(0==t.get_BaseUrl().length?a:t.get_BaseUrl())+a,n&&(a+=n),d?this.addPluginToSideMenu(t,o,r,h,i,a):this.addPluginToWindow(t,o,r,h,i,a),this.viewPlugins.openedPluginMode(t.get_Guid(),d)}else this.viewPlugins.openedPluginMode(t.get_Guid(),o.get_InsideMode())},onPluginClose:function(t){var e=!1,i=t.get_Guid();this.pluginDlg&&this.pluginDlg.guid===i?this.pluginDlg.close():this.closePluginInPanel(i)&&(e=!0);!this.turnOffBackgroundPlugin(i)&&this.viewPlugins.closedPluginMode(i,e),this.runAutoStartPlugins(),Common.UI.LayoutManager.clearCustomMenuItems(i),Common.UI.LayoutManager.clearCustomControls(i)},onPluginResize:function(t,e,i,n){if(this.pluginDlg){var o=e&&e.length>1&&i&&i.length>1&&(i[0]>e[0]||i[1]>e[1]||0==i[0]||0==i[1]);this.pluginDlg.setResizable(o,e,i),this.pluginDlg.setInnerSize(t[0],t[1]),n&&n.call()}},onToolClose:function(t){this.api.asc_pluginButtonClick(-1,t&&t._state.insidePlugin,t&&t.frameId)},onToolHide:function(t){t&&t.sideMenuButton&&t.sideMenuButton.click()},onPluginsInit:function(t,e){!(t instanceof Array)&&(t=t.pluginsData),this.parsePlugins(t,!1,!0,e)},onPluginShowButton:function(t,e){this.pluginDlg&&this.pluginDlg.showButton(t,e)},onPluginHideButton:function(t){this.pluginDlg&&this.pluginDlg.hideButton(t)},runAutoStartPlugins:function(){this.autostart&&this.autostart.length>0&&this.api.asc_pluginRun(this.autostart.shift(),0,"")},resetPluginsList:function(){this.getApplication().getCollection("Common.Collections.Plugins").reset()},applyUICustomization:function(){var me=this;return new Promise((function(resolve,reject){var timer_sl=setInterval((function(){if(me.customPluginsComplete){clearInterval(timer_sl);try{me.configPlugins.UIplugins&&me.configPlugins.UIplugins.forEach((function(c){c.code&&eval(c.code)}))}catch(t){}resolve()}}),10)}))},parsePlugins:function(t,e,i,n){this.closeBackPluginsTip();var o=this,s=this.getApplication().getCollection("Common.Collections.Plugins"),a=o.appOptions.isEdit,r=o.editor,l=o.api?o.api.GetVersion():void 0;if(t instanceof Array){var c=[],h=[],d=o.appOptions.lang.split(/[\-_]/)[0];t.forEach((function(t){var e;if(i)!(e=c.find((function(e){return e.get("baseUrl")==t.baseUrl||e.get("guid")==t.guid})))&&(e=s.findWhere({baseUrl:t.baseUrl})),!e&&(e=s.findWhere({guid:t.guid}));else if(c.some((function(e){return e.get("baseUrl")==t.baseUrl||e.get("guid")==t.guid}))||s.findWhere({baseUrl:t.baseUrl})||s.findWhere({guid:t.guid}))return;var u,m=[],p=!1,f=!1,g=!1;if(t.variations&&t.variations.forEach((function(e,i){var n=Asc.PluginType.getType(e.type);u=!0===e.isSystem||Asc.PluginType.System===n;var o=(a||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,r)&&!u;if(o&&(p=!0),e.isViewer&&!1!==e.isDisplayedInViewer&&(f=!0),t.isUICustomizer)o&&h.push({url:t.baseUrl+e.url});else{var s=new Common.Models.PluginVariation(e),l=e.description;"object"==typeof e.descriptionLocale&&(l=e.descriptionLocale[d]||e.descriptionLocale.en||l||""),_.each(e.buttons,(function(t,e){"object"==typeof t.textLocale&&(t.text=t.textLocale[d]||t.textLocale.en||t.text||""),t.visible=a||!1!==t.isViewer}));var c="string"==typeof e.icons&&-1!==e.icons.indexOf("%")||!e.icons2?e.icons:e.icons2;c||(c=""),s.set({description:l,index:m.length,url:e.url,icons:c,buttons:e.buttons,visible:o,help:e.help}),m.push(s),0===i&&(g=!!e.type&&n===Asc.PluginType.Background)}})),m.length>0&&!t.isUICustomizer){var b=t.name;if("object"==typeof t.nameLocale&&(b=t.nameLocale[d]||t.nameLocale.en||b||""),p&&(p=o.checkPluginVersion(l,t.minVersion)),"asc.{E6978D28-0441-4BD7-8346-82FAD68BCA3B}"===t.guid)return;var v={name:b,guid:t.guid,baseUrl:t.baseUrl,variations:m,currentVariation:0,visible:p,groupName:t.group?t.group.name:"",groupRank:t.group?t.group.rank:0,minVersion:t.minVersion,original:t,isDisplayedInViewer:f,isBackgroundPlugin:p&&g,isSystem:u,tab:t.tab?{action:t.tab.id,caption:("object"==typeof t.tab.text?t.tab.text[d]||t.tab.text.en:t.tab.text)||"",separator:t.tab.separator}:void 0};e?e.set(v):c.push(new Common.Models.Plugin(v)),n&&!e&&v.isBackgroundPlugin&&o.newInstalledBackgroundPlugins.push({name:b,guid:t.guid})}})),!1!==e&&(o.configPlugins.UIplugins=h),!e&&s&&((c=s.models.concat(c)).sort((function(t,e){var i=t.get("groupRank"),n=e.get("groupRank");return i<n?0==i?1:-1:i>n?0==n?-1:1:0})),s.reset(c),this.appOptions.canPlugins=!s.isEmpty(),o.newInstalledBackgroundPlugins=_.filter(o.newInstalledBackgroundPlugins,(function(t){return!!s.findWhere({guid:t.guid})})))}else e||(this.appOptions.canPlugins=!1);e||this.getApplication().getController("LeftMenu").enablePlugins(),this.appOptions.canPlugins&&(this.refreshPluginsList(),this.startOnPostLoad=!Common.Controllers.LaunchController.isScriptLoaded(),!this.startOnPostLoad&&this.runAutoStartPlugins())},checkPluginVersion:function(t,e){if(t&&"develop"!==t&&e&&"string"==typeof e){var i=e.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/),n=t.match(/^([0-9]+)(?:.([0-9]+))?(?:.([0-9]+))?$/);if(i&&i.length>1&&n&&n.length>1)for(var o=0;o<3;o++){var s=i[o+1]?parseInt(i[o+1]):0,a=n[o+1]?parseInt(n[o+1]):0;if(s>a)return!1;if(s<a)return!0}}return!0},getPlugins:function(t,e){if(!t||t.length<1)return Promise.resolve([]);e=e||function(t){return fetch(t).then((function(e){return e.ok?e.json():Promise.reject(t)})).then((function(e){return e.baseUrl=t.substring(0,t.lastIndexOf("config.json")),e}))};var i=[];return t.map(e).reduce((function(t,e){return t.then((function(){return e})).then((function(t){return i.push(t),Promise.resolve(t)})).catch((function(t){return Promise.resolve(t)}))}),Promise.resolve()).then((function(){return Promise.resolve(i)}))},mergePlugins:function(){if(void 0!==this.serverPlugins.plugins&&void 0!==this.configPlugins.plugins){var t=[],e=[],i=this.configPlugins,n=!1;if(i.plugins&&i.plugins.length>0&&(e=i.plugins),i&&i.config){var o=i.config.autostart||i.config.autoStartGuid;"string"==typeof o&&(o=[o]),n=!!i.config.autoStartGuid,t=o||[]}(i=this.serverPlugins).plugins&&i.plugins.length>0&&(e=e.concat(i.plugins)),i&&i.config&&("string"==typeof(o=i.config.autostart||i.config.autoStartGuid)&&(o=[o]),(n||i.config.autoStartGuid)&&console.warn("Obsolete: The autoStartGuid parameter is deprecated. Please check the documentation for new plugin connection configuration."),t=t.concat(o||[])),this.autostart=t,this.parsePlugins(e,!1)}},getAppCustomPlugins:function(t){var e=this,i=function(){e.customPluginsComplete=!0};t.config?this.getPlugins(t.config.UIpluginsData).then((function(n){e.parsePlugins(n,!0),e.getPlugins(t.UIplugins,(function(t){return fetch(t.url).then((function(t){return t.ok?t.text():Promise.reject()})).then((function(e){return t.code=e,e}))})).then(i,i)}),i):i()},onChangeProtectDocument:function(t){if(!t){var e=this.getApplication().getController("DocProtection");t=e?e.getDocProps():null}t&&this.viewPlugins&&(this.viewPlugins._state.docProtection=t,Common.Utils.lockControls(Common.enumLock.docLockView,t.isReadOnly,{array:this.viewPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockForms,t.isFormsOnly,{array:this.viewPlugins.lockedControls}),Common.Utils.lockControls(Common.enumLock.docLockComments,t.isCommentsOnly,{array:this.viewPlugins.lockedControls}))},onChangeDocMode:function(t){"view"===t&&this.pluginDlg&&this.api.asc_pluginButtonClick(-1,this.pluginDlg.guid)},onPluginWindowShow:function(t,e,i){var n=this,o=e.isCustomWindow,s=e.buttons,a=[],r=e.size,l=e.isModal,c=Asc.PluginType.getType(e.type),h=c===Asc.PluginType.Panel||c===Asc.PluginType.PanelRight;(!r||r.length<2)&&(r=[800,600]);var d=e.description;"object"==typeof e.descriptionLocale&&(d=e.descriptionLocale[i]||e.descriptionLocale.en||d||""),_.isArray(s)&&_.each(s,(function(e,o){"object"==typeof e.textLocale&&(e.text=e.textLocale[i]||e.textLocale.en||e.text||""),(n.appOptions.isEdit||!1!==e.isViewer)&&(a[o]={caption:e.text,value:o,primary:e.primary,frameId:t})}));var u=e.help;n.customPluginsDlg[t]=new Common.Views.PluginDlg({cls:o?"plain":"",header:!o,title:d,width:r[0],height:r[1],url:e.url,frameId:t,buttons:o?void 0:a,toolcallback:function(i){n.api.asc_pluginButtonClick(-1,e.guid,t)},help:!!u,isCanDocked:e.isCanDocked,modal:void 0===l||l}),n.customPluginsDlg[t].on({"render:after":function(i){i.getChild(".footer .dlg-btn").on("click",(function(i){n.api.asc_pluginButtonClick(parseInt(i.currentTarget.attributes.result.value),e.guid,t)})),n.customPluginsDlg[t].options.pluginContainer=n.customPluginsDlg[t].$window.find("#id-plugin-container")},close:function(e){n.customPluginsDlg[t]=void 0},drag:function(e){n.api.asc_pluginEnableMouseEvents("start"==e[1],t),e[0].enablePointerEvents("start"!==e[1])},resize:function(e){n.api.asc_pluginEnableMouseEvents("start"==e[1],t),e[0].enablePointerEvents("start"!==e[1])},help:function(){u&&window.open(u,"_blank")},docked:function(t){n.api.asc_pluginButtonDockChanged(h?e.type:"panel",e.guid,t,(function(){setTimeout((function(){n.customPluginsDlg[t].close(),n.onPluginPanelShow(t,e,i)}),0)}))},"header:click":function(i){n.api.asc_pluginButtonClick(i,e.guid,t)}}),n.customPluginsDlg[t].show()},onApiPluginWindowShow:function(t,e){if(Common.Controllers.LaunchController.isScriptLoaded()){if(e.isVisual){if(this.customPluginsDlg[t]||this.viewPlugins.customPluginPanels[t])return;var i=this.appOptions&&this.appOptions.lang?this.appOptions.lang.split(/[\-_]/)[0]:"en",n=Asc.PluginType.getType(e.type),o=!0===e.isSystem||Asc.PluginType.System===n,s=n===Asc.PluginType.Panel||n===Asc.PluginType.PanelRight,a=(this.appOptions.isEdit||e.isViewer&&!1!==e.isDisplayedInViewer)&&_.contains(e.EditorsSupport,this.editor)&&!o;a&&s?this.onPluginPanelShow(t,e,i):a&&!e.isInsideMode&&this.onPluginWindowShow(t,e,i)}if(this.pluginsWinToShow.length>0){let t=this.pluginsWinToShow.shift();t&&this.onApiPluginWindowShow(t.frameId,t.variation)}}else this.pluginsWinToShow.push({frameId:t,variation:e})},onPluginWindowClose:function(t){if(this.pluginsWinToShow.length>0&&(this.pluginsWinToShow=_.reject(this.pluginsWinToShow,(function(e){return e.frameId===t}))),this.customPluginsDlg[t])this.customPluginsDlg[t].close();else if(this.viewPlugins.customPluginPanels[t]){var e=this.viewPlugins.customPluginPanels[t];e&&e.iframePlugin&&(e.closeInsideMode(),e.$el.remove(),delete this.viewPlugins.customPluginPanels[t],this.viewPlugins.fireEvent("right"===e.menu?"pluginsright:close":"pluginsleft:close",[t]))}},onPluginWindowResize:function(t,e,i,n,o){if(this.customPluginsDlg[t]){var s=i&&i.length>1&&n&&n.length>1&&(n[0]>i[0]||n[1]>i[1]||0==n[0]||0==n[1]);this.customPluginsDlg[t].setResizable(s,i,n),this.customPluginsDlg[t].setInnerSize(e[0],e[1])}o&&o.call()},onPluginPanelShow:function(t,e,i){var n=e.guid,o=this.isPDFEditor?"left":"panelRight"==e.type?"right":"left";!o&&(o="left");var s=e.description;"object"==typeof e.descriptionLocale&&(s=e.descriptionLocale[i]||e.descriptionLocale.en||s||"");var a,r=e.baseUrl||"",l=this.viewPlugins.storePlugins.findWhere({guid:n}),c=e.icons,h=!1!==e.isActivated;l&&(""===r&&(r=l.get("baseUrl")),c||(c=l.get("variations")[l.get("currentVariation")].get("icons")));c||(a="icon toolbar__icon btn-plugin-panel-default");var d=$('<div id="slot-btn-plugins-'+t+'"></div>'),u=new Common.UI.ButtonCustom({cls:"btn-category plugin-buttons",hint:s,enableToggle:!0,toggleGroup:"right"===o?"tabpanelbtnsGroup":"leftMenuGroup",iconCls:a,iconsSet:this.viewPlugins.iconsStr2IconsObj(c),baseUrl:r,onlyIcon:!0,value:t,type:"plugin"});u.render(d);var m=$('<div id="panel-plugins-'+t+'" class="plugin-panel content-box" style="height: 100%;"></div>');this.viewPlugins.fireEvent("right"===o?"plugins:addtoright":"plugins:addtoleft",[u,d,m]),this.viewPlugins.customPluginPanels[t]=new Common.Views.PluginPanel({el:"#panel-plugins-"+t,menu:o,frameId:t,baseUrl:r,icons:c,sideMenuButton:u,isCanDocked:e.isCanDocked}),this.viewPlugins.customPluginPanels[t].on("render:after",_.bind(this.onAfterRender,this,this.viewPlugins.customPluginPanels[t],t,h)),this.viewPlugins.customPluginPanels[t].on("docked",_.bind((function(t){var n=this;this.api.asc_pluginButtonDockChanged("window",e.guid,t,(function(){setTimeout(_.bind((function(){n.onPluginWindowClose(t),n.onPluginWindowShow(t,e,i)}),this),0)}))}),this)),this.viewPlugins.customPluginPanels[t].openInsideMode(s,e.url,t,n)||this.api.asc_pluginButtonClick(-1,n,t)},onModalClose:function(){var t=this.newInstalledBackgroundPlugins;if(t&&t.length>0&&this.viewPlugins.backgroundBtn&&this.viewPlugins.backgroundBtn.isVisible()){var e=t.length>1?this.textPluginsSuccessfullyInstalled:Common.Utils.String.format(this.textPluginSuccessfullyInstalled,t[0].name);this.backgroundPluginsTip&&this.backgroundPluginsTip.isVisible()&&this.backgroundPluginsTip.close(),this.backgroundPluginsTip=new Common.UI.SynchronizeTip({extCls:"colored",placement:"bottom",target:this.viewPlugins.backgroundBtn.$el,text:e,showLink:!0,textLink:t.length>1?this.textRunInstalledPlugins:this.textRunPlugin}),this.backgroundPluginsTip.on("dontshowclick",(function(){this.backgroundPluginsTip.close(),this.backgroundPluginsTip=void 0,this.newInstalledBackgroundPlugins.forEach(_.bind((function(t){this.api.asc_pluginRun(t.guid,0,"")}),this)),this.newInstalledBackgroundPlugins.length=0}),this),this.backgroundPluginsTip.on("closeclick",(function(){this.closeBackPluginsTip()}),this),this.backgroundPluginsTip.show()}},onActiveTab:function(t){"plugins"===t||this.closeBackPluginsTip()},closeBackPluginsTip:function(){this.backgroundPluginsTip&&(this.backgroundPluginsTip.close(),this.backgroundPluginsTip=void 0,this.newInstalledBackgroundPlugins&&(this.newInstalledBackgroundPlugins.length=0))},onPostLoadComplete:function(){if(this.pluginsWinToShow.length>0){let t=this.pluginsWinToShow.shift();t&&this.onApiPluginWindowShow(t.frameId,t.variation)}this.startOnPostLoad&&this.runAutoStartPlugins()},textRunPlugin:"Run plugin",textRunInstalledPlugins:"Run installed plugins",textPluginSuccessfullyInstalled:"<b>{0}</b> is successfully installed. You can access all background plugins here.",textPluginsSuccessfullyInstalled:"Plugins are successfully installed. You can access all background plugins here."},Common.Controllers.Plugins||{}))})),require.config({baseUrl:window.customBaseUrl||"../../",paths:{jquery:"../vendor/jquery/jquery",underscore:"../vendor/underscore/underscore",backbone:"../vendor/backbone/backbone",text:"../vendor/requirejs-text/text",perfectscrollbar:"common/main/lib/mods/perfect-scrollbar",jmousewheel:"../vendor/perfect-scrollbar/src/jquery.mousewheel",xregexp:"../vendor/xregexp/xregexp-all-min",socketio:"../vendor/socketio/socket.io.min",allfonts:"../../sdkjs/common/AllFonts",sdk:"../../sdkjs/visio/sdk-all-min",api:"api/documents/api",core:"common/main/lib/core/application",notification:"common/main/lib/core/NotificationCenter",keymaster:"common/main/lib/core/keymaster",tip:"common/main/lib/util/Tip",localstorage:"common/main/lib/util/LocalStorage",analytics:"common/Analytics",gateway:"common/Gateway",locale:"common/locale",irregularstack:"common/IrregularStack",x2t:"../../sdkjs/common/wasm/x2t/x2t_helper"},shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},perfectscrollbar:{deps:["jmousewheel"]},notification:{deps:["backbone"]},core:{deps:["backbone","notification","irregularstack"]},sdk:{deps:["jquery","allfonts","xregexp","socketio"]},gateway:{deps:["jquery"]},analytics:{deps:["jquery"]}}}),require(["sdk","backbone","underscore","core","analytics","gateway","locale"],(function(t,e,i,n){if(!e.History||!e.History.started){e.history.start(),window._=i;var o=new e.Application({nameSpace:"VE",autoCreate:!1,controllers:["Viewport","DocumentHolder","Toolbar","Statusbar","LeftMenu","Main","ViewTab","Common.Controllers.Chat","Common.Controllers.Plugins"]});Common.Locale.apply((function(){require(["common/main/lib/mods/dropdown","common/main/lib/mods/tooltip","common/main/lib/util/LocalStorage","common/main/lib/controller/Scaling","common/main/lib/controller/Themes","common/main/lib/controller/TabStyler","common/main/lib/controller/Desktop","visioeditor/main/app/controller/Viewport","visioeditor/main/app/controller/DocumentHolder","visioeditor/main/app/controller/Toolbar","visioeditor/main/app/controller/Statusbar","visioeditor/main/app/controller/LeftMenu","visioeditor/main/app/controller/Main","visioeditor/main/app/controller/ViewTab","common/main/lib/util/utils","common/main/lib/controller/Chat","common/main/lib/controller/Plugins"],(function(){o.postLaunchScripts=["visioeditor/main/code"],o.start()}))}))}}),(function(t){"timeout"==t.requireType&&!reqerr&&window.requireTimeourError&&(reqerr=window.requireTimeourError(),window.alert(reqerr),window.location.reload())})),define("../apps/visioeditor/main/app.js",(function(){}));