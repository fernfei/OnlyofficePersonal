/* minified by terser */
if(void 0===Common)var Common={};void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],(function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}));const helper=function(){let t;const e=function(e){if(e){if(!t&&0==(t=$("div[aria-live]")).length){t=$('<div aria-live="assertive" class="sr-only" style=""></div>').appendTo($("body"))}}else t&&(t.remove(t),t=void 0)};return{setEnabled:e,disable:function(){e(!1)},speech:function(i){t||e(!0),t.text(""),setTimeout((function(e){t.text(i)}),0)}}};if(!window.Common&&(window.Common={}),!Common.Utils&&(Common.Utils={}),Common.Utils.ScreeenReaderHelper=new helper,define("common/main/lib/util/ScreenReaderHelper",(function(){})),void 0===Common)Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ScreenReaderFocusManager=new function(){var t,e,i,n,s=!1,a=!1,o=!1,l=0,r=0,c=document,d=document,p=[],h=!1,m=!1,u=!1,g=!1,b=function(t,e){d=c,e?c=e:"esc"!==t?c=$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):0===l?document:t&&t.closest(".hint-section")||document:0===l&&(c=document)},f=function(t){!e||!t&&Common.Utils.ModalWindow.isVisible()||(h=t,e.asc_enableKeyEvents(!t))},v=function(){if((0===p.length||$("#file-menu-panel").is(":visible")&&1===l)&&T(),a)if(l!==r&&(0===l||1===l&&$("#file-menu-panel").is(":visible"))){var e=$(d).prop("id");"toolbar"===e?w():"left-menu"===e||"right-menu"===e?S(e):"file-menu-panel"===e&&A()}else 1!==l||l===r||"left-menu"!==$(c).prop("id")&&"right-menu"!==$(c).prop("id")||I("left-menu"===$(c).prop("id"));else $("#file-menu-panel").is(":visible")?A():w();var i=p[t];i&&($(i).parent().hasClass("ribtab")&&!$(i).parent().hasClass("active")&&"file"!==$(i).data("tab")&&$(i).trigger(jQuery.Event("click",{which:1})),$(p[t]).focus()),p.length>0?(!h&&f(!0),a=!0):a=!1},C=function(){a=!1,o=!1,g=!1},y=function(e){r=l,t=0,p.length=0,void 0!==e?l=e:l++},x=function(){l=$("#file-menu-panel").is(":visible")?1:0,b(),p.length=0},w=function(){for(var e,i=0;i<p.length;i++){var n=$(p[i]).parent();if(n&&n.hasClass("ribtab")&&n.hasClass("active")){e=p[i];break}}e&&(t=i)},S=function(e){for(var i,n=0;n<p.length;n++){var s=$(p[n]);if($(s.closest(".hint-section")).prop("id")===e&&s.hasClass("btn-category")&&s.hasClass("active")){i=p[n];break}}i&&(t=n)},A=function(){for(var e,i=0;i<p.length;i++)if($(p[i]).parent().hasClass("active")){e=p[i];break}e&&(t=i)},I=function(e){var n,s=0;if(e&&(n=i.getController("LeftMenu").getView("LeftMenu").getFocusElement()),n)for(var a=0;a<p.length;a++)if($(p[a]).is($(n))){s=a;break}t=s},T=function(){p=[];var t=[];_.isArray(c)?c.forEach((function(e){t=t.concat($(e).find("[data-hint="+l+"]").toArray())})):t=$(c).find("[data-hint="+l+"]").toArray(),(p=t.filter((function(t){return $(t).is(":visible")&&!function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}($(t))}))).forEach((function(t){void 0===$(t).attr("tabindex")&&$(t).attr("tabindex",0)}))},P=function(){C(),x(),h&&f(!1)};return{init:function(d){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){e=d,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE,u=!0;var _=Common.localStorage.getKeysFilter();n=_&&_.length?_.split(",")[0]:"",Common.Utils.ScreeenReaderHelper||require(["common/main/lib/util/ScreenReaderHelper"],(function(){Common.Utils.ScreeenReaderHelper.setEnabled(!0)})),$("#editor_sdk").on("click",(function(){P()})),$(document).on("mousedown",(function(){P()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!s||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?m?(f(!1),m=!1):a&&t.preventDefault():(t.preventDefault(),a?P():($("input:focus").blur(),l=$("#file-menu-panel").is(":visible")?1:0,b(),v())),s=!1})),$(document).on("keydown.after.bs.dropdown",(function(e){if(a){var i=$(p[t]).prop("tagName"),n="INPUT"===i||"TEXTAREA"===i,s=e.keyCode==Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN,d=e.keyCode==Common.UI.Keys.ESC||e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE;if($(p[t]).data("move-focus-only-tab")&&e.keyCode!==Common.UI.Keys.TAB&&!d)return;if(!s&&!d||e.keyCode==Common.UI.Keys.SPACE&&n)return;s&&e.preventDefault(),Common.UI.Menu.Manager.hideAll();var u,f,_,w,S=!1,A=p[t]&&$(p[t]),I=$("#file-menu-panel").is(":visible"),T=A&&A.hasClass("btn-category"),k=e.keyCode==Common.UI.Keys.LEFT,M=e.keyCode==Common.UI.Keys.RIGHT,V=e.keyCode==Common.UI.Keys.UP,U=e.keyCode==Common.UI.Keys.DOWN,L=e.keyCode==Common.UI.Keys.TAB,D=e.shiftKey&&e.keyCode==Common.UI.Keys.TAB;if(I?(u=k||V,f=2===l?M||U||L&&!D:M||U,_=D,w=L&&!D):T?(u=V||D,f=U||L,_=!1,w=M||k):g?(u=D,f=L,_=!1,w=!1):(u=k||D,f=M||L&&!D,_=V,w=U),e.keyCode==Common.UI.Keys.ESC)return void P();if(e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE){if(A&&(A.attr("for")?e.keyCode==Common.UI.Keys.RETURN?$("#"+A.attr("for")).trigger(jQuery.Event("click",{which:1})):e.preventDefault():"file"===A.data("tab")||I&&1===l||T?A.trigger(jQuery.Event("click",{which:1})):setTimeout((function(){A.trigger(jQuery.Event("click",{which:1}))}),1),"dropdown"!==A.data("toggle")&&A.blur()),!(A&&"file"===A.data("tab")||I&&1===l||T&&A.hasClass("active")))return C(),x(),Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),A&&"dropdown"!==A.data("toggle")&&(m=!0),void(h=!1);T&&A.hasClass("active")&&(g=!0),y(),b(A)}else if(u)S=!0,r=l,--t<0&&(t=p.length-1);else if(f)S=!0,r=l,++t>p.length-1&&(t=0);else if(w){var E='[data-hint="'+(l+1)+'"]';if(0===$(c).find(E).length||A&&0===$(A.closest(".hint-section")).find(E).filter(":visible").length)return;S=!0,y(),b(A),T&&(g=!0)}else if(_){if(0===l)return;S=!0,r=l,p.length=0,l--,b(A)}!o&&S&&(o=!0,Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0)),v()}})),$(document).on("keydown",(function(t){s=Common.Utils.InternalSettings.get(n+"settings-show-alt-hints")&&t.keyCode==Common.UI.Keys.ALT&&!t.shiftKey&&!Common.Utils.ModalWindow.isVisible()&&u&&!(window.PE&&$("#pe-preview").is(":visible")),Common.localStorage.getBool("screen-reader-focus-mode",!1)?!$(document.body).hasClass("focus-mode")&&$(document.body).addClass("focus-mode"):$(document.body).hasClass("focus-mode")&&$(document.body).removeClass("focus-mode")}))}},isFocusMode:function(){return!!o},exitFocusMode:P}},define("common/main/lib/controller/ScreenReaderFocus",(function(){})),void 0===Common)Common={};if(define("common/main/lib/component/ComboBoxDataView",[],(function(){"use strict";Common.UI.ComboBoxDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,formTemplate:null,disabled:!1,menuCls:"",menuStyle:"",restoreHeight:0,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle <%= cls %>" data-toggle="dropdown" id="<%= id %>" style="<%= style %>">',"<%= formTemplate() %>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.dataViewStyle=e.options.dataViewStyle,this.dataViewCls=e.options.dataViewCls,this.template=e.options.template||e.template,this.itemTemplate=e.options.itemTemplate,this.disabled=e.options.disabled,this.groups=e.options.groups||null,this.store=e.options.store||new Common.UI.DataViewStore,this.updateFormControl=e.options.updateFormControl,this.options.data&&e.store.add(this.options.data),this.formTemplate=this.options.formTemplate||_.template(['<div class="form-control" style="width: 100px;" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),e.rendered=e.options.rendered||!1,e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},render:function(t){var e=this;if(e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,formTemplate:this.formTemplate,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;this._button=i.find(".btn"),this._formControl=i.find(".form-control"),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e))}return e.getMenu(),e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},getMenu:function(t){if("object"!=typeof this.menu){t=t||this.options;var e=Common.UI.getId(),i=this.$el||$(this.el),n=new Common.UI.Menu({id:e,cls:t.menuCls,style:t.menuStyle,additionalAlign:t.additionalAlign,items:(t.additionalItems?t.additionalItems:[]).concat([{template:_.template('<div id="'+e+'-data-menu" style="'+t.dataViewStyle+'" class="'+t.dataViewCls+'"></div>')}])}).render(i);this.dataPicker=new Common.UI.DataView({el:i.find("#"+e+"-data-menu"),parentMenu:n,outerMenu:{menu:n,index:t.additionalItems?t.additionalItems.length:0,focusOnShow:!t.additionalItems},groups:t.groups,store:t.store,itemTemplate:t.itemTemplate,restoreHeight:t.restoreHeight}),this.dataPicker.on("item:click",_.bind(this.onClickItem,this)),n.setInnerMenu([{menu:this.dataPicker,index:t.additionalItems?t.additionalItems.length:0}]);var s=this;n.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),n.on("show:after",(function(e){s.dataPicker&&_.delay((function(){!t.additionalItems&&s.dataPicker.focus()}),10)})).on("hide:after",(function(){s.options.takeFocusOnClose&&setTimeout((function(){s.focus()}),1)})),this.menu=n}return this.menu},getPicker:function(){return this.dataPicker},onClickItem:function(t,e,i){this.updateFormControl&&this.updateFormControl.call(this,i),this.disabled||this.isSuspendEvents||this.trigger("item:click",this,t,e,i)},selectRecord:function(t){this.rendered&&(this.dataPicker&&this.dataPicker.selectRecord(t,!0),this.updateFormControl&&this.updateFormControl.call(this,t))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),e.preventDefault(),e.stopPropagation(),!1},closeMenu:function(){(this.$el||$(this.el)).removeClass("open")},isMenuOpen:function(){return(this.$el||$(this.el)).hasClass("open")},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this._formControl.attr("tabindex",this.tabindex))},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(void 0!==this.tabindex&&(t&&(this.tabindex=this._formControl.attr("tabindex")),this._formControl.attr("tabindex",t?"-1":this.tabindex)),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t),this._formControl.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},focus:function(){this._formControl&&this._formControl.focus()}})})),define("common/main/lib/view/AdvancedSettingsWindow",[],(function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach((function(i,n){var s=new Common.UI.Button({parentEl:e.find("#slot-category-"+i.panelId),cls:"btn-category "+(i.categoryCls||""),caption:i.panelCaption,iconCls:i.categoryIcon||"",enableToggle:!0,toggleGroup:t.toggleGroup,allowDepress:!1,contentTarget:i.panelId});s.cmpEl.attr("content-target",i.panelId),s.on("click",_.bind(t.onCategoryClick,t,s,n)),t.btnsCategory.push(s)}));let i=e.find(".menu-panel");if(this.content_panel=e.find(".content-panel"),this.content_panel.width(this.contentWidth),e.width((i.length>0?i.outerWidth():0)+this.content_panel.outerWidth()+2),this.options.contentHeight)e.find(".body > .box").css("height",this.options.contentHeight);else if("number"==typeof this.options.height){var n=e.find(".body"),s=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));e.find(".body > .box").css("height",this.options.height-s)}this.content_panels=e.find(".settings-panel"),this.btnsCategory.length>0&&this.btnsCategory[0].toggle(!0,!0);var a=function(){e.width((i.length>0?i.outerWidth():0)+t.content_panel.outerWidth()+2)};$(window).on("resize",a),this.on("close",(function(){$(window).off("resize",a)}))},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"));e.find(".body > .box").css("height",parseInt(i.css("height"))-n)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),n=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));void 0===t&&(t=parseInt(e.find(".body > .box").css("height"))),Common.UI.Window.prototype.setHeight.call(this,t+n),e.find(".body > .box").css("height",t)},fixHeight:function(){let t=this.content_panels.filter(".active").height()-this.content_panel.height();t>0&&this.setInnerHeight(parseInt(this.$window.find(".body > .box").css("height"))+t)},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active"),this.fixHeight()},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=t>=0&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var n=this.btnsCategory[i];if(n.isVisible()&&!n.isDisabled()){e=n,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var t=-1;return this.btnsCategory.forEach((function(e,i){e.pressed&&(t=i)})),t},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.fixHeight())},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))})),define("text",["module"],(function(t){"use strict";var e,i,n,s,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),p=c&&location.hostname,h=c&&(location.port||void 0),m={},u=t.config&&t.config()||{};function g(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(r);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:u.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(t){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,n,s=!1,a=t.lastIndexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!o||a>1)?(e=t.substring(0,a),i=t.substring(a+1)):e=t,-1!==(a=(n=i||e).indexOf("!"))&&(s="strip"===n.substring(a+1),n=n.substring(0,a),i?i=n:e=n),{moduleName:e,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,s){var a,o,l,r=e.xdRegExp.exec(t);return!r||(a=r[2],l=(o=(o=r[3]).split(":"))[1],o=o[0],(!a||a===i)&&(!o||o.toLowerCase()===n.toLowerCase())&&(!l&&!o||function(t,e,i,n){if(e===n)return!0;if(t===i){if("http"===t)return g(e,"80")===g(n,"80");if("https"===t)return g(e,"443")===g(n,"443")}return!1}(a,l,i,s)))},finishLoad:function(t,i,n,s){n=i?e.strip(n):n,u.isBuild&&(m[t]=n),s(n)},load:function(t,i,n,s){if(s&&s.isBuild&&!s.inlineText)n();else{u.isBuild=s&&s.isBuild;var a=e.parseName(t),o=a.moduleName+(a.ext?"."+a.ext:""),l=i.toUrl(o),r=u.useXhr||e.useXhr;0!==l.indexOf("empty:")?!c||r(l,d,p,h)?e.get(l,(function(i){e.finishLoad(t,a.strip,i,n)}),(function(t){n.error&&n.error(t)})):i([o],(function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,n)}),(function(t){n.error&&n.error(t)})):n()}},write:function(t,i,n,s){if(m.hasOwnProperty(i)){var a=e.jsEscape(m[i]);n.asModule(t+"!"+i,"define(function () { return '"+a+"';});\n")}},writeFile:function(t,i,n,s,a){var o=e.parseName(i),l=o.ext?"."+o.ext:"",r=o.moduleName+l,c=n.toUrl(o.moduleName+l)+".js";e.load(r,n,(function(i){var n=function(t){return s(c,t)};n.asModule=function(t,e){return s.asModule(t,c,e)},e.write(t,r,n,a)}),a)}},"node"===u.env||!u.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var s=i.readFileSync(t,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),e(s)}catch(t){n&&n(t)}}):"xhr"===u.env||!u.env&&e.createXhr()?e.get=function(t,i,n,s){var a,o=e.createXhr();if(o.open("GET",t,!0),s)for(a in s)s.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),s[a]);u.onXhr&&u.onXhr(o,t),o.onreadystatechange=function(e){var s,a;4===o.readyState&&((s=o.status||0)>399&&s<600?((a=new Error(t+" HTTP status: "+s)).xhr=o,n&&n(a)):i(o.responseText),u.onXhrComplete&&u.onXhrComplete(o,t))},o.send(null)}:"rhino"===u.env||!u.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,s=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),"utf-8")),l="";try{for(i=new java.lang.StringBuffer,(n=o.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(a),i.append(n);l=String(i.toString())}finally{o.close()}e(l)}:("xpconnect"===u.env||!u.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,o,l,r={};a&&(t=t.replace(/\//g,"\\")),l=new FileUtils.File(t);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(l,1,0,!1),(o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),r),o.close(),i.close(),e(r.value)}catch(t){throw new Error((l&&l.path||"")+": "+t)}}),e})),define("text!common/main/lib/template/AutoCorrectDialog.template",[],(function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-very-small">\n                <div id="auto-correct-replace" class="margin-right-2" style="width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-chk-sentence" class="padding-small"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),void 0===Common)Common={};if(define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";var e=new Common.UI.DataViewStore,i=new Common.UI.DataViewStore,n=new Common.UI.DataViewStore,s=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,contentHeight:355,buttons:["close"],toggleGroup:"autocorrect-dialog-group"},initialize:function(e){var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"";var n=[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}];"de-"==this.appPrefix||"pe-"==this.appPrefix?(n.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),n.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&n.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:n,contentTemplate:_.template(t)({scope:this})},e||{}),this.api=this.options.api;var s=this.appPrefix+"settings-math-correct",a=Common.Utils.InternalSettings.get(s+"-add");this.arrAdd=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRem=a?JSON.parse(a):[],s=this.appPrefix+"settings-rec-functions",a=Common.Utils.InternalSettings.get(s+"-add"),this.arrAddRec=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(s+"-rem"),this.arrRemRec=a?JSON.parse(a):[],this.arrAddExceptions={},this.arrRemExceptions={},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),a=this,o=t.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");if(this.chReplaceType=new Common.UI.CheckBox({el:t.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-math-correct-replace-type",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-math-correct-replace-type",s),a.api.asc_updateFlagAutoCorrectMathSymbols(s)})),this.onInitList(),this.mathList=new Common.UI.ListView({el:t.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(e.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(replaced) %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(by) %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:t.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathList.store.find((function(t){if(0==t.get("replaced").indexOf(e))return!0})))&&(a.mathList.scrollToRecord(i,!0),i.get("replaced")==e?a.mathList.selectRecord(i,!0):i=null));!i&&a.mathList.deselectAll(),a.updateControls(i)})),this.inputReplace.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathList.getSelectedRec()||a.mathList.store.at(0);e&&(a.mathList.selectRecord(e),a.mathList.scrollToRecord(e)),_.delay((function(){a.mathList.focus()}),10)}})),this.inputBy=new Common.UI.InputField({el:t.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){a.updateControls()})),this.btnReset=new Common.UI.Button({el:t.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:t.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:t.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:t.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(i.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:t.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathRecList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(a.mathRecList.scrollToRecord(i,!0),i.get("value")==e?a.mathRecList.selectRecord(i,!0):i=null));!i&&a.mathRecList.deselectAll(),a.updateRecControls(i)})),this.inputRecFind.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathRecList.getSelectedRec()||a.mathRecList.store.at(0);e&&(a.mathRecList.selectRecord(e),a.mathRecList.scrollToRecord(e)),_.delay((function(){a.mathRecList.focus()}),10)}})),this.btnResetRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix){this.chQuotes=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-smart-quotes",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-smart-quotes",s),a.api.asc_SetAutoCorrectSmartQuotes(s)})),this.chHyphens=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyphens",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyphens",s),a.api.asc_SetAutoCorrectHyphensWithDash(s)})),this.chBulleted=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-bulleted",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-bulleted",s),a.api.asc_SetAutomaticBulletedLists(s)})),this.chNumbered=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-numbered",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-numbered",s),a.api.asc_SetAutomaticNumberedLists(s)})),this.chDoubleSpaces=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-double-space",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-double-space",s),a.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(s)})),this.api&&(s=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultLangs()||[]),s.forEach((function(t){var e=a.appPrefix+"settings-letter-exception",i=Common.Utils.InternalSettings.get(e+"-add-"+t);a.arrAddExceptions[t]=i?JSON.parse(i):[],i=Common.Utils.InternalSettings.get(e+"-rem-"+t),a.arrRemExceptions[t]=i?JSON.parse(i):[]}));var l=Common.Utils.InternalSettings.get("settings-letter-exception-lang");if(this.exceptionsLangCmb=new Common.UI.ComboBox({el:t.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHintDirection:"bottom",data:s.map((function(t){t=parseInt(t);var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}}))}).on("selected",(function(t,e){l!=e.value&&(l=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",l),a.onInitExceptionsList(!0),a.onChangeInputException(a.exceptionsFindInput,a.exceptionsFindInput.getValue()))})),!l){var r=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()});if(!r){var c=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0];r=this.exceptionsLangCmb.store.find((function(t){return 0==t.get("shortName").indexOf(c)}))}r&&(l=r.get("value"))}this.exceptionsLangCmb.setValue(l||s[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:t.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(n.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:t.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.exceptionsList.getSelectedRec()||a.exceptionsList.store.at(0);e&&(a.exceptionsList.selectRecord(e),a.exceptionsList.scrollToRecord(e)),_.delay((function(){a.exceptionsList.focus()}),10)}})),this.btnResetExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-sentence",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-sentence",s),a.api.asc_SetAutoCorrectFirstLetterOfSentences&&a.api.asc_SetAutoCorrectFirstLetterOfSentences(s)})),this.chkSentenceCells=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-cells",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-cells",s),a.api.asc_SetAutoCorrectFirstLetterOfCells&&a.api.asc_SetAutoCorrectFirstLetterOfCells(s)})),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))}else"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-new-rows",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-new-rows",s),a.api.asc_setIncludeNewRowColTable(s)})));this.chHyperlink=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",(function(t,e,i,n){var s="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyperlink",s),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyperlink",s),a.api.asc_SetAutoCorrectHyperlinks(s)})),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){if(this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){var t=this.btnsCategory.concat([this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec]);return t=(t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])).concat(this.getFooterButtons())},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){if(this.mathList){t=t||this.mathList.getSelectedRec();var e=this.inputBy.getValue(),i=this.inputReplace.getValue();if(t){var n=t.get("defaultDisabled"),s=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by");this.btnDelete.setCaption(n?this.textRestore:this.textDelete),this.btnEdit.setDisabled(n||e===t.get("by")&&!s||!e||!i),this.btnEdit.setCaption(s&&e===t.get("by")?this.textReset:this.textReplace)}else this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd);this.btnDelete.setDisabled(!t)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var i=this;_.delay((function(){$("input",i.inputReplace.cmpEl).select().focus()}),t?50:0),i.mathList.store.length<e.length&&_.delay((function(){i.mathList.setStore(e),i.mathList.onResetItems()}),t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay((function(){"sse-"==e.appPrefix?e.chHyperlink.focus():e.chQuotes.focus()}),t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()}),t?50:0),e.exceptionsList.store.length<n.length&&_.delay((function(){e.exceptionsList.setStore(n),e.exceptionsList.onResetItems()}),t?100:10)},onDelete:function(){var t,i=this.mathList.getSelectedRec(),n="";if(i){if(i.get("defaultValue")){n=this.appPrefix+"settings-math-correct-rem";var s=!i.get("defaultDisabled");i.set("defaultDisabled",s),s?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.btnDelete.setCaption(s?this.textRestore:this.textDelete),s?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))}else e.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),n=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(n,t),Common.localStorage.setItem(n,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"));this.updateControls()}},onEdit:function(){var t=this.mathList.getSelectedRec(),i="",n=this,s=function(t,e){var i=n.appPrefix+"settings-math-correct-add",s=JSON.stringify(n.arrAdd);Common.Utils.InternalSettings.set(i,s),Common.localStorage.setItem(i,s),n.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),n.mathList.selectRecord(t),n.mathList.scrollToRecord(t)};if(t||(t=e.findWhere({replaced:this.inputReplace.getValue()})),t){var a=_.findIndex(this.arrAdd,(function(e){return e[0]==t.get("replaced")})),o=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by")&&this.inputBy.getValue()===t.get("by");Common.UI.warning({maxwidth:500,msg:o?this.warnRestore.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))):this.warnReplace.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))),buttons:["yes","no"],primary:"yes",callback:_.bind((function(e,n){"yes"==e&&(o?(i=t.get("defaultValue"),t.set("by",t.get("defaultValueStr")),a>=0&&this.arrAdd.splice(a,1)):(i=this.inputBy.getValue(),t.set("by",i),a<0?this.arrAdd.push([t.get("replaced"),i]):this.arrAdd[a][1]=i),s(t,i))}),this)})}else t=e.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),i=t.get("by"),this.arrAdd.push([t.get("replaced"),i]),s(t,i)},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())}),this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",i),Common.localStorage.setItem(t+"-add",i),Common.Utils.InternalSettings.set(t+"-rem",i),Common.localStorage.setItem(t+"-rem",i),this.arrAdd=[],this.arrRem=[],e.remove(e.where({defaultValue:void 0})),e.each((function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)})),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){if(!(e.length>0)){e.comparator=function(t,e){var i=t.get("replaced").toLowerCase(),n=e.get("replaced").toLowerCase();return i==n?0:i<n?-1:1};var t=this.arrAdd,i=this.arrRem,n=this.api?this.api.asc_getAutoCorrectMathSymbols():[],s=[];_.each(n,(function(t,e){var n={replaced:t[0],defaultValue:t[1],defaultDisabled:i.indexOf(t[0])>-1};"object"==typeof t[1]?(n.defaultValueStr="",_.each(t[1],(function(t){n.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)})),n.by=n.defaultValueStr):n.by=n.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),s.push(n)}));var a=[];_.each(t,(function(t,e){var i=_.findIndex(s,{replaced:t[0]});i<0?a.push({replaced:t[0],by:t[1],defaultDisabled:!1}):s[i].by=t[1]})),e.reset(s.concat(a)),this.updateControls()}},onInitRecList:function(){if(!(i.length>0)){i.comparator=function(t,e){var i=t.get("value").toLowerCase(),n=e.get("value").toLowerCase();return i==n?0:i<n?-1:1};var t=this.arrAddRec,e=this.arrRemRec,n=this.api?this.api.asc_getAutoCorrectMathFunctions():[],s=[];_.each(n,(function(t,i){s.push({value:t,defaultValue:!0,defaultDisabled:e.indexOf(t)>-1})}));var a=[];_.each(t,(function(t,e){_.findIndex(s,{value:t})<0&&a.push({value:t,defaultValue:!1,defaultDisabled:!1})})),i.reset(s.concat(a)),this.updateRecControls()}},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())}),this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],i.remove(i.where({defaultValue:!1})),i.each((function(t,e){t.set("defaultDisabled",!1)})),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.inputRecFind.cmpEl).select().focus()}),t?50:0),e.mathRecList.store.length<i.length&&_.delay((function(){e.mathRecList.setStore(i),e.mathRecList.onResetItems()}),t?100:10)},onDeleteRec:function(){var t,e,n=this.mathRecList.getSelectedRec();if(n){if(n.get("defaultValue")){t=this.appPrefix+"settings-rec-functions-rem";var s=!n.get("defaultDisabled");n.set("defaultDisabled",s),s?this.arrRemRec.push(n.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(n.get("value")),1),e=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.btnDeleteRec.setCaption(s?this.textRestore:this.textDelete),s?this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(n.get("value"))}else i.remove(n),this.arrAddRec.splice(this.arrAddRec.indexOf(n.get("value")),1),t=this.appPrefix+"settings-rec-functions-add",e=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(n.get("value"));this.updateRecControls()}},onAddRec:function(){var t,e,n,s=this.mathRecList.getSelectedRec(),a=this;s||(s=i.findWhere({value:this.inputRecFind.getValue()})),s?(a.mathRecList.selectRecord(s),a.mathRecList.scrollToRecord(s)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(s=i.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(s.get("value")),t=s,e=a.appPrefix+"settings-rec-functions-add",n=JSON.stringify(a.arrAddRec),Common.Utils.InternalSettings.set(e,n),Common.localStorage.setItem(e,n),a.api.asc_AddFromAutoCorrectMathFunctions(t.get("value")),a.mathRecList.selectRecord(t),a.mathRecList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){if(this.mathRecList){t=t||this.mathRecList.getSelectedRec();var e=this.inputRecFind.getValue();this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e)}},onInitExceptionsList:function(t){if(!(n.length>0)||t){n.comparator=function(t,e){var i=t.get("value").toLowerCase(),n=e.get("value").toLowerCase();return i==n?0:i<n?-1:1};var e=this.exceptionsLangCmb.getValue(),i=this.arrAddExceptions[e]?this.arrAddExceptions[e]:[],s=this.arrRemExceptions[e]?this.arrRemExceptions[e]:[],a=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(e):[],o=[];_.each(a,(function(t,e){o.push({value:t,defaultValue:!0,defaultDisabled:s.indexOf(t)>-1})}));var l=[];_.each(i,(function(t,e){_.findIndex(o,{value:t})<0&&l.push({value:t,defaultValue:!1,defaultDisabled:!1})})),n.reset(o.concat(l)),this.updateExceptionsControls()}},onResetExceptionsToDefault:function(){var t=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),e=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind((function(i,n){"yes"==i&&(t.put_Exceptions(t.get_DefaultExceptions(e),e),this.onResetExceptionsList())}),this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],n.remove(n.where({defaultValue:!1})),n.each((function(t,e){t.set("defaultDisabled",!1)})),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t=this.exceptionsList.getSelectedRec(),e=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),i=this.exceptionsLangCmb.getValue();if(t){var s,a="";if(t.get("defaultValue")){var o=!t.get("defaultDisabled");a=this.appPrefix+"settings-letter-exception-rem-"+i,t.set("defaultDisabled",o),o?this.arrRemExceptions[i].push(t.get("value")):this.arrRemExceptions[i].splice(this.arrRemExceptions[i].indexOf(t.get("value")),1),s=JSON.stringify(this.arrRemExceptions[i]),Common.Utils.InternalSettings.set(a,s),Common.localStorage.setItem(a,s),this.btnDeleteExceptions.setCaption(o?this.textRestore:this.textDelete),o?e.remove_Exception(t.get("value"),i):e.add_Exception(t.get("value"),i)}else n.remove(t),this.arrAddExceptions[i].splice(this.arrAddExceptions[i].indexOf(t.get("value")),1),a=this.appPrefix+"settings-letter-exception-add-"+i,s=JSON.stringify(this.arrAddExceptions[i]),Common.Utils.InternalSettings.set(a,s),Common.localStorage.setItem(a,s),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),e.remove_Exception(t.get("value"),i);this.updateExceptionsControls()}},onAddException:function(){var t,e,i,s=this.exceptionsList.getSelectedRec(),a=this.exceptionsLangCmb.getValue(),o=this,l=this.exceptionsFindInput.getValue().trim();s||(s=n.findWhere({value:l})),s?(o.exceptionsList.selectRecord(s),o.exceptionsList.scrollToRecord(s)):("."===l[l.length-1]&&(l=l.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(l)?(s=n.add({value:l,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[a].push(s.get("value")),t=s,e=o.appPrefix+"settings-letter-exception-add-"+a,i=JSON.stringify(o.arrAddExceptions[a]),Common.Utils.InternalSettings.set(e,i),Common.localStorage.setItem(e,i),o.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(t.get("value"),a),o.exceptionsList.selectRecord(t),o.exceptionsList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null));!i&&this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){if(this.exceptionsList){t=t||this.exceptionsList.getSelectedRec();var e=this.exceptionsFindInput.getValue();this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e)}},textTitle:"AutoCorrect",textMathCorrect:"Math AutoCorrect",textReplace:"Replace",textBy:"By",textResetAll:"Reset to default",textAdd:"Add",textDelete:"Delete",textRestore:"Restore",textReset:"Reset",textReplaceType:"Replace text as you type",warnReset:"Any autocorrect you added will be removed and the changed ones will be restored to their original values. Do you want to continue?",warnReplace:"The autocorrect entry for %1 already exists. Do you want to replace it?",warnRestore:"The autocorrect entry for %1 will be reset to its original value. Do you want to continue?",textRecognized:"Recognized Functions",textRecognizedDesc:"The following expressions are recognized math expressions. They will not be automatically italicized.",textWarnAddRec:"Recognized functions must contain only the letters A through Z, uppercase or lowercase.",textWarnResetRec:"Any expression you added will be removed and the removed ones will be restored. Do you want to continue?",textAutoFormat:"AutoFormat As You Type",textReplaceText:"Replace As You Type",textApplyText:"Apply As You Type",textQuotes:'"Straight quotes" with "smart quotes"',textHyphens:"Hyphens (--) with dash ()",textBulleted:"Automatic bulleted lists",textNumbered:"Automatic numbered lists",textApplyAsWork:"Apply as you work",textNewRowCol:"Include new rows and columns in table",textAutoCorrect:"AutoCorrect",textFLSentence:"Capitalize first letter of sentences",textWarnResetFL:"Any exceptions you added will be removed and the removed ones will be restored. Do you want to continue?",textWarnAddFL:"Exceptions must contain only the letters, uppercase or lowercase.",textForLangFL:"Exceptions for the language:",textHyperlink:"Internet and network paths with hyperlinks",textFLCells:"Capitalize first letter of table cells",textFLDont:"Don`t capitalize after",textDoubleSpaces:"Add period with double-space"},Common.Views.AutoCorrectDialog||{}))})),define("common/main/lib/view/DocumentAccessDialog",[],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var e={},i=this;_.extend(e,{header:!1,label:t.label||i.textUrl,inputConfig:{allowBlank:!1,blankError:i.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||i.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,e)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout((function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),function(t,e){var i=1057,n=1124,s=1,a=2,o=3,l=4,r=5,c=6,d=7,p=8,h=9,m=10,u=11,g=12,b=13,f=14,v=15,C=16,_=17,y=18,x=19,w=20,S=21,A=22,I=23,T=24,P=25,k=26,M=27,V=28,U=29,L=30,D=31,E=32,B=33,F=34,R=35,H=36,O=37,N=38,z=39,$=40,W=41,j=42,q=43,G=44,K=45,Y=46,X=47,J=48,Q=49,Z=50,tt=51,et=52,it=53,nt=54,st=55,at=56,ot=57,lt=58,rt=59,ct=60,dt=61,pt=62,ht=63,mt=64,ut=65,gt=66,bt=67,ft=68,vt=69,Ct=70,_t=71,yt=72,xt=73,wt=74,St=75,At=76,It=77,Tt=78,Pt=79,kt=80,Mt=81,Vt=82,Ut=83,Lt=84,Dt=85,Et=86,Bt=87,Ft=88,Rt=89,Ht=90,Ot=91,Nt=92,zt=93,$t=94,Wt=95,jt=96,qt=97,Gt=98,Kt=99,Yt=100,Xt=101,Jt=102,Qt=103,Zt=104,te=105,ee=106,ie=107,ne=108,se=109,ae=110,oe=111,le=112,re=113,ce=114,de=115,pe=116,he=117,me=118,ue=119,ge=120,be=121,fe=122,ve=123,Ce=124,_e=125,ye=126,xe=127,we=128,Se=129,Ae=130,Ie=131,Te=132,Pe=133,ke=134,Me=135,Ve=136,Ue=137,Le=138,De=139,Ee=140,Be=141,Fe=142,Re=143,He=144,Oe=145,Ne=146,ze=147,$e=148,We=149,je=150,qe=151,Ge=152,Ke=153,Ye=154,Xe=155,Je=156,Qe=157,Ze=158,ti=159,ei=160,ii=161,ni=162,si=163,ai=164,oi=165,li=166,ri=167,ci=168,di=169,pi=170,hi=171,mi=172,ui=173,gi=174,bi=175,fi=176,vi=177,Ci=178,_i=179,yi=180,xi=181,wi=182,Si=183,Ai=184,Ii=185,Ti=186,Pi=187,ki=188,Mi=189,Vi=190,Ui=191,Li=192,Di=193,Ei=194,Bi=195,Fi=196,Ri=197,Hi=198,Oi=199,Ni=200,zi=201,$i=202,Wi=203,ji=204,qi=205,Gi=206,Ki=207,Yi=208,Xi=209,Ji=210,Qi=211,Zi=212,tn=213,en=214,nn=215,sn=216,an=217,on=218,ln=219,rn=220,cn=221,dn=222,pn=223,hn=224,mn=225,un=226,gn=227,bn=228,fn=229,vn=230,Cn=231,_n=232,yn=233,xn=234,wn=235,Sn=236,An=237,In=238,Tn=239,Pn=240,kn=241,Mn=242,Vn=243,Un=244,Ln=245,Dn=246,En=247,Bn=248,Fn=249,Rn=250,Hn=251,On=252,Nn=253,zn=254,$n=255,Wn=256,jn=257,qn=258,Gn=259,Kn=260,Yn=261,Xn=262,Jn=263,Qn=264,Zn=265,ts=266,es=267,is=268,ns=269,ss=270,as=271,os=272,ls=273,rs=0,cs=1,ds=2,ps=3,hs=4,ms=5,us=6,gs=7,bs=8,fs=16,vs=17,Cs=18,_s=19,ys=20,xs=30,ws=19,Ss=21,As=29,Is={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},Ts={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},Ps={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},ks=1,Ms=2,Vs=3,Us=4,Ls=5,Ds=6,Es=7,Bs=8,Fs=9,Rs=10,Hs=11,Os=12,Ns=14,zs=16,$s=17,Ws=18,js=19,qs=20,Gs=21,Ks=22,Ys=23,Xs=24,Js=25,Qs=26;function Zs(t,e,i,n,s){this.Start=t,this.End=e,this.Name=i,this.Lid=n,this.Param=s}var ta=[new Zs(32,126,s,1033,[1<<Is.Basic_Latin,0,0,0,1<<rs,0]),new Zs(160,255,a,0,[1<<Is.Basic_Latin|1<<Is.Latin_1_Supplement,0,0,0,1<<rs,0]),new Zs(256,383,o,0,[1<<Is.Basic_Latin|1<<Is.Latin_Extended_A,0,0,0,1<<rs|1<<cs|1<<hs|1<<gs,0]),new Zs(384,591,l,0,[1<<Is.Basic_Latin|1<<Is.Latin_Extended_B,0,0,0,1<<rs|1<<cs|1<<hs|1<<gs,0]),new Zs(592,687,r,0,[1<<Is.IPA_Extensions,0,0,0,0,0]),new Zs(688,767,c,0,[1<<Is.Spacing_Modifier_Letters,0,0,0,0,0]),new Zs(768,879,d,0,[1<<Is.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(880,1023,p,1032,[1<<Is.Greek_and_Coptic,0,0,0,1<<ps,0]),new Zs(1024,1279,h,1049,[1<<Is.Cyrillic,0,0,0,1<<ds,0]),new Zs(1280,1327,m,0,[1<<Is.Cyrillic,0,0,0,1<<ds,0]),new Zs(1328,1423,u,1067,[1<<Is.Armenian,0,0,0,0,0]),new Zs(1424,1535,g,1037,[1<<Is.Hebrew,0,0,0,1<<ms,1<<Ss]),new Zs(1536,1791,b,1,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1792,1871,f,1114,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1872,1919,v,1,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1920,1983,C,1125,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(1984,2047,_,0,[1<<Is.NKo,0,0,0,0,0]),new Zs(2048,2111,y,0,[1<<Is.Hebrew,0,0,0,1<<ms,0]),new Zs(2112,2143,x,0,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(2208,2303,w,1,[1<<Is.Arabic,0,0,0,1<<us,1<<ws|1<<As]),new Zs(2304,2431,S,1081,[1<<Is.Devanagari,0,0,0,0,0]),new Zs(2432,2559,A,1093,[1<<Is.Bengali,0,0,0,0,0]),new Zs(2560,2687,I,1094,[1<<Is.Gurmukhi,0,0,0,0,0]),new Zs(2688,2815,T,1095,[1<<Is.Gujarati,0,0,0,0,0]),new Zs(2816,2943,P,1096,[1<<Is.Oriya,0,0,0,0,0]),new Zs(2944,3071,k,1097,[1<<Is.Tamil,0,0,0,0,0]),new Zs(3072,3199,M,1098,[1<<Is.Telugu,0,0,0,0,0]),new Zs(3200,3327,V,1099,[1<<Is.Kannada,0,0,0,0,0]),new Zs(3328,3455,U,1100,[1<<Is.Malayalam,0,0,0,0,0]),new Zs(3456,3583,L,1115,[0,0,1<<Ps.Sinhala,0,0,0]),new Zs(3584,3711,D,1054,[1<<Is.Thai,0,0,0,1<<fs,0]),new Zs(3712,3839,E,1108,[1<<Is.Lao,0,0,0,0,0]),new Zs(3840,4095,B,2129,[0,0,1<<Ps.Tibetan,0,0,0]),new Zs(4096,4255,F,1109,[0,0,1<<Ps.Myanmar,0,0,0]),new Zs(4256,4351,R,1079,[1<<Is.Georgian,0,0,0,0,0]),new Zs(4352,4607,H,1042,[1<<Is.Hangul_Jamo,0,0,0,1<<_s,0]),new Zs(4608,4991,O,1138,[0,0,1<<Ps.Ethiopic,0,0,0]),new Zs(4992,5023,N,0,[0,0,1<<Ps.Ethiopic,0,0,0]),new Zs(5024,5119,z,1116,[0,0,1<<Ps.Cherokee,0,0,0]),new Zs(5120,5759,$,1117,[0,0,1<<Ps.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zs(5760,5791,W,0,[0,0,1<<Ps.Ogham,0,0,0]),new Zs(5792,5887,j,0,[0,0,1<<Ps.Runic,0,0,0]),new Zs(5888,5919,q,n,[0,0,1<<Ps.Tagalog,0,0,0]),new Zs(5920,5951,G,n,[0,0,1<<Ps.Tagalog,0,0,0]),new Zs(5952,5983,K,n,[0,0,1<<Ps.Tagalog,0,0,0]),new Zs(5984,6015,Y,n,[0,0,1<<Ps.Tagalog,0,0,0]),new Zs(6016,6143,X,1107,[0,0,1<<Ps.Khmer,0,0,0]),new Zs(6144,6319,J,1104,[0,0,1<<Ps.Mongolian,0,0,0]),new Zs(6320,6399,Q,1117,[0,0,1<<Ps.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zs(6400,6479,Z,0,[0,0,1<<Ps.Limbu,0,0,0]),new Zs(6480,6527,tt,0,[0,0,1<<Ps.Tai_Le,0,0,0]),new Zs(6528,6623,et,0,[0,0,1<<Ps.New_Tai_Lue,0,0,0]),new Zs(6624,6655,it,1107,[0,0,1<<Ps.Khmer,0,0,0]),new Zs(6656,6687,nt,0,[0,0,1<<Ps.Buginese,0,0,0]),new Zs(6688,6831,st,1054,[0,0,1<<Ps.Tai_Le,0,0,0]),new Zs(6832,6911,at,0,[1<<Is.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(6912,7039,ot,i,[1<<Is.Balinese,0,0,0,0,0]),new Zs(7040,7103,lt,i,[0,0,0,1<<zs,0,0]),new Zs(7104,7167,rt,i,[]),new Zs(7168,7247,ct,0,[0,0,0,1<<$s,0,0]),new Zs(7248,7295,dt,0,[0,0,0,1<<Ws,0,0]),new Zs(7296,7311,pt,0,[1<<Is.Cyrillic,0,0,0,0,0]),new Zs(7360,7375,ht,0,[0,0,0,1<<zs,0,0]),new Zs(7376,7423,mt,0,[]),new Zs(7424,7551,ut,0,[1<<Is.IPA_Extensions,0,0,0,0,0]),new Zs(7552,7615,gt,0,[1<<Is.IPA_Extensions,0,0,0,0,0]),new Zs(7616,7679,bt,0,[1<<Is.Combining_Diacritical_Marks,0,0,0,0,0]),new Zs(7680,7935,ft,0,[1<<Is.Latin_Extended_Additional,0,0,0,1<<bs,0]),new Zs(7936,8191,vt,0,[1<<Is.Greek_Extended,0,0,0,0,0]),new Zs(8192,8303,Ct,0,[1<<Is.Punctuation,0,0,0,0,0]),new Zs(8304,8351,_t,0,[0,1<<Ts.Superscripts_And_Subscripts,0,0,0,0]),new Zs(8352,8399,yt,0,[0,1<<Ts.Currency_Symbols,0,0,0,0]),new Zs(8400,8447,xt,0,[0,1<<Ts.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new Zs(8448,8527,wt,0,[0,1<<Ts.Letterlike_Symbols,0,0,0,0]),new Zs(8528,8591,St,0,[0,1<<Ts.Number_Forms,0,0,0,0]),new Zs(8592,8703,At,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(8704,8959,It,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(8960,9215,Tt,0,[0,1<<Ts.Miscellaneous_Technical,0,0,0,0]),new Zs(9216,9279,Pt,0,[0,1<<Ts.Control_Pictures,0,0,0,0]),new Zs(9280,9311,kt,0,[0,1<<Ts.Optical_Character_Recognition,0,0,0,0]),new Zs(9312,9471,Mt,0,[0,1<<Ts.Enclosed_Alphanumerics,0,0,0,0]),new Zs(9472,9599,Vt,0,[0,1<<Ts.Box_Drawing,0,0,0,0]),new Zs(9600,9631,Ut,0,[0,1<<Ts.Block_Elements,0,0,0,0]),new Zs(9632,9727,Lt,0,[0,1<<Ts.Geometric_Shapes,0,0,0,0]),new Zs(9728,9983,Dt,0,[0,1<<Ts.Miscellaneous_Symbols,0,0,0,0]),new Zs(9984,10175,Et,0,[0,1<<Ts.Dingbats,0,0,0,0]),new Zs(10176,10223,Bt,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(10224,10239,Ft,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(10240,10495,Rt,0,[0,0,1<<Ps.Braille_Patterns,0,0,0]),new Zs(10496,10623,Ht,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(10624,10751,Ot,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(10752,11007,Nt,0,[0,1<<Ts.Mathematical_Operators,0,0,0,0]),new Zs(11008,11263,zt,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(11264,11359,$t,0,[0,0,0,1<<Ts.Glagolitic,0,0]),new Zs(11360,11391,Wt,0,[1<<Is.Latin_Extended_Additional,0,0,0,0,0]),new Zs(11392,11519,jt,0,[1<<Is.Coptic,0,0,0,0,0]),new Zs(11520,11567,qt,0,[1<<Is.Georgian,0,0,0,0,0]),new Zs(11568,11647,Gt,0,[0,0,0,1<<Ms,0,0]),new Zs(11648,11743,Kt,0,[0,0,1<<Ps.Ethiopic,0,0,0]),new Zs(11744,11775,Yt,0,[1<<Is.Cyrillic,0,0,0,1<<ds,0]),new Zs(11776,11903,Xt,0,[1<<Is.General_Punctuation,0,0,0,0,0]),new Zs(11904,12031,Jt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12032,12255,Qt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12272,12287,Zt,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12288,12351,te,0,[0,1<<Ts.CJK_Symbols_And_Punctuation,0,0,1<<vs|1<<xs,0]),new Zs(12352,12447,ee,1041,[0,1<<Ts.Hiragana,0,0,0,0]),new Zs(12448,12543,ie,1041,[0,1<<Ts.Katakana,0,0,0,0]),new Zs(12544,12591,ne,0,[0,1<<Ts.Bopomofo,0,0,0,0]),new Zs(12592,12687,se,0,[0,1<<Ts.Hangul_Compatibility_Jamo,0,0,1<<_s,0]),new Zs(12688,12703,ae,2052,[0,1<<Ts.CJK_Unified_Ideographs,0,0,0,0]),new Zs(12704,12735,oe,0,[0,1<<Ts.Bopomofo,0,0,0,0]),new Zs(12736,12783,le,0,[0,1<<Ts.CJK_Strokes,0,0,0,0]),new Zs(12784,12799,re,0,[0,1<<Ts.Katakana,0,0,0,0]),new Zs(12800,13055,ce,0,[0,1<<Ts.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new Zs(13056,13311,de,0,[0,1<<Ts.CJK_Compatibility,0,0,0,0]),new Zs(13312,19903,pe,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,1<<Cs|1<<ys,0]),new Zs(19904,19967,he,0,[0,0,0,1<<Vs,1<<Cs|1<<ys,0]),new Zs(19968,40959,me,0,[0,1<<Ts.CJK_Unified_Ideographs,0,0,1<<Cs|1<<ys|1<<vs|1<<xs,0]),new Zs(40960,42127,ue,0,[0,0,1<<Ps.Yi_Syllables,0,0,0]),new Zs(42128,42191,ge,0,[0,0,1<<Ps.Yi_Radicals,0,0,0]),new Zs(42192,42239,be,0,[]),new Zs(42240,42559,fe,0,[1<<Is.Vai,0,0,0,0,0]),new Zs(42560,42655,ve,0,[1<<Is.Cyrillic,0,0,0,1<<ds,0]),new Zs(42656,42751,Ce,0,[]),new Zs(42752,42783,_e,0,[1<<Is.Spacing_Modifier_Letters,0,0,0,0,0]),new Zs(42784,43007,ye,0,[1<<Is.Latin_Extended_Additional,0,0,0,0,0]),new Zs(43008,43055,xe,0,[0,0,0,1<<Us,0,0]),new Zs(43056,43071,we,0,[]),new Zs(43072,43135,Se,0,[0,1<<Ts.Phags_pa,0,0,0,0]),new Zs(43136,43231,Ae,0,[0,0,0,1<<js,0,0]),new Zs(43232,43263,Ie,0,[1<<Is.Devanagari,0,0,0,0,0]),new Zs(43264,43311,Te,0,[0,0,0,1<<qs,0,0]),new Zs(43312,43359,Pe,0,[0,0,0,1<<Gs,0,0]),new Zs(43360,43391,ke,0,[1<<Is.Hangul_Jamo,0,0,0,0,0]),new Zs(43392,43487,Me,i,[]),new Zs(43488,43519,Ve,0,[0,0,1<<Ps.Myanmar,0,0,0]),new Zs(43520,43615,Ue,0,[0,0,0,1<<Ks,0,0]),new Zs(43616,43647,Le,0,[0,0,1<<Ps.Myanmar,0,0,0]),new Zs(43648,43743,De,0,[]),new Zs(43744,43775,Ee,0,[]),new Zs(43776,43823,Be,0,[]),new Zs(43824,43887,Fe,0,[1<<Is.Latin_Extended_Additional,0,0,0,0,0]),new Zs(43888,43967,Re,0,[]),new Zs(43968,44031,He,0,[]),new Zs(44032,55215,Oe,0,[0,1<<Ts.Hangul_Syllables,0,0,1<<_s,0]),new Zs(55216,55295,Ne,0,[1<<Is.Hangul_Jamo,0,0,0,0,0]),new Zs(55296,56191,ze,0,[]),new Zs(56192,56319,$e,0,[]),new Zs(56320,57343,We,0,[]),new Zs(57344,63743,je,0,[0,1<<Ts.Private_Use_Area_plane_0,0,0,0,0]),new Zs(63744,64255,qe,0,[0,1<<Ts.CJK_Compatibility_Ideographs,0,0,1<<Cs|1<<ys,0]),new Zs(64256,64335,Ge,0,[0,1<<Ts.Alphabetic_Presentation_Forms,0,0,0,0]),new Zs(64336,65023,Ke,0,[0,1<<Ts.Arabic_Presentation_Forms_A,0,0,1<<us,1<<ws|1<<As]),new Zs(65024,65039,Ye,0,[0,0,1<<Ps.Variation_Selectors,0,0,0]),new Zs(65040,65055,Xe,0,[0,0,1<<Ps.Vertical_Forms,0,0,0]),new Zs(65056,65071,Je,0,[0,0,1<<Ps.Combining_Half_Marks,0,0,0]),new Zs(65072,65103,Qe,0,[0,0,1<<Ps.Vertical_Forms,0,0,0]),new Zs(65104,65135,Ze,0,[0,0,1<<Ps.Small_Form_Variants,0,0,0]),new Zs(65136,65279,ti,0,[0,0,1<<Ps.Arabic_Presentation_Forms_B,0,1<<us,1<<ws|1<<As]),new Zs(65280,65519,ei,0,[0,0,1<<Ps.Halfwidth_And_Fullwidth_Forms,0,1<<_s|1<<Cs|1<<ys|1<<vs|1<<xs,0]),new Zs(65520,65535,ii,0,[0,0,1<<Ps.Specials,0,0,0]),new Zs(65536,65663,ni,0,[0,0,0,1<<Ls,0,0]),new Zs(65664,65791,si,0,[0,0,0,1<<Ls,0,0]),new Zs(65792,65855,ai,0,[0,0,0,1<<Ls,0,0]),new Zs(65856,65935,oi,0,[0,0,0,1<<Ds,0,0]),new Zs(65936,65999,li,0,[0,0,0,1<<Ys,0,0]),new Zs(66e3,66047,ri,0,[0,0,0,1<<Xs,0,0]),new Zs(66176,66207,ci,0,[0,0,0,1<<Js,0,0]),new Zs(66208,66271,di,0,[0,0,0,1<<Js,0,0]),new Zs(66272,66303,pi,0,[1<<Is.Coptic,0,0,0,0,0]),new Zs(66304,66351,hi,0,[0,0,1<<Ps.Old_Italic,0,0,0]),new Zs(66352,66383,mi,0,[0,0,1<<Ps.Gothic,0,0,0]),new Zs(66384,66431,ui,0,[]),new Zs(66432,66463,gi,0,[0,0,0,1<<Es,0,0]),new Zs(66464,66527,bi,0,[0,0,0,1<<Bs,0,0]),new Zs(66560,66639,fi,0,[0,0,1<<Ps.Deseret,0,0,0]),new Zs(66640,66687,vi,0,[0,0,0,1<<Fs,0,0]),new Zs(66688,66735,Ci,0,[0,0,0,1<<Rs,0,0]),new Zs(66736,66815,_i,0,[]),new Zs(66816,66863,yi,0,[]),new Zs(66864,66927,xi,0,[]),new Zs(67072,67455,wi,0,[]),new Zs(67584,67647,Si,0,[0,0,0,1<<Hs,0,0]),new Zs(67648,67679,Ai,0,[]),new Zs(67680,67711,Ii,0,[]),new Zs(67712,67759,Ti,0,[]),new Zs(67808,67839,Pi,0,[]),new Zs(67840,67871,ki,0,[0,1<<Ts.Phoenician,0,0,0,0]),new Zs(67872,67903,Mi,0,[0,0,0,1<<Js,0,0]),new Zs(67968,67999,Vi,0,[]),new Zs(68e3,68095,Ui,0,[]),new Zs(68096,68191,Li,0,[0,0,0,1<<Os,0,0]),new Zs(68192,68223,Di,0,[]),new Zs(68224,68255,Ei,0,[]),new Zs(68288,68351,Bi,0,[]),new Zs(68352,68415,Fi,0,[]),new Zs(68416,68447,Ri,0,[]),new Zs(68448,68479,Hi,0,[]),new Zs(68480,68527,Oi,0,[]),new Zs(68608,68687,Ni,0,[]),new Zs(68736,68863,zi,0,[]),new Zs(69216,69247,$i,0,[]),new Zs(69632,69759,Wi,0,[]),new Zs(69760,69839,ji,0,[]),new Zs(69840,69887,qi,0,[]),new Zs(69888,69967,Gi,0,[]),new Zs(69968,70015,Ki,0,[]),new Zs(70016,70111,Yi,0,[]),new Zs(70112,70143,Xi,0,[0,0,1<<Ps.Sinhala,0,0,0]),new Zs(70144,70223,Ji,0,[]),new Zs(70272,70319,Qi,0,[]),new Zs(70320,70399,Zi,0,[]),new Zs(70400,70527,tn,0,[]),new Zs(70656,70783,en,0,[]),new Zs(70784,70879,nn,0,[]),new Zs(71040,71167,sn,0,[]),new Zs(71168,71263,an,0,[]),new Zs(71264,71295,on,0,[0,0,1<<Ps.Mongolian,0,0,0]),new Zs(71296,71375,ln,0,[]),new Zs(71424,71487,rn,0,[]),new Zs(71840,71935,cn,0,[]),new Zs(72384,72447,dn,0,[]),new Zs(72704,72815,pn,0,[]),new Zs(72816,72895,hn,0,[]),new Zs(73728,74751,mn,0,[0,0,0,1<<Ns,0,0]),new Zs(74752,74879,un,0,[0,0,0,1<<Ns,0,0]),new Zs(74880,75087,gn,0,[]),new Zs(77824,78895,bn,0,[]),new Zs(82944,83583,fn,0,[]),new Zs(92160,92735,vn,0,[]),new Zs(92736,92783,Cn,0,[]),new Zs(92880,92927,_n,0,[]),new Zs(92928,93071,yn,0,[]),new Zs(93952,94111,xn,2052,[]),new Zs(94176,94207,wn,0,[]),new Zs(94208,100351,Sn,0,[]),new Zs(100352,101119,An,0,[]),new Zs(110592,110847,In,0,[]),new Zs(113664,113823,Tn,0,[]),new Zs(113824,113839,Pn,0,[]),new Zs(118784,119039,kn,0,[0,0,1<<Ps.Byzantine_Musical_Symbols,0,0,0]),new Zs(119040,119295,Mn,0,[0,0,1<<Ps.Byzantine_Musical_Symbols,0,0,0]),new Zs(119296,119375,Vn,0,[0,0,1<<Ps.Byzantine_Musical_Symbols,0,0,0]),new Zs(119552,119647,Un,0,[]),new Zs(119648,119679,Ln,0,[]),new Zs(119808,120831,Dn,0,[0,0,1<<Ps.Mathematical_Alphanumeric_Symbols,0,0,0]),new Zs(120832,121519,En,0,[]),new Zs(122880,122927,Bn,0,[0,0,0,1<<ks,0,0]),new Zs(124928,125151,Fn,0,[]),new Zs(125184,125279,Rn,0,[]),new Zs(126464,126719,Hn,0,[]),new Zs(126976,127023,On,0,[0,0,0,1<<Qs,0,0]),new Zs(127024,127135,Nn,0,[0,0,0,1<<Qs,0,0]),new Zs(127136,127231,zn,0,[]),new Zs(127232,127487,$n,0,[]),new Zs(127488,127743,Wn,0,[]),new Zs(127744,128511,jn,0,[]),new Zs(128512,128591,qn,0,[]),new Zs(128592,128639,Gn,0,[]),new Zs(128640,128767,Kn,0,[]),new Zs(128768,128895,Yn,0,[]),new Zs(128896,129023,Xn,0,[0,1<<Ts.Geometric_Shapes,0,0,0,0]),new Zs(129024,129279,Jn,0,[0,1<<Ts.Arrows,0,0,0,0]),new Zs(129280,129535,Qn,0,[]),new Zs(131072,173791,Zn,0,[0,0,1<<Ps.CJK_Unified_Ideographs,0,1<<Cs|1<<ys,0]),new Zs(173824,177983,ts,0,[0,0,1<<Ps.CJK_Unified_Ideographs,0,1<<Cs|1<<ys,0]),new Zs(177984,178207,es,0,[0,0,1<<Ps.CJK_Unified_Ideographs,0,1<<Cs|1<<ys,0]),new Zs(178208,183983,is,0,[0,0,1<<Ps.CJK_Unified_Ideographs,0,1<<Cs|1<<ys,0]),new Zs(194560,195103,ns,0,[0,0,1<<Ps.CJK_Strokes,0,1<<Cs|1<<ys,0]),new Zs(917504,917631,ss,0,[0,0,1<<Ps.Tags,0,0,0]),new Zs(917760,917999,as,0,[0,0,1<<Ps.Variation_Selectors,0,0,0]),new Zs(983040,1048575,os,0,[0,0,1<<Ps.Private_Use_plane_15,0,0,0]),new Zs(1048576,1114111,ls,0,[0,0,1<<Ps.Private_Use_plane_15,0,0,0])];t.getSupportedFonts=function(e){var i=function(t,e){var i=0,n=e.length-1,s=0,a=null;if(i>=n)return null;for(;i<n;)if((a=e[s=i+n>>1]).Start>t)n=s-1;else{if(!(a.End<t))return e[s];i=s+1}return i>n||(a=e[i]).Start>t||a.End<t?null:e[i]}(e,ta);return t.getSupportedFontsByRange(i)},t.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,n=[],s=0;s<i;s++){var a=e[s],o=t.Param;if(o[0]==(a.m_ulUnicodeRange1&o[0])&&(o[1]==(a.m_ulUnicodeRange2&o[1])&&o[2]==(a.m_ulUnicodeRange3&o[2])&&o[3]==(a.m_ulUnicodeRange4&o[3]))){if(t.Name==me){if(0==(a.m_ulCodePageRange1&o[4]))continue}else if(o[4]!=(a.m_ulCodePageRange1&o[4]))continue;o[5]==(a.m_ulCodePageRange2&o[5])&&n.push(a.m_wsFontName)}}return n},t.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<ta.length;++i){var n=ta[i],o=n.Param;o[0]==(t.m_ulUnicodeRange1&o[0])&&(o[1]==(t.m_ulUnicodeRange2&o[1])&&o[2]==(t.m_ulUnicodeRange3&o[2])&&o[3]==(t.m_ulUnicodeRange4&o[3])&&o[4]==(t.m_ulCodePageRange1&o[4])&&o[5]==(t.m_ulCodePageRange2&o[5])&&e.push(n))}return 0===e.length&&(e.push(new Zs(32,126,s,1033,[1<<Is.Basic_Latin,0,0,0,1<<rs,0])),e.push(new Zs(160,255,a,0,[1<<Is.Basic_Latin|1<<Is.Latin_1_Supplement,0,0,0,1<<rs,0]))),e}}(window),define("common/main/lib/util/character",(function(){})),void 0===Common)Common={};if(define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/character"],(function(){"use strict";var t={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},e=33,i=[],n=[],s=[],a=-1,o=-1,l=!0,r=-1,c="",d=-1e3,p="",h=-1e3,m=-1,u=-1,g=20,b=20;Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(e){var r=Common.localStorage.getKeysFilter();this.appPrefix=r&&r.length?r.split(",")[0]:"";var c=this.appPrefix+"settings-size-symbol-table",d=Common.Utils.InternalSettings.get(c);null!=d&&null!=d||(d=Common.localStorage.getItem(c)||"",Common.Utils.InternalSettings.set(c,d)),d=d?JSON.parse(d):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:d[0]||448,height:d[1]||420},e||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special&&(this.options.height+=38),this.special&&(this.options.minheight+=38),this.template=['<div class="box">','<div id="symbol-table-switcher" style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>","<td>",'<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304-38*(this.special?1:0))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;padding-top: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label id="symbol-table-lbl-char">'+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157)+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options);var p,h,m,u=i.length<1;if(u&&this.initFonts(),this.fillRecentSymbols(),e.font?p=e.font:s.length>0&&(p=s[0].font),p)for(var g=0;g<i.length;++g)if(i[g].displayValue===p){a=g;break}if(a<0&&(a=0),n=this.getArrRangesByFont(a),-1===o&&(o=n[0].Start),e.code?o=e.code:e.symbol?o=this.fixedCharCodeAt(e.symbol,0):s.length>0&&(o=s[0].symbol),u&&this.options.lang&&"en"!=this.options.lang){var b=this;h=this.options.lang,m=function(){b.updateRangeSelector()},h=h.split(/[\-_]/)[0].toLocaleLowerCase(),Common.Utils.loadConfig("resources/symboltable/"+h+".json",(function(e){for(var i=1;i<274;i++){var n=t[i];t[i]=e[n]||n}m&&m()}))}Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){var t,e,n=this.api.pluginMethod_GetFontList();n.sort((function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}));for(var s,o=[],l={},r=0;r<n.length;++r)(e=l[s=(t=n[r]).m_wsFontName])?e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold?l[s]=t:!e.m_bItalic||t.m_bBold||t.m_bItalic||(l[s]=t):l[s]=t;delete l.ASCW3;r=0;for(var d in l)l.hasOwnProperty(d)&&(o.push(l[d]),o[o.length-1].displayValue=l[d].m_wsFontName);for((i=o).sort((function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1})),r=0;r<i.length;++r)i[r].value=r;if(l[c]||(l["Cambria Math"]?c="Cambria Math":l["Asana-Math"]&&(c="Asana-Math")),l[c])for(r=0;r<i.length;++r)if(i[r].displayValue===c){a=r;break}},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.btnSymbols=new Common.UI.Button({el:e.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:e.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),Common.UI.GroupedButtons([this.btnSymbols,this.btnSpecial]),this.cmbFonts=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:i,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var s=t.getRangeBySymbol(n,o);if(a=i.value,n=t.getArrRangesByFont(a),s){for(var r=0;r<n.length&&s.Name!==n[r].Name;++r);r===n.length&&(o=n[0].Start)}else o=n[0].Start;l=!0,t.updateView(),setTimeout((function(){t.previewPanel.focus()}),1)})),this.cmbFonts.setValue(a),this.cmbRange=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var s=t.getRangeByName(n,parseInt(i.value));o=s.Start,l=!0,t.updateView(void 0,void 0,void 0,void 0,!1),setTimeout((function(){t.previewPanel.focus()}),1)})),this.updateRangeSelector(),t.inputCode=new Common.UI.InputField({el:e.find("#symbol-table-text-code"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",(function(i,s,a){var r=parseInt(s,16);if(!isNaN(r)&&r>31&&t.getRangeBySymbol(n,r)){var c=0===e.find("#c"+r).length;o=r,l=!0,t.updateView(c,void 0,!1)}})).on("change:after",(function(e,i,n){t.updateInput()})),this.symbolTablePanel=e.find("#symbol-table-scrollable-div"),this.previewPanel=e.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=e.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=e.find("#symbol-table-recent"),this.fontLabel=e.find("#symbol-table-label-font"),this.boxPanel=e.find(".box"),this.updateView(void 0,void 0,void 0,!0);var s=[{symbol:"",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"",description:this.textDCQuote,shortcutKey:"",code:"201D"}];this.specialList=new Common.UI.ListView({el:e.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(s),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=e.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=e.find("#symbol-table-pnl-symbols"),this.specialPanel=e.find("#symbol-table-pnl-special")},calcControlsHeight:function(){var t=this.$window,e=this.symbolsPanel.find("> table"),i=t.find("#symbol-table-switcher"),n=t.find(".body");this.hfHeight=parseInt(t.find(".header").css("height"))+parseInt(t.find(".footer").css("height"))+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(t.css("border-bottom-width"))+parseInt(t.css("border-top-width")),this.switcherHeight=this.special?i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSpecialHeight=this.special&&this.btnSpecial.isActive()?t.find("#symbol-table-lbl-char").height()+i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSymbolsHeight=this.special&&this.btnSpecial.isActive()?0:e.eq(0).height()+e.eq(2).height()+e.eq(3).height()+(this.special?i.height()+parseInt(i.css("margin-bottom")):0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");t?this.btnSpecial.toggle(!0):this.btnSymbols.toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,n=!1;if(t&&t.length>0)if(n="c"===t[0])e=i[a].displayValue;else{var s=parseInt(t.split("_")[2]);e=i[s].displayValue}return{font:e,symbol:this.encodeSurrogateChar(o),code:o,updateRecents:n}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){if(e||!document.activeElement||"textarea"!=document.activeElement.localName||!/area_id/.test(document.activeElement.id)){var i=this.btnSpecial.isActive(),n="ok"==t?i?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{};this.options.handler&&this.options.handler.call(this,this,t,n),"ok"==t&&(!i&&this.checkRecent(o,n.font),!i&&n.updateRecents&&this.updateRecents(),this.type)||this.close()}},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedCharCodeAt:function(t,e){e=e||0;var i,n,s=t.charCodeAt(e);if(55296<=s&&s<=56319){if(i=s,n=t.charCodeAt(e+1),isNaN(n))throw"        fixedCharCodeAt()";return 1024*(i-55296)+(n-56320)+65536}return!(56320<=s&&s<=57343)&&s},getArrRangesByFont:function(t){var e=getSupportedRangesByFont(i[t]);return 0===e.length&&e.push({Start:32,End:255}),e[0].Start<32&&(e[0].Start=32),e},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,n=0,s=0;s<t.length;++s){if((i=t[s]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return n+(e-i.Start);n+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(e<0)return-1;for(var i,n=0,s=t[0],a=0;a<t.length;++a){if(n+(i=(s=t[a]).End-s.Start+1)>e)return s.Start+e-n;n+=i}return-1},createTable:function(t,e,i){for(var n,s=e*i,a=0,o="",l=0;l<s;++l)n=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?o+='<div dir="ltr" class="cell" '+n+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":o+='<div dir="ltr" class="cell"'+n+"></div>",++a>=i&&(o+='<br class="noselect">',a=0);this.previewPanel.html(o)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(s=t)},saveRecent:function(){var t=JSON.stringify(s);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===s.length)return s.push({symbol:t,font:e}),void this.saveRecent();for(var i=0;i<s.length;++i)if(s[i].symbol===t&&s[i].font===e){s.splice(i,1);break}s.splice(0,0,{symbol:t,font:e}),s.length>36&&s.splice(36,s.length-36),this.saveRecent()},createCell:function(t,e){var n="",s="";if(e){for(var a=0,o=0;o<i.length;++o)if(i[o].displayValue===e){a=o;break}n="r_"+t+"_"+a,s="&#"+t.toString()}else void 0!==t&&(n="r"+t,s="&#"+t.toString());var l=$('<div dir="ltr" id="'+n+'">'+s+"</div>");return l.addClass("cell"),l.addClass("noselect"),l.mousedown(_.bind(this.cellClickHandler,this)),e&&l.css("font-family","'"+e+"'"),l},cellClickHandler:function(t){var e=$(t.target).attr("id");if(e){var i=(new Date).getTime();if(e===p&&i-h<300)this.cellDblClickHandler(t);else{if("c"===e[0])o=parseInt(e.slice(1,e.length)),l=!0;else{var n=e.split("_");o=parseInt(n[1]),r=parseInt(n[2]),l=!1}this.updateView(!1)}p=t.target.id,h=i}},cellDblClickHandler:function(t){if(this.type){var e=this.getPasteSymbol($(t.target).attr("id"));this.checkRecent(o,e.font),e.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},onDblClickSpecialItem:function(t){if(this.type){var e=this.getSpecialSymbol();this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel;t.empty();var e=this.getColsCount(),i=s.length;t.width(31*e);for(var n=0;n<e;++n){var a=n<i?this.createCell(s[n].symbol,s[n].font):this.createCell();a.css("border-bottom","none"),t.append(a),n===e-1&&a.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.width()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.height()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/e>>0)},getAllSymbolsCount:function(t){for(var e,i=0,n=0;n<t.length;++n)i+=(e=t[n]).End-e.Start+1;return i},setTable:function(t){for(var e,s=this.getColsCount(),o=this.getRowsCount(),l=this.getLinearIndexByCode(n,t),r=this.getAllSymbolsCount(n),c=Math.ceil(r/s),d=Math.max(0,Math.min(c-o,l/s>>0)),p=d*s,h=o*s,m=[],u=0;u<h&&-1!==(e=this.getCodeByLinearIndex(n,p+u));++u)m.push(e);return this.previewPanel.css("font-family","'"+i[a].displayValue+"'"),this.createTable(m,o,s),d},updateView:function(t,s,c,d,p){l&&!1!==p&&this.updateRangeSelector(),l?this.fontLabel.text(i[a]?i[a].displayValue:""):this.fontLabel.text(i[r]?i[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(a);var h=this.getRowsCount()*e;if(!1,!1!==t){var m=null!=s?s:o,u=this.setTable(m),f=this.getAllSymbolsCount(n),v=Math.ceil(f/this.getColsCount())*e;this.previewInner.height(v),this.previewPanel.height(h),this.previewScrolled.height(h),this.scrollerY||(g=Math.max(22,h/8+.5>>0),b=Math.min(Math.floor(this.previewPanel.height()/e)*e/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:g,alwaysVisibleY:!0,wheelSpeed:b,useKeyboard:!1,onChange:_.bind((function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(h),this.previewParent.css({top:this.scrollerY.getScrollTop()}))}),this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:g,wheelSpeed:b}),this.scrollerY.scrollTop(u*e));var C=this.previewPanel.find(".cell");C.off("mousedown"),C.mousedown(_.bind(this.cellClickHandler,this))}d&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),l?this.$window.find("#c"+o).addClass("cell-selected"):this.$window.find("#r_"+o+"_"+r).addClass("cell-selected"),!1!==c&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==d){var t=this.getAllSymbolsCount(n),i=this.getColsCount(),s=this.getRowsCount(),a=Math.ceil(t/i),r=a*e,c=Math.max(0,Math.min(a-s,a*this.scrollerY.getScrollTop()/r+.5>>0));if(d=this.scrollerY.getScrollTop(),l){var p=this.previewPanel.children()[0];if(p){var h=p.id;if(h){var m=parseInt(h.slice(1,h.length)),u=this.getLinearIndexByCode(n,m),g=c*i+(this.getLinearIndexByCode(n,o)-u);o=this.getCodeByLinearIndex(n,g);var b=c*i;for(g-=i;-1===o&&g>=b;)o=this.getCodeByLinearIndex(n,g),g-=i;-1===o&&(o=this.getCodeByLinearIndex(n,b))}else o=this.getCodeByLinearIndex(n,c*i)}}else o=this.getCodeByLinearIndex(n,c*i),l=!0;this.updateView(!0,this.getCodeByLinearIndex(n,c*i))}},updateInput:function(){for(var t=o.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var e=this.getRangeBySymbol(n,o);if(e&&e.Name){this.cmbRange.setDisabled(!1);var i,s=[];for(i=0;i<n.length;++i)s.push({value:n[i].Name,displayValue:t[n[i].Name]});this.cmbRange.setData(s),this.cmbRange.setValue(e.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0,i=!0;if(l){var s=-1;if(e===Common.UI.Keys.LEFT?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,o)-1):e===Common.UI.Keys.UP?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,o)-this.getColsCount()):e===Common.UI.Keys.RIGHT?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,o)+1):e===Common.UI.Keys.DOWN?s=this.getCodeByLinearIndex(n,this.getLinearIndexByCode(n,o)+this.getColsCount()):e===Common.UI.Keys.HOME?n.length>0&&(s=n[0].Start):e===Common.UI.Keys.END?n.length>0&&(s=n[n.length-1].End):i=!1,s>-1){o=s;var a=0===this.$window.find("#c"+o).length;this.updateView(a)}}else{var c,d;if(e===Common.UI.Keys.LEFT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var p=this.$window.find(c).prev();p.length>0&&(d=this.$window.find(p).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.RIGHT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var h=this.$window.find(c).next();h.length>0&&(d=this.$window.find(h).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.HOME){var g=this.$window.find("#recent-table").children()[0];g&&(d=g.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else if(e===Common.UI.Keys.END){var b=this.recentPanel.children(),f=b[b.length-1];f&&(d=f.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else i=!1}i&&(u=e,m=(new Date).getTime())}},onKeyPress:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0;if(!(u===e&&Math.abs(m-(new Date).getTime())<1e3)){if(!isNaN(e)&&e>31)if(this.getRangeBySymbol(n,e)){var i=0===this.$window.find("#c"+e).length;o=e,l=!0,this.updateView(i,void 0,!0)}t.preventDefault&&t.preventDefault()}}},onWindowResize:function(t){var e=this.getSize();if(t&&"start"==t[1])this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]};else if(this.curSize.resize){this._preventUpdateScroll=!1,this.scrollerY=null,this.curSize.height=e[1],this.curSize.width=e[0],this.applyInnerSize(e[1]),this.special&&(e[1]-=this.switcherHeight);var i=JSON.stringify(e);Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",i),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",i)}},onWindowResizing:function(){if(this.curSize){var t=this.getSize();t[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1],this.applyInnerSize(t[1]))}},applyInnerSize:function(t){var i=t-this.hfHeight;this.controlsSymbolsHeight?(i-=this.controlsSymbolsHeight,this.symbolTablePanel.css({height:i+"px"}),i=Math.max(1,(i-2)/e>>0)*e,this.previewPanel.css({height:i+"px"}),this.previewScrolled.css({height:i+"px"}),this.updateView(void 0,void 0,void 0,!0)):this.specialList.cmpEl.height(i-this.controlsSpecialHeight)},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]);var e=this;_.delay((function(){t?e.specialList.focus():e.previewPanel.focus()}),50)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]))},textTitle:"Symbol",textFont:"Font",textRange:"Range",textRecent:"Recently used symbols",textCode:"Unicode HEX value",textSymbols:"Symbols",textSpecial:"Special characters",textCharacter:"Character",textShortcut:"Shortcut key",textEmDash:"Em Dash",textEnDash:"En Dash",textNBHyphen:"Non-breaking Hyphen",textSHyphen:"Soft Hyphen",textEmSpace:"Em Space",textEnSpace:"En Space",textQEmSpace:"1/4 Em Space",textNBSpace:"No-break Space",textCopyright:"Copyright Sign",textRegistered:"Registered Sign",textTradeMark:"Trade Mark Sign",textSection:"Section Sign",textPilcrow:"Pilcrow Sign",textEllipsis:"Horizontal Ellipsis",textSOQuote:"Single Opening Quote",textSCQuote:"Single Closing Quote",textDOQuote:"Double Opening Quote",textDCQuote:"Double Closing Quote"},Common.Views.SymbolTableDialog||{}))})),define("common/main/lib/view/ExternalEditor",[],(function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=e&&e.length?e.split(",")[0]:"";this.storageName=i+(t.storageName||"external-editor");var n={},s=t.initwidth||900,a=t.initheight||700,o=Common.localStorage.getItem(this.storageName+"-width");o&&(s=parseInt(o)),(o=Common.localStorage.getItem(this.storageName+"-height"))&&(a=parseInt(o)),_.extend(n,{width:s,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0},t),n.contentHeight=a,this.template=['<div id="id-editor-container" class="box" style="height:'+n.contentHeight+'px; padding: 0 5px;">','<div id="'+(n.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary auto" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>"].join(""),n.tpl=_.template(this.template)(n),this.handler=n.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,n)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box");var t=this.$window.find("> .body");this._headerFooterHeight=this.initConfig.header?parseInt(this.$window.find(".header").css("height")):0,this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width"));var e=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");e<this.initConfig.contentHeight+this._headerFooterHeight&&(this.initConfig.contentHeight=e-this._headerFooterHeight,this.boxEl.css("height",this.initConfig.contentHeight)),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),this.$window.height(t);var i=this.initConfig.header?parseInt(this.$window.find("> .header").css("height")):0;this.$window.find("> .body").css("height",t-i),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight)}},setInCenter:function(){var t=this.$window.height(),e=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,i=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",i),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+e)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),s=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),a=parseInt(this.boxEl.css("padding-left"))+parseInt(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),n<t+a+s&&(t=n-a-s),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+a+s),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){if(t&&"end"==t[1]){var e=this.getSize();Common.localStorage.setItem(this.storageName+"-width",e[0]),Common.localStorage.setItem(this.storageName+"-height",e[1])}},textSave:"Save & Exit",textClose:"Close"},Common.Views.ExternalEditor||{}))})),define("common/main/lib/view/ExternalDiagramEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalDiagramEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-diagram-editor",title:this.textTitle,storageName:"diagram-editor",sdkplaceholder:"id-diagram-editor-placeholder",initwidth:900,initheight:700,minwidth:730,minheight:275},t),this._chartData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},show:function(){this.setPlaceholder(),Common.Views.ExternalEditor.prototype.show.apply(this,arguments)},setChartData:function(t){this._chartData=t,this._isExternalDocReady&&this.fireEvent("setchartdata",this)},setPlaceholder:function(t){this._placeholder=t},getPlaceholder:function(){return this._placeholder},textTitle:"Chart Editor"},Common.Views.ExternalDiagramEditor||{}))})),define("common/main/lib/view/ExternalOleEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalOleEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-ole-editor",title:this.textTitle,storageName:"ole-editor",sdkplaceholder:"id-ole-editor-placeholder",initwidth:1030,initheight:700,minwidth:1030,minheight:275},t),this._oleData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setOleData:function(t){this._oleData=t,this._isExternalDocReady&&this.fireEvent("setoledata",this)},textTitle:"Spreadsheet Editor"},Common.Views.ExternalOleEditor||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/LanguageDialog",[],(function(){"use strict";Common.Views.LanguageDialog=Common.UI.Window.extend(_.extend({options:{header:!1,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},template:'<div class="box"><div class="input-row"><label><%= label %></label></div><div class="input-row" id="id-document-language"></div></div>',initialize:function(t){_.extend(this.options,t||{},{label:this.labelSelect}),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var e="app-settings-recent-langs";this.cmbLanguage=new Common.UI.ComboBoxRecent({el:t.find("#id-document-language"),cls:"input-group-nr",menuCls:"shifted-right",menuStyle:"min-width: 318px; max-height: 285px;",editable:!1,recent:{count:Common.Utils.InternalSettings.get(e+"-count")||5,offset:Common.Utils.InternalSettings.get(e+"-offset")||0,key:e,valueField:"value"},template:_.template(['<span class="input-group combobox <%= cls %> combo-langs" id="<%= id %>" style="<%= style %>">','<input type="text" class="form-control">','<span class="icon input-icon spellcheck-lang toolbar__icon btn-ic-docspell"></span>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','<span class="caret" />',"</button>",'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">',"</ul>","</span>"].join("")),itemTemplate:_.template(['<li id="<%= id %>" data-value="<%= value %>">','<a tabindex="-1" type="menuitem" langval="<%= value %>">',"<div>",'<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= displayValue %>","</div>",'<label style="opacity: 0.6"><%= displayValueEn %></label>',"</a>","</li>"].join("")),data:this.options.languages,takeFocusOnClose:!0,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLanguage.scroller&&this.cmbLanguage.scroller.update({alwaysVisibleY:!0}),this.cmbLanguage.on("selected",_.bind(this.onLangSelect,this));var i=Common.util.LanguageInfo.getLocalLanguageName(this.options.current);this.cmbLanguage.setValue(i[0],i[1]),this.onLangSelect(this.cmbLanguage,this.cmbLanguage.getSelectedRecord());var n=this;setTimeout((function(){n.cmbLanguage.focus()}),100)},getFocusedComponents:function(){return[this.cmbLanguage].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbLanguage},close:function(t){this.getChild().find(".combobox.open").length||Common.UI.Window.prototype.close.call(this,arguments)},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,this.cmbLanguage.getValue()),this.close()},onLangSelect:function(t,e,i){t.$el.find(".input-icon").toggleClass("spellcheck-lang",e&&e.spellcheck),t._input.css(Common.UI.isRTL()?"padding-right":"padding-left",e&&e.spellcheck?25:3)},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",this.cmbLanguage.getValue()),this.close(),!1},labelSelect:"Select document language"},Common.Views.LanguageDialog||{}))})),define("common/main/lib/view/SearchDialog",[],(function(){"use strict";Common.UI.SearchDialog=Common.UI.Window.extend(_.extend({options:{width:550,title:"Search & Replace",modal:!1,cls:"search",toolclose:"hide",alias:"SearchDialog"},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">','<span class="btn-placeholder" id="search-placeholder-btn-options"></span>','<input type="text" id="sd-text-search" class="input-field form-control" maxlength="255" placeholder="'+this.textSearchStart+'" autocomplete="off">',"</div>",'<div class="input-row">','<input type="text" id="sd-text-replace" class="input-field form-control" maxlength="255" placeholder="'+this.textReplaceDef+'" autocomplete="off">',"</div>",'<div class="input-row">','<label class="link" id="search-label-replace" result="replaceshow">'+this.txtBtnReplace+"</label>","</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer right">','<button class="btn normal dlg-btn" result="replace">'+this.txtBtnReplace+"</button>",'<button class="btn normal dlg-btn margin-left-6" result="replaceall" style="width: auto;min-width: 100px;">'+this.txtBtnReplaceAll+"</button>",'<button class="btn normal dlg-btn iconic" result="back"><span class="icon img-commonctrl back"></span></button>','<button class="btn normal dlg-btn iconic margin-left-6" result="next"><span class="icon img-commonctrl next"></span></button>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){return Common.UI.Window.prototype.render.call(this),this.miMatchCase=new Common.UI.MenuItem({caption:this.textMatchCase,checkable:!0}),this.miMatchWord=new Common.UI.MenuItem({caption:this.options.matchwordstr||this.textWholeWords,checkable:!0}),this.miHighlight=new Common.UI.MenuItem({caption:this.textHighlight,checkable:!0}),this.btnOptions=new Common.UI.Button({id:"search-btn-options",cls:"btn-toolbar",iconCls:"toolbar__icon btn-settings",menu:new Common.UI.Menu({items:[this.miMatchCase,this.miMatchWord,this.miHighlight]})}),this.options.extraoptions&&(this.btnOptions.menu.addItem({caption:"--"}),this.options.extraoptions.forEach((function(t){this.btnOptions.menu.addItem(t)}),this)),this.btnOptions.render(this.$window.find("#search-placeholder-btn-options")),this.options.matchcase||this.miMatchCase.hide(),this.options.matchword||this.miMatchWord.hide(),this.options.markresult?this.options.markresult.applied&&this.miHighlight.setChecked(!0,!0):this.miHighlight.hide(),"search"===this.options.mode&&$(this.$window.find(".input-row").get(2)).hide(),this.txtSearch=this.$window.find("#sd-text-search"),this.txtReplace=this.$window.find("#sd-text-replace"),this.lblReplace=this.$window.find("#search-label-replace"),this.miHighlight.on("toggle",_.bind(this.onHighlight,this)),this.$window.find(".btn[result=back]").on("click",_.bind(this.onBtnClick,this,"back")),this.$window.find(".btn[result=next]").on("click",_.bind(this.onBtnClick,this,"next")),this.$window.find(".btn[result=replace]").on("click",_.bind(this.onBtnClick,this,"replace")),this.$window.find(".btn[result=replaceall]").on("click",_.bind(this.onBtnClick,this,"replaceall")),this.$window.find("label[result=replaceshow]").on("click",_.bind(this.onShowReplace,this)),this.txtSearch.on("keydown",null,"search",_.bind(this.onKeyPress,this)),this.txtReplace.on("keydown",null,"replace",_.bind(this.onKeyPress,this)),this.on("animate:before",_.bind(this.onAnimateBefore,this)),this},show:function(t,e){Common.UI.Window.prototype.show.call(this),!this.mode&&!t&&(t="search"),t&&this.mode!=t&&this.setMode(t),e&&this.setSearchText(e),this.options.markresult&&this.miHighlight.checked&&this.fireEvent("search:highlight",[this,!0]),this.focus()},focus:function(t){var e="replace"===t?this.txtReplace:this.txtSearch;setTimeout((function(){e.focus(),e.select()}),10)},onAnimateBefore:function(){this.focus()},onKeyPress:function(t){this.isLocked()||(t.keyCode==Common.UI.Keys.RETURN?("search"==t.data?this.onBtnClick("next",t):"replace"==t.data&&"replace"==this.mode&&this.onBtnClick("replace",t),t.preventDefault(),t.stopPropagation()):t.keyCode==Common.UI.Keys.ESC&&$(".asc-loadmask").length<1&&(this.hide(),t.preventDefault(),t.stopPropagation()))},onBtnClick:function(t,e){if(!$(".asc-loadmask").length){var i={textsearch:this.txtSearch.val(),textreplace:this.txtReplace.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked,highlight:this.miHighlight.checked};this.fireEvent("search:"+t,[this,i])}},setMode:function(t){this.mode=t;var e=this.$window.find(".input-row");"no-replace"===t?(this.setTitle(this.textTitle2),e.eq(1).hide(),e.eq(2).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.options.matchcase||this.options.matchword||this.options.markresult||(this.txtSearch.addClass("clear"),this.btnOptions.hide()),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(170)):(this.txtSearch.removeClass("clear"),this.setTitle(this.textTitle),"search"===t?(e.eq(2).show(),this.lblReplace.text(this.txtBtnReplace),e.eq(1).hide(),this.$window.find(".btn[result=replace]").hide(),this.$window.find(".btn[result=replaceall]").hide(),this.menuLookin&&this.menuLookin.menu.items[1].setDisabled(!1),this.setHeight(200)):(e.eq(2).show(),this.lblReplace.text(this.txtBtnHideReplace),e.eq(1).show(),this.$window.find(".btn[result=replace]").show(),this.$window.find(".btn[result=replaceall]").show(),this.menuLookin&&(this.menuLookin.menu.items[0].setChecked(!0),this.menuLookin.menu.items[1].setDisabled(!0)),this.setHeight(230)))},setSearchText:function(t){this.txtSearch&&this.txtSearch.val(t)},onShowReplace:function(t){this.setMode("replace"==this.mode?"search":"replace");var e=this;_.defer((function(){"replace"==e.mode?e.txtReplace.focus():e.txtSearch.focus()}),300)},onHighlight:function(t,e){this.fireEvent("search:highlight",[this,e])},getSettings:function(){return{textsearch:this.txtSearch.val(),matchcase:this.miMatchCase.checked,matchword:this.miMatchWord.checked}},textTitle:"Search & Replace",textTitle2:"Search",txtBtnReplace:"Replace",txtBtnReplaceAll:"Replace All",textMatchCase:"Case sensitive",textWholeWords:"Whole words only",textHighlight:"Highlight results",textReplaceDef:"Enter the replacement text",textSearchStart:"Enter text for search",txtBtnHideReplace:"Hide Replace"},Common.UI.SearchDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/InsertTableDialog",[],(function(){"use strict";Common.Views.InsertTableDialog=Common.UI.Window.extend(_.extend({options:{width:230,style:"min-width: 230px;",cls:"modal-dlg",id:"window-insert-table",split:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:t.split?this.txtTitleSplit:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="text columns-text" style="width: 130px;">'+this.txtColumns+'</label><div class="columns-val float-right"></div>',"</div>",'<div class="input-row" style="margin-top: 10px;">','<label class="text rows-text" style="width: 130px;">'+this.txtRows+'</label><div class="rows-val float-right"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.udColumns=new Common.UI.MetricSpinner({el:t.find(".columns-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:63,minValue:1,allowDecimal:!1}),this.udRows=new Common.UI.MetricSpinner({el:t.find(".rows-val"),step:1,width:64,value:2,defaultUnit:"",maxValue:100,minValue:1,allowDecimal:!1})},getFocusedComponents:function(){return[this.udColumns,this.udRows].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.udColumns},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,t.currentTarget.attributes.result.value,{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close()},onPrimary:function(){return this.options.handler&&this.options.handler.call(this,"ok",{columns:this.udColumns.getNumberValue(),rows:this.udRows.getNumberValue()}),this.close(),!1},txtTitle:"Table Size",txtTitleSplit:"Split Cell",txtColumns:"Number of Columns",txtRows:"Number of Rows",textInvalidRowsCols:"You need to specify valid rows and columns count.",txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},Common.Views.InsertTableDialog||{}))})),define("common/main/lib/view/RenameDialog",[],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},getFocusedComponents:function(){return[this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),define("common/main/lib/view/PasswordDialog",[],(function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{width:395,header:!0,cls:"modal-dlg",contentTemplate:"",title:e.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+e.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+e.txtPassword+(e.passwordOptional?" ("+e.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1})}},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()},txtTitle:"Set Password",txtPassword:"Password",txtDescription:"A Password is required to open this document",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place."},Common.Views.PasswordDialog||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.cls+=" advanced-settings-dlg invisible-borders",(!e.buttons||_.size(e.buttons)<1)&&(e.cls+=" no-footer"),e.contentHeight=e.height,e.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+e.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var e=document.createElement("iframe");e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this);var i=this,n=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:n}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())}),500),e.src=this.url,n.append(e),this.frame=e,this.on("resizing",(function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)}));var s=function(){i.onWindowResize()};$(window).on("resize",s),this.on("close",(function(){$(window).off("resize",s)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),s=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),a=2*this.bordersOffset;i-a<e+this._headerFooterHeight&&(e=i-a-this._headerFooterHeight),n-a<t+s&&(t=n-a-s),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+s),this.$window.css("left",(n-t-s)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),n=this.getHeight(),s=this.resizable?0:this.bordersOffset;if(n<e-2*s+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var a=Math.max(Math.min(this._restoreHeight,e-2*s),this.initConfig.minheight);this.setHeight(a),this.boxEl.css("height",a-this._headerFooterHeight)}var o=this.getTop();o<s?this.$window.css("top",s):o+n>e-s&&this.$window.css("top",e-s-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(e-2*s,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*s,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",s);if(i<t-2*s+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*s),this.initConfig.minwidth));var l=this.getLeft();l<s?this.$window.css("left",s):l+i>t-s&&this.$window.css("left",t-s-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*s,this.initConfig.minwidth)),this.$window.css("left",s)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),e="id-plugindlg-docked",i=t.find("#"+e);if(i.length<1){(i=$('<div id="'+e+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=i.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(i),i.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}i.show(),t.removeClass("hidden")},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),n=i.find("#id-plugindlg-"+t);if(n.length<1){var s="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+s+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(n)}n.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginPanel",[],(function(){"use strict";Common.Views.PluginPanel=Common.UI.BaseView.extend(_.extend({template:_.template(['<div class="current-plugin-box layout-ct vbox">','<div class="current-plugin-frame">',"</div>",'<div class="current-plugin-header">','<div class="tools">','<div class="plugin-close close"></div>','<div class="plugin-hide"></div>',"</div>","<label></label>","</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._state={},this.menu||(this.menu="left"),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$(".current-plugin-header label",this.$el),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$(".current-plugin-box",this.$el),this.currentPluginFrame=$(".current-plugin-frame",this.$el),this.pluginClose=new Common.UI.Button({parentEl:this.$el.find(".plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.sideMenuButton&&(this.pluginHide=new Common.UI.Button({parentEl:this.$el.find(".plugin-hide"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-panel-left-collapse",hint:this.textHidePanel})),this.isCanDocked&&this.showDockedButton(),this.trigger("render:after",this),this},showDockedButton:function(){var t=this.$el.find(".current-plugin-header .tools"),e="plugin-undock",i=t.find("."+e);i.length<1&&(i=$('<div class="'+e+'"></div>'),this.$el.find(".plugin-close").after(i),new Common.UI.Button({parentEl:this.$el.find("."+e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-unpin",hint:this.textUndock}).on("click",_.bind((function(){this.fireEvent("docked",this.iframePlugin.id)}),this)));i.show(),t.removeClass("hidden")},openInsideMode:function(t,e,i,n){return this.pluginName||this.render(),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=n,!0},closeInsideMode:function(){this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this._state.insidePlugin=void 0},_onLoad:function(){this.loadMask&&this.loadMask.hide()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},enablePointerEvents:function(t){this.iframePlugin&&(this.iframePlugin.style.pointerEvents=t?"":"none")},textClosePanel:"Close plugin",textLoading:"Loading",textUndock:"Unpin plugin",textHidePanel:"Collapse plugin"},Common.Views.PluginPanel||{}))})),define("common/main/lib/view/ShapeShadowDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShapeShadowDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ShapeShadowDialog",contentWidth:230,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px;",contentTemplate:['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="header">'+e.txtTransparency+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-transparency-slider" style="display: inline-block"></div>','<div id="shape-shadow-transparency-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtSize+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-size-slider" style="display: inline-block"></div>','<div id="shape-shadow-size-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtAngle+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-angle-slider" style="display: inline-block"></div>','<div id="shape-shadow-angle-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtDistance+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-distance-slider" style="display: inline-block"></div>','<div id="shape-shadow-distance-spin"></div>',"</div>","</td>","</tr>","</table>","</div>","</div>"].join("")},t),this.handler=t.handler,this.api=t.api,this.shadowProps=t.shadowProps,this.methodApplySettings=t.methodApplySettings,this.isShadowEmpty=!this.shadowProps,this.shadowProps||(this.shadowProps=new Asc.asc_CShadowProperty,this.shadowProps.putPreset("t")),this.oldTransparency=this.shadowProps.getTransparency(),this.oldSize=this.shadowProps.getSize(),this.oldAngle=this.shadowProps.getAngle(),this.oldDistance=this._mm2pt(this.shadowProps.getDistance()),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){if(Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.api.setStartPointHistory(),this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,t)}this.sldrTransparency=new Common.UI.SingleSlider({el:$("#shape-shadow-transparency-slider"),width:128,minValue:0,maxValue:100,value:this.oldTransparency}),this.sldrTransparency.on("change",_.bind(this.onSliderTransparencyChange,this)),this.spinTransparency=new Common.UI.MetricSpinner({el:$("#shape-shadow-transparency-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinTransparency.setValue(this.oldTransparency,!0),this.spinTransparency.on("change",_.bind(this.onSpinnerTransparencyChange,this)),this.sldrSize=new Common.UI.SingleSlider({el:$("#shape-shadow-size-slider"),width:128,minValue:1,maxValue:200,value:this.oldSize}),this.sldrSize.on("change",_.bind(this.onSliderSizeChange,this)),this.spinSize=new Common.UI.MetricSpinner({el:$("#shape-shadow-size-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:200,minValue:1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinSize.setValue(this.oldSize,!0),this.spinSize.on("change",_.bind(this.onSpinnerSizeChange,this)),this.sldrAngle=new Common.UI.SingleSlider({el:$("#shape-shadow-angle-slider"),width:128,minValue:0,maxValue:359,value:this.oldAngle}),this.sldrAngle.on("change",_.bind(this.onSliderAngleChange,this)),this.spinAngle=new Common.UI.MetricSpinner({el:$("#shape-shadow-angle-spin"),step:1,width:62,allowDecimal:!1,value:"0 ",defaultUnit:"",maxValue:359,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinAngle.setValue(this.oldAngle,!0),this.spinAngle.on("change",_.bind(this.onSpinnerAngleChange,this)),this.sldrDistance=new Common.UI.SingleSlider({el:$("#shape-shadow-distance-slider"),width:128,minValue:0,maxValue:200,value:this.oldDistance}),this.sldrDistance.on("change",_.bind(this.onSliderDistanceChange,this));var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt);this.spinDistance=new Common.UI.MetricSpinner({el:$("#shape-shadow-distance-spin"),step:1,width:62,allowDecimal:!1,value:"0 "+e,defaultUnit:e,maxValue:200,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinDistance.setValue(this.oldDistance,!0),this.spinDistance.on("change",_.bind(this.onSpinnerDistanceChange,this)),this.on("close",_.bind(this.handleCancelClose,this))},onSliderTransparencyChange:function(t,e,i){this.spinTransparency.setValue(e,!0),this.setTransparency(e)},onSpinnerTransparencyChange:function(t,e,i){var n=t.getNumberValue();this.sldrTransparency.setValue(n,!0),this.setTransparency(n)},setTransparency:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderSizeChange:function(t,e,i){this.spinSize.setValue(e,!0),this.setSize(e)},onSpinnerSizeChange:function(t,e,i){var n=t.getNumberValue();this.sldrSize.setValue(n,!0),this.setSize(n)},setSize:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putSize(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderAngleChange:function(t,e,i){this.spinAngle.setValue(e,!0),this.setAngle(e)},onSpinnerAngleChange:function(t,e,i){var n=t.getNumberValue();this.sldrAngle.setValue(n,!0),this.setAngle(n)},setAngle:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putAngle(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderDistanceChange:function(t,e,i){this.spinDistance.setValue(e,!0),this.setDistance(e)},onSpinnerDistanceChange:function(t,e,i){var n=t.getNumberValue();this.sldrDistance.setValue(n,!0),this.setDistance(n)},setDistance:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putDistance(this._pt2mm(t)),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},setAllProperties:function(t,e,i,n){var s=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),this.shadowProps.putSize(e),this.shadowProps.putAngle(i),this.shadowProps.putDistance(this._pt2mm(n)),s.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,s)},getFocusedComponents:function(){return[this.spinTransparency,this.spinSize,this.spinAngle,this.spinDistance].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spinTransparency},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},onPrimary:function(){return this.handleOkClose(),this.close(!0),!1},onDlgBtnClick:function(t){"ok"==t.currentTarget.attributes.result.value?this.handleOkClose():this.handleCancelClose(),this.close(!0)},onDblClickFunction:function(){this.handleOkClose(),this.close(!0)},handleOkClose:function(){this.api.setEndPointHistory(),this.setAllProperties(parseInt(this.spinTransparency.getValue()),parseInt(this.spinSize.getValue()),parseInt(this.spinAngle.getValue()),parseInt(this.spinDistance.getValue())),this.handler&&this.handler.call(this,"ok")},handleCancelClose:function(){if(this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(null),this.methodApplySettings&&this.methodApplySettings.call(this,t)}else this.setAllProperties(this.oldTransparency,this.oldSize,this.oldAngle,this.oldDistance);this.api.setEndPointHistory(),this.handler&&this.handler.call(this,"cancel")},txtTitle:"Adjust Shadow",txtTransparency:"Transparency",txtSize:"Size",txtAngle:"Angle",txtDistance:"Distance"},Common.Views.ShapeShadowDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CustomizeQuickAccessDialog",[],(function(){"use strict";Common.Views.CustomizeQuickAccessDialog=Common.UI.Window.extend(_.extend({options:{width:296,style:"min-width: 296px;",cls:"modal-dlg quick-access-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<label class="padding-medium">'+this.textMsg+"</label>",'<div class="padding-small" id="quick-access-chb-save"></div>','<div class="padding-small" id="quick-access-chb-print"></div>','<div class="padding-small" id="quick-access-chb-quick-print" style="display:none;"></div>','<div class="padding-small" id="quick-access-chb-undo"></div>','<div class="padding-small" id="quick-access-chb-redo"></div>','<div class="padding-small" id="quick-access-chb-start-over" style="display:none;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.focusedComponents=[],this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.showSave&&(this.chSave=new Common.UI.CheckBox({el:$("#quick-access-chb-save"),labelText:this.options.mode&&(this.options.mode.canSaveToFile||this.options.mode.isDesktopApp&&this.options.mode.isOffline)?this.textSave:this.textDownload,value:this.props.save}),this.focusedComponents.push(this.chSave)),this.options.showPrint&&(this.chPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-print"),labelText:this.textPrint,value:this.props.print}),this.focusedComponents.push(this.chPrint)),this.options.showQuickPrint&&(this.chQuickPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-quick-print"),labelText:this.textQuickPrint,value:this.props.quickPrint}),this.focusedComponents.push(this.chQuickPrint),this.chQuickPrint.show()),this.chUndo=new Common.UI.CheckBox({el:$("#quick-access-chb-undo"),labelText:this.textUndo,value:this.props.undo}),this.focusedComponents.push(this.chUndo),this.chRedo=new Common.UI.CheckBox({el:$("#quick-access-chb-redo"),labelText:this.textRedo,value:this.props.redo}),this.focusedComponents.push(this.chRedo),window.PE&&(this.chStartOver=new Common.UI.CheckBox({el:$("#quick-access-chb-start-over"),labelText:this.textStartOver,value:this.props.startOver}),this.focusedComponents.push(this.chStartOver),this.chStartOver.show())},getFocusedComponents:function(){return this.focusedComponents.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.focusedComponents[0]},onBtnClick:function(t){"ok"===t.currentTarget.attributes.result.value&&Common.NotificationCenter.trigger("quickaccess:changed",{save:this.chSave?"checked"===this.chSave.getValue():void 0,print:this.chPrint?"checked"===this.chPrint.getValue():void 0,quickPrint:this.chQuickPrint?"checked"===this.chQuickPrint.getValue():void 0,undo:"checked"===this.chUndo.getValue(),redo:"checked"===this.chRedo.getValue(),startOver:this.chStartOver?"checked"===this.chStartOver.getValue():void 0}),this.close()},textTitle:"Customize quick access",textMsg:"Check the commands that will be displayed on the Quick Access Toolbar",textSave:"Save",textPrint:"Print",textQuickPrint:"Quick Print",textUndo:"Undo",textRedo:"Redo",textDownload:"Download file"},Common.Views.CustomizeQuickAccessDialog||{}))})),define("common/main/lib/view/DocumentHolderExt",[],(function(){"use strict";let t=window.DE||window.PDFE||window.PDFE||window.PE||window.SSE||window.VE;if(t&&t.Views&&t.Views.DocumentHolder){let e=t.Views.DocumentHolder.prototype;e.addEquationMenu=function(t,e){if(t){var i=this;i.clearEquationMenu(t,e);var n=i.initEquationMenu();return n.length>0&&_.each(n,(function(n,s){n.menu?_.each(n.menu.items,(function(t){t.on("click",_.bind(i.equationCallback,i,t.options.equationProps))})):n.on("click",_.bind(i.equationCallback,i,n.options.equationProps)),t.insertItem(e,n),e++})),n.length}},e.clearEquationMenu=function(t,e){for(var i=e;i<t.items.length&&t.items[i].options.equation;i++)t.items[i].menu?_.each(t.items[i].menu.items,(function(t){t.off("click")})):t.items[i].off("click"),t.removeItem(t.items[i]),i--},e.equationCallback=function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&e[t.callback](t.value)}this.fireEvent("equation:callback",[e])},e.initEquationMenu=function(){var t=this._currentTranslateObj;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),n=t._currentMathObj,s=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:n.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!n.get_HideTop()}},{caption:n.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!n.get_HideBottom()}},{caption:n.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!n.get_HideLeft()}},{caption:n.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!n.get_HideRight()}},{caption:n.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!n.get_HideHor()}},{caption:n.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!n.get_HideVer()}},{caption:n.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!n.get_HideTopLTR()}},{caption:n.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!n.get_HideTopRTL()}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var a=n.get_ScriptType();a==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)):(a==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),s.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),s.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:var o=n.get_FractionType();o!=Asc.c_oAscMathInterfaceFraction.Skewed&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),s.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),s.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),s.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:o==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:o==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:n.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!n.get_HidePlaceholder()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:n.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),s.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:n.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),s.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:n.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),s.push(e),void 0!==n.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:n.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!n.get_HideUpper()}}),s.push(e)),void 0!==n.get_HideLower()&&(e=new Common.UI.MenuItem({caption:n.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!n.get_HideLower()}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),s.push(e),n.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),s.push(e)),e=new Common.UI.MenuItem({caption:n.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!n.get_HideOpeningBracket()}}),s.push(e),e=new Common.UI.MenuItem({caption:n.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!n.get_HideClosingBracket()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!n.get_StretchBrackets()}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!n.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:n.get_StretchBrackets()&&n.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!n.get_MatchBrackets()}}),s.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:n.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:n.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),s.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),s.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==n.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:n.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!n.get_HideDegree()}}),s.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),s.push(e)}return n.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),s.push(e)),n.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),s.push(e)),n.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),s.push(e)),n.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),s.push(e)),n.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),s.push(e)),s}},e.updateCustomItems=function(t,e){if(t&&e&&!(e.length<1)){var i=this,n=i.mode&&i.mode.lang?i.mode.lang.split(/[\-_]/)[0]:"en";i._preventCustomClick&&clearTimeout(i._preventCustomClick),i._hasCustomItems&&(i._preventCustomClick=setTimeout((function(){i._preventCustomClick=null}),500)),i._hasCustomItems=!0;var s,a=function(e,i){if(t&&t.items.length>0)for(var n=t.items.length-1;n>=0;n--)if(t.items[n].isCustomItem&&(void 0===i&&t.items[n].options.guid===e||t.items[n].options.guid===e&&t.items[n].value===i))return t.items[n]},o=function(t,e,s){var a=!1;return s?s.removeAll():((s=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,n){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),s.on("menu:click",(function(t,e){i._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&s.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&s.addItem(new Common.UI.MenuItemCustom({caption:("object"==typeof t.text?t.text[n]||t.text.en:t.text)||"",value:t.id,guid:e,menu:!!t.items&&o(t.items,e),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled})),a=a||!!t.icons})),a&&(s.cmpEl?s.cmpEl.toggleClass("shifted-right",!0):s.options.cls="shifted-right"),s};if(e.forEach((function(e){var l=!a(e.guid);e&&e.items&&e.items.length>0&&e.items.forEach((function(r){if(r.separator&&l&&t.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e.guid})),r.text){var c=a(e.guid,r.id),d=("object"==typeof r.text?r.text[n]||r.text.en:r.text)||"";if(c)c.setCaption(d),c.setDisabled(!!r.disabled),r.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,s=c.cmpEl),o(r.items,e.guid,c.menu)):c.setMenu(o(r.items,e.guid)));else{c=new Common.UI.MenuItemCustom({caption:d,value:r.id,guid:e.guid,menu:!!(r.items&&r.items.length>=0)&&o(r.items,e.guid),iconsSet:r.icons,baseUrl:"",disabled:!!r.disabled}).on("click",(function(t,e){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));t.addItem(c)}}}))})),s){var l=$("> [role=menu]",s).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}t.alignPosition()}},e.clearCustomItems=function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}}})),void 0===Common)Common={};if(define("common/main/lib/view/SignDialog",[],(function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(t.onChangeName,t)),t.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 230px;",menuCls:"scrollable-menu",menuStyle:"min-width: 230px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:t.tipFontName}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),i.name,t.font.size,t.font.italic,t.font.bold),t.font.name=i.name})),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 50px;",menuCls:"scrollable-menu",menuStyle:"min-width: 50px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,i.value,t.font.italic,t.font.bold),t.font.size=i.value})),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:t.textBold}),t.btnBold.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,t.font.italic,e.pressed),t.font.bold=e.pressed})),t.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:t.textItalic}),t.btnItalic.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,e.pressed,t.font.bold),t.font.italic=e.pressed})),t.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),t.btnSelectImage.on("click",_.bind(t.onSelectImage,t)),t.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),t.btnChangeCertificate.on("click",_.bind(t.onChangeCertificate,t)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),t.btnOk.setDisabled(!0),t.cntCertificate=$("#id-dlg-sign-certificate"),t.cntVisibleSign=$("#id-dlg-sign-visible"),t.cntInvisibleSign=$("#id-dlg-sign-invisible"),"visible"==t.signType?t.cntInvisibleSign.addClass("hidden"):t.cntVisibleSign.addClass("hidden"),e.find(".dlg-btn").on("click",_.bind(t.onBtnClick,t)),t.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate].concat(this.getFooterButtons())},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()}),500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,i="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",i[0]).replace("%2",i[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,n){var s;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(s=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return s=e.getValue(),e.setRawValue(s),n.preventDefault(),!1}else{var a="sse-"==this.appPrefix?409:300;s=(s=Common.Utils.String.parseFloat(i.value))>a?a:s<1?1:Math.floor(2*(s+.4))/2,e.setRawValue(s),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,s,this.font.italic,this.font.bold),this.font.size=s}},textTitle:"Sign Document",textPurpose:"Purpose for signing this document",textCertificate:"Certificate",textValid:"Valid from %1 to %2",textChange:"Change",textInputName:"Input signer name",textUseImage:"or click 'Select Image' to use a picture as signature",textSelectImage:"Select Image",textSignature:"Signature looks as",tipFontName:"Font Name",tipFontSize:"Font Size",textBold:"Bold",textItalic:"Italic",textSelect:"Select",textNameError:"Signer name must not be empty."},Common.Views.SignDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/ListSettingsDialog",[],(function(){"use strict";var t={none:-1,symbol:0,image:2,newSymbol:1,newImage:-2};Common.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:285,height:261,style:"min-width: 240px;",cls:"modal-dlg",id:"window-list-settings",split:!1,buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 16px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-list-bullet">',this.textBulleted,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-list-numbering">',this.textNumbering,"</button>","</div>",'<div style="height:120px;">','<table cols="3">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtType+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-numbering-format" class="input-group-nr" style="width: 105px;"></div>','<div id="id-dlg-list-bullet-format" class="input-group-nr" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="image">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtImport+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-image" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtSize+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-size"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="text" style="white-space: nowrap;">'+this.txtOfText+"</label>","</td>","</tr>",'<tr class="numbering">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text" style="white-space: nowrap;">'+this.txtStart+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-start"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="color">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtColor+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-color"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","</table>","</div>","</div>"].join(""),this.props=t.props,this.options.tpl=_.template(this.template)(this.options),this.color="000000",this.storage=!!t.storage,this.api=t.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,i=this.getChild();i.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.btnBullet=new Common.UI.Button({el:$("#id-dlg-list-bullet"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1,pressed:!0}),e.btnBullet.on("click",_.bind(e.onListTypeClick,e,0)),e.btnNumbering=new Common.UI.Button({el:$("#id-dlg-list-numbering"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1}),e.btnNumbering.on("click",_.bind(e.onListTypeClick,e,1)),Common.UI.GroupedButtons([e.btnBullet,e.btnNumbering]),this.cmbNumFormat=new Common.UI.ComboBox({el:$("#id-dlg-list-numbering-format"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{displayValue:this.txtNone,value:-1},{displayValue:"A, B, C,...",value:4},{displayValue:"a), b), c),...",value:5},{displayValue:"a, b, c,...",value:6},{displayValue:"1, 2, 3,...",value:1},{displayValue:"1), 2), 3),...",value:2},{displayValue:"I, II, III,...",value:3},{displayValue:"i, ii, iii,...",value:7}]}),this.cmbNumFormat.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putListType(1,e.value)}),this)),this.cmbNumFormat.setValue(1);var n=["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue %>",'<% if (item.value === 0) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span>','<% } else if (item.value === 2) { %><span id="id-dlg-list-bullet-image-preview" class="margin-left-4" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span><% } %>',"</a></li>","<% }); %>"],s=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(n).concat(["</ul>","</div>"]);this.cmbBulletFormat=new Common.UI.ComboBoxCustom({el:$("#id-dlg-list-bullet-format"),menuStyle:"min-width: 100%;max-height: 183px;",style:"width: 105px;",editable:!1,takeFocusOnClose:!0,template:_.template(s.join("")),itemsTemplate:_.template(n.join("")),data:[{displayValue:this.txtNone,value:t.none},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"w",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtNewBullet,value:t.newSymbol},{displayValue:this.txtNewImage,value:t.newImage}],updateFormControl:function(i){var n=$(this.el).find(".form-control");if(i)if(i.get("value")===t.symbol)n[0].innerHTML=i.get("displayValue")+'<span style="font-family:'+(i.get("font")||"Arial")+'">'+i.get("symbol")+"</span>";else if(i.get("value")===t.image){n[0].innerHTML=i.get("displayValue")+'<span id="id-dlg-list-bullet-combo-preview" class="margin-left-2" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span>';var s=new Asc.asc_CBullet;s.asc_fillBulletImage(e.imageProps.id),s.drawSquareImage("id-dlg-list-bullet-combo-preview")}else i.get("value")===t.newImage?n[0].innerHTML=e.txtImage:n[0].innerHTML=i.get("displayValue");else n[0].innerHTML=""}});var a=this.cmbBulletFormat.store.at(1);this.cmbBulletFormat.selectRecord(a),this.bulletProps={symbol:a.get("symbol"),font:a.get("font")},this.cmbBulletFormat.on("selected",_.bind((function(e,i){if(this.imageControls.toggleClass("hidden",!(i.value===t.image||i.value===t.newImage)),this.colorControls.toggleClass("hidden",i.value===t.image||i.value===t.newImage),i.value===t.newSymbol){var n,s=this,a=s.bulletProps,o=function(i,o,l){n=o,"ok"==o&&(a.changed=!0,a.code=l.code,a.font=l.font,a.symbol=l.symbol,s._changedProps&&(s._changedProps.asc_putFont(a.font),s._changedProps.asc_putSymbol(a.symbol)));var r=e.store;if(!r.findWhere({value:t.symbol,symbol:a.symbol,font:a.font})){var c=r.indexOf(r.findWhere({value:t.image}));c<0&&(c=r.indexOf(r.findWhere({value:t.newSymbol}))),r.add({displayValue:s.txtSymbol+": ",value:t.symbol,symbol:a.symbol,font:a.font},{at:c})}s.imageProps&&(s.imageProps.redraw=!0),e.setData(r.models),e.selectRecord(e.store.findWhere({value:t.symbol,symbol:a.symbol,font:a.font}))},l=new Common.Views.SymbolTableDialog({api:s.options.api,lang:s.options.interfaceLang,modal:!0,type:0,font:a.font,symbol:a.symbol,handler:o}).on("close",(function(t){void 0===n&&o&&o.call(s),setTimeout((function(){s.cmbBulletFormat.focus()}),1)}));l.show(),l.on("symbol:dblclick",o)}else i.value==t.newImage||(i.value==t.image?this._changedProps&&this._changedProps.asc_fillBulletImage(this.imageProps.id):i.value==t.none?this._changedProps&&this._changedProps.asc_putListType(0,i.value):(this.bulletProps.changed=!0,this.bulletProps.code=i.code,this.bulletProps.font=i.font,this.bulletProps.symbol=i.symbol,this._changedProps&&(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol))));this.btnOk.setDisabled(i.value===t.newImage)}),this)),this.cmbBulletFormat.on("show:after",_.bind(this.onBulletFormatOpen,this)),this.spnSize=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-size"),step:1,width:105,value:100,defaultUnit:"",maxValue:400,minValue:25,allowDecimal:!1}).on("change",(function(t,i,n,s){e._changedProps&&e._changedProps.asc_putSize(t.getNumberValue())}));var o=this.options.colorConfig||{};this.btnColor=new Common.UI.ColorButton({parentEl:i.find("#id-dlg-list-color"),style:"width:45px;",additionalAlign:this.menuAddAlign,color:this.color,colors:o.colors,dynamiccolors:o.dynamiccolors,themecolors:o.themecolors,effects:o.effects,columns:o.columns,paletteCls:o.cls,paletteWidth:o.paletteWidth,takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.colors=this.btnColor.getPicker(),this.spnStart=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-start"),step:1,width:105,value:1,defaultUnit:"",maxValue:32767,minValue:1,allowDecimal:!1}).on("change",(function(t,i,n,s){e._changedProps&&e._changedProps.asc_putNumStartAt(t.getNumberValue())})),this.btnSelectImage=new Common.UI.Button({parentEl:$("#id-dlg-list-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 100%;",menu:new Common.UI.Menu({style:"min-width: 105px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),takeFocusOnClose:!0}),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:i.find(".primary")}),e.numberingControls=i.find("tr.numbering"),e.imageControls=i.find("tr.image"),e.colorControls=i.find("tr.color");var l=i.find("table tr:first() td:first()");l.width(Math.max(i.find(".numbering .text").width(),l.width())),this.afterRender()},getFocusedComponents:function(){return[this.btnBullet,this.btnNumbering,this.cmbNumFormat,this.cmbBulletFormat,this.btnSelectImage,this.spnSize,this.spnStart,this.btnColor].concat(this.getFooterButtons())},afterRender:function(){!this.options.colorConfig&&this.updateThemeColors(),this._setDefaults(this.props);var e=this,i=function(i){e.imageProps={id:i.asc_getImageId(),redraw:!0},e._changedProps&&e._changedProps.asc_fillBulletImage(e.imageProps.id);var n=e.cmbBulletFormat.store;if(!n.findWhere({value:t.image})){var s=n.indexOf(n.findWhere({value:t.newSymbol}));n.add({displayValue:e.txtImage+":",value:t.image},{at:s})}e.cmbBulletFormat.setData(n.models),e.cmbBulletFormat.selectRecord(e.cmbBulletFormat.store.findWhere({value:t.image})),e.btnOk.setDisabled(!1)};this.api.asc_registerCallback("asc_onBulletImageLoaded",i);var n=function(t){t&&t._urls&&"bullet"==t.c&&(new Asc.asc_CBullet).asc_putImageUrl(t._urls[0],t.token)};Common.NotificationCenter.on("storage:image-insert",n),this.on("close",(function(t){e.api.asc_unregisterCallback("asc_onBulletImageLoaded",i),Common.NotificationCenter.off("storage:image-insert",n)}))},onBulletFormatOpen:function(e){if(e.store.findWhere({value:t.image})&&this.imageProps.redraw){var i=new Asc.asc_CBullet;i.asc_fillBulletImage(this.imageProps.id),i.drawSquareImage("id-dlg-list-bullet-image-preview"),this.imageProps.redraw=!1}},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onColorsSelect:function(t,e){this.color=e,this._changedProps&&this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(e))},onListTypeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(e){var i=0==e&&(this.cmbBulletFormat.getValue()===t.image||this.cmbBulletFormat.getValue()===t.newImage||(void 0===this.cmbBulletFormat.getValue()||""===this.cmbBulletFormat.getValue())&&this.originalType===AscFormat.BULLET_TYPE_BULLET_BLIP);this.numberingControls.toggleClass("hidden",0==e),this.imageControls.toggleClass("hidden",!i),this.colorControls.toggleClass("hidden",i),this.cmbNumFormat.setVisible(1==e),this.cmbBulletFormat.setVisible(0==e),this.btnOk.setDisabled(i&&this.cmbBulletFormat.getValue()===t.newImage);var n=this;_.delay((function(){e?n.cmbNumFormat.focus():n.cmbBulletFormat.focus()}),50)},_handleInput:function(e){if(this.options.handler){if("ok"==e&&this.btnOk.isDisabled())return;var i=this.btnBullet.pressed?0:1;this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE&&(this._changedProps=new Asc.asc_CBullet,this._changedProps.asc_putSize(this.spnSize.getNumberValue()),0==i&&this.cmbBulletFormat.getValue()===t.image&&this.imageProps?this._changedProps.asc_fillBulletImage(this.imageProps.id):this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.color))),(this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE||(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR||this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP)&&1==i||this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM&&0==i)&&(0==i?this.cmbBulletFormat.getValue()==t.none?this._changedProps.asc_putListType(0,-1):this.cmbBulletFormat.getValue()==t.image||(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol)):(this._changedProps.asc_putListType(1,this.cmbNumFormat.getValue()),this._changedProps.asc_putNumStartAt(this.spnStart.getNumberValue()))),this.options.handler.call(this,e,this._changedProps)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(e){if(e){var i=0,n=e.asc_getBullet();if(n){this.originalType=n.asc_getType(),this.spnSize.setValue(n.asc_getSize()||"",!0);var s=n.asc_getColor();if(s=s?s.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b()),effectValue:s.get_value()}:Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b()):"transparent",this.color=Common.Utils.ThemeColor.colorValue2EffectId(s),this.btnColor.setColor(s),Common.Utils.ThemeColor.selectPickerColorByEffect(s,this.colors),this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE)this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),i=this.type;else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR){var a=n.asc_getSymbol();a?(this.bulletProps={symbol:a,font:n.asc_getFont()},this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font})||this.cmbBulletFormat.store.add({displayValue:this.txtSymbol+": ",value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font}))):this.cmbBulletFormat.setValue(""),this._changedProps=n,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP){var o=n.asc_getImageId();o?(this.imageProps={id:o,redraw:!0},this.cmbBulletFormat.store.findWhere({value:t.image})||this.cmbBulletFormat.store.add({displayValue:this.txtImage+":",value:t.image},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.image}))):this.cmbBulletFormat.setValue(""),this._changedProps=n,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM){var l=n.asc_getAutoNumType();this.cmbNumFormat.setValue(l,"");var r=n.asc_getNumStartAt();this.spnStart.setValue(r||"",!0),this.spnStart.setDisabled(null===r),this._changedProps=n,i=1}}else this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),this._changedProps=new Asc.asc_CBullet,i=this.type}1==i?this.btnNumbering.toggle(!0):this.btnBullet.toggle(!0),this.ShowHideElem(i)},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t){var i=e.replace(/ /g,"");_.isEmpty(i)||(new Asc.asc_CBullet).asc_putImageUrl(i)}}}).on("close",(function(){i.btnSelectImage.focus()})).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","bullet"):(new Asc.asc_CBullet).asc_showFileDialog()},txtTitle:"List Settings",txtSize:"Size",txtColor:"Color",txtOfText:"% of text",txtStart:"Start at",textBulleted:"Bulleted",textNumbering:"Numbered",txtType:"Type",txtNone:"None",txtNewBullet:"New bullet",txtSymbol:"Symbol",txtNewImage:"New image",txtImage:"Image",txtImport:"Import",textSelect:"Select From",textFromUrl:"From URL",textFromFile:"From File",textFromStorage:"From Storage"},Common.Views.ListSettingsDialog||{}))})),define("common/main/lib/view/DocumentPropertyDialog",[],(function(){"use strict";Common.Views.DocumentPropertyDialog=Common.UI.Window.extend(_.extend({options:{width:320,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,defaultValue:{}},t),this.template=['<div style="display: flex; flex-direction: column; margin: 0 20px;">','<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTitleLabel+"</label>",'<div id="id-dlg-title"></div>',"</div>",'<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTypeLabel+"</label>",'<div id="id-dlg-type"></div>',"</div>",'<div style="flex-shrink:0;">',"<label>"+this.txtPropertyValueLabel+"</label>",'<div id="id-dlg-value-input"></div>','<div id="id-dlg-value-date"></div>','<div id="id-dlg-value-boolean"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.asc2type=function(t){return t===AscCommon.c_oVariantTypes.vtLpwstr?"text":t===AscCommon.c_oVariantTypes.vtI4||t===AscCommon.c_oVariantTypes.vtR8?"number":t===AscCommon.c_oVariantTypes.vtBool?"boolean":t===AscCommon.c_oVariantTypes.vtFiletime?"date":void 0},Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.inputTitle=new Common.UI.InputField({el:$("#id-dlg-title"),allowBlank:!1,blankError:this.txtPropertyTitleBlankError,validateOnBlur:!1,hideErrorOnInput:!0,validation:function(e){if(void 0!==t.options.nameValidator)return t.options.nameValidator(e)}}),this.options.defaultValue.name&&this.inputTitle.setValue(this.options.defaultValue.name),this.comboboxType=new Common.UI.ComboBox({el:$("#id-dlg-type"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyTypeText,value:"text"},{displayValue:this.txtPropertyTypeNumber,value:"number"},{displayValue:this.txtPropertyTypeDate,value:"date"},{displayValue:this.txtPropertyTypeBoolean,value:"boolean"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0});var e=this.options.defaultValue.type?this.asc2type(this.options.defaultValue.type):"text";this.comboboxType.setValue(e),this.comboboxType.on("selected",_.bind((function(t,e){this.inputTextOrNumber.setVisible("text"===e.value||"number"===e.value),this.comboboxBoolean.setVisible("boolean"===e.value),this.datepicker.setVisible("date"===e.value)}),this)),this.inputTextOrNumber=new Common.UI.InputField({el:$("#id-dlg-value-input"),style:"width: 100%;",validateOnBlur:!1,hideErrorOnInput:!0,allowBlank:!1,blankError:this.txtPropertyValueBlankError,validation:function(t){return"number"!==this.comboboxType.getValue()||"number"==typeof t||!isNaN(t.replace(",","."))||this.txtPropertyTypeNumberInvalid}.bind(this)}),!this.options.defaultValue.value||"text"!==e&&"number"!==e||this.inputTextOrNumber.setValue(this.options.defaultValue.value),this.inputTextOrNumber.setVisible(this.options.defaultValue.type?this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtFiletime&&this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtBool:"text"===e||"number"===e),this.comboboxBoolean=new Common.UI.ComboBox({el:$("#id-dlg-value-boolean"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyBooleanTrue,value:1},{displayValue:this.txtPropertyBooleanFalse,value:0}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0}),this.comboboxBoolean.setValue(void 0!==this.options.defaultValue.value&&"boolean"===e?this.options.defaultValue.value?1:0:1),this.comboboxBoolean.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtBool:"boolean"===e),this.datepicker=new Common.UI.InputFieldBtnCalendar({el:$("#id-dlg-value-date"),allowBlank:!1,blankError:this.txtPropertyValueBlankError,validateOnBlur:!1,value:"",hideErrorOnInput:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.options.defaultValue.value&&"date"===e&&(this.datepicker.setDate(this.options.defaultValue.value),this.datepicker.setValue(this.dateToString(this.options.defaultValue.value))),this.datepicker.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtFiletime:"date"===e),this.datepicker.on("date:click",function(t,e){t.setValue(this.dateToString(e))}.bind(this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputTitle,this.comboboxType,this.inputTextOrNumber,this.comboboxBoolean,this.datepicker].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputTitle},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.inputTitle.focus()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler&&"ok"===t){if(!0!==this.inputTitle.checkValidate())return void this.inputTitle.focus();var e,i,n=this.inputTitle.getValue(),s=this.comboboxType.getValue();if("boolean"===s)e=1===this.comboboxBoolean.getValue(),i=AscCommon.c_oVariantTypes.vtBool;else if("date"===s){if(!0!==this.datepicker.checkValidate())return void this.datepicker.focus();if((e=this.datepicker.getDate())||(e=new Date(this.datepicker.getValue()))&&e instanceof Date&&!isNaN(e)||(e=void 0),!e){var a=this;return void Common.UI.warning({msg:a.errorDate,buttons:["ok","cancel"],callback:function(e){"ok"===e?(a.options.handler.call(this,t,n,AscCommon.c_oVariantTypes.vtLpwstr,a.datepicker.getValue()),a.close()):a.datepicker.focus()}})}i=AscCommon.c_oVariantTypes.vtFiletime}else{if(!0!==this.inputTextOrNumber.checkValidate())return void this.inputTextOrNumber.focus();var o=this.inputTextOrNumber.getValue();"text"===s?(i=AscCommon.c_oVariantTypes.vtLpwstr,e=o):("number"!=typeof o&&(o=o.replace(",",".")),o%1==0?(i=AscCommon.c_oVariantTypes.vtI4,e=parseInt(o)):(i=AscCommon.c_oVariantTypes.vtR8,e=parseFloat(o)))}this.options.handler.call(this,t,n,i,e)}this.close()},dateToString:function(t){var e="";if(t){t=new Date(t);var i=(this.options.lang||"en").replace("_","-").toLowerCase();try{i=="ar-SA".toLowerCase()&&(i+="-u-nu-latn-ca-gregory"),e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}catch(n){i="en",e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}}return e},txtTitle:"New Document Property",txtPropertyTitleLabel:"Title",txtPropertyTitleBlankError:"Property should have a title",txtPropertyTypeLabel:"Type",txtPropertyValueLabel:"Value",txtPropertyValueBlankError:"Property should have a value",txtPropertyTypeText:"Text",txtPropertyTypeNumber:"Number",txtPropertyTypeNumberInvalid:"Provide a valid number",txtPropertyTypeDate:"Date",txtPropertyTypeBoolean:'"Yes" or "no"',txtPropertyBooleanTrue:"Yes",txtPropertyBooleanFalse:"No",errorDate:"You can choose a value from the calendar to store the value as Date.<br>If you enter a value manually, it will be stored as Text."},Common.Views.DocumentPropertyDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/MacrosDialog",[],(function(){"use strict";Common.Views.MacrosDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=Math.max(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top"),350),n=Math.max(Common.Utils.innerWidth(),600);_.extend(e,{id:"macros-dialog",title:this.textTitle,header:!0,help:!0,width:Math.min(810,n),height:Math.min(512,i),minwidth:750,minheight:350,resizable:!0,cls:"modal-dlg invisible-borders",buttons:[{value:"ok",caption:this.textSave},"cancel"]},t||{}),this.api=t.api,this.ItemTypes={CustomFunction:0,Macros:1},this._state={isFunctionsSupport:!!window.SSE,selectedItem:{record:null,type:null},currentValue:"",currentPos:{row:3,column:0}},this.template=['<div id="macros-dialog-content"><div id="macros-dialog-left" class="noselect"><div id="macros-menu" <% if(!isFunctionsSupport){%> style="height: 100%;" <% } %>><div class="menu-header"><label>'+this.textMacros+'</label><div id="btn-ai-macros-add"></div><div id="btn-macros-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-list"></div></div><div class="separator horizontal" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ></div><div id="functions-menu" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ><div class="menu-header"><label id="macros-dialog-functions-label">'+this.textCustomFunctions+'</label><div id="btn-function-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="functions-list"></div></div></div><div class="separator vertical" style="position: relative"></div><div id="macros-dialog-right"><div class="menu-header"><div id="btn-macros-undo"></div><div id="btn-macros-redo"></div><div id="btn-macros-run" class="lock-for-function"></div><div id="btn-macros-debug" class="lock-for-function"></div><div id="btn-macros-copy"></div><div id="btn-macros-rename"></div><div id="btn-macros-delete"></div><div id="ch-macros-autostart" class="lock-for-function"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-code-editor" class="invisible"></div></div></div><div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)({isFunctionsSupport:this._state.isFunctionsSupport}),this.on({help:this.onHelp,drag:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])},resize:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])}}),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.aceContainer=e.find("#macros-code-editor"),t.createCodeEditor(),t.renderAfterAceLoaded(),t.calcHeaderBreakpoints(),t.collapseHeaderItems(),t.updateCustomFunctionLabel();var i=_.throttle(_.bind(this.collapseHeaderItems,this),100);this.on("resizing",(function(){i()}))},renderAfterAceLoaded:function(){this.btnUndo=new Common.UI.Button({parentEl:$("#btn-macros-undo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo icon-rtl",hint:this.tipUndo}).on("click",_.bind(this.onUndo,this)),this.btnRedo=new Common.UI.Button({parentEl:$("#btn-macros-redo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo icon-rtl",hint:this.tipRedo}).on("click",_.bind(this.onRedo,this)),this.btnRun=new Common.UI.Button({parentEl:$("#btn-macros-run"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-run",caption:this.textRun,hint:this.tipMacrosRun}).on("click",_.bind(this.onRunMacros,this,!1)),this.btnDebug=new Common.UI.Button({parentEl:$("#btn-macros-debug"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-debug",caption:this.textDebug,hint:this.tipMacrosDebug}).on("click",_.bind(this.onRunMacros,this,!0)),this.btnCopy=new Common.UI.Button({parentEl:$("#btn-macros-copy"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",caption:this.textCopy,hint:this.tipMacrosCopy}).on("click",_.bind(this.onCopyItem,this)),this.btnRename=new Common.UI.Button({parentEl:$("#btn-macros-rename"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rename",caption:this.textRename,hint:this.tipMacrosRename}).on("click",_.bind(this.onRenameItem,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#btn-macros-delete"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",caption:this.textDelete,hint:this.tipMacrosDelete}).on("click",_.bind(this.onDeleteItem,this)),this.chAutostart=new Common.UI.CheckBox({el:$("#ch-macros-autostart"),labelText:this.textAutostart}).on("change",_.bind(this.onChangeAutostart,this));var t=this.api.checkAI();this.btnAiMacrosAdd=new Common.UI.Button({parentEl:$("#btn-ai-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-general-ai",menu:new Common.UI.Menu({additionalAlign:this.menuAddAlign,items:[{caption:this.textCreateFromDesc,value:"create",disabled:!t},{caption:this.textConvertFromVBA,value:"convert",disabled:!t}]}),hint:this.tipAi}),this.btnAiMacrosAdd.menu.on("item:click",_.bind(this.onAiMenu,this)),this.btnMacrosAdd=new Common.UI.Button({parentEl:$("#btn-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipMacrosAdd}).on("click",_.bind(this.onCreateMacros,this,"")),this.listMacros=new Common.UI.ListView({el:$("#macros-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,itemTemplate:_.template(['<div class="listitem-autostart">',"<% if (autostart) { %>","<span>(A)</span>","<% } %>","</div>",'<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listMacros.on("item:add",_.bind(this.onAddListItem,this)),this.listMacros.on("item:select",_.bind(this.onSelectListMacrosItem,this)),this.setListMacros(),this._state.isFunctionsSupport&&(this.btnFunctionAdd=new Common.UI.Button({parentEl:$("#btn-function-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipFunctionAdd}).on("click",_.bind(this.onCreateFunction,this)),this.listFunctions=new Common.UI.ListView({el:$("#functions-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template(['<div class="listitem-autostart"></div>','<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listFunctions.on("item:add",_.bind(this.onAddListItem,this)),this.listFunctions.on("item:select",_.bind(this.onSelectListFunctionItem,this)),this.setListFunctions()),this.makeDragable()},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-code-editor"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue(t._state.currentValue,t._state.currentPos),setTimeout((function(){t.aceContainer.removeClass("invisible")}),10)})),this.codeEditor.on("change",(function(e,i){t._state.selectedItem.record&&(t._state.currentValue=e,t._state.currentPos=i,t._state.selectedItem.record.set("value",e),t._state.selectedItem.record.set("currentPos",i))}))},calcHeaderBreakpoints:function(){this.breakpoints=[];var t=this,e=10,i=[{btn:this.btnUndo,collapsible:!1},{btn:this.btnRedo,collapsible:!1},{btn:this.btnRun,collapsible:!0},{btn:this.btnDebug,collapsible:!0},{btn:this.btnCopy,collapsible:!0},{btn:this.btnRename,collapsible:!0},{btn:this.btnDelete,collapsible:!0},{btn:this.chAutostart,collapsible:!1,withoutMargin:!0}];this.collapsibleHeaderItems=i.filter((function(t){return t.collapsible})),i.forEach((function(t){var i=t.btn.$el.find(".caption"),n=i.hasClass("hide");i.removeClass("hide"),t.expandedWidth=t.btn.$el.outerWidth(!t.withoutMargin),t.collapsedWidth=t.collapsible?t.expandedWidth-i.outerWidth(!0):t.expandedWidth,e+=t.expandedWidth,n&&i.addClass("hide")})),this.collapsibleHeaderItems.forEach((function(i,n){if(0==n)t.breakpoints.push({width:e,collapseItems:[i]});else{var s=t.breakpoints[n-1],a=t.collapsibleHeaderItems[n-1];t.breakpoints.push({width:s.width-(a.expandedWidth-a.collapsedWidth),collapseItems:[i].concat(s.collapseItems)})}}))},collapseHeaderItems:function(){var t=this.getChild().find("#macros-dialog-right .menu-header").width(),e=null;for(let i=this.breakpoints.length-1;i>=0;i--)if(t<this.breakpoints[i].width){e=this.breakpoints[i];break}this.collapsibleHeaderItems.forEach((function(t){var i=e&&-1!==e.collapseItems.indexOf(t);t.btn.$el.find(".caption").toggleClass("hide",!!i)}))},updateCustomFunctionLabel:function(){var t=this.getChild(),e=t.find("#macros-dialog-left"),i=t.find("#functions-menu .menu-header"),n=t.find("#btn-function-add"),s=t.find("#macros-dialog-functions-label"),a=(parseFloat(e.css("min-width"))||0)-((parseFloat(i.css("padding-left"))||0)+(parseFloat(i.css("padding-right"))||0))-(n.outerWidth(!0)||0);s.width()>a&&s.text(this.textFunctions)},setListMacros:function(){var t=this,e=this.parseDataFromApi(this.api.pluginMethod_GetMacros()),i=e.macrosArray,n=this.api.pluginMethod_GetVBAMacros();n&&"string"==typeof n&&n.includes("<Module")&&n.split("<Module ").filter((function(t){return t.includes('Type="Procedural"')||t.includes('Type="Class"')})).forEach((function(e){var n=e.indexOf("<SourceCode>")+12,s=e.indexOf("</SourceCode>",n),a=e.slice(n,s);n=e.indexOf('Name="')+6,s=e.indexOf('"',n);var o=e.slice(n,s);-1==i.findIndex((function(t){return t.name==o}))&&(a=(a=(a=(a=(a=(a=a.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')).replace(/Attribute [^\r\n]*\r\n/g,""),i.push({guid:t.createGuid(),name:o,autostart:!1,value:"(function()\n{\n\t/* Enter your code here. */\n})();\n\n/*\nExecution of VBA commands does not support.\n"+a+"*/"}))}));if(i.length>0){i.forEach((function(t){t.autostart=!!t.autostart,t.currentPos={row:3,column:0}})),this.listMacros.store.reset(i);var s=this.listMacros.store.at(e.current);s&&this.listMacros.selectRecord(s)}else this.onCreateMacros()},setListFunctions:function(){var t=this.parseDataFromApi(this.api.pluginMethod_GetCustomFunctions()).macrosArray;this.listFunctions.store.reset(t)},makeDragable:function(){var t,e,i=this,n=0,s=document.getElementById("macros-list"),a=document.getElementById("functions-list");function o(t,e){i.codeEditor.disableDrop(!0);var s=$(e.target).children(".list-item").attr("id");e.dataTransfer.setData("text/plain",s),e.dataTransfer.effectAllowed="move",e.target.classList.add("dragged"),n=t.store.indexOf(t.store.findWhere({id:s})),e.target.click()}function l(t,s){if(i.codeEditor.disableDrop(!1),s.target.classList.remove("dragged"),$(".dragHovered").removeClass("dragHovered"),n===e||null==e)return;-1===e&&(e=t.store.length),n<e&&e--;var a=t.store.models.slice();let o=a.splice(n,1)[0];a.splice(e,0,o),t.store.reset(a),n=0}function r(n,s,a){a.preventDefault(),t=a.target;let o=i._state.selectedItem.type===s;a.dataTransfer.dropEffect=o?"move":"none";t.classList.contains("draggable")&&o&&(e=function(t,e,i){var n=i.index(e),s=Common.Utils.getBoundingClientRect(e);return t>s.y+.45*s.height&&(n+=1),n}(a.clientY,t,$(n).find(".item")),$(".dragHovered").removeClass("dragHovered"),e<$(n).find(".item").length?($(n).find(".item").last().removeClass(["dragHovered","last"]),$(n).find(".item")[e].classList.add("dragHovered")):$(n).find(".item").last().addClass(["dragHovered","last"]))}function c(t){if(t.fromElement){if("list"==$(t.fromElement).attr("role")||"listitem"==$(t.fromElement).attr("role")||$(t.fromElement).parents('[role="listitem"]').length)return;$(".dragHovered").removeClass("dragHovered"),e=null}}s.addEventListener("dragstart",(function(t){o(i.listMacros,t)})),a.addEventListener("dragstart",(function(t){o(i.listFunctions,t)})),s.addEventListener("dragend",(function(t){l(i.listMacros,t)})),a.addEventListener("dragend",(function(t){l(i.listFunctions,t)})),s.addEventListener("dragover",(function(t){r(s,i.ItemTypes.Macros,t)})),a.addEventListener("dragover",(function(t){r(a,i.ItemTypes.CustomFunction,t)})),s.addEventListener("dragleave",(function(t){c(t)})),a.addEventListener("dragleave",(function(t){c(t)}))},selectItem:function(t,e){this._state.selectedItem.record=t,this._state.selectedItem.type=e,this.codeEditor.setValue(t.get("value"),void 0!==t.get("currentPos")?t.get("currentPos"):{row:3,column:0}),this.codeEditor.revealPositionInCenter(),this._state.currentValue=t.get("value"),this._state.currentPos=t.get("currentPos"),this.chAutostart.setValue(t.get("autostart")),this.getChild().find(".lock-for-function").toggleClass("hidden",e==this.ItemTypes.CustomFunction),e==this.ItemTypes.Macros&&this.listFunctions&&this.listFunctions.deselectAll(),e==this.ItemTypes.CustomFunction&&this.listMacros&&this.listMacros.deselectAll(),this.updateHintButtons(),this.setDisableButtons(!1)},updateHintButtons:function(){var t=this._state.selectedItem.type==this.ItemTypes.Macros?"Macros":"Function";this.btnCopy.updateHint(this["tip"+t+"Copy"]),this.btnRename.updateHint(this["tip"+t+"Rename"]),this.btnDelete.updateHint(this["tip"+t+"Delete"])},setDisableButtons:function(t){this.btnUndo.setDisabled(t),this.btnRedo.setDisabled(t),this.btnRun.setDisabled(t),this.btnDebug.setDisabled(t),this.btnCopy.setDisabled(t),this.btnRename.setDisabled(t),this.btnDelete.setDisabled(t),this.chAutostart.setDisabled(t)},parseDataFromApi:function(t){var e={macrosArray:[],current:-1};if(t)try{e=JSON.parse(t)}catch(t){e={macrosArray:[],current:-1}}return e},createGuid:function(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"");return e},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){},close:function(t){this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),"ok"===t&&(this.api.pluginMethod_SetMacros(JSON.stringify({macrosArray:this.listMacros.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),autostart:t.get("autostart"),value:t.get("value")}})),current:this.listMacros.store.indexOf(this.listMacros.getSelectedRec())})),this._state.isFunctionsSupport&&this.api.pluginMethod_SetCustomFunctions(JSON.stringify({macrosArray:this.listFunctions.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),value:t.get("value")}}))}))),this.close()},onAddListItem:function(t,e){e.$el.attr("draggable",!0),e.$el.addClass("draggable")},onCopyItem:function(){if(!this._state.selectedItem.record)return;let t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record;t.store.add({guid:this.createGuid(),name:e.get("name")+"_copy",value:e.get("value"),autostart:e.get("autostart")}),t.selectRecord(t.store.at(-1))},onRenameItem:function(){if(this._state.selectedItem.record){var t=this,e=300,i=90,n=Common.Utils.getBoundingClientRect(this.$window[0]);new Common.Views.TextInputDialog({value:t._state.selectedItem.record.get("name"),width:e,height:i,inputConfig:{allowBlank:!1,validation:function(t){return t.trim().length>0||""}},handler:function(e,i){"ok"==e&&t._state.selectedItem.record.set("name",i.trim())}}).show(n.left+(n.width-e)/2,n.top+(n.height-i)/2)}},onCreateMacros:function(t){var e=0,i="Macro",n=this.textMacro;this.listMacros.store.each((function(t,s){var a=t.get("name");if(0==a.indexOf(i)){s=parseInt(a.substr(5));!isNaN(s)&&e<s&&(e=s)}else if(0==a.indexOf(n)){s=parseInt(a.substr(n.length));!isNaN(s)&&e<s&&(e=s)}})),e++,this.listMacros.store.add({guid:this.createGuid(),name:n+" "+e,value:t||"(function()\n{\n    \n})();",autostart:!1,currentPos:{row:3,column:5}}),this.listMacros.selectRecord(this.listMacros.store.at(-1))},onSelectListMacrosItem:function(t,e,i){this.selectItem(i,this.ItemTypes.Macros)},onUndo:function(){this.codeEditor.undo()},onRedo:function(){this.codeEditor.redo()},onAiMenu:function(t,e){var i=this,n="",s="",a="Generate JavaScript code as an Immediately Invoked Function Expression (IIFE), in the format (function(){ ... })();, that [describe what the code should do]. The code should be self-contained and execute immediately. ",o=Common.Locale.getCurrentLanguage(),l=Common.util.LanguageInfo.getLocalLanguageName(Common.util.LanguageInfo.getLocalLanguageCode(o));l=l&&"string"==typeof l[1]?l[1]:null;var r="Document Editor";(window.PE&&(r="Presentation Editor"),window.SSE&&(r="Spreadsheet Editor"),"create"==e.value?(n=this.textCreateMacrosFromDesc,s="Create a macro for OnlyOffice. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The format of the code is JavaScript. Write comments in the same language as the user prompt. The description of what the macro should do is also described in the user message. "+a):"convert"==e.value&&(n=this.textConvertMacrosFromVBA,s="Convert macro for OnlyOffice from VBA. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The code format is JavaScript. Write comments in "+o+(l?"("+l+")":"")+" language. The code of the macro in VBA should be presented in the user message. "+a),"create"==e.value||"convert"==e.value)&&new Common.Views.MacrosAiDialog({title:n,api:this.api,instruction:s,inputType:"create"==e.value?"textarea":"codeEditor",handler:function(t,e){"ok"==t&&i.onCreateMacros(e)}}).show()},onRunMacros:function(t){this.api.callCommand(t?"debugger;\n"+this._state.currentValue:this._state.currentValue)},onChangeAutostart:function(t,e){this._state.selectedItem.record&&this._state.selectedItem.record.set("autostart","checked"==e)},onDeleteItem:function(){if(!this._state.selectedItem.record)return;let t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record;var i=t.store.indexOf(e);if(t.store.remove(e),t.store.length>0){var n=i<t.store.length?i:t.store.length-1;t.selectByIndex(n)}else this.codeEditor.setValue("",{row:0,column:0},!0),this.setDisableButtons(!0)},onCreateFunction:function(){var t=0,e=this.textCustomFunction;this.listFunctions.store.each((function(i,n){var s=i.get("name");if(0==s.indexOf("Custom function")){n=parseInt(s.substr(15));!isNaN(n)&&t<n&&(t=n)}else if(0==s.indexOf(e)){n=parseInt(s.substr(e.length));!isNaN(n)&&t<n&&(t=n)}})),t++,this.listFunctions.store.add({guid:this.createGuid(),name:e+" "+t,value:"(function()\n{\n\t/**\n\t * Function that returns the argument\n\t * @customfunction\n\t * @param {any} arg Any data.\n     * @returns {any} The argumet of the function.\n\t*/\n\tfunction myFunction(arg) {\n\t\t\n\t    return arg;\n\t}\n\tApi.AddCustomFunction(myFunction);\n})();",currentPos:{row:10,column:3}}),this.listFunctions.selectRecord(this.listFunctions.store.at(-1))},onSelectListFunctionItem:function(t,e,i){this.selectItem(i,this.ItemTypes.CustomFunction)},onThemeChanged:function(){this.calcHeaderBreakpoints(),this.collapseHeaderItems(),Common.UI.Window.prototype.onThemeChanged.call(this)},onHelp:function(){window.open("https://api.onlyoffice.com/docs/plugin-and-macros/macros/getting-started/","_blank")},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},textTitle:"Macros",textSave:"Save",textMacro:"Macro",textMacros:"Macros",textRun:"Run",textDebug:"Debug",textAutostart:"Autostart",textRename:"Rename",textDelete:"Delete",textCopy:"Copy",textCustomFunction:"Custom function",textCustomFunctions:"Custom functions",textFunctions:"Functions",textLoading:"Loading...",textCreateFromDesc:"Create from description",textCreateMacrosFromDesc:"Create macros from description",textConvertFromVBA:"Convert from VBA",textConvertMacrosFromVBA:"Convert macros from VBA",tipUndo:"Undo",tipRedo:"Redo",tipMacrosRename:"Rename macros",tipMacrosDelete:"Delete macros",tipMacrosCopy:"Copy macros",tipMacrosRun:"Run macros",tipMacrosDebug:"Debug macros",tipMacrosAdd:"Add macros",tipFunctionRename:"Rename custom function",tipFunctionDelete:"Delete custom function",tipFunctionCopy:"Copy custom function",tipFunctionAdd:"Add custom function",tipAi:"AI"},Common.Views.MacrosDialog||{}))})),define("common/main/lib/view/MacrosAiDialog",[],(function(){"use strict";Common.Views.MacrosAiDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i={width:{init:400,min:400,max:800},height:{init:200,min:200,max:400}},n="modal-dlg invisible-borders";"codeEditor"==t.inputType&&(i={width:{init:600,min:600,max:1e3},height:{init:400,min:400,max:600}},n+=" padding-none"),_.extend(e,{id:"macros-ai-dialog",title:t.title,width:i.width.init,height:i.height.init,minwidth:i.width.min,minheight:i.height.min,maxwidth:i.width.max,maxheight:i.height.max,resizable:!0,cls:n,buttons:[{caption:this.textCreate,value:"ok",primary:!0},"cancel"]},t||{}),this.api=t.api,this.instruction=t.instruction,this.inputType=t.inputType||"textarea",this._state={codeEditorValue:""},"textarea"==this.inputType?this.template=['<div class="box">','<div id="macros-ai-dialog-textarea"></div>',"</div>"].join(""):this.template=['<div id="macros-ai-dialog-code-editor"></div>','<div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();"textarea"==this.inputType?this.textareaPrompt=new Common.UI.TextareaField({el:t.find("#macros-ai-dialog-textarea"),placeHolder:this.textAreaPlaceholder}):this.createCodeEditor(),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-ai-dialog-code-editor",language:"vba"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue("",{row:0,column:0})})),this.codeEditor.on("change",(function(e,i){t._state.codeEditorValue=e}))},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},show:function(){if(Common.UI.Window.prototype.show.apply(this,arguments),this.textareaPrompt){var t=this;_.delay((function(){t.textareaPrompt.focus()}),50)}},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},close:function(t){this.codeEditor&&this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){if(this.options.handler)if("ok"==t){var e=this,i="textarea"==this.inputType?this.textareaPrompt.getValue():this._state.codeEditorValue;e.api.AI({type:"text",data:[{role:"system",content:this.instruction},{role:"user",content:i}]},(function(i){if(i.error){if("no-engine"===i.type)return e._handleInput("cancel");console.log(i.error)}else{if(!i||!i.text)return e._handleInput("cancel");function s(t,e,i){let n=e||0;if(-1!=n){let e=['"',"'","\n","\r"];for(!0===i&&e.push(" ");n<t.length&&e.includes(t[n]);)n++;let s=t.length-1;for(;s>0&&e.includes(t[s]);)s--;if(s>n)return t.substring(n,s+1)}return t}var n=i.text.replace(/```javascript|```/g,"");n=s(n,0,!0),e.close(),e.options.handler.call(e,t,n)}}))}else this.close(),this.options.handler.call(this,t)},textCreate:"Create",textAreaPlaceholder:"Input a prompt for the query"},Common.Views.MacrosAiDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/component/MonacoEditor",[],(function(){"use strict";Common.UI.MonacoEditor=Common.UI.BaseView.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=_.uniqueId(),this.parentEl=t.parentEl,this.language=t.language||"javascript",this.parentEl&&this.render(this.parentEl)},render:function(t){this.parentEl="string"==typeof t?$(t):t,this.iframe=document.createElement("iframe"),this.iframe.width="100%",this.iframe.height="100%",this.iframe.align="top",this.iframe.frameBorder=0,this.iframe.scrolling="no",this.iframe.onload=_.bind(this._onLoad,this),this.parentEl.append(this.iframe),this.loadMask=new Common.UI.LoadMask({owner:this.parentEl}),this.loadMask.show();var e="../../../vendor/monaco/MonacoEditor.html";e+="?editorType="+(window.SSE?"cell":window.PE?"slide":"word"),e+="&language="+this.language,e+="&id="+this.id,this.iframe.src=e;var i=this;this._eventfunc=function(t){i._onMessage(t)},this._updatebind=function(){i.updateTheme()},this._bindWindowEvents.call(this)},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc),Common.NotificationCenter.on("uitheme:changed",this._updatebind)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc),Common.NotificationCenter.off("uitheme:changed",this._updatebind)},_postMessage:function(t,e){t&&t.postMessage&&window.JSON&&(e.referer="monaco-editor-"+this.id,t.postMessage(window.JSON.stringify(e),"*"))},_onMessage:function(t){var e=t.data;if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var i;try{i=window.JSON.parse(e)}catch(t){i=""}if(i&&i.referer=="monaco-editor-"+this.id)switch(i.command){case"changeValue":e=i.data||{},this.fireEvent("change",e.value,e.pos);break;case"monacoEditorReady":this.fireEvent("ready",i.data)}}},_onLoad:function(){this.updateTheme(),this.loadMask&&this.loadMask.hide()},setValue:function(t,e,i){this._postMessage(this.iframe.contentWindow,{command:"setValue",data:{value:t,readonly:i,currentPos:e}})},updateTheme:function(){this._postMessage(this.iframe.contentWindow,{command:"setTheme",data:Common.UI.Themes.getThemeColors()})},disableDrop:function(t){this._postMessage(this.iframe.contentWindow,{command:"disableDrop",data:t})},revealPositionInCenter:function(){this._postMessage(this.iframe.contentWindow,{command:"revealPositionInCenter",data:{}})},undo:function(){this._postMessage(this.iframe.contentWindow,{command:"undo",data:{}})},redo:function(){this._postMessage(this.iframe.contentWindow,{command:"redo",data:{}})},enablePointerEvents:function(t){this.iframe&&(this.iframe.style.pointerEvents=t?"":"none")},destroyEditor:function(){this._unbindWindowEvents()}})})),void 0===Common)Common={};if(define("common/main/lib/component/TextareaField",[],(function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;this.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.value=e.options.value,this.placeHolder=e.options.placeHolder,this.template=e.options.template||e.template,this.disabled=e.options.disabled,this.spellcheck=e.options.spellcheck,this.maxLength=e.options.maxLength,e.rendered=e.options.rendered||!1,e.options.el&&e.render()},render:function(t){var e=this;return e.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:e})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),e.rendered||(this.cmpEl,this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)),e.rendered=!0,e.value&&e.setValue(e.value),this},_doChange:function(t,e){if(!e||!e.synthetic){var i=$(t.target).val(),n=this.value;this.trigger("changed:before",this,i,n,t),t.isDefaultPrevented()||(this.value=i,this.trigger("changed:after",this,i,n,t))}},onInputChanged:function(t,e){this._doChange(t,e)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}})})),define("presentationeditor/main/app/controller/DocumentHolderExt",[],(function(){"use strict";if(window.PE&&window.PE.Controllers&&window.PE.Controllers.DocumentHolder){let t=window.PE.Controllers.DocumentHolder.prototype;t.setEvents=function(){var t=this;this.addListeners({DocumentHolder:{createdelayedelements:this.createDelayedElements,"equation:callback":this.equationCallback,"layout:change":this.onLayoutChange,"theme:change":this.onThemeChange}}),t.api&&(t.api.asc_registerCallback("asc_onContextMenu",_.bind(t.onContextMenu,t)),t.api.asc_registerCallback("asc_onMouseMoveStart",_.bind(t.onMouseMoveStart,t)),t.api.asc_registerCallback("asc_onMouseMoveEnd",_.bind(t.onMouseMoveEnd,t)),t.api.asc_registerCallback("asc_onPaintSlideNum",_.bind(t.onPaintSlideNum,t)),t.api.asc_registerCallback("asc_onEndPaintSlideNum",_.bind(t.onEndPaintSlideNum,t)),t.api.asc_registerCallback("asc_onCurrentPage",_.bind(t.onApiCurrentPages,t)),t.documentHolder.slidesCount=t.api.getCountPages(),t.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(t.onHyperlinkClick,t)),t.api.asc_registerCallback("asc_onMouseMove",_.bind(t.onMouseMove,t)),!0===t.mode.isEdit&&(t.api.asc_registerCallback("asc_onDialogAddHyperlink",_.bind(t.onDialogAddHyperlink,t)),t.api.asc_registerCallback("asc_doubleClickOnChart",_.bind(t.editChartClick,t)),t.api.asc_registerCallback("asc_doubleClickOnTableOleObject",_.bind(t.onDoubleClickOnTableOleObject,t)),t.api.asc_registerCallback("asc_onSpellCheckVariantsFound",_.bind(t.onSpellCheckVariantsFound,t)),t.api.asc_registerCallback("asc_onShowSpecialPasteOptions",_.bind(t.onShowSpecialPasteOptions,t)),t.api.asc_registerCallback("asc_onHideSpecialPasteOptions",_.bind(t.onHideSpecialPasteOptions,t)),t.api.asc_registerCallback("asc_ChangeCropState",_.bind(t.onChangeCropState,t)),t.api.asc_registerCallback("asc_onHidePlaceholderActions",_.bind(t.onHidePlaceholderActions,t)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(t.onInsertImage,t,!0)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(t.onInsertImageUrl,t,!0)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Chart,_.bind(t.onClickPlaceholderChart,t)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Table,_.bind(t.onClickPlaceholderTable,t)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Video,_.bind(t.onClickPlaceholder,t,AscCommon.PlaceholderButtonType.Video)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Audio,_.bind(t.onClickPlaceholder,t,AscCommon.PlaceholderButtonType.Audio)),t.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.SmartArt,_.bind(t.onClickPlaceholderSmartArt,t)),t.api.asc_registerCallback("asc_onTrackGuide",_.bind(t.onTrackGuide,t)),t.api.asc_registerCallback("asc_onShowMathTrack",_.bind(t.onShowMathTrack,t)),t.api.asc_registerCallback("asc_onHideMathTrack",_.bind(t.onHideMathTrack,t)),t.api.asc_registerCallback("asc_onLockViewProps",_.bind(t.onLockViewProps,t,!0)),t.api.asc_registerCallback("asc_onUnLockViewProps",_.bind(t.onLockViewProps,t,!1)),t.api.asc_registerCallback("asc_onHideEyedropper",_.bind(t.hideEyedropper,t)),t.api.asc_SetMathInputType(Common.localStorage.getBool("pe-equation-input-latex")?Asc.c_oAscMathInputType.LaTeX:Asc.c_oAscMathInputType.Unicode),t.api.asc_registerCallback("asc_onRemoveUnpreserveMasters",_.bind(t.onRemoveUnpreserveMasters,t))),t.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(t.onShowForeignCursorLabel,t)),t.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(t.onHideForeignCursorLabel,t)),t.api.asc_registerCallback("asc_onFocusObject",_.bind(t.onFocusObject,t)),t.api.asc_registerCallback("onPluginContextMenu",_.bind(t.onPluginContextMenu,t)))},t.initExternalEditors=function(){var t=this,e=this.getApplication().getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");e&&(e.on("internalmessage",_.bind((function(t,i){i.data.command;var n=i.data.data;this.api&&(e.isEditMode()?this.api.asc_editChartDrawingObject(n):this.api.asc_addChartDrawingObject(n,e.getPlaceholder()))}),this)),e.on("hide",_.bind((function(e,i){this.api&&(this.api.asc_onCloseChartFrame(),this.api.asc_enableKeyEvents(!0)),setTimeout((function(){t.editComplete()}),10)}),this)));var i=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");i&&(i.on("internalmessage",_.bind((function(t,e){e.data.command;var n=e.data.data;this.api&&(i.isEditMode()?this.api.asc_editTableOleObject(n):this.api.asc_addTableOleObject(n))}),this)),i.on("hide",_.bind((function(e,i){this.api&&(this.api.asc_enableKeyEvents(!0),this.api.asc_onCloseChartFrame()),setTimeout((function(){t.editComplete()}),10)}),this)))},t.createDelayedElements=function(t,e){var i=this;t=i.documentHolder;if("view"==e)return t.menuViewCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuViewAddComment.on("click",_.bind(i.addComment,i)),t.menuViewUndo.on("click",_.bind(i.onUndo,i)),t.mnuPreview.on("click",_.bind(i.onPreview,i)),t.mnuSelectAll.on("click",_.bind(i.onSelectAll,i)),void t.mnuPrintSelection.on("click",_.bind(i.onPrintSelection,i));t.menuEditObject.on("click",_.bind(i.onEditObject,i)),t.menuSlidePaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuParaCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgPaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuImgCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCopy.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTablePaste.on("click",_.bind(i.onCutCopyPaste,i)),t.menuTableCut.on("click",_.bind(i.onCutCopyPaste,i)),t.menuAddHyperlinkPara.on("click",_.bind(i.addHyperlink,i)),t.menuAddHyperlinkTable.on("click",_.bind(i.addHyperlink,i)),t.menuEditHyperlinkPara.on("click",_.bind(i.editHyperlink,i)),t.menuEditHyperlinkTable.on("click",_.bind(i.editHyperlink,i)),t.menuRemoveHyperlinkPara.on("click",_.bind(i.removeHyperlink,i)),t.menuRemoveHyperlinkTable.on("click",_.bind(i.removeHyperlink,i)),t.menuChartEdit.on("click",_.bind(i.editChartClick,i,void 0)),t.menuImgSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),t.menuTableSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),t.menuAddCommentPara.on("click",_.bind(i.addComment,i)),t.menuAddCommentTable.on("click",_.bind(i.addComment,i)),t.menuAddCommentImg.on("click",_.bind(i.addComment,i)),t.menuImgReplace.menu.on("item:click",_.bind(i.onImgReplace,i)),t.langParaMenu.menu.on("item:click",_.bind(i.onLangMenu,i,"para")),t.langTableMenu.menu.on("item:click",_.bind(i.onLangMenu,i,"table")),t.mnuPreview.on("click",_.bind(i.onPreview,i)),t.mnuSelectAll.on("click",_.bind(i.onSelectAll,i)),t.mnuPrintSelection.on("click",_.bind(i.onPrintSelection,i)),t.mnuNewSlide.on("click",_.bind(i.onNewSlide,i)),t.mnuDuplicateSlide.on("click",_.bind(i.onDuplicateSlide,i)),t.mnuDeleteSlide.on("click",_.bind(i.onDeleteSlide,i)),t.mnuResetSlide.on("click",_.bind(i.onResetSlide,i)),t.mnuMoveSlideToStart.on("click",_.bind(i.onMoveSlideToStart,i)),t.mnuMoveSlideToEnd.on("click",_.bind(i.onMoveSlideToEnd,i)),t.menuSlideSettings.on("click",_.bind(i.onSlideSettings,i)),t.mnuSlideHide.on("click",_.bind(i.onSlideHide,i)),t.mnuTableMerge.on("click",_.bind(i.onTableMerge,i)),t.mnuTableSplit.on("click",_.bind(i.onTableSplit,i)),t.menuTableCellAlign.menu.on("item:click",_.bind(i.tableCellsVAlign,i)),t.menuTableDistRows.on("click",_.bind(i.onTableDistRows,i)),t.menuTableDistCols.on("click",_.bind(i.onTableDistCols,i)),t.menuIgnoreSpellTable.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreSpellPara.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreAllSpellTable.on("click",_.bind(i.onIgnoreSpell,i)),t.menuIgnoreAllSpellPara.on("click",_.bind(i.onIgnoreSpell,i)),t.menuToDictionaryTable.on("click",_.bind(i.onToDictionary,i)),t.menuToDictionaryPara.on("click",_.bind(i.onToDictionary,i)),t.menuTableAdvanced.on("click",_.bind(i.onTableAdvanced,i)),t.menuImageAdvanced.on("click",_.bind(i.onImageAdvanced,i)),t.menuImgOriginalSize.on("click",_.bind(i.onImgOriginalSize,i)),t.menuImgShapeRotate.menu.items[0].on("click",_.bind(i.onImgRotate,i)),t.menuImgShapeRotate.menu.items[1].on("click",_.bind(i.onImgRotate,i)),t.menuImgShapeRotate.menu.items[3].on("click",_.bind(i.onImgFlip,i)),t.menuImgShapeRotate.menu.items[4].on("click",_.bind(i.onImgFlip,i)),t.menuImgCrop.menu.on("item:click",_.bind(i.onImgCrop,i)),t.menuImgResetCrop.on("click",_.bind(i.onImgResetCrop,i)),t.menuImgEditPoints.on("click",_.bind(i.onImgEditPoints,i)),t.menuShapeAdvanced.on("click",_.bind(i.onShapeAdvanced,i)),t.menuParagraphAdvanced.on("click",_.bind(i.onParagraphAdvanced,i)),t.menuChartAdvanced.on("click",_.bind(i.onChartAdvanced,i)),t.mnuGroupImg.on("click",_.bind(i.onGroupImg,i)),t.mnuUnGroupImg.on("click",_.bind(i.onUnGroupImg,i)),t.mnuArrangeFront.on("click",_.bind(i.onArrangeFront,i)),t.mnuArrangeBack.on("click",_.bind(i.onArrangeBack,i)),t.mnuArrangeForward.on("click",_.bind(i.onArrangeForward,i)),t.mnuArrangeBackward.on("click",_.bind(i.onArrangeBackward,i)),t.menuImgShapeAlign.menu.on("item:click",_.bind(i.onImgShapeAlign,i)),t.menuShapesMerge.menu.on("item:click",_.bind(i.onShapesMerge,i)),t.menuParagraphVAlign.menu.on("item:click",_.bind(i.onParagraphVAlign,i)),t.menuParagraphDirection.menu.on("item:click",_.bind(i.onParagraphDirection,i)),t.menuTableSelectText.menu.on("item:click",_.bind(i.tableSelectText,i)),t.menuTableInsertText.menu.on("item:click",_.bind(i.tableInsertText,i)),t.menuTableDeleteText.menu.on("item:click",_.bind(i.tableDeleteText,i)),t.mnuGuides.menu.on("item:click",_.bind(i.onGuidesClick,i)),t.mnuGridlines.menu.on("item:click",_.bind(i.onGridlinesClick,i)),t.mnuRulers.on("click",_.bind(i.onRulersClick,i)),t.menuTableEquationSettings.menu.on("item:click",_.bind(i.convertEquation,i)),t.menuParagraphEquation.menu.on("item:click",_.bind(i.convertEquation,i)),t.animEffectMenu.on("item:click",_.bind(i.onAnimEffect,i)),t.mnuInsertMaster.on("click",_.bind(i.onInsertMaster,i)),t.mnuInsertLayout.on("click",_.bind(i.onInsertLayout,i)),t.mnuDuplicateMaster.on("click",_.bind(i.onDuplicateMaster,i)),t.mnuPreserveMaster.on("toggle",_.bind(i.onPreserveMaster,i)),t.mnuDuplicateLayout.on("click",_.bind(i.onDuplicateLayout,i)),t.mnuDeleteMaster.on("click",_.bind(i.onDeleteMaster,i)),t.mnuDeleteLayout.on("click",_.bind(i.onDeleteLayout,i)),t.mnuRenameMaster.on("click",_.bind(i.onRename,i)),t.mnuRenameLayout.on("click",_.bind(i.onRename,i))},t.fillMenuProps=function(t){if(t&&_.isArray(t)){var e=this.documentHolder,i={},n=null;return _.each(t,(function(t,s){var a=t.get_ObjectType(),o=t.get_ObjectValue();Asc.c_oAscTypeSelectElement.Image==a?(n=e.pictureMenu,i.imgProps={},i.imgProps.value=o,i.imgProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Table==a?(n=e.tableMenu,i.tableProps={},i.tableProps.value=o,i.tableProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Hyperlink==a?(i.hyperProps={},i.hyperProps.value=o):Asc.c_oAscTypeSelectElement.Shape==a?(n=e.pictureMenu,i.shapeProps={},i.shapeProps.value=o,i.shapeProps.locked=!!o&&o.get_Locked(),o.get_FromChart()&&(i.shapeProps.isChart=!0)):Asc.c_oAscTypeSelectElement.Chart==a?(n=e.pictureMenu,i.chartProps={},i.chartProps.value=o,i.chartProps.locked=!!o&&o.get_Locked()):Asc.c_oAscTypeSelectElement.Slide==a?(i.slideProps={},i.slideProps.value=o,i.slideProps.locked=!!o&&o.get_LockDelete()):Asc.c_oAscTypeSelectElement.Paragraph==a?(i.paraProps={},i.paraProps.value=o,i.paraProps.locked=!!o&&o.get_Locked(),(i.shapeProps&&i.shapeProps.value||i.chartProps&&i.chartProps.value)&&_.isUndefined(i.tableProps)&&(n=e.textMenu)):Asc.c_oAscTypeSelectElement.SpellCheck==a?(i.spellProps={},i.spellProps.value=o,e._currentSpellObj=o):Asc.c_oAscTypeSelectElement.Math==a&&(i.mathProps={},i.mathProps.value=o,e._currentMathObj=o)})),null===n&&(_.isUndefined(i.paraProps)?_.isUndefined(i.slideProps)||(n=e.slideMenu):n=e.textMenu),{menu_to_show:n,menu_props:i}}},t.fillViewMenuProps=function(t){if(t&&_.isArray(t)){var e=this.documentHolder;e.viewModeMenu||e.createDelayedElementsViewer();var i={},n=null;return _.each(t,(function(t,s){var a=t.get_ObjectType(),o=t.get_ObjectValue();Asc.c_oAscTypeSelectElement.Image==a||Asc.c_oAscTypeSelectElement.Table==a||Asc.c_oAscTypeSelectElement.Shape==a||Asc.c_oAscTypeSelectElement.Chart==a||Asc.c_oAscTypeSelectElement.Paragraph==a?(n=e.viewModeMenu,i.locked=i.locked||!!o&&o.get_Locked(),Asc.c_oAscTypeSelectElement.Chart==a&&(i.isChart=!0)):Asc.c_oAscTypeSelectElement.Slide==a&&(i.locked=i.locked||!!o&&o.get_LockDelete())})),n?{menu_to_show:n,menu_props:i}:null}},t.onHyperlinkClick=function(t){if(t){var e=this.api.asc_getUrlType(t);if(e===AscCommon.c_oAscUrlType.Http||e===AscCommon.c_oAscUrlType.Email)window.open(t);else{var i=this;setTimeout((function(){Common.UI.warning({msg:i.documentHolder.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(e){try{"yes"==e&&window.open(t)}catch(t){t&&console.log(t.stack)}}})}),1)}}},t.onMouseMove=function(t){var e=this,i=e.documentHolder.cmpEl,n=e.screenTip;if(_.isUndefined(e._XY)&&(e._XY=[Common.Utils.getOffset(i).left-$(window).scrollLeft(),Common.Utils.getOffset(i).top-$(window).scrollTop()],e._Width=i.width(),e._Height=i.height(),e._BodyWidth=$("body").width()),t){var s,a="",o=t.get_Type();if(o===Asc.c_oAscMouseMoveDataTypes.Hyperlink||o===Asc.c_oAscMouseMoveDataTypes.Placeholder||o===Asc.c_oAscMouseMoveDataTypes.EffectInfo){if(e.isTooltipHiding)return void(e.mouseMoveData=t);if(o===Asc.c_oAscMouseMoveDataTypes.Hyperlink){var l=t.get_Hyperlink();l&&(a=_.isEmpty(l.get_ToolTip())?l.get_Value():l.get_ToolTip(),(a=Common.Utils.String.htmlEncode(a)).length>256&&(a=a.substr(0,256)+"..."))}else if(o===Asc.c_oAscMouseMoveDataTypes.Placeholder)switch(t.get_PlaceholderType()){case AscCommon.PlaceholderButtonType.Image:a=e.documentHolder.txtInsImage;break;case AscCommon.PlaceholderButtonType.ImageUrl:a=e.documentHolder.txtInsImageUrl;break;case AscCommon.PlaceholderButtonType.Chart:a=e.documentHolder.txtInsChart;break;case AscCommon.PlaceholderButtonType.Table:a=e.documentHolder.txtInsTable;break;case AscCommon.PlaceholderButtonType.Video:a=e.documentHolder.txtInsVideo;break;case AscCommon.PlaceholderButtonType.Audio:a=e.documentHolder.txtInsAudio;break;case AscCommon.PlaceholderButtonType.SmartArt:a=e.documentHolder.txtInsSmartArt}else if(o===Asc.c_oAscMouseMoveDataTypes.EffectInfo){if(e.documentHolder.currentMenu&&e.documentHolder.currentMenu.isVisible())return;var r=t.get_EffectText();r||(r=e.getApplication().getController("Animation").getAnimationPanelTip(t.get_EffectDescription())||""),a=r}var c=!1;n.isHidden=!1,(n.tipType!==o||n.tipLength!==a.length||n.strTip.indexOf(a)<0)&&(n.toolTip.setTitle(o===Asc.c_oAscMouseMoveDataTypes.Hyperlink?a+(e.isPreviewVisible?"":"<br><b>"+Common.Utils.String.platformKey("Ctrl",e.documentHolder.txtPressLink)+"</b>"):a),n.tipLength=a.length,n.strTip=a,n.tipType=o,c=!0,n.toolTip.getBSTip().options.container=e.isPreviewVisible?"#pe-preview":"body"),(s=[t.get_X(),t.get_Y()])[1]+=(e.isPreviewVisible?0:e._XY[1])-15,s[0]+=(e.isPreviewVisible?0:e._XY[0])+5,n.isVisible&&!c||(n.isVisible=!0,n.toolTip.show([-1e4,-1e4])),c&&(n.tipHeight=n.toolTip.getBSTip().$tip.height(),n.tipWidth=n.toolTip.getBSTip().$tip.width()),s[1]-=n.tipHeight,s[1]<0&&(s[1]=0),s[0]+n.tipWidth>e._BodyWidth&&(s[0]=e._BodyWidth-n.tipWidth),n.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"})}else if(o===Asc.c_oAscMouseMoveDataTypes.Eyedropper){if(e.eyedropperTip.isTipVisible&&(e.eyedropperTip.isTipVisible=!1,e.eyedropperTip.toolTip.hide()),!e.eyedropperTip.toolTip){var d=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>');e.documentHolder.cmpEl.append(d),e.eyedropperTip.toolTip=new Common.UI.Tooltip({owner:d,html:!0,cls:"eyedropper-tooltip"})}var p=t.get_EyedropperColor().asc_getColor(),h=p.get_r(),m=p.get_g(),u=p.get_b(),g=Common.Utils.ThemeColor.getHexColor(h,m,u);if(!e.eyedropperTip.eyedropperColor){var b=$(document.createElement("div"));b.addClass("eyedropper-color"),b.appendTo(document.body),e.eyedropperTip.eyedropperColor=b,$("#id_main_view").on("mouseleave",_.bind(e.hideEyedropper,e))}e.eyedropperTip.eyedropperColor.css({backgroundColor:"#"+g,left:t.get_X()+e._XY[0]+23+"px",top:t.get_Y()+e._XY[1]-53+"px"}),e.eyedropperTip.isVisible=!0,e.eyedropperTip.tipInterval&&clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.tipInterval=setInterval((function(){clearInterval(e.eyedropperTip.tipInterval),e.eyedropperTip.isVisible&&(a="<div>RGB ("+h+","+m+","+u+")</div><div>"+t.get_EyedropperColor().asc_getName()+"</div>",e.eyedropperTip.toolTip.setTitle(a),e.eyedropperTip.isTipVisible=!0,e.eyedropperTip.toolTip.show([-1e4,-1e4]),e.eyedropperTip.tipWidth=e.eyedropperTip.toolTip.getBSTip().$tip.width(),(s=[t.get_X(),t.get_Y()])[1]+=e._XY[1]-57,s[0]+=e._XY[0]+58,s[0]+e.eyedropperTip.tipWidth>e._BodyWidth&&(s[0]=s[0]-e.eyedropperTip.tipWidth-40),e.eyedropperTip.toolTip.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px"}))}),800),e.eyedropperTip.isHidden=!1}else if(o===Asc.c_oAscMouseMoveDataTypes.LockedObject&&e.mode.isEdit&&e.isUserVisible(t.get_UserId())){var f;e.usertipcount>=e.usertips.length&&((f=$(document.createElement("div"))).addClass("username-tip"),f.css({height:e._TtHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(f),e.userTooltip&&(f.on("mouseover",e.wrapEvents.userTipMousover),f.on("mouseout",e.wrapEvents.userTipMousout)),e.usertips.push(f)),f=e.usertips[e.usertipcount],e.usertipcount++,a=e.getUserName(t.get_UserId());var v=(s=[t.get_X()+e._XY[0],t.get_Y()+e._XY[1]])[0];s[0]=e._BodyWidth-s[0],s[1]-=2==t.get_LockedObjectType()?e._TtHeight:0,s[1]>e._XY[1]&&s[1]+e._TtHeight<e._XY[1]+e._Height&&(f.text(a),f.css({visibility:"visible",top:s[1]+"px",right:s[0]+"px","max-width":v+"px"}))}}},t.onShowForeignCursorLabel=function(t,e,i,n){if(this.isUserVisible(t)){for(var s,a=this,o=0;o<a.fastcoauthtips.length;o++)if(a.fastcoauthtips[o].attr("userid")==t){s=a.fastcoauthtips[o];break}s||((s=$(document.createElement("div"))).addClass("username-tip"),s.attr("userid",t),s.css({height:a._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b())}),s.text(a.getUserName(t)),$("#id_main_parent").append(s),a.fastcoauthtips.push(s),s.fadeIn(150)),s.css({top:i-a._TtHeight+"px",left:e+"px"})}},t.onHideForeignCursorLabel=function(t){for(var e=this,i=0;i<e.fastcoauthtips.length;i++)if(e.fastcoauthtips[i].attr("userid")==t){var n=e.fastcoauthtips[i];e.fastcoauthtips[i].fadeOut(150,(function(){n.remove()})),e.fastcoauthtips.splice(i,1);break}},t.onDialogAddHyperlink=function(t){var e,i,n,s=this;if(s.api&&s.mode.isEdit&&!s._isDisabled&&!PE.getController("LeftMenu").leftMenu.menuFile.isVisible()){var a=function(t,e){"ok"==e&&(i=t.getSettings(),!1!==n?s.api.add_Hyperlink(i):s.api.change_Hyperlink(i)),s.editComplete()};n=s.api.can_AddHyperlink();for(var o=[],l=0;l<s.api.getCountPages();l++)o.push({displayValue:l+1,value:l});if(!1!==n)e=new PE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:a,type:!0===t?c_oHyperlinkType.InternalLink:void 0,slides:o}),t&&t instanceof Asc.CHyperlinkProperty?i=t:(i=new Asc.CHyperlinkProperty).put_Text(n),e.show(),e.setSettings(i);else{var r=s.api.getSelectedElements();r&&_.isArray(r)&&_.each(r,(function(t,e){r[e].get_ObjectType()==Asc.c_oAscTypeSelectElement.Hyperlink&&(i=r[e].get_ObjectValue())})),i&&((e=new PE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.mode,handler:a,slides:o})).show(),e.setSettings(i))}}Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")},t.onPaintSlideNum=function(t){var e=this;_.isUndefined(e._XY)&&(e._XY=[Common.Utils.getOffset(e.documentHolder.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(e.documentHolder.cmpEl).top-$(window).scrollTop()],e._Width=e.documentHolder.cmpEl.width(),e._Height=e.documentHolder.cmpEl.height(),e._BodyWidth=$("body").width()),_.isUndefined(e.slideNumDiv)&&(e.slideNumDiv=$(document.createElement("div")),e.slideNumDiv.addClass("slidenum-div"),e.slideNumDiv.css({position:"absolute",display:"block",zIndex:"900",top:e._XY[1]+e._Height/2+"px",right:e._BodyWidth-e._XY[0]-e._Width+22+"px"}),$(document.body).append(e.slideNumDiv)),e.slideNumDiv.html(e.documentHolder.txtSlide+" "+(t+1)),e.slideNumDiv.show()},t.onEndPaintSlideNum=function(){this.slideNumDiv&&this.slideNumDiv.hide()},t.onSpellCheckVariantsFound=function(){var t,e=this,i=e.api.getSelectedElements(!0);if(i&&_.isArray(i))for(var n=0;n<i.length;n++)if(i[n].get_ObjectType()==Asc.c_oAscTypeSelectElement.SpellCheck){t=i[n].get_ObjectValue(),e.documentHolder._currentSpellObj=t;break}t&&!1===t.get_Checked()&&null!==t.get_Variants()&&void 0!==t.get_Variants()&&(e.documentHolder.addWordVariants(),e.documentHolder.textMenu&&e.documentHolder.textMenu.isVisible()&&e.documentHolder.textMenu.alignPosition())},t.equationCallback=function(t){t&&this.api.asc_SetMathProps(t),this.editComplete()},t.onApiCurrentPages=function(t){var e=this;e.documentHolder.currentMenu&&e.documentHolder.currentMenu.isVisible()&&!0!==e._isFromSlideMenu&&e._isFromSlideMenu!==t&&setTimeout((function(){e.documentHolder.currentMenu&&e.documentHolder.currentMenu.hide()}),1),e._isFromSlideMenu=t},t.onShowSpecialPasteOptions=function(t){if(!this.mode||this.mode.isEdit){var e=this,i=e.documentHolder,n=t.asc_getCellCoord(),s=i.cmpEl.find("#special-paste-container"),a=t.asc_getOptions();if(a){if(s.length<1&&(e._arrSpecialPaste=[],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.paste]=i.textPaste,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.keepTextOnly]=i.txtKeepTextOnly,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.picture]=i.txtPastePicture,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.sourceformatting]=i.txtPasteSourceFormat,e._arrSpecialPaste[Asc.c_oSpecialPasteProps.destinationFormatting]=i.txtPasteDestFormat,s=$('<div id="special-paste-container" style="position: absolute;"><div id="id-document-holder-btn-special-paste"></div></div>'),i.cmpEl.append(s),e.btnSpecialPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-special-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",caption:Common.Utils.String.format("({0})",Common.Utils.String.textCtrl),menu:new Common.UI.Menu({items:[]})}),e.initSpecialPasteEvents()),a.length>0){for(var o=e.btnSpecialPaste.menu,l=0;l<o.items.length;l++)o.removeItem(o.items[l]),l--;_.each(a,(function(t,i){var n=new Common.UI.MenuItem({caption:e._arrSpecialPaste[t]+" ("+e.hkSpecPaste[t]+")",value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(e.onSpecialPasteItemClick,e));o.addItem(n)})),o.items.length>0&&o.items[0].setChecked(!0,!0)}if(n.asc_getX()<0||n.asc_getY()<0)s.is(":visible")&&s.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp);else{var r=0,c=i.cmpEl.find("#id_panel_left");c.length&&(r+="none"!==c.css("display")?c.width():0);var d=[Math.max(0,n.asc_getX()+n.asc_getWidth()+3-r),n.asc_getY()+n.asc_getHeight()+3];if(d[0]>e._Width||d[1]>e._Height)return s.is(":visible")&&s.hide(),void $(document).off("keyup",this.wrapEvents.onKeyUp);d[1]+s.height()>e._Height&&(d[1]=e._Height-s.height()),d[0]+s.width()>e._Width&&(d[0]=e._Width-s.width()),!e.btnSpecialPaste.menu.isVisible()||parseInt(s.css("left"))===d[0]&&parseInt(s.css("top"))===d[1]||e.btnSpecialPaste.menu.hide(),s.css({left:d[0],top:d[1]}),s.show(),setTimeout((function(){$(document).on("keyup",e.wrapEvents.onKeyUp)}),10)}this.disableSpecialPaste()}}},t.onHideSpecialPasteOptions=function(){if(this.documentHolder&&this.documentHolder.cmpEl){var t=this.documentHolder.cmpEl.find("#special-paste-container");t.is(":visible")&&(t.hide(),$(document).off("keyup",this.wrapEvents.onKeyUp))}},t.disableSpecialPaste=function(){var t=this.documentHolder.cmpEl.find("#special-paste-container");t.length>0&&t.is(":visible")&&this.btnSpecialPaste.setDisabled(!!this._isDisabled)},t.initSpecialPasteEvents=function(){var t=this;for(var e in t.hkSpecPaste=[],t.hkSpecPaste[Asc.c_oSpecialPasteProps.paste]="P",t.hkSpecPaste[Asc.c_oSpecialPasteProps.keepTextOnly]="T",t.hkSpecPaste[Asc.c_oSpecialPasteProps.picture]="U",t.hkSpecPaste[Asc.c_oSpecialPasteProps.sourceformatting]="K",t.hkSpecPaste[Asc.c_oSpecialPasteProps.destinationFormatting]="H",t.hkSpecPaste)if(t.hkSpecPaste.hasOwnProperty(e)){var i={};i[t.hkSpecPaste[e]]=_.bind(t.onSpecialPasteItemClick,t,{value:parseInt(e)}),Common.util.Shortcuts.delegateShortcuts({shortcuts:i}),Common.util.Shortcuts.suspendEvents(t.hkSpecPaste[e],void 0,!0)}t.btnSpecialPaste.menu.on("show:after",(function(e){for(var i=0;i<e.items.length;i++)t.hkSpecPaste[e.items[i].value]&&Common.util.Shortcuts.resumeEvents(t.hkSpecPaste[e.items[i].value])})).on("hide:after",(function(e){for(var i=0;i<e.items.length;i++)t.hkSpecPaste[e.items[i].value]&&Common.util.Shortcuts.suspendEvents(t.hkSpecPaste[e.items[i].value],void 0,!0)}))},t.onChangeCropState=function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},t.onDoubleClickOnTableOleObject=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.mode.isEdit&&!this._isDisabled){var e=PE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&t&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}},t.addHyperlink=function(t){var e,i=this;if(i.api){for(var n=[],s=0;s<i.api.getCountPages();s++)n.push({displayValue:s+1,value:s});(e=new PE.Views.HyperlinkSettingsDialog({api:i.api,appOptions:i.mode,handler:function(t,e){"ok"==e&&i.api.add_Hyperlink(t.getSettings()),i.editComplete()},slides:n})).show(),e.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")}},t.editHyperlink=function(t,e){var i,n=this;if(n.api){for(var s=[],a=0;a<n.api.getCountPages();a++)s.push({displayValue:a+1,value:a});(i=new PE.Views.HyperlinkSettingsDialog({api:n.api,appOptions:n.mode,handler:function(t,e){"ok"==e&&n.api.change_Hyperlink(i.getSettings()),n.editComplete()},slides:s})).show(),i.setSettings(t.hyperProps.value),Common.component.Analytics.trackEvent("DocumentHolder","Edit Hyperlink")}},t.removeHyperlink=function(t){this.api&&this.api.remove_Hyperlink(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Remove Hyperlink")},t.saveAsPicture=function(){this.api&&this.api.asc_SaveDrawingAsPicture()},t.editChartClick=function(t,e){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.mode.isEdit&&!this._isDisabled){var i=PE.getController("Common.Controllers.ExternalDiagramEditor").getView("Common.Views.ExternalDiagramEditor");i&&(i.setEditMode(void 0===t||"object"==typeof t),i.show(),"object"!=typeof t&&(t=this.api.asc_getChartObject(t,e)),i.setChartData(new Asc.asc_CChartBinary(t)),i.setPlaceholder(e))}},t.onEditObject=function(){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.api){var t=this.api.asc_canEditTableOleObject(!0);if(t){var e=PE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}else this.api.asc_startEditCurrentOleObject()}},t.onCutCopyPaste=function(t,e){var i=this;i.api&&(("cut"==t.value?i.api.Cut():"copy"==t.value?i.api.Copy():i.api.Paste())||Common.localStorage.getBool("pe-hide-copywarning")||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("pe-hide-copywarning",1),i.editComplete()}}).show());i.editComplete()},t.onInsertImage=function(t,e,i,n){t&&(this.hideScreenTip(),this.onHidePlaceholderActions()),this.api&&(t?this.api.asc_addImage(e):this.api.ChangeImageFromFile()),this.editComplete()},t.onInsertImageUrl=function(t,e,i,n){if(Common.Controllers.LaunchController.isScriptLoaded()){t&&(this.hideScreenTip(),this.onHidePlaceholderActions());var s=this;new Common.Views.ImageFromUrlDialog({handler:function(i,n){if("ok"==i&&s.api){var a=n.replace(/ /g,"");if(!_.isEmpty(a))if(t)s.api.AddImageUrl([a],void 0,void 0,e);else{var o=new Asc.asc_CImgProperty;o.put_ImageUrl(a),s.api.ImgApply(o,e)}}s.editComplete()}}).show()}},t.onClickPlaceholderChart=function(t,e,i){if(this.api&&Common.Controllers.LaunchController.isScriptLoaded()){this._state.placeholderObj=t;var n=this.placeholderMenuChart,s=n?this.documentHolder.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",n.id)):null,a=this;if(this._fromShowPlaceholder=!0,Common.UI.Menu.Manager.hideAll(),!n)this.placeholderMenuChart=n=new Common.UI.Menu({style:"width: 364px;padding-top: 12px;",items:[{template:_.template('<div id="id-placeholder-menu-chart" class="menu-insertchart"></div>')}]}),s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),this.documentHolder.cmpEl.append(s),n.render(s),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",(function(){a._fromShowPlaceholder||a.api.asc_uncheckPlaceholders()})),new Common.UI.DataView({el:$("#id-placeholder-menu-chart"),parentMenu:n,showLast:!1,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')}).on("item:click",(function(t,e,i,n){a.editChartClick(i.get("type"),a._state.placeholderObj)}));s.css({left:e,top:i}),s.attr("data-value","prevent-canvas-click"),this._preventClick=!0,setTimeout((function(){n.show(),n.alignPosition(),_.delay((function(){n.cmpEl.find(".dataview").focus()}),10)}),1),this._fromShowPlaceholder=!1}},t.onClickPlaceholderTable=function(t,e,i){if(this.api){this._state.placeholderObj=t;var n=this.placeholderMenuTable,s=n?this.documentHolder.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",n.id)):null,a=this;if(this._fromShowPlaceholder=!0,Common.UI.Menu.Manager.hideAll(),!n){this.placeholderMenuTable=n=new Common.UI.Menu({cls:"shifted-left",items:[{template:_.template('<div id="id-placeholder-menu-tablepicker" class="dimension-picker" style="margin: 5px 10px;"></div>')},{caption:a.documentHolder.mniCustomTable,value:"custom"}]}),s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),this.documentHolder.cmpEl.append(s),n.render(s),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",(function(){a._fromShowPlaceholder||a.api.asc_uncheckPlaceholders()}));var o=new Common.UI.DimensionPicker({el:$("#id-placeholder-menu-tablepicker"),minRows:8,minColumns:10,maxRows:8,maxColumns:10,customClear:!0});o.on("select",(function(t,e,i){a.api.put_Table(e,i,a._state.placeholderObj),a.editComplete()})),n.on("hide:before",(function(t,e){o.setTableSize(0,0)})),n.on("item:click",(function(t,e,i){"custom"===e.value&&new Common.Views.InsertTableDialog({handler:function(t,e){"ok"==t&&a.api.put_Table(e.columns,e.rows,a._state.placeholderObj),a.editComplete()}}).show()}))}s.css({left:e,top:i}),s.attr("data-value","prevent-canvas-click"),this._preventClick=!0,setTimeout((function(){n.show(),n.alignPosition(),_.delay((function(){n.cmpEl.focus()}),10)}),1),this._fromShowPlaceholder=!1}},t.onClickPlaceholderSmartArt=function(t,e,i){if(this.api&&Common.Controllers.LaunchController.isScriptLoaded()){this._state.placeholderObj=t;var n=this.placeholderMenuSmartArt,s=n?this.documentHolder.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",n.id)):null,a=this;if(this._fromShowPlaceholder=!0,Common.UI.Menu.Manager.hideAll(),!n){this.placeholderMenuSmartArt=n=new Common.UI.Menu({cls:"shifted-right",items:[]}),Common.define.smartArt.getSmartArtData().forEach((function(t,e){var i=t.items.length,s=399;i<5&&(s=78*i+9),n.addItem({caption:t.caption,value:t.sectionId,itemId:t.id,itemsLength:i,iconCls:t.icon?"menu__icon "+t.icon:void 0,menu:new Common.UI.Menu({items:[{template:_.template('<div id="placeholder-'+t.id+'" class="menu-add-smart-art margin-left-5" style="width: '+s+'px; height: 500px;"></div>')}],menuAlign:"tl-tr"})})})),s=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',n.id)),this.documentHolder.cmpEl.append(s),n.render(s),n.cmpEl.attr({tabindex:"-1"}),n.on("hide:after",(function(){a._fromShowPlaceholder||a.api.asc_uncheckPlaceholders()}));var o=function(t){t.items.forEach((function(e,i){for(var n=[],s=0;s<e.options.itemsLength;s++)n.push({isLoading:!0});e.menuPicker=new Common.UI.DataView({el:$("#placeholder-"+e.options.itemId),parentMenu:t.items[i].menu,itemTemplate:_.template(["<% if (isLoading) { %>",'<div class="loading-item" style="width: 70px; height: 70px;">','<i class="loading-spinner"></i>',"</div>","<% } else { %>","<div>",'<img src="<%= imageUrl %>" width="70" height="70" />',"</div>","<% } %>"].join("")),store:new Common.UI.DataViewStore(n),delayRenderTips:!0,scrollAlwaysVisible:!0,showLast:!1}),e.menuPicker.on("item:click",(function(t,e,i,n){i&&null!==i.get("value")&&a.api.asc_createSmartArt(i.get("value"),a._state.placeholderObj),Common.NotificationCenter.trigger("edit:complete",a)})),e.menuPicker.loaded=!1,e.$el.on("mouseenter",(function(){e.menuPicker.loaded||a.documentHolder.fireEvent("smartart:mouseenter",[e.value,t])})),e.$el.on("mouseleave",(function(){a.documentHolder.fireEvent("smartart:mouseleave",[e.value])}))})),t.off("show:before",o)};n.on("show:before",o)}s.css({left:e,top:i}),s.attr("data-value","prevent-canvas-click"),this._preventClick=!0,setTimeout((function(){n.show(),n.alignPosition(),_.delay((function(){n.cmpEl.focus()}),10)}),1),this._fromShowPlaceholder=!1}},t.onHidePlaceholderActions=function(){this.placeholderMenuChart&&this.placeholderMenuChart.hide(),this.placeholderMenuTable&&this.placeholderMenuTable.hide(),this.placeholderMenuSmartArt&&this.placeholderMenuSmartArt.hide()},t.onClickPlaceholder=function(t,e,i,n){this.api&&(this.hideScreenTip(),this.onHidePlaceholderActions(),t==AscCommon.PlaceholderButtonType.Video?this.api.asc_AddVideo(e):t==AscCommon.PlaceholderButtonType.Audio&&this.api.asc_AddAudio(e),this.editComplete())},t.onImgReplace=function(t,e,i){var n=this;1==e.value?n.onInsertImageUrl(!1):2==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):setTimeout((function(){n.onInsertImage()}),10)},t.onLangMenu=function(t,e,i){var n=this;n.api&&(_.isUndefined(i.langid)||n.api.put_TextPrLang(i.langid),"para"===t?n.documentHolder._currLang.paraid=i.langid:n.documentHolder._currLang.tableid=i.langid,n.editComplete())},t.onUndo=function(){this.api.Undo()},t.onPreview=function(){var t=this.api.getCurrentPage();Common.NotificationCenter.trigger("preview:start",_.isNumber(t)?t:0,!1,!1,!0)},t.onSelectAll=function(){this.api&&(this.api.SelectAllSlides(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Select All Slides"))},t.onPrintSelection=function(){if(this.api){var t=new Asc.asc_CAdjustPrint;t.asc_setPrintType(Asc.c_oAscPrintType.Selection);var e=new Asc.asc_CDownloadOptions(null,Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86);e.asc_setAdvancedOptions(t),this.api.asc_Print(e),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Print Selection")}},t.onNewSlide=function(){this.api&&(this._isFromSlideMenu=!0,this.api.AddSlide(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Add Slide"))},t.onDuplicateSlide=function(){this.api&&(this._isFromSlideMenu=!0,this.api.DublicateSlide(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Dublicate Slide"))},t.onDeleteSlide=function(){this.api&&(this._isFromSlideMenu=!0,this.api.DeleteSlide(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Delete Slide"))},t.onResetSlide=function(){this.api&&(this.api.ResetSlide(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Reset Slide"))},t.onMoveSlideToStart=function(){this.api&&(this.api.asc_moveSelectedSlidesToStart(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Move Slide to Start"))},t.onMoveSlideToEnd=function(){this.api&&(this.api.asc_moveSelectedSlidesToEnd(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Move Slide to End"))},t.onSlideSettings=function(t){PE.getController("RightMenu").onDoubleClickOnObject(t.options.value)},t.onSlideHide=function(t){this.api&&(this.api.asc_HideSlides(t.checked),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Hide Slides"))},t.onLayoutChange=function(t){this.api&&(this.api.ChangeLayout(t.get("data").idx),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Change Layout"))},t.onThemeChange=function(t){this.api&&(this.api.ChangeTheme(t.get("themeId"),!0),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Change Layout"))},t.onTableMerge=function(){this.api&&this.api.MergeCells()},t.onTableSplit=function(){var t=this;t.api&&new Common.Views.InsertTableDialog({split:!0,handler:function(e,i){"ok"==e&&(t.api&&t.api.SplitCell(i.columns,i.rows),Common.component.Analytics.trackEvent("DocumentHolder","Table Split")),t.editComplete()}}).show()},t.tableCellsVAlign=function(t,e,i){if(this.api){var n=new Asc.CTableProp;n.put_CellsVAlign(e.value),this.api.tblApply(n)}this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Table Cell Align")},t.onTableDistRows=function(){this.api&&this.api.asc_DistributeTableCells(!1),this.editComplete()},t.onTableDistCols=function(){this.api&&this.api.asc_DistributeTableCells(!0),this.editComplete()},t.onIgnoreSpell=function(t,e){this.api&&this.api.asc_ignoreMisspelledWord(this.documentHolder._currentSpellObj,!!t.value),this.editComplete()},t.onToDictionary=function(t,e){this.api&&this.api.asc_spellCheckAddToDictionary(this.documentHolder._currentSpellObj),this.editComplete()},t.onTableAdvanced=function(t,e){var i=this;if(i.api){var n=i.api.getSelectedElements();if(n&&n.length>0)for(var s,a,o=n.length-1;o>=0;o--)if(s=n[o].get_ObjectType(),a=n[o].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Table==s){new PE.Views.TableSettingsAdvanced({tableProps:a,slideSize:PE.getController("Toolbar").currentPageSize,handler:function(t,e){"ok"==t&&i.api&&i.api.tblApply(e.tableProps),i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Table Settings Advanced")}}).show();break}}},t.onImageAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var n,s,a=i.length-1;a>=0;a--)if(n=i[a].get_ObjectType(),s=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Image==n){var o;e.documentHolder.menuImgOriginalSize.isDisabled()||(o=e.api.asc_getCropOriginalImageSize())&&(o={width:o.get_ImageWidth(),height:o.get_ImageHeight()}),new PE.Views.ImageSettingsAdvanced({imageProps:s,sizeOriginal:o,slideSize:PE.getController("Toolbar").currentPageSize,handler:function(t,i){"ok"==t&&e.api&&e.api.ImgApply(i.imageProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Settings Advanced")}}).show();break}}},t.onImgOriginalSize=function(t){var e=this;if(e.api){var i=e.api.asc_getCropOriginalImageSize();if(i){var n=new Asc.asc_CImgProperty;n.put_Width(i.get_ImageWidth()),n.put_Height(i.get_ImageHeight()),n.put_Rot(0),e.api.ImgApply(n)}e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Set Image Original Size")}},t.onImgRotate=function(t){var e=new Asc.asc_CShapeProperty;e.asc_putRotAdd(3.14159265358979*(1==t.value?90:270)/180),this.api.ShapeApply(e),this.editComplete()},t.onImgFlip=function(t){var e=new Asc.asc_CShapeProperty;1==t.value?e.asc_putFlipHInvert(!0):e.asc_putFlipVInvert(!0),this.api.ShapeApply(e),this.editComplete()},t.onImgCrop=function(t,e){1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop(),this.editComplete()},t.onImgResetCrop=function(){if(this.api){var t=new Asc.asc_CImgProperty;t.put_ResetCrop(!0)}this.api.ShapeApply(t),this.editComplete()},t.onImgEditPoints=function(t){this.api&&this.api.asc_editPointsGeometry()},t.onShapeAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var n,s,a=i.length-1;a>=0;a--)if(n=i[a].get_ObjectType(),s=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Shape==n){new PE.Views.ShapeSettingsAdvanced({shapeProps:s,slideSize:PE.getController("Toolbar").currentPageSize,handler:function(t,i){"ok"==t&&e.api&&e.api.ShapeApply(i.shapeProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Shape Advanced")}}).show();break}}},t.onParagraphAdvanced=function(t){var e=this;if(e.api){var i=e.api.getSelectedElements();if(i&&i.length>0)for(var n,s,a=i.length-1;a>=0;a--)if(n=i[a].get_ObjectType(),s=i[a].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Paragraph==n){new PE.Views.ParagraphSettingsAdvanced({paragraphProps:s,api:e.api,handler:function(t,i){"ok"==t&&e.api&&e.api.paraApply(i.paragraphProps),e.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Image Paragraph Advanced")}}).show();break}}},t.onChartAdvanced=function(t,e){var i=this;if(i.api){var n=i.api.getSelectedElements();if(n&&n.length>0)for(var s,a,o=n.length-1;o>=0;o--)if(s=n[o].get_ObjectType(),a=n[o].get_ObjectValue(),Asc.c_oAscTypeSelectElement.Chart==s){new PE.Views.ChartSettingsAdvanced({chartProps:a,slideSize:PE.getController("Toolbar").currentPageSize,handler:function(t,e){"ok"==t&&i.api&&i.api.ChartApply(e.chartProps),i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Chart Settings Advanced")}}).show();break}}},t.onGroupImg=function(t){this.api&&this.api.groupShapes(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Group Image")},t.onUnGroupImg=function(t){this.api&&this.api.unGroupShapes(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","UnGroup Image")},t.onArrangeFront=function(t){this.api&&this.api.shapes_bringToFront(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Bring To Front")},t.onArrangeBack=function(t){this.api&&this.api.shapes_bringToBack(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Bring To Back")},t.onArrangeForward=function(t){this.api&&this.api.shapes_bringForward(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Send Forward")},t.onArrangeBackward=function(t){this.api&&this.api.shapes_bringBackward(),this.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Send Backward")},t.onImgShapeAlign=function(t,e){var i=this;if(i.api){var n=i.api.asc_getSelectedDrawingObjectsCount()<2||Common.Utils.InternalSettings.get("pe-align-to-slide");n=n?Asc.c_oAscObjectsAlignType.Slide:Asc.c_oAscObjectsAlignType.Selected,e.value<6?(i.api.put_ShapesAlign(e.value,n),Common.component.Analytics.trackEvent("DocumentHolder","Shape Align")):6==e.value?(i.api.DistributeHorizontally(n),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Horizontally")):7==e.value&&(i.api.DistributeVertically(n),Common.component.Analytics.trackEvent("DocumentHolder","Distribute Vertically")),i.editComplete()}},t.onShapesMerge=function(t,e,i){e&&e.value&&(this.api.asc_mergeSelectedShapes(e.value),Common.component.Analytics.trackEvent("DocumentHolder","Shapes Merge")),this.editComplete()},t.onParagraphVAlign=function(t,e){var i=this;if(i.api){var n=new Asc.asc_CShapeProperty;n.put_VerticalTextAlign(e.value),i.api.ShapeApply(n)}i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Text Vertical Align")},t.onParagraphDirection=function(t,e){var i=this;if(i.api){var n=new Asc.asc_CShapeProperty;n.put_Vert(e.options.direction),i.api.ShapeApply(n)}i.editComplete(),Common.component.Analytics.trackEvent("DocumentHolder","Text Direction")},t.tableSelectText=function(t,e){if(this.api)switch(e.value){case 0:this.api.selectRow();break;case 1:this.api.selectColumn();break;case 2:this.api.selectCell();break;case 3:this.api.selectTable()}},t.tableInsertText=function(t,e){if(this.api)switch(e.value){case 0:this.api.addColumnLeft();break;case 1:this.api.addColumnRight();break;case 2:this.api.addRowAbove();break;case 3:this.api.addRowBelow()}},t.tableDeleteText=function(t,e){if(this.api)switch(e.value){case 0:this.api.remRow();break;case 1:this.api.remColumn();break;case 2:this.api.remTable()}},t.onSpecialPasteItemClick=function(t,e){if(this.api){this.api.asc_SpecialPaste(t.value);var i=this.btnSpecialPaste.menu;if(!t.cmpEl)for(var n=0;n<i.items.length;n++)i.items[n].setChecked(i.items[n].value===t.value,!0);setTimeout((function(){i.hide()}),100)}return!1},t.onGuidesClick=function(t,e){"del-guide"==e.value&&e.options.guideId?this.documentHolder.fireEvent("guides:delete",[e.options.guideId]):"add-vert"===e.value||"add-hor"===e.value?this.documentHolder.fireEvent("guides:add",[e.value]):"clear"===e.value?this.documentHolder.fireEvent("guides:clear"):"smart"===e.value?this.documentHolder.fireEvent("guides:smart",[e.isChecked()]):this.documentHolder.fireEvent("guides:show",[e.isChecked()])},t.onGridlinesClick=function(t,e){"custom"===e.value?this.documentHolder.fireEvent("gridlines:custom"):"snap"===e.value?this.documentHolder.fireEvent("gridlines:snap",[e.isChecked()]):"show"===e.value?this.documentHolder.fireEvent("gridlines:show",[e.isChecked()]):this.documentHolder.fireEvent("gridlines:spacing",[e.value])},t.onRulersClick=function(t){this.documentHolder.fireEvent("rulers:change",[t.isChecked()])},t.onTrackGuide=function(t,e,i){var n=this.guideTip;if(void 0===t||e<0||i<0)!n.isHidden&&n.ref&&(n.ref.hide(),n.ref=void 0,n.text="",n.isHidden=!0);else{_.isUndefined(this._XY)&&(this._XY=[Common.Utils.getOffset(this.documentHolder.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(this.documentHolder.cmpEl).top-$(window).scrollTop()],this._Width=this.documentHolder.cmpEl.width(),this._Height=this.documentHolder.cmpEl.height(),this._BodyWidth=$("body").width()),n.parentEl||(n.parentEl=$('<div id="tip-container-guide" style="position: absolute; z-index: 10000;"></div>'),this.documentHolder.cmpEl.append(n.parentEl));var s=t.toFixed(2);n.ref&&n.ref.isVisible()&&n.text!=s&&(n.text=s,n.ref.setTitle(s),n.ref.updateTitle()),n.ref&&n.ref.isVisible()||(n.text=s,n.ref=new Common.UI.Tooltip({owner:n.parentEl,html:!0,title:s}),n.ref.show([-1e4,-1e4]),n.isHidden=!1);var a=[e,i];a[0]+=this._XY[0]+6,a[1]+=this._XY[1]-20-n.ttHeight;var o=n.ref.getBSTip().$tip.width();a[0]+o>this._BodyWidth&&(a[0]=this._BodyWidth-o-20),n.ref.getBSTip().$tip.css({top:a[1]+"px",left:a[0]+"px"})}},t.onShowMathTrack=function(t){if(!this.mode||this.mode.isEdit)if(this.lastMathTrackBounds=t,Common.Controllers.LaunchController.isScriptLoaded())if(t[3]<0||Common.Utils.InternalSettings.get("pe-equation-toolbar-hide"))this.onHideMathTrack();else{var e=this,i=e.documentHolder,n=i.cmpEl.find("#equation-container");if(n.length<1){var s=e.getApplication().getCollection("EquationGroups"),a='<div id="equation-container" style="position: absolute;">';e.getApplication().getController("Toolbar").onMathTypes(),e.equationBtns=[];for(var o=0;o<s.length;++o)a+='<span id="id-document-holder-btn-equation-'+o+'"></span>';a+='<div class="separator"></div>',a+='<span id="id-document-holder-btn-equation-settings"></span>',a+="</div>",n=$(a),i.cmpEl.append(n);var l=function(t){var i=t.options.value,n=s.at(i);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+i,t.cmpEl),parentMenu:t,store:n.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",(function(t,i,n,s){e.api&&n&&e.api.asc_AddMath(n.get("data").equationType)})),t.off("show:before",l)},r=function(t){n.addClass("has-open-menu")},c=function(t){n.removeClass("has-open-menu")};for(o=0;o<s.length;++o){var d=s.at(o),p=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+o,i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({value:o,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+o+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});p.menu.on("show:before",l),p.menu.on("show:before",r),p.menu.on("hide:after",c),e.equationBtns.push(p)}e.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:e.documentHolder.advancedEquationText,menu:e.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),e.equationSettingsBtn.menu.options.initMenu=function(){var t=e.api.asc_GetMathInputType(),i=e.equationSettingsBtn.menu,n=Common.Utils.InternalSettings.get("pe-equation-toolbar-hide");i.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),i.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),i.items[8].options.isToolbarHide=n,i.items[8].setCaption(n?e.documentHolder.showEqToolbar:e.documentHolder.hideEqToolbar,!0)},e.equationSettingsBtn.menu.on("item:click",_.bind(e.convertEquation,e)),e.equationSettingsBtn.menu.on("show:before",(function(t){r(),t.options.initMenu()})),e.equationSettingsBtn.menu.on("hide:after",c)}var h=[(t[0]+t[2])/2-n.outerWidth()/2,t[1]-n.outerHeight()-10];h[0]<0&&(h[0]=0),h[1]<0&&(h[1]=t[3]+10),h[1]=Math.min(e._Height-n.outerHeight(),Math.max(0,h[1])),n.css({left:h[0],top:h[1]}),_.isUndefined(e._XY)&&(e._XY=[Common.Utils.getOffset(i.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(i.cmpEl).top-$(window).scrollTop()],e._Width=i.cmpEl.width(),e._Height=i.cmpEl.height(),e._BodyWidth=$("body").width());var m=e._Height-h[1]-n.outerHeight(),u=e._XY[1]+h[1],g=m<220&&m<.9*u?"bl-tl":"tl-bl";Common.UI.isRTL()&&(g="bl-tl"===g?"br-tr":"tr-br"),e.equationBtns.forEach((function(t){t&&(t.menu.menuAlign=g)})),e.equationSettingsBtn.menu.menuAlign=g,n.is(":visible")?e.equationSettingsBtn.menu.isVisible()&&(e.equationSettingsBtn.menu.options.initMenu(),e.equationSettingsBtn.menu.alignPosition()):n.show(),e.disableEquationBar()}else this.showMathTrackOnLoad=!0},t.onHideMathTrack=function(){if(this.documentHolder&&this.documentHolder.cmpEl)if(Common.Controllers.LaunchController.isScriptLoaded()){var t=this.documentHolder.cmpEl.find("#equation-container");t.is(":visible")&&t.hide()}else this.showMathTrackOnLoad=!1},t.disableEquationBar=function(){var t=this.documentHolder.cmpEl.find("#equation-container"),e=this._isDisabled||this._state.equationLocked;t.length>0&&t.is(":visible")&&(this.equationBtns.forEach((function(t){t&&t.setDisabled(!!e)})),this.equationSettingsBtn.setDisabled(!!e))},t.convertEquation=function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("pe-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("pe-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("pe-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},t.onLockViewProps=function(t){Common.Utils.InternalSettings.set("pe-lock-view-props",t);var e=this,i=e.documentHolder.currentMenu;if(i&&i.isVisible()&&e.documentHolder.slideMenu===i&&0!==e.api.asc_getCurrentFocusObject()&&!e._isDisabled&&e.mode.isEdit){var n=e.fillMenuProps(e.api.getSelectedElements());n&&n.menu_to_show===i&&(i.options.initMenu(n.menu_props),i.alignPosition())}},t.onPluginContextMenu=function(t){t&&t.length>0&&this.documentHolder&&this.documentHolder.currentMenu&&this.documentHolder.currentMenu.isVisible()&&this.documentHolder.updateCustomItems(this.documentHolder.currentMenu,t)},t.onAnimEffect=function(t,e){"remove"===e.value?this.api.asc_RemoveSelectedAnimEffects():this.api.asc_SetSelectedAnimEffectsStartType(e.value)},t.onInsertMaster=function(){this.api.asc_AddMasterSlide()},t.onInsertLayout=function(){this.api.asc_AddSlideLayout()},t.onDuplicateMaster=function(){this.api.asc_DuplicateMaster()},t.onPreserveMaster=function(t){this.api.asc_setPreserveSlideMaster(t.checked)},t.onRemoveUnpreserveMasters=function(t){Common.UI.warning({msg:this.documentHolder.textRemoveUnpreserveMasters,buttons:["yes","no"],primary:"yes",callback:function(e){t("yes"===e)}})},t.onDuplicateLayout=function(){this.api.asc_DuplicateLayout()},t.onDeleteMaster=function(){this.api.asc_DeleteMaster()},t.onDeleteLayout=function(){this.api.asc_DeleteLayout()},t.onRename=function(){var t,e=this,i="",n=e.api.getSelectedElements();n&&_.isArray(n)&&_.each(n,(function(e){if(Asc.c_oAscTypeSelectElement.Slide==e.get_ObjectType()){var n=e.get_ObjectValue();t=n.get_IsMasterSelected(),i=t?n.get_MasterName():n.get_LayoutName()}})),new Common.Views.TextInputDialog({title:t?e.textRenameTitleMaster:e.textRenameTitleLayout,label:t?e.textNameMaster:e.textNameLayout,value:i||"",inputConfig:{allowBlank:!1,validation:function(t){return t.length<255||e.textLongName}},handler:function(i,n){"ok"===i&&n&&e.api[t?"asc_SetMasterName":"asc_SetLayoutName"](n)}}).show()}}})),define("presentationeditor/main/app/view/FileMenuPanels",[],(function(){"use strict";!PE.Views.FileMenuPanels&&(PE.Views.FileMenuPanels={}),PE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"PPTX",imgCls:"pptx",type:Asc.c_oAscFileType.PPTX},{name:"PPSX",imgCls:"ppsx",type:Asc.c_oAscFileType.PPSX},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF},{name:"ODP",imgCls:"odp",type:Asc.c_oAscFileType.ODP}],[{name:"POTX",imgCls:"potx",type:Asc.c_oAscFileType.POTX},{name:"PPTM",imgCls:"pptm",type:Asc.c_oAscFileType.PPTM},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA},{name:"OTP",imgCls:"otp",type:Asc.c_oAscFileType.OTP}],[]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.PPTM || fileType=="pptm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"pptx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"PE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,parseInt(e.value)])},textDownloadAs:"Download as"}),PE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"PPTX",imgCls:"pptx",type:Asc.c_oAscFileType.PPTX,ext:".pptx"},{name:"PPSX",imgCls:"ppsx",type:Asc.c_oAscFileType.PPSX,ext:".ppsx"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"},{name:"ODP",imgCls:"odp",type:Asc.c_oAscFileType.ODP,ext:".odp"}],[{name:"POTX",imgCls:"potx",type:Asc.c_oAscFileType.POTX,ext:".potx"},{name:"PPTM",imgCls:"pptm",type:Asc.c_oAscFileType.PPTM,ext:".pptm"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"},{name:"OTP",imgCls:"otp",type:Asc.c_oAscFileType.OTP,ext:".otp"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.PPTM || fileType=="pptm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"pptx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"PE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var n=e.length;n>t&&(t=n)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("savecopy:format",[this.menu,parseInt(e.value),i.value])},textSaveCopyAs:"Save Copy as"}),PE.Views.FileMenuPanels.Settings=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>',"<table><tbody>",'<tr class="editsave">','<td colspan="2" class="group-name top"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan="2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2" class="right"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-paste-settings"></div></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="coauth changes">','<td colspan="2" class="group-name"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes">','<td colspan="2" class="subgroup-name"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex;" role="radiogroup" aria-owns="fms-rb-coauth-mode-strict">','<div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span>',"</div></td>","</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex;">','<div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</tr>",'<tr class ="coauth changes divider-group"></tr>','<tr class="live-viewer">','<td colspan="2" class="group-name"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class ="live-viewer divider-group"></tr>','<tr class="edit">','<td colspan="2" class="group-name"><label><%= scope.txtProofing %></label></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><div id="fms-chb-spell-check"></div></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-uppercase-words"></span></td>',"</tr>",'<tr class="edit spellcheck">','<td colspan="2"><span id="fms-chb-ignore-numbers-words"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-auto-correct" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtAutoCorrect %></button></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>','<tr class="appearance">','<td colspan="2" class="group-name"><label><%= scope.txtAppearance %></label></td>',"</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>",'<td><span id="fms-cmb-theme"></span></td>',"</tr>",'<tr class="tab-style">',"<td><label><%= scope.strTabStyle %></label></td>",'<td><div id="fms-cmb-tab-style"></div></td>',"</tr>",'<tr class="tab-background">','<td colspan="2"><div id="fms-chb-tab-background"></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>',"<tr>",'<td colspan="2" class="group-name"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-scrn-reader"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-align-guides"></span></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>",'<tr class="edit quick-access">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-customize-quick-access" style="width:auto;display:inline-block;padding-right:10px;padding-left:10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomizeQuickAccess %></button></div></td>',"</tr>",'<tr class="edit">',"<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class="macros">',"<td><label><%= scope.strMacrosSettings %></label></td>",'<td><div><div id="fms-cmb-macros"></div></div></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table style="margin: 10px 20px;"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chSpell=new Common.UI.CheckBox({el:i.findById("#fms-chb-spell-check"),labelText:this.txtSpellCheck,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,s){e.chIgnoreUppercase.setDisabled("checked"!==t.getValue()),e.chIgnoreNumbers.setDisabled("checked"!==t.getValue())})),this.chIgnoreUppercase=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-uppercase-words"),labelText:this.strIgnoreWordsInUPPERCASE,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chIgnoreNumbers=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-numbers-words"),labelText:this.strIgnoreWordsWithNumbers,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chScreenReader=new Common.UI.CheckBox({el:i.findById("#fms-chb-scrn-reader"),labelText:this.txtScreenReader,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:-1,displayValue:this.txtFitSlide},{value:-2,displayValue:this.txtFitWidth},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strFast+" "+this.txtFastTip}).on("change",(function(t,i,n){i&&e.chAutosave.setValue(1)})),this.rbCoAuthModeFast.$el.parent().on("click",(function(){e.rbCoAuthModeFast.setValue(!0)})),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strStrict+" "+this.txtStrictTip}),this.rbCoAuthModeStrict.$el.parent().on("click",(function(){e.rbCoAuthModeStrict.setValue(!0)})),this.chLiveViewer=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,n,s){"checked"!==t.getValue()&&e.rbCoAuthModeFast.getValue()&&e.rbCoAuthModeStrict.setValue(1)})),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chAlignGuides=new Common.UI.CheckBox({el:i.findById("#fms-chb-align-guides"),labelText:this.textAlignGuides,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"});var n=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));return this.cmbFontRender=new Common.UI.ComboBox({el:i.findById("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",itemsTemplate:n,data:[{value:Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling,displayValue:this.txtWin},{value:Asc.c_oAscFontRenderingModeType.noHinting,displayValue:this.txtMac},{value:Asc.c_oAscFontRenderingModeType.hinting,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.cmbUnit=new Common.UI.ComboBox({el:i.findById("#fms-cmb-unit"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbMacros=new Common.UI.ComboBox({el:i.findById("#fms-cmb-macros"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:2,displayValue:this.txtStopMacros,descValue:this.txtStopMacrosDesc},{value:0,displayValue:this.txtWarnMacros,descValue:this.txtWarnMacrosDesc},{value:1,displayValue:this.txtRunMacros,descValue:this.txtRunMacrosDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.lblMacrosDesc.text(i.descValue)})),this.lblMacrosDesc=i.findById("#fms-lbl-macros"),this.chPaste=new Common.UI.CheckBox({el:i.findById("#fms-chb-paste-settings"),labelText:this.strPasteButton,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnAutoCorrect=new Common.UI.Button({el:i.findById("#fms-btn-auto-correct")}),this.btnAutoCorrect.on("click",_.bind(this.autoCorrect,this)),this.btnCustomizeQuickAccess=new Common.UI.Button({el:i.findById("#fms-btn-customize-quick-access")}),this.btnCustomizeQuickAccess.on("click",_.bind(this.customizeQuickAccess,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTabStyle=new Common.UI.ComboBox({el:i.findById("#fms-cmb-tab-style"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",data:[{value:"fill",displayValue:this.textFill},{value:"line",displayValue:this.textLine}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chTabBack=new Common.UI.CheckBox({el:i.findById("#fms-chb-tab-background"),labelText:this.txtTabBack,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()),this.cmbZoom.options.menuAlignEl=t?this.pnlSettings:null,this.cmbUnit.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFontRender.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTheme.options.menuAlignEl=t?this.pnlSettings:null,this.cmbMacros.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTabStyle.options.menuAlignEl=t?this.pnlSettings:null}},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("pe-settings-coauthmode");$("tr.editsave",this.el)[t.isEdit||t.canForcesave?"show":"hide"](),$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[!t.isEdit||!t.canChangeCoAuthoring&&e?"hide":"show"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.forcesave",this.el)[t.canForcesave?"show":"hide"](),$("tr.coauth.changes",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),$("tr.spellcheck",this.el)[t.isEdit&&Common.UI.FeaturesManager.canChange("spellcheck")?"show":"hide"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.compactHeader&&t.isEdit?"hide":"show"](),$("tr.tab-background",this.el)[!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)?"show":"hide"](),$("tr.tab-style",this.el)[Common.Utils.isIE||Common.Controllers.Desktop.isWinXp()||!Common.UI.FeaturesManager.canChange("tabStyle",!0)?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.appearance",this.el)[Common.Utils.isIE?"hide":"show"](),t.compactHeader&&$("tr.quick-access",this.el).hide()},setApi:function(t){return this.api=t,this},updateSettings:function(){Common.UI.FeaturesManager.canChange("spellcheck")&&(this.chSpell.setValue(Common.Utils.InternalSettings.get("pe-settings-spellcheck")),this.chIgnoreUppercase.setValue(Common.Utils.InternalSettings.get("pe-spellcheck-ignore-uppercase-words")),this.chIgnoreNumbers.setValue(Common.Utils.InternalSettings.get("pe-spellcheck-ignore-numbers-words"))),this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("pe-settings-show-alt-hints")),this.chScreenReader.setValue(Common.Utils.InternalSettings.get("app-settings-screen-reader"));var t=Common.Utils.InternalSettings.get("pe-settings-zoom");t=null!==t?parseInt(t):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):-1;var e=this.cmbZoom.store.findWhere({value:t});this.cmbZoom.setValue(e?parseInt(e.get("value")):t>0?t+"%":100);var i=Common.Utils.InternalSettings.get("pe-settings-coauthmode");this.rbCoAuthModeFast.setValue(i),this.rbCoAuthModeStrict.setValue(!i),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("pe-settings-coauthmode")),t=Common.Utils.InternalSettings.get("pe-settings-fontrender"),e=this.cmbFontRender.store.findWhere({value:parseInt(t)}),this.cmbFontRender.setValue(e?e.get("value"):Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling),this._fontRender=this.cmbFontRender.getValue(),t=Common.Utils.InternalSettings.get("pe-settings-cachemode"),(e=this.cmbFontRender.store.findWhere({value:"custom"}))&&t&&e.set("checked",!!t),e&&t&&this.cmbFontRender.cmpEl.find("#"+e.get("id")+" a").addClass("checked"),t=Common.Utils.InternalSettings.get("pe-settings-unit"),e=this.cmbUnit.store.findWhere({value:t}),this.cmbUnit.setValue(e?parseInt(e.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),t=Common.Utils.InternalSettings.get("pe-settings-autosave"),this.chAutosave.setValue(1==t),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("pe-settings-forcesave")),this.chAlignGuides.setValue(Common.Utils.InternalSettings.get("pe-settings-showsnaplines")),e=this.cmbMacros.store.findWhere({value:Common.Utils.InternalSettings.get("pe-macros-mode")}),this.cmbMacros.setValue(e?e.get("value"):0),this.lblMacrosDesc.text(e?e.get("descValue"):this.txtWarnMacrosDesc),this.chPaste.setValue(Common.Utils.InternalSettings.get("pe-settings-paste-button"));var n=[];for(var s in Common.UI.Themes.map())n.push({value:s,displayValue:Common.UI.Themes.get(s).text});n.length&&(this.cmbTheme.setData(n),e=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(e?e.get("value"):Common.UI.Themes.defaultThemeId())),this.chTabBack.setValue("toolbar"===Common.Utils.InternalSettings.get("settings-tab-background")),t=Common.Utils.InternalSettings.get("settings-tab-style"),e=this.cmbTabStyle.store.findWhere({value:t}),this.cmbTabStyle.setValue(e?e.get("value"):"fill")},applySettings:function(){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit&&(Common.localStorage.setItem("pe-settings-spellcheck",this.chSpell.isChecked()?1:0),Common.localStorage.setBool("pe-spellcheck-ignore-uppercase-words",this.chIgnoreUppercase.isChecked()),Common.localStorage.setBool("pe-spellcheck-ignore-numbers-words",this.chIgnoreNumbers.isChecked())),Common.localStorage.setItem("pe-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("pe-settings-show-alt-hints",Common.localStorage.getBool("pe-settings-show-alt-hints")),Common.localStorage.setItem("pe-settings-zoom",this.cmbZoom.getValue()),Common.localStorage.setItem("app-settings-screen-reader",this.chScreenReader.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&this.mode.canChangeCoAuthoring?Common.localStorage.setItem("pe-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("pe-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("pe-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("pe-settings-cachemode",t&&!t.get("checked")?0:1),Common.localStorage.setItem("pe-settings-unit",this.cmbUnit.getValue()),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("pe-settings-coauthmode")||Common.localStorage.setItem("pe-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("pe-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.localStorage.setBool("pe-settings-showsnaplines",this.chAlignGuides.isChecked()),Common.localStorage.setItem("pe-macros-mode",this.cmbMacros.getValue()),Common.Utils.InternalSettings.set("pe-macros-mode",this.cmbMacros.getValue()),Common.localStorage.setItem("pe-settings-paste-button",this.chPaste.isChecked()?1:0),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)&&Common.UI.TabStyler.setBackground(this.chTabBack.isChecked()?"toolbar":"header"),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabStyle",!0)&&Common.UI.TabStyler.setStyle(this.cmbTabStyle.getValue()),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this))},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},autoCorrect:function(){this.dlgAutoCorrect&&this.dlgAutoCorrect.isVisible()||(this.dlgAutoCorrect=new Common.Views.AutoCorrectDialog({api:this.api}),this.dlgAutoCorrect.show())},customizeQuickAccess:function(){this.dlgQuickAccess&&this.dlgQuickAccess.isVisible()||(this.dlgQuickAccess=new Common.Views.CustomizeQuickAccessDialog({showSave:this.mode.showSaveButton&&Common.UI.LayoutManager.isElementVisible("header-save"),showPrint:this.mode.canPrint&&this.mode.twoLevelHeader,showQuickPrint:this.mode.canQuickPrint&&this.mode.twoLevelHeader,mode:this.mode,props:{save:Common.localStorage.getBool("pe-quick-access-save",!0),print:Common.localStorage.getBool("pe-quick-access-print",!0),quickPrint:Common.localStorage.getBool("pe-quick-access-quick-print",!0),undo:Common.localStorage.getBool("pe-quick-access-undo",!0),redo:Common.localStorage.getBool("pe-quick-access-redo",!0),startOver:Common.localStorage.getBool("pe-quick-access-start-over",!0)}}),this.dlgQuickAccess.show())},strZoom:"Default Zoom Value",okButtonText:"Apply",txtFitSlide:"Fit to Slide",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",strUnit:"Unit of Measurement",txtCm:"Centimeter",txtPt:"Point",textAutoSave:"Autosave",txtAll:"View All",txtLast:"View Last",textAlignGuides:"Alignment Guides",strCoAuthMode:"Co-editing mode",strFast:"Fast",strStrict:"Strict",textAutoRecover:"Autorecover",txtInch:"Inch",txtFitWidth:"Fit to Width",textForceSave:"Save to Server",txtSpellCheck:"Spell Checking",txtCacheMode:"Default cache mode",strMacrosSettings:"Macros Settings",txtWarnMacros:"Show Notification",txtRunMacros:"Enable All",txtStopMacros:"Disable All",txtWarnMacrosDesc:"Disable all macros with notification",txtRunMacrosDesc:"Enable all macros without notification",txtStopMacrosDesc:"Disable all macros without notification",strPasteButton:"Show Paste Options button when content is pasted",txtProofing:"Proofing",strTheme:"Theme",txtThemeLight:"Light",txtThemeDark:"Dark",txtAutoCorrect:"AutoCorrect options...",txtEditingSaving:"Editing and saving",txtCollaboration:"Collaboration",txtWorkspace:"Workspace",txtHieroglyphs:"Hieroglyphs",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use Option key to navigate the user interface using the keyboard",txtFastTip:"Real-time co-editing. All changes are saved automatically",txtStrictTip:"Use the 'Save' button to sync the changes you and others make",strIgnoreWordsInUPPERCASE:"Ignore words in UPPERCASE",strIgnoreWordsWithNumbers:"Ignore words with numbers",strShowOthersChanges:"Show changes from other users",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtLastUsed:"Last used",txtScreenReader:"Turn on screen reader support",txtCustomizeQuickAccess:"Customize quick access",txtTabBack:"Use toolbar color as tabs background",strTabStyle:"Tab style",textFill:"Fill",textLine:"Line",txtAppearance:"Appearance"},PE.Views.FileMenuPanels.Settings||{})),PE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="blank-document-btn">','<div class="btn-blank-format"><div class="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="thumb" ',"<%  if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank presentation",txtCreateNew:"Create New"},PE.Views.FileMenuPanels.CreateNew||{})),PE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<table class="main">','<tbody><td class="header">'+this.txtPresentationInfo+"</td></tbody>","<tbody>",'<tr><td class="title"><label>'+this.txtCommon+"</label></td></tr>","<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>","<tr></tr>","<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>","</tbody>",'<tbody class="properties-tab">','<tr><td class="title"><label>'+this.txtProperties+"</label></td></tr>",'<tr class="author-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>","</tbody>","<tbody>","<tr>",'<td class="left"></td>','<td class="right">','<button id="fminfo-btn-add-property" class="btn" data-hint="2" data-hint-direction="bottom" data-hint-offset="big">',"<span>"+this.txtAddProperty+"</span>","</button>","</td>","</tr>","</tbody>","</table>"].join("")),this.menu=t.menu,this.coreProps=null,this.authors=[],this._locked=!1},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded");var n=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),n=t.getValue();i!==n&&(t.setValue(n),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putTitle(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putKeywords(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putSubject(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",n).on("changed:after",(function(t,i){e.coreProps.asc_putDescription(i),e.api.asc_setCoreProps(e.coreProps)})),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}" ></div><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var n=i.find(t.target);if(n.hasClass("close")&&!n.hasClass("disabled")){var s=n.closest("tr"),a=e.tblAuthor.find("tr").index(s);s.remove(),e.authors.splice(a,1),e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",(function(t,i,n,s){if(i!=n){var a=i.trim();if(a&&a!==n.trim()){var o=s&&s.relatedTarget&&"fminfo-btn-apply"==s.relatedTarget.id;a.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!o)){var n=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(n),e.updateScroller()}})),!o&&e.inputAuthor.setValue("")}e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps)}})).on("keydown:before",n),this.btnAddProperty=new Common.UI.Button({el:i.findById("#fminfo-btn-add-property")}),this.btnAddProperty.on("click",_.bind(this.onAddPropertyClick,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateScroller:function(t){this.scroller&&this.scroller.update(t?{}:void 0)},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(n=t.info.owner)&&this.lblOwner.text(n),e=this._ShowHideInfoItem(this.lblOwner,!!n)||e,(n=t.info.uploaded)&&this.lblUploaded.text(n),e=this._ShowHideInfoItem(this.lblUploaded,!!n)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getAppProps():null;if(i&&(i=(i.asc_getApplication()||"")+(i.asc_getAppVersion()?" ":"")+(i.asc_getAppVersion()||""),this.lblApplication.text(i)),this._ShowHideInfoItem(this.lblApplication,!!i),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){var n=this.coreProps.asc_getCreated();this.lblDate.text(this.dateToString(n)),this._ShowHideInfoItem(this.lblDate,!!n)}}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=i,i){var n=!1;t=i.asc_getModified(),this.lblModifyDate.text(this.dateToString(t)),n=this._ShowHideInfoItem(this.lblModifyDate,!!t)||n,(t=i.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),n=this._ShowHideInfoItem(this.lblModifyBy,!!t)||n,$("tr.divider.modify",this.el)[n?"show":"hide"](),t=i.asc_getTitle(),this.inputTitle.setValue(t||""),t=i.asc_getKeywords(),this.inputTags.setValue(t||""),t=i.asc_getSubject(),this.inputSubject.setValue(t||""),t=i.asc_getDescription(),this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i.asc_getCreator())&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),!this.mode.isEdit&&this._ShowHideInfoItem(this.tblAuthor,!!this.authors.length)}this.renderCustomProperties(),this.SetDisabled()}},tplCustomProperty:function(t,e,i){return e===AscCommon.c_oVariantTypes.vtBool?i=i?this.txtYes:this.txtNo:e===AscCommon.c_oVariantTypes.vtFiletime&&(i=this.dateToString(new Date(i),!0)),'<tr data-custom-property><td class="left"><label>'+Common.Utils.String.htmlEncode(t)+'</label></td><td class="right"><div class="custom-property-wrapper"><input type="text" spellcheck="false" class="form-control" readonly style="width: 200px;" value="'+i+'"><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></div></td></tr>'},dateToString:function(t,e){var i="";if(t){var n=(this.mode.lang||"en").replace("_","-").toLowerCase();try{n=="ar-SA".toLowerCase()&&(n+="-u-nu-latn-ca-gregory"),i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}catch(s){n="en",i=t.toLocaleString(n,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(n,{timeStyle:"short"}))}}return i},renderCustomProperties:function(){if(this.api){$("tr[data-custom-property]").remove();var t=this.api.asc_getAllCustomProperties();_.each(t,_.bind((function(e,i){var n=this,s=e.asc_getName(),a=e.asc_getType(),o=e.asc_getValue(),l=$(this.tplCustomProperty(s,a,o));$("tbody.properties-tab").append(l),l.on("click",(function(e){if(!l.find("div.disabled").length){var r=l.find(e.target);r.hasClass("close")?(n.api.asc_removeCustomProperty(i),n.renderCustomProperties()):r.hasClass("form-control")&&new Common.Views.DocumentPropertyDialog({title:n.txtDocumentPropertyUpdateTitle,lang:n.mode.lang,defaultValue:{name:s,type:a,value:o},nameValidator:function(e){return e===s||!_.some(t,(function(t){return t.asc_getName()===e}))||n.txtPropertyTitleConflictError},handler:function(t,e,s,a){"ok"===t&&(n.api.asc_modifyCustomProperty(i,e,s,a),n.renderCustomProperties())}}).show()}}))}),this))}},setDisabledCustomProperties:function(t){_.each($("tr[data-custom-property]"),(function(e){$(e).find("div.custom-property-wrapper")[t?"addClass":"removeClass"]("disabled"),$(e).find("div.close")[t?"hide":"show"]()}))},onAddPropertyClick:function(){var t=this;new Common.Views.DocumentPropertyDialog({lang:t.mode.lang,nameValidator:function(e){var i=t.api.asc_getAllCustomProperties();return!_.some(i,(function(t){return t.asc_getName()===e}))||t.txtPropertyTitleConflictError},handler:function(e,i,n,s){"ok"===e&&(t.api.asc_addCustomProperty(i,n,s),t.renderCustomProperties())}}).show()},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.btnAddProperty.setVisible(t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),t.isEdit||(this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder","")),this.SetDisabled(),this},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},onLockCore:function(t){this._locked=t,this.updateFileInfo()},SetDisabled:function(){var t=!this.mode.isEdit||this._locked;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._locked),this.tblAuthor.toggleClass("disabled",t),this.btnAddProperty.setDisabled(t),this.setDisabledCustomProperties(t)},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtAppName:"Application",txtEditTime:"Total Editing time",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtPresentationInfo:"Presentation Info",txtCommon:"Common",txtProperties:"Properties",txtDocumentPropertyUpdateTitle:"Document Property",txtAddProperty:"Add property",txtYes:"Yes",txtNo:"No",txtPropertyTitleConflictError:"Property with this title already exists"},PE.Views.FileMenuPanels.DocumentInfo||{})),PE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary auto">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.findById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},PE.Views.FileMenuPanels.DocumentRights||{})),PE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Presentation Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new presentation or open an existing one",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteUndoRedo.htm",name:"Copy/paste data, undo/redo your actions"},{src:"UsageInstructions/ManageSlides.htm",name:"Manage slides",headername:"Working with slides"},{src:"UsageInstructions/SetSlideParameters.htm",name:"Set slide parameters"},{src:"UsageInstructions/ApplyTransitions.htm",name:"Apply transitions"},{src:"UsageInstructions/PreviewPresentation.htm",name:"Preview your presentation"},{src:"UsageInstructions/InsertText.htm",name:"Insert and format your text",headername:"Text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/CreateLists.htm",name:"Create lists"},{src:"UsageInstructions/CopyClearFormatting.htm",name:"Copy/clear formatting"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert and format autoshapes",headername:"Operations on objects"},{src:"UsageInstructions/InsertImages.htm",name:"Insert and adjust images"},{src:"UsageInstructions/InsertCharts.htm",name:"Insert and edit charts"},{src:"UsageInstructions/InsertTables.htm",name:"Insert and format tables"},{src:"UsageInstructions/FillObjectsSelectColor.htm",name:"Fill objects and select colors"},{src:"UsageInstructions/ManipulateObjects.htm",name:"Manipulate objects on a slide"},{src:"UsageInstructions/AlignArrangeObjects.htm",name:"Align and arrange objects on a slide"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative presentation editing",headername:"Presentation co-editing"},{src:"UsageInstructions/ViewPresentationInfo.htm",name:"View presentation information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/print/download your presentation"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Presentation Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search function"},{src:"HelpfulHints/SpellChecking.htm",name:"Spell-checking"},{src:"HelpfulHints/About.htm",name:"About Presentation Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of electronic presentations"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,n){t.onSelectItem(n.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var n={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(n)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(n)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(n),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}}),PE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectPresentation %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasSigned) { %>hidden<% } %>"">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</div>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=PE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var t=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e&&t.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide(),PE.getController("RightMenu").rightmenu.SetActivePane(Common.Utils.documentSettingsType.Signature,!0)},updateSignatures:function(){var t=this.api.asc_getSignatures(),e=!1,i=!1;_.each(t,(function(t,n){0==t.asc_getValid()?e=!0:i=!0}));var n=i?this.txtSignedInvalid:e?this.txtSigned:"";this.cntSignatureView.html(this.templateSignature({tipText:n,hasSigned:e||i}));var s=this.btnAddInvisibleSign.$el.find("button").hasClass("hidden");this.cntAddSignature.toggleClass("hidden",s),this.cntAddedSignature.toggleClass("hidden",!s)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)},strProtect:"Protect Presentation",strSignature:"With Signature",txtView:"View signatures",txtEdit:"Edit presentation",txtSigned:"Valid signatures has been added to the presentation. The presentation is protected from editing.",txtSignedInvalid:"Some of the digital signatures in presentation are invalid or could not be verified. The presentation is protected from editing.",notcriticalErrorTitle:"Warning",txtEditWarning:"Editing will remove the signatures from the presentation.<br>Are you sure you want to continue?",strEncrypt:"With Password",txtProtectPresentation:"Encrypt this presentation with a password",txtEncrypted:"A password is required to open this presentation",txtAddSignature:"Ensure the integrity of the presentation by adding an<br>invisible digital signature",txtAddedSignature:"Valid signatures have been added to the presentation.<br>The presentation is protected from editing."},PE.Views.FileMenuPanels.ProtectDoc||{})),PE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrinter %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-printer" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table style="width: 100%;"><tbody>','<tr><td class="padding-large"><%= scope.txtPages %>:</td><td class="padding-large" style="width: 100%;"><div id="print-txt-pages" class="padding-left-5" style="width: 100%;"></div></td></tr>','<tr><td><%= scope.txtCopies %>:</td><td style="width: 100%;"><div id="print-txt-copies" class="padding-left-5" style="width: 60px;"></div></td></tr>',"</tr></tbody></table>","</td></tr>",'<tr><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPaperSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr class="header-settings"><td class="padding-large"><label class="link" id="print-header-footer-settings" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtHeaderFooterSettings %></label></td></tr>','<tr><td class="padding-large"><label class="link" id="print-btn-system-dialog" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtPrintUsingSystemDialog %></label></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print" class="btn normal dlg-btn primary margin-right-8" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-print-pdf" class="btn normal dlg-btn" result="pdf" style="min-width: 96px;width: auto;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintPdf %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview"></div>','<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>","</div>","</div>",'<div id="print-preview-empty" class="hidden">',"<div><%= scope.txtEmptyTable %></div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._defaultPaperSizeList=[{value:0,displayValue:["US Letter","21,59","27,94","cm"],caption:"US Letter",size:[215.9,279.4]},{value:1,displayValue:["US Legal","21,59","35,56","cm"],caption:"US Legal",size:[215.9,355.6]},{value:2,displayValue:["A4","21","29,7","cm"],caption:"A4",size:[210,297]},{value:3,displayValue:["A5","14,8","21","cm"],caption:"A5",size:[148,210]},{value:4,displayValue:["B5","17,6","25","cm"],caption:"B5",size:[176,250]},{value:5,displayValue:["Envelope #10","10,48","24,13","cm"],caption:"Envelope #10",size:[104.8,241.3]},{value:6,displayValue:["Envelope DL","11","22","cm"],caption:"Envelope DL",size:[110,220]},{value:7,displayValue:["Tabloid","27,94","43,18","cm"],caption:"Tabloid",size:[279.4,431.8]},{value:8,displayValue:["A3","29,7","42","cm"],caption:"A3",size:[297,420]},{value:9,displayValue:["Tabloid Oversize","29,69","45,72","cm"],caption:"Tabloid Oversize",size:[296.9,457.2]},{value:10,displayValue:["ROC 16K","19,68","27,3","cm"],caption:"ROC 16K",size:[196.8,273]},{value:11,displayValue:["Envelope Choukei 3","12","23,5","cm"],caption:"Envelope Choukei 3",size:[120,235]},{value:12,displayValue:["Super B/A3","30,5","48,7","cm"],caption:"Super B/A3",size:[305,487]},{value:13,displayValue:["A4","84,1","118,9","cm"],caption:"A0",size:[841,1189]},{value:14,displayValue:["A4","59,4","84,1","cm"],caption:"A1",size:[594,841]},{value:16,displayValue:["A4","42","59,4","cm"],caption:"A2",size:[420,594]},{value:17,displayValue:["A4","10,5","14,8","cm"],caption:"A6",size:[105,148]}],this._initSettings=!0,this._originalPageSize=void 0},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));this.cmbPrinter=new Common.UI.ComboBox({el:i.findById("#print-combo-printer"),menuStyle:"width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",placeHolder:this.txtPrinterNotSelected,itemsTemplate:_.template(["<% if (items.length > 0) { %>","<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","<% } else { %>",'<li><a style="background:none; cursor: default;" onclick="event.stopPropagation();">'+this.txtPrintersNotFound+"</a></li>","<% } %>"].join("")),data:[],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPrinter.on("selected",_.bind(this.onPrinterSelected,this)),this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"all",displayValue:this.txtAllPages},{value:"current",displayValue:this.txtCurrentPage},{value:-1,displayValue:this.txtCustomPages}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.setValue("all"),this.inputPages=new Common.UI.InputField({el:i.findById("#print-txt-pages"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one");var n=Common.UI.isRTL()?_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" dir="ltr">','(<span dir="rtl"><%= item.displayValue[2] %> <%= item.displayValue[3] %></span>',"<span> x </span>",'<span dir="rtl"><%= item.displayValue[1] %> <%= item.displayValue[3] %></span>)',"<span> <%= item.displayValue[0] %></span>","</a></li>","<% }); %>"].join("")):_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue[0] %>"," (<%= item.displayValue[1] %> <%= item.displayValue[3] %> x"," <%= item.displayValue[2] %> <%= item.displayValue[3] %>)","</a></li>","<% }); %>"].join("")),s=_.template(['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; width: 248px; <%= style %>"',Common.UI.isRTL()?'dir="rtl"':"","></div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(n).concat(["</ul>","</div>"]).join(""));return this.cmbPaperSize=new Common.UI.ComboBoxCustom({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; width: 248px;",editable:!1,takeFocusOnClose:!0,template:s,itemsTemplate:n,data:[].concat(this._defaultPaperSizeList),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t,e){var i=$(this.el).find(".form-control");if(t||e){var n=e||t.get("displayValue");"string"==typeof n?i[0].innerHTML=n:Common.UI.isRTL()?i[0].innerHTML='<span dir="ltr">(<span dir="rtl">'+n[2]+" "+n[3]+'</span><span> x </span><span dir="rtl">'+n[1]+" "+n[3]+"</span>)<span> "+n[0]+"</span></span>":i[0].innerHTML=n[0]+" ("+n[1]+" "+n[3]+" x "+n[2]+" "+n[3]+")"}else i[0].innerHTML=""}}),this.cmbPaperSize.setValue(2),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrintSystemDialog=i.findById("#print-btn-system-dialog"),this.btnPrint=new Common.UI.Button({el:i.findById("#print-btn-print"),disabled:!0}),this.btnPrintPdf=new Common.UI.Button({el:i.findById("#print-btn-print-pdf")}),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.$el=$(t).html(i),this.$el.on("click","#print-header-footer-settings",_.bind(this.openHeaderSettings,this)),this.$previewBox=$("#print-preview-box"),this.$previewEmpty=$("#print-preview-empty"),this.applyMode(),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateCmbPrinter:function(t,e){var i;e=e||[],t&&!_.some(e,(function(e){return e.name==t}))&&e.push({name:t,duplex_supported:!0,paperSupported:this._defaultPaperSizeList}),i=e.map((function(t){return{value:t.name,displayValue:t.name,paperSupported:t.paper_supported,isDuplexSupported:t.duplex_supported}})),this.cmbPrinter.setData(i),this.cmbPrinter.setValue(t),this.cmbPrinter.trigger("selected",this,this.cmbPrinter.getSelectedRecord())},setCmbSidesOptions:function(t){var e=this.cmbSides.getValue(),i=[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc}];t?i.push({value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}):"one"!=e&&(e="one"),this.cmbSides.setData(i),this.cmbSides.setValue(e)},setCmbPaperSizeOptions:function(t){var e=[];e=t&&t.length>0?t.map((function(t,e){return{value:e,displayValue:[t.name,t.width/10,t.height/10,"cm"],caption:t.name,size:[t.width,t.height]}})):[].concat(this._defaultPaperSizeList);var i=this.cmbPaperSize.store.findWhere({value:this.cmbPaperSize.getValue()}),n=null;function s(t,e,i){return _.find(t,(function(t){return Math.abs(t.size[0]-e)<.1&&Math.abs(t.size[1]-i)<.1}))}if(i&&(n=s(e,Math.round(i.get("size")[0]),Math.round(i.get("size")[1]))),!n)if(i)n={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[0]).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[1]).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]};else{const t=this._originalPageSize?this._originalPageSize.w:210,i=this._originalPageSize?this._originalPageSize.h:297;n||(n=s(e,t,i)),n||(n={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(t).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]}),!n&&e[0]&&(n=e[0])}this.cmbPaperSize.setData(e),this.updatePaperSizeMetricUnit(),n?n.custom?this.cmbPaperSize.setValue(void 0,n.value):this.cmbPaperSize.setValue(n.value):this.cmbPaperSize.setValue(null)},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.height()+25+this.$el.find(".main-header").outerHeight(!0);this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update()}},setMode:function(t){this.mode=t,!this._initSettings&&this.applyMode()},applyMode:function(){this.mode&&this.$el&&this.$el.find(".header-settings")[this.mode.isEdit?"show":"hide"]()},setApi:function(t){},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},onPrinterSelected:function(t,e){this.setCmbSidesOptions(!e||e.isDuplexSupported),this.setCmbPaperSizeOptions(e?e.paperSupported:null),this.btnPrint.setDisabled(!e)},updateMetricUnit:function(){this.updatePaperSizeMetricUnit()},updatePaperSizeMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length;e++){var i=t.at(e),n=i.get("size"),s=n[0],a=n[1];i.set("displayValue",[i.get("caption"),parseFloat(Common.Utils.Metric.fnRecalcFromMM(s).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(a).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()])}this.cmbPaperSize.onResetItems()}},openHeaderSettings:function(){this.fireEvent("openheader",this)},setOriginalPageSize:function(t,e){this._originalPageSize={w:t,h:e}},txtPrint:"Print",txtPrintPdf:"Print to PDF",txtPrinter:"Printer",txtPrinterNotSelected:"Printer not selected",txtPrintersNotFound:"Printers not found",txtPrintUsingSystemDialog:"Print using the system dialog",txtPrintRange:"Print range",txtCurrentPage:"Current slide",txtAllPages:"All slides",txtCustom:"Custom",txtCustomPages:"Custom print",txtPage:"Slide",txtOf:"of {0}",txtPageNumInvalid:"Slide number invalid",txtEmptyTable:"There is nothing to print because the presentation is empty",txtPages:"Slides",txtPaperSize:"Paper size",txtCopies:"Copies",txtPrintSides:"Print sides",txtOneSide:"Print one sided",txtOneSideDesc:"Only print on one side of the page",txtBothSides:"Print on both sides",txtBothSidesLongDesc:"Flip pages on long edge",txtBothSidesShortDesc:"Flip pages on short edge",txtHeaderFooterSettings:"Header/footer settings"},PE.Views.PrintWithPreview||{}))})),define("presentationeditor/main/app/view/DocumentHolderExt",[],(function(){"use strict";if(window.PE&&window.PE.Views&&window.PE.Views.DocumentHolder){let t=window.PE.Views.DocumentHolder.prototype;t.createDelayedElementsViewer=function(){var t=this;if(!t.menuViewCopy){t.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuViewUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo icon-rtl",caption:t.textUndo});var e=new Common.UI.MenuItem({caption:"--"});t.menuViewAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",initMenu:function(i){t.menuViewUndo.setVisible(t.mode.canCoAuthoring&&t.mode.canComments&&!t._isDisabled),t.menuViewUndo.setDisabled(!t.api.asc_getCanUndo()),e.setVisible(!i.isChart&&!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments&&!t._isDisabled),t.menuViewAddComment.setVisible(!i.isChart&&!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments&&!t._isDisabled),t.menuViewAddComment.setDisabled(i.locked);var n=t.api&&t.api.can_CopyCut();t.menuViewCopy.setDisabled(!n)},items:[t.menuViewCopy,t.menuViewUndo,e,t.menuViewAddComment]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),t.mnuPreview=new Common.UI.MenuItem({iconCls:"menu__icon btn-preview",caption:t.txtPreview}),t.mnuSelectAll=new Common.UI.MenuItem({caption:t.txtSelectAll}),t.mnuPrintSelection=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection}),this.viewModeMenuSlide=new Common.UI.Menu({cls:"shifted-right",initMenu:function(e){t.mnuSelectAll.setDisabled(t.slidesCount<2),t.mnuPrintSelection.setVisible(t.mode.canPrint&&!0===e.fromThumbs),t.mnuPrintSelection.setDisabled(t.slidesCount<1),t.mnuPreview.setDisabled(t.slidesCount<1)},items:[t.mnuSelectAll,t.mnuPrintSelection,{caption:"--"},t.mnuPreview]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),this.fireEvent("createdelayedelements",[this,"view"])}},t.createDelayedElements=function(){var t=this;if(!t.mnuDeleteSlide&&window.styles_loaded){t.mnuDeleteSlide=new Common.UI.MenuItem({caption:t.txtDeleteSlide}),t.mnuChangeSlide=new Common.UI.MenuItem({iconCls:"menu__icon btn-changeslide",caption:t.txtChangeLayout,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="id-docholder-menu-changeslide" class="menu-layouts" style="width: 302px; margin: 0 4px;"></div>')}]})}),t.mnuResetSlide=new Common.UI.MenuItem({caption:t.txtResetLayout}),t.mnuNewSlide=new Common.UI.MenuItem({caption:t.txtNewSlide}),t.mnuDuplicateSlide=new Common.UI.MenuItem({caption:t.txtDuplicateSlide});var e=new Common.UI.MenuItem({caption:t.txtChangeTheme,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="id-docholder-menu-changetheme" style="width: 289px; margin: 0 4px;"></div>')}]})});t.mnuPreview=new Common.UI.MenuItem({iconCls:"menu__icon btn-preview",caption:t.txtPreview}),t.mnuSelectAll=new Common.UI.MenuItem({caption:t.txtSelectAll}),t.mnuPrintSelection=new Common.UI.MenuItem({iconCls:"menu__icon btn-print",caption:t.txtPrintSelection}),t.mnuMoveSlideToStart=new Common.UI.MenuItem({caption:t.txtMoveSlidesToStart}),t.mnuMoveSlideToEnd=new Common.UI.MenuItem({caption:t.txtMoveSlidesToEnd}),t.menuSlidePaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuSlideSettings=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-slide",caption:t.textSlideSettings,value:null}),t.mnuSlideHide=new Common.UI.MenuItem({caption:t.txtSlideHide,checkable:!0,checked:!1}),t.mnuGuides=new Common.UI.MenuItem({caption:t.textGuides,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textShowGuides,value:"show",checkable:!0},{caption:"--"},{caption:t.textAddVGuides,iconCls:"menu__icon btn-vertical-guide",value:"add-vert"},{caption:t.textAddHGuides,iconCls:"menu__icon btn-horizontal-guide",value:"add-hor"},{caption:t.textDeleteGuide,value:"del-guide"},{caption:"--"},{caption:t.textSmartGuides,value:"smart",checkable:!0},{caption:t.textClearGuides,value:"clear"}]})}),t.mnuGridlines=new Common.UI.MenuItem({caption:t.textGridlines,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textShowGridlines,value:"show",checkable:!0},{caption:t.textSnapObjects,value:"snap",checkable:!0},{caption:"--"},{caption:"--"},{caption:t.textCustom,value:"custom"}]})}),t.mnuRulers=new Common.UI.MenuItem({caption:t.textRulers,checkable:!0}),t.slideMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(i){var n=t.api.asc_IsLastSlideSelected(),s=t.api.asc_IsFirstSlideSelected();if(t.menuSlidePaste.setVisible(!0!==i.fromThumbs),t.mnuNewSlide.setVisible(!0===i.fromThumbs),t.mnuDuplicateSlide.setVisible(!0===i.isSlideSelect),t.mnuDeleteSlide.setVisible(!0===i.isSlideSelect),t.mnuSlideHide.setVisible(!0===i.isSlideSelect),t.mnuSlideHide.setChecked(!0===i.isSlideHidden),t.slideMenu.items[5].setVisible(!0===i.isSlideSelect||!0!==i.fromThumbs),t.mnuChangeSlide.setVisible(!t.api.asc_IsMasterMode()&&(!0===i.isSlideSelect||!0!==i.fromThumbs)),t.mnuResetSlide.setVisible(!t.api.asc_IsMasterMode()&&(!0===i.isSlideSelect||!0!==i.fromThumbs)),e.setVisible(!0===i.isSlideSelect||!0!==i.fromThumbs),t.menuSlideSettings.setVisible(!0===i.isSlideSelect||!0!==i.fromThumbs),t.menuSlideSettings.options.value=null,t.slideMenu.items[10].setVisible(!i.fromThumbs),t.mnuGuides.setVisible(!i.fromThumbs),t.mnuGridlines.setVisible(!i.fromThumbs),t.mnuRulers.setVisible(!i.fromThumbs),t.slideMenu.items[14].setVisible(!0===i.fromThumbs),t.mnuSelectAll.setVisible(!0===i.fromThumbs),t.mnuPrintSelection.setVisible(t.mode.canPrint&&!0===i.fromThumbs),t.slideMenu.items[17].setVisible(!(n&&s||!0!==i.isSlideSelect)),t.mnuMoveSlideToEnd.setVisible(!n&&!0===i.isSlideSelect),t.mnuMoveSlideToStart.setVisible(!s&&!0===i.isSlideSelect),t.slideMenu.items[20].setVisible(!0===i.fromThumbs),t.mnuPreview.setVisible(!0===i.fromThumbs),!i.fromThumbs){t.mnuGuides.menu.items[0].setChecked(t.api.asc_getShowGuides(),!0),i.guide&&(t.mnuGuides.menu.items[4].setVisible(!!i.guide.guideId),t.mnuGuides.menu.items[4].options.guideId=i.guide.guideId),t.mnuGuides.menu.items[6].setChecked(t.api.asc_getShowSmartGuides(),!0);var a=!!Common.Utils.InternalSettings.get("pe-lock-view-props");t.mnuGuides.menu.items[2].setDisabled(a),t.mnuGuides.menu.items[3].setDisabled(a),t.mnuGuides.menu.items[4].setDisabled(a),t.mnuGuides.menu.items[7].setDisabled(a||!t.api.asc_canClearGuides()),t.mnuGridlines.menu.items[0].setChecked(t.api.asc_getShowGridlines(),!0),t.mnuGridlines.menu.items[1].setChecked(t.api.asc_getSnapToGrid(),!0);var o=Common.Utils.Metric.fnRecalcFromMM(t.api.asc_getGridSpacing()/36e3),l=t.mnuGridlines.menu.items;if(t._state.unitsChanged){for(var r=3;r<l.length-2;r++)t.mnuGridlines.menu.removeItem(l[r]),r--;var c=Common.define.gridlineData.getGridlineData(Common.Utils.Metric.getCurrentMetric());for(r=0;r<c.length;r++){var d=new Common.UI.MenuItem({caption:c[r].caption,value:c[r].value,checkable:!0,toggleGroup:"mnu-gridlines"});t.mnuGridlines.menu.insertItem(3+r,d)}t._state.unitsChanged=!1}for(r=3;r<l.length-2;r++){var p=l[r];p.value<1&&Math.abs(p.value-o)<.005||p.value>=1&&Math.abs(p.value-o)<.001?p.setChecked(!0):p.setChecked(!1),p.setDisabled(a)}t.mnuGridlines.menu.items[1].setDisabled(a),t.mnuGridlines.menu.items[l.length-1].setDisabled(a),t.mnuRulers.setChecked(!Common.Utils.InternalSettings.get("pe-hidden-rulers"))}var h=t.api.getSelectedElements(),m=!1,u=!1,g=!1;h&&_.isArray(h)&&_.each(h,(function(e,i){if(Asc.c_oAscTypeSelectElement.Slide==e.get_ObjectType()){var n=e.get_ObjectValue();return m=n.get_LockDelete(),u=n.get_LockRemove(),g=n.get_LockLayout(),t.menuSlideSettings.options.value=e,t.slideLayoutMenu.options.layout_index=n.get_LayoutIndex(),!1}}));for(r=0;r<3;r++)t.slideMenu.items[r].setDisabled(m);t.mnuPreview.setDisabled(t.slidesCount<1),t.mnuSelectAll.setDisabled(t.slidesCount<2),t.mnuDeleteSlide.setDisabled(u||m),t.mnuChangeSlide.setDisabled(g||m),t.mnuResetSlide.setDisabled(g||m),e.setDisabled(t._state.themeLock||m),t.mnuSlideHide.setDisabled(g||m),t.mnuPrintSelection.setDisabled(t.slidesCount<1)},items:[t.menuSlidePaste,t.mnuNewSlide,t.mnuDuplicateSlide,t.mnuDeleteSlide,t.mnuSlideHide,{caption:"--"},t.mnuChangeSlide,t.mnuResetSlide,e,t.menuSlideSettings,{caption:"--"},t.mnuGuides,t.mnuGridlines,t.mnuRulers,{caption:"--"},t.mnuSelectAll,t.mnuPrintSelection,{caption:"--"},t.mnuMoveSlideToStart,t.mnuMoveSlideToEnd,{caption:"--"},t.mnuPreview]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})).on("render:after",(function(i){t.slideLayoutMenu=new Common.UI.DataView({el:$("#id-docholder-menu-changeslide"),parentMenu:t.mnuChangeSlide.menu,style:"max-height: 300px;",restoreWidth:302,store:PE.getCollection("SlideLayouts"),itemTemplate:_.template(['<div class="layout" id="<%= id %>" style="width: <%= itemWidth %>px;">','<div style="background-image: url(<%= imageUrl %>); width: <%= itemWidth %>px; height: <%= itemHeight %>px;background-size: contain;"></div>','<div class="title"><%- title %></div> ',"</div>"].join(""))}).on("item:click",(function(e,i,n,s){"click"!==s.type&&t.slideMenu.hide(),t.fireEvent("layout:change",[n])})),t.slideMenu&&t.mnuChangeSlide.menu.on("show:after",(function(e){t.onSlidePickerShowAfter(t.slideLayoutMenu),t.slideLayoutMenu.scroller.update({alwaysVisibleY:!0});var i=t.slideLayoutMenu.store.findLayoutByIndex(t.slideLayoutMenu.options.layout_index);i&&(t.slideLayoutMenu.selectRecord(i,!0),t.slideLayoutMenu.scrollToRecord(i))})),t.slideLayoutMenu._needRecalcSlideLayout=!0,t.listenTo(PE.getCollection("SlideLayouts"),"reset",(function(){t.slideLayoutMenu._needRecalcSlideLayout=!0})),t.slideThemeMenu=new Common.UI.DataView({el:$("#id-docholder-menu-changetheme"),parentMenu:e.menu,style:"max-height: 300px;",store:PE.getCollection("SlideThemes"),itemTemplate:_.template(['<div class="style" id="<%= id %>"">','<div class="item-theme" style="<% if (typeof imageUrl !== "undefined") { %>background-image: url(<%= imageUrl %>);<% } %> background-position: 0 -<%= offsety %>px;"></div>',"</div>"].join(""))}).on("item:click",(function(e,i,n,s){"click"!==s.type&&t.slideMenu.hide(),t.fireEvent("theme:change",[n])})),t.slideMenu&&e.menu.on("show:after",(function(e){var i=t.slideThemeMenu.store.findWhere({themeId:t._state.themeId});t.slideThemeMenu.selectRecord(i,!0),t.slideThemeMenu.scroller.update({alwaysVisibleY:!0}),t.slideThemeMenu.scroller.scrollTop(0)}))})),t.mnuInsertMaster=new Common.UI.MenuItem({caption:t.textInsertSlideMaster,value:"ins-master"}),t.mnuInsertLayout=new Common.UI.MenuItem({caption:t.textInsertLayout,value:"ins-layout"}),t.mnuDuplicateMaster=new Common.UI.MenuItem({caption:t.textDuplicateSlideMaster,value:"duplicate-master"}),t.mnuPreserveMaster=new Common.UI.MenuItem({caption:t.textPreserveSlideMaster,value:"preserve-master",checkable:!0}),t.mnuDeleteMaster=new Common.UI.MenuItem({caption:t.textDeleteMaster,value:"delete-master"}),t.mnuDuplicateLayout=new Common.UI.MenuItem({caption:t.textDuplicateLayout,value:"duplicate-master"}),t.mnuDeleteLayout=new Common.UI.MenuItem({caption:t.textDeleteLayout,value:"delete-layout"}),t.mnuRenameMaster=new Common.UI.MenuItem({caption:t.textRenameMaster,value:"Rename-master"}),t.mnuRenameLayout=new Common.UI.MenuItem({caption:t.textRenameLayout,value:"Rename-layout"}),t.slideMasterMenu=new Common.UI.Menu({restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){var i=e.isMaster,n="",s=t.api.getSelectedElements();s&&_.isArray(s)&&_.each(s,(function(t){if(Asc.c_oAscTypeSelectElement.Slide==t.get_ObjectType()){var e=t.get_ObjectValue();n=i?e.get_MasterName():e.get_LayoutName()}})),t.mnuRenameMaster.setDisabled(void 0===n),t.mnuRenameLayout.setDisabled(void 0===n),t.mnuDuplicateMaster.setVisible(i),t.mnuPreserveMaster.setVisible(i),t.mnuPreserveMaster.setChecked(e.isPreserve,!0),t.mnuDeleteMaster.setVisible(i),t.mnuRenameMaster.setVisible(i),t.mnuDuplicateLayout.setVisible(!i),t.mnuDeleteLayout.setVisible(!i),t.mnuRenameLayout.setVisible(!i),i&&t.mnuDeleteMaster.setDisabled(!t.api.asc_CanDeleteMaster()),!i&&t.mnuDeleteLayout.setDisabled(!t.api.asc_CanDeleteLayout())},items:[t.mnuInsertMaster,t.mnuInsertLayout,t.mnuDuplicateMaster,t.mnuPreserveMaster,t.mnuDuplicateLayout,{caption:"--"},t.mnuDeleteMaster,t.mnuRenameMaster,t.mnuDeleteLayout,t.mnuRenameLayout]}),t.mnuTableMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-merge-cells",caption:t.mergeCellsText}),t.mnuTableSplit=new Common.UI.MenuItem({caption:t.splitCellsText}),t.menuTableCellAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.cellAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuTableCellTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Top}),t.menuTableCellCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Center}),t.menuTableCellBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,checkable:!0,checkmark:!1,toggleGroup:"popuptablecellalign",value:Asc.c_oAscVertAlignJc.Bottom})]})}),t.menuTableSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var i=new Common.UI.MenuItem({caption:"--"});t.menuTableDistRows=new Common.UI.MenuItem({caption:t.textDistributeRows}),t.menuTableDistCols=new Common.UI.MenuItem({caption:t.textDistributeCols}),t.menuTableSelectText=new Common.UI.MenuItem({caption:t.selectText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.cellText,value:2}),new Common.UI.MenuItem({caption:t.tableText,value:3})]})}),t.menuTableInsertText=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:t.insertText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",style:"width: 100px",items:[new Common.UI.MenuItem({caption:t.insertColumnLeftText,value:0}),new Common.UI.MenuItem({caption:t.insertColumnRightText,value:1}),new Common.UI.MenuItem({caption:t.insertRowAboveText,value:2}),new Common.UI.MenuItem({caption:t.insertRowBelowText,value:3})]})}),t.menuTableDeleteText=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:t.deleteText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.rowText,value:0}),new Common.UI.MenuItem({caption:t.columnText,value:1}),new Common.UI.MenuItem({caption:t.tableText,value:2})]})}),t.menuSpellTable=new Common.UI.MenuItem({caption:t.loadSpellText,disabled:!0}),t.menuSpellMoreTable=new Common.UI.MenuItem({caption:t.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})});var n=_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" langval="<%= value %>" class="<% if (checked) { %> checked <% } %>">',"<div>",'<i class="icon <% if (spellcheck) { %> toolbar__icon btn-ic-docspell spellcheck-lang <% } %>"></i>',"<%= caption %>","</div>",'<label style="opacity: 0.6"><%= captionEn %></label>',"</a>"].join(""));t.langTableMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:t.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu shifted-right",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:n,search:!0,searchFields:["caption","captionEn"],focusToCheckedItem:!0})}),t.menuIgnoreSpellTable=new Common.UI.MenuItem({caption:t.ignoreSpellText,value:!1}),t.menuIgnoreAllSpellTable=new Common.UI.MenuItem({caption:t.ignoreAllSpellText,value:!0}),t.menuToDictionaryTable=new Common.UI.MenuItem({caption:t.toDictionaryText});var s=new Common.UI.MenuItem({caption:"--"}),a=new Common.UI.MenuItem({caption:"--"});t.menuSpellCheckTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-docspell",caption:t.spellcheckText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuSpellTable,t.menuSpellMoreTable,s,t.menuIgnoreSpellTable,t.menuIgnoreAllSpellTable,t.menuToDictionaryTable,{caption:"--"},t.langTableMenu]})}),t.menuSpellPara=new Common.UI.MenuItem({caption:t.loadSpellText,disabled:!0}),t.menuSpellMorePara=new Common.UI.MenuItem({caption:t.moreText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",restoreHeight:!0,items:[]})}),t.langParaMenu=new Common.UI.MenuItem({iconCls:"menu__icon btn-ic-doclang",caption:t.langText,menu:new Common.UI.MenuSimple({cls:"lang-menu shifted-right",menuAlign:"tl-tr",restoreHeight:285,items:[],itemTemplate:n,search:!0,searchFields:["caption","captionEn"],focusToCheckedItem:!0})}),t.menuIgnoreSpellPara=new Common.UI.MenuItem({caption:t.ignoreSpellText,value:!1}),t.menuIgnoreAllSpellPara=new Common.UI.MenuItem({caption:t.ignoreAllSpellText,value:!0}),t.menuToDictionaryPara=new Common.UI.MenuItem({caption:t.toDictionaryText});var o=new Common.UI.MenuItem({caption:"--"}),l=new Common.UI.MenuItem({caption:"--"});t.menuTableAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-table",caption:t.advancedTableText});var r=new Common.UI.MenuItem({caption:"--"});t.menuImageAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:t.advancedImageText}),t.menuShapeAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-shape",caption:t.advancedShapeText}),t.menuParagraphAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:t.advancedParagraphText}),t.menuChartAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-chart",caption:t.advancedChartText});var c=new Common.UI.MenuItem({caption:"--"}),d=new Common.UI.MenuItem({caption:"--"});t.menuAddHyperlinkPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuEditHyperlinkPara=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkPara=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var p=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkPara,t.menuRemoveHyperlinkPara]})});t.menuAddHyperlinkTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText}),t.menuEditHyperlinkTable=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkTable=new Common.UI.MenuItem({caption:t.removeHyperlinkText});var h=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.hyperlinkText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkTable,t.menuRemoveHyperlinkTable]})});t.mnuGroupImg=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group"}),t.mnuUnGroupImg=new Common.UI.MenuItem({caption:this.txtUngroup,iconCls:"menu__icon btn-shape-ungroup"}),t.mnuArrangeFront=new Common.UI.MenuItem({caption:this.textArrangeFront,iconCls:"menu__icon btn-arrange-front"}),t.mnuArrangeBack=new Common.UI.MenuItem({caption:this.textArrangeBack,iconCls:"menu__icon btn-arrange-back"}),t.mnuArrangeForward=new Common.UI.MenuItem({caption:this.textArrangeForward,iconCls:"menu__icon btn-arrange-forward"}),t.mnuArrangeBackward=new Common.UI.MenuItem({caption:this.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward"});var m=new Common.UI.MenuItem({caption:t.txtArrange,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.mnuArrangeFront,t.mnuArrangeBack,t.mnuArrangeForward,t.mnuArrangeBackward,{caption:"--"},t.mnuGroupImg,t.mnuUnGroupImg]})});t.menuImgShapeAlign=new Common.UI.MenuItem({caption:t.txtAlign,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:Asc.c_oAscAlignShapeType.ALIGN_LEFT}),new Common.UI.MenuItem({caption:t.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:Asc.c_oAscAlignShapeType.ALIGN_CENTER}),new Common.UI.MenuItem({caption:t.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:Asc.c_oAscAlignShapeType.ALIGN_RIGHT}),new Common.UI.MenuItem({caption:t.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:Asc.c_oAscAlignShapeType.ALIGN_TOP}),new Common.UI.MenuItem({caption:t.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:Asc.c_oAscAlignShapeType.ALIGN_MIDDLE}),new Common.UI.MenuItem({caption:t.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:Asc.c_oAscAlignShapeType.ALIGN_BOTTOM}),{caption:"--"},new Common.UI.MenuItem({caption:t.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6}),new Common.UI.MenuItem({caption:t.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7})]})});var u=PE.getController("Toolbar").getView("Toolbar");t.menuShapesMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-combine-shapes",caption:t.textShapesMerge,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:u.textShapesUnion,iconCls:"menu__icon btn-union-shapes",value:"unite"}),new Common.UI.MenuItem({caption:u.textShapesCombine,iconCls:"menu__icon btn-combine-shapes",value:"exclude"}),new Common.UI.MenuItem({caption:u.textShapesFragment,iconCls:"menu__icon btn-fragment-shapes",value:"divide"}),new Common.UI.MenuItem({caption:u.textShapesIntersect,iconCls:"menu__icon btn-intersect-shapes",value:"intersect"}),new Common.UI.MenuItem({caption:u.textShapesSubstract,iconCls:"menu__icon btn-substract-shapes",value:"subtract"})]})}),t.menuChartEdit=new Common.UI.MenuItem({caption:t.editChartText}),t.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.textShapeAlignTop,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Top}),t.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.textShapeAlignMiddle,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Center}),t.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.textShapeAlignBottom,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Bottom})]})}),t.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:t.directionText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphDirectH=new Common.UI.MenuItem({caption:t.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),t.menuParagraphDirect90=new Common.UI.MenuItem({caption:t.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),t.menuParagraphDirect270=new Common.UI.MenuItem({caption:t.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})});var g=new Common.UI.MenuItem({caption:"--"});t.menuImgOriginalSize=new Common.UI.MenuItem({caption:t.originalSizeText}),t.menuImgReplace=new Common.UI.MenuItem({caption:t.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:0}),new Common.UI.MenuItem({caption:this.textFromUrl,value:1}),new Common.UI.MenuItem({caption:this.textFromStorage,value:2})]})}),t.menuImgShapeRotate=new Common.UI.MenuItem({caption:t.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:t.textRotate90,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:t.textRotate270,value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:t.textFlipH,value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:t.textFlipV,value:0})]})}),t.menuImgCrop=new Common.UI.MenuItem({caption:t.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:t.textCropFill,value:1}),new Common.UI.MenuItem({caption:t.textCropFit,value:2})]})}),t.menuImgResetCrop=new Common.UI.MenuItem({caption:t.textResetCrop,iconCls:"menu__icon btn-reset"}),t.menuImgSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var b=new Common.UI.MenuItem({caption:"--"});t.menuAddCommentPara=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentPara.hide(),t.menuAddCommentTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentTable.hide(),t.menuAddCommentImg=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",caption:t.addCommentText}),t.menuAddCommentImg.hide(),t.menuParaCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuParaPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuParaCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"}),t.menuTableCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.textCopy,value:"copy"}),t.menuTablePaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.textPaste,value:"paste"}),t.menuTableCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.textCut,value:"cut"});var f=new Common.UI.MenuItem({caption:"--"}),v=new Common.UI.MenuItem({caption:"--"}),C=new Common.UI.MenuItem({caption:"--"});t.menuParagraphEquation=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popupparaeqinput","tl-tr")}),t.menuTableEquationSettings=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popuptableeqinput","tl-tr")}),t.menuImgEditPoints=new Common.UI.MenuItem({iconCls:"menu__icon btn-edit-points",caption:t.textEditPoints}),t.textMenu=new Common.UI.Menu({cls:"shifted-right",scrollToCheckedItem:!1,initMenu:function(e){var i=e.shapeProps&&!_.isNull(e.shapeProps.value),n=e.chartProps&&!_.isNull(e.chartProps.value),s=void 0!==e.paraProps&&e.paraProps.locked||void 0!==e.slideProps&&e.slideProps.locked||i&&e.shapeProps.locked,a=e.mathProps&&e.mathProps.value;if(t._currentParaObjDisabled=s,t.menuParagraphVAlign.setVisible(i&&!n&&!a),t.menuParagraphDirection.setVisible(i&&!n&&!a),i||n){var r=e.shapeProps.value.get_VerticalTextAlign(),c="";switch(r){case Asc.c_oAscVAlign.Top:c="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:c="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:c="menu__icon btn-align-bottom"}t.menuParagraphVAlign.setIconCls(c),t.menuParagraphTop.setChecked(r==Asc.c_oAscVAlign.Top),t.menuParagraphCenter.setChecked(r==Asc.c_oAscVAlign.Center),t.menuParagraphBottom.setChecked(r==Asc.c_oAscVAlign.Bottom);var h=e.shapeProps.value.get_Vert();switch(c="",h){case Asc.c_oAscVertDrawingText.normal:c="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:c="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:c="menu__icon btn-text-orient-rup"}t.menuParagraphDirection.setIconCls(c),t.menuParagraphDirectH.setChecked(h==Asc.c_oAscVertDrawingText.normal),t.menuParagraphDirect90.setChecked(h==Asc.c_oAscVertDrawingText.vert),t.menuParagraphDirect270.setChecked(h==Asc.c_oAscVertDrawingText.vert270)}else t.menuParagraphVAlign.setIconCls(""),t.menuParagraphDirection.setIconCls("");t.menuParagraphVAlign.setDisabled(s),t.menuParagraphDirection.setDisabled(s);var m=null;t.api&&(m=t.api.can_AddHyperlink()),t.menuAddHyperlinkPara.setVisible(void 0===e.hyperProps&&!1!==m),p.setVisible(void 0!==e.hyperProps),t.menuEditHyperlinkPara.hyperProps=e.hyperProps,!1!==m&&(t.menuAddHyperlinkPara.hyperProps={},t.menuAddHyperlinkPara.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkPara.hyperProps.value.put_Text(m)),t.menuAddCommentPara.setVisible(!n&&i&&!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments),d.setVisible(t.menuAddCommentPara.isVisible()||t.menuAddHyperlinkPara.isVisible()||p.isVisible()),t.menuAddHyperlinkPara.setDisabled(s),p.setDisabled(s),t.menuAddCommentPara.setDisabled(s),t.menuParagraphAdvanced.setDisabled(s);var u=t.api&&t.api.can_CopyCut();t.menuParaCopy.setDisabled(!u),t.menuParaCut.setDisabled(s||!u),t.menuParaPaste.setDisabled(s);var g=void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked();t.menuSpellPara.setVisible(g),l.setVisible(g),t.menuIgnoreSpellPara.setVisible(g),t.menuIgnoreAllSpellPara.setVisible(g),t.menuToDictionaryPara.setVisible(g&&t.mode.isDesktopApp),t.langParaMenu.setVisible(g),t.langParaMenu.setDisabled(s),o.setVisible(g),g&&null!==e.spellProps.value.get_Variants()&&void 0!==e.spellProps.value.get_Variants()?t.addWordVariants(!0):(t.menuSpellPara.setCaption(t.loadSpellText),t.clearWordVariants(!0),t.menuSpellMorePara.setVisible(!1)),t.langParaMenu.isVisible()&&t._currLang.id!==t._currLang.paraid&&(t.changeLanguageMenu(t.langParaMenu.menu),t._currLang.paraid=t._currLang.id);var b=0;if(a?b=t.addEquationMenu(t.textMenu,12):t.clearEquationMenu(t.textMenu,12),f.setVisible(a&&b>0),t.menuParagraphEquation.setVisible(a),t.menuParagraphEquation.setDisabled(s),a){var v=t.api.asc_GetMathInputType(),C=Common.Utils.InternalSettings.get("pe-equation-toolbar-hide");t.menuParagraphEquation.menu.items[5].setChecked(v===Asc.c_oAscMathInputType.Unicode),t.menuParagraphEquation.menu.items[6].setChecked(v===Asc.c_oAscMathInputType.LaTeX),t.menuParagraphEquation.menu.items[8].options.isToolbarHide=C,t.menuParagraphEquation.menu.items[8].setCaption(C?t.showEqToolbar:t.hideEqToolbar)}},items:[t.menuSpellPara,t.menuSpellMorePara,l,t.menuIgnoreSpellPara,t.menuIgnoreAllSpellPara,t.menuToDictionaryPara,t.langParaMenu,o,t.menuParaCut,t.menuParaCopy,t.menuParaPaste,f,{caption:"--"},t.menuParagraphVAlign,t.menuParagraphDirection,t.menuParagraphAdvanced,t.menuParagraphEquation,d,t.menuAddCommentPara,t.menuAddHyperlinkPara,p]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),t.tableMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){if(!_.isUndefined(e.tableProps)){for(var n=e.mathProps&&e.mathProps.value,s=6;s<18;s++)t.tableMenu.items[s].setVisible(!n);var o=void 0!==e.slideProps&&e.slideProps.locked,l=e.tableProps.value.get_CellsVAlign(),c="";switch(l){case Asc.c_oAscVertAlignJc.Top:c="menu__icon btn-align-top";break;case Asc.c_oAscVertAlignJc.Center:c="menu__icon btn-align-middle";break;case Asc.c_oAscVertAlignJc.Bottom:c="menu__icon btn-align-bottom"}t.menuTableCellAlign.setIconCls(c),t.menuTableCellTop.setChecked(l==Asc.c_oAscVertAlignJc.Top),t.menuTableCellCenter.setChecked(l==Asc.c_oAscVertAlignJc.Center),t.menuTableCellBottom.setChecked(l==Asc.c_oAscVertAlignJc.Bottom),t.api&&(t.mnuTableMerge.setDisabled(e.tableProps.locked||o||!t.api.CheckBeforeMergeCells()),t.mnuTableSplit.setDisabled(e.tableProps.locked||o||!t.api.CheckBeforeSplitCells())),t.menuTableDistRows.setDisabled(e.tableProps.locked||o),t.menuTableDistCols.setDisabled(e.tableProps.locked||o),t.tableMenu.items[7].setDisabled(e.tableProps.locked||o),t.tableMenu.items[8].setDisabled(e.tableProps.locked||o),t.menuTableCellAlign.setDisabled(e.tableProps.locked||o),t.menuTableSaveAsPicture.setVisible(!n),i.setVisible(!n),t.menuTableAdvanced.setVisible(!n),t.menuTableAdvanced.setDisabled(e.tableProps.locked||o),r.setVisible(t.menuTableAdvanced.isVisible());var d=t.api&&t.api.can_CopyCut();t.menuTableCopy.setDisabled(!d),t.menuTableCut.setDisabled(e.tableProps.locked||o||!d),t.menuTablePaste.setDisabled(e.tableProps.locked||o);var p=null;t.api&&(p=t.api.can_AddHyperlink()),t.menuAddHyperlinkTable.setVisible(!_.isUndefined(e.paraProps)&&_.isUndefined(e.hyperProps)&&!1!==p),h.setVisible(!_.isUndefined(e.paraProps)&&!_.isUndefined(e.hyperProps)),t.menuEditHyperlinkTable.hyperProps=e.hyperProps,!1!==p&&(t.menuAddHyperlinkTable.hyperProps={},t.menuAddHyperlinkTable.hyperProps.value=new Asc.CHyperlinkProperty,t.menuAddHyperlinkTable.hyperProps.value.put_Text(p)),_.isUndefined(e.paraProps)||(t.menuAddHyperlinkTable.setDisabled(e.paraProps.locked||o),h.setDisabled(e.paraProps.locked||o),t._currentParaObjDisabled=e.paraProps.locked||o),t.menuAddCommentTable.setVisible(!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments),t.menuAddCommentTable.setDisabled(!_.isUndefined(e.paraProps)&&e.paraProps.locked||o),t.menuSpellCheckTable.setVisible(void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()),t.menuToDictionaryTable.setVisible(t.mode.isDesktopApp),a.setVisible(void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()),t.langTableMenu.setDisabled(o),void 0!==e.spellProps&&!1===e.spellProps.value.get_Checked()&&null!==e.spellProps.value.get_Variants()&&void 0!==e.spellProps.value.get_Variants()?t.addWordVariants(!1):(t.menuSpellTable.setCaption(t.loadSpellText),t.clearWordVariants(!1),t.menuSpellMoreTable.setVisible(!1)),t.menuSpellCheckTable.isVisible()&&t._currLang.id!==t._currLang.tableid&&(t.changeLanguageMenu(t.langTableMenu.menu),t._currLang.tableid=t._currLang.id);var m=0;if(n?m=t.addEquationMenu(t.tableMenu,6):t.clearEquationMenu(t.tableMenu,6),v.setVisible(m>0),t.menuTableEquationSettings.setVisible(n),C.setVisible(n),t.menuTableEquationSettings.setDisabled(o),n){var u=t.api.asc_GetMathInputType(),g=Common.Utils.InternalSettings.get("pe-equation-toolbar-hide");t.menuTableEquationSettings.menu.items[5].setChecked(u===Asc.c_oAscMathInputType.Unicode),t.menuTableEquationSettings.menu.items[6].setChecked(u===Asc.c_oAscMathInputType.LaTeX),t.menuTableEquationSettings.menu.items[8].options.isToolbarHide=g,t.menuTableEquationSettings.menu.items[8].setCaption(g?t.showEqToolbar:t.hideEqToolbar)}}},items:[t.menuSpellCheckTable,a,t.menuTableCut,t.menuTableCopy,t.menuTablePaste,{caption:"--"},t.menuTableSelectText,t.menuTableInsertText,t.menuTableDeleteText,{caption:"--"},t.mnuTableMerge,t.mnuTableSplit,{caption:"--"},t.menuTableDistRows,t.menuTableDistCols,{caption:"--"},t.menuTableCellAlign,{caption:"--"},v,t.menuTableSaveAsPicture,i,t.menuTableAdvanced,r,t.menuTableEquationSettings,C,t.menuAddCommentTable,t.menuAddHyperlinkTable,h]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),t.menuEditObjectSeparator=new Common.UI.MenuItem({caption:"--"}),t.menuEditObject=new Common.UI.MenuItem({caption:t.textEditObject}),t.pictureMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,initMenu:function(e){t.api&&(t.mnuUnGroupImg.setDisabled(!t.api.canUnGroup()),t.mnuGroupImg.setDisabled(!t.api.canGroup()));var i=(_.isUndefined(e.shapeProps)||e.shapeProps.value.get_FromImage())&&_.isUndefined(e.chartProps),n=void 0!==e.imgProps&&e.imgProps.locked,s=void 0!==e.shapeProps&&e.shapeProps.locked,a=void 0!==e.chartProps&&e.chartProps.locked,o=n||s||a||void 0!==e.slideProps&&e.slideProps.locked,l=e.imgProps?e.imgProps.value.asc_getPluginGuid():null,r=e.shapeProps&&e.shapeProps.value.get_FromSmartArtInternal(),d=null!=l;if(t.menuEditObject.setVisible(d),t.menuEditObjectSeparator.setVisible(d),d){var p=PE.getCollection("Common.Collections.Plugins").findWhere({guid:l});t.menuEditObject.setDisabled(!t.api.asc_canEditTableOleObject()&&null==p||o)}t.mnuArrangeFront.setDisabled(r),t.mnuArrangeBack.setDisabled(r),t.mnuArrangeForward.setDisabled(r),t.mnuArrangeBackward.setDisabled(r),t.menuImgShapeRotate.setVisible(_.isUndefined(e.chartProps)&&null==l),t.menuImgShapeRotate.isVisible()&&(t.menuImgShapeRotate.setDisabled(o||e.shapeProps&&e.shapeProps.value.get_FromSmartArt()),t.menuImgShapeRotate.menu.items[3].setDisabled(r),t.menuImgShapeRotate.menu.items[4].setDisabled(r)),t.menuImgOriginalSize.setVisible(i),t.menuImgOriginalSize.isVisible()&&t.menuImgOriginalSize.setDisabled(o||_.isNull(e.imgProps.value.get_ImageUrl())||_.isUndefined(e.imgProps.value.get_ImageUrl())),t.menuImgReplace.setVisible(i&&null==l),t.menuImgReplace.isVisible()&&t.menuImgReplace.setDisabled(o||null===l),t.menuImgReplace.menu.items[2].setVisible(t.mode.canRequestInsertImage||t.mode.fileChoiceUrl&&t.mode.fileChoiceUrl.indexOf("{documentType}")>-1),t.menuImgCrop.setVisible(t.api.asc_canEditCrop()),t.menuImgCrop.isVisible()&&t.menuImgCrop.setDisabled(o),t.menuImgResetCrop.setVisible(i&&e.imgProps.value.asc_getIsCrop()),t.menuImgResetCrop.isVisible()&&t.menuImgResetCrop.setDisabled(o);var h=t.api&&t.api.asc_canEditGeometry();if(t.menuImgEditPoints.setVisible(h),h&&t.menuImgEditPoints.setDisabled(o),t.menuImageAdvanced.setVisible(i),t.menuShapeAdvanced.setVisible(_.isUndefined(e.imgProps)&&_.isUndefined(e.chartProps)),t.menuChartEdit.setVisible(_.isUndefined(e.imgProps)&&!_.isUndefined(e.chartProps)&&(_.isUndefined(e.shapeProps)||e.shapeProps.isChart)),t.menuChartAdvanced.setVisible(_.isUndefined(e.imgProps)&&!_.isUndefined(e.chartProps)&&(_.isUndefined(e.shapeProps)||e.shapeProps.isChart)),g.setVisible(t.menuImageAdvanced.isVisible()||t.menuShapeAdvanced.isVisible()||t.menuChartEdit.isVisible()||t.menuChartAdvanced.isVisible()),c.setVisible(t.menuImgCrop.isVisible()||t.menuImgOriginalSize.isVisible()||t.menuImgReplace.isVisible()||t.menuImageAdvanced.isVisible()||t.menuImgEditPoints.isVisible()||t.menuShapeAdvanced.isVisible()||t.menuChartEdit.isVisible()||t.menuChartAdvanced.isVisible()),t.menuAddCommentImg.setVisible(!1!==t.api.can_AddQuotedComment()&&t.mode.canCoAuthoring&&t.mode.canComments),t.menuAddCommentImg.setDisabled(o),t.menuImgShapeAlign.setDisabled(o),!o){var u=t.api.asc_getSelectedDrawingObjectsCount(),b=Common.Utils.InternalSettings.get("pe-align-to-slide")||!1;t.menuImgShapeAlign.menu.items[7].setDisabled(2==u&&!b),t.menuImgShapeAlign.menu.items[8].setDisabled(2==u&&!b)}t.menuShapesMerge.setDisabled(o||!t.api.asc_canMergeSelectedShapes()),t.menuShapesMerge.isDisabled()||t.menuShapesMerge.menu.items.forEach((function(e){e.setDisabled(!t.api.asc_canMergeSelectedShapes(e.value))})),t.menuImageAdvanced.setDisabled(o),t.menuShapeAdvanced.setDisabled(o),t.menuChartAdvanced.setDisabled(o),t.menuChartEdit.isVisible()&&t.menuChartEdit.setDisabled(o);var f=t.api&&t.api.can_CopyCut();t.menuImgCopy.setDisabled(!f),t.menuImgCut.setDisabled(o||!f),t.menuImgPaste.setDisabled(o),m.setDisabled(o)},items:[t.menuImgCut,t.menuImgCopy,t.menuImgPaste,t.menuEditObjectSeparator,t.menuEditObject,{caption:"--"},m,t.menuImgShapeAlign,t.menuShapesMerge,t.menuImgShapeRotate,g,t.menuImgSaveAsPicture,b,t.menuImgCrop,t.menuImgResetCrop,t.menuImgOriginalSize,t.menuImgReplace,t.menuImageAdvanced,t.menuImgEditPoints,t.menuShapeAdvanced,t.menuChartEdit,t.menuChartAdvanced,c,t.menuAddCommentImg]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)})),t.menuAnimStartOnClick=new Common.UI.MenuItem({caption:t.textStartOnClick,checkable:!0,value:AscFormat.NODE_TYPE_CLICKEFFECT}),t.menuAnimStartWithPrevious=new Common.UI.MenuItem({caption:t.textStartWithPrevious,checkable:!0,value:AscFormat.NODE_TYPE_WITHEFFECT}),t.menuAnimStartAfterPrevious=new Common.UI.MenuItem({caption:t.textStartAfterPrevious,checkable:!0,value:AscFormat.NODE_TYPE_AFTEREFFECT}),t.menuAnimRemove=new Common.UI.MenuItem({caption:t.textRemove,value:"remove"}),t.animEffectMenu=new Common.UI.Menu({restoreHeightAndTop:!0,scrollToCheckedItem:!1,style:"min-width: auto;",initMenu:function(e){t.menuAnimStartOnClick.setChecked(e.effect===AscFormat.NODE_TYPE_CLICKEFFECT,!0),t.menuAnimStartWithPrevious.setChecked(e.effect===AscFormat.NODE_TYPE_WITHEFFECT,!0),t.menuAnimStartAfterPrevious.setChecked(e.effect===AscFormat.NODE_TYPE_AFTEREFFECT,!0)},items:[t.menuAnimStartOnClick,t.menuAnimStartWithPrevious,t.menuAnimStartAfterPrevious,{caption:"--"},t.menuAnimRemove]}).on("hide:after",(function(e,i,n){t.clearCustomItems(e),t.currentMenu=null,t.suppressEditComplete?t.suppressEditComplete=!1:n||t.fireEvent("editcomplete",t)}));var y=$("#id_buttonNextPage");y.attr("data-toggle","tooltip"),y.tooltip({title:t.textNextPage+Common.Utils.String.platformKey("PgDn"),placement:"top-right"});var x=$("#id_buttonPrevPage");x.attr("data-toggle","tooltip"),x.tooltip({title:t.textPrevPage+Common.Utils.String.platformKey("PgUp"),placement:"top-right"}),this.fireEvent("createdelayedelements",[this,"edit"])}}}})),define("text!presentationeditor/main/app/template/ParagraphSettingsAdvanced.template",[],(function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <div>\r\n            <div class="padding-large" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textAlign %></label>\r\n                <div id="paragraphadv-spin-text-alignment"></div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-very-small"><label class="header"><%= scope.strIndent %></label></div>\r\n        <div>\r\n            <div class="padding-large margin-right-3" style="display: inline-block;">\r\n                <label id="paragraphadv-lbl-indent-left" class="input-label"><%= scope.strIndentsLeftText %></label>\r\n                <div id="paragraphadv-spin-indent-left"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\r\n                <label id="paragraphadv-lbl-indent-right" class="input-label"><%= scope.strIndentsRightText %></label>\r\n                <div id="paragraphadv-spin-indent-right"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\r\n                <div>\r\n                    <label class="input-label"><%= scope.strIndentsSpecial %></label>\r\n                </div>\r\n                <div>\r\n                    <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                 --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-very-small"><label class="header"><%= scope.strSpacing %></label></div>\r\n        <div>\r\n            <div class="margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\r\n                <div id="paragraphadv-spin-spacing-before"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\r\n                <div id="paragraphadv-spin-spacing-after"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div style="display: inline-block;vertical-align: top">\r\n                <div>\r\n                    <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\r\n                </div>\r\n                <div>\r\n                    <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                 --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div style="padding-top: 16px;"><label class="header padding-very-small"><%= scope.strDirection %></label></div>\r\n        <div>\r\n            <div id="paragraphadv-dir-ltr" class="margin-right-20" style="display: inline-block;"></div><div id="paragraphadv-dir-rtl" class="margin-left-20" style="display: inline-block;"></div>\r\n        </div>\r\n        <div class="padding-large" style="padding-top: 16px; display: none;">\r\n            <div style="border: 1px solid #cbcbcb; width: 350px;">\r\n                <div id="paragraphadv-indent-preview" style="height: 58px; position: relative;"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-font" class="settings-panel">\r\n    <div class="inner-content" style="width: 100%;">\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textEffects %></label>\r\n        </div>\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-subscript"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-double-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-small-caps"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="paragraphadv-checkbox-superscript"></div>\r\n                </td>\r\n                <td class="padding-large padding-left-40">\r\n                    <div id="paragraphadv-checkbox-all-caps"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textCharacterSpacing %></label>\r\n        </div>\r\n        <div class="padding-large">\r\n            <div style="display: inline-block;">\r\n                <div id="paragraphadv-spin-spacing"></div>\r\n            </div>\r\n        </div>\r\n        <div class="doc-content-color" style="border: 1px solid #cbcbcb;">\r\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-tabs" class="settings-panel">\r\n    <div class="inner-content">\r\n        <div class="padding-large">\r\n            <label class="input-label"><%= scope.textDefault %></label>\r\n            <div id="paraadv-spin-default-tab"></div>\r\n\r\n        </div>\r\n        <div>\r\n            <div class="padding-large margin-right-9" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textTabPosition %></label>\r\n                <div id="paraadv-spin-tab"></div>\r\n            </div>\r\n            <div class="padding-large margin-right-9" style=" display: inline-block;">\r\n                <label class="input-label"><%= scope.textAlign %></label>\r\n                <div id="paraadv-cmb-align"></div>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <div colspan=3 class="padding-large">\r\n                <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width:108px; display: inline-block;"><%= scope.textSet %></button>\r\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\r\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\r\n        </div>\r\n    </div>\r\n</div>'})),define("presentationeditor/main/app/view/ParagraphSettingsAdvanced",["text!presentationeditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,contentHeight:309,toggleGroup:"paragraph-adv-settings-group",storageName:"pe-para-settings-adv-category"},initialize:function(e){var i=this;_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.spinners=[],this.FirstLine=void 0,this.Spacing=null,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this._arrLineRule=[{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}];var n=this._originalProps.get_Spacing().get_LineRule(),s=_.findWhere(this._arrLineRule,{value:n});this.CurLineRuleIdx=this._arrLineRule.indexOf(s),this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach((function(t){i._arrKeyTabAlign[t.value]=t.displayValue}))},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.cmbTextAlignment.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putJc(e.value>-1?e.value:null)}),this)),this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsLeft.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue();this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Left(Common.Utils.Metric.fnRecalcToMM(s)))}),this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.get_Ind().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numIndentsRight),this.lblIndentsLeft=$("#paragraphadv-lbl-indent-left"),this.lblIndentsRight=$("#paragraphadv-lbl-indent-right"),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind((function(t,e,i,n){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}var a=t.getNumberValue();this.Spacing.put_Before(a<0?-1:Common.Utils.Metric.fnRecalcToMM(a))}),this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind((function(t,e,i,n){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}var a=t.getNumberValue();this.Spacing.put_After(a<0?-1:Common.Utils.Metric.fnRecalcToMM(a))}),this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.rbDirLtr=new Common.UI.RadioBox({el:$("#paragraphadv-dir-ltr"),name:"text-dir",labelText:this.textDirLtr,value:!1}),this.rbDirLtr.on("change",_.bind(this.onTextDirChange,this)),this.rbDirRtl=new Common.UI.RadioBox({el:$("#paragraphadv-dir-rtl"),name:"text-dir",labelText:this.textDirRtl,value:!0}),this.rbDirRtl.on("change",_.bind(this.onTextDirChange,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:100,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind((function(t,e,i,n){if(this._changedProps&&this._changedProps.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_TextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}}),this)),this.spinners.push(this.numSpacing),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.put_DefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))}),this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width: 117px;display: inline-block;"><%= value %></div>','<div style="display: inline-block;"><%= displayTabAlign %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));var e=function(){t._noApply||(t._tabListChanged=!0)};this.listenTo(this.tabList.store,"add",e),this.listenTo(this.tabList.store,"remove",e),this.listenTo(this.tabList.store,"reset",e),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.cmbTextAlignment,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.rbDirLtr,this.rbDirRtl,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numDefaultTab,this.numTab,this.cmbAlign,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll]).concat(this.getFooterButtons())},onCategoryClick:function(t,e,i,n){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var s=this;setTimeout((function(){switch(e){case 0:s.cmbTextAlignment.focus();break;case 1:s.chStrike.focus(),n&&n instanceof jQuery.Event&&s.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s._originalProps||new Asc.asc_CParagraphProperty);break;case 2:s.numDefaultTab.focus()}}),10)},onAnimateAfter:function(){1==this.getActiveCategory()&&this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){return this._tabListChanged&&(null!==this._changedProps.get_Tabs()&&void 0!==this._changedProps.get_Tabs()||this._changedProps.put_Tabs(new Asc.asc_CParagraphTabs),this.tabList.store.each((function(t,e){var i=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"));this._changedProps.get_Tabs().add_Tab(i)}),this)),null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing),{paragraphProps:this._changedProps}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.FirstLine=null!==t.get_Ind()?t.get_Ind().get_FirstLine():null,this.numIndentsLeft.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Left()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Left()):"",!0),this.numIndentsRight.setValue(null!==t.get_Ind()&&null!==t.get_Ind().get_Right()?Common.Utils.Metric.fnRecalcFromMM(t.get_Ind().get_Right()):"",!0),this.cmbTextAlignment.setValue(void 0!==t.get_Jc()&&null!==t.get_Jc()?t.get_Jc():""),void 0===this.CurSpecial&&(this.CurSpecial=0===t.get_Ind().get_FirstLine()?c_paragraphSpecial.NONE_SPECIAL:t.get_Ind().get_FirstLine()>0?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0);var e=t.get_Spacing()?t.get_Spacing().get_Before():null;this.numSpacingBefore.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0),e=t.get_Spacing()?t.get_Spacing().get_After():null,this.numSpacingAfter.setValue(null!==e?e<0?e:Common.Utils.Metric.fnRecalcFromMM(e):"",!0);var i=t.get_Spacing().get_LineRule();this.cmbLineRule.setValue(null!==i?i:""),null!==t.get_Spacing()&&null!==t.get_Spacing().get_Line()?this.numLineHeight.setValue(i==c_paragraphLinerule.LINERULE_AUTO?t.get_Spacing().get_Line():Common.Utils.Metric.fnRecalcFromMM(t.get_Spacing().get_Line()),!0):this.numLineHeight.setValue("",!0),void 0!==(e=t.asc_getRtlDirection())&&(this.rbDirRtl.setValue(e,!0),this.rbDirLtr.setValue(!e,!0)),this.lblIndentsLeft.text(e?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(e?this.strIndentsSpacingAfter:this.strIndentsRightText),this._noApply=!0,this.chStrike.setValue(null!==t.get_Strikeout()&&void 0!==t.get_Strikeout()?t.get_Strikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.get_DStrikeout()&&void 0!==t.get_DStrikeout()?t.get_DStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.get_Subscript()&&void 0!==t.get_Subscript()?t.get_Subscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.get_Superscript()&&void 0!==t.get_Superscript()?t.get_Superscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.get_SmallCaps()&&void 0!==t.get_SmallCaps()?t.get_SmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.get_AllCaps()&&void 0!==t.get_AllCaps()?t.get_AllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.get_TextSpacing()&&void 0!==t.get_TextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.get_TextSpacing()):"",!0),this.numDefaultTab.setValue(null!==t.get_DefaultTab()&&void 0!==t.get_DefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.get_DefaultTab().toFixed(1))):"",!0);var n=this.tabList.store,s=t.get_Tabs();if(s){for(var a=[],o=s.get_Count(),l=0;l<o;l++){var r=s.get_Tab(l),c=Common.Utils.Metric.fnRecalcFromMM(parseFloat(r.get_Pos().toFixed(1))),d=new Common.UI.DataViewModel;d.set({tabPos:c,value:parseFloat(c.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:r.get_Value(),displayTabAlign:this._arrKeyTabAlign[r.get_Value()]}),a.push(d)}n.reset(a,{silent:!1}),this.tabList.selectByIndex(0)}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}if(this._arrLineRule[1].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[1].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[1].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx){var i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0];this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step)}},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},onStrikeChange:function(t,e,i,n){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_Strikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.put_DStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Strikeout("checked"==t.getValue()),s.put_DStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onDoubleStrikeChange:function(t,e,i,n){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.put_DStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.put_Strikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_DStrikeout("checked"==t.getValue()),s.put_Strikeout("checked"==this.chStrike.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSuperscriptChange:function(t,e,i,n){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Superscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.put_Subscript(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Superscript("checked"==t.getValue()),s.put_Subscript("checked"==this.chSubscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSubscriptChange:function(t,e,i,n){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.put_Subscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.put_Superscript(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_Subscript("checked"==t.getValue()),s.put_Superscript("checked"==this.chSuperscript.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onSmallCapsChange:function(t,e,i,n){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_SmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.put_AllCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_SmallCaps("checked"==t.getValue()),s.put_AllCaps("checked"==this.chAllCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},onAllCapsChange:function(t,e,i,n){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.put_AllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.put_SmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;s.put_AllCaps("checked"==t.getValue()),s.put_SmallCaps("checked"==this.chSmallCaps.getValue()),this.api.SetDrawImagePlaceParagraph("paragraphadv-font-img",s)}},addTab:function(t,e){var i=this.numTab.getNumberValue(),n=this.cmbAlign.getValue(),s=this._arrKeyTabAlign[n],a=this.tabList.store,o=a.find((function(t){return Math.abs(t.get("tabPos")-i)<.001}));o?(o.set("tabAlign",n),o.set("displayTabAlign",s),this._tabListChanged=!0):((o=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:n,displayTabAlign:s}),a.add(o)),this.tabList.selectRecord(o),this.tabList.scrollToRecord(o)},removeTab:function(t,e){var i=this.tabList.getSelectedRec();if(i){var n=this.tabList.store,s=_.indexOf(n.models,i);n.remove(i),s>n.length-1&&(s=n.length-1),n.length>0&&(this.tabList.selectByIndex(s),this.tabList.scrollToRecord(n.at(s)))}},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var n={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;n=i.toJSON()}else n=i;this.numTab.setValue(n.tabPos),this.cmbAlign.setValue(n.tabAlign)}},onSpecialSelect:function(t,e){if(this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue());0===i&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.get_Ind().put_FirstLine(i)}},onFirstLineChange:function(t,e,i,n){if(this._changedProps){null!==this._changedProps.get_Ind()&&void 0!==this._changedProps.get_Ind()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var s=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue());this.CurSpecial===c_paragraphSpecial.HANGING?s=-s:this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&s>0?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===s&&(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)),this._changedProps.get_Ind().put_FirstLine(s)}},onLineRuleSelect:function(t,e){if(null===this.Spacing){var i=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=i.get_Spacing()}this.Spacing.put_LineRule(e.value);var n=_.findWhere(this._arrLineRule,{value:e.value}),s=this._arrLineRule.indexOf(n);this.CurLineRuleIdx!==s&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[s].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[s].minValue),this.numLineHeight.setStep(this._arrLineRule[s].step),this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[s].defaultValue):this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[s].defaultValue)),this.CurLineRuleIdx=s)},onNumLineHeightChange:function(t,e,i,n){if(""!==this.cmbLineRule.getRawValue()){if(null===this.Spacing){var s=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=s.get_Spacing()}this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}},onTextDirChange:function(t,e,i){e&&this._changedProps&&(this._changedProps.asc_putRtlDirection(t.options.value),this.lblIndentsLeft.text(t.options.value?this.strIndentsSpacingBefore:this.strIndentsLeftText),this.lblIndentsRight.text(t.options.value?this.strIndentsSpacingAfter:this.strIndentsRightText))},textTitle:"Paragraph - Advanced Settings",strIndentsLeftText:"Left",strIndentsRightText:"Right",strParagraphIndents:"Indents & Spacing",strParagraphFont:"Font",textEffects:"Effects",textCharacterSpacing:"Character Spacing",strDoubleStrike:"Double strikethrough",strStrike:"Strikethrough",strSuperscript:"Superscript",strSubscript:"Subscript",strSmallCaps:"Small caps",strAllCaps:"All caps",strTabs:"Tab",textSet:"Specify",textRemove:"Remove",textRemoveAll:"Remove All",textTabLeft:"Left",textTabRight:"Right",textTabCenter:"Center",textAlign:"Alignment",textTabPosition:"Tab Position",textDefault:"Default Tab",noTabs:"The specified tabs will appear in this field",textJustified:"Justified",strIndentsSpecial:"Special",textNoneSpecial:"(none)",textFirstLine:"First line",textHanging:"Hanging",strIndentsSpacingBefore:"Before",strIndentsSpacingAfter:"After",strIndentsLineSpacing:"Line Spacing",txtAutoText:"Auto",textAuto:"Multiple",textExact:"Exactly",strIndent:"Indents",strSpacing:"Spacing"},PE.Views.ParagraphSettingsAdvanced||{}))})),define("text!presentationeditor/main/app/template/ShapeSettingsAdvanced.template",[],(function(){return'<div id="id-adv-shape-general" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="1" width="100%" role="presentation">\r\n        <tr>\r\n            <td class="padding-large">\r\n                <label class="header"><%= scope.textShapeName %></label>\r\n                <div id="shape-general-object-name"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-width" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="3" role="presentation">\r\n            <tr>\r\n                <td colspan="3" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textSize %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td width="93px">\r\n                    <label class="input-label"><%= scope.textWidth %></label>\r\n                    <div id="shape-advanced-spin-width"></div>\r\n                </td>\r\n                <td width="28px" style="vertical-align: bottom;">\r\n                    <div id="shape-advanced-button-ratio"></div>\r\n                </td>\r\n                <td width="93px">\r\n                    <label class="input-label"><%= scope.textHeight %></label>\r\n                    <div id="shape-advanced-spin-height"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="4" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textPosition %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="121px">\r\n                    <label class="input-label"><%= scope.textHorizontal %></label>\r\n                    <div id="shape-advanced-spin-x"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="shape-advanced-combo-from-x"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textVertical %></label>\r\n                    <div id="shape-advanced-spin-y"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="shape-advanced-combo-from-y"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-rotate" class="settings-panel active">\r\n    <div class="inner-content  padding-large">\r\n        <div style="width: 100%;">\r\n            <label class="input-label"><%= scope.textAngle %></label>\r\n            <div id="shape-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content  padding-large">\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\r\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="shape-advanced-checkbox-hor"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-advanced-checkbox-vert"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-shape" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textLineStyle %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large" width="125px">\r\n                    <label class="input-label"><%= scope.textCapType %></label>\r\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textJoinType %></label>\r\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textArrows %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\r\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndStyle %></label>\r\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBeginSize %></label>\r\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndSize %></label>\r\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-margins" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="header"><%= scope.textAutofit %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-radio-nofit"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-radio-shrink"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="shape-radio-fit"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="separator horizontal padding-large"></div>\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.strMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="shape-margin-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="shape-margin-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="shape-margin-bottom"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="shape-margin-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-columns" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textColNumber %></label>\r\n                    <div id="shape-columns-number"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textSpacing %></label>\r\n                    <div id="shape-columns-spacing"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="shape-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="shape-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("presentationeditor/main/app/view/ShapeSettingsAdvanced",["text!presentationeditor/main/app/template/ShapeSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.ShapeSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:270,toggleGroup:"shape-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"pe-shape-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-shape-general",panelCaption:this.textGeneral},{panelId:"id-adv-shape-width",panelCaption:this.textPlacement},{panelId:"id-adv-shape-rotate",panelCaption:this.textRotation},{panelId:"id-adv-shape-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-shape-margins",panelCaption:this.textTextBox},{panelId:"id-adv-shape-columns",panelCaption:this.strColumns},{panelId:"id-adv-shape-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.shapeProps,this.slideSize=this.options.slideSize,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputShapeName=new Common.UI.InputField({el:$("#shape-general-object-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isShapeNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,n){if(this.btnRatio.pressed){var s=t.getNumberValue(),a=s/this._nRatio;a>this.sizeMax.height&&(s=(a=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(s,!0)),this.spnHeight.setValue(a,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=s*this._nRatio)>this.sizeMax.width&&(s=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(s,!0)),this.spnWidth.setValue(a,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#shape-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#shape-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#shape-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#shape-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Top(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#shape-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Bottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#shape-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Left(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#shape-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,i,n){this._changedProps&&(null!==this._changedProps.get_paddings()&&void 0!==this._changedProps.get_paddings()||this._changedProps.put_paddings(new Asc.asc_CPaddings),this._changedProps.get_paddings().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginRight),this.radioNofit=new Common.UI.RadioBox({el:$("#shape-radio-nofit"),name:"asc-radio-fit",labelText:this.textNofit,value:AscFormat.text_fit_No}),this.radioNofit.on("change",_.bind(this.onRadioFitChange,this)),this.radioShrink=new Common.UI.RadioBox({el:$("#shape-radio-shrink"),name:"asc-radio-fit",labelText:this.textShrink,value:AscFormat.text_fit_NormAuto}),this.radioShrink.on("change",_.bind(this.onRadioFitChange,this)),this.radioFit=new Common.UI.RadioBox({el:$("#shape-radio-fit"),name:"asc-radio-fit",labelText:this.textResizeFit,value:AscFormat.text_fit_Auto}),this.radioFit.on("change",_.bind(this.onRadioFitChange,this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-vert"),labelText:this.textVertically}),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind((function(t,e){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linecap(e.value))}),this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind((function(t,e){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linejoin(e.value))}),this));var e=[],i=[];e.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),e.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),e.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),e.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),e.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),e.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var n=0;n<6;n++)e[n].value=n;for(n=0;n<9;n++)i.push({value:n,typearrow:""});for(i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginStyle.on("item:click",_.bind(this.onSelectBeginStyle,this)),this.mnuBeginStylePicker=this.btnBeginStyle.getPicker(),this.btnBeginStyle.updateFormControl(),this.btnBeginSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginSize.on("item:click",_.bind(this.onSelectBeginSize,this)),this.mnuBeginSizePicker=this.btnBeginSize.getPicker(),this.btnBeginSize.updateFormControl(),n=0;n<e.length;n++)e[n].offsety+=200;for(n=0;n<i.length;n++)i[n].offsety+=200;this.btnEndStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndStyle.on("item:click",_.bind(this.onSelectEndStyle,this)),this.mnuEndStylePicker=this.btnEndStyle.getPicker(),this.btnEndStyle.updateFormControl(),this.btnEndSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndSize.on("item:click",_.bind(this.onSelectEndSize,this)),this.mnuEndSizePicker=this.btnEndSize.getPicker(),this.btnEndSize.updateFormControl(),this.spnColumns=new Common.UI.MetricSpinner({el:$("#shape-columns-number"),step:1,allowDecimal:!1,width:100,defaultUnit:"",value:"1",maxValue:16,minValue:1}),this.spnColumns.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.asc_putColumnNumber(t.getNumberValue())}),this)),this.spnSpacing=new Common.UI.MetricSpinner({el:$("#shape-columns-spacing"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:40.64,minValue:0}),this.spnSpacing.on("change",_.bind((function(t,e,i,n){this._changedProps&&this._changedProps.asc_putColumnSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.spnSpacing),this.inputAltTitle=new Common.UI.InputField({el:$("#shape-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputShapeName,this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.spnAngle,this.chFlipHor,this.chFlipVert,this.cmbCapType,this.cmbJoinType,this.btnBeginStyle,this.btnEndStyle,this.btnBeginSize,this.btnEndSize,this.radioNofit,this.radioShrink,this.radioFit,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnColumns,this.spnSpacing,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputShapeName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnAngle.focus();break;case 3:i.cmbCapType.focus();break;case 4:i.spnMarginTop.focus();break;case 5:i.spnColumns.focus();break;case 6:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){t.get_FromSmartArt()&&this.btnsCategory[2].setDisabled(!0),t.get_FromSmartArtInternal()&&(this.radioNofit.setDisabled(!0),this.radioShrink.setDisabled(!0),this.radioFit.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[1].setDisabled(!0));var e=t.asc_getName();if(this.inputShapeName.setValue(e||""),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e||t.get_FromSmartArt()),this.btnRatio.setDisabled(!!t.get_FromSmartArt()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.asc_getPosition()){var i={X:t.asc_getPosition().get_X(),Y:t.asc_getPosition().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);this._setShapeDefaults(t);var n=t.get_paddings();if(n){var s=n.get_Left();this.spnMarginLeft.setValue(null!=s?Common.Utils.Metric.fnRecalcFromMM(s):"",!0),s=n.get_Top(),this.spnMarginTop.setValue(null!=s?Common.Utils.Metric.fnRecalcFromMM(s):"",!0),s=n.get_Right(),this.spnMarginRight.setValue(null!=s?Common.Utils.Metric.fnRecalcFromMM(s):"",!0),s=n.get_Bottom(),this.spnMarginBottom.setValue(null!=s?Common.Utils.Metric.fnRecalcFromMM(s):"",!0)}switch(e=t.asc_getTextFitType()){case AscFormat.text_fit_No:this.radioNofit.setValue(!0,!0);break;case AscFormat.text_fit_Auto:this.radioFit.setValue(!0,!0);break;case AscFormat.text_fit_NormAuto:this.radioShrink.setValue(!0,!0)}this.btnsCategory[4].setDisabled(null===n);var a=t.asc_getType();this.btnsCategory[5].setDisabled(t.get_FromSmartArtInternal()||t.get_FromSmartArt()||"line"==a||"bentConnector2"==a||"bentConnector3"==a||"bentConnector4"==a||"bentConnector5"==a||"curvedConnector2"==a||"curvedConnector3"==a||"curvedConnector4"==a||"curvedConnector5"==a||"straightConnector1"==a),e=t.asc_getColumnNumber(),this.spnColumns.setValue(null!=e?e:"",!0),e=t.asc_getColumnSpace(),this.spnSpacing.setValue(null!=e?Common.Utils.Metric.fnRecalcFromMM(e):"",!0),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),e=t.asc_getFlipH(),this.chFlipHor.setValue(null==e||null===e?"indeterminate":e),e=t.asc_getFlipV(),this.chFlipVert.setValue(null==e||null===e?"indeterminate":e),this._changedProps=new Asc.asc_CShapeProperty}},getSettings:function(){this.isShapeNameChanged&&this._changedProps.asc_putName(this.inputShapeName.getValue());var t=new Asc.CPosition;if(""!==this.spnX.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(e=this.slideSize.width/36e3/2+e),t.put_X(e)}if(""!==this.spnY.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(i=this.slideSize.height/36e3/2+i),t.put_Y(i)}return this._changedProps.asc_putPosition(t),this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),"indeterminate"!==this.chFlipHor.getValue()&&this._changedProps.asc_putFlipH("checked"===this.chFlipHor.getValue()),"indeterminate"!==this.chFlipVert.getValue()&&this._changedProps.asc_putFlipV("checked"===this.chFlipVert.getValue()),Common.localStorage.setItem("pe-settings-shaperatio",this.btnRatio.pressed?1:0),{shapeProps:this._changedProps}},_setShapeDefaults:function(t){if(t){var e=t.get_stroke();if(e){this.btnsCategory[3].setDisabled(e.get_type()==Asc.c_oAscStrokeType.STROKE_NONE);for(var i=e.get_linejoin(),n=0;n<this._arrJoinType.length;n++)if(i==this._arrJoinType[n].value){this.cmbJoinType.setValue(i);break}for(i=e.get_linecap(),n=0;n<this._arrCapType.length;n++)if(i==this._arrCapType[n].value){this.cmbCapType.setValue(i);break}var s=e.get_canChangeArrows();if(this.btnBeginStyle.setDisabled(!s),this.btnEndStyle.setDisabled(!s),this.btnBeginSize.setDisabled(!s),this.btnEndSize.setDisabled(!s),s){i=e.get_linebeginsize();var a=this.mnuBeginSizePicker.store.findWhere({type:i});a?this._beginSizeIdx=a.get("value"):(this._beginSizeIdx=null,this.btnBeginSize.updateFormControl()),i=e.get_linebeginstyle(),a=this.mnuBeginStylePicker.store.findWhere({type:i}),this.btnBeginStyle.selectRecord(a),a&&this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,a,this._beginSizeIdx),i=e.get_lineendsize(),(a=this.mnuEndSizePicker.store.findWhere({type:i}))?this._endSizeIdx=a.get("value"):(this._endSizeIdx=null,this.btnEndSize.updateFormControl()),i=e.get_lineendstyle(),a=this.mnuEndStylePicker.store.findWhere({type:i}),this.btnEndStyle.selectRecord(a),a&&this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,a,this._endSizeIdx)}}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},_updateSizeArr:function(t,e,i,n){i.get("value")>0?(e.store.each((function(t){t.set({typearrow:i.get("idsvg")})}),this),t.setDisabled(!1),t.selectRecord(null!==n?e.store.at(n):null)):(t.updateFormControl(),t.setDisabled(!0))},updateFormControl:function(t){var e=$(this.el).find(".form-control > .img-arrows use");if(e.length){var i="";if(t){var n=t.get("idsvg");i=void 0!==n?n+"arrow-5":t.get("typearrow")+"arrow-"+(t.get("value")+1)}e[0].setAttribute("xlink:href","#"+i)}},onSelectBeginStyle:function(t,e,i,n){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linebeginstyle(n.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,n,this._beginSizeIdx)},onSelectBeginSize:function(t,e,i,n){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_linebeginsize(n.get("type"))),this._beginSizeIdx=n.get("value")},onSelectEndStyle:function(t,e,i,n){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_lineendstyle(n.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,n,this._endSizeIdx)},onSelectEndSize:function(t,e,i,n){this._changedProps&&(null===this._changedProps.get_stroke()&&this._changedProps.put_stroke(new Asc.asc_CStroke),this._changedProps.get_stroke().put_lineendsize(n.get("type"))),this._endSizeIdx=n.get("value")},onRadioFitChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putTextFitType(t.options.value)},textRound:"Round",textMiter:"Miter",textSquare:"Square",textFlat:"Flat",textBevel:"Bevel",textTitle:"Shape - Advanced Settings",txtNone:"None",textWeightArrows:"Weights & Arrows",textArrows:"Arrows",textLineStyle:"Line Style",textCapType:"Cap Type",textJoinType:"Join Type",textBeginStyle:"Begin Style",textBeginSize:"Begin Size",textEndStyle:"End Style",textEndSize:"End Size",textSize:"Size",textWidth:"Width",textHeight:"Height",textKeepRatio:"Constant Proportions",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",strMargins:"Text Padding",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",strColumns:"Columns",textSpacing:"Spacing between columns",textColNumber:"Number of columns",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textTextBox:"Text Box",textAutofit:"AutoFit",textNofit:"Do not Autofit",textShrink:"Shrink text on overflow",textResizeFit:"Resize shape to fit text",textPlacement:"Placement",textPosition:"Position",textHorizontal:"Horizontal",textFrom:"From",textVertical:"Vertical",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textGeneral:"General",textShapeName:"Shape name"},PE.Views.ShapeSettingsAdvanced||{}))})),define("text!presentationeditor/main/app/template/TableSettingsAdvanced.template",[],(function(){return'<div id="id-adv-table-general" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="1" width="100%" role="presentation">\r\n        <tr>\r\n            <td class="padding-large">\r\n                <label class="header"><%= scope.textTableName %></label>\r\n                <div id="tableadv-name"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n</div>\r\n<div  id="id-adv-table-placement" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="3" role="presentation">\r\n            <tr>\r\n                <td colspan="3" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textSize %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td width="93px">\r\n                    <label class="input-label"><%= scope.textWidth %></label>\r\n                    <div id="tableadv-spin-width"></div>\r\n                </td>\r\n                <td width="28px" style="vertical-align: bottom;">\r\n                    <div id="tableadv-button-ratio"></div>\r\n                </td>\r\n                <td width="93px">\r\n                    <label class="input-label"><%= scope.textHeight %></label>\r\n                    <div id="tableadv-spin-height"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="4" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textPosition %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="121px">\r\n                    <label class="input-label"><%= scope.textHorizontal %></label>\r\n                    <div id="tableadv-spin-x"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="tableadv-combo-from-x"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textVertical %></label>\r\n                    <div id="tableadv-spin-y"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="tableadv-combo-from-y"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-cell-props" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2" class="padding-small">\r\n                    <div id="tableadv-checkbox-margins"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="tableadv-number-margin-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="tableadv-number-margin-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="tableadv-number-margin-bottom"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="tableadv-number-margin-right"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textDefaultMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="tableadv-number-margin-table-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="tableadv-number-margin-table-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="tableadv-number-margin-table-bottom"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="tableadv-number-margin-table-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-table-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="tableadv-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="tableadv-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("presentationeditor/main/app/view/TableSettingsAdvanced",["text!presentationeditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"TableSettingsAdvanced",contentWidth:280,contentHeight:300,storageName:"pe-table-settings-adv-category",sizeMax:{width:55.88,height:55.88}},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-general",panelCaption:this.textGeneral},{panelId:"id-adv-table-placement",panelCaption:this.textPlacement},{panelId:"id-adv-table-cell-props",panelCaption:this.textWidthSpaces},{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._changedProps=null,this._allTable=!1,this.TableMargins={Left:.19,Right:.19,Top:0,Bottom:0},this.CellMargins={Left:.19,Right:.19,Top:null,Bottom:null,Flag:0},this._initialMarginsDefault=!1,this._originalProps=new Asc.CTableProp(this.options.tableProps),this.slideSize=this.options.slideSize},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputTableName=new Common.UI.InputField({el:$("#tableadv-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isTableNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#tableadv-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t){if(this.btnRatio.pressed){var e=t.getNumberValue(),i=e/this._nRatio;i>this.sizeMax.height&&(e=(i=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(e,!0)),this.spnHeight.setValue(i,!0)}}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#tableadv-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=s*this._nRatio)>this.sizeMax.width&&(s=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(s,!0)),this.spnWidth.setValue(a,!0))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#tableadv-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue())}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#tableadv-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#tableadv-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#tableadv-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#tableadv-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this._marginsChange=function(t,e,i,n,s,a){"table"==s?this.TableMargins[a]=t.getNumberValue():this.CellMargins[a]=t.getNumberValue()},this.spnTableMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginTop.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Top"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Top(null!==this.TableMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Top):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginTop),this.spnTableMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnTableMarginBottom.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Bottom"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Bottom(null!==this.TableMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Bottom):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginBottom),this.spnTableMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnTableMarginLeft.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Left"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Left(null!==this.TableMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Left):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginLeft),this.spnTableMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-table-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnTableMarginRight.on("change",_.bind((function(t,e,i,n){this._marginsChange(t,e,i,n,"table","Right"),this._changedProps&&(void 0===this._changedProps.get_DefaultMargins()&&this._changedProps.put_DefaultMargins(new Asc.asc_CPaddings),this._changedProps.get_DefaultMargins().put_Right(null!==this.TableMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.TableMargins.Right):null),this.TableMargins.isChanged=!0)}),this)),this.spinners.push(this.spnTableMarginRight);var e=function(){"indeterminate"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(1):"checked"==t.CellMargins.Flag?t._changedProps.get_CellMargins().put_Flag(0):t._changedProps.get_CellMargins().put_Flag(2)};this.chCellMargins=new Common.UI.CheckBox({el:$("#tableadv-checkbox-margins"),value:!0,labelText:this.textCheckMargins}),this.chCellMargins.on("change",_.bind((function(t,i,n,s){"checked"==n&&this._originalProps&&1==this._originalProps.get_CellMargins().get_Flag()&&t.setValue("indeterminate",!0),this.fillMargins.call(this,t.getValue()),this.CellMargins.Flag=t.getValue(),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),e())}),this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-top"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,i,n,s){this._marginsChange(t,i,n,s,"cell","Top"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Top(null!==this.CellMargins.Top?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Top):null),e())}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-bottom"),step:.1,width:85,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,i,n,s){this._marginsChange(t,i,n,s,"cell","Bottom"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Bottom(null!==this.CellMargins.Bottom?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Bottom):null),e())}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-left"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,i,n,s){this._marginsChange(t,i,n,s,"cell","Left"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Left(null!==this.CellMargins.Left?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Left):null),e())}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#tableadv-number-margin-right"),step:.1,width:85,defaultUnit:"cm",value:"0.19 cm",maxValue:55.87,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,i,n,s){this._marginsChange(t,i,n,s,"cell","Right"),this._changedProps&&(void 0===this._changedProps.get_CellMargins()&&this._changedProps.put_CellMargins(new Asc.CMargins),this._changedProps.get_CellMargins().put_Right(null!==this.CellMargins.Right?Common.Utils.Metric.fnRecalcToMM(this.CellMargins.Right):null),e())}),this)),this.spinners.push(this.spnMarginRight),this.inputAltTitle=new Common.UI.InputField({el:$("#tableadv-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputTableName,this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.chCellMargins,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnTableMarginTop,this.spnTableMarginLeft,this.spnTableMarginBottom,this.spnTableMarginRight,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputTableName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnMarginTop.isDisabled()?i.spnTableMarginTop.focus():i.spnMarginTop.focus();break;case 3:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getSettings:function(){if(this.isTableNameChanged&&this._changedProps.put_TableName(this.inputTableName.getValue()),""!==this.spnHeight.getValue()&&this._changedProps.put_FrameHeight(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),""!==this.spnWidth.getValue()&&this._changedProps.put_FrameWidth(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),this._changedProps.put_FrameLockAspect(this.btnRatio.pressed),""!==this.spnX.getValue()){var t=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(t=this.slideSize.width/36e3/2+t),this._changedProps.put_FrameX(t)}if(""!==this.spnY.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(e=this.slideSize.height/36e3/2+e),this._changedProps.put_FrameY(e)}return this.isAltTitleChanged&&this._changedProps.put_TableCaption(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.put_TableDescription(this.textareaAltDescription.val()),{tableProps:this._changedProps}},_setDefaults:function(t){if(t){this._allTable=!t.get_CellSelect();var e=t.get_TableName();this.inputTableName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_FrameWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.get_FrameHeight()).toFixed(2),!0),e=t.get_FrameLockAspect(),this.btnRatio.toggle(e),t.get_FrameHeight()>0&&(this._nRatio=t.get_FrameWidth()/t.get_FrameHeight()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left");var i={x:t.get_FrameX(),y:t.get_FrameY()};this.spnX.setValue(null!=i.x?Common.Utils.Metric.fnRecalcFromMM(i.x):"",!0),this.spnY.setValue(null!=i.y?Common.Utils.Metric.fnRecalcFromMM(i.y):"",!0);var n=t.get_DefaultMargins();n&&(this.TableMargins={Left:null!==n.get_Left()?Common.Utils.Metric.fnRecalcFromMM(n.get_Left()):null,Right:null!==n.get_Right()?Common.Utils.Metric.fnRecalcFromMM(n.get_Right()):null,Top:null!==n.get_Top()?Common.Utils.Metric.fnRecalcFromMM(n.get_Top()):null,Bottom:null!==n.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(n.get_Bottom()):null});var s=void 0;(n=t.get_CellMargins())&&(this.CellMargins={Left:null!==n.get_Left()?Common.Utils.Metric.fnRecalcFromMM(n.get_Left()):null,Right:null!==n.get_Right()?Common.Utils.Metric.fnRecalcFromMM(n.get_Right()):null,Top:null!==n.get_Top()?Common.Utils.Metric.fnRecalcFromMM(n.get_Top()):null,Bottom:null!==n.get_Bottom()?Common.Utils.Metric.fnRecalcFromMM(n.get_Bottom()):null},s=n.get_Flag(),this.CellMargins.Flag=1==s?"indeterminate":0==s?"checked":"unchecked",this.chCellMargins.setValue(this.CellMargins.Flag,!0)),0===s&&(null===this.CellMargins.Left&&(this.CellMargins.Left=this.TableMargins.Left),null===this.CellMargins.Top&&(this.CellMargins.Top=this.TableMargins.Top),null===this.CellMargins.Right&&(this.CellMargins.Right=this.TableMargins.Right),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=this.TableMargins.Bottom)),this.fillMargins(this.CellMargins.Flag),e=t.get_TableCaption(),this.inputAltTitle.setValue(e||""),e=t.get_TableDescription(),this.textareaAltDescription.val(e||""),this._changedProps=new Asc.CTableProp}},fillMargins:function(t){this._initialMarginsDefault&&"unchecked"==t&&(null===this.CellMargins.Left&&(this.CellMargins.Left=0),null===this.CellMargins.Top&&(this.CellMargins.Top=0),null===this.CellMargins.Right&&(this.CellMargins.Right=0),null===this.CellMargins.Bottom&&(this.CellMargins.Bottom=0)),this.spnMarginLeft.setValue(null!==this.CellMargins.Left?this.CellMargins.Left:"",!0),this.spnMarginTop.setValue(null!==this.CellMargins.Top?this.CellMargins.Top:"",!0),this.spnMarginRight.setValue(null!==this.CellMargins.Right?this.CellMargins.Right:"",!0),this.spnMarginBottom.setValue(null!==this.CellMargins.Bottom?this.CellMargins.Bottom:"",!0);var e="checked"==t;this.spnMarginTop.setDisabled(e),this.spnMarginBottom.setDisabled(e),this.spnMarginLeft.setDisabled(e),this.spnMarginRight.setDisabled(e),this.spnTableMarginLeft.setValue(null!==this.TableMargins.Left?this.TableMargins.Left:"",!0),this.spnTableMarginTop.setValue(null!==this.TableMargins.Top?this.TableMargins.Top:"",!0),this.spnTableMarginRight.setValue(null!==this.TableMargins.Right?this.TableMargins.Right:"",!0),this.spnTableMarginBottom.setValue(null!==this.TableMargins.Bottom?this.TableMargins.Bottom:"",!0)},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)}},textWidthSpaces:"Margins",textMargins:"Cell Margins",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textTitle:"Table - Advanced Settings",textDefaultMargins:"Default Margins",textCheckMargins:"Use default margins",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textPlacement:"Placement",textSize:"Size",textPosition:"Position",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textWidth:"Width",textHeight:"Height",textKeepRatio:"Constant Proportions",textGeneral:"General",textTableName:"Table name"},PE.Views.TableSettingsAdvanced||{}))})),define("text!presentationeditor/main/app/template/ImageSettingsAdvanced.template",[],(function(){return'<div id="id-adv-image-general" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="1" width="100%" role="presentation">\r\n        <tr>\r\n            <td class="padding-large">\r\n                <label class="header"><%= scope.textImageName %></label>\r\n                <div id="image-general-name"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n</div>\r\n<div  id="id-adv-image-size" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="4" width="100%" role="presentation">\r\n            <tr>\r\n                <td colspan="4" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textSize %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td width="78px" class="padding-large">\r\n                    <label class="input-label"><%= scope.textWidth %></label>\r\n                    <div id="image-advanced-spin-width"></div>\r\n                </td>\r\n                <td width="28px" style="vertical-align: bottom;" class="padding-large">\r\n                    <div id="image-advanced-button-ratio"></div>\r\n                </td>\r\n                <td width="78px" class="padding-large">\r\n                    <label class="input-label"><%= scope.textHeight %></label>\r\n                    <div id="image-advanced-spin-height"></div>\r\n                </td>\r\n                <td style="vertical-align: bottom;" class="padding-large">\r\n                    <button type="button" class="btn btn-text-default auto" id="image-advanced-button-original-size" style="min-width:100px;"><%= scope.textOriginalSize %></button>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan="4" width="88px" class="padding-small">\r\n                    <label class="header"><%= scope.textPosition %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="106px">\r\n                    <label class="input-label"><%= scope.textHorizontal %></label>\r\n                    <div id="image-advanced-spin-x"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="image-advanced-combo-from-x"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textVertical %></label>\r\n                    <div id="image-advanced-spin-y"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textFrom %></label>\r\n                    <div id="image-advanced-combo-from-y"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-rotate" class="settings-panel active">\r\n    <div class="inner-content  padding-large">\r\n        <div style="width: 100%;">\r\n            <label class="input-label vertical-align-baseline"><%= scope.textAngle %></label>\r\n            <div id="image-advanced-spin-angle" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content  padding-large">\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\r\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="image-advanced-checkbox-hor"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="image-advanced-checkbox-vert"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-image-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="image-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("presentationeditor/main/app/view/ImageSettingsAdvanced",["text!presentationeditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ImageSettingsAdvanced",contentWidth:340,contentHeight:257,sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},storageName:"pe-img-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-general",panelCaption:this.textGeneral},{panelId:"id-adv-image-size",panelCaption:this.textPlacement},{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._nRatio=1,this._isDefaultSize=!1,this._originalProps=this.options.imageProps,this.slideSize=this.options.slideSize},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputImageName=new Common.UI.InputField({el:$("#image-general-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isImgNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-width"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,n){if(this.btnRatio.pressed){var s=t.getNumberValue(),a=s/this._nRatio;a>this.sizeMax.height&&(s=(a=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(s,!0)),this.spnHeight.setValue(a,!0)}this._isDefaultSize=!1}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-height"),step:.1,width:70,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=s*this._nRatio)>this.sizeMax.width&&(s=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(s,!0)),this.spnWidth.setValue(a,!0)),this._isDefaultSize=!1}),this)),this.spinners.push(this.spnHeight),this.btnOriginalSize=new Common.UI.Button({el:$("#image-advanced-button-original-size")}),this.btnOriginalSize.on("click",_.bind((function(t,e){this.spnAngle.setValue(0),this.spnWidth.setValue(this.sizeOriginal.width,!0),this.spnHeight.setValue(this.sizeOriginal.height,!0),this._nRatio=this.sizeOriginal.width/this.sizeOriginal.height}),this)),this.btnRatio=new Common.UI.Button({parentEl:$("#image-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue())}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#image-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#image-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputImageName,this.spnWidth,this.btnRatio,this.spnHeight,this.btnOriginalSize,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.spnAngle,this.chFlipHor,this.chFlipVert,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputImageName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.spnAngle.focus();break;case 3:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){var e=t.asc_getName();if(this.inputImageName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),e=t.get_Width(),this.spnWidth.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.get_Height(),this.spnHeight.setValue(void 0!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),this.btnOriginalSize.setDisabled(null===t.get_ImageUrl()||void 0===t.get_ImageUrl()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),t.get_Height()>0&&(this._nRatio=t.get_Width()/t.get_Height()),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.get_Position()){var i={X:t.get_Position().get_X(),Y:t.get_Position().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||"");var n=t.asc_getPluginGuid();this.btnsCategory[2].setVisible(null==n)}},getSettings:function(){var t=new Asc.asc_CImgProperty;this.isImgNameChanged&&t.asc_putName(this.inputImageName.getValue()),""!==this.spnHeight.getValue()&&t.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())),""!==this.spnWidth.getValue()&&t.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())),t.asc_putLockAspect(this.btnRatio.pressed),t.put_ResetCrop(this._isDefaultSize);var e=new Asc.CPosition;if(""!==this.spnX.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(i=this.slideSize.width/36e3/2+i),e.put_X(i)}if(""!==this.spnY.getValue()){var n=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(n=this.slideSize.height/36e3/2+n),e.put_Y(n)}return t.put_Position(e),this.isAltTitleChanged&&t.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&t.asc_putDescription(this.textareaAltDescription.val()),t.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),t.asc_putFlipH("checked"==this.chFlipHor.getValue()),t.asc_putFlipV("checked"==this.chFlipVert.getValue()),{imageProps:t}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},textOriginalSize:"Actual Size",textPosition:"Position",textSize:"Size",textWidth:"Width",textHeight:"Height",textTitle:"Image - Advanced Settings",textKeepRatio:"Constant Proportions",textPlacement:"Placement",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textGeneral:"General",textImageName:"Image name"},PE.Views.ImageSettingsAdvanced||{}))})),define("presentationeditor/main/app/view/SlideshowSettings",[],(function(){"use strict";PE.Views.SlideshowSettings=Common.UI.Window.extend(_.extend({options:{width:315,header:!0,style:"min-width: 315px;",cls:"modal-dlg",id:"window-slideshow-settings",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div id="slideshow-checkbox-loop" style="margin-bottom:5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chLoop=new Common.UI.CheckBox({el:$("#slideshow-checkbox-loop"),labelText:this.textLoop}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chLoop].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chLoop},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){this.chLoop.setValue(t)},getSettings:function(){return"checked"==this.chLoop.getValue()},textTitle:"Show Settings",textLoop:"Loop continuously until 'Esc' is pressed"},PE.Views.SlideshowSettings||{}))})),define("presentationeditor/main/app/view/AnimationDialog",[],(function(){"use strict";PE.Views.AnimationDialog=Common.UI.Window.extend(_.extend({options:{width:515,header:!0,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){if(_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class = "input-row" id = "animation-group"></div>','<div class = "input-row" id = "animation-picker" style = "margin-top: 16px;  height: 272px; text-wrap: nowrap;"></div>',"</div>"].join(""),this.allEffects=Common.define.effectData.getEffectFullData(),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this._state=[],this.handler=this.options.handler,this.lockEmphasis=!!this.options.lockEmphasis,this.EffectGroupData=Common.define.effectData.getEffectGroupData(),this._state.activeGroup=this.EffectGroupData[0].id,this._state.activeGroupValue=this.EffectGroupData[0].value,this.EffectGroupData.forEach((function(t){t.displayValue=t.caption})),null!=this.options.activeEffect&&this.options.activeEffect!=AscFormat.ANIM_PRESET_NONE&&this.options.activeEffect!==AscFormat.ANIM_PRESET_MULTIPLE){this._state.activeEffect=this.options.activeEffect,this._state.activeGroupValue=this.options.groupValue;var e=_.findWhere(this.EffectGroupData,{value:this._state.activeGroupValue});this._state.activeGroup=e.id}Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);this.getChild();this.cmbGroup=new Common.UI.ComboBox({el:$("#animation-group"),cls:"input-group-nr",editable:!1,style:"width: 175px;",menuStyle:"min-width: 100%;",takeFocusOnClose:!0,data:this.EffectGroupData,value:null!=this._state.activeEffect?this._state.activeGroup:void 0}),this.cmbGroup.on("selected",_.bind(this.onGroupSelect,this)),this.pickerEffectList=new Common.UI.DataView({el:$("#animation-picker"),cls:"bordered no-borders-item",store:new Common.UI.DataViewStore,groups:new Common.UI.DataViewGroupStore,style:"max-height: 380px;",itemTemplate:_.template(['<div  class = "btn_item x-huge" id = "<%= id %>" style = "width: 88px;height: 40px; pointer-events:none;">','<div class = "icon <% if (iconCls) { %>toolbar__icon<% } %> <%= iconCls %>"></div>','<div class = "caption"><%= displayValue %></div>',"</div>"].join("")),delayRenderTips:!0,tabindex:1}),this.pickerEffectList.on("item:select",_.bind(this.onEffectListItem,this)),this.pickerEffectList.on("item:dblclick",_.bind(this.onPrimary,this)),this.pickerEffectList.on("entervalue",_.bind(this.onPrimary,this)),this.cmbGroup.setValue(this._state.activeGroupValue),this.fillEffect(),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.cmbGroup,this.pickerEffectList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.pickerEffectList},onGroupSelect:function(t,e){this._state.activeGroup=e.id,this._state.activeGroupValue=e.value,this._state.activeEffect=void 0,this.fillEffect()},fillEffect:function(){var t,e=_.where(this.allEffects,{group:this._state.activeGroup}),i=this.lockEmphasis;e=_.reject(e,(function(t){return!!t.notsupported})),"menu-effect-group-emphasis"===this._state.activeGroup&&e.forEach((function(e,n){i&&e.value!==AscFormat.EMPHASIS_GROW_SHRINK&&e.value!==AscFormat.EMPHASIS_SPIN&&e.value!==AscFormat.EMPHASIS_TRANSPARENCY&&e.value!==AscFormat.EMPHASIS_PULSE&&e.value!==AscFormat.EMPHASIS_TEETER&&e.value!==AscFormat.EMPHASIS_BLINK?e.disabled=i:void 0===t&&(t=n)})),e=e.map((function(t){return{displayValue:t.displayValue,effectGroup:t.group,group:t.level,iconCls:t.iconCls,value:t.value,disabled:t.disabled,tip:t.displayValue}})),this.pickerEffectList.groups.reset(Common.define.effectData.getLevelEffect("menu-effect-group-path"==this._state.activeGroup)),this.pickerEffectList.store.reset(e);var n=this.pickerEffectList.store.findWhere({value:this._state.activeEffect});n||(n=this.pickerEffectList.store.at(t||0)),this.pickerEffectList.selectRecord(n),this.pickerEffectList.scrollToRecord(n),this._state.activeEffect=n.get("value")},onEffectListItem:function(t,e,i){i&&(this._state.activeEffect=i.get("value"))},onPreviewChange:function(t,e,i,n){Common.Utils.InternalSettings.set("pe-animation-no-preview","checked"!==t.getValue())},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this._state),this.close()},textTitle:"More Effects",textPreviewEffect:"Preview Effect"},PE.Views.AnimationDialog||{}))})),define("text!presentationeditor/main/app/template/HeaderFooterDialog.template",[],(function(){return'<table cols="1" style="width: 100%;" role="presentation">\n    <tr><td class="padding-small">\n        <div>\n            <button type="button" class="btn btn-text-default auto" id="hf-dlg-btn-slide"><%= scope.textSlide %></button><button type="button" class="btn btn-text-default auto" id="hf-dlg-btn-notes"><%= scope.textNotes %></button>\n        </div>\n    </td></tr>\n    <tr><td class="padding-very-small">\n        <div id="hf-dlg-chb-datetime"></div>\n    </td></tr>\n    <tr><td class="padding-large">\n        <table id="hf-dlg-tbl-datetime" class="margin-left-22" cols="2" role="presentation">\n            <tr>\n                <td colspan="2" class="padding-very-small">\n                    <div id="hf-dlg-radio-update"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small padding-left-22">\n                    <label  style="display:block;" class="input-label"><%= scope.textFormat %></label>\n                    <div id="hf-dlg-combo-format" style="width: 100%;"></div>\n                </td>\n                <td class="padding-small padding-left-5">\n                    <label  style="display:block;" class="input-label"><%= scope.textLang %></label>\n                    <div id="hf-dlg-combo-lang" style="width: 100%;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-very-small">\n                    <div id="hf-dlg-radio-fixed"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2">\n                    <div id="hf-dlg-input-fixed" class="input-row margin-left-22"></div>\n                </td>\n            </tr>\n        </table>\n    </td></tr>\n    <tr><td class="padding-large">\n        <div id="hf-dlg-chb-slide"></div>\n    </td></tr>\n    <tr class="notes hidden"><td>\n        <div id="hf-dlg-chb-text-header"></div>\n    </td></tr>\n    <tr class="notes hidden"><td class="padding-large">\n        <div id="hf-dlg-text-header" class="input-row margin-left-22"></div>\n    </td></tr>\n    <tr><td>\n        <div id="hf-dlg-chb-text"></div>\n    </td></tr>\n    <tr><td class="padding-large">\n        <div id="hf-dlg-text" class="input-row margin-left-22"></div>\n    </td></tr>\n    <tr class="slides"><td class="padding-small">\n        <div id="hf-dlg-chb-not-title"></div>\n    </td></tr>\n</table>\n'})),define("presentationeditor/main/app/view/HeaderFooterDialog",["text!presentationeditor/main/app/template/HeaderFooterDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.HeaderFooterDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:360,contentHeight:340,id:"window-header-footer"},initialize:function(e){_.extend(this.options,{title:this.textHFTitle,buttons:[{value:"all",caption:this.applyAllText,id:"hf-dlg-btn-apply-to-all"},{value:"ok",caption:this.applyText,id:"hf-dlg-btn-apply"},"cancel"],primary:"all",template:_.template(['<div class="box">','<div class="content-panel" style="padding: 10px 5px;">','<div class="settings-panel active"><div class="inner-content">',t,"</div></div>","</div>",'<div class="separator"></div>','<div class="menu-panel" style="width: 130px; padding-top: 17px;">','<label  style="display:block;" class="input-label margin-left-15">'+this.textPreview+"</label>",'<div class="margin-left-15 slides" style="width: 100px; height: 80px; padding: 5px; border: 1px solid #AFAFAF; border-radius: 2px; background: #ffffff;">','<div id="hf-dlg-canvas-preview" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="margin-left-15 hidden notes" style="width: 100px; height: 122px; padding: 5px; border: 1px solid #AFAFAF; border-radius: 2px; background: #ffffff;">','<div id="hf-dlg-canvas-preview-notes" style="width: 100%;height: 100%;"></div>',"</div>","</div>","</div>",'<div class="separator horizontal"></div>'].join(""))({scope:this})},e),this.lang=e.lang,this.handler=e.handler,this.hfProps=e.props,this.api=e.api,this.type=e.type||0,this.isLockedApplyToAll=e.isLockedApplyToAll||!1,this.dateControls=[],this.inited=[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.btnSlide=new Common.UI.Button({el:$("#hf-dlg-btn-slide"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1,pressed:!0}),this.btnSlide.on("click",_.bind(this.onHFTypeClick,this,0)),this.btnNotes=new Common.UI.Button({el:$("#hf-dlg-btn-notes"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1}),this.btnNotes.setDisabled(this.isLockedApplyToAll),this.btnNotes.on("click",_.bind(this.onHFTypeClick,this,1)),Common.UI.GroupedButtons([this.btnSlide,this.btnNotes],{underline:!0}),this.chDateTime=new Common.UI.CheckBox({el:$("#hf-dlg-chb-datetime"),labelText:this.textDateTime}),this.chDateTime.on("change",_.bind(this.setType,this,"date")),this.chSlide=new Common.UI.CheckBox({el:$("#hf-dlg-chb-slide"),labelText:this.textSlideNum}),this.chSlide.on("change",_.bind(this.setType,this,"slide")),this.chFooter=new Common.UI.CheckBox({el:$("#hf-dlg-chb-text"),labelText:this.txtFooter}),this.chFooter.on("change",_.bind(this.setType,this,"footer")),this.inputFooter=new Common.UI.InputField({el:$("#hf-dlg-text"),validateOnBlur:!1,style:"width: 100%;"}),this.chHeader=new Common.UI.CheckBox({el:$("#hf-dlg-chb-text-header"),labelText:this.txtHeader}),this.chHeader.on("change",_.bind(this.setType,this,"header")),this.inputHeader=new Common.UI.InputField({el:$("#hf-dlg-text-header"),validateOnBlur:!1,style:"width: 100%;"});var t=[{value:1025},{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:14345},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1057},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:10266},{value:9242},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052},{value:1028}];t.forEach((function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value),i=Common.util.LanguageInfo.getLocalLanguageDisplayName(t.value);t.displayValue=i.native,t.displayValueEn=i.english,t.langName=e[0]})),this.cmbLang=new Common.UI.ComboBox({el:$("#hf-dlg-combo-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),data:t,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",_.bind((function(t,e){this.updateFormats(e.value)}),this)),this.dateControls.push(this.cmbLang),this.cmbFormat=new Common.UI.ComboBox({el:$("#hf-dlg-combo-format"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,data:[],takeFocusOnClose:!0}),this.dateControls.push(this.cmbFormat),this.radioUpdate=new Common.UI.RadioBox({el:$("#hf-dlg-radio-update"),labelText:this.textUpdate,name:"asc-radio-header-update",checked:!0}).on("change",_.bind(this.setDateTimeType,this,"update")),this.dateControls.push(this.radioUpdate),this.radioFixed=new Common.UI.RadioBox({el:$("#hf-dlg-radio-fixed"),labelText:this.textFixed,name:"asc-radio-header-update"}).on("change",_.bind(this.setDateTimeType,this,"fixed")),this.dateControls.push(this.radioFixed),this.inputFixed=new Common.UI.InputField({el:$("#hf-dlg-input-fixed"),validateOnBlur:!1,style:"width: 100%;"}),this.dateControls.push(this.inputFixed),this.chNotTitle=new Common.UI.CheckBox({el:$("#hf-dlg-chb-not-title"),labelText:this.textNotTitle}),this.chNotTitle.on("change",_.bind(this.setNotTitle,this)),this.btnApplyToAll=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find("#hf-dlg-btn-apply-to-all").addBack().filter("#hf-dlg-btn-apply-to-all").length>0}))||new Common.UI.Button({el:$("#hf-dlg-btn-apply-to-all")}),this.btnApplyToAll.setDisabled(this.isLockedApplyToAll),this.btnApply=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find("#hf-dlg-btn-apply").addBack().filter("#hf-dlg-btn-apply").length>0}))||new Common.UI.Button({el:$("#hf-dlg-btn-apply")}),this.headerControls=this.$window.find(".notes"),this.slideControls=this.$window.find(".slides"),this.afterRender()},getFocusedComponents:function(){return[this.btnSlide,this.btnNotes,this.chDateTime,this.radioUpdate,this.cmbFormat,this.cmbLang,this.radioFixed,this.inputFixed,this.chSlide,this.chHeader,this.inputHeader,this.chFooter,this.inputFooter,this.chNotTitle].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFormat.isDisabled()?this.inputFixed.isDisabled()?this.inputFooter.isDisabled()?this.chDateTime:this.inputFooter:this.inputFixed:this.cmbFormat},focusControls:function(){var t=this.getDefaultFocusableComponent();t&&setTimeout((function(){t.focus()}),10)},afterRender:function(){var t=this,e=Common.Utils.InternalSettings.get("pe-settings-datetime-default"),i=e?e.split(";"):[];this.defaultFormats=[],i.forEach((function(e){var i=e.split(" ");t.defaultFormats[parseInt(i[0])]=i[1]})),this._setDefaults(this.hfProps)},setNotTitle:function(t,e){0===this.type&&this.props.put_ShowOnTitleSlide("checked"!==t.getValue())},setType:function(t,e,i){var n=this;i="checked"==i,"date"==t?(_.each(this.dateControls,(function(t){t.setDisabled(!i)})),i&&this.setDateTimeType(this.radioFixed.getValue()?"fixed":"update",null,!0),this.props.put_ShowDateTime(i),this.focusControls()):"slide"==t?this.props.put_ShowSlideNum(i):"footer"==t?(this.inputFooter.setDisabled(!i),this.props.put_ShowFooter(i),i&&setTimeout((function(){n.inputFooter.cmpEl.find("input").focus()}),50)):"header"==t&&(this.inputHeader.setDisabled(!i),this.props.put_ShowHeader(i),i&&setTimeout((function(){n.inputHeader.cmpEl.find("input").focus()}),50)),this.props.updateView()},updateFormats:function(t,e){var i=new AscCommonSlide.CAscDateTime;i.put_Lang(t);var n=i.get_DateTimeExamples(),s=[];for(var a in n)n[a]&&s.push({value:a,displayValue:n[a]});this.cmbFormat.setData(s),e=e||this.defaultFormats[t],this.cmbFormat.setValue(e||s[0].value)},setDateTimeType:function(t,e,i){if(i){this.cmbLang.setDisabled("fixed"==t),this.cmbFormat.setDisabled("fixed"==t),this.inputFixed.setDisabled("update"==t),this.focusControls()}},onSelectFormat:function(t){this.radioUpdate.getValue()?(t=t||this.cmbFormat.getValue(),this.props.get_DateTime().put_DateTime(t)):this.props.get_DateTime().put_DateTime(null),this.props.get_DateTime().put_CustomDateTime(this.inputFixed.getValue())},onHFTypeClick:function(t,e,i){this.saveTempHFSettings(),this.type=t,this.ShowHideElem(),this.fillHFSettings()},ShowHideElem:function(){var t=0===this.type;this.slideControls.toggleClass("hidden",!t),this.headerControls.toggleClass("hidden",t),this.chSlide.setCaption(t?this.textSlideNum:this.textPageNum),this.btnApply.setVisible(t)},fillHFSettings:function(){var t=0===this.type;this.props=t?this.slideprops:this.notesprops;var e=this.props.get_ShowDateTime();this.chDateTime.setValue(e,!0),_.each(this.dateControls,(function(t){t.setDisabled(!e)}));var i,n=this.props.get_DateTime(),s=this.cmbLang.store.findWhere({value:n&&n.get_Lang()||this.lang});this._originalLang=s?s.get("value"):1033,this.cmbLang.setValue(this._originalLang),(e||this.inited[this.type])&&((i=n.get_DateTime())?this.radioUpdate.setValue(!0,!0):this.radioFixed.setValue(!0,!0),e&&this.setDateTimeType(i?"update":"fixed",null,!0)),this.updateFormats(this.cmbLang.getValue(),i),this.inputFixed.setValue(n.get_CustomDateTime()||(this.inited[this.type]?"":this.cmbFormat.getRawValue())),e=this.props.get_ShowSlideNum(),this.chSlide.setValue(e,!0),e=this.props.get_ShowFooter(),this.chFooter.setValue(e,!0),this.inputFooter.setDisabled(!e),this.inputFooter.setValue(this.props.get_Footer()||""),t?(e=this.props.get_ShowOnTitleSlide(),this.chNotTitle.setValue(!e,!0)):(e=this.props.get_ShowHeader(),this.chHeader.setValue(e,!0),this.inputHeader.setDisabled(!e),this.inputHeader.setValue(this.props.get_Header()||"")),this.inited[this.type]=!0,this.props.put_DivId(t?"hf-dlg-canvas-preview":"hf-dlg-canvas-preview-notes"),this.props.put_Api(this.api),this.props.updateView()},_setDefaults:function(t){t?(this.slideprops=t.get_Slide()||new AscCommonSlide.CAscHFProps,this.notesprops=t.get_Notes()||new AscCommonSlide.CAscHFProps):(this.slideprops=new AscCommonSlide.CAscHFProps,this.notesprops=new AscCommonSlide.CAscHFProps),1==this.type?this.btnNotes.toggle(!0):this.btnSlide.toggle(!0),this.ShowHideElem(),this.fillHFSettings()},saveTempHFSettings:function(){var t=this.props;!t.get_DateTime()&&t.put_DateTime(new AscCommonSlide.CAscDateTime),t.get_DateTime().put_Lang(this.cmbLang.getValue()),this.onSelectFormat(),t.put_Footer(this.inputFooter.getValue()),1===this.type&&t.put_Header(this.inputHeader.getValue())},getSettings:function(){return this.saveTempHFSettings(),this.hfProps.put_Slide(this.slideprops),this.hfProps.put_Notes(this.notesprops),this.hfProps},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("all"),!1},_handleInput:function(t){if(this.handler){if("ok"==t&&this.cmbLang.getValue()!==this._originalLang)return void Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:this.diffLanguage});this.handler.call(this,t,this.getSettings())}this.close()},applyAllText:"Apply to all",applyText:"Apply",textLang:"Language",textFormat:"Formats",textUpdate:"Update automatically",textDateTime:"Date and time",textSlideNum:"Slide number",textNotTitle:"Don't show on title slide",textPreview:"Preview",diffLanguage:"You cant use a date format in a different language than the slide master.\nTo change the master, click 'Apply to all' instead of 'Apply'",notcriticalErrorTitle:"Warning",textFixed:"Fixed",textSlide:"Slide",textNotes:"Notes and Handouts",textPageNum:"Page number",txtHeader:"Header",txtFooter:"Footer",textHFTitle:"Header/Footer settings"},PE.Views.HeaderFooterDialog||{}))})),void 0===Common)Common={};var c_oHyperlinkType={InternalLink:0,WebLink:1};define("presentationeditor/main/app/view/HyperlinkSettingsDialog",[],(function(){"use strict";PE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink-settings",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 330px;">','<div style="margin-bottom: 10px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternalLink,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternalLink,"</button>","</div>",'<div id="id-external-link">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row" style="margin-bottom: 5px;"></div>',"</div>",'<div id="id-internal-link" class="hidden">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-list" style="width:100%; height: 171px;"></div>',"</div>",'<div class="input-row">',"<label>"+this.strDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textTipText+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row" style="margin-bottom: 5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.slides=this.options.slides,this.api=this.options.api,this.type=t.type,this.urlType=AscCommon.c_oAscUrlType.Invalid,this.appOptions=this.options.appOptions,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),t.btnExternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.WebLink)),t.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),t.btnInternal.on("click",_.bind(t.onLinkTypeClick,t,c_oHyperlinkType.InternalLink)),Common.UI.GroupedButtons([t.btnExternal,t.btnInternal]);var i={el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:t.txtEmpty,validateOnBlur:!1,style:"width: 100%;",iconCls:"toolbar__icon btn-browse",placeHolder:t.appOptions.isDesktopApp?t.txtUrlPlaceholder:"",btnHint:t.textSelectFile,validation:function(e){var i=$.trim(e);return i.length>2083?t.txtSizeLimit:(t.urlType=t.api.asc_getUrlType(i),t.urlType!==AscCommon.c_oAscUrlType.Invalid||t.txtNotUrl)}};t.inputUrl=t.appOptions.isDesktopApp?new Common.UI.InputFieldBtn(i):new Common.UI.InputField(i),t.inputUrl._input.on("input",(function(e){t.isInputFirstChange&&t.inputUrl.showError(),t.isInputFirstChange=!1;var i=$(e.target).val();t.isAutoUpdate&&(t.inputDisplay.setValue(i),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(i))})),t.appOptions.isDesktopApp&&t.inputUrl.on("button:click",_.bind(t.onSelectFile,t)),t.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isTextChanged=!0})),t.inputDisplay._input.on("input",(function(e){t.isAutoUpdate=""==$(e.target).val()})),t.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength}),t.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,enableKeyEvents:!0,tabindex:1}),t.internalList.on("item:select",_.bind(this.onSelectItem,this)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),t.btnOk.setDisabled(!0),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.internalList.on("entervalue",_.bind(t.onPrimary,t)),t.externalPanel=e.find("#id-external-link"),t.internalPanel=e.find("#id-internal-link")},getFocusedComponents:function(){return[this.btnExternal,this.btnInternal,this.inputUrl,this.internalList,this.inputDisplay,this.inputTip].concat(this.getFooterButtons())},setSettings:function(t){if(t){var e=this,i=void 0!==e.type?e.type:e.parseUrl(t.get_Value());i==c_oHyperlinkType.WebLink?e.btnExternal.toggle(!0):e.btnInternal.toggle(!0),e.ShowHideElem(i,t.get_Value()),null!==t.get_Text()?(e.inputDisplay.setValue(t.get_Text()),e.inputDisplay.setDisabled(!1),e.isAutoUpdate=""==e.inputDisplay.getValue()||i==c_oHyperlinkType.WebLink&&e.inputUrl.getValue()==e.inputDisplay.getValue()):(this.inputDisplay.setValue(this.textDefault),this.inputDisplay.setDisabled(!0)),this.isTextChanged=!1,this.inputTip.setValue(t.get_ToolTip()),e._originalProps=t}},getSettings:function(){var t=this,e=new Asc.CHyperlinkProperty,i="",n=this.btnExternal.isActive()?c_oHyperlinkType.WebLink:c_oHyperlinkType.InternalLink;if(n==c_oHyperlinkType.InternalLink){var s="ppaction://hlink",a="",o=t.inputTip.getValue(),l=this.internalList.getSelectedRec();l&&(s+=l.get("type"),a=l.get("tiptext")),e.put_Value(s),e.put_ToolTip(_.isEmpty(o)?a:o),i=a}else{s=$.trim(t.inputUrl.getValue());t.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(s)||(s=(t.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+s),s=s.replace(new RegExp("%20","g")," "),e.put_Value(s),e.put_ToolTip(t.inputTip.getValue()),i=s}return t.inputDisplay.isDisabled()||!t.isTextChanged&&!_.isEmpty(t.inputDisplay.getValue())?e.put_Text(null):((_.isEmpty(t.inputDisplay.getValue())||n==c_oHyperlinkType.WebLink&&t.isAutoUpdate)&&t.inputDisplay.setValue(i),e.put_Text(t.inputDisplay.getValue())),e},onBtnClick:function(t){t.currentTarget&&t.currentTarget.attributes.result&&this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=!this.btnExternal.isActive()||this.inputUrl.checkValidate(),i=this.inputDisplay.checkValidate();if(!0!==e)return this.isInputFirstChange=!0,void this.inputUrl.focus();if(!0!==i)return void this.inputDisplay.focus();!this._originalProps.get_Value()&&Common.Utils.InternalSettings.set("pe-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()},ShowHideElem:function(t,e){if(this.externalPanel.toggleClass("hidden",t!==c_oHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==c_oHyperlinkType.InternalLink),t==c_oHyperlinkType.InternalLink){null!=e&&""!=e||(e="ppaction://hlinkshowjump?jump=firstslide");var i=this.internalList.store;if(i.length<1){var n=[],s=0;n.push(new Common.UI.TreeViewModel({name:this.txtFirst,level:0,index:s++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=firstslide",tiptext:this.txtFirst,selected:"ppaction://hlinkshowjump?jump=firstslide"==e})),n.push(new Common.UI.TreeViewModel({name:this.txtLast,level:0,index:s++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=lastslide",tiptext:this.txtLast,selected:"ppaction://hlinkshowjump?jump=lastslide"==e})),n.push(new Common.UI.TreeViewModel({name:this.txtNext,level:0,index:s++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=nextslide",tiptext:this.txtNext,selected:"ppaction://hlinkshowjump?jump=nextslide"==e})),n.push(new Common.UI.TreeViewModel({name:this.txtPrev,level:0,index:s++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"showjump?jump=previousslide",tiptext:this.txtPrev,selected:"ppaction://hlinkshowjump?jump=previousslide"==e})),n.push(new Common.UI.TreeViewModel({name:this.textSlides,level:0,index:s++,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:this.api.getCountPages()>0}));var a="ppaction://hlinksldjumpslide",o=0==e.indexOf(a)?parseInt(e.substring(28)):-1;for(s=0;s<this.api.getCountPages();s++)n.push(new Common.UI.TreeViewModel({name:this.txtSlide+" "+(s+1),level:1,index:n.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,hasSubItems:!1,type:"sldjumpslide"+s,tiptext:this.txtSlide+" "+(s+1),selected:s==o}));i.reset(n)}var l=this.internalList.getSelectedRec();l&&this.internalList.scrollToRecord(l),this.btnOk.setDisabled(!l||4==l.get("index"));var r=this;_.delay((function(){r.inputDisplay.focus()}),50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));r=this;_.delay((function(){r.inputUrl.focus()}),50)}},onLinkTypeClick:function(t,e,i){if(this.ShowHideElem(t),this.isAutoUpdate){if(t==c_oHyperlinkType.InternalLink){var n=this.internalList.getSelectedRec();this.inputDisplay.setValue(n&&(n.get("level")||n.get("index")<4)?n.get("name"):"")}else this.inputDisplay.setValue(this.inputUrl.getValue());this.isTextChanged=!0}},parseUrl:function(t){return null==t||""==t?Common.Utils.InternalSettings.get("pe-settings-link-type")?c_oHyperlinkType.InternalLink:c_oHyperlinkType.WebLink:0==t.indexOf("ppaction://hlink")?c_oHyperlinkType.InternalLink:(this.inputUrl.setValue(t?t.replace(new RegExp(" ","g"),"%20"):""),c_oHyperlinkType.WebLink)},onSelectItem:function(t,e,i,n){i&&(this.btnOk.setDisabled(4==i.get("index")),this.isAutoUpdate&&(this.inputDisplay.setValue(i.get("level")||i.get("index")<4?i.get("name"):""),this.isTextChanged=!0))},onSelectFile:function(){var t=this;if(t.api){t.api.asc_getFilePath((function(e){e&&(t.inputUrl.setValue(e),!0!==t.inputUrl.checkValidate()&&(t.isInputFirstChange=!0),t.isAutoUpdate&&(t.inputDisplay.setValue(e),t.isTextChanged=!0),t.btnOk.setDisabled(""==$.trim(e)))}))}},textTitle:"Hyperlink Settings",textInternalLink:"Place in Document",textExternalLink:"External Link",textEmptyLink:"Enter link here",textEmptyDesc:"Enter caption here",textEmptyTooltip:"Enter tooltip here",txtSlide:"Slide",strDisplay:"Display",textTipText:"Screen Tip Text",strLinkTo:"Link To",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"',txtNext:"Next Slide",txtPrev:"Previous Slide",txtFirst:"First Slide",txtLast:"Last Slide",textDefault:"Selected text",textSlides:"Slides",txtSizeLimit:"This field is limited to 2083 characters",txtUrlPlaceholder:"Enter the web address or select a file",textSelectFile:"Select file"},PE.Views.HyperlinkSettingsDialog||{}))})),define("presentationeditor/main/app/view/DateTimeDialog",[],(function(){"use strict";PE.Views.DateTimeDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-date-time",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="font-weight-bold">'+this.textLang+"</label>","</div>",'<div id="datetime-dlg-lang" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">','<label class="font-weight-bold">'+this.textFormat+"</label>","</div>",'<div id="datetime-dlg-format" class="" style="margin-bottom: 10px;width: 100%; height: 162px; overflow: hidden;"></div>','<div class="input-row" style="margin-bottom: 8px;">','<div id="datetime-dlg-update" style="margin-top: 3px;margin-bottom: 10px;"></div>','<button type="button" class="btn btn-text-default auto float-right" id="datetime-dlg-default">'+this.textDefault+"</button>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.lang=this.options.lang,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=[{value:1025},{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:14345},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1057},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:10266},{value:9242},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052},{value:1028}];t.forEach((function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value),i=Common.util.LanguageInfo.getLocalLanguageDisplayName(t.value);t.displayValue=i.native,t.displayValueEn=i.english,t.langName=e[0]})),this.cmbLang=new Common.UI.ComboBox({el:$("#datetime-dlg-lang"),menuStyle:"min-width: 100%; max-height: 185px;",cls:"input-group-nr",editable:!1,takeFocusOnClose:!0,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),data:t,search:!0,searchFields:["displayValue","displayValueEn"],scrollAlwaysVisible:!0}),this.cmbLang.setValue(1033),this.cmbLang.on("selected",_.bind((function(t,e){this.updateFormats(e.value)}),this)),this.chUpdate=new Common.UI.CheckBox({el:$("#datetime-dlg-update"),labelText:this.textUpdate}),this.chUpdate.on("change",_.bind((function(t,e,i,n){this.onSelectFormat(this.listFormats,null,this.listFormats.getSelectedRec())}),this)),this.listFormats=new Common.UI.ListView({el:$("#datetime-dlg-format"),store:new Common.UI.DataViewStore,scrollAlwaysVisible:!0,tabindex:1,cls:"dbl-clickable"}),this.listFormats.on("item:select",_.bind(this.onSelectFormat,this)),this.listFormats.on("item:dblclick",_.bind(this.onDblClickFormat,this)),this.listFormats.on("entervalue",_.bind(this.onPrimary,this)),this.btnDefault=new Common.UI.Button({el:$("#datetime-dlg-default")}),this.btnDefault.on("click",_.bind((function(t,e){var i=this.listFormats.getSelectedRec();Common.UI.warning({msg:Common.Utils.String.format(this.confirmDefault,Common.util.LanguageInfo.getLocalLanguageName(this.cmbLang.getValue())[1],i?i.get("value"):""),buttons:["yes","no"],primary:"yes",callback:_.bind((function(t){if("yes"==t){this.defaultFormats[this.cmbLang.getValue()]=i?i.get("format"):"",this.api.asc_setDefaultDateTimeFormat(this.defaultFormats);var e=[];for(var n in this.defaultFormats)n&&e.push(n+" "+this.defaultFormats[n]);var s=e.join(";");Common.localStorage.setItem("pe-settings-datetime-default",s),Common.Utils.InternalSettings.set("pe-settings-datetime-default",s)}this.listFormats.focus()}),this)})}),this)),this.chUpdate.$el.outerWidth()+this.btnDefault.$el.outerWidth()>this.$window.find(".box").width()&&(this.btnDefault.$el.removeClass("float-right"),this.listFormats.$el.height(139)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},afterRender:function(){var t=this,e=Common.Utils.InternalSettings.get("pe-settings-datetime-default"),i=e?e.split(";"):[];this.defaultFormats=[],i.forEach((function(e){var i=e.split(" ");t.defaultFormats[parseInt(i[0])]=i[1]})),this._setDefaults()},getFocusedComponents:function(){return[this.cmbLang,this.listFormats,this.chUpdate,this.btnDefault].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbLang},_setDefaults:function(){if(this.props=new AscCommonSlide.CAscDateTime,this.lang){var t=this.cmbLang.store.findWhere({value:this.lang});t=t?t.get("value"):1033,this.cmbLang.setValue(t)}this.updateFormats(this.cmbLang.getValue())},getSettings:function(){return this.props},updateFormats:function(t){this.props.put_Lang(t);var e=this.props.get_DateTimeExamples(),i=[],n=this.listFormats.store;for(var s in e){if(e[s])(o=new Common.UI.DataViewModel).set({format:s,value:e[s]}),i.push(o)}n.reset(i);var a=this.defaultFormats[t];a?this.listFormats.selectRecord(n.findWhere({format:a})):this.listFormats.selectByIndex(0);var o=this.listFormats.getSelectedRec();this.listFormats.scrollToRecord(o),this.onSelectFormat(this.listFormats,null,o)},onSelectFormat:function(t,e,i){i&&("checked"==this.chUpdate.getValue()?this.props.put_DateTime(i.get("format")):(this.props.put_DateTime(null),this.props.put_CustomDateTime(i.get("value"))))},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,this.getSettings()),this.close()},txtTitle:"Date & Time",textLang:"Language",textFormat:"Formats",textUpdate:"Update automatically",textDefault:"Set as default",confirmDefault:'Set default format for {0}: "{1}"'},PE.Views.DateTimeDialog||{}))})),define("text!presentationeditor/main/app/template/ChartSettingsAdvanced.template",[],(function(){return'<div id="id-adv-chart-general" class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" width="100%" role="presentation">\n        <tr>\n            <td class="padding-large">\n                <label class="header"><%= scope.textChartName %></label>\n                <div id="chart-advanced-name"></div>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n<div  id="id-adv-chart-placement" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="3" role="presentation">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textSize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td width="93px" class="padding-large">\n                    <label class="input-label"><%= scope.textWidth %></label>\n                    <div id="chart-advanced-spin-width"></div>\n                </td>\n                <td width="28px" style="vertical-align: bottom;" class="padding-large">\n                    <div id="chart-advanced-button-ratio"></div>\n                </td>\n                <td width="93px" class="padding-large">\n                    <label class="input-label"><%= scope.textHeight %></label>\n                    <div id="chart-advanced-spin-height"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan="4" width="88px" class="padding-small">\n                    <label class="header"><%= scope.textPosition %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="121px">\n                    <label class="input-label"><%= scope.textHorizontal %></label>\n                    <div id="chart-advanced-spin-x"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="chart-advanced-combo-from-x"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textVertical %></label>\n                    <div id="chart-advanced-spin-y"></div>\n                </td>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textFrom %></label>\n                    <div id="chart-advanced-combo-from-y"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-chart-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="chart-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="chart-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("presentationeditor/main/app/view/ChartSettingsAdvanced",["text!presentationeditor/main/app/template/ChartSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";PE.Views.ChartSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:257,toggleGroup:"chart-adv-settings-group",properties:null,storageName:"pe-chart-settings-adv-category",sizeMax:{width:55.88,height:55.88}},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-chart-general",panelCaption:this.textGeneral},{panelId:"id-adv-chart-placement",panelCaption:this.textPlacement},{panelId:"id-adv-chart-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this._originalProps=this.options.chartProps,this.slideSize=this.options.slideSize,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputChartName=new Common.UI.InputField({el:$("#chart-advanced-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isChartNameChanged=!0})),this.spnWidth=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-width"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t){if(this.btnRatio.pressed){var e=t.getNumberValue(),i=e/this._nRatio;i>this.sizeMax.height&&(e=(i=this.sizeMax.height)*this._nRatio,this.spnWidth.setValue(e,!0)),this.spnHeight.setValue(i,!0)}this._changedProps&&(this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-height"),step:.1,width:85,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,n){var s=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=s*this._nRatio)>this.sizeMax.width&&(s=(a=this.sizeMax.width)/this._nRatio,this.spnHeight.setValue(s,!0)),this.spnWidth.setValue(a,!0)),this._changedProps&&(this._changedProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#chart-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.spnX=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-x"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnX),this.spnY=new Common.UI.MetricSpinner({el:$("#chart-advanced-spin-y"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.spinners.push(this.spnY),this.cmbFromX=new Common.UI.ComboBox({el:$("#chart-advanced-combo-from-x"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.cmbFromY=new Common.UI.ComboBox({el:$("#chart-advanced-combo-from-y"),cls:"input-group-nr",style:"width: 125px;",menuStyle:"min-width: 125px;",data:[{value:"left",displayValue:this.textTopLeftCorner},{value:"center",displayValue:this.textCenter}],editable:!1,takeFocusOnClose:!0}),this.inputAltTitle=new Common.UI.InputField({el:$("#chart-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputChartName,this.spnWidth,this.btnRatio,this.spnHeight,this.spnX,this.cmbFromX,this.spnY,this.cmbFromY,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputChartName.focus();break;case 1:i.spnWidth.focus();break;case 2:i.inputAltTitle.focus()}}),10)},_setDefaults:function(t){if(t){var e=t.asc_getName();if(this.inputChartName.setValue(e||""),this.spnWidth.setMaxValue(this.sizeMax.width),this.spnHeight.setMaxValue(this.sizeMax.height),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),this.cmbFromX.setValue("left"),this.cmbFromY.setValue("left"),t.asc_getPosition()){var i={X:t.asc_getPosition().get_X(),Y:t.asc_getPosition().get_Y()};this.spnX.setValue(null!=i.X?Common.Utils.Metric.fnRecalcFromMM(i.X):"",!0),this.spnY.setValue(null!=i.Y?Common.Utils.Metric.fnRecalcFromMM(i.Y):"",!0)}else this.spnX.setValue("",!0),this.spnY.setValue("",!0);e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),this._changedProps=new Asc.CAscChartProp}},getSettings:function(){var t=new Asc.CPosition;if(this.isChartNameChanged&&this._changedProps.asc_putName(this.inputChartName.getValue()),""!==this.spnX.getValue()){var e=Common.Utils.Metric.fnRecalcToMM(this.spnX.getNumberValue());"center"===this.cmbFromX.getValue()&&(e=this.slideSize.width/36e3/2+e),t.put_X(e)}if(""!==this.spnY.getValue()){var i=Common.Utils.Metric.fnRecalcToMM(this.spnY.getNumberValue());"center"===this.cmbFromY.getValue()&&(i=this.slideSize.height/36e3/2+i),t.put_Y(i)}return this._changedProps.asc_putPosition(t),this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),{chartProps:this._changedProps}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)}},textTitle:"Chart - Advanced Settings",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textPlacement:"Placement",textSize:"Size",textWidth:"Width",textHeight:"Height",textPosition:"Position",textHorizontal:"Horizontal",textVertical:"Vertical",textFrom:"From",textTopLeftCorner:"Top Left Corner",textCenter:"Center",textKeepRatio:"Constant Proportions",textGeneral:"General",textChartName:"Chart name"},PE.Views.ChartSettingsAdvanced||{}))})),require(["common/main/lib/util/define","common/main/lib/controller/ScreenReaderFocus","common/main/lib/component/ComboBoxDataView","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/AutoCorrectDialog","common/main/lib/view/DocumentAccessDialog","common/main/lib/view/SaveAsDlg","common/main/lib/view/CopyWarningDialog","common/main/lib/view/TextInputDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/view/ExternalEditor","common/main/lib/view/ExternalDiagramEditor","common/main/lib/view/ExternalOleEditor","common/main/lib/view/LanguageDialog","common/main/lib/view/SearchDialog","common/main/lib/view/InsertTableDialog","common/main/lib/view/RenameDialog","common/main/lib/view/PasswordDialog","common/main/lib/view/PluginDlg","common/main/lib/view/PluginPanel","common/main/lib/view/ShapeShadowDialog","common/main/lib/view/CustomizeQuickAccessDialog","common/main/lib/view/DocumentHolderExt","common/main/lib/view/SignDialog","common/main/lib/view/ListSettingsDialog","common/main/lib/view/DocumentPropertyDialog","common/main/lib/view/MacrosDialog","common/main/lib/view/MacrosAiDialog","common/main/lib/component/MonacoEditor","common/main/lib/component/TextareaField","presentationeditor/main/app/controller/DocumentHolderExt","presentationeditor/main/app/view/FileMenuPanels","presentationeditor/main/app/view/DocumentHolderExt","presentationeditor/main/app/view/ParagraphSettingsAdvanced","presentationeditor/main/app/view/ShapeSettingsAdvanced","presentationeditor/main/app/view/TableSettingsAdvanced","presentationeditor/main/app/view/ImageSettingsAdvanced","presentationeditor/main/app/view/SlideshowSettings","presentationeditor/main/app/view/AnimationDialog","presentationeditor/main/app/view/HeaderFooterDialog","presentationeditor/main/app/view/HyperlinkSettingsDialog","presentationeditor/main/app/view/DateTimeDialog","presentationeditor/main/app/view/ChartSettingsAdvanced"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/presentationeditor/main/app_pack.js",(function(){}));