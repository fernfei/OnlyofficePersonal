/* minified by terser */
if(void 0===Common)var Common={};if(define("common/main/lib/component/TextareaField",[],(function(){"use strict";Common.UI.TextareaField=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",value:"",maxlength:void 0,placeHolder:"",spellcheck:!1,disabled:!1,resize:!1},template:_.template(['<div class="textarea-field" style="<%= style %>">',"<textarea ",'spellcheck="<%= spellcheck %>" ','class="form-control <%= cls %>" ','placeholder="<%= placeHolder %>" ',"<% if (dataHint) {%>",'data-hint="<%= dataHint %>" ',"<% } %>","<% if (dataHintDirection) {%>",'data-hint-direction="<%= dataHintDirection %>" ',"<% } %>","<% if (dataHintOffset) {%>",'data-hint-offset="<%= dataHintOffset %>" ',"<% } %>","></textarea>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var i=this;this.id=i.options.id||Common.UI.getId(),this.cls=i.options.cls,this.style=i.options.style,this.value=i.options.value,this.placeHolder=i.options.placeHolder,this.template=i.options.template||i.template,this.disabled=i.options.disabled,this.spellcheck=i.options.spellcheck,this.maxLength=i.options.maxLength,i.rendered=i.options.rendered||!1,i.options.el&&i.render()},render:function(t){var i=this;return i.rendered?this.cmpEl=this.$el:(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,placeHolder:this.placeHolder,spellcheck:this.spellcheck,dataHint:this.options.dataHint,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,scope:i})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),i.rendered||(this.cmpEl,this._input=this.cmpEl.find("textarea").addBack().filter("textarea"),this._input.on("blur",_.bind(this.onInputChanged,this)),this._input.on("keydown",_.bind(this.onKeyDown,this)),this.maxLength&&this._input.attr("maxlength",this.maxLength),this.resize||this._input.css("resize","none"),this.disabled&&this.setDisabled(this.disabled)),i.rendered=!0,i.value&&i.setValue(i.value),this},_doChange:function(t,i){if(!i||!i.synthetic){var e=$(t.target).val(),n=this.value;this.trigger("changed:before",this,e,n,t),t.isDefaultPrevented()||(this.value=e,this.trigger("changed:after",this,e,n,t))}},onInputChanged:function(t,i){this._doChange(t,i)},onKeyDown:function(t){this.trigger("keydown:before",this,t),t.isDefaultPrevented()||(t.keyCode===Common.UI.Keys.RETURN&&t.stopPropagation(),t.keyCode==Common.UI.Keys.ESC&&this.setValue(this.value),t.keyCode==Common.UI.Keys.ESC&&this.trigger("inputleave",this))},setDisabled:function(t){t=!!t,this.disabled=t,$(this.el).toggleClass("disabled",t),t?this._input.attr("disabled",!0):this._input.removeAttr("disabled")},isDisabled:function(){return this.disabled},setValue:function(t){this.value=t,this.rendered&&this._input.val(t)},getValue:function(){return this.value},focus:function(){this._input.focus()}})})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var i={};_.extend(i,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,i.width=Common.Utils.innerWidth()-2*this.bordersOffset-i.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:i.width,i.cls+=" advanced-settings-dlg invisible-borders",(!i.buttons||_.size(i.buttons)<1)&&(i.cls+=" no-footer"),i.contentHeight=i.height,i.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+i.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),i.tpl=_.template(this.template)(i),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var i=document.createElement("iframe");i.id=this.frameId,i.name="pluginFrameEditor",i.width="100%",i.height="100%",i.align="top",i.frameBorder=0,i.scrolling="no",i.allow="camera; microphone; display-capture",i.onload=_.bind(this._onLoad,this);var e=this,n=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){e.isLoaded||(e.loadMask=new Common.UI.LoadMask({owner:n}),e.loadMask.setTitle(e.textLoading),e.loadMask.show(),e.isLoaded&&e.loadMask.hide())}),500),i.src=this.url,n.append(i),this.frame=i,this.on("resizing",(function(t){e.boxEl.css("height",parseInt(e.$window.css("height"))-e._headerFooterHeight)}));var o=function(){e.onWindowResize()};$(window).on("resize",o),this.on("close",(function(){$(window).off("resize",o)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,i){var e=Common.Utils.innerHeight(),n=Common.Utils.innerWidth(),o=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),s=2*this.bordersOffset;e-s<i+this._headerFooterHeight&&(i=e-s-this._headerFooterHeight),n-s<t+o&&(t=n-s-o),this.boxEl.css("height",i),Common.UI.Window.prototype.setHeight.call(this,i+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+o),this.$window.css("left",(n-t-o)/2),this.$window.css("top",(e-i-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),i=Common.Utils.innerHeight(),e=this.getWidth(),n=this.getHeight(),o=this.resizable?0:this.bordersOffset;if(n<i-2*o+.1){if(!this.resizable&&this._restoreHeight>0&&n<this._restoreHeight){var s=Math.max(Math.min(this._restoreHeight,i-2*o),this.initConfig.minheight);this.setHeight(s),this.boxEl.css("height",s-this._headerFooterHeight)}var a=this.getTop();a<o?this.$window.css("top",o):a+n>i-o&&this.$window.css("top",i-o-n)}else void 0===this._restoreHeight&&(this._restoreHeight=n),this.setHeight(Math.max(i-2*o,this.initConfig.minheight)),this.boxEl.css("height",Math.max(i-2*o,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",o);if(e<t-2*o+.1){!this.resizable&&this._restoreWidth>0&&e<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*o),this.initConfig.minwidth));var l=this.getLeft();l<o?this.$window.css("left",o):l+e>t-o&&this.$window.css("left",t-o-e)}else void 0===this._restoreWidth&&(this._restoreWidth=e),this.setWidth(Math.max(t-2*o,this.initConfig.minwidth)),this.$window.css("left",o)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),i="id-plugindlg-docked",e=t.find("#"+i);if(e.length<1){(e=$('<div id="'+i+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=e.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(e),e.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}e.show(),t.removeClass("hidden")},showButton:function(t,i){var e=this.$window.find(i?".header .tools:not(.left)":".header .tools.left"),n=e.find("#id-plugindlg-"+t);if(n.length<1){var o="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(n=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+o+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),e.append(n)}n.show(),e.removeClass("hidden")},hideButton:function(t){var i=this.$window.find(".header #id-plugindlg-"+t);i.length>0&&i.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var i={};_.extend(i,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var i={},e=this;_.extend(i,{header:!1,label:t.label||e.textUrl,inputConfig:{allowBlank:!1,blankError:e.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||e.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,i)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var i={};_.extend(i,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),i.tpl=_.template(this.template)(i),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var i=this;this._eventfunc=function(t){i._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){i._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var i=this;setTimeout((function(){_.isEmpty(t.file)||i.trigger("selectfile",i,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var i={};_.extend(i,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),i.tpl=_.template(this.template)(i),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var i=this;this._eventfunc=function(t){i._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){i._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),require(["common/main/lib/component/TextareaField","common/main/lib/view/PluginDlg","common/main/lib/view/CopyWarningDialog","common/main/lib/view/TextInputDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SaveAsDlg"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/documenteditor/forms/app_pack.js",(function(){}));