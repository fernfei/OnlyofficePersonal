/* minified by terser */
function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}if(void 0===Common)var Common={};void 0===Common.define&&(Common.define={}),define("common/main/lib/util/define",[],(function(){"use strict";Common.define.c_oAscMathMainType={Symbol:0,Fraction:1,Script:2,Radical:3,Integral:4,LargeOperator:5,Bracket:6,Function:7,Accent:8,LimitLog:9,Operator:10,Matrix:11},Common.define.c_oAscMathType={Symbol_pm:0,Symbol_infinity:1,Symbol_equals:2,Symbol_neq:3,Symbol_about:4,Symbol_times:5,Symbol_div:6,Symbol_factorial:7,Symbol_propto:8,Symbol_less:9,Symbol_ll:10,Symbol_greater:11,Symbol_gg:12,Symbol_leq:13,Symbol_geq:14,Symbol_mp:15,Symbol_cong:16,Symbol_approx:17,Symbol_equiv:18,Symbol_forall:19,Symbol_additional:20,Symbol_partial:21,Symbol_sqrt:22,Symbol_cbrt:23,Symbol_qdrt:24,Symbol_cup:25,Symbol_cap:26,Symbol_emptyset:27,Symbol_percent:28,Symbol_degree:29,Symbol_fahrenheit:30,Symbol_celsius:31,Symbol_inc:32,Symbol_nabla:33,Symbol_exists:34,Symbol_notexists:35,Symbol_in:36,Symbol_ni:37,Symbol_leftarrow:38,Symbol_uparrow:39,Symbol_rightarrow:40,Symbol_downarrow:41,Symbol_leftrightarrow:42,Symbol_therefore:43,Symbol_plus:44,Symbol_minus:45,Symbol_not:46,Symbol_ast:47,Symbol_bullet:48,Symbol_vdots:49,Symbol_cdots:50,Symbol_rddots:51,Symbol_ddots:52,Symbol_aleph:53,Symbol_beth:54,Symbol_QED:55,Symbol_alpha:65536,Symbol_beta:65537,Symbol_gamma:65538,Symbol_delta:65539,Symbol_varepsilon:65540,Symbol_epsilon:65541,Symbol_zeta:65542,Symbol_eta:65543,Symbol_theta:65544,Symbol_vartheta:65545,Symbol_iota:65546,Symbol_kappa:65547,Symbol_lambda:65548,Symbol_mu:65549,Symbol_nu:65550,Symbol_xsi:65551,Symbol_o:65552,Symbol_pi:65553,Symbol_varpi:65554,Symbol_rho:65555,Symbol_varrho:65556,Symbol_sigma:65557,Symbol_varsigma:65558,Symbol_tau:65559,Symbol_upsilon:65560,Symbol_varphi:65561,Symbol_phi:65562,Symbol_chi:65563,Symbol_psi:65564,Symbol_omega:65565,Symbol_Alpha:131072,Symbol_Beta:131073,Symbol_Gamma:131074,Symbol_Delta:131075,Symbol_Epsilon:131076,Symbol_Zeta:131077,Symbol_Eta:131078,Symbol_Theta:131079,Symbol_Iota:131080,Symbol_Kappa:131081,Symbol_Lambda:131082,Symbol_Mu:131083,Symbol_Nu:131084,Symbol_Xsi:131085,Symbol_O:131086,Symbol_Pi:131087,Symbol_Rho:131088,Symbol_Sigma:131089,Symbol_Tau:131090,Symbol_Upsilon:131091,Symbol_Phi:131092,Symbol_Chi:131093,Symbol_Psi:131094,Symbol_Omega:131095,FractionVertical:16777216,FractionDiagonal:16777217,FractionHorizontal:16777218,FractionSmall:16777219,FractionDifferential_1:16842752,FractionDifferential_2:16842753,FractionDifferential_3:16842754,FractionDifferential_4:16842755,FractionPi_2:16842756,ScriptSup:33554432,ScriptSub:33554433,ScriptSubSup:33554434,ScriptSubSupLeft:33554435,ScriptCustom_1:33619968,ScriptCustom_2:33619969,ScriptCustom_3:33619970,ScriptCustom_4:33619971,RadicalSqrt:50331648,RadicalRoot_n:50331649,RadicalRoot_2:50331650,RadicalRoot_3:50331651,RadicalCustom_1:50397184,RadicalCustom_2:50397185,Integral:67108864,IntegralSubSup:67108865,IntegralCenterSubSup:67108866,IntegralDouble:67108867,IntegralDoubleSubSup:67108868,IntegralDoubleCenterSubSup:67108869,IntegralTriple:67108870,IntegralTripleSubSup:67108871,IntegralTripleCenterSubSup:67108872,IntegralOriented:67174400,IntegralOrientedSubSup:67174401,IntegralOrientedCenterSubSup:67174402,IntegralOrientedDouble:67174403,IntegralOrientedDoubleSubSup:67174404,IntegralOrientedDoubleCenterSubSup:67174405,IntegralOrientedTriple:67174406,IntegralOrientedTripleSubSup:67174407,IntegralOrientedTripleCenterSubSup:67174408,Integral_dx:67239936,Integral_dy:67239937,Integral_dtheta:67239938,LargeOperator_Sum:83886080,LargeOperator_Sum_CenterSubSup:83886081,LargeOperator_Sum_SubSup:83886082,LargeOperator_Sum_CenterSub:83886083,LargeOperator_Sum_Sub:83886084,LargeOperator_Prod:83951616,LargeOperator_Prod_CenterSubSup:83951617,LargeOperator_Prod_SubSup:83951618,LargeOperator_Prod_CenterSub:83951619,LargeOperator_Prod_Sub:83951620,LargeOperator_CoProd:83951621,LargeOperator_CoProd_CenterSubSup:83951622,LargeOperator_CoProd_SubSup:83951623,LargeOperator_CoProd_CenterSub:83951624,LargeOperator_CoProd_Sub:83951625,LargeOperator_Union:84017152,LargeOperator_Union_CenterSubSup:84017153,LargeOperator_Union_SubSup:84017154,LargeOperator_Union_CenterSub:84017155,LargeOperator_Union_Sub:84017156,LargeOperator_Intersection:84017157,LargeOperator_Intersection_CenterSubSup:84017158,LargeOperator_Intersection_SubSup:84017159,LargeOperator_Intersection_CenterSub:84017160,LargeOperator_Intersection_Sub:84017161,LargeOperator_Disjunction:84082688,LargeOperator_Disjunction_CenterSubSup:84082689,LargeOperator_Disjunction_SubSup:84082690,LargeOperator_Disjunction_CenterSub:84082691,LargeOperator_Disjunction_Sub:84082692,LargeOperator_Conjunction:84082693,LargeOperator_Conjunction_CenterSubSup:84082694,LargeOperator_Conjunction_SubSup:84082695,LargeOperator_Conjunction_CenterSub:84082696,LargeOperator_Conjunction_Sub:84082697,LargeOperator_Custom_1:84148224,LargeOperator_Custom_2:84148225,LargeOperator_Custom_3:84148226,LargeOperator_Custom_4:84148227,LargeOperator_Custom_5:84148228,Bracket_Round:100663296,Bracket_Square:100663297,Bracket_Curve:100663298,Bracket_Angle:100663299,Bracket_LowLim:100663300,Bracket_UppLim:100663301,Bracket_Line:100663302,Bracket_LineDouble:100663303,Bracket_Square_OpenOpen:100663304,Bracket_Square_CloseClose:100663305,Bracket_Square_CloseOpen:100663306,Bracket_SquareDouble:100663307,Bracket_Round_Delimiter_2:100728832,Bracket_Curve_Delimiter_2:100728833,Bracket_Angle_Delimiter_2:100728834,Bracket_Angle_Delimiter_3:100728835,Bracket_Round_OpenNone:100794368,Bracket_Round_NoneOpen:100794369,Bracket_Square_OpenNone:100794370,Bracket_Square_NoneOpen:100794371,Bracket_Curve_OpenNone:100794372,Bracket_Curve_NoneOpen:100794373,Bracket_Angle_OpenNone:100794374,Bracket_Angle_NoneOpen:100794375,Bracket_LowLim_OpenNone:100794376,Bracket_LowLim_NoneNone:100794377,Bracket_UppLim_OpenNone:100794378,Bracket_UppLim_NoneOpen:100794379,Bracket_Line_OpenNone:100794380,Bracket_Line_NoneOpen:100794381,Bracket_LineDouble_OpenNone:100794382,Bracket_LineDouble_NoneOpen:100794383,Bracket_SquareDouble_OpenNone:100794384,Bracket_SquareDouble_NoneOpen:100794385,Bracket_Custom_1:100859904,Bracket_Custom_2:100859905,Bracket_Custom_3:100859906,Bracket_Custom_4:100859907,Bracket_Custom_5:100925440,Bracket_Custom_6:100925441,Bracket_Custom_7:100925442,Function_Sin:117440512,Function_Cos:117440513,Function_Tan:117440514,Function_Csc:117440515,Function_Sec:117440516,Function_Cot:117440517,Function_1_Sin:117506048,Function_1_Cos:117506049,Function_1_Tan:117506050,Function_1_Csc:117506051,Function_1_Sec:117506052,Function_1_Cot:117506053,Function_Sinh:117571584,Function_Cosh:117571585,Function_Tanh:117571586,Function_Csch:117571587,Function_Sech:117571588,Function_Coth:117571589,Function_1_Sinh:117637120,Function_1_Cosh:117637121,Function_1_Tanh:117637122,Function_1_Csch:117637123,Function_1_Sech:117637124,Function_1_Coth:117637125,Function_Custom_1:117702656,Function_Custom_2:117702657,Function_Custom_3:117702658,Accent_Dot:134217728,Accent_DDot:134217729,Accent_DDDot:134217730,Accent_Hat:134217731,Accent_Check:134217732,Accent_Accent:134217733,Accent_Grave:134217734,Accent_Smile:134217735,Accent_Tilde:134217736,Accent_Bar:134217737,Accent_DoubleBar:134217738,Accent_CurveBracketTop:134217739,Accent_CurveBracketBot:134217740,Accent_GroupTop:134217741,Accent_GroupBot:134217742,Accent_ArrowL:134217743,Accent_ArrowR:134217744,Accent_ArrowD:134217745,Accent_HarpoonL:134217746,Accent_HarpoonR:134217747,Accent_BorderBox:134283264,Accent_BorderBoxCustom:134283265,Accent_BarTop:134348800,Accent_BarBot:134348801,Accent_Custom_1:134414336,Accent_Custom_2:134414337,Accent_Custom_3:134414338,LimitLog_LogBase:150994944,LimitLog_Log:150994945,LimitLog_Lim:150994946,LimitLog_Min:150994947,LimitLog_Max:150994948,LimitLog_Ln:150994949,LimitLog_Custom_1:151060480,LimitLog_Custom_2:151060481,Operator_ColonEquals:167772160,Operator_EqualsEquals:167772161,Operator_PlusEquals:167772162,Operator_MinusEquals:167772163,Operator_Definition:167772164,Operator_UnitOfMeasure:167772165,Operator_DeltaEquals:167772166,Operator_ArrowL_Top:167837696,Operator_ArrowR_Top:167837697,Operator_ArrowL_Bot:167837698,Operator_ArrowR_Bot:167837699,Operator_DoubleArrowL_Top:167837700,Operator_DoubleArrowR_Top:167837701,Operator_DoubleArrowL_Bot:167837702,Operator_DoubleArrowR_Bot:167837703,Operator_ArrowD_Top:167837704,Operator_ArrowD_Bot:167837705,Operator_DoubleArrowD_Top:167837706,Operator_DoubleArrowD_Bot:167837707,Operator_Custom_1:167903232,Operator_Custom_2:167903233,Matrix_1_2:184549376,Matrix_2_1:184549377,Matrix_1_3:184549378,Matrix_3_1:184549379,Matrix_2_2:184549380,Matrix_2_3:184549381,Matrix_3_2:184549382,Matrix_3_3:184549383,Matrix_Dots_Center:184614912,Matrix_Dots_Baseline:184614913,Matrix_Dots_Vertical:184614914,Matrix_Dots_Diagonal:184614915,Matrix_Identity_2:184680448,Matrix_Identity_2_NoZeros:184680449,Matrix_Identity_3:184680450,Matrix_Identity_3_NoZeros:184680451,Matrix_2_2_RoundBracket:184745984,Matrix_2_2_SquareBracket:184745985,Matrix_2_2_LineBracket:184745986,Matrix_2_2_DLineBracket:184745987,Matrix_Flat_Round:184811520,Matrix_Flat_Square:184811521},Common.define.chartData=_.extend(new function(){return{textLine:"Line",textColumn:"Column",textBar:"Bar",textArea:"Area",textPie:"Pie",textPoint:"XY (Scatter)",textStock:"Stock",textSurface:"Surface",textCharts:"Charts",textSparks:"Sparklines",textLineSpark:"Line",textColumnSpark:"Column",textWinLossSpark:"Win/Loss",textCombo:"Combo",textBarNormal:"Clustered column",textBarStacked:"Stacked column",textBarStackedPer:"100% Stacked column",textBarNormal3d:"3-D Clustered column",textBarStacked3d:"3-D Stacked column",textBarStackedPer3d:"3-D 100% Stacked column",textBarNormal3dPerspective:"3-D column",textLineStacked:"Stacked line",textLineStackedPer:"100% Stacked line",textLineMarker:"Line with markers",textLineStackedMarker:"Stacked line with markers",textLineStackedPerMarker:"100% Stacked line with markers",textLine3d:"3-D line",textDoughnut:"Doughnut",textPie3d:"3-D pie",textHBarNormal:"Clustered bar",textHBarStacked:"Stacked bar",textHBarStackedPer:"100% Stacked bar",textHBarNormal3d:"3-D Clustered bar",textHBarStacked3d:"3-D Stacked bar",textHBarStackedPer3d:"3-D 100% Stacked bar",textAreaStacked:"Stacked area",textAreaStackedPer:"100% Stacked area",textScatter:"Scatter",textScatterSmoothMarker:"Scatter with smooth lines and markers",textScatterSmooth:"Scatter with smooth lines",textScatterLineMarker:"Scatter with straight lines and markers",textScatterLine:"Scatter with straight lines",textComboBarLine:"Clustered column - line",textComboBarLineSecondary:"Clustered column - line on secondary axis",textComboAreaBar:"Stacked area - clustered column",textComboCustom:"Custom combination",textRadar:"Radar",textRadarMarker:"Radar with markers",textRadarFilled:"Filled radar",getChartGroupData:function(t){return[{id:"menu-chart-group-bar",caption:this.textColumn,headername:t?this.textCharts:void 0},{id:"menu-chart-group-line",caption:this.textLine},{id:"menu-chart-group-pie",caption:this.textPie},{id:"menu-chart-group-hbar",caption:this.textBar},{id:"menu-chart-group-area",caption:this.textArea,inline:!0},{id:"menu-chart-group-stock",caption:this.textStock,inline:!0},{id:"menu-chart-group-scatter",caption:this.textPoint},{id:"menu-chart-group-radar",caption:this.textRadar},{id:"menu-chart-group-combo",caption:this.textCombo}]},getChartData:function(){return[{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal,iconCls:"column-normal",tip:this.textBarNormal},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked,iconCls:"column-stack",tip:this.textBarStacked},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer,iconCls:"column-pstack",tip:this.textBarStackedPer},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3d,iconCls:"column-3d-normal",tip:this.textBarNormal3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStacked3d,iconCls:"column-3d-stack",tip:this.textBarStacked3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barStackedPer3d,iconCls:"column-3d-pstack",tip:this.textBarStackedPer3d,is3d:!0},{group:"menu-chart-group-bar",type:Asc.c_oAscChartTypeSettings.barNormal3dPerspective,iconCls:"column-3d-normal-per",tip:this.textBarNormal3dPerspective,is3d:!0},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormal,iconCls:"line-normal",tip:this.textLine},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStacked,iconCls:"line-stack",tip:this.textLineStacked},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPer,iconCls:"line-pstack",tip:this.textLineStackedPer},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineNormalMarker,iconCls:"line-normal-marker",tip:this.textLineMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedMarker,iconCls:"line-stack-marker",tip:this.textLineStackedMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.lineStackedPerMarker,iconCls:"line-pstack-marker",tip:this.textLineStackedPerMarker},{group:"menu-chart-group-line",type:Asc.c_oAscChartTypeSettings.line3d,iconCls:"line-3d",tip:this.textLine3d,is3d:!0},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie,iconCls:"pie-normal",tip:this.textPie},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.doughnut,iconCls:"pie-doughnut",tip:this.textDoughnut},{group:"menu-chart-group-pie",type:Asc.c_oAscChartTypeSettings.pie3d,iconCls:"pie-3d-normal",tip:this.textPie3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal,iconCls:"bar-normal",tip:this.textHBarNormal},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked,iconCls:"bar-stack",tip:this.textHBarStacked},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer,iconCls:"bar-pstack",tip:this.textHBarStackedPer},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarNormal3d,iconCls:"bar-3d-normal",tip:this.textHBarNormal3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStacked3d,iconCls:"bar-3d-stack",tip:this.textHBarStacked3d,is3d:!0},{group:"menu-chart-group-hbar",type:Asc.c_oAscChartTypeSettings.hBarStackedPer3d,iconCls:"bar-3d-pstack",tip:this.textHBarStackedPer3d,is3d:!0},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaNormal,iconCls:"area-normal",tip:this.textArea},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStacked,iconCls:"area-stack",tip:this.textAreaStacked},{group:"menu-chart-group-area",type:Asc.c_oAscChartTypeSettings.areaStackedPer,iconCls:"area-pstack",tip:this.textAreaStackedPer},{group:"menu-chart-group-stock",type:Asc.c_oAscChartTypeSettings.stock,iconCls:"stock-normal",tip:this.textStock},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatter,iconCls:"point-normal",tip:this.textScatter},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmoothMarker,iconCls:"point-smooth-marker",tip:this.textScatterSmoothMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterSmooth,iconCls:"point-smooth",tip:this.textScatterSmooth},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLineMarker,iconCls:"point-line-marker",tip:this.textScatterLineMarker},{group:"menu-chart-group-scatter",type:Asc.c_oAscChartTypeSettings.scatterLine,iconCls:"point-line",tip:this.textScatterLine},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radar,iconCls:"radar",tip:this.textRadar},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarMarker,iconCls:"radar-with-markers",tip:this.textRadarMarker},{group:"menu-chart-group-radar",type:Asc.c_oAscChartTypeSettings.radarFilled,iconCls:"filled-radar",tip:this.textRadarFilled},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLine,iconCls:"combo-bar-line",tip:this.textComboBarLine},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboBarLineSecondary,iconCls:"combo-bar-line-sec",tip:this.textComboBarLineSecondary},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboAreaBar,iconCls:"combo-area-bar",tip:this.textComboAreaBar},{group:"menu-chart-group-combo",type:Asc.c_oAscChartTypeSettings.comboCustom,iconCls:"combo-custom",tip:this.textComboCustom}]},getSparkGroupData:function(t){return[{id:"menu-chart-group-sparkcolumn",inline:!0,headername:t?this.textSparks:void 0},{id:"menu-chart-group-sparkline",inline:!0},{id:"menu-chart-group-sparkwin",inline:!0}]},getSparkData:function(){return[{group:"menu-chart-group-sparkcolumn",type:Asc.c_oAscSparklineType.Column,allowSelected:!0,iconCls:"spark-column",tip:this.textColumnSpark},{group:"menu-chart-group-sparkline",type:Asc.c_oAscSparklineType.Line,allowSelected:!0,iconCls:"spark-line",tip:this.textLineSpark},{group:"menu-chart-group-sparkwin",type:Asc.c_oAscSparklineType.Stacked,allowSelected:!0,iconCls:"spark-win",tip:this.textWinLossSpark}]}}},Common.define.chartData||{}),Common.define.smartArt=_.extend(new function(){return{textList:"List",textProcess:"Process",textCycle:"Cycle",textHierarchy:"Hierarchy",textRelationship:"Relationship",textMatrix:"Matrix",textPyramid:"Pyramid",textPicture:"Picture",textBasicBlockList:"Basic Block List",textAlternatingHexagons:"Alternating Hexagons",textPictureCaptionList:"Picture Caption List",textLinedList:"Lined List",textVerticalBulletList:"Vertical Bullet List",textVerticalBoxList:"Vertical Box List",textHorizontalBulletList:"Horizontal Bullet List",textSquareAccentList:"Square Accent List",textPictureAccentList:"Picture Accent List",textBendingPictureAccentList:"Bending Picture Accent List",textStackedList:"Stacked List",textIncreasingCircleProcess:"Increasing Circle Process",textPieProcess:"Pie Process",textDetailedProcess:"Detailed Process",textGroupedList:"Grouped List",textHorizontalPictureList:"Horizontal Picture List",textContinuousPictureList:"Continuous Picture List",textPictureStrips:"Picture Strips",textVerticalPictureList:"Vertical Picture List",textAlternatingPictureBlocks:"Alternating Picture Blocks",textVerticalPictureAccentList:"Vertical Picture Accent List",textTitledPictureAccentList:"Titled Picture Accent List",textVerticalBlockList:"Vertical Block List",textVerticalChevronList:"Vertical Chevron List",textVerticalAccentList:"Vertical Accent List",textVerticalArrowList:"Vertical Arrow List",textTrapezoidList:"Trapezoid List",textDescendingBlockList:"Descending Block List",textTableList:"Table List",textSegmentedProcess:"Segmented Process",textVerticalCurvedList:"Vertical Curved List",textPyramidList:"Pyramid List",textTargetList:"Target List",textHierarchyList:"Hierarchy List",textVerticalCircleList:"Vertical Circle List",textTableHierarchy:"Table Hierarchy",textBasicProcess:"Basic Process",textStepUpProcess:"Step Up Process",textStepDownProcess:"Step Down Process",textAccentProcess:"Accent Process",textPictureAccentProcess:"Picture Accent Process",textAlternatingFlow:"Alternating Flow",textContinuousBlockProcess:"Continuous Block Process",textIncreasingArrowProcess:"Increasing Arrow Process",textContinuousArrowProcess:"Continuous Arrow Process",textProcessArrows:"Process Arrows",textCircleAccentTimeline:"Circle Accent Timeline",textBasicTimeline:"Basic Timeline",textBasicChevronProcess:"Basic Chevron Process",textClosedChevronProcess:"Closed Chevron Process",textChevronList:"Chevron List",textSubStepProcess:"Sub-Step Process",textPhasedProcess:"Phased Process",textRandomToResultProcess:"Random to Result Process",textVerticalProcess:"Vertical Process",textStaggeredProcess:"Staggered Process",textProcessList:"Process List",textCircleArrowProcess:"Circle Arrow Process",textBasicBendingProcess:"Basic Bending Process",textRepeatingBendingProcess:"Repeating Bending Process",textVerticalBendingProcess:"Vertical Bending Process",textAscendingPictureAccentProcess:"Ascending Picture Accent Process",textUpwardArrow:"Upward Arrow",textDescendingProcess:"Descending Process",textCircularBendingProcess:"Circular Bending Process",textEquation:"Equation",textVerticalEquation:"Vertical Equation",textFunnel:"Funnel",textGear:"Gear",textArrowRibbon:"Arrow Ribbon",textOpposingArrows:"Opposing Arrows",textConvergingArrows:"Converging Arrows",textDivergingArrows:"Diverging Arrows",textBasicCycle:"Basic Cycle",textTextCycle:"Text Cycle",textBlockCycle:"Block Cycle",textNondirectionalCycle:"Nondirectional Cycle",textContinuousCycle:"Continuous Cycle",textMultidirectionalCycle:"Multidirectional Cycle",textSegmentedCycle:"Segmented Cycle",textBasicPie:"Basic Pie",textRadialCycle:"Radial Cycle",textBasicRadial:"Basic Radial",textDivergingRadial:"Diverging Radial",textRadialVenn:"Radial Venn",textCycleMatrix:"Cycle Matrix",textRadialCluster:"Radial Cluster",textOrganizationChart:"Organization Chart",textNameAndTitleOrganizationChart:"Name and Title Organization Chart",textHalfCircleOrganizationChart:"Half Circle Organization Chart",textCirclePictureHierarchy:"Circle Picture Hierarchy",textLabeledHierarchy:"Labeled Hierarchy",textHorizontalOrganizationChart:"Horizontal Organization Chart",textHorizontalMultiLevelHierarchy:"Horizontal Multi-Level Hierarchy",textHorizontalHierarchy:"Horizontal Hierarchy",textHorizontalLabeledHierarchy:"Horizontal Labeled Hierarchy",textBalance:"Balance",textCircleRelationship:"Circle Relationship",textHexagonCluster:"Hexagon Cluster",textOpposingIdeas:"Opposing Ideas",textPlusAndMinus:"Plus and Minus",textReverseList:"Reverse List",textCounterbalanceArrows:"Counterbalance Arrows",textSegmentedPyramid:"Segmented Pyramid",textNestedTarget:"Nested Target",textConvergingRadial:"Converging Radial",textRadialList:"Radial List",textBasicTarget:"Basic Target",textBasicVenn:"Basic Venn",textLinearVenn:"Linear Venn",textStackedVenn:"Stacked Venn",textBasicMatrix:"Basic Matrix",textTitledMatrix:"Titled Matrix",textGridMatrix:"Grid Matrix",textBasicPyramid:"Basic Pyramid",textInvertedPyramid:"Inverted Pyramid",textAccentedPicture:"Accented Picture",textCircularPictureCallout:"Circular Picture Callout",textSnapshotPictureList:"Snapshot Picture List",textSpiralPicture:"Spiral Picture",textCaptionedPictures:"Captioned Pictures",textBendingPictureCaption:"Bending Picture Caption",textBendingPictureSemiTranparentText:"Bending Picture Semi-Tranparent Text",textBendingPictureBlocks:"Bending Picture Blocks",textBendingPictureCaptionList:"Bending Picture Caption List",textTitledPictureBlocks:"Titled Picture Blocks",textPictureGrid:"Picture Grid",textPictureAccentBlocks:"Picture Accent Blocks",textAlternatingPictureCircles:"Alternating Picture Circles",textTitlePictureLineup:"Title Picture Lineup",textPictureLineup:"Picture Lineup",textFramedTextPicture:"Framed Text Picture",textBubblePictureList:"Bubble Picture List",textOther:"Other",textPictureOrganizationChart:"Picture Organization Chart",textChevronAccentProcess:"Chevron Accent Process",textRadialPictureList:"Radial Picture List",textVerticalBracketList:"Vertical Bracket List",textInterconnectedBlockProcess:"Interconnected Block Process",textTabbedArc:"Tabbed Arc",textThemePictureAccent:"Theme Picture Accent",textVaryingWidthList:"Varying Width List",textConvergingText:"Converging Text",textInterconnectedRings:"Interconnected Rings",textArchitectureLayout:"Architecture Layout",textThemePictureAlternatingAccent:"Theme Picture Alternating Accent",textThemePictureGrid:"Theme Picture Grid",textCircleProcess:"Circle Process",textHexagonRadial:"Hexagon Radial",textPictureFrame:"PictureFrame",textTabList:"Tab List",getSmartArtData:function(){return[{id:"menu-smart-art-group-list",sectionId:Asc.c_oAscSmartArtSectionNames.List,caption:this.textList,icon:"btn-smart-list",items:[{type:Asc.c_oAscSmartArtTypes.BasicBlockList,tip:this.textBasicBlockList},{type:Asc.c_oAscSmartArtTypes.AlternatingHexagonList,tip:this.textAlternatingHexagons},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList},{type:Asc.c_oAscSmartArtTypes.VerticalBulletList,tip:this.textVerticalBulletList},{type:Asc.c_oAscSmartArtTypes.VerticalBoxList,tip:this.textVerticalBoxList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList},{type:Asc.c_oAscSmartArtTypes.HorizontalBulletList,tip:this.textHorizontalBulletList},{type:Asc.c_oAscSmartArtTypes.SquareAccentList,tip:this.textSquareAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.StackedList,tip:this.textStackedList},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalBlockList,tip:this.textVerticalBlockList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalAccentList,tip:this.textVerticalAccentList},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.TrapezoidList,tip:this.textTrapezoidList},{type:Asc.c_oAscSmartArtTypes.DescendingBlockList,tip:this.textDescendingBlockList},{type:Asc.c_oAscSmartArtTypes.TableList,tip:this.textTableList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalCurvedList,tip:this.textVerticalCurvedList},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.VerticalCircleList,tip:this.textVerticalCircleList},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout}]},{id:"menu-smart-art-group-process",sectionId:Asc.c_oAscSmartArtSectionNames.Process,caption:this.textProcess,icon:"btn-smart-process",items:[{type:Asc.c_oAscSmartArtTypes.BasicProcess,tip:this.textBasicProcess},{type:Asc.c_oAscSmartArtTypes.StepUpProcess,tip:this.textStepUpProcess},{type:Asc.c_oAscSmartArtTypes.StepDownProcess,tip:this.textStepDownProcess},{type:Asc.c_oAscSmartArtTypes.AccentProcess,tip:this.textAccentProcess},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingFlow,tip:this.textAlternatingFlow},{type:Asc.c_oAscSmartArtTypes.IncreasingCircleProcess,tip:this.textIncreasingCircleProcess},{type:Asc.c_oAscSmartArtTypes.PieProcess,tip:this.textPieProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousBlockProcess,tip:this.textContinuousBlockProcess},{type:Asc.c_oAscSmartArtTypes.IncreasingArrowsProcess,tip:this.textIncreasingArrowProcess},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousArrowProcess,tip:this.textContinuousArrowProcess},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.ProcessArrows,tip:this.textProcessArrows},{type:Asc.c_oAscSmartArtTypes.CircleAccentTimeline,tip:this.textCircleAccentTimeline},{type:Asc.c_oAscSmartArtTypes.BasicTimeline,tip:this.textBasicTimeline},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.BasicChevronProcess,tip:this.textBasicChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.ClosedChevronProcess,tip:this.textClosedChevronProcess},{type:Asc.c_oAscSmartArtTypes.ChevronList,tip:this.textChevronList},{type:Asc.c_oAscSmartArtTypes.VerticalChevronList,tip:this.textVerticalChevronList},{type:Asc.c_oAscSmartArtTypes.SubStepProcess,tip:this.textSubStepProcess},{type:Asc.c_oAscSmartArtTypes.PhasedProcess,tip:this.textPhasedProcess},{type:Asc.c_oAscSmartArtTypes.RandomToResultProcess,tip:this.textRandomToResultProcess},{type:Asc.c_oAscSmartArtTypes.VerticalProcess,tip:this.textVerticalProcess},{type:Asc.c_oAscSmartArtTypes.StaggeredProcess,tip:this.textStaggeredProcess},{type:Asc.c_oAscSmartArtTypes.ProcessList,tip:this.textProcessList},{type:Asc.c_oAscSmartArtTypes.SegmentedProcess,tip:this.textSegmentedProcess},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess},{type:Asc.c_oAscSmartArtTypes.BasicBendingProcess,tip:this.textBasicBendingProcess},{type:Asc.c_oAscSmartArtTypes.RepeatingBendingProcess,tip:this.textRepeatingBendingProcess},{type:Asc.c_oAscSmartArtTypes.VerticalBendingProcess,tip:this.textVerticalBendingProcess},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.DetailedProcess,tip:this.textDetailedProcess},{type:Asc.c_oAscSmartArtTypes.VerticalArrowList,tip:this.textVerticalArrowList},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.UpwardArrow,tip:this.textUpwardArrow},{type:Asc.c_oAscSmartArtTypes.DescendingProcess,tip:this.textDescendingProcess},{type:Asc.c_oAscSmartArtTypes.CircularBendingProcess,tip:this.textCircularBendingProcess},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows}]},{id:"menu-smart-art-group-cycle",sectionId:Asc.c_oAscSmartArtSectionNames.Cycle,caption:this.textCycle,icon:"btn-smart-cycle",items:[{type:Asc.c_oAscSmartArtTypes.BasicCycle,tip:this.textBasicCycle},{type:Asc.c_oAscSmartArtTypes.TextCycle,tip:this.textTextCycle},{type:Asc.c_oAscSmartArtTypes.BlockCycle,tip:this.textBlockCycle},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.ContinuousCycle,tip:this.textContinuousCycle},{type:Asc.c_oAscSmartArtTypes.MultiDirectionalCycle,tip:this.textMultidirectionalCycle},{type:Asc.c_oAscSmartArtTypes.SegmentedCycle,tip:this.textSegmentedCycle},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.CircleArrowProcess,tip:this.textCircleArrowProcess}]},{id:"menu-smart-art-group-hierarchy",sectionId:Asc.c_oAscSmartArtSectionNames.Hierarchy,caption:this.textHierarchy,icon:"btn-smart-hierarchy",items:[{type:Asc.c_oAscSmartArtTypes.OrganizationChart,tip:this.textOrganizationChart},{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.NameAndTitleOrganizationChart,tip:this.textNameAndTitleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.HalfCircleOrganizationChart,tip:this.textHalfCircleOrganizationChart},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.Hierarchy,tip:this.textHierarchy},{type:Asc.c_oAscSmartArtTypes.LabeledHierarchy,tip:this.textLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalOrganizationChart,tip:this.textHorizontalOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.HorizontalMultiLevelHierarchy,tip:this.textHorizontalMultiLevelHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalHierarchy,tip:this.textHorizontalHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalLabeledHierarchy,tip:this.textHorizontalLabeledHierarchy},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.LinedList,tip:this.textLinedList}]},{id:"menu-smart-art-group-relationship",sectionId:Asc.c_oAscSmartArtSectionNames.Relationship,caption:this.textRelationship,icon:"btn-smart-relationship",items:[{type:Asc.c_oAscSmartArtTypes.Balance,tip:this.textBalance},{type:Asc.c_oAscSmartArtTypes.CircleRelationship,tip:this.textCircleRelationship},{type:Asc.c_oAscSmartArtTypes.Funnel,tip:this.textFunnel},{type:Asc.c_oAscSmartArtTypes.Gear,tip:this.textGear},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.OpposingIdeas,tip:this.textOpposingIdeas},{type:Asc.c_oAscSmartArtTypes.PlusAndMinus,tip:this.textPlusAndMinus},{type:Asc.c_oAscSmartArtTypes.ReverseList,tip:this.textReverseList},{type:Asc.c_oAscSmartArtTypes.ArrowRibbon,tip:this.textArrowRibbon},{type:Asc.c_oAscSmartArtTypes.CounterbalanceArrows,tip:this.textCounterbalanceArrows},{type:Asc.c_oAscSmartArtTypes.ConvergingArrows,tip:this.textConvergingArrows},{type:Asc.c_oAscSmartArtTypes.DivergingArrows,tip:this.textDivergingArrows},{type:Asc.c_oAscSmartArtTypes.OpposingArrows,tip:this.textOpposingArrows},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid},{type:Asc.c_oAscSmartArtTypes.TableHierarchy,tip:this.textTableHierarchy},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.TargetList,tip:this.textTargetList},{type:Asc.c_oAscSmartArtTypes.NestedTarget,tip:this.textNestedTarget},{type:Asc.c_oAscSmartArtTypes.GroupedList,tip:this.textGroupedList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.HierarchyList,tip:this.textHierarchyList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.Equation,tip:this.textEquation},{type:Asc.c_oAscSmartArtTypes.VerticalEquation,tip:this.textVerticalEquation},{type:Asc.c_oAscSmartArtTypes.ConvergingRadial,tip:this.textConvergingRadial},{type:Asc.c_oAscSmartArtTypes.RadialCluster,tip:this.textRadialCluster},{type:Asc.c_oAscSmartArtTypes.RadialList,tip:this.textRadialList},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.RadialCycle,tip:this.textRadialCycle},{type:Asc.c_oAscSmartArtTypes.BasicRadial,tip:this.textBasicRadial},{type:Asc.c_oAscSmartArtTypes.DivergingRadial,tip:this.textDivergingRadial},{type:Asc.c_oAscSmartArtTypes.NonDirectionalCycle,tip:this.textNondirectionalCycle},{type:Asc.c_oAscSmartArtTypes.BasicTarget,tip:this.textBasicTarget},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix},{type:Asc.c_oAscSmartArtTypes.BasicPie,tip:this.textBasicPie},{type:Asc.c_oAscSmartArtTypes.BasicVenn,tip:this.textBasicVenn},{type:Asc.c_oAscSmartArtTypes.LinearVenn,tip:this.textLinearVenn},{type:Asc.c_oAscSmartArtTypes.StackedVenn,tip:this.textStackedVenn},{type:Asc.c_oAscSmartArtTypes.RadialVenn,tip:this.textRadialVenn},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings}]},{id:"menu-smart-art-group-matrix",sectionId:Asc.c_oAscSmartArtSectionNames.Matrix,caption:this.textMatrix,icon:"btn-smart-matrix",items:[{type:Asc.c_oAscSmartArtTypes.BasicMatrix,tip:this.textBasicMatrix},{type:Asc.c_oAscSmartArtTypes.TitledMatrix,tip:this.textTitledMatrix},{type:Asc.c_oAscSmartArtTypes.GridMatrix,tip:this.textGridMatrix},{type:Asc.c_oAscSmartArtTypes.CycleMatrix,tip:this.textCycleMatrix}]},{id:"menu-smart-art-group-pyramid",sectionId:Asc.c_oAscSmartArtSectionNames.Pyramid,caption:this.textPyramid,icon:"btn-smart-pyramid",items:[{type:Asc.c_oAscSmartArtTypes.BasicPyramid,tip:this.textBasicPyramid},{type:Asc.c_oAscSmartArtTypes.InvertedPyramid,tip:this.textInvertedPyramid},{type:Asc.c_oAscSmartArtTypes.PyramidList,tip:this.textPyramidList},{type:Asc.c_oAscSmartArtTypes.SegmentedPyramid,tip:this.textSegmentedPyramid}]},{id:"menu-smart-art-group-picture",sectionId:Asc.c_oAscSmartArtSectionNames.Picture,caption:this.textPicture,icon:"btn-menu-image",items:[{type:Asc.c_oAscSmartArtTypes.AccentedPicture,tip:this.textAccentedPicture},{type:Asc.c_oAscSmartArtTypes.CircularPictureCallout,tip:this.textCircularPictureCallout},{type:Asc.c_oAscSmartArtTypes.PictureCaptionList,tip:this.textPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.SnapshotPictureList,tip:this.textSnapshotPictureList},{type:Asc.c_oAscSmartArtTypes.SpiralPicture,tip:this.textSpiralPicture},{type:Asc.c_oAscSmartArtTypes.CaptionedPictures,tip:this.textCaptionedPictures},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaption,tip:this.textBendingPictureCaption},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.BendingPictureSemiTransparentText,tip:this.textBendingPictureSemiTranparentText},{type:Asc.c_oAscSmartArtTypes.BendingPictureBlocks,tip:this.textBendingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.BendingPictureCaptionList,tip:this.textBendingPictureCaptionList},{type:Asc.c_oAscSmartArtTypes.TitledPictureBlocks,tip:this.textTitledPictureBlocks},{type:Asc.c_oAscSmartArtTypes.PictureGrid,tip:this.textPictureGrid},{type:Asc.c_oAscSmartArtTypes.PictureAccentBlocks,tip:this.textPictureAccentBlocks},{type:Asc.c_oAscSmartArtTypes.PictureStrips,tip:this.textPictureStrips},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.TitledPictureAccentList,tip:this.textTitledPictureAccentList},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureBlocks,tip:this.textAlternatingPictureBlocks},{type:Asc.c_oAscSmartArtTypes.AscendingPictureAccentProcess,tip:this.textAscendingPictureAccentProcess},{type:Asc.c_oAscSmartArtTypes.AlternatingPictureCircles,tip:this.textAlternatingPictureCircles},{type:Asc.c_oAscSmartArtTypes.TitlePictureLineup,tip:this.textTitlePictureLineup},{type:Asc.c_oAscSmartArtTypes.PictureLineup,tip:this.textPictureLineup},{type:Asc.c_oAscSmartArtTypes.FramedTextPicture,tip:this.textFramedTextPicture},{type:Asc.c_oAscSmartArtTypes.HexagonCluster,tip:this.textHexagonCluster},{type:Asc.c_oAscSmartArtTypes.BubblePictureList,tip:this.textBubblePictureList},{type:Asc.c_oAscSmartArtTypes.CirclePictureHierarchy,tip:this.textCirclePictureHierarchy},{type:Asc.c_oAscSmartArtTypes.HorizontalPictureList,tip:this.textHorizontalPictureList},{type:Asc.c_oAscSmartArtTypes.ContinuousPictureList,tip:this.textContinuousPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureList,tip:this.textVerticalPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalPictureAccentList,tip:this.textVerticalPictureAccentList},{type:Asc.c_oAscSmartArtTypes.BendingPictureAccentList,tip:this.textBendingPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentList,tip:this.textPictureAccentList},{type:Asc.c_oAscSmartArtTypes.PictureAccentProcess,tip:this.textPictureAccentProcess}]},{id:"menu-smart-art-group-other",sectionId:Asc.c_oAscSmartArtSectionNames.OfficeCom,caption:this.textOther,items:[{type:Asc.c_oAscSmartArtTypes.PictureOrganizationChart,tip:this.textPictureOrganizationChart},{type:Asc.c_oAscSmartArtTypes.ChevronAccentProcess,tip:this.textChevronAccentProcess},{type:Asc.c_oAscSmartArtTypes.RadialPictureList,tip:this.textRadialPictureList},{type:Asc.c_oAscSmartArtTypes.VerticalBracketList,tip:this.textVerticalBracketList},{type:Asc.c_oAscSmartArtTypes.InterconnectedBlockProcess,tip:this.textInterconnectedBlockProcess},{type:Asc.c_oAscSmartArtTypes.TabbedArc,tip:this.textTabbedArc},{type:Asc.c_oAscSmartArtTypes.ThemePictureAccent,tip:this.textThemePictureAccent},{type:Asc.c_oAscSmartArtTypes.VaryingWidthList,tip:this.textVaryingWidthList},{type:Asc.c_oAscSmartArtTypes.ConvergingText,tip:this.textConvergingText},{type:Asc.c_oAscSmartArtTypes.InterconnectedRings,tip:this.textInterconnectedRings},{type:Asc.c_oAscSmartArtTypes.ArchitectureLayout,tip:this.textArchitectureLayout},{type:Asc.c_oAscSmartArtTypes.ThemePictureAlternatingAccent,tip:this.textThemePictureAlternatingAccent},{type:Asc.c_oAscSmartArtTypes.ThemePictureGrid,tip:this.textThemePictureGrid},{type:Asc.c_oAscSmartArtTypes.CircleProcess,tip:this.textCircleProcess},{type:Asc.c_oAscSmartArtTypes.HexagonRadial,tip:this.textHexagonRadial},{type:Asc.c_oAscSmartArtTypes.PictureFrame,tip:this.textPictureFrame},{type:Asc.c_oAscSmartArtTypes.TabList,tip:this.textTabList}]}]}}},Common.define.smartArt||{})}));var helper=function(){var t,e=function(e){if(e){if(!t&&0==(t=$("div[aria-live]")).length){t=$('<div aria-live="assertive" class="sr-only" style=""></div>').appendTo($("body"))}}else t&&(t.remove(t),t=void 0)};return{setEnabled:e,disable:function(){e(!1)},speech:function(i){t||e(!0),t.text(""),setTimeout((function(e){t.text(i)}),0)}}};if(!window.Common&&(window.Common={}),!Common.Utils&&(Common.Utils={}),Common.Utils.ScreeenReaderHelper=new helper,define("common/main/lib/util/ScreenReaderHelper",(function(){})),void 0===Common)Common={};if(void 0===Common.UI&&(Common.UI={}),Common.UI.ScreenReaderFocusManager=new function(){var t,e,i,s,n=!1,a=!1,o=!1,l=0,r=0,c=document,d=document,h=[],p=!1,u=!1,m=!1,g=!1,b=function(t,e){d=c,e?c=e:"esc"!==t?c=$("#file-menu-panel").is(":visible")?$("#file-menu-panel"):0===l?document:t&&t.closest(".hint-section")||document:0===l&&(c=document)},f=function(t){!e||!t&&Common.Utils.ModalWindow.isVisible()||(p=t,e.asc_enableKeyEvents(!t))},v=function(){if((0===h.length||$("#file-menu-panel").is(":visible")&&1===l)&&T(),a)if(l!==r&&(0===l||1===l&&$("#file-menu-panel").is(":visible"))){var e=$(d).prop("id");"toolbar"===e?A():"left-menu"===e||"right-menu"===e?w(e):"file-menu-panel"===e&&S()}else 1!==l||l===r||"left-menu"!==$(c).prop("id")&&"right-menu"!==$(c).prop("id")||k("left-menu"===$(c).prop("id"));else $("#file-menu-panel").is(":visible")?S():A();var i=h[t];i&&($(i).parent().hasClass("ribtab")&&!$(i).parent().hasClass("active")&&"file"!==$(i).data("tab")&&$(i).trigger(jQuery.Event("click",{which:1})),$(h[t]).focus()),h.length>0?(!p&&f(!0),a=!0):a=!1},C=function(){a=!1,o=!1,g=!1},x=function(e){r=l,t=0,h.length=0,void 0!==e?l=e:l++},y=function(){l=$("#file-menu-panel").is(":visible")?1:0,b(),h.length=0},A=function(){for(var e,i=0;i<h.length;i++){var s=$(h[i]).parent();if(s&&s.hasClass("ribtab")&&s.hasClass("active")){e=h[i];break}}e&&(t=i)},w=function(e){for(var i,s=0;s<h.length;s++){var n=$(h[s]);if($(n.closest(".hint-section")).prop("id")===e&&n.hasClass("btn-category")&&n.hasClass("active")){i=h[s];break}}i&&(t=s)},S=function(){for(var e,i=0;i<h.length;i++)if($(h[i]).parent().hasClass("active")){e=h[i];break}e&&(t=i)},k=function(e){var s,n=0;if(e&&(s=i.getController("LeftMenu").getView("LeftMenu").getFocusElement()),s)for(var a=0;a<h.length;a++)if($(h[a]).is($(s))){n=a;break}t=n},T=function(){h=[];var t=[];_.isArray(c)?c.forEach((function(e){t=t.concat($(e).find("[data-hint="+l+"]").toArray())})):t=$(c).find("[data-hint="+l+"]").toArray(),(h=t.filter((function(t){return $(t).is(":visible")&&!function(t){return t.hasClass("disabled")||t.parent().hasClass("disabled")||t.attr("disabled")}($(t))}))).forEach((function(t){void 0===$(t).attr("tabindex")&&$(t).attr("tabindex",0)}))},I=function(){C(),y(),p&&f(!1)};return{init:function(d){if(!(Common.Utils.isIE||Common.UI.isMac&&Common.Utils.isGecko)){e=d,i=window.DE||window.PE||window.SSE||window.PDFE||window.VE,m=!0;var _=Common.localStorage.getKeysFilter();s=_&&_.length?_.split(",")[0]:"",Common.Utils.ScreeenReaderHelper||require(["common/main/lib/util/ScreenReaderHelper"],(function(){Common.Utils.ScreeenReaderHelper.setEnabled(!0)})),$("#editor_sdk").on("click",(function(){I()})),$(document).on("mousedown",(function(){I()})),$(document).on("keyup",(function(t){t.keyCode!=Common.UI.Keys.ALT&&91!==t.keyCode||!n||window.SSE&&window.SSE.getController("Statusbar").getIsDragDrop()?u?(f(!1),u=!1):a&&t.preventDefault():(t.preventDefault(),a?I():($("input:focus").blur(),l=$("#file-menu-panel").is(":visible")?1:0,b(),v())),n=!1})),$(document).on("keydown.after.bs.dropdown",(function(e){if(a){var i=$(h[t]).prop("tagName"),s="INPUT"===i||"TEXTAREA"===i,n=e.keyCode==Common.UI.Keys.TAB||e.keyCode==Common.UI.Keys.LEFT||e.keyCode==Common.UI.Keys.RIGHT||e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN,d=e.keyCode==Common.UI.Keys.ESC||e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE;if($(h[t]).data("move-focus-only-tab")&&e.keyCode!==Common.UI.Keys.TAB&&!d)return;if(!n&&!d||e.keyCode==Common.UI.Keys.SPACE&&s)return;n&&e.preventDefault(),Common.UI.Menu.Manager.hideAll();var m,f,_,A,w=!1,S=h[t]&&$(h[t]),k=$("#file-menu-panel").is(":visible"),T=S&&S.hasClass("btn-category"),D=e.keyCode==Common.UI.Keys.LEFT,V=e.keyCode==Common.UI.Keys.RIGHT,P=e.keyCode==Common.UI.Keys.UP,F=e.keyCode==Common.UI.Keys.DOWN,R=e.keyCode==Common.UI.Keys.TAB,U=e.shiftKey&&e.keyCode==Common.UI.Keys.TAB;if(k?(m=D||P,f=2===l?V||F||R&&!U:V||F,_=U,A=R&&!U):T?(m=P||U,f=F||R,_=!1,A=V||D):g?(m=U,f=R,_=!1,A=!1):(m=D||U,f=V||R&&!U,_=P,A=F),e.keyCode==Common.UI.Keys.ESC)return void I();if(e.keyCode==Common.UI.Keys.RETURN||e.keyCode==Common.UI.Keys.SPACE){if(S&&(S.attr("for")?e.keyCode==Common.UI.Keys.RETURN?$("#"+S.attr("for")).trigger(jQuery.Event("click",{which:1})):e.preventDefault():"file"===S.data("tab")||k&&1===l||T?S.trigger(jQuery.Event("click",{which:1})):setTimeout((function(){S.trigger(jQuery.Event("click",{which:1}))}),1),"dropdown"!==S.data("toggle")&&S.blur()),!(S&&"file"===S.data("tab")||k&&1===l||T&&S.hasClass("active")))return C(),y(),Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0),S&&"dropdown"!==S.data("toggle")&&(u=!0),void(p=!1);T&&S.hasClass("active")&&(g=!0),x(),b(S)}else if(m)w=!0,r=l,--t<0&&(t=h.length-1);else if(f)w=!0,r=l,++t>h.length-1&&(t=0);else if(A){var E='[data-hint="'+(l+1)+'"]';if(0===$(c).find(E).length||S&&0===$(S.closest(".hint-section")).find(E).filter(":visible").length)return;w=!0,x(),b(S),T&&(g=!0)}else if(_){if(0===l)return;w=!0,r=l,h.length=0,l--,b(S)}!o&&w&&(o=!0,Common.UI.HintManager.isHintVisible()&&Common.UI.HintManager.clearHints(!1,!0)),v()}})),$(document).on("keydown",(function(t){n=Common.Utils.InternalSettings.get(s+"settings-show-alt-hints")&&t.keyCode==Common.UI.Keys.ALT&&!t.shiftKey&&!Common.Utils.ModalWindow.isVisible()&&m&&!(window.PE&&$("#pe-preview").is(":visible")),Common.localStorage.getBool("screen-reader-focus-mode",!1)?!$(document.body).hasClass("focus-mode")&&$(document.body).addClass("focus-mode"):$(document.body).hasClass("focus-mode")&&$(document.body).removeClass("focus-mode")}))}},isFocusMode:function(){return!!o},exitFocusMode:I}},define("common/main/lib/controller/ScreenReaderFocus",(function(){})),void 0===Common)Common={};if(define("common/main/lib/component/ColorPaletteExt",[],(function(){"use strict";Common.UI.ColorPaletteExt=Common.UI.BaseView.extend({options:{dynamiccolors:10,allowReselect:!0,cls:"",style:""},template:_.template(['<div class="palette-color-ext">',"<% var me = this; %>","<% $(colors).each(function(num, item) { %>","<% if (me.isColor(item)) { %>",'<div class="palette-color-item palette-color color-<%=item%>" style="background:#<%=item%>" hidefocus="on">','<em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em>',"</div>","<% } else if (me.isTransparent(item)) { %>",'<div class="palette-color-item color-<%=item%>" hidefocus="on">','<em><span unselectable="on">&#160;</span></em>',"</div>","<% } else if (me.isEffect(item)) { %>",'<div effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" class="palette-color-item palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" hidefocus="on">','<em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em>',"</div>","<% } %>","<% }); %>","</div>"].join("")),colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,selectedCls:"selected",initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=this.options.id,this.cls=this.options.cls,this.style=this.options.style,this.colors=this.options.colors||[],this.value=this.options.value,this.options.el&&this.render(),this.options.value&&this.select(this.options.value,!0)},render:function(t){var e=this;return e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl),this.cmpEl.on("click",e.handleClick.bind(e))),e.rendered=!0,this},isColor:function(t){return"string"==typeof t&&/[0-9A-F]{6}/.test(t)},isTransparent:function(t){return"string"==typeof t&&"transparent"==t},isEffect:function(t){return"object"==_typeof(t)&&void 0!==t.effectId},getColor:function(){return this.value},handleClick:function(t){var e,i=this,s=$(t.target).closest("div.palette-color-item");if(0!=s.length)if(s.hasClass("color-transparent"))$(i.el).find("div."+i.selectedCls).removeClass(i.selectedCls),s.addClass(i.selectedCls),i.value="transparent",i.trigger("select",i,"transparent");else if((!/^[a-fA-F0-9]{6}$/.test(i.value)||_.indexOf(i.colors,i.value)<0)&&(i.value=!1),$(i.el).find("div."+i.selectedCls).removeClass(i.selectedCls),s.addClass(i.selectedCls),e=s[0].className.match(i.colorRe)[1],s.hasClass("palette-color-effect")){var n=parseInt(s.attr("effectid"));e&&(i.value=e.toUpperCase(),i.trigger("select",i,{color:e,effectId:n}))}else/#?[a-fA-F0-9]{6}/.test(e)&&(e=/#?([a-fA-F0-9]{6})/.exec(e)[1].toUpperCase(),i.value=e,i.trigger("select",i,e))},select:function(t,e){var i,s=$(this.el);if(s.find("div."+this.selectedCls).removeClass(this.selectedCls),t)if("object"==_typeof(t))void 0!==t.effectId?(i=s.find('div[effectid="'+t.effectId+'"]').first()).length>0?(i.addClass(this.selectedCls),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1:void 0!==t.effectValue&&((i=s.find('div[effectvalue="'+t.effectValue+'"].color-'+t.color.toUpperCase()).first()).length>0?(i.addClass(this.selectedCls),this.value=i[0].className.match(this.colorRe)[1].toUpperCase()):this.value=!1);else if(/#?[a-fA-F0-9]{6}/.test(t)&&(t=/#?([a-fA-F0-9]{6})/.exec(t)[1].toUpperCase(),this.value=t),/^[a-fA-F0-9]{6}|transparent$/.test(t)&&_.indexOf(this.colors,t)>=0)_.indexOf(this.colors,this.value)<0&&(this.value=!1),(t!=this.value||this.options.allowReselect)&&("transparent"==t?s.find("div.color-transparent").addClass(this.selectedCls):s.find("div.palette-color.color-"+t).first().addClass(this.selectedCls),this.value=t,!0!==e&&this.fireEvent("select",this,t));else{var n=s.find("#"+t).first();0==n.length&&(n=s.find('div[color="'+t+'"]').first()),n.length>0&&(n.addClass(this.selectedCls),this.value=t.toUpperCase())}},updateColors:function(t){void 0!==t&&(this.colors=t,this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,colors:this.colors})),$(this.el).html(this.cmpEl),this.cmpEl.on("click",_.bind(this.handleClick,this)))},clearSelection:function(t){$(this.el).find("div."+this.selectedCls).removeClass(this.selectedCls),this.value=void 0}})})),void 0===Common)Common={};if(define("common/main/lib/component/ComboBoxDataView",[],(function(){"use strict";Common.UI.ComboBoxDataView=Common.UI.BaseView.extend({options:{id:null,cls:"",style:"",hint:!1,formTemplate:null,disabled:!1,menuCls:"",menuStyle:"",restoreHeight:0,takeFocusOnClose:!1,dataHint:"",dataHintDirection:"",dataHintOffset:""},template:_.template(['<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle <%= cls %>" data-toggle="dropdown" id="<%= id %>" style="<%= style %>">',"<%= formTemplate() %>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle"><span class="caret"></span></button>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.id=e.options.id||Common.UI.getId(),this.cls=e.options.cls,this.style=e.options.style,this.menuCls=e.options.menuCls,this.menuStyle=e.options.menuStyle,this.dataViewStyle=e.options.dataViewStyle,this.dataViewCls=e.options.dataViewCls,this.template=e.options.template||e.template,this.itemTemplate=e.options.itemTemplate,this.disabled=e.options.disabled,this.groups=e.options.groups||null,this.store=e.options.store||new Common.UI.DataViewStore,this.updateFormControl=e.options.updateFormControl,this.options.data&&e.store.add(this.options.data),this.formTemplate=this.options.formTemplate||_.template(['<div class="form-control" style="width: 100px;" data-hint="<%= dataHint %>" data-hint-direction="<%= dataHintDirection %>" data-hint-offset="<%= dataHintOffset %>">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),e.rendered=e.options.rendered||!1,e.options.el?e.render():e.options.parentEl&&e.render(e.options.parentEl)},render:function(t){var e=this;if(e.rendered?this.cmpEl=e.$el||$(this.el):(this.cmpEl=$(this.template({id:this.id,cls:this.cls,style:this.style,formTemplate:this.formTemplate,dataHintDirection:this.options.dataHintDirection,dataHintOffset:this.options.dataHintOffset,isRTL:Common.UI.isRTL()})),t?(this.setElement(t,!1),t.html(this.cmpEl)):this.$el.html(this.cmpEl)),!e.rendered){var i=this.cmpEl;this._button=i.find(".btn"),this._formControl=i.find(".form-control"),Common.NotificationCenter.on("menumanager:hideall",_.bind(e.closeMenu,e))}return e.getMenu(),e.rendered=!0,e.disabled&&e.setDisabled(e.disabled),this},getMenu:function(t){if("object"!==_typeof(this.menu)){t=t||this.options;var e=Common.UI.getId(),i=this.$el||$(this.el),s=new Common.UI.Menu({id:e,cls:t.menuCls,style:t.menuStyle,additionalAlign:t.additionalAlign,items:(t.additionalItems?t.additionalItems:[]).concat([{template:_.template('<div id="'+e+'-data-menu" style="'+t.dataViewStyle+'" class="'+t.dataViewCls+'"></div>')}])}).render(i);this.dataPicker=new Common.UI.DataView({el:i.find("#"+e+"-data-menu"),parentMenu:s,outerMenu:{menu:s,index:t.additionalItems?t.additionalItems.length:0,focusOnShow:!t.additionalItems},groups:t.groups,store:t.store,itemTemplate:t.itemTemplate,restoreHeight:t.restoreHeight}),this.dataPicker.on("item:click",_.bind(this.onClickItem,this)),s.setInnerMenu([{menu:this.dataPicker,index:t.additionalItems?t.additionalItems.length:0}]);var n=this;s.on("keydown:before",_.bind(this.onBeforeKeyDown,this)),s.on("show:after",(function(e){n.dataPicker&&_.delay((function(){!t.additionalItems&&n.dataPicker.focus()}),10)})).on("hide:after",(function(){n.options.takeFocusOnClose&&setTimeout((function(){n.focus()}),1)})),this.menu=s}return this.menu},getPicker:function(){return this.dataPicker},onClickItem:function(t,e,i){this.updateFormControl&&this.updateFormControl.call(this,i),this.disabled||this.isSuspendEvents||this.trigger("item:click",this,t,e,i)},selectRecord:function(t){this.rendered&&(this.dataPicker&&this.dataPicker.selectRecord(t,!0),this.updateFormControl&&this.updateFormControl.call(this,t))},onBeforeKeyDown:function(t,e){if((e.keyCode==Common.UI.Keys.DOWN||e.keyCode==Common.UI.Keys.SPACE)&&!this.isMenuOpen())return $("button",this.cmpEl).click(),e.preventDefault(),e.stopPropagation(),!1},closeMenu:function(){(this.$el||$(this.el)).removeClass("open")},isMenuOpen:function(){return(this.$el||$(this.el)).hasClass("open")},setTabIndex:function(t){this.rendered&&(this.tabindex=t.toString(),!this.disabled&&this._formControl.attr("tabindex",this.tabindex))},setDisabled:function(t){t=!!t,this.disabled=t,this.rendered&&(void 0!==this.tabindex&&(t&&(this.tabindex=this._formControl.attr("tabindex")),this._formControl.attr("tabindex",t?"-1":this.tabindex)),this.cmpEl.toggleClass("disabled",t),this._button.toggleClass("disabled",t),this._formControl.toggleClass("disabled",t))},isDisabled:function(){return this.disabled},focus:function(){this._formControl&&this._formControl.focus()}})})),define("common/main/lib/view/AdvancedSettingsWindow",[],(function(){"use strict";Common.Views.AdvancedSettingsWindow=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{height:"auto",header:!0,cls:"advanced-settings-dlg",toggleGroup:"advanced-settings-group",contentTemplate:"",contentStyle:"",items:[],buttons:["ok","cancel"],separator:!0},t),this.template=t.template||['<div class="box">',"<% if (items.length>0) { %>",'<div class="menu-panel">',"<% _.each(items, function(item) { %>",'<div id="slot-category-<%= item.panelId %>"></div>',"<% }); %>","</div>",'<div class="separator"></div>',"<% } %>",'<div class="content-panel" style="<%= contentStyle %>">'+e.contentTemplate+"</div>","</div>","<% if (separator) { %>",'<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.handler=e.handler,this.toggleGroup=e.toggleGroup,this.contentWidth=e.contentWidth,this.storageName=e.storageName,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this)),this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.btnsCategory=[],this.options.items.forEach((function(i,s){var n=new Common.UI.Button({parentEl:e.find("#slot-category-"+i.panelId),cls:"btn-category "+(i.categoryCls||""),caption:i.panelCaption,iconCls:i.categoryIcon||"",enableToggle:!0,toggleGroup:t.toggleGroup,allowDepress:!1,contentTarget:i.panelId});n.cmpEl.attr("content-target",i.panelId),n.on("click",_.bind(t.onCategoryClick,t,n,s)),t.btnsCategory.push(n)}));var i=e.find(".menu-panel");if(this.content_panel=e.find(".content-panel"),this.content_panel.width(this.contentWidth),e.width((i.length>0?i.outerWidth():0)+this.content_panel.outerWidth()+2),this.options.contentHeight)e.find(".body > .box").css("height",this.options.contentHeight);else if("number"==typeof this.options.height){var s=e.find(".body"),n=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(s.css("padding-top"))+parseInt(s.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));e.find(".body > .box").css("height",this.options.height-n)}this.content_panels=e.find(".settings-panel"),this.btnsCategory.length>0&&this.btnsCategory[0].toggle(!0,!0);var a=function(){e.width((i.length>0?i.outerWidth():0)+t.content_panel.outerWidth()+2)};$(window).on("resize",a),this.on("close",(function(){$(window).off("resize",a)}))},setHeight:function(t){Common.UI.Window.prototype.setHeight.call(this,t);var e=this.getChild(),i=e.find(".body"),s=parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"));e.find(".body > .box").css("height",parseInt(i.css("height"))-s)},setInnerHeight:function(t){var e=this.getChild(),i=e.find(".body"),s=parseInt(e.find(".header").css("height"))+parseInt(e.find(".footer").css("height"))+parseInt(i.css("padding-top"))+parseInt(i.css("padding-bottom"))+parseInt(e.css("border-bottom-width"))+parseInt(e.css("border-top-width"));void 0===t&&(t=parseInt(e.find(".body > .box").css("height"))),Common.UI.Window.prototype.setHeight.call(this,t+s),e.find(".body > .box").css("height",t)},fixHeight:function(){var t=this.content_panels.filter(".active").height()-this.content_panel.height();t>0&&this.setInnerHeight(parseInt(this.$window.find(".body > .box").css("height"))+t)},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)||this.close()},onCategoryClick:function(t,e){this.content_panels.filter(".active").removeClass("active"),$("#"+t.options.contentTarget).addClass("active"),this.fixHeight()},getSettings:function(){},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings())||this.close(),!1},setActiveCategory:function(t){if(!(this.btnsCategory.length<1)){t=t>=0&&t<this.btnsCategory.length?t:0;var e=this.btnsCategory[t];if(!e.isVisible()||e.isDisabled())for(var i=0;i<this.btnsCategory.length;i++){var s=this.btnsCategory[i];if(s.isVisible()&&!s.isDisabled()){e=s,t=i;break}}e.toggle(!0),this.onCategoryClick(e,t)}},getActiveCategory:function(){var t=-1;return this.btnsCategory.forEach((function(e,i){e.pressed&&(t=i)})),t},close:function(t){this.storageName&&Common.localStorage.setItem(this.storageName,this.getActiveCategory()),Common.UI.Window.prototype.close.call(this,t)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.fixHeight())},onAnimateAfter:function(){}},Common.Views.AdvancedSettingsWindow||{}))})),define("common/main/lib/view/OptionsDialog",[],(function(){"use strict";Common.Views.OptionsDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",items:[],buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<% if (typeof label !== "undefined" && label !=="") { %>','<label style="margin-bottom: 10px;"><%= label %></label>',"<% } %>","<% _.each(items, function(item, index) { %>","<% if (!item.id) item.id = Common.UI.getId(); %>",'<div id="<%= item.id %>" style="margin-bottom: 10px;"></div>',"<% }) %>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.radio=[],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=t.getChild(),i=this.options.items,s=!0;if(this.checkedIndex=-1,i){for(var n=0;n<i.length;n++){var a=i[n];this.radio.push(new Common.UI.RadioBox({el:e.find("#"+a.id),labelText:a.caption||"",name:"asc-radio-opt-dlg",value:a.value,disabled:!!a.disabled,checked:s&&!a.disabled}).on("change",(function(e,i,s){i&&(t.currentCell=e.options.value)}))),!s&&!a.checked||a.disabled||(s=!1,this.checkedIndex=n)}this.checkedIndex>=0&&(this.radio[this.checkedIndex].setValue(!0),this.currentCell=this.radio[this.checkedIndex].options.value)}e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return this.radio.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.checkedIndex>=0?this.radio[this.checkedIndex]:null},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},getSettings:function(){return this.currentCell},onPrimary:function(){return this._handleInput("ok"),!1}},Common.Views.OptionsDialog||{}))})),define("text",["module"],(function(t){"use strict";var e,i,s,n,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,p=c&&(location.port||void 0),u={},m=t.config&&t.config()||{};function g(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(l,"")).match(r);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(t){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,s,n=!1,a=t.lastIndexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!o||a>1)?(e=t.substring(0,a),i=t.substring(a+1)):e=t,-1!==(a=(s=i||e).indexOf("!"))&&(n="strip"===s.substring(a+1),s=s.substring(0,a),i?i=s:e=s),{moduleName:e,ext:i,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,s,n){var a,o,l,r=e.xdRegExp.exec(t);return!r||(a=r[2],l=(o=(o=r[3]).split(":"))[1],o=o[0],(!a||a===i)&&(!o||o.toLowerCase()===s.toLowerCase())&&(!l&&!o||function(t,e,i,s){if(e===s)return!0;if(t===i){if("http"===t)return g(e,"80")===g(s,"80");if("https"===t)return g(e,"443")===g(s,"443")}return!1}(a,l,i,n)))},finishLoad:function(t,i,s,n){s=i?e.strip(s):s,m.isBuild&&(u[t]=s),n(s)},load:function(t,i,s,n){if(n&&n.isBuild&&!n.inlineText)s();else{m.isBuild=n&&n.isBuild;var a=e.parseName(t),o=a.moduleName+(a.ext?"."+a.ext:""),l=i.toUrl(o),r=m.useXhr||e.useXhr;0!==l.indexOf("empty:")?!c||r(l,d,h,p)?e.get(l,(function(i){e.finishLoad(t,a.strip,i,s)}),(function(t){s.error&&s.error(t)})):i([o],(function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,s)}),(function(t){s.error&&s.error(t)})):s()}},write:function(t,i,s,n){if(u.hasOwnProperty(i)){var a=e.jsEscape(u[i]);s.asModule(t+"!"+i,"define(function () { return '"+a+"';});\n")}},writeFile:function(t,i,s,n,a){var o=e.parseName(i),l=o.ext?"."+o.ext:"",r=o.moduleName+l,c=s.toUrl(o.moduleName+l)+".js";e.load(r,s,(function(i){var s=function(t){return n(c,t)};s.asModule=function(t,e){return n.asModule(t,c,e)},e.write(t,r,s,a)}),a)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,s){try{var n=i.readFileSync(t,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),e(n)}catch(t){s&&s(t)}}):"xhr"===m.env||!m.env&&e.createXhr()?e.get=function(t,i,s,n){var a,o=e.createXhr();if(o.open("GET",t,!0),n)for(a in n)n.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),n[a]);m.onXhr&&m.onXhr(o,t),o.onreadystatechange=function(e){var n,a;4===o.readyState&&((n=o.status||0)>399&&n<600?((a=new Error(t+" HTTP status: "+n)).xhr=o,s&&s(a)):i(o.responseText),m.onXhrComplete&&m.onXhrComplete(o,t))},o.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,s,n=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),l="";try{for(i=new java.lang.StringBuffer,(s=o.readLine())&&s.length()&&65279===s.charAt(0)&&(s=s.substring(1)),null!==s&&i.append(s);null!==(s=o.readLine());)i.append(a),i.append(s);l=String(i.toString())}finally{o.close()}e(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,n=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,e.get=function(t,e){var i,o,l,r={};a&&(t=t.replace(/\//g,"\\")),l=new FileUtils.File(t);try{(i=s["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream)).init(l,1,0,!1),(o=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream)).init(i,"utf-8",i.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),r),o.close(),i.close(),e(r.value)}catch(t){throw new Error((l&&l.path||"")+": "+t)}}),e})),define("text!common/main/lib/template/AutoCorrectDialog.template",[],(function(){return'<div id="id-autocorrect-dialog-settings-math" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-chb-replace-type"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label style="width: 117px;"><%= scope.textReplace %>:</label>\n                <label><%= scope.textBy %>:</label>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-very-small">\n                <div id="auto-correct-replace" class="margin-right-2" style="width: 115px;display: inline-block;"></div>\n                <div id="auto-correct-by" style="width: 234px;display: inline-block;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <div id="auto-correct-math-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n        <tr>\n            <td class="padding-small">\n                <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-recognized" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textRecognizedDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="auto-correct-rec-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-recognized-list" class="" style="width:100%; height: 208px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-rec-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-rec-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-rec-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-de-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-quotes"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyphens"></div>\n            <div class="padding-small"  id="id-autocorrect-dialog-chk-hyperlink"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-double-space"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-bulleted"></div>\n            <div class="padding-small" id="id-autocorrect-dialog-chk-numbered"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-sse-autoformat" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textReplaceText %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-hyperlink"></div>\n        </div>\n        <div class="padding-small">\n            <label class="header"><%= scope.textApplyAsWork %></label>\n        </div>\n        <div class="padding-small">\n            <div class="padding-small" id="id-autocorrect-dialog-chk-new-rows"></div>\n        </div>\n    </div>\n</div>\n<div id="id-autocorrect-dialog-settings-exceptions" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-chk-sentence" class="padding-small"></div>\n                    <div id="auto-correct-exceptions-chk-cells"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textForLangFL %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="auto-correct-exceptions-lang" style="display: inline-block;vertical-align: middle;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textFLDont %></label>\n                    <div id="auto-correct-exceptions-find" style="width: 100%;margin-bottom: 4px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="auto-correct-exceptions-list" class="" style="width:100%; height: 139px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="auto-correct-btn-exceptions-reset" style="min-width: 86px;"><%= scope.textResetAll %></button>\n                    <button type="button" class="btn btn-text-default auto float-right" id="auto-correct-btn-exceptions-delete" style="min-width: 86px;"><%= scope.textDelete %></button>\n                    <button type="button" class="btn btn-text-default auto float-right margin-right-5" id="auto-correct-btn-exceptions-edit" style="min-width: 86px;"><%= scope.textAdd %></button>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),void 0===Common)Common={};if(define("common/main/lib/view/AutoCorrectDialog",["text!common/main/lib/template/AutoCorrectDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";var e=new Common.UI.DataViewStore,i=new Common.UI.DataViewStore,s=new Common.UI.DataViewStore,n=[1033,1049];Common.Views.AutoCorrectDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:375,contentHeight:355,buttons:["close"],toggleGroup:"autocorrect-dialog-group"},initialize:function(e){var i=Common.localStorage.getKeysFilter();this.appPrefix=i&&i.length?i.split(",")[0]:"";var s=[{panelId:"id-autocorrect-dialog-settings-math",panelCaption:this.textMathCorrect},{panelId:"id-autocorrect-dialog-settings-recognized",panelCaption:this.textRecognized}];"de-"==this.appPrefix||"pe-"==this.appPrefix?(s.push({panelId:"id-autocorrect-dialog-settings-de-autoformat",panelCaption:this.textAutoFormat}),s.push({panelId:"id-autocorrect-dialog-settings-exceptions",panelCaption:this.textAutoCorrect})):"sse-"==this.appPrefix&&s.push({panelId:"id-autocorrect-dialog-settings-sse-autoformat",panelCaption:this.textAutoFormat}),_.extend(this.options,{title:this.textTitle,storageName:this.appPrefix+"autocorrect-dialog-category",items:s,contentTemplate:_.template(t)({scope:this})},e||{}),this.api=this.options.api;var n=this.appPrefix+"settings-math-correct",a=Common.Utils.InternalSettings.get(n+"-add");this.arrAdd=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRem=a?JSON.parse(a):[],n=this.appPrefix+"settings-rec-functions",a=Common.Utils.InternalSettings.get(n+"-add"),this.arrAddRec=a?JSON.parse(a):[],a=Common.Utils.InternalSettings.get(n+"-rem"),this.arrRemRec=a?JSON.parse(a):[],this.arrAddExceptions={},this.arrRemExceptions={},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild(),a=this,o=t.find("#id-autocorrect-dialog-settings-"+("pe-"==this.appPrefix?"de-":this.appPrefix)+"autoformat");if(this.chReplaceType=new Common.UI.CheckBox({el:t.find("#auto-correct-chb-replace-type"),labelText:this.textReplaceType,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-math-correct-replace-type")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-math-correct-replace-type",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-math-correct-replace-type",n),a.api.asc_updateFlagAutoCorrectMathSymbols(n)})),this.onInitList(),this.mathList=new Common.UI.ListView({el:t.find("#auto-correct-math-list"),store:new Common.UI.DataViewStore(e.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="pointer-events:none;width: 100%;display:flex;">','<div class="padding-right-5" style="width:110px;overflow: hidden;text-overflow: ellipsis;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(replaced) %></div>','<div style="width:230px;overflow-x: clip;overflow-y:visible;text-overflow: ellipsis;flex-grow:1;font-family: Cambria Math;font-size:13px;white-space: nowrap;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= Common.Utils.String.htmlEncode(by) %></div>',"</div>"].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathList.on("item:select",_.bind(this.onSelectMathItem,this)),this.inputReplace=new Common.UI.InputField({el:t.find("#auto-correct-replace"),allowBlank:!0,validateOnChange:!0,maxLength:31,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathList.store.find((function(t){if(0==t.get("replaced").indexOf(e))return!0})))&&(a.mathList.scrollToRecord(i,!0),i.get("replaced")==e?a.mathList.selectRecord(i,!0):i=null));!i&&a.mathList.deselectAll(),a.updateControls(i)})),this.inputReplace.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathList.getSelectedRec()||a.mathList.store.at(0);e&&(a.mathList.selectRecord(e),a.mathList.scrollToRecord(e)),_.delay((function(){a.mathList.focus()}),10)}})),this.inputBy=new Common.UI.InputField({el:t.find("#auto-correct-by"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){a.updateControls()})),this.btnReset=new Common.UI.Button({el:t.find("#auto-correct-btn-reset")}),this.btnReset.on("click",_.bind(this.onResetToDefault,this)),this.btnEdit=new Common.UI.Button({el:t.find("#auto-correct-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEdit,this,!1)),this.btnDelete=new Common.UI.Button({el:t.find("#auto-correct-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this,!1)),this.onInitRecList(),this.mathRecList=new Common.UI.ListView({el:t.find("#auto-correct-recognized-list"),store:new Common.UI.DataViewStore(i.slice(0,9)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value %></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.mathRecList.on("item:select",_.bind(this.onSelectRecItem,this)),this.inputRecFind=new Common.UI.InputField({el:t.find("#auto-correct-rec-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",(function(t,e){var i;e.length&&((i=a.mathRecList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(a.mathRecList.scrollToRecord(i,!0),i.get("value")==e?a.mathRecList.selectRecord(i,!0):i=null));!i&&a.mathRecList.deselectAll(),a.updateRecControls(i)})),this.inputRecFind.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.mathRecList.getSelectedRec()||a.mathRecList.store.at(0);e&&(a.mathRecList.selectRecord(e),a.mathRecList.scrollToRecord(e)),_.delay((function(){a.mathRecList.focus()}),10)}})),this.btnResetRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-reset")}),this.btnResetRec.on("click",_.bind(this.onResetRecToDefault,this)),this.btnAddRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-edit")}),this.btnAddRec.on("click",_.bind(this.onAddRec,this,!1)),this.btnDeleteRec=new Common.UI.Button({el:t.find("#auto-correct-btn-rec-delete")}),this.btnDeleteRec.on("click",_.bind(this.onDeleteRec,this,!1)),"de-"==this.appPrefix||"pe-"==this.appPrefix){this.chQuotes=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-quotes"),labelText:this.textQuotes,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-smart-quotes")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-smart-quotes",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-smart-quotes",n),a.api.asc_SetAutoCorrectSmartQuotes(n)})),this.chHyphens=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-hyphens"),labelText:this.textHyphens,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyphens")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyphens",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyphens",n),a.api.asc_SetAutoCorrectHyphensWithDash(n)})),this.chBulleted=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-bulleted"),labelText:this.textBulleted,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-bulleted")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-bulleted",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-bulleted",n),a.api.asc_SetAutomaticBulletedLists(n)})),this.chNumbered=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-numbered"),labelText:this.textNumbered,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-numbered")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-numbered",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-numbered",n),a.api.asc_SetAutomaticNumberedLists(n)})),this.chDoubleSpaces=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-double-space"),labelText:this.textDoubleSpaces,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-double-space")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-double-space",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-double-space",n),a.api.asc_SetAutoCorrectDoubleSpaceWithPeriod(n)})),this.api&&(n=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultLangs()||[]),n.forEach((function(t){var e=a.appPrefix+"settings-letter-exception",i=Common.Utils.InternalSettings.get(e+"-add-"+t);a.arrAddExceptions[t]=i?JSON.parse(i):[],i=Common.Utils.InternalSettings.get(e+"-rem-"+t),a.arrRemExceptions[t]=i?JSON.parse(i):[]}));var l=Common.Utils.InternalSettings.get("settings-letter-exception-lang");if(this.exceptionsLangCmb=new Common.UI.ComboBox({el:t.find("#auto-correct-exceptions-lang"),style:"width: 145px;",menuStyle:"min-width:100%;",editable:!1,takeFocusOnClose:!0,restoreMenuHeightAndTop:!0,cls:"input-group-nr",dataHintDirection:"bottom",data:n.map((function(t){t=parseInt(t);var e=Common.util.LanguageInfo.getLocalLanguageName(t);return{displayValue:e[1],shortName:e[0],value:t}}))}).on("selected",(function(t,e){l!=e.value&&(l=e.value,Common.Utils.InternalSettings.set("settings-letter-exception-lang",l),a.onInitExceptionsList(!0),a.onChangeInputException(a.exceptionsFindInput,a.exceptionsFindInput.getValue()))})),!l){var r=this.exceptionsLangCmb.store.findWhere({value:this.api.asc_getDefaultLanguage()});if(!r){var c=Common.util.LanguageInfo.getLocalLanguageName(this.api.asc_getDefaultLanguage())[0].split(/[\-\_]/)[0];r=this.exceptionsLangCmb.store.find((function(t){return 0==t.get("shortName").indexOf(c)}))}r&&(l=r.get("value"))}this.exceptionsLangCmb.setValue(l||n[0]),this.onInitExceptionsList(!0),this.exceptionsList=new Common.UI.ListView({el:t.find("#auto-correct-exceptions-list"),store:new Common.UI.DataViewStore(s.slice(0,6)),simpleAddMode:!1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 340px;text-overflow: ellipsis;overflow: hidden;<% if (defaultDisabled) { %> font-style:italic; opacity: 0.5;<% } %>"><%= value + "."%></div>'].join("")),scrollAlwaysVisible:!0,tabindex:1}),this.exceptionsList.on("item:select",_.bind(this.onSelectExceptionItem,this)),this.exceptionsFindInput=new Common.UI.InputField({el:t.find("#auto-correct-exceptions-find"),allowBlank:!0,validateOnChange:!0,maxLength:255,validation:function(){return!0}}).on("changing",_.bind(this.onChangeInputException,this)),this.exceptionsFindInput.cmpEl.find("input").on("keydown",(function(t){if("ArrowDown"==t.key){var e=a.exceptionsList.getSelectedRec()||a.exceptionsList.store.at(0);e&&(a.exceptionsList.selectRecord(e),a.exceptionsList.scrollToRecord(e)),_.delay((function(){a.exceptionsList.focus()}),10)}})),this.btnResetExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-reset")}),this.btnResetExceptions.on("click",_.bind(this.onResetExceptionsToDefault,this)),this.btnAddExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-edit")}),this.btnAddExceptions.on("click",_.bind(this.onAddException,this,!1)),this.btnDeleteExceptions=new Common.UI.Button({el:t.find("#auto-correct-btn-exceptions-delete")}),this.btnDeleteExceptions.on("click",_.bind(this.onDeleteException,this,!1)),this.chkSentenceExceptions=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-sentence"),labelText:this.textFLSentence,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-sentence")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-sentence",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-sentence",n),a.api.asc_SetAutoCorrectFirstLetterOfSentences&&a.api.asc_SetAutoCorrectFirstLetterOfSentences(n)})),this.chkSentenceCells=new Common.UI.CheckBox({el:t.find("#auto-correct-exceptions-chk-cells"),labelText:this.textFLCells,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-letter-exception-cells")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-letter-exception-cells",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-letter-exception-cells",n),a.api.asc_SetAutoCorrectFirstLetterOfCells&&a.api.asc_SetAutoCorrectFirstLetterOfCells(n)})),this.btnsCategory[3].on("click",_.bind(this.onAutocorrectCategoryClick,this,!1))}else"sse-"==this.appPrefix&&(this.chNewRows=new Common.UI.CheckBox({el:t.find("#id-autocorrect-dialog-chk-new-rows"),labelText:this.textNewRowCol,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-new-rows")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-new-rows",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-new-rows",n),a.api.asc_setIncludeNewRowColTable(n)})));this.chHyperlink=new Common.UI.CheckBox({el:o.find("#id-autocorrect-dialog-chk-hyperlink"),labelText:this.textHyperlink,value:Common.Utils.InternalSettings.get(this.appPrefix+"settings-autoformat-hyperlink")}).on("change",(function(t,e,i,s){var n="checked"===t.getValue();Common.localStorage.setBool(a.appPrefix+"settings-autoformat-hyperlink",n),Common.Utils.InternalSettings.set(a.appPrefix+"settings-autoformat-hyperlink",n),a.api.asc_SetAutoCorrectHyperlinks(n)})),this.btnsCategory[0].on("click",_.bind(this.onMathCategoryClick,this,!1)),this.btnsCategory[1].on("click",_.bind(this.onRecCategoryClick,this,!1)),this.btnsCategory[2].on("click",_.bind(this.onAutoformatCategoryClick,this,!1)),this.afterRender()},afterRender:function(){if(this.updateControls(),this.updateRecControls(),this.updateExceptionsControls(),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){var t=this.btnsCategory.concat([this.chReplaceType,this.inputReplace,this.inputBy,this.mathList,this.btnReset,this.btnEdit,this.btnDelete,this.inputRecFind,this.mathRecList,this.btnResetRec,this.btnAddRec,this.btnDeleteRec]);return t=(t=(t=t.concat(this.chNewRows?[this.chHyperlink,this.chNewRows]:[this.chQuotes,this.chHyphens,this.chHyperlink,this.chDoubleSpaces,this.chBulleted,this.chNumbered])).concat(this.chkSentenceExceptions?[this.chkSentenceExceptions,this.chkSentenceCells,this.exceptionsLangCmb,this.exceptionsFindInput,this.exceptionsList,this.btnResetExceptions,this.btnAddExceptions,this.btnDeleteExceptions]:[])).concat(this.getFooterButtons())},getSettings:function(){},onSelectMathItem:function(t,e,i){i&&(this.inputReplace.setValue(i.get("replaced")),this.inputBy.setValue(i.get("by"))),this.updateControls(i)},updateControls:function(t){if(this.mathList){t=t||this.mathList.getSelectedRec();var e=this.inputBy.getValue(),i=this.inputReplace.getValue();if(t){var s=t.get("defaultDisabled"),n=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by");this.btnDelete.setCaption(s?this.textRestore:this.textDelete),this.btnEdit.setDisabled(s||e===t.get("by")&&!n||!e||!i),this.btnEdit.setCaption(n&&e===t.get("by")?this.textReset:this.textReplace)}else this.btnDelete.setCaption(this.textDelete),this.btnEdit.setDisabled(!e||!i),this.btnEdit.setCaption(this.textAdd);this.btnDelete.setDisabled(!t)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments);var t=this.getActiveCategory();0==t?this.onMathCategoryClick(!0):1==t?this.onRecCategoryClick(!0):2==t?this.onAutoformatCategoryClick(!0):3==t&&this.onAutocorrectCategoryClick(!0)},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments),this.mathList&&this.mathList.deselectAll(),this.mathRecList&&this.mathRecList.deselectAll()},onMathCategoryClick:function(t){var i=this;_.delay((function(){$("input",i.inputReplace.cmpEl).select().focus()}),t?50:0),i.mathList.store.length<e.length&&_.delay((function(){i.mathList.setStore(e),i.mathList.onResetItems()}),t?100:10)},onAutoformatCategoryClick:function(t){var e=this;_.delay((function(){"sse-"==e.appPrefix?e.chHyperlink.focus():e.chQuotes.focus()}),t?50:0)},onAutocorrectCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.exceptionsFindInput.cmpEl).select().focus()}),t?50:0),e.exceptionsList.store.length<s.length&&_.delay((function(){e.exceptionsList.setStore(s),e.exceptionsList.onResetItems()}),t?100:10)},onDelete:function(){var t,i=this.mathList.getSelectedRec(),s="";if(i){if(i.get("defaultValue")){s=this.appPrefix+"settings-math-correct-rem";var n=!i.get("defaultDisabled");i.set("defaultDisabled",n),n?this.arrRem.push(i.get("replaced")):this.arrRem.splice(this.arrRem.indexOf(i.get("replaced")),1),t=JSON.stringify(this.arrRem),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.btnDelete.setCaption(n?this.textRestore:this.textDelete),n?this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced")):this.api.asc_AddOrEditFromAutoCorrectMathSymbols(i.get("replaced"),i.get("defaultValue"))}else e.remove(i),this.arrAdd.splice(this.arrAdd.indexOf(i.get("replaced")),1),s=this.appPrefix+"settings-math-correct-add",t=JSON.stringify(this.arrAdd),Common.Utils.InternalSettings.set(s,t),Common.localStorage.setItem(s,t),this.mathList.scroller&&this.mathList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathSymbols(i.get("replaced"));this.updateControls()}},onEdit:function(){var t=this.mathList.getSelectedRec(),i="",s=this,n=function(t,e){var i=s.appPrefix+"settings-math-correct-add",n=JSON.stringify(s.arrAdd);Common.Utils.InternalSettings.set(i,n),Common.localStorage.setItem(i,n),s.api.asc_AddOrEditFromAutoCorrectMathSymbols(t.get("replaced"),e),s.mathList.selectRecord(t),s.mathList.scrollToRecord(t)};if(t||(t=e.findWhere({replaced:this.inputReplace.getValue()})),t){var a=_.findIndex(this.arrAdd,(function(e){return e[0]==t.get("replaced")})),o=t.get("defaultValue")&&t.get("defaultValueStr")!==t.get("by")&&this.inputBy.getValue()===t.get("by");Common.UI.warning({maxwidth:500,msg:o?this.warnRestore.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))):this.warnReplace.replace("%1",Common.Utils.String.htmlEncode(t.get("replaced"))),buttons:["yes","no"],primary:"yes",callback:_.bind((function(e,s){"yes"==e&&(o?(i=t.get("defaultValue"),t.set("by",t.get("defaultValueStr")),a>=0&&this.arrAdd.splice(a,1)):(i=this.inputBy.getValue(),t.set("by",i),a<0?this.arrAdd.push([t.get("replaced"),i]):this.arrAdd[a][1]=i),n(t,i))}),this)})}else t=e.add({replaced:this.inputReplace.getValue(),by:this.inputBy.getValue(),defaultDisabled:!1}),i=t.get("by"),this.arrAdd.push([t.get("replaced"),i]),n(t,i)},onResetToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.warnReset,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathSymbols(),this.onResetList())}),this)})},onResetList:function(){var t=this.appPrefix+"settings-math-correct",i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",i),Common.localStorage.setItem(t+"-add",i),Common.Utils.InternalSettings.set(t+"-rem",i),Common.localStorage.setItem(t+"-rem",i),this.arrAdd=[],this.arrRem=[],e.remove(e.where({defaultValue:void 0})),e.each((function(t,e){t.set("by",t.get("defaultValueStr")),t.set("defaultDisabled",!1)})),this.mathList.deselectAll(),this.mathList.scroller&&(this.mathList.scroller.update(),this.mathList.scroller.scrollTop(0)),this.updateControls()},onInitList:function(){if(!(e.length>0)){e.comparator=function(t,e){var i=t.get("replaced").toLowerCase(),s=e.get("replaced").toLowerCase();return i==s?0:i<s?-1:1};var t=this.arrAdd,i=this.arrRem,s=this.api?this.api.asc_getAutoCorrectMathSymbols():[],n=[];_.each(s,(function(t,e){var s={replaced:t[0],defaultValue:t[1],defaultDisabled:i.indexOf(t[0])>-1};"object"==_typeof(t[1])?(s.defaultValueStr="",_.each(t[1],(function(t){s.defaultValueStr+=Common.Utils.String.encodeSurrogateChar(t)})),s.by=s.defaultValueStr):s.by=s.defaultValueStr=Common.Utils.String.encodeSurrogateChar(t[1]),n.push(s)}));var a=[];_.each(t,(function(t,e){var i=_.findIndex(n,{replaced:t[0]});i<0?a.push({replaced:t[0],by:t[1],defaultDisabled:!1}):n[i].by=t[1]})),e.reset(n.concat(a)),this.updateControls()}},onInitRecList:function(){if(!(i.length>0)){i.comparator=function(t,e){var i=t.get("value").toLowerCase(),s=e.get("value").toLowerCase();return i==s?0:i<s?-1:1};var t=this.arrAddRec,e=this.arrRemRec,s=this.api?this.api.asc_getAutoCorrectMathFunctions():[],n=[];_.each(s,(function(t,i){n.push({value:t,defaultValue:!0,defaultDisabled:e.indexOf(t)>-1})}));var a=[];_.each(t,(function(t,e){_.findIndex(n,{value:t})<0&&a.push({value:t,defaultValue:!1,defaultDisabled:!1})})),i.reset(n.concat(a)),this.updateRecControls()}},onResetRecToDefault:function(){Common.UI.warning({maxwidth:500,msg:this.textWarnResetRec,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t,e){"yes"==t&&(this.api.asc_resetToDefaultAutoCorrectMathFunctions(),this.onResetRecList())}),this)})},onResetRecList:function(){var t=this.appPrefix+"settings-rec-functions",e=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add",e),Common.localStorage.setItem(t+"-add",e),Common.Utils.InternalSettings.set(t+"-rem",e),Common.localStorage.setItem(t+"-rem",e),this.arrAddRec=[],this.arrRemRec=[],i.remove(i.where({defaultValue:!1})),i.each((function(t,e){t.set("defaultDisabled",!1)})),this.mathRecList.deselectAll(),this.mathRecList.scroller&&(this.mathRecList.scroller.update(),this.mathRecList.scroller.scrollTop(0)),this.updateRecControls()},onRecCategoryClick:function(t){var e=this;_.delay((function(){$("input",e.inputRecFind.cmpEl).select().focus()}),t?50:0),e.mathRecList.store.length<i.length&&_.delay((function(){e.mathRecList.setStore(i),e.mathRecList.onResetItems()}),t?100:10)},onDeleteRec:function(){var t,e,s=this.mathRecList.getSelectedRec();if(s){if(s.get("defaultValue")){t=this.appPrefix+"settings-rec-functions-rem";var n=!s.get("defaultDisabled");s.set("defaultDisabled",n),n?this.arrRemRec.push(s.get("value")):this.arrRemRec.splice(this.arrRemRec.indexOf(s.get("value")),1),e=JSON.stringify(this.arrRemRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.btnDeleteRec.setCaption(n?this.textRestore:this.textDelete),n?this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value")):this.api.asc_AddFromAutoCorrectMathFunctions(s.get("value"))}else i.remove(s),this.arrAddRec.splice(this.arrAddRec.indexOf(s.get("value")),1),t=this.appPrefix+"settings-rec-functions-add",e=JSON.stringify(this.arrAddRec),Common.Utils.InternalSettings.set(t,e),Common.localStorage.setItem(t,e),this.mathRecList.scroller&&this.mathRecList.scroller.update({}),this.api.asc_deleteFromAutoCorrectMathFunctions(s.get("value"));this.updateRecControls()}},onAddRec:function(){var t,e,s,n=this.mathRecList.getSelectedRec(),a=this;n||(n=i.findWhere({value:this.inputRecFind.getValue()})),n?(a.mathRecList.selectRecord(n),a.mathRecList.scrollToRecord(n)):/^[A-Z]+$/i.test(this.inputRecFind.getValue())?(n=i.add({value:this.inputRecFind.getValue(),defaultValue:!1,defaultDisabled:!1}),this.arrAddRec.push(n.get("value")),t=n,e=a.appPrefix+"settings-rec-functions-add",s=JSON.stringify(a.arrAddRec),Common.Utils.InternalSettings.set(e,s),Common.localStorage.setItem(e,s),a.api.asc_AddFromAutoCorrectMathFunctions(t.get("value")),a.mathRecList.selectRecord(t),a.mathRecList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddRec})},onSelectRecItem:function(t,e,i){i&&this.inputRecFind.setValue(i.get("value")),this.updateRecControls(i)},updateRecControls:function(t){if(this.mathRecList){t=t||this.mathRecList.getSelectedRec();var e=this.inputRecFind.getValue();this.btnDeleteRec.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteRec.setDisabled(!t),this.btnAddRec.setDisabled(!!t||!e)}},onInitExceptionsList:function(t){if(!(s.length>0)||t){s.comparator=function(t,e){var i=t.get("value").toLowerCase(),s=e.get("value").toLowerCase();return i==s?0:i<s?-1:1};var e=this.exceptionsLangCmb.getValue(),i=this.arrAddExceptions[e]?this.arrAddExceptions[e]:[],n=this.arrRemExceptions[e]?this.arrRemExceptions[e]:[],a=this.api?this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().get_DefaultExceptions(e):[],o=[];_.each(a,(function(t,e){o.push({value:t,defaultValue:!0,defaultDisabled:n.indexOf(t)>-1})}));var l=[];_.each(i,(function(t,e){_.findIndex(o,{value:t})<0&&l.push({value:t,defaultValue:!1,defaultDisabled:!1})})),s.reset(o.concat(l)),this.updateExceptionsControls()}},onResetExceptionsToDefault:function(){var t=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),e=this.exceptionsLangCmb.getValue();Common.UI.warning({maxwidth:500,msg:this.textWarnResetFL,buttons:["yes","no"],primary:"yes",callback:_.bind((function(i,s){"yes"==i&&(t.put_Exceptions(t.get_DefaultExceptions(e),e),this.onResetExceptionsList())}),this)})},onResetExceptionsList:function(){var t=this.appPrefix+"settings-letter-exception",e=this.exceptionsLangCmb.getValue(),i=JSON.stringify([]);Common.Utils.InternalSettings.set(t+"-add-"+e,i),Common.localStorage.setItem(t+"-add-"+e,i),Common.Utils.InternalSettings.set(t+"-rem-"+e,i),Common.localStorage.setItem(t+"-rem-"+e,i),this.arrAddExceptions[e]=[],this.arrRemExceptions[e]=[],s.remove(s.where({defaultValue:!1})),s.each((function(t,e){t.set("defaultDisabled",!1)})),this.exceptionsList.deselectAll(),this.exceptionsList.scroller&&(this.exceptionsList.scroller.update(),this.exceptionsList.scroller.scrollTop(0)),this.updateExceptionsControls()},onDeleteException:function(){var t=this.exceptionsList.getSelectedRec(),e=this.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager(),i=this.exceptionsLangCmb.getValue();if(t){var n,a="";if(t.get("defaultValue")){var o=!t.get("defaultDisabled");a=this.appPrefix+"settings-letter-exception-rem-"+i,t.set("defaultDisabled",o),o?this.arrRemExceptions[i].push(t.get("value")):this.arrRemExceptions[i].splice(this.arrRemExceptions[i].indexOf(t.get("value")),1),n=JSON.stringify(this.arrRemExceptions[i]),Common.Utils.InternalSettings.set(a,n),Common.localStorage.setItem(a,n),this.btnDeleteExceptions.setCaption(o?this.textRestore:this.textDelete),o?e.remove_Exception(t.get("value"),i):e.add_Exception(t.get("value"),i)}else s.remove(t),this.arrAddExceptions[i].splice(this.arrAddExceptions[i].indexOf(t.get("value")),1),a=this.appPrefix+"settings-letter-exception-add-"+i,n=JSON.stringify(this.arrAddExceptions[i]),Common.Utils.InternalSettings.set(a,n),Common.localStorage.setItem(a,n),this.exceptionsList.scroller&&this.exceptionsList.scroller.update({}),e.remove_Exception(t.get("value"),i);this.updateExceptionsControls()}},onAddException:function(){var t,e,i,n=this.exceptionsList.getSelectedRec(),a=this.exceptionsLangCmb.getValue(),o=this,l=this.exceptionsFindInput.getValue().trim();n||(n=s.findWhere({value:l})),n?(o.exceptionsList.selectRecord(n),o.exceptionsList.scrollToRecord(n)):("."===l[l.length-1]&&(l=l.slice(0,-1)),/^[^\%/\\&\?\,\.\s\d\'\;:!-+!@#\$\^*)(]{1,20}$/.test(l)?(n=s.add({value:l,defaultValue:!1,defaultDisabled:!1}),this.arrAddExceptions[a].push(n.get("value")),t=n,e=o.appPrefix+"settings-letter-exception-add-"+a,i=JSON.stringify(o.arrAddExceptions[a]),Common.Utils.InternalSettings.set(e,i),Common.localStorage.setItem(e,i),o.api.asc_GetAutoCorrectSettings().get_FirstLetterExceptionManager().add_Exception(t.get("value"),a),o.exceptionsList.selectRecord(t),o.exceptionsList.scrollToRecord(t)):Common.UI.warning({maxwidth:500,msg:this.textWarnAddFL}))},onSelectExceptionItem:function(t,e,i){i&&this.exceptionsFindInput.setValue(i.get("value")),this.updateExceptionsControls(i)},onChangeInputException:function(t,e){var i;(e=e.trim()).length&&("."===e[e.length-1]&&(e=e.slice(0,-1)),(i=this.exceptionsList.store.find((function(t){if(0==t.get("value").indexOf(e))return!0})))&&(this.exceptionsList.scrollToRecord(i,!0),i.get("value")==e?this.exceptionsList.selectRecord(i,!0):i=null));!i&&this.exceptionsList.deselectAll(),this.updateExceptionsControls(i)},updateExceptionsControls:function(t){if(this.exceptionsList){t=t||this.exceptionsList.getSelectedRec();var e=this.exceptionsFindInput.getValue();this.btnDeleteExceptions.setCaption(t&&t.get("defaultDisabled")?this.textRestore:this.textDelete),this.btnDeleteExceptions.setDisabled(!t),this.btnAddExceptions.setDisabled(!!t||!e)}},textTitle:"AutoCorrect",textMathCorrect:"Math AutoCorrect",textReplace:"Replace",textBy:"By",textResetAll:"Reset to default",textAdd:"Add",textDelete:"Delete",textRestore:"Restore",textReset:"Reset",textReplaceType:"Replace text as you type",warnReset:"Any autocorrect you added will be removed and the changed ones will be restored to their original values. Do you want to continue?",warnReplace:"The autocorrect entry for %1 already exists. Do you want to replace it?",warnRestore:"The autocorrect entry for %1 will be reset to its original value. Do you want to continue?",textRecognized:"Recognized Functions",textRecognizedDesc:"The following expressions are recognized math expressions. They will not be automatically italicized.",textWarnAddRec:"Recognized functions must contain only the letters A through Z, uppercase or lowercase.",textWarnResetRec:"Any expression you added will be removed and the removed ones will be restored. Do you want to continue?",textAutoFormat:"AutoFormat As You Type",textReplaceText:"Replace As You Type",textApplyText:"Apply As You Type",textQuotes:'"Straight quotes" with "smart quotes"',textHyphens:"Hyphens (--) with dash ()",textBulleted:"Automatic bulleted lists",textNumbered:"Automatic numbered lists",textApplyAsWork:"Apply as you work",textNewRowCol:"Include new rows and columns in table",textAutoCorrect:"AutoCorrect",textFLSentence:"Capitalize first letter of sentences",textWarnResetFL:"Any exceptions you added will be removed and the removed ones will be restored. Do you want to continue?",textWarnAddFL:"Exceptions must contain only the letters, uppercase or lowercase.",textForLangFL:"Exceptions for the language:",textHyperlink:"Internet and network paths with hyperlinks",textFLCells:"Capitalize first letter of table cells",textFLDont:"Don`t capitalize after",textDoubleSpaces:"Add period with double-space"},Common.Views.AutoCorrectDialog||{}))})),define("common/main/lib/view/DocumentAccessDialog",[],(function(){"use strict";Common.Views.DocumentAccessDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:600,header:!0},t),this.template=['<div id="id-sharing-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.settingsurl=t.settingsurl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=500,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-sharing-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-sharing-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.settingsurl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(t.needUpdate&&this.trigger("accessrights",this,t.sharingSettings),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Sharing Settings",textLoading:"Loading"},Common.Views.DocumentAccessDialog||{}))})),define("common/main/lib/view/SaveAsDlg",[],(function(){"use strict";Common.Views.SaveAsDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:420,header:!0},t),this.template=['<div id="id-saveas-folder-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.saveFolderUrl=t.saveFolderUrl||"",this.saveFileUrl=t.saveFileUrl||"",this.defFileName=t.defFileName||"",this.saveFolderUrl=this.saveFolderUrl.replace("{title}",encodeURIComponent(this.defFileName)).replace("{fileuri}",encodeURIComponent(this.saveFileUrl)),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=645,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-saveas-folder-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-saveas-folder-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.saveFolderUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){t&&"onlyoffice"==t.Referer&&(_.isEmpty(t.error)?_.isEmpty(t.message)||Common.NotificationCenter.trigger("showmessage",{msg:t.message}):this.trigger("saveaserror",this,t.error),Common.NotificationCenter.trigger("window:close",this))},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Folder for save",textLoading:"Loading"},Common.Views.SaveAsDlg||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CopyWarningDialog",[],(function(){"use strict";Common.Views.CopyWarningDialog=Common.UI.Window.extend(_.extend({options:{width:500,cls:"modal-dlg copy-warning",buttons:["ok"]},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"]},t||{}),this.template=['<div class="box">','<p class="message">'+this.textMsg+"</p>",'<div class="hotkeys">',"<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+C","{0}")+"</p>",'<p class="message">'+this.textToCopy+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+X","{0}")+"</p>",'<p class="message">'+this.textToCut+"</p>","</div>","<div>",'<p class="hotkey">'+Common.Utils.String.platformKey("Ctrl+V","{0}")+"</p>",'<p class="message">'+this.textToPaste+"</p>","</div>","</div>",'<div id="copy-warning-checkbox" class="text-align-left" style="padding: 15px 0;"></div>',"</div>",'<div class="separator horizontal"></div>'].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chDontShow=new Common.UI.CheckBox({el:$("#copy-warning-checkbox"),labelText:this.textDontShow}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.chDontShow].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.chDontShow},onBtnClick:function(t){this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close()},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&(this.options.handler&&this.options.handler.call(this,"checked"==this.chDontShow.getValue()),this.close())},getSettings:function(){return"checked"==this.chDontShow.getValue()},textTitle:"Copy, Cut and Paste Actions",textMsg:"Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",textToCopy:"for Copy",textToPaste:"for Paste",textToCut:"for Cut",textDontShow:"Don't show this message again"},Common.Views.CopyWarningDialog||{}))})),define("common/main/lib/view/SelectFileDlg",[],(function(){"use strict";Common.Views.SelectFileDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{title:this.textTitle,width:1024,header:!0},t),this.template=['<div id="id-select-file-placeholder"></div>'].join(""),e.tpl=_.template(this.template)(e),this.fileChoiceUrl=t.fileChoiceUrl||"",Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find("> .body").css({height:"auto",overflow:"hidden"});var t=document.createElement("iframe");t.width="100%",t.height=585,t.align="top",t.frameBorder=0,t.scrolling="no",t.onload=_.bind(this._onLoad,this),$("#id-select-file-placeholder").append(t),this.loadMask=new Common.UI.LoadMask({owner:$("#id-select-file-placeholder")}),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),t.src=this.fileChoiceUrl;var e=this;this._eventfunc=function(t){e._onWindowMessage(t)},this._bindWindowEvents.call(this),this.on("close",(function(t){e._unbindWindowEvents()}))},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc)},_onWindowMessage:function(t){if(t&&window.JSON)try{this._onMessage.call(this,window.JSON.parse(t.data))}catch(t){}},_onMessage:function(t){if(t&&"onlyoffice"==t.Referer&&void 0!==t.file){Common.NotificationCenter.trigger("window:close",this);var e=this;setTimeout((function(){_.isEmpty(t.file)||e.trigger("selectfile",e,t.file)}),50)}},_onLoad:function(){this.loadMask&&this.loadMask.hide()},textTitle:"Select Data Source",textLoading:"Loading"},Common.Views.SelectFileDlg||{}))})),function(t,e){var i=1057,s=1124,n=1,a=2,o=3,l=4,r=5,c=6,d=7,h=8,p=9,u=10,m=11,g=12,b=13,f=14,v=15,C=16,x=17,y=18,_=19,A=20,w=21,S=22,k=23,T=24,I=25,D=26,V=27,P=28,F=29,R=30,U=31,E=32,L=33,M=34,B=35,N=36,O=37,H=38,$=39,W=40,z=41,G=42,j=43,q=44,K=45,Y=46,X=47,J=48,Q=49,Z=50,tt=51,et=52,it=53,st=54,nt=55,at=56,ot=57,lt=58,rt=59,ct=60,dt=61,ht=62,pt=63,ut=64,mt=65,gt=66,bt=67,ft=68,vt=69,Ct=70,xt=71,yt=72,_t=73,At=74,wt=75,St=76,kt=77,Tt=78,It=79,Dt=80,Vt=81,Pt=82,Ft=83,Rt=84,Ut=85,Et=86,Lt=87,Mt=88,Bt=89,Nt=90,Ot=91,Ht=92,$t=93,Wt=94,zt=95,Gt=96,jt=97,qt=98,Kt=99,Yt=100,Xt=101,Jt=102,Qt=103,Zt=104,te=105,ee=106,ie=107,se=108,ne=109,ae=110,oe=111,le=112,re=113,ce=114,de=115,he=116,pe=117,ue=118,me=119,ge=120,be=121,fe=122,ve=123,Ce=124,xe=125,ye=126,_e=127,Ae=128,we=129,Se=130,ke=131,Te=132,Ie=133,De=134,Ve=135,Pe=136,Fe=137,Re=138,Ue=139,Ee=140,Le=141,Me=142,Be=143,Ne=144,Oe=145,He=146,$e=147,We=148,ze=149,Ge=150,je=151,qe=152,Ke=153,Ye=154,Xe=155,Je=156,Qe=157,Ze=158,ti=159,ei=160,ii=161,si=162,ni=163,ai=164,oi=165,li=166,ri=167,ci=168,di=169,hi=170,pi=171,ui=172,mi=173,gi=174,bi=175,fi=176,vi=177,Ci=178,xi=179,yi=180,_i=181,Ai=182,wi=183,Si=184,ki=185,Ti=186,Ii=187,Di=188,Vi=189,Pi=190,Fi=191,Ri=192,Ui=193,Ei=194,Li=195,Mi=196,Bi=197,Ni=198,Oi=199,Hi=200,$i=201,Wi=202,zi=203,Gi=204,ji=205,qi=206,Ki=207,Yi=208,Xi=209,Ji=210,Qi=211,Zi=212,ts=213,es=214,is=215,ss=216,ns=217,as=218,os=219,ls=220,rs=221,cs=222,ds=223,hs=224,ps=225,us=226,ms=227,gs=228,bs=229,fs=230,vs=231,Cs=232,xs=233,ys=234,_s=235,As=236,ws=237,Ss=238,ks=239,Ts=240,Is=241,Ds=242,Vs=243,Ps=244,Fs=245,Rs=246,Us=247,Es=248,Ls=249,Ms=250,Bs=251,Ns=252,Os=253,Hs=254,$s=255,Ws=256,zs=257,Gs=258,js=259,qs=260,Ks=261,Ys=262,Xs=263,Js=264,Qs=265,Zs=266,tn=267,en=268,sn=269,nn=270,an=271,on=272,ln=273,rn=0,cn=1,dn=2,hn=3,pn=4,un=5,mn=6,gn=7,bn=8,fn=16,vn=17,Cn=18,xn=19,yn=20,_n=30,An=19,wn=21,Sn=29,kn={Basic_Latin:0,Latin_1_Supplement:1,Latin_Extended_A:2,Latin_Extended_B:3,IPA_Extensions:4,Spacing_Modifier_Letters:5,Combining_Diacritical_Marks:6,Greek_and_Coptic:7,Coptic:8,Cyrillic:9,Armenian:10,Hebrew:11,Vai:12,Arabic:13,NKo:14,Devanagari:15,Bengali:16,Gurmukhi:17,Gujarati:18,Oriya:19,Tamil:20,Telugu:21,Kannada:22,Malayalam:23,Thai:24,Lao:25,Georgian:26,Balinese:27,Hangul_Jamo:28,Latin_Extended_Additional:29,Greek_Extended:30,General_Punctuation:31},Tn={Superscripts_And_Subscripts:0,Currency_Symbols:1,Combining_Diacritical_Marks_For_Symbols:2,Letterlike_Symbols:3,Number_Forms:4,Arrows:5,Mathematical_Operators:6,Miscellaneous_Technical:7,Control_Pictures:8,Optical_Character_Recognition:9,Enclosed_Alphanumerics:10,Box_Drawing:11,Block_Elements:12,Geometric_Shapes:13,Miscellaneous_Symbols:14,Dingbats:15,CJK_Symbols_And_Punctuation:16,Hiragana:17,Katakana:18,Bopomofo:19,Hangul_Compatibility_Jamo:20,Phags_pa:21,Enclosed_CJK_Letters_And_Months:22,CJK_Compatibility:23,Hangul_Syllables:24,Non_Plane:25,Phoenician:26,CJK_Unified_Ideographs:27,Private_Use_Area_plane_0:28,CJK_Strokes:29,Alphabetic_Presentation_Forms:30,Arabic_Presentation_Forms_A:31},In={Combining_Half_Marks:0,Vertical_Forms:1,Small_Form_Variants:2,Arabic_Presentation_Forms_B:3,Halfwidth_And_Fullwidth_Forms:4,Specials:5,Tibetan:6,Syriac:7,Thaana:8,Sinhala:9,Myanmar:10,Ethiopic:11,Cherokee:12,Unified_Canadian_Aboriginal_Syllabics:13,Ogham:14,Runic:15,Khmer:16,Mongolian:17,Braille_Patterns:18,Yi_Syllables:19,Tagalog:20,Old_Italic:21,Gothic:22,Deseret:23,Byzantine_Musical_Symbols:24,Mathematical_Alphanumeric_Symbols:25,Private_Use_plane_15:26,Variation_Selectors:27,Tags:28,Limbu:29,Tai_Le:30,New_Tai_Lue:31},Dn=1,Vn=2,Pn=3,Fn=4,Rn=5,Un=6,En=7,Ln=8,Mn=9,Bn=10,Nn=11,On=12,Hn=14,$n=16,Wn=17,zn=18,Gn=19,jn=20,qn=21,Kn=22,Yn=23,Xn=24,Jn=25,Qn=26;function Zn(t,e,i,s,n){this.Start=t,this.End=e,this.Name=i,this.Lid=s,this.Param=n}var ta=[new Zn(32,126,n,1033,[1<<kn.Basic_Latin,0,0,0,1<<rn,0]),new Zn(160,255,a,0,[1<<kn.Basic_Latin|1<<kn.Latin_1_Supplement,0,0,0,1<<rn,0]),new Zn(256,383,o,0,[1<<kn.Basic_Latin|1<<kn.Latin_Extended_A,0,0,0,1<<rn|1<<cn|1<<pn|1<<gn,0]),new Zn(384,591,l,0,[1<<kn.Basic_Latin|1<<kn.Latin_Extended_B,0,0,0,1<<rn|1<<cn|1<<pn|1<<gn,0]),new Zn(592,687,r,0,[1<<kn.IPA_Extensions,0,0,0,0,0]),new Zn(688,767,c,0,[1<<kn.Spacing_Modifier_Letters,0,0,0,0,0]),new Zn(768,879,d,0,[1<<kn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(880,1023,h,1032,[1<<kn.Greek_and_Coptic,0,0,0,1<<hn,0]),new Zn(1024,1279,p,1049,[1<<kn.Cyrillic,0,0,0,1<<dn,0]),new Zn(1280,1327,u,0,[1<<kn.Cyrillic,0,0,0,1<<dn,0]),new Zn(1328,1423,m,1067,[1<<kn.Armenian,0,0,0,0,0]),new Zn(1424,1535,g,1037,[1<<kn.Hebrew,0,0,0,1<<un,1<<wn]),new Zn(1536,1791,b,1,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(1792,1871,f,1114,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(1872,1919,v,1,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(1920,1983,C,1125,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(1984,2047,x,0,[1<<kn.NKo,0,0,0,0,0]),new Zn(2048,2111,y,0,[1<<kn.Hebrew,0,0,0,1<<un,0]),new Zn(2112,2143,_,0,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(2208,2303,A,1,[1<<kn.Arabic,0,0,0,1<<mn,1<<An|1<<Sn]),new Zn(2304,2431,w,1081,[1<<kn.Devanagari,0,0,0,0,0]),new Zn(2432,2559,S,1093,[1<<kn.Bengali,0,0,0,0,0]),new Zn(2560,2687,k,1094,[1<<kn.Gurmukhi,0,0,0,0,0]),new Zn(2688,2815,T,1095,[1<<kn.Gujarati,0,0,0,0,0]),new Zn(2816,2943,I,1096,[1<<kn.Oriya,0,0,0,0,0]),new Zn(2944,3071,D,1097,[1<<kn.Tamil,0,0,0,0,0]),new Zn(3072,3199,V,1098,[1<<kn.Telugu,0,0,0,0,0]),new Zn(3200,3327,P,1099,[1<<kn.Kannada,0,0,0,0,0]),new Zn(3328,3455,F,1100,[1<<kn.Malayalam,0,0,0,0,0]),new Zn(3456,3583,R,1115,[0,0,1<<In.Sinhala,0,0,0]),new Zn(3584,3711,U,1054,[1<<kn.Thai,0,0,0,1<<fn,0]),new Zn(3712,3839,E,1108,[1<<kn.Lao,0,0,0,0,0]),new Zn(3840,4095,L,2129,[0,0,1<<In.Tibetan,0,0,0]),new Zn(4096,4255,M,1109,[0,0,1<<In.Myanmar,0,0,0]),new Zn(4256,4351,B,1079,[1<<kn.Georgian,0,0,0,0,0]),new Zn(4352,4607,N,1042,[1<<kn.Hangul_Jamo,0,0,0,1<<xn,0]),new Zn(4608,4991,O,1138,[0,0,1<<In.Ethiopic,0,0,0]),new Zn(4992,5023,H,0,[0,0,1<<In.Ethiopic,0,0,0]),new Zn(5024,5119,$,1116,[0,0,1<<In.Cherokee,0,0,0]),new Zn(5120,5759,W,1117,[0,0,1<<In.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zn(5760,5791,z,0,[0,0,1<<In.Ogham,0,0,0]),new Zn(5792,5887,G,0,[0,0,1<<In.Runic,0,0,0]),new Zn(5888,5919,j,s,[0,0,1<<In.Tagalog,0,0,0]),new Zn(5920,5951,q,s,[0,0,1<<In.Tagalog,0,0,0]),new Zn(5952,5983,K,s,[0,0,1<<In.Tagalog,0,0,0]),new Zn(5984,6015,Y,s,[0,0,1<<In.Tagalog,0,0,0]),new Zn(6016,6143,X,1107,[0,0,1<<In.Khmer,0,0,0]),new Zn(6144,6319,J,1104,[0,0,1<<In.Mongolian,0,0,0]),new Zn(6320,6399,Q,1117,[0,0,1<<In.Unified_Canadian_Aboriginal_Syllabics,0,0,0]),new Zn(6400,6479,Z,0,[0,0,1<<In.Limbu,0,0,0]),new Zn(6480,6527,tt,0,[0,0,1<<In.Tai_Le,0,0,0]),new Zn(6528,6623,et,0,[0,0,1<<In.New_Tai_Lue,0,0,0]),new Zn(6624,6655,it,1107,[0,0,1<<In.Khmer,0,0,0]),new Zn(6656,6687,st,0,[0,0,1<<In.Buginese,0,0,0]),new Zn(6688,6831,nt,1054,[0,0,1<<In.Tai_Le,0,0,0]),new Zn(6832,6911,at,0,[1<<kn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(6912,7039,ot,i,[1<<kn.Balinese,0,0,0,0,0]),new Zn(7040,7103,lt,i,[0,0,0,1<<$n,0,0]),new Zn(7104,7167,rt,i,[]),new Zn(7168,7247,ct,0,[0,0,0,1<<Wn,0,0]),new Zn(7248,7295,dt,0,[0,0,0,1<<zn,0,0]),new Zn(7296,7311,ht,0,[1<<kn.Cyrillic,0,0,0,0,0]),new Zn(7360,7375,pt,0,[0,0,0,1<<$n,0,0]),new Zn(7376,7423,ut,0,[]),new Zn(7424,7551,mt,0,[1<<kn.IPA_Extensions,0,0,0,0,0]),new Zn(7552,7615,gt,0,[1<<kn.IPA_Extensions,0,0,0,0,0]),new Zn(7616,7679,bt,0,[1<<kn.Combining_Diacritical_Marks,0,0,0,0,0]),new Zn(7680,7935,ft,0,[1<<kn.Latin_Extended_Additional,0,0,0,1<<bn,0]),new Zn(7936,8191,vt,0,[1<<kn.Greek_Extended,0,0,0,0,0]),new Zn(8192,8303,Ct,0,[1<<kn.Punctuation,0,0,0,0,0]),new Zn(8304,8351,xt,0,[0,1<<Tn.Superscripts_And_Subscripts,0,0,0,0]),new Zn(8352,8399,yt,0,[0,1<<Tn.Currency_Symbols,0,0,0,0]),new Zn(8400,8447,_t,0,[0,1<<Tn.Combining_Diacritical_Marks_For_Symbols,0,0,0,0]),new Zn(8448,8527,At,0,[0,1<<Tn.Letterlike_Symbols,0,0,0,0]),new Zn(8528,8591,wt,0,[0,1<<Tn.Number_Forms,0,0,0,0]),new Zn(8592,8703,St,0,[0,1<<Tn.Arrows,0,0,0,0]),new Zn(8704,8959,kt,0,[0,1<<Tn.Mathematical_Operators,0,0,0,0]),new Zn(8960,9215,Tt,0,[0,1<<Tn.Miscellaneous_Technical,0,0,0,0]),new Zn(9216,9279,It,0,[0,1<<Tn.Control_Pictures,0,0,0,0]),new Zn(9280,9311,Dt,0,[0,1<<Tn.Optical_Character_Recognition,0,0,0,0]),new Zn(9312,9471,Vt,0,[0,1<<Tn.Enclosed_Alphanumerics,0,0,0,0]),new Zn(9472,9599,Pt,0,[0,1<<Tn.Box_Drawing,0,0,0,0]),new Zn(9600,9631,Ft,0,[0,1<<Tn.Block_Elements,0,0,0,0]),new Zn(9632,9727,Rt,0,[0,1<<Tn.Geometric_Shapes,0,0,0,0]),new Zn(9728,9983,Ut,0,[0,1<<Tn.Miscellaneous_Symbols,0,0,0,0]),new Zn(9984,10175,Et,0,[0,1<<Tn.Dingbats,0,0,0,0]),new Zn(10176,10223,Lt,0,[0,1<<Tn.Mathematical_Operators,0,0,0,0]),new Zn(10224,10239,Mt,0,[0,1<<Tn.Arrows,0,0,0,0]),new Zn(10240,10495,Bt,0,[0,0,1<<In.Braille_Patterns,0,0,0]),new Zn(10496,10623,Nt,0,[0,1<<Tn.Arrows,0,0,0,0]),new Zn(10624,10751,Ot,0,[0,1<<Tn.Mathematical_Operators,0,0,0,0]),new Zn(10752,11007,Ht,0,[0,1<<Tn.Mathematical_Operators,0,0,0,0]),new Zn(11008,11263,$t,0,[0,1<<Tn.Arrows,0,0,0,0]),new Zn(11264,11359,Wt,0,[0,0,0,1<<Tn.Glagolitic,0,0]),new Zn(11360,11391,zt,0,[1<<kn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(11392,11519,Gt,0,[1<<kn.Coptic,0,0,0,0,0]),new Zn(11520,11567,jt,0,[1<<kn.Georgian,0,0,0,0,0]),new Zn(11568,11647,qt,0,[0,0,0,1<<Vn,0,0]),new Zn(11648,11743,Kt,0,[0,0,1<<In.Ethiopic,0,0,0]),new Zn(11744,11775,Yt,0,[1<<kn.Cyrillic,0,0,0,1<<dn,0]),new Zn(11776,11903,Xt,0,[1<<kn.General_Punctuation,0,0,0,0,0]),new Zn(11904,12031,Jt,0,[0,1<<Tn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12032,12255,Qt,0,[0,1<<Tn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12272,12287,Zt,0,[0,1<<Tn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12288,12351,te,0,[0,1<<Tn.CJK_Symbols_And_Punctuation,0,0,1<<vn|1<<_n,0]),new Zn(12352,12447,ee,1041,[0,1<<Tn.Hiragana,0,0,0,0]),new Zn(12448,12543,ie,1041,[0,1<<Tn.Katakana,0,0,0,0]),new Zn(12544,12591,se,0,[0,1<<Tn.Bopomofo,0,0,0,0]),new Zn(12592,12687,ne,0,[0,1<<Tn.Hangul_Compatibility_Jamo,0,0,1<<xn,0]),new Zn(12688,12703,ae,2052,[0,1<<Tn.CJK_Unified_Ideographs,0,0,0,0]),new Zn(12704,12735,oe,0,[0,1<<Tn.Bopomofo,0,0,0,0]),new Zn(12736,12783,le,0,[0,1<<Tn.CJK_Strokes,0,0,0,0]),new Zn(12784,12799,re,0,[0,1<<Tn.Katakana,0,0,0,0]),new Zn(12800,13055,ce,0,[0,1<<Tn.Enclosed_CJK_Letters_And_Months,0,0,0,0]),new Zn(13056,13311,de,0,[0,1<<Tn.CJK_Compatibility,0,0,0,0]),new Zn(13312,19903,he,0,[0,1<<Tn.CJK_Unified_Ideographs,0,0,1<<Cn|1<<yn,0]),new Zn(19904,19967,pe,0,[0,0,0,1<<Pn,1<<Cn|1<<yn,0]),new Zn(19968,40959,ue,0,[0,1<<Tn.CJK_Unified_Ideographs,0,0,1<<Cn|1<<yn|1<<vn|1<<_n,0]),new Zn(40960,42127,me,0,[0,0,1<<In.Yi_Syllables,0,0,0]),new Zn(42128,42191,ge,0,[0,0,1<<In.Yi_Radicals,0,0,0]),new Zn(42192,42239,be,0,[]),new Zn(42240,42559,fe,0,[1<<kn.Vai,0,0,0,0,0]),new Zn(42560,42655,ve,0,[1<<kn.Cyrillic,0,0,0,1<<dn,0]),new Zn(42656,42751,Ce,0,[]),new Zn(42752,42783,xe,0,[1<<kn.Spacing_Modifier_Letters,0,0,0,0,0]),new Zn(42784,43007,ye,0,[1<<kn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(43008,43055,_e,0,[0,0,0,1<<Fn,0,0]),new Zn(43056,43071,Ae,0,[]),new Zn(43072,43135,we,0,[0,1<<Tn.Phags_pa,0,0,0,0]),new Zn(43136,43231,Se,0,[0,0,0,1<<Gn,0,0]),new Zn(43232,43263,ke,0,[1<<kn.Devanagari,0,0,0,0,0]),new Zn(43264,43311,Te,0,[0,0,0,1<<jn,0,0]),new Zn(43312,43359,Ie,0,[0,0,0,1<<qn,0,0]),new Zn(43360,43391,De,0,[1<<kn.Hangul_Jamo,0,0,0,0,0]),new Zn(43392,43487,Ve,i,[]),new Zn(43488,43519,Pe,0,[0,0,1<<In.Myanmar,0,0,0]),new Zn(43520,43615,Fe,0,[0,0,0,1<<Kn,0,0]),new Zn(43616,43647,Re,0,[0,0,1<<In.Myanmar,0,0,0]),new Zn(43648,43743,Ue,0,[]),new Zn(43744,43775,Ee,0,[]),new Zn(43776,43823,Le,0,[]),new Zn(43824,43887,Me,0,[1<<kn.Latin_Extended_Additional,0,0,0,0,0]),new Zn(43888,43967,Be,0,[]),new Zn(43968,44031,Ne,0,[]),new Zn(44032,55215,Oe,0,[0,1<<Tn.Hangul_Syllables,0,0,1<<xn,0]),new Zn(55216,55295,He,0,[1<<kn.Hangul_Jamo,0,0,0,0,0]),new Zn(55296,56191,$e,0,[]),new Zn(56192,56319,We,0,[]),new Zn(56320,57343,ze,0,[]),new Zn(57344,63743,Ge,0,[0,1<<Tn.Private_Use_Area_plane_0,0,0,0,0]),new Zn(63744,64255,je,0,[0,1<<Tn.CJK_Compatibility_Ideographs,0,0,1<<Cn|1<<yn,0]),new Zn(64256,64335,qe,0,[0,1<<Tn.Alphabetic_Presentation_Forms,0,0,0,0]),new Zn(64336,65023,Ke,0,[0,1<<Tn.Arabic_Presentation_Forms_A,0,0,1<<mn,1<<An|1<<Sn]),new Zn(65024,65039,Ye,0,[0,0,1<<In.Variation_Selectors,0,0,0]),new Zn(65040,65055,Xe,0,[0,0,1<<In.Vertical_Forms,0,0,0]),new Zn(65056,65071,Je,0,[0,0,1<<In.Combining_Half_Marks,0,0,0]),new Zn(65072,65103,Qe,0,[0,0,1<<In.Vertical_Forms,0,0,0]),new Zn(65104,65135,Ze,0,[0,0,1<<In.Small_Form_Variants,0,0,0]),new Zn(65136,65279,ti,0,[0,0,1<<In.Arabic_Presentation_Forms_B,0,1<<mn,1<<An|1<<Sn]),new Zn(65280,65519,ei,0,[0,0,1<<In.Halfwidth_And_Fullwidth_Forms,0,1<<xn|1<<Cn|1<<yn|1<<vn|1<<_n,0]),new Zn(65520,65535,ii,0,[0,0,1<<In.Specials,0,0,0]),new Zn(65536,65663,si,0,[0,0,0,1<<Rn,0,0]),new Zn(65664,65791,ni,0,[0,0,0,1<<Rn,0,0]),new Zn(65792,65855,ai,0,[0,0,0,1<<Rn,0,0]),new Zn(65856,65935,oi,0,[0,0,0,1<<Un,0,0]),new Zn(65936,65999,li,0,[0,0,0,1<<Yn,0,0]),new Zn(66e3,66047,ri,0,[0,0,0,1<<Xn,0,0]),new Zn(66176,66207,ci,0,[0,0,0,1<<Jn,0,0]),new Zn(66208,66271,di,0,[0,0,0,1<<Jn,0,0]),new Zn(66272,66303,hi,0,[1<<kn.Coptic,0,0,0,0,0]),new Zn(66304,66351,pi,0,[0,0,1<<In.Old_Italic,0,0,0]),new Zn(66352,66383,ui,0,[0,0,1<<In.Gothic,0,0,0]),new Zn(66384,66431,mi,0,[]),new Zn(66432,66463,gi,0,[0,0,0,1<<En,0,0]),new Zn(66464,66527,bi,0,[0,0,0,1<<Ln,0,0]),new Zn(66560,66639,fi,0,[0,0,1<<In.Deseret,0,0,0]),new Zn(66640,66687,vi,0,[0,0,0,1<<Mn,0,0]),new Zn(66688,66735,Ci,0,[0,0,0,1<<Bn,0,0]),new Zn(66736,66815,xi,0,[]),new Zn(66816,66863,yi,0,[]),new Zn(66864,66927,_i,0,[]),new Zn(67072,67455,Ai,0,[]),new Zn(67584,67647,wi,0,[0,0,0,1<<Nn,0,0]),new Zn(67648,67679,Si,0,[]),new Zn(67680,67711,ki,0,[]),new Zn(67712,67759,Ti,0,[]),new Zn(67808,67839,Ii,0,[]),new Zn(67840,67871,Di,0,[0,1<<Tn.Phoenician,0,0,0,0]),new Zn(67872,67903,Vi,0,[0,0,0,1<<Jn,0,0]),new Zn(67968,67999,Pi,0,[]),new Zn(68e3,68095,Fi,0,[]),new Zn(68096,68191,Ri,0,[0,0,0,1<<On,0,0]),new Zn(68192,68223,Ui,0,[]),new Zn(68224,68255,Ei,0,[]),new Zn(68288,68351,Li,0,[]),new Zn(68352,68415,Mi,0,[]),new Zn(68416,68447,Bi,0,[]),new Zn(68448,68479,Ni,0,[]),new Zn(68480,68527,Oi,0,[]),new Zn(68608,68687,Hi,0,[]),new Zn(68736,68863,$i,0,[]),new Zn(69216,69247,Wi,0,[]),new Zn(69632,69759,zi,0,[]),new Zn(69760,69839,Gi,0,[]),new Zn(69840,69887,ji,0,[]),new Zn(69888,69967,qi,0,[]),new Zn(69968,70015,Ki,0,[]),new Zn(70016,70111,Yi,0,[]),new Zn(70112,70143,Xi,0,[0,0,1<<In.Sinhala,0,0,0]),new Zn(70144,70223,Ji,0,[]),new Zn(70272,70319,Qi,0,[]),new Zn(70320,70399,Zi,0,[]),new Zn(70400,70527,ts,0,[]),new Zn(70656,70783,es,0,[]),new Zn(70784,70879,is,0,[]),new Zn(71040,71167,ss,0,[]),new Zn(71168,71263,ns,0,[]),new Zn(71264,71295,as,0,[0,0,1<<In.Mongolian,0,0,0]),new Zn(71296,71375,os,0,[]),new Zn(71424,71487,ls,0,[]),new Zn(71840,71935,rs,0,[]),new Zn(72384,72447,cs,0,[]),new Zn(72704,72815,ds,0,[]),new Zn(72816,72895,hs,0,[]),new Zn(73728,74751,ps,0,[0,0,0,1<<Hn,0,0]),new Zn(74752,74879,us,0,[0,0,0,1<<Hn,0,0]),new Zn(74880,75087,ms,0,[]),new Zn(77824,78895,gs,0,[]),new Zn(82944,83583,bs,0,[]),new Zn(92160,92735,fs,0,[]),new Zn(92736,92783,vs,0,[]),new Zn(92880,92927,Cs,0,[]),new Zn(92928,93071,xs,0,[]),new Zn(93952,94111,ys,2052,[]),new Zn(94176,94207,_s,0,[]),new Zn(94208,100351,As,0,[]),new Zn(100352,101119,ws,0,[]),new Zn(110592,110847,Ss,0,[]),new Zn(113664,113823,ks,0,[]),new Zn(113824,113839,Ts,0,[]),new Zn(118784,119039,Is,0,[0,0,1<<In.Byzantine_Musical_Symbols,0,0,0]),new Zn(119040,119295,Ds,0,[0,0,1<<In.Byzantine_Musical_Symbols,0,0,0]),new Zn(119296,119375,Vs,0,[0,0,1<<In.Byzantine_Musical_Symbols,0,0,0]),new Zn(119552,119647,Ps,0,[]),new Zn(119648,119679,Fs,0,[]),new Zn(119808,120831,Rs,0,[0,0,1<<In.Mathematical_Alphanumeric_Symbols,0,0,0]),new Zn(120832,121519,Us,0,[]),new Zn(122880,122927,Es,0,[0,0,0,1<<Dn,0,0]),new Zn(124928,125151,Ls,0,[]),new Zn(125184,125279,Ms,0,[]),new Zn(126464,126719,Bs,0,[]),new Zn(126976,127023,Ns,0,[0,0,0,1<<Qn,0,0]),new Zn(127024,127135,Os,0,[0,0,0,1<<Qn,0,0]),new Zn(127136,127231,Hs,0,[]),new Zn(127232,127487,$s,0,[]),new Zn(127488,127743,Ws,0,[]),new Zn(127744,128511,zs,0,[]),new Zn(128512,128591,Gs,0,[]),new Zn(128592,128639,js,0,[]),new Zn(128640,128767,qs,0,[]),new Zn(128768,128895,Ks,0,[]),new Zn(128896,129023,Ys,0,[0,1<<Tn.Geometric_Shapes,0,0,0,0]),new Zn(129024,129279,Xs,0,[0,1<<Tn.Arrows,0,0,0,0]),new Zn(129280,129535,Js,0,[]),new Zn(131072,173791,Qs,0,[0,0,1<<In.CJK_Unified_Ideographs,0,1<<Cn|1<<yn,0]),new Zn(173824,177983,Zs,0,[0,0,1<<In.CJK_Unified_Ideographs,0,1<<Cn|1<<yn,0]),new Zn(177984,178207,tn,0,[0,0,1<<In.CJK_Unified_Ideographs,0,1<<Cn|1<<yn,0]),new Zn(178208,183983,en,0,[0,0,1<<In.CJK_Unified_Ideographs,0,1<<Cn|1<<yn,0]),new Zn(194560,195103,sn,0,[0,0,1<<In.CJK_Strokes,0,1<<Cn|1<<yn,0]),new Zn(917504,917631,nn,0,[0,0,1<<In.Tags,0,0,0]),new Zn(917760,917999,an,0,[0,0,1<<In.Variation_Selectors,0,0,0]),new Zn(983040,1048575,on,0,[0,0,1<<In.Private_Use_plane_15,0,0,0]),new Zn(1048576,1114111,ln,0,[0,0,1<<In.Private_Use_plane_15,0,0,0])];t.getSupportedFonts=function(e){var i=function(t,e){var i=0,s=e.length-1,n=0,a=null;if(i>=s)return null;for(;i<s;)if((a=e[n=i+s>>1]).Start>t)s=n-1;else{if(!(a.End<t))return e[n];i=n+1}return i>s||(a=e[i]).Start>t||a.End<t?null:e[i]}(e,ta);return t.getSupportedFontsByRange(i)},t.getSupportedFontsByRange=function(t){if(null==t)return[];for(var e=AscFonts.g_fontApplication.g_fontSelections.List,i=e.length,s=[],n=0;n<i;n++){var a=e[n],o=t.Param;if(o[0]==(a.m_ulUnicodeRange1&o[0])&&(o[1]==(a.m_ulUnicodeRange2&o[1])&&o[2]==(a.m_ulUnicodeRange3&o[2])&&o[3]==(a.m_ulUnicodeRange4&o[3]))){if(t.Name==ue){if(0==(a.m_ulCodePageRange1&o[4]))continue}else if(o[4]!=(a.m_ulCodePageRange1&o[4]))continue;o[5]==(a.m_ulCodePageRange2&o[5])&&s.push(a.m_wsFontName)}}return s},t.getSupportedRangesByFont=function(t){for(var e=[],i=0;i<ta.length;++i){var s=ta[i],o=s.Param;o[0]==(t.m_ulUnicodeRange1&o[0])&&(o[1]==(t.m_ulUnicodeRange2&o[1])&&o[2]==(t.m_ulUnicodeRange3&o[2])&&o[3]==(t.m_ulUnicodeRange4&o[3])&&o[4]==(t.m_ulCodePageRange1&o[4])&&o[5]==(t.m_ulCodePageRange2&o[5])&&e.push(s))}return 0===e.length&&(e.push(new Zn(32,126,n,1033,[1<<kn.Basic_Latin,0,0,0,1<<rn,0])),e.push(new Zn(160,255,a,0,[1<<kn.Basic_Latin|1<<kn.Latin_1_Supplement,0,0,0,1<<rn,0]))),e}}(window),define("common/main/lib/util/character",(function(){})),void 0===Common)Common={};if(define("common/main/lib/view/SymbolTableDialog",["common/main/lib/util/character"],(function(){"use strict";var t={1:"Basic Latin",2:"Latin 1 Supplement",3:"Latin Extended A",4:"Latin Extended B",5:"IPA Extensions",6:"Spacing Modifier Letters",7:"Combining Diacritical Marks",8:"Greek and Coptic",9:"Cyrillic",10:"Cyrillic Supplement",11:"Armenian",12:"Hebrew",13:"Arabic",14:"Syriac",15:"Arabic Supplement",16:"Thaana",17:"NKo",18:"Samaritan",19:"Mandaic",20:"Arabic Extended A",21:"Devanagari",22:"Bengali",23:"Gurmukhi",24:"Gujarati",25:"Oriya",26:"Tamil",27:"Telugu",28:"Kannada",29:"Malayalam",30:"Sinhala",31:"Thai",32:"Lao",33:"Tibetan",34:"Myanmar",35:"Georgian",36:"Hangul Jamo",37:"Ethiopic",38:"Ethiopic Supplement",39:"Cherokee",40:"Unified Canadian Aboriginal Syllabics",41:"Ogham",42:"Runic",43:"Tagalog",44:"Hanunoo",45:"Buhid",46:"Tagbanwa",47:"Khmer",48:"Mongolian",49:"Unified Canadian Aboriginal Syllabics Extended",50:"Limbu",51:"Tai Le",52:"New Tai Lue",53:"Khmer Symbols",54:"Buginese",55:"Tai Tham",56:"Combining Diacritical Marks Extended",57:"Balinese",58:"Sundanese",59:"Batak",60:"Lepcha",61:"Ol Chiki",62:"Cyrillic Extended C",63:"Sundanese Supplement",64:"Vedic Extensions",65:"Phonetic Extensions",66:"Phonetic Extensions Supplement",67:"Combining Diacritical Marks Supplement",68:"Latin Extended Additional",69:"Greek Extended",70:"General Punctuation",71:"Superscripts and Subscripts",72:"Currency Symbols",73:"Combining Diacritical Marks for Symbols",74:"Letterlike Symbols",75:"Number Forms",76:"Arrows",77:"Mathematical Operators",78:"Miscellaneous Technical",79:"Control Pictures",80:"Optical Character Recognition",81:"Enclosed Alphanumerics",82:"Box Drawing",83:"Block Elements",84:"Geometric Shapes",85:"Miscellaneous Symbols",86:"Dingbats",87:"Miscellaneous Mathematical Symbols A",88:"Supplemental Arrows A",89:"Braille Patterns",90:"Supplemental Arrows B",91:"Miscellaneous Mathematical Symbols B",92:"Supplemental Mathematical Operators",93:"Miscellaneous Symbols and Arrows",94:"Glagolitic",95:"Latin Extended C",96:"Coptic",97:"Georgian Supplement",98:"Tifinagh",99:"Ethiopic Extended",100:"Cyrillic Extended A",101:"Supplemental Punctuation",102:"CJK Radicals Supplement",103:"Kangxi Radicals",104:"Ideographic Description Characters",105:"CJK Symbols and Punctuation",106:"Hiragana",107:"Katakana",108:"Bopomofo",109:"Hangul Compatibility Jamo",110:"Kanbun",111:"Bopomofo Extended",112:"CJK Strokes",113:"Katakana Phonetic Extensions",114:"Enclosed CJK Letters and Months",115:"CJK Compatibility",116:"CJK Unified Ideographs Extension",117:"Yijing Hexagram Symbols",118:"CJK Unified Ideographs",119:"Yi Syllables",120:"Yi Radicals",121:"Lisu",122:"Vai",123:"Cyrillic Extended B",124:"Bamum",125:"Modifier Tone Letters",126:"Latin Extended D",127:"Syloti Nagri",128:"Common Indic Number Forms",129:"Phags pa",130:"Saurashtra",131:"Devanagari Extended",132:"Kayah Li",133:"Rejang",134:"Hangul Jamo Extended A",135:"Javanese",136:"Myanmar Extended B",137:"Cham",138:"Myanmar Extended A",139:"Tai Viet",140:"Meetei Mayek Extensions",141:"Ethiopic Extended A",142:"Latin Extended E",143:"Cherokee Supplement",144:"Meetei Mayek",145:"Hangul Syllables",146:"Hangul Jamo Extended B",147:"High Surrogates",148:"High Private Use Surrogates",149:"Low Surrogates",150:"Private Use Area",151:"CJK Compatibility Ideographs",152:"Alphabetic Presentation Forms",153:"Arabic Presentation Forms A",154:"Variation Selectors",155:"Vertical Forms",156:"Combining Half Marks",157:"CJK Compatibility Forms",158:"Small Form Variants",159:"Arabic Presentation Forms B",160:"Halfwidth and Fullwidth Forms",161:"Specials",162:"Linear B Syllabary",163:"Linear B Ideograms",164:"Aegean Numbers",165:"Ancient Greek Numbers",166:"Ancient Symbols",167:"Phaistos Disc",168:"Lycian",169:"Carian",170:"Coptic Epact Numbers",171:"Old Italic",172:"Gothic",173:"Old Permic",174:"Ugaritic",175:"Old Persian",176:"Deseret",177:"Shavian",178:"Osmanya",179:"Osage",180:"Elbasan",181:"Caucasian Albanian",182:"Linear A",183:"Cypriot Syllabary",184:"Imperial Aramaic",185:"Palmyrene",186:"Nabataean",187:"Hatran",188:"Phoenician",189:"Lydian",190:"Meroitic Hieroglyphs",191:"Meroitic Cursive",192:"Kharoshthi",193:"Old South Arabian",194:"Old North Arabian",195:"Manichaean",196:"Avestan",197:"Inscriptional Parthian",198:"Inscriptional Pahlavi",199:"Psalter Pahlavi",200:"Old Turkic",201:"Old Hungarian",202:"Rumi Numeral Symbols",203:"Brahmi",204:"Kaithi",205:"Sora Sompeng",206:"Chakma",207:"Mahajani",208:"Sharada",209:"Sinhala Archaic Numbers",210:"Khojki",211:"Multani",212:"Khudawadi",213:"Grantha",214:"Newa",215:"Tirhuta",216:"Siddham",217:"Modi",218:"Mongolian Supplement",219:"Takri",220:"Ahom",221:"Warang Citi",222:"Pau Cin Hau",223:"Bhaiksuki",224:"Marchen",225:"Cuneiform",226:"Cuneiform Numbers and Punctuation",227:"Early Dynastic Cuneiform",228:"Egyptian Hieroglyphs",229:"Anatolian Hieroglyphs",230:"Bamum Supplement",231:"Mro",232:"Bassa Vah",233:"Pahawh Hmong",234:"Miao",235:"Ideographic Symbols and Punctuation",236:"Tangut",237:"Tangut Components",238:"Kana Supplement",239:"Duployan",240:"Shorthand Format Controls",241:"Byzantine Musical Symbols",242:"Musical Symbols",243:"Ancient Greek Musical Notation",244:"Tai Xuan Jing Symbols",245:"Counting Rod Numerals",246:"Mathematical Alphanumeric Symbols",247:"Sutton SignWriting",248:"Glagolitic Supplement",249:"Mende Kikakui",250:"Adlam",251:"Arabic Mathematical Alphabetic Symbols",252:"Mahjong Tiles",253:"Domino Tiles",254:"Playing Cards",255:"Enclosed Alphanumeric Supplement",256:"Enclosed Ideographic Supplement",257:"Miscellaneous Symbols and Pictographs",258:"Emoticons",259:"Ornamental Dingbats",260:"Transport and Map Symbols",261:"Alchemical Symbols",262:"Geometric Shapes Extended",263:"Supplemental Arrows C",264:"Supplemental Symbols and Pictographs",265:"CJK Unified Ideographs Extension B",266:"CJK Unified Ideographs Extension C",267:"CJK Unified Ideographs Extension D",268:"CJK Unified Ideographs Extension E",269:"CJK Compatibility Ideographs Supplement",270:"Tags",271:"Variation Selectors Supplement",272:"Supplementary Private Use Area A",273:"Supplementary Private Use Area B"},e=33,i=[],s=[],n=[],a=-1,o=-1,l=!0,r=-1,c="",d=-1e3,h="",p=-1e3,u=-1,m=-1,g=20,b=20;Common.Views.SymbolTableDialog=Common.UI.Window.extend(_.extend({options:{resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},initialize:function(e){var r=Common.localStorage.getKeysFilter();this.appPrefix=r&&r.length?r.split(",")[0]:"";var c=this.appPrefix+"settings-size-symbol-table",d=Common.Utils.InternalSettings.get(c);null!=d&&null!=d||(d=Common.localStorage.getItem(c)||"",Common.Utils.InternalSettings.set(c,d)),d=d?JSON.parse(d):[],this.options=_.extend({resizable:!0,minwidth:448,minheight:420,width:448,height:420,cls:"modal-dlg invisible-borders",buttons:["ok","cancel"]},{title:this.textTitle,width:d[0]||448,height:d[1]||420},e||{}),this.api=this.options.api,this.type=this.options.type||0,this.special=this.options.special||!1,this.showShortcutKey=this.options.showShortcutKey||!1,this.special&&(this.options.height+=38),this.special&&(this.options.minheight+=38),this.template=['<div class="box">','<div id="symbol-table-switcher" style="margin-bottom: 16px;" class="'+(this.special?"":"hidden")+'">','<button type="button" class="btn btn-text-default auto" id="symbol-table-symbols">',this.textSymbols,"</button>",'<button type="button" class="btn btn-text-default auto" id="symbol-table-special">',this.textSpecial,"</button>","</div>",'<div id="symbol-table-pnl-symbols">','<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 50%;">','<label class="input-label">'+this.textFont+"</label>",'<div id="symbol-table-cmb-fonts"></div>',"</td>",'<td class="padding-left-5" style="padding-bottom: 8px;">','<label class="input-label">'+this.textRange+"</label>",'<div id="symbol-table-cmb-range"></div>',"</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>","<td>",'<div id="symbol-table-scrollable-div" style="position: relative;height:'+(this.options.height-304-38*(this.special?1:0))+'px;">','<div style="width: 100%;">','<div id="id-preview">',"<div>",'<div style="position: absolute; top: 0;"><div id="id-preview-data" tabindex="0" oo_editor_input="true"></div></div>',"</div>","</div>","</div>","</div>","</td>","</tr>","</table>",'<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 16px;padding-top: 16px;">','<label class="input-label">'+this.textRecent+"</label>",'<div id="symbol-table-recent" tabindex="0" oo_editor_input="true" style="width: 100%;"></div>',"</td>","</tr>","</table>",'<table cols="2" style="width: 100%;max-width: 497px;">',"<tr>",'<td class="padding-right-5" style="width: 50%;">','<label class="input-label">'+this.textCode+"</label>","</td>",'<td class="padding-left-5">',"</td>","</tr>","<tr>",'<td class="padding-right-5">','<div id="symbol-table-text-code" oo_editor_input="true"></div>',"</td>",'<td class="padding-left-5">','<div id="symbol-table-label-font" style="overflow: hidden; text-overflow: ellipsis;white-space: nowrap;max-width: 160px;"></div>',"</td>","</tr>","</table>","</div>",'<div id="symbol-table-pnl-special">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label id="symbol-table-lbl-char">'+this.textCharacter+"</label>",'<label id="symbol-table-lbl-shortcut" style="width: 112px;" class="float-right">'+this.textShortcut+"</label>","</td>","</tr>","<tr>","<td>",'<div id="symbol-table-special-list" class="no-borders" style="width:100%; height: '+(this.options.height-157)+'px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options);var h,p,u,m=i.length<1;if(m&&this.initFonts(),this.fillRecentSymbols(),e.font?h=e.font:n.length>0&&(h=n[0].font),h)for(var g=0;g<i.length;++g)if(i[g].displayValue===h){a=g;break}if(a<0&&(a=0),s=this.getArrRangesByFont(a),-1===o&&(o=s[0].Start),e.code?o=e.code:e.symbol?o=this.fixedCharCodeAt(e.symbol,0):n.length>0&&(o=n[0].symbol),m&&this.options.lang&&"en"!=this.options.lang){var b=this;p=this.options.lang,u=function(){b.updateRangeSelector()},p=p.split(/[\-_]/)[0].toLocaleLowerCase(),Common.Utils.loadConfig("resources/symboltable/"+p+".json",(function(e){for(var i=1;i<274;i++){var s=t[i];t[i]=e[s]||s}u&&u()}))}Common.UI.Window.prototype.initialize.call(this,this.options),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this)),l=!0},initFonts:function(){var t,e,s=this.api.pluginMethod_GetFontList();s.sort((function(t,e){return t.m_wsFontName<e.m_wsFontName?-1:t.m_wsFontName>e.m_wsFontName?1:0}));for(var n,o=[],l={},r=0;r<s.length;++r)(e=l[n=(t=s[r]).m_wsFontName])?e.m_bBold&&e.m_bItalic||e.m_bBold&&!t.m_bBold?l[n]=t:!e.m_bItalic||t.m_bBold||t.m_bItalic||(l[n]=t):l[n]=t;delete l.ASCW3;r=0;for(var d in l)l.hasOwnProperty(d)&&(o.push(l[d]),o[o.length-1].displayValue=l[d].m_wsFontName);for((i=o).sort((function(t,e){return t.displayValue.toLowerCase()>e.displayValue.toLowerCase()?1:-1})),r=0;r<i.length;++r)i[r].value=r;if(l[c]||(l["Cambria Math"]?c="Cambria Math":l["Asana-Math"]&&(c="Asana-Math")),l[c])for(r=0;r<i.length;++r)if(i[r].displayValue===c){a=r;break}},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.btnSymbols=new Common.UI.Button({el:e.find("#symbol-table-symbols"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),this.btnSymbols.on("click",_.bind(this.onModeClick,this,!1)),this.btnSpecial=new Common.UI.Button({el:e.find("#symbol-table-special"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),this.btnSpecial.on("click",_.bind(this.onModeClick,this,!0)),Common.UI.GroupedButtons([this.btnSymbols,this.btnSpecial]),this.cmbFonts=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-fonts"),cls:"input-group-nr",data:i,editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var n=t.getRangeBySymbol(s,o);if(a=i.value,s=t.getArrRangesByFont(a),n){for(var r=0;r<s.length&&n.Name!==s[r].Name;++r);r===s.length&&(o=s[0].Start)}else o=s[0].Start;l=!0,t.updateView(),setTimeout((function(){t.previewPanel.focus()}),1)})),this.cmbFonts.setValue(a),this.cmbRange=new Common.UI.ComboBox({el:e.find("#symbol-table-cmb-range"),cls:"input-group-nr",editable:!1,search:!0,menuStyle:"min-width: 100%; max-height: 209px;"}).on("selected",(function(e,i){var n=t.getRangeByName(s,parseInt(i.value));o=n.Start,l=!0,t.updateView(void 0,void 0,void 0,void 0,!1),setTimeout((function(){t.previewPanel.focus()}),1)})),this.updateRangeSelector(),t.inputCode=new Common.UI.InputField({el:e.find("#symbol-table-text-code"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 100%;",validateOnBlur:!1,validateOnChange:!0}).on("changing",(function(i,n,a){var r=parseInt(n,16);if(!isNaN(r)&&r>31&&t.getRangeBySymbol(s,r)){var c=0===e.find("#c"+r).length;o=r,l=!0,t.updateView(c,void 0,!1)}})).on("change:after",(function(e,i,s){t.updateInput()})),this.symbolTablePanel=e.find("#symbol-table-scrollable-div"),this.previewPanel=e.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=e.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.recentPanel=e.find("#symbol-table-recent"),this.fontLabel=e.find("#symbol-table-label-font"),this.boxPanel=e.find(".box"),this.updateView(void 0,void 0,void 0,!0);var n=[{symbol:"",description:this.textEmDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Shift -":"Alt+Ctrl+Num -","{0}"),code:"2014"},{symbol:"",description:this.textEnDash,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Num -":"Ctrl+Num -","{0}"),code:"2013"},{symbol:"",description:this.textNBHyphen,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Ctrl Shift _":"Ctrl+Shift+_","{0}"),code:"002D",special:{NonBreakingHyphen:!0}},{symbol:"",description:this.textEmSpace,shortcutKey:"",code:"2003"},{symbol:"",description:this.textEnSpace,shortcutKey:"",code:"2002"},{symbol:"",description:this.textQEmSpace,shortcutKey:"",code:"2005"},{symbol:"",description:this.textNBSpace,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt ":"Ctrl+Shift+","{0}")+"Space",code:"00A0"},{symbol:"",description:this.textCopyright,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"G",code:"00A9"},{symbol:"",description:this.textRegistered,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"R",code:"00AE"},{symbol:"",description:this.textTradeMark,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+"T",code:"2122"},{symbol:"",description:this.textSection,shortcutKey:"",code:"00A7"},{symbol:"",description:this.textPilcrow,shortcutKey:"",code:"00B6"},{symbol:"",description:this.textEllipsis,shortcutKey:Common.Utils.String.platformKey(Common.Utils.isMac?"Alt Ctrl ":"Alt+Ctrl+","{0}")+".",code:"2026"},{symbol:"",description:this.textSOQuote,shortcutKey:"",code:"2018"},{symbol:"",description:this.textSCQuote,shortcutKey:"",code:"2019"},{symbol:"",description:this.textDOQuote,shortcutKey:"",code:"201C"},{symbol:"",description:this.textDCQuote,shortcutKey:"",code:"201D"}];this.specialList=new Common.UI.ListView({el:e.find("#symbol-table-special-list"),store:new Common.UI.DataViewStore(n),simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:flex;">','<div class="padding-right-5" style="width:70px;text-align: center;"><%= symbol %></div>','<div class="padding-right-5" style="flex-grow:1;"><%= description %></div>',"<% if ("+this.showShortcutKey+") { %>",'<div style="width:105px;"><%= shortcutKey %></div>',"<% } %>","</div>"].join(""))}),this.specialList.on("item:dblclick",_.bind(this.onDblClickSpecialItem,this)).on("entervalue",_.bind(this.onDblClickSpecialItem,this)),this.specialList.selectByIndex(0),this.lblShortCut=e.find("#symbol-table-lbl-shortcut"),this.lblShortCut.toggleClass("hidden",!this.showShortcutKey),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.symbolsPanel=e.find("#symbol-table-pnl-symbols"),this.specialPanel=e.find("#symbol-table-pnl-special")},calcControlsHeight:function(){var t=this.$window,e=this.symbolsPanel.find("> table"),i=t.find("#symbol-table-switcher"),s=t.find(".body");this.hfHeight=parseInt(t.find(".header").css("height"))+parseInt(t.find(".footer").css("height"))+parseInt(s.css("padding-top"))+parseInt(s.css("padding-bottom"))+parseInt(t.css("border-bottom-width"))+parseInt(t.css("border-top-width")),this.switcherHeight=this.special?i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSpecialHeight=this.special&&this.btnSpecial.isActive()?t.find("#symbol-table-lbl-char").height()+i.height()+parseInt(i.css("margin-bottom")):0,this.controlsSymbolsHeight=this.special&&this.btnSpecial.isActive()?0:e.eq(0).height()+e.eq(2).height()+e.eq(3).height()+(this.special?i.height()+parseInt(i.css("margin-bottom")):0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),this.binding||(this.binding={}),this.binding.keydownSymbols=_.bind(this.onKeyDown,this),this.binding.keypressSymbols=_.bind(this.onKeyPress,this),$(document).on("keydown."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keydownSymbols),$(document).on("keypress."+this.cid,"#symbol-table-scrollable-div #id-preview-data, #symbol-table-recent",this.binding.keypressSymbols);var t=this.special&&!!Common.Utils.InternalSettings.get(this.appPrefix+"symbol-table-special");t?this.btnSpecial.toggle(!0):this.btnSymbols.toggle(!0),this.ShowHideElem(t)},close:function(t){$(document).off("keydown."+this.cid,this.binding.keydownSymbols),$(document).off("keypress."+this.cid,this.binding.keypressSymbols),this.special&&Common.Utils.InternalSettings.set(this.appPrefix+"symbol-table-special",this.btnSpecial.isActive()),Common.UI.Window.prototype.close.apply(this,arguments)},getPasteSymbol:function(t){var e,s=!1;if(t&&t.length>0)if(s="c"===t[0])e=i[a].displayValue;else{var n=parseInt(t.split("_")[2]);e=i[n].displayValue}return{font:e,symbol:this.encodeSurrogateChar(o),code:o,updateRecents:s}},getSpecialSymbol:function(){var t=this.specialList.getSelectedRec();return{font:void 0,symbol:this.encodeSurrogateChar(t.get("code")),code:parseInt(t.get("code"),16),special:t.get("special"),speccharacter:!0}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value,!0)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t,e){if(e||!document.activeElement||"textarea"!=document.activeElement.localName||!/area_id/.test(document.activeElement.id)){var i=this.btnSpecial.isActive(),s="ok"==t?i?this.getSpecialSymbol():this.getPasteSymbol(this.$window.find(".cell-selected").attr("id")):{};this.options.handler&&this.options.handler.call(this,this,t,s),"ok"==t&&(!i&&this.checkRecent(o,s.font),!i&&s.updateRecents&&this.updateRecents(),this.type)||this.close()}},encodeSurrogateChar:function(t){if(t<65536)return String.fromCharCode(t);var e=55296|(t-=65536)>>10,i=56320|1023&t;return String.fromCharCode(e)+String.fromCharCode(i)},fixedCharCodeAt:function(t,e){e=e||0;var i,s,n=t.charCodeAt(e);if(55296<=n&&n<=56319){if(i=n,s=t.charCodeAt(e+1),isNaN(s))throw"        fixedCharCodeAt()";return 1024*(i-55296)+(s-56320)+65536}return!(56320<=n&&n<=57343)&&n},getArrRangesByFont:function(t){var e=getSupportedRangesByFont(i[t]);return 0===e.length&&e.push({Start:32,End:255}),e[0].Start<32&&(e[0].Start=32),e},getRangeBySymbol:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Start<=e&&t[i].End>=e)return t[i];return null},getRangeByName:function(t,e){for(var i=0;i<t.length;++i)if(t[i].Name===e)return t[i];return null},getLinearIndexByCode:function(t,e){for(var i,s=0,n=0;n<t.length;++n){if((i=t[n]).Start>e)return-1;if(i.Start<=e&&i.End>=e)return s+(e-i.Start);s+=i.End-i.Start+1}return-1},getCodeByLinearIndex:function(t,e){if(e<0)return-1;for(var i,s=0,n=t[0],a=0;a<t.length;++a){if(s+(i=(n=t[a]).End-n.Start+1)>e)return n.Start+e-s;s+=i}return-1},createTable:function(t,e,i){for(var s,n=e*i,a=0,o="",l=0;l<n;++l)s=l/i>>0==e-1?"style='border-bottom: none'":"",l<t.length?o+='<div dir="ltr" class="cell" '+s+' id="'+("c"+t[l])+'">&#'+t[l].toString(10)+"</div>":o+='<div dir="ltr" class="cell"'+s+"></div>",++a>=i&&(o+='<br class="noselect">',a=0);this.previewPanel.html(o)},fillRecentSymbols:function(){var t,e=Common.localStorage.getItem(this.appPrefix+"recentSymbols");""!=e&&(t=JSON.parse(e)),_.isArray(t)&&(n=t)},saveRecent:function(){var t=JSON.stringify(n);Common.localStorage.setItem(this.appPrefix+"recentSymbols",t)},checkRecent:function(t,e){if(0===n.length)return n.push({symbol:t,font:e}),void this.saveRecent();for(var i=0;i<n.length;++i)if(n[i].symbol===t&&n[i].font===e){n.splice(i,1);break}n.splice(0,0,{symbol:t,font:e}),n.length>36&&n.splice(36,n.length-36),this.saveRecent()},createCell:function(t,e){var s="",n="";if(e){for(var a=0,o=0;o<i.length;++o)if(i[o].displayValue===e){a=o;break}s="r_"+t+"_"+a,n="&#"+t.toString()}else void 0!==t&&(s="r"+t,n="&#"+t.toString());var l=$('<div dir="ltr" id="'+s+'">'+n+"</div>");return l.addClass("cell"),l.addClass("noselect"),l.mousedown(_.bind(this.cellClickHandler,this)),e&&l.css("font-family","'"+e+"'"),l},cellClickHandler:function(t){var e=$(t.target).attr("id");if(e){var i=(new Date).getTime();if(e===h&&i-p<300)this.cellDblClickHandler(t);else{if("c"===e[0])o=parseInt(e.slice(1,e.length)),l=!0;else{var s=e.split("_");o=parseInt(s[1]),r=parseInt(s[2]),l=!1}this.updateView(!1)}h=t.target.id,p=i}},cellDblClickHandler:function(t){if(this.type){var e=this.getPasteSymbol($(t.target).attr("id"));this.checkRecent(o,e.font),e.updateRecents&&this.updateView(!1,void 0,void 0,!0),this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},onDblClickSpecialItem:function(t){if(this.type){var e=this.getSpecialSymbol();this.fireEvent("symbol:dblclick",this,"ok",e)}else this._handleInput("ok")},updateRecents:function(){var t=this.recentPanel;t.empty();var e=this.getColsCount(),i=n.length;t.width(31*e);for(var s=0;s<e;++s){var a=s<i?this.createCell(n[s].symbol,n[s].font):this.createCell();a.css("border-bottom","none"),t.append(a),s===e-1&&a.css(Common.UI.isRTL()?"border-left":"border-right","none")}},getColsCount:function(){return(this.boxPanel.width()-13)/31>>0},getMaxHeight:function(){return this.symbolTablePanel.height()-2},getRowsCount:function(){return Math.max(1,this.getMaxHeight()/e>>0)},getAllSymbolsCount:function(t){for(var e,i=0,s=0;s<t.length;++s)i+=(e=t[s]).End-e.Start+1;return i},setTable:function(t){for(var e,n=this.getColsCount(),o=this.getRowsCount(),l=this.getLinearIndexByCode(s,t),r=this.getAllSymbolsCount(s),c=Math.ceil(r/n),d=Math.max(0,Math.min(c-o,l/n>>0)),h=d*n,p=o*n,u=[],m=0;m<p&&-1!==(e=this.getCodeByLinearIndex(s,h+m));++m)u.push(e);return this.previewPanel.css("font-family","'"+i[a].displayValue+"'"),this.createTable(u,o,n),d},updateView:function(t,n,c,d,h){l&&!1!==h&&this.updateRangeSelector(),l?this.fontLabel.text(i[a]?i[a].displayValue:""):this.fontLabel.text(i[r]?i[r].displayValue:""),!1!==t&&this.cmbFonts.setValue(a);var p=this.getRowsCount()*e;if(!1,!1!==t){var u=null!=n?n:o,m=this.setTable(u),f=this.getAllSymbolsCount(s),v=Math.ceil(f/this.getColsCount())*e;this.previewInner.height(v),this.previewPanel.height(p),this.previewScrolled.height(p),this.scrollerY||(g=Math.max(22,p/8+.5>>0),b=Math.min(Math.floor(this.previewPanel.height()/e)*e/10,20),this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:g,alwaysVisibleY:!0,wheelSpeed:b,useKeyboard:!1,onChange:_.bind((function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(p),this.previewParent.css({top:this.scrollerY.getScrollTop()}))}),this)})),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:g,wheelSpeed:b}),this.scrollerY.scrollTop(m*e));var C=this.previewPanel.find(".cell");C.off("mousedown"),C.mousedown(_.bind(this.cellClickHandler,this))}d&&this.updateRecents(),this.$window.find(".cell").removeClass("cell-selected"),l?this.$window.find("#c"+o).addClass("cell-selected"):this.$window.find("#r_"+o+"_"+r).addClass("cell-selected"),!1!==c&&this.updateInput()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==d){var t=this.getAllSymbolsCount(s),i=this.getColsCount(),n=this.getRowsCount(),a=Math.ceil(t/i),r=a*e,c=Math.max(0,Math.min(a-n,a*this.scrollerY.getScrollTop()/r+.5>>0));if(d=this.scrollerY.getScrollTop(),l){var h=this.previewPanel.children()[0];if(h){var p=h.id;if(p){var u=parseInt(p.slice(1,p.length)),m=this.getLinearIndexByCode(s,u),g=c*i+(this.getLinearIndexByCode(s,o)-m);o=this.getCodeByLinearIndex(s,g);var b=c*i;for(g-=i;-1===o&&g>=b;)o=this.getCodeByLinearIndex(s,g),g-=i;-1===o&&(o=this.getCodeByLinearIndex(s,b))}else o=this.getCodeByLinearIndex(s,c*i)}}else o=this.getCodeByLinearIndex(s,c*i),l=!0;this.updateView(!0,this.getCodeByLinearIndex(s,c*i))}},updateInput:function(){for(var t=o.toString(16).toUpperCase(),e=t.length;e<5;++e)t="0"+t;this.inputCode.setValue(t)},updateRangeSelector:function(){var e=this.getRangeBySymbol(s,o);if(e&&e.Name){this.cmbRange.setDisabled(!1);var i,n=[];for(i=0;i<s.length;++i)n.push({value:s[i].Name,displayValue:t[s[i].Name]});this.cmbRange.setData(n),this.cmbRange.setValue(e.Name)}else this.cmbRange.setDisabled(!0),this.cmbRange.setValue("")},onKeyDown:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0,i=!0;if(l){var n=-1;if(e===Common.UI.Keys.LEFT?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)-1):e===Common.UI.Keys.UP?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)-this.getColsCount()):e===Common.UI.Keys.RIGHT?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)+1):e===Common.UI.Keys.DOWN?n=this.getCodeByLinearIndex(s,this.getLinearIndexByCode(s,o)+this.getColsCount()):e===Common.UI.Keys.HOME?s.length>0&&(n=s[0].Start):e===Common.UI.Keys.END?s.length>0&&(n=s[s.length-1].End):i=!1,n>-1){o=n;var a=0===this.$window.find("#c"+o).length;this.updateView(a)}}else{var c,d;if(e===Common.UI.Keys.LEFT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var h=this.$window.find(c).prev();h.length>0&&(d=this.$window.find(h).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.RIGHT){if((c=this.$window.find(".cell-selected")[0])&&"r"===c.id[0]){var p=this.$window.find(c).next();p.length>0&&(d=this.$window.find(p).attr("id").split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}}else if(e===Common.UI.Keys.HOME){var g=this.$window.find("#recent-table").children()[0];g&&(d=g.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else if(e===Common.UI.Keys.END){var b=this.recentPanel.children(),f=b[b.length-1];f&&(d=f.id.split("_"),o=parseInt(d[1]),r=parseInt(d[2]),this.updateView(!1))}else i=!1}i&&(m=e,u=(new Date).getTime())}},onKeyPress:function(t){if(!document.activeElement||!document.activeElement.nodeName||"span"!==document.activeElement.nodeName.toLowerCase()){var e=t.which||t.charCode||t.keyCode||0;if(!(m===e&&Math.abs(u-(new Date).getTime())<1e3)){if(!isNaN(e)&&e>31)if(this.getRangeBySymbol(s,e)){var i=0===this.$window.find("#c"+e).length;o=e,l=!0,this.updateView(i,void 0,!0)}t.preventDefault&&t.preventDefault()}}},onWindowResize:function(t){var e=this.getSize();if(t&&"start"==t[1])this._preventUpdateScroll=!0,this.curSize={resize:!1,width:e[0],height:e[1]};else if(this.curSize.resize){this._preventUpdateScroll=!1,this.scrollerY=null,this.curSize.height=e[1],this.curSize.width=e[0],this.applyInnerSize(e[1]),this.special&&(e[1]-=this.switcherHeight);var i=JSON.stringify(e);Common.localStorage.setItem(this.appPrefix+"settings-size-symbol-table",i),Common.Utils.InternalSettings.set(this.appPrefix+"settings-size-symbol-table",i)}},onWindowResizing:function(){if(this.curSize){var t=this.getSize();t[0]===this.curSize.width&&t[1]===this.curSize.height||(this.curSize.resize||(this.curSize.resize=!0),this.curSize.width=t[0],this.curSize.height=t[1],this.applyInnerSize(t[1]))}},applyInnerSize:function(t){var i=t-this.hfHeight;this.controlsSymbolsHeight?(i-=this.controlsSymbolsHeight,this.symbolTablePanel.css({height:i+"px"}),i=Math.max(1,(i-2)/e>>0)*e,this.previewPanel.css({height:i+"px"}),this.previewScrolled.css({height:i+"px"}),this.updateView(void 0,void 0,void 0,!0)):this.specialList.cmpEl.height(i-this.controlsSpecialHeight)},onModeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(t){this.symbolsPanel.toggleClass("hidden",t),this.specialPanel.toggleClass("hidden",!t),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]);var e=this;_.delay((function(){t?e.specialList.focus():e.previewPanel.focus()}),50)},onThemeChanged:function(){this.$window&&this.isVisible()&&(Common.UI.Window.prototype.onThemeChanged.call(this),this.calcControlsHeight(),this.applyInnerSize(this.getSize()[1]))},textTitle:"Symbol",textFont:"Font",textRange:"Range",textRecent:"Recently used symbols",textCode:"Unicode HEX value",textSymbols:"Symbols",textSpecial:"Special characters",textCharacter:"Character",textShortcut:"Shortcut key",textEmDash:"Em Dash",textEnDash:"En Dash",textNBHyphen:"Non-breaking Hyphen",textSHyphen:"Soft Hyphen",textEmSpace:"Em Space",textEnSpace:"En Space",textQEmSpace:"1/4 Em Space",textNBSpace:"No-break Space",textCopyright:"Copyright Sign",textRegistered:"Registered Sign",textTradeMark:"Trade Mark Sign",textSection:"Section Sign",textPilcrow:"Pilcrow Sign",textEllipsis:"Horizontal Ellipsis",textSOQuote:"Single Opening Quote",textSCQuote:"Single Closing Quote",textDOQuote:"Double Opening Quote",textDCQuote:"Double Closing Quote"},Common.Views.SymbolTableDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/ListSettingsDialog",[],(function(){"use strict";var t={none:-1,symbol:0,image:2,newSymbol:1,newImage:-2};Common.Views.ListSettingsDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:285,height:261,style:"min-width: 240px;",cls:"modal-dlg",id:"window-list-settings",split:!1,buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 16px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-list-bullet">',this.textBulleted,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-list-numbering">',this.textNumbering,"</button>","</div>",'<div style="height:120px;">','<table cols="3">',"<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtType+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-numbering-format" class="input-group-nr" style="width: 105px;"></div>','<div id="id-dlg-list-bullet-format" class="input-group-nr" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="image">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtImport+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-image" style="width: 105px;"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","<tr>",'<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtSize+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-size"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="text" style="white-space: nowrap;">'+this.txtOfText+"</label>","</td>","</tr>",'<tr class="numbering">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text" style="white-space: nowrap;">'+this.txtStart+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-start"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>",'<tr class="color">','<td class="padding-right-5" style="padding-bottom: 8px;min-width: 50px;">','<label class="text">'+this.txtColor+"</label>","</td>",'<td class="padding-right-5" style="padding-bottom: 8px;width: 105px;">','<div id="id-dlg-list-color"></div>',"</td>",'<td style="padding-bottom: 8px;"></td>',"</tr>","</table>","</div>","</div>"].join(""),this.props=t.props,this.options.tpl=_.template(this.template)(this.options),this.color="000000",this.storage=!!t.storage,this.api=t.api,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this,i=this.getChild();i.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.btnBullet=new Common.UI.Button({el:$("#id-dlg-list-bullet"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1,pressed:!0}),e.btnBullet.on("click",_.bind(e.onListTypeClick,e,0)),e.btnNumbering=new Common.UI.Button({el:$("#id-dlg-list-numbering"),enableToggle:!0,toggleGroup:"list-type",allowDepress:!1}),e.btnNumbering.on("click",_.bind(e.onListTypeClick,e,1)),Common.UI.GroupedButtons([e.btnBullet,e.btnNumbering]),this.cmbNumFormat=new Common.UI.ComboBox({el:$("#id-dlg-list-numbering-format"),menuStyle:"min-width: 100%;max-height: 183px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{displayValue:this.txtNone,value:-1},{displayValue:"A, B, C,...",value:4},{displayValue:"a), b), c),...",value:5},{displayValue:"a, b, c,...",value:6},{displayValue:"1, 2, 3,...",value:1},{displayValue:"1), 2), 3),...",value:2},{displayValue:"I, II, III,...",value:3},{displayValue:"i, ii, iii,...",value:7}]}),this.cmbNumFormat.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putListType(1,e.value)}),this)),this.cmbNumFormat.setValue(1);var s=["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue %>",'<% if (item.value === 0) { %><span style="font-family:<%=item.font%>;"><%=item.symbol%></span>','<% } else if (item.value === 2) { %><span id="id-dlg-list-bullet-image-preview" class="margin-left-4" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span><% } %>',"</a></li>","<% }); %>"],n=['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; <%= style %>"></div>','<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(s).concat(["</ul>","</div>"]);this.cmbBulletFormat=new Common.UI.ComboBoxCustom({el:$("#id-dlg-list-bullet-format"),menuStyle:"min-width: 100%;max-height: 183px;",style:"width: 105px;",editable:!1,takeFocusOnClose:!0,template:_.template(n.join("")),itemsTemplate:_.template(s.join("")),data:[{displayValue:this.txtNone,value:t.none},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"o",font:"Courier New"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"v",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"w",font:"Wingdings"},{displayValue:this.txtSymbol+": ",value:t.symbol,symbol:"",font:"Arial"},{displayValue:this.txtNewBullet,value:t.newSymbol},{displayValue:this.txtNewImage,value:t.newImage}],updateFormControl:function(i){var s=$(this.el).find(".form-control");if(i)if(i.get("value")===t.symbol)s[0].innerHTML=i.get("displayValue")+'<span style="font-family:'+(i.get("font")||"Arial")+'">'+i.get("symbol")+"</span>";else if(i.get("value")===t.image){s[0].innerHTML=i.get("displayValue")+'<span id="id-dlg-list-bullet-combo-preview" class="margin-left-2" style="width:12px; height: 12px; margin-bottom: 1px;display: inline-block; vertical-align: middle;"></span>';var n=new Asc.asc_CBullet;n.asc_fillBulletImage(e.imageProps.id),n.drawSquareImage("id-dlg-list-bullet-combo-preview")}else i.get("value")===t.newImage?s[0].innerHTML=e.txtImage:s[0].innerHTML=i.get("displayValue");else s[0].innerHTML=""}});var a=this.cmbBulletFormat.store.at(1);this.cmbBulletFormat.selectRecord(a),this.bulletProps={symbol:a.get("symbol"),font:a.get("font")},this.cmbBulletFormat.on("selected",_.bind((function(e,i){if(this.imageControls.toggleClass("hidden",!(i.value===t.image||i.value===t.newImage)),this.colorControls.toggleClass("hidden",i.value===t.image||i.value===t.newImage),i.value===t.newSymbol){var s,n=this,a=n.bulletProps,o=function(i,o,l){s=o,"ok"==o&&(a.changed=!0,a.code=l.code,a.font=l.font,a.symbol=l.symbol,n._changedProps&&(n._changedProps.asc_putFont(a.font),n._changedProps.asc_putSymbol(a.symbol)));var r=e.store;if(!r.findWhere({value:t.symbol,symbol:a.symbol,font:a.font})){var c=r.indexOf(r.findWhere({value:t.image}));c<0&&(c=r.indexOf(r.findWhere({value:t.newSymbol}))),r.add({displayValue:n.txtSymbol+": ",value:t.symbol,symbol:a.symbol,font:a.font},{at:c})}n.imageProps&&(n.imageProps.redraw=!0),e.setData(r.models),e.selectRecord(e.store.findWhere({value:t.symbol,symbol:a.symbol,font:a.font}))},l=new Common.Views.SymbolTableDialog({api:n.options.api,lang:n.options.interfaceLang,modal:!0,type:0,font:a.font,symbol:a.symbol,handler:o}).on("close",(function(t){void 0===s&&o&&o.call(n),setTimeout((function(){n.cmbBulletFormat.focus()}),1)}));l.show(),l.on("symbol:dblclick",o)}else i.value==t.newImage||(i.value==t.image?this._changedProps&&this._changedProps.asc_fillBulletImage(this.imageProps.id):i.value==t.none?this._changedProps&&this._changedProps.asc_putListType(0,i.value):(this.bulletProps.changed=!0,this.bulletProps.code=i.code,this.bulletProps.font=i.font,this.bulletProps.symbol=i.symbol,this._changedProps&&(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol))));this.btnOk.setDisabled(i.value===t.newImage)}),this)),this.cmbBulletFormat.on("show:after",_.bind(this.onBulletFormatOpen,this)),this.spnSize=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-size"),step:1,width:105,value:100,defaultUnit:"",maxValue:400,minValue:25,allowDecimal:!1}).on("change",(function(t,i,s,n){e._changedProps&&e._changedProps.asc_putSize(t.getNumberValue())}));var o=this.options.colorConfig||{};this.btnColor=new Common.UI.ColorButton({parentEl:i.find("#id-dlg-list-color"),style:"width:45px;",additionalAlign:this.menuAddAlign,color:this.color,colors:o.colors,dynamiccolors:o.dynamiccolors,themecolors:o.themecolors,effects:o.effects,columns:o.columns,paletteCls:o.cls,paletteWidth:o.paletteWidth,takeFocusOnClose:!0}),this.btnColor.on("color:select",_.bind(this.onColorsSelect,this)),this.colors=this.btnColor.getPicker(),this.spnStart=new Common.UI.MetricSpinner({el:i.find("#id-dlg-list-start"),step:1,width:105,value:1,defaultUnit:"",maxValue:32767,minValue:1,allowDecimal:!1}).on("change",(function(t,i,s,n){e._changedProps&&e._changedProps.asc_putNumStartAt(t.getNumberValue())})),this.btnSelectImage=new Common.UI.Button({parentEl:$("#id-dlg-list-image"),cls:"btn-text-menu-default",caption:this.textSelect,style:"width: 100%;",menu:new Common.UI.Menu({style:"min-width: 105px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textFromFile,value:0},{caption:this.textFromUrl,value:1},{caption:this.textFromStorage,value:2}]}),takeFocusOnClose:!0}),this.btnSelectImage.menu.on("item:click",_.bind(this.onImageSelect,this)),this.btnSelectImage.menu.items[2].setVisible(this.storage),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:i.find(".primary")}),e.numberingControls=i.find("tr.numbering"),e.imageControls=i.find("tr.image"),e.colorControls=i.find("tr.color");var l=i.find("table tr:first() td:first()");l.width(Math.max(i.find(".numbering .text").width(),l.width())),this.afterRender()},getFocusedComponents:function(){return[this.btnBullet,this.btnNumbering,this.cmbNumFormat,this.cmbBulletFormat,this.btnSelectImage,this.spnSize,this.spnStart,this.btnColor].concat(this.getFooterButtons())},afterRender:function(){!this.options.colorConfig&&this.updateThemeColors(),this._setDefaults(this.props);var e=this,i=function(i){e.imageProps={id:i.asc_getImageId(),redraw:!0},e._changedProps&&e._changedProps.asc_fillBulletImage(e.imageProps.id);var s=e.cmbBulletFormat.store;if(!s.findWhere({value:t.image})){var n=s.indexOf(s.findWhere({value:t.newSymbol}));s.add({displayValue:e.txtImage+":",value:t.image},{at:n})}e.cmbBulletFormat.setData(s.models),e.cmbBulletFormat.selectRecord(e.cmbBulletFormat.store.findWhere({value:t.image})),e.btnOk.setDisabled(!1)};this.api.asc_registerCallback("asc_onBulletImageLoaded",i);var s=function(t){t&&t._urls&&"bullet"==t.c&&(new Asc.asc_CBullet).asc_putImageUrl(t._urls[0],t.token)};Common.NotificationCenter.on("storage:image-insert",s),this.on("close",(function(t){e.api.asc_unregisterCallback("asc_onBulletImageLoaded",i),Common.NotificationCenter.off("storage:image-insert",s)}))},onBulletFormatOpen:function(e){if(e.store.findWhere({value:t.image})&&this.imageProps.redraw){var i=new Asc.asc_CBullet;i.asc_fillBulletImage(this.imageProps.id),i.drawSquareImage("id-dlg-list-bullet-image-preview"),this.imageProps.redraw=!1}},updateThemeColors:function(){this.colors.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},onColorsSelect:function(t,e){this.color=e,this._changedProps&&this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(e))},onListTypeClick:function(t,e,i){this.ShowHideElem(t)},ShowHideElem:function(e){var i=0==e&&(this.cmbBulletFormat.getValue()===t.image||this.cmbBulletFormat.getValue()===t.newImage||(void 0===this.cmbBulletFormat.getValue()||""===this.cmbBulletFormat.getValue())&&this.originalType===AscFormat.BULLET_TYPE_BULLET_BLIP);this.numberingControls.toggleClass("hidden",0==e),this.imageControls.toggleClass("hidden",!i),this.colorControls.toggleClass("hidden",i),this.cmbNumFormat.setVisible(1==e),this.cmbBulletFormat.setVisible(0==e),this.btnOk.setDisabled(i&&this.cmbBulletFormat.getValue()===t.newImage);var s=this;_.delay((function(){e?s.cmbNumFormat.focus():s.cmbBulletFormat.focus()}),50)},_handleInput:function(e){if(this.options.handler){if("ok"==e&&this.btnOk.isDisabled())return;var i=this.btnBullet.pressed?0:1;this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE&&(this._changedProps=new Asc.asc_CBullet,this._changedProps.asc_putSize(this.spnSize.getNumberValue()),0==i&&this.cmbBulletFormat.getValue()===t.image&&this.imageProps?this._changedProps.asc_fillBulletImage(this.imageProps.id):this._changedProps.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.color))),(this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE||(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR||this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP)&&1==i||this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM&&0==i)&&(0==i?this.cmbBulletFormat.getValue()==t.none?this._changedProps.asc_putListType(0,-1):this.cmbBulletFormat.getValue()==t.image||(this._changedProps.asc_putFont(this.bulletProps.font),this._changedProps.asc_putSymbol(this.bulletProps.symbol)):(this._changedProps.asc_putListType(1,this.cmbNumFormat.getValue()),this._changedProps.asc_putNumStartAt(this.spnStart.getNumberValue()))),this.options.handler.call(this,e,this._changedProps)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_setDefaults:function(e){if(e){var i=0,s=e.asc_getBullet();if(s){this.originalType=s.asc_getType(),this.spnSize.setValue(s.asc_getSize()||"",!0);var n=s.asc_getColor();if(n=n?n.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()),effectValue:n.get_value()}:Common.Utils.ThemeColor.getHexColor(n.get_r(),n.get_g(),n.get_b()):"transparent",this.color=Common.Utils.ThemeColor.colorValue2EffectId(n),this.btnColor.setColor(n),Common.Utils.ThemeColor.selectPickerColorByEffect(n,this.colors),this.originalType==AscFormat.BULLET_TYPE_BULLET_NONE)this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),i=this.type;else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_CHAR){var a=s.asc_getSymbol();a?(this.bulletProps={symbol:a,font:s.asc_getFont()},this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font})||this.cmbBulletFormat.store.add({displayValue:this.txtSymbol+": ",value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.symbol,symbol:this.bulletProps.symbol,font:this.bulletProps.font}))):this.cmbBulletFormat.setValue(""),this._changedProps=s,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_BLIP){var o=s.asc_getImageId();o?(this.imageProps={id:o,redraw:!0},this.cmbBulletFormat.store.findWhere({value:t.image})||this.cmbBulletFormat.store.add({displayValue:this.txtImage+":",value:t.image},{at:this.cmbBulletFormat.store.length-2}),this.cmbBulletFormat.setData(this.cmbBulletFormat.store.models),this.cmbBulletFormat.selectRecord(this.cmbBulletFormat.store.findWhere({value:t.image}))):this.cmbBulletFormat.setValue(""),this._changedProps=s,i=0}else if(this.originalType==AscFormat.BULLET_TYPE_BULLET_AUTONUM){var l=s.asc_getAutoNumType();this.cmbNumFormat.setValue(l,"");var r=s.asc_getNumStartAt();this.spnStart.setValue(r||"",!0),this.spnStart.setDisabled(null===r),this._changedProps=s,i=1}}else this.cmbNumFormat.setValue(-1),this.cmbBulletFormat.setValue(t.none),this._changedProps=new Asc.asc_CBullet,i=this.type}1==i?this.btnNumbering.toggle(!0):this.btnBullet.toggle(!0),this.ShowHideElem(i)},onImageSelect:function(t,e){if(1==e.value){var i=this;new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t){var i=e.replace(/ /g,"");_.isEmpty(i)||(new Asc.asc_CBullet).asc_putImageUrl(i)}}}).on("close",(function(){i.btnSelectImage.focus()})).show()}else 2==e.value?Common.NotificationCenter.trigger("storage:image-load","bullet"):(new Asc.asc_CBullet).asc_showFileDialog()},txtTitle:"List Settings",txtSize:"Size",txtColor:"Color",txtOfText:"% of text",txtStart:"Start at",textBulleted:"Bulleted",textNumbering:"Numbered",txtType:"Type",txtNone:"None",txtNewBullet:"New bullet",txtSymbol:"Symbol",txtNewImage:"New image",txtImage:"Image",txtImport:"Import",textSelect:"Select From",textFromUrl:"From URL",textFromFile:"From File",textFromStorage:"From Storage"},Common.Views.ListSettingsDialog||{}))})),define("common/main/lib/view/ExternalEditor",[],(function(){"use strict";Common.Views.ExternalEditor=Common.UI.Window.extend(_.extend({initialize:function(t){var e=Common.localStorage.getKeysFilter(),i=e&&e.length?e.split(",")[0]:"";this.storageName=i+(t.storageName||"external-editor");var s={},n=t.initwidth||900,a=t.initheight||700,o=Common.localStorage.getItem(this.storageName+"-width");o&&(n=parseInt(o)),(o=Common.localStorage.getItem(this.storageName+"-height"))&&(a=parseInt(o)),_.extend(s,{width:n,cls:"advanced-settings-dlg",header:!0,toolclose:"hide",toolcallback:_.bind(this.onToolClose,this),resizable:!0},t),s.contentHeight=a,this.template=['<div id="id-editor-container" class="box" style="height:'+s.contentHeight+'px; padding: 0 5px;">','<div id="'+(s.sdkplaceholder||"")+'" style="width: 100%;height: 100%;"></div>',"</div>",'<div class="separator horizontal"></div>','<div class="footer" style="text-align: center;">','<button id="id-btn-editor-apply" class="btn normal dlg-btn primary auto" result="ok" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textSave+"</button>",'<button id="id-btn-editor-cancel" class="btn normal dlg-btn" result="cancel" data-hint="1" data-hint-direction="bottom" data-hint-offset="big">'+this.textClose+"</button>","</div>"].join(""),s.tpl=_.template(this.template)(s),this.handler=s.handler,this._isNewObject=!0,this.on("resize",_.bind(this.onWindowResize,this)),Common.UI.Window.prototype.initialize.call(this,s)},render:function(){Common.UI.Window.prototype.render.call(this),this.boxEl=this.$window.find(".body > .box");var t=this.$window.find("> .body");this._headerFooterHeight=this.initConfig.header?parseInt(this.$window.find(".header").css("height")):0,this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom")),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width"));var e=Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top");e<this.initConfig.contentHeight+this._headerFooterHeight&&(this.initConfig.contentHeight=e-this._headerFooterHeight,this.boxEl.css("height",this.initConfig.contentHeight)),this.btnSave=new Common.UI.Button({el:this.$window.find("#id-btn-editor-apply"),disabled:!0}),this.btnCancel=new Common.UI.Button({el:this.$window.find("#id-btn-editor-cancel")}),this.$window.find(".dlg-btn").on("click",_.bind(this.onDlgBtnClick,this))},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},setEditMode:function(t){this._isNewObject=!t},isEditMode:function(){return!this._isNewObject},setControlsDisabled:function(t){this.btnSave.setDisabled(t),this.btnCancel.setDisabled(t),t?this.$window.find(".tool.close").addClass("disabled"):this.$window.find(".tool.close").removeClass("disabled")},onDlgBtnClick:function(t){this.handler?this.handler.call(this,t.currentTarget.attributes.result.value):this.hide()},onToolClose:function(){this.handler?this.handler.call(this,"cancel"):this.hide()},setHeight:function(t){if(t>=0){var e=parseInt(this.$window.css("min-height"));t<e&&(t=e),this.$window.height(t);var i=this.initConfig.header?parseInt(this.$window.find("> .header").css("height")):0;this.$window.find("> .body").css("height",t-i),this.$window.find("> .body > .box").css("height",t-this._headerFooterHeight)}},setInCenter:function(){var t=this.$window.height(),e=(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top")-parseInt(t))/2,i=(Common.Utils.innerWidth()-parseInt(this.initConfig.width))/2;this.$window.css("left",i),this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top")+e)},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),n=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),a=parseInt(this.boxEl.css("padding-left"))+parseInt(this.boxEl.css("padding-right"));i<(e+=90)+this._headerFooterHeight&&(e=i-this._headerFooterHeight),s<t+a+n&&(t=s-a-n),this.boxEl.css("height",e),this.setHeight(e+this._headerFooterHeight),this.setWidth(t+a+n),this.getLeft()<0&&this.$window.css("left",0),this.getTop()<Common.Utils.InternalSettings.get("window-inactive-area-top")&&this.$window.css("top",Common.Utils.InternalSettings.get("window-inactive-area-top"))},onWindowResize:function(t){if(t&&"end"==t[1]){var e=this.getSize();Common.localStorage.setItem(this.storageName+"-width",e[0]),Common.localStorage.setItem(this.storageName+"-height",e[1])}},textSave:"Save & Exit",textClose:"Close"},Common.Views.ExternalEditor||{}))})),define("common/main/lib/view/ExternalOleEditor",["common/main/lib/view/ExternalEditor"],(function(){"use strict";Common.Views.ExternalOleEditor=Common.Views.ExternalEditor.extend(_.extend({initialize:function(t){var e={};_.extend(e,{id:"id-external-ole-editor",title:this.textTitle,storageName:"ole-editor",sdkplaceholder:"id-ole-editor-placeholder",initwidth:1030,initheight:700,minwidth:1030,minheight:275},t),this._oleData=null,Common.Views.ExternalEditor.prototype.initialize.call(this,e)},setOleData:function(t){this._oleData=t,this._isExternalDocReady&&this.fireEvent("setoledata",this)},textTitle:"Spreadsheet Editor"},Common.Views.ExternalOleEditor||{}))})),define("common/main/lib/view/RenameDialog",[],(function(){"use strict";Common.Views.RenameDialog=Common.UI.Window.extend(_.extend({options:{width:330,header:!1,cls:"modal-dlg",filename:"",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,t||{}),this.template=['<div class="box">','<div class="input-row">',"<label>"+this.textName+"</label>","</div>",'<div id="id-dlg-newname" class="input-row"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputName=new Common.UI.InputField({el:$("#id-dlg-newname"),style:"width: 100%;",validateOnBlur:!1,maxLength:t.options.maxLength,validation:function(e){return!/[\t*\+:\"<>?|\\\\/]/gim.test(e)||t.txtInvalidName+'*+:"<>?|/'}});var e=this.getChild();e.find(".btn").on("click",_.bind(this.onBtnClick,this)),t.inputNameEl=e.find("input")},getFocusedComponents:function(){return[this.inputName].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this,e=t.options.filename.lastIndexOf(".");e>0&&(t.options.filename=t.options.filename.substring(0,e)),_.delay((function(){t.inputName.setValue(t.options.filename),t.inputNameEl.focus().select()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputName.checkValidate())return void this.inputNameEl.focus();this.options.handler.call(this,t,this.inputName.getValue())}this.close()},textName:"File name",txtInvalidName:"The file name cannot contain any of the following characters: "},Common.Views.RenameDialog||{}))})),define("common/main/lib/view/PasswordDialog",[],(function(){"use strict";Common.Views.PasswordDialog=Common.UI.Window.extend(_.extend({applyFunction:void 0,initialize:function(t){var e=this,i={};_.extend(i,{width:395,header:!0,cls:"modal-dlg",contentTemplate:"",title:e.txtTitle,buttons:["ok","cancel"]},t),this.handler=t.handler,this.template=t.template||['<div class="box">','<div class="input-row" style="margin-bottom: 10px;">',"<label>"+e.txtDescription+"</label>","</div>",'<div class="input-row">',"<label>"+e.txtPassword+(e.passwordOptional?" ("+e.txtOptional+")":"")+"</label>","</div>",'<div id="id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>',"<label>"+e.txtWarning+"</label>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.$window){var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#id-repeat-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#id-password-txt"),type:"password",allowBlank:!1,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1})}},getFocusedComponents:function(){return[this.inputPwd,this.repeatPwd].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputPwd},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue())}this.close()},txtTitle:"Set Password",txtPassword:"Password",txtDescription:"A Password is required to open this document",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place."},Common.Views.PasswordDialog||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginDlg",[],(function(){"use strict";Common.Views.PluginDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!0,enableKeyEvents:!1,automove:!1},t),this.bordersOffset=40,e.width=Common.Utils.innerWidth()-2*this.bordersOffset-e.width<0?Common.Utils.innerWidth()-2*this.bordersOffset:e.width,e.cls+=" advanced-settings-dlg invisible-borders",(!e.buttons||_.size(e.buttons)<1)&&(e.cls+=" no-footer"),e.contentHeight=e.height,e.height="auto",this.template=['<div id="id-plugin-container" class="box" style="height:'+e.contentHeight+'px;">','<div id="id-plugin-placeholder" style="width: 100%;height: 100%;"></div>',"</div>",'<% if ((typeof buttons !== "undefined") && _.size(buttons) > 0) { %>','<div class="separator horizontal"></div>',"<% } %>"].join(""),e.tpl=_.template(this.template)(e),this.url=t.url||"",this.loader=void 0===t.loader||t.loader,this.frameId=t.frameId||"plugin_iframe",this.guid=t.guid,Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.$window.find("> .body");t.css({height:"auto",overflow:"hidden"}),this.boxEl=this.$window.find(".body > .box"),this._headerFooterHeight=this.options.header?parseInt(this.$window.find(".header").css("height")):0,this.options.buttons&&_.size(this.options.buttons)>0&&(this._headerFooterHeight+=parseInt(this.$window.find(".footer").css("height"))+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),this._headerFooterHeight+=parseInt(this.$window.css("border-top-width"))+parseInt(this.$window.css("border-bottom-width")),Common.Utils.innerHeight()-2*this.bordersOffset<this.options.contentHeight+this._headerFooterHeight&&(this._restoreHeight=this.options.contentHeight+this._headerFooterHeight,this.options.contentHeight=Common.Utils.innerHeight()-2*this.bordersOffset-this._headerFooterHeight,this.boxEl.css("height",this.options.contentHeight)),this.$window.find(".header").prepend($('<div class="tools left hidden"></div>'));var e=document.createElement("iframe");e.id=this.frameId,e.name="pluginFrameEditor",e.width="100%",e.height="100%",e.align="top",e.frameBorder=0,e.scrolling="no",e.allow="camera; microphone; display-capture",e.onload=_.bind(this._onLoad,this);var i=this,s=this.$window.find("#id-plugin-placeholder");this.loader&&setTimeout((function(){i.isLoaded||(i.loadMask=new Common.UI.LoadMask({owner:s}),i.loadMask.setTitle(i.textLoading),i.loadMask.show(),i.isLoaded&&i.loadMask.hide())}),500),e.src=this.url,s.append(e),this.frame=e,this.on("resizing",(function(t){i.boxEl.css("height",parseInt(i.$window.css("height"))-i._headerFooterHeight)}));var n=function(){i.onWindowResize()};$(window).on("resize",n),this.on("close",(function(){$(window).off("resize",n)})),this.options.isCanDocked&&this.showDockedButton()},_onLoad:function(){this.isLoaded=!0,this.loadMask&&this.loadMask.hide()},setInnerSize:function(t,e){var i=Common.Utils.innerHeight(),s=Common.Utils.innerWidth(),n=parseInt(this.$window.css("border-left-width"))+parseInt(this.$window.css("border-right-width")),a=2*this.bordersOffset;i-a<e+this._headerFooterHeight&&(e=i-a-this._headerFooterHeight),s-a<t+n&&(t=s-a-n),this.boxEl.css("height",e),Common.UI.Window.prototype.setHeight.call(this,e+this._headerFooterHeight),Common.UI.Window.prototype.setWidth.call(this,t+n),this.$window.css("left",(s-t-n)/2),this.$window.css("top",(i-e-this._headerFooterHeight)/2),this._restoreHeight=this._restoreWidth=void 0},onWindowResize:function(){var t=Common.Utils.innerWidth(),e=Common.Utils.innerHeight(),i=this.getWidth(),s=this.getHeight(),n=this.resizable?0:this.bordersOffset;if(s<e-2*n+.1){if(!this.resizable&&this._restoreHeight>0&&s<this._restoreHeight){var a=Math.max(Math.min(this._restoreHeight,e-2*n),this.initConfig.minheight);this.setHeight(a),this.boxEl.css("height",a-this._headerFooterHeight)}var o=this.getTop();o<n?this.$window.css("top",n):o+s>e-n&&this.$window.css("top",e-n-s)}else void 0===this._restoreHeight&&(this._restoreHeight=s),this.setHeight(Math.max(e-2*n,this.initConfig.minheight)),this.boxEl.css("height",Math.max(e-2*n,this.initConfig.minheight)-this._headerFooterHeight),this.$window.css("top",n);if(i<t-2*n+.1){!this.resizable&&this._restoreWidth>0&&i<this._restoreWidth&&this.setWidth(Math.max(Math.min(this._restoreWidth,t-2*n),this.initConfig.minwidth));var l=this.getLeft();l<n?this.$window.css("left",n):l+i>t-n&&this.$window.css("left",t-n-i)}else void 0===this._restoreWidth&&(this._restoreWidth=i),this.setWidth(Math.max(t-2*n,this.initConfig.minwidth)),this.$window.css("left",n)},showDockedButton:function(){var t=this.$window.find(".header .tools:not(.left)"),e="id-plugindlg-docked",i=t.find("#"+e);if(i.length<1){(i=$('<div id="'+e+'" class="tool custom toolbar__icon btn-pin"></div>')).on("click",_.bind((function(){var t=i.data("bs.tooltip");t&&(t.dontShow=!0),this.fireEvent("docked",this.frameId)}),this)),t.append(i),i.tooltip({title:this.textDock,placement:"cursor",zIndex:parseInt(this.$window.css("z-index"))+10})}i.show(),t.removeClass("hidden")},showButton:function(t,e){var i=this.$window.find(e?".header .tools:not(.left)":".header .tools.left"),s=i.find("#id-plugindlg-"+t);if(s.length<1){var n="back"===t?"btn-promote":"btn-"+Common.Utils.String.htmlEncode(t);(s=$('<div id="id-plugindlg-'+t+'" class="tool custom toolbar__icon '+n+'"></div>')).on("click",_.bind((function(){this.fireEvent("header:click",t)}),this)),i.append(s)}s.show(),i.removeClass("hidden")},hideButton:function(t){var e=this.$window.find(".header #id-plugindlg-"+t);e.length>0&&e.hide()},enablePointerEvents:function(t){this.frame&&(this.frame.style.pointerEvents=t?"":"none")},textLoading:"Loading",textDock:"Pin plugin"},Common.Views.PluginDlg||{}))})),void 0===Common)Common={};if(Common.Views=Common.Views||{},define("common/main/lib/view/PluginPanel",[],(function(){"use strict";Common.Views.PluginPanel=Common.UI.BaseView.extend(_.extend({template:_.template(['<div class="current-plugin-box layout-ct vbox">','<div class="current-plugin-frame">',"</div>",'<div class="current-plugin-header">','<div class="tools">','<div class="plugin-close close"></div>','<div class="plugin-hide"></div>',"</div>","<label></label>","</div>","</div>",'<div id="plugins-mask" style="display: none;">'].join("")),initialize:function(t){_.extend(this,t),this._state={},this.menu||(this.menu="left"),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t&&(this.$el=$(t)),this.$el.html(this.template({scope:this})),this.pluginName=$(".current-plugin-header label",this.$el),this.pluginsMask=$("#plugins-mask",this.$el),this.currentPluginPanel=$(".current-plugin-box",this.$el),this.currentPluginFrame=$(".current-plugin-frame",this.$el),this.pluginClose=new Common.UI.Button({parentEl:this.$el.find(".plugin-close"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.textClosePanel}),this.sideMenuButton&&(this.pluginHide=new Common.UI.Button({parentEl:this.$el.find(".plugin-hide"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-panel-left-collapse",hint:this.textHidePanel})),this.isCanDocked&&this.showDockedButton(),this.trigger("render:after",this),this},showDockedButton:function(){var t=this.$el.find(".current-plugin-header .tools"),e="plugin-undock",i=t.find("."+e);i.length<1&&(i=$('<div class="'+e+'"></div>'),this.$el.find(".plugin-close").after(i),new Common.UI.Button({parentEl:this.$el.find("."+e),cls:"btn-toolbar",iconCls:"toolbar__icon btn-unpin",hint:this.textUndock}).on("click",_.bind((function(){this.fireEvent("docked",this.iframePlugin.id)}),this)));i.show(),t.removeClass("hidden")},openInsideMode:function(t,e,i,s){return this.pluginName||this.render(),this.pluginName.text(t),this.iframePlugin||(this.iframePlugin=document.createElement("iframe"),this.iframePlugin.id=void 0===i?"plugin_iframe":i,this.iframePlugin.name="pluginFrameEditor",this.iframePlugin.width="100%",this.iframePlugin.height="100%",this.iframePlugin.align="top",this.iframePlugin.frameBorder=0,this.iframePlugin.scrolling="no",this.iframePlugin.allow="camera; microphone; display-capture",this.iframePlugin.onload=_.bind(this._onLoad,this),this.currentPluginFrame.append(this.iframePlugin),this.loadMask||(this.loadMask=new Common.UI.LoadMask({owner:this.currentPluginFrame})),this.loadMask.setTitle(this.textLoading),this.loadMask.show(),this.iframePlugin.src=e),this._state.insidePlugin=s,!0},closeInsideMode:function(){this.iframePlugin&&(this.currentPluginFrame.empty(),this.iframePlugin=null),this._state.insidePlugin=void 0},_onLoad:function(){this.loadMask&&this.loadMask.hide()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},enablePointerEvents:function(t){this.iframePlugin&&(this.iframePlugin.style.pointerEvents=t?"":"none")},textClosePanel:"Close plugin",textLoading:"Loading",textUndock:"Unpin plugin",textHidePanel:"Collapse plugin"},Common.Views.PluginPanel||{}))})),define("common/main/lib/view/ShapeShadowDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";Common.Views.ShapeShadowDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ShapeShadowDialog",contentWidth:230,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px;",contentTemplate:['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="header">'+e.txtTransparency+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-transparency-slider" style="display: inline-block"></div>','<div id="shape-shadow-transparency-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtSize+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-size-slider" style="display: inline-block"></div>','<div id="shape-shadow-size-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtAngle+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-angle-slider" style="display: inline-block"></div>','<div id="shape-shadow-angle-spin"></div>',"</div>","</td>","</tr>","<tr>","<td>",'<label class="header">'+e.txtDistance+"</label>",'<div style="display: flex; align-items: center; justify-content: space-between;">','<div id="shape-shadow-distance-slider" style="display: inline-block"></div>','<div id="shape-shadow-distance-spin"></div>',"</div>","</td>","</tr>","</table>","</div>","</div>"].join("")},t),this.handler=t.handler,this.api=t.api,this.shadowProps=t.shadowProps,this.methodApplySettings=t.methodApplySettings,this.isShadowEmpty=!this.shadowProps,this.shadowProps||(this.shadowProps=new Asc.asc_CShadowProperty,this.shadowProps.putPreset("t")),this.oldTransparency=this.shadowProps.getTransparency(),this.oldSize=this.shadowProps.getSize(),this.oldAngle=this.shadowProps.getAngle(),this.oldDistance=this._mm2pt(this.shadowProps.getDistance()),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){if(Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.api.setStartPointHistory(),this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,t)}this.sldrTransparency=new Common.UI.SingleSlider({el:$("#shape-shadow-transparency-slider"),width:128,minValue:0,maxValue:100,value:this.oldTransparency}),this.sldrTransparency.on("change",_.bind(this.onSliderTransparencyChange,this)),this.spinTransparency=new Common.UI.MetricSpinner({el:$("#shape-shadow-transparency-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:100,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinTransparency.setValue(this.oldTransparency,!0),this.spinTransparency.on("change",_.bind(this.onSpinnerTransparencyChange,this)),this.sldrSize=new Common.UI.SingleSlider({el:$("#shape-shadow-size-slider"),width:128,minValue:1,maxValue:200,value:this.oldSize}),this.sldrSize.on("change",_.bind(this.onSliderSizeChange,this)),this.spinSize=new Common.UI.MetricSpinner({el:$("#shape-shadow-size-spin"),step:1,width:62,allowDecimal:!1,value:"0 %",defaultUnit:"%",maxValue:200,minValue:1,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinSize.setValue(this.oldSize,!0),this.spinSize.on("change",_.bind(this.onSpinnerSizeChange,this)),this.sldrAngle=new Common.UI.SingleSlider({el:$("#shape-shadow-angle-slider"),width:128,minValue:0,maxValue:359,value:this.oldAngle}),this.sldrAngle.on("change",_.bind(this.onSliderAngleChange,this)),this.spinAngle=new Common.UI.MetricSpinner({el:$("#shape-shadow-angle-spin"),step:1,width:62,allowDecimal:!1,value:"0 ",defaultUnit:"",maxValue:359,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinAngle.setValue(this.oldAngle,!0),this.spinAngle.on("change",_.bind(this.onSpinnerAngleChange,this)),this.sldrDistance=new Common.UI.SingleSlider({el:$("#shape-shadow-distance-slider"),width:128,minValue:0,maxValue:200,value:this.oldDistance}),this.sldrDistance.on("change",_.bind(this.onSliderDistanceChange,this));var e=Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt);this.spinDistance=new Common.UI.MetricSpinner({el:$("#shape-shadow-distance-spin"),step:1,width:62,allowDecimal:!1,value:"0 "+e,defaultUnit:e,maxValue:200,minValue:0,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spinDistance.setValue(this.oldDistance,!0),this.spinDistance.on("change",_.bind(this.onSpinnerDistanceChange,this)),this.on("close",_.bind(this.handleCancelClose,this))},onSliderTransparencyChange:function(t,e,i){this.spinTransparency.setValue(e,!0),this.setTransparency(e)},onSpinnerTransparencyChange:function(t,e,i){var s=t.getNumberValue();this.sldrTransparency.setValue(s,!0),this.setTransparency(s)},setTransparency:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderSizeChange:function(t,e,i){this.spinSize.setValue(e,!0),this.setSize(e)},onSpinnerSizeChange:function(t,e,i){var s=t.getNumberValue();this.sldrSize.setValue(s,!0),this.setSize(s)},setSize:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putSize(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderAngleChange:function(t,e,i){this.spinAngle.setValue(e,!0),this.setAngle(e)},onSpinnerAngleChange:function(t,e,i){var s=t.getNumberValue();this.sldrAngle.setValue(s,!0),this.setAngle(s)},setAngle:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putAngle(t),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},onSliderDistanceChange:function(t,e,i){this.spinDistance.setValue(e,!0),this.setDistance(e)},onSpinnerDistanceChange:function(t,e,i){var s=t.getNumberValue();this.sldrDistance.setValue(s,!0),this.setDistance(s)},setDistance:function(t){var e=new Asc.asc_CShapeProperty;this.shadowProps.putDistance(this._pt2mm(t)),e.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,e)},setAllProperties:function(t,e,i,s){var n=new Asc.asc_CShapeProperty;this.shadowProps.putTransparency(t),this.shadowProps.putSize(e),this.shadowProps.putAngle(i),this.shadowProps.putDistance(this._pt2mm(s)),n.asc_putShadow(this.shadowProps),this.methodApplySettings&&this.methodApplySettings.call(this,n)},getFocusedComponents:function(){return[this.spinTransparency,this.spinSize,this.spinAngle,this.spinDistance].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spinTransparency},_pt2mm:function(t){return 25.4*t/72},_mm2pt:function(t){return 72*t/25.4},onPrimary:function(){return this.handleOkClose(),this.close(!0),!1},onDlgBtnClick:function(t){"ok"==t.currentTarget.attributes.result.value?this.handleOkClose():this.handleCancelClose(),this.close(!0)},onDblClickFunction:function(){this.handleOkClose(),this.close(!0)},handleOkClose:function(){this.api.setEndPointHistory(),this.setAllProperties(parseInt(this.spinTransparency.getValue()),parseInt(this.spinSize.getValue()),parseInt(this.spinAngle.getValue()),parseInt(this.spinDistance.getValue())),this.handler&&this.handler.call(this,"ok")},handleCancelClose:function(){if(this.isShadowEmpty){var t=new Asc.asc_CShapeProperty;t.asc_putShadow(null),this.methodApplySettings&&this.methodApplySettings.call(this,t)}else this.setAllProperties(this.oldTransparency,this.oldSize,this.oldAngle,this.oldDistance);this.api.setEndPointHistory(),this.handler&&this.handler.call(this,"cancel")},txtTitle:"Adjust Shadow",txtTransparency:"Transparency",txtSize:"Size",txtAngle:"Angle",txtDistance:"Distance"},Common.Views.ShapeShadowDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/CustomizeQuickAccessDialog",[],(function(){"use strict";Common.Views.CustomizeQuickAccessDialog=Common.UI.Window.extend(_.extend({options:{width:296,style:"min-width: 296px;",cls:"modal-dlg quick-access-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<label class="padding-medium">'+this.textMsg+"</label>",'<div class="padding-small" id="quick-access-chb-save"></div>','<div class="padding-small" id="quick-access-chb-print"></div>','<div class="padding-small" id="quick-access-chb-quick-print" style="display:none;"></div>','<div class="padding-small" id="quick-access-chb-undo"></div>','<div class="padding-small" id="quick-access-chb-redo"></div>','<div class="padding-small" id="quick-access-chb-start-over" style="display:none;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.focusedComponents=[],this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.options.showSave&&(this.chSave=new Common.UI.CheckBox({el:$("#quick-access-chb-save"),labelText:this.options.mode&&(this.options.mode.canSaveToFile||this.options.mode.isDesktopApp&&this.options.mode.isOffline)?this.textSave:this.textDownload,value:this.props.save}),this.focusedComponents.push(this.chSave)),this.options.showPrint&&(this.chPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-print"),labelText:this.textPrint,value:this.props.print}),this.focusedComponents.push(this.chPrint)),this.options.showQuickPrint&&(this.chQuickPrint=new Common.UI.CheckBox({el:$("#quick-access-chb-quick-print"),labelText:this.textQuickPrint,value:this.props.quickPrint}),this.focusedComponents.push(this.chQuickPrint),this.chQuickPrint.show()),this.chUndo=new Common.UI.CheckBox({el:$("#quick-access-chb-undo"),labelText:this.textUndo,value:this.props.undo}),this.focusedComponents.push(this.chUndo),this.chRedo=new Common.UI.CheckBox({el:$("#quick-access-chb-redo"),labelText:this.textRedo,value:this.props.redo}),this.focusedComponents.push(this.chRedo),window.PE&&(this.chStartOver=new Common.UI.CheckBox({el:$("#quick-access-chb-start-over"),labelText:this.textStartOver,value:this.props.startOver}),this.focusedComponents.push(this.chStartOver),this.chStartOver.show())},getFocusedComponents:function(){return this.focusedComponents.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.focusedComponents[0]},onBtnClick:function(t){"ok"===t.currentTarget.attributes.result.value&&Common.NotificationCenter.trigger("quickaccess:changed",{save:this.chSave?"checked"===this.chSave.getValue():void 0,print:this.chPrint?"checked"===this.chPrint.getValue():void 0,quickPrint:this.chQuickPrint?"checked"===this.chQuickPrint.getValue():void 0,undo:"checked"===this.chUndo.getValue(),redo:"checked"===this.chRedo.getValue(),startOver:this.chStartOver?"checked"===this.chStartOver.getValue():void 0}),this.close()},textTitle:"Customize quick access",textMsg:"Check the commands that will be displayed on the Quick Access Toolbar",textSave:"Save",textPrint:"Print",textQuickPrint:"Quick Print",textUndo:"Undo",textRedo:"Redo",textDownload:"Download file"},Common.Views.CustomizeQuickAccessDialog||{}))})),define("common/main/lib/view/TextInputDialog",[],(function(){"use strict";Common.Views.TextInputDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{header:!!t.title,label:t.label||"",description:t.description||"",width:330,cls:"modal-dlg",buttons:["ok","cancel"]},t||{}),this.template=['<div class="box">','<div class="input-row <% if (!label) { %> hidden <% } %>">',"<label><%= label %></label>","</div>",'<div id="id-dlg-label-custom-input" class="input-row"></div>','<div class="input-row <% if (!description) { %> hidden <% } %>">','<label class="light"><%= description %></label>',"</div>","</div>"].join(""),this.inputConfig=_.extend({allowBlank:!0},t.inputConfig||{}),this.inputFixedConfig=t.inputFixedConfig,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;t.inputLabel=this.inputFixedConfig?new Common.UI.InputFieldFixed({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputFixedConfig.fixedValue&&t.inputConfig.maxLength?t.inputConfig.maxLength-t.inputFixedConfig.fixedValue.length:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation,cls:"text-align-left",fixedValue:t.inputFixedConfig.fixedValue,fixedCls:"light",fixedWidth:t.inputFixedConfig.fixedWidth}):new Common.UI.InputField({el:$("#id-dlg-label-custom-input"),allowBlank:t.inputConfig.allowBlank,blankError:t.inputConfig.blankError,maxLength:t.inputConfig.maxLength,style:"width: 100%;",validateOnBlur:!1,validation:t.inputConfig.validation}),t.inputLabel.cmpEl.on("focus","input.fixed-text",(function(){setTimeout((function(){t.inputLabel._input&&t.inputLabel._input.focus()}),1)})),t.inputLabel.setValue(t.options.value||""),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[{cmp:this.inputLabel,selector:"input:not(.fixed-text)"}].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputLabel},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.getChild("input").focus()}),50)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputLabel.checkValidate())return void this.inputLabel.cmpEl.find("input").focus();this.options.handler.call(this,t,this.inputLabel.getValue())}this.close()}},Common.Views.TextInputDialog||{})),Common.Views.ImageFromUrlDialog=Common.Views.TextInputDialog.extend(_.extend({initialize:function(t){var e={},i=this;_.extend(e,{header:!1,label:t.label||i.textUrl,inputConfig:{allowBlank:!1,blankError:i.txtEmpty,validation:function(t){return!!/((^https?)|(^ftp)):\/\/.+/i.test(t)||i.txtNotUrl}}},t||{}),Common.Views.TextInputDialog.prototype.initialize.call(this,e)},textUrl:"Paste an image URL:",txtEmpty:"This field is required",txtNotUrl:'This field should be a URL in the format "http://www.example.com"'},Common.Views.ImageFromUrlDialog||{}))})),define("common/main/lib/view/DocumentHolderExt",[],(function(){"use strict";var t=window.DE||window.PDFE||window.PDFE||window.PE||window.SSE||window.VE;if(t&&t.Views&&t.Views.DocumentHolder){var e=t.Views.DocumentHolder.prototype;e.addEquationMenu=function(t,e){if(t){var i=this;i.clearEquationMenu(t,e);var s=i.initEquationMenu();return s.length>0&&_.each(s,(function(s,n){s.menu?_.each(s.menu.items,(function(t){t.on("click",_.bind(i.equationCallback,i,t.options.equationProps))})):s.on("click",_.bind(i.equationCallback,i,s.options.equationProps)),t.insertItem(e,s),e++})),s.length}},e.clearEquationMenu=function(t,e){for(var i=e;i<t.items.length&&t.items[i].options.equation;i++)t.items[i].menu?_.each(t.items[i].menu.items,(function(t){t.off("click")})):t.items[i].off("click"),t.removeItem(t.items[i]),i--},e.equationCallback=function(t){var e;if(t){switch(t.type){case Asc.c_oAscMathInterfaceType.Accent:e=new CMathMenuAccent;break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new CMathMenuBorderBox;break;case Asc.c_oAscMathInterfaceType.Box:e=new CMathMenuBox;break;case Asc.c_oAscMathInterfaceType.Bar:e=new CMathMenuBar;break;case Asc.c_oAscMathInterfaceType.Script:e=new CMathMenuScript;break;case Asc.c_oAscMathInterfaceType.Fraction:e=new CMathMenuFraction;break;case Asc.c_oAscMathInterfaceType.Limit:e=new CMathMenuLimit;break;case Asc.c_oAscMathInterfaceType.Matrix:e=new CMathMenuMatrix;break;case Asc.c_oAscMathInterfaceType.EqArray:e=new CMathMenuEqArray;break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new CMathMenuNary;break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new CMathMenuDelimiter;break;case Asc.c_oAscMathInterfaceType.GroupChar:e=new CMathMenuGroupCharacter;break;case Asc.c_oAscMathInterfaceType.Radical:e=new CMathMenuRadical;break;case Asc.c_oAscMathInterfaceType.Common:e=new CMathMenuBase}e&&e[t.callback](t.value)}this.fireEvent("equation:callback",[e])},e.initEquationMenu=function(){var t=this._currentTranslateObj;if(t._currentMathObj){var e,i=t._currentMathObj.get_Type(),s=t._currentMathObj,n=[];switch(i){case Asc.c_oAscMathInterfaceType.Accent:e=new Common.UI.MenuItem({caption:t.txtRemoveAccentChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_AccentCharacter"}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.BorderBox:e=new Common.UI.MenuItem({caption:t.txtBorderProps,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:s.get_HideTop()?t.txtAddTop:t.txtHideTop,equationProps:{type:i,callback:"put_HideTop",value:!s.get_HideTop()}},{caption:s.get_HideBottom()?t.txtAddBottom:t.txtHideBottom,equationProps:{type:i,callback:"put_HideBottom",value:!s.get_HideBottom()}},{caption:s.get_HideLeft()?t.txtAddLeft:t.txtHideLeft,equationProps:{type:i,callback:"put_HideLeft",value:!s.get_HideLeft()}},{caption:s.get_HideRight()?t.txtAddRight:t.txtHideRight,equationProps:{type:i,callback:"put_HideRight",value:!s.get_HideRight()}},{caption:s.get_HideHor()?t.txtAddHor:t.txtHideHor,equationProps:{type:i,callback:"put_HideHor",value:!s.get_HideHor()}},{caption:s.get_HideVer()?t.txtAddVer:t.txtHideVer,equationProps:{type:i,callback:"put_HideVer",value:!s.get_HideVer()}},{caption:s.get_HideTopLTR()?t.txtAddLT:t.txtHideLT,equationProps:{type:i,callback:"put_HideTopLTR",value:!s.get_HideTopLTR()}},{caption:s.get_HideTopRTL()?t.txtAddLB:t.txtHideLB,equationProps:{type:i,callback:"put_HideTopRTL",value:!s.get_HideTopRTL()}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Bar:e=new Common.UI.MenuItem({caption:t.txtRemoveBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Bar"}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?t.txtUnderbar:t.txtOverbar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceBarPos.Top?Asc.c_oAscMathInterfaceBarPos.Bottom:Asc.c_oAscMathInterfaceBarPos.Top}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Script:var a=s.get_ScriptType();a==Asc.c_oAscMathInterfaceScript.PreSubSup?(e=new Common.UI.MenuItem({caption:t.txtScriptsAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.SubSup}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtRemScripts,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)):(a==Asc.c_oAscMathInterfaceScript.SubSup&&(e=new Common.UI.MenuItem({caption:t.txtScriptsBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:Asc.c_oAscMathInterfaceScript.PreSubSup}}),n.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sub||(e=new Common.UI.MenuItem({caption:t.txtRemSubscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sup:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)),a!=Asc.c_oAscMathInterfaceScript.SubSup&&a!=Asc.c_oAscMathInterfaceScript.Sup||(e=new Common.UI.MenuItem({caption:t.txtRemSuperscript,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_ScriptType",value:a==Asc.c_oAscMathInterfaceScript.SubSup?Asc.c_oAscMathInterfaceScript.Sub:Asc.c_oAscMathInterfaceScript.None}}),n.push(e)));break;case Asc.c_oAscMathInterfaceType.Fraction:var o=s.get_FractionType();o!=Asc.c_oAscMathInterfaceFraction.Skewed&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionStacked,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Bar}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Linear||(e=new Common.UI.MenuItem({caption:t.txtFractionSkewed,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Skewed}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.Skewed||(e=new Common.UI.MenuItem({caption:t.txtFractionLinear,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:Asc.c_oAscMathInterfaceFraction.Linear}}),n.push(e)),o!=Asc.c_oAscMathInterfaceFraction.Bar&&o!=Asc.c_oAscMathInterfaceFraction.NoBar||(e=new Common.UI.MenuItem({caption:o==Asc.c_oAscMathInterfaceFraction.Bar?t.txtRemFractionBar:t.txtAddFractionBar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_FractionType",value:o==Asc.c_oAscMathInterfaceFraction.Bar?Asc.c_oAscMathInterfaceFraction.NoBar:Asc.c_oAscMathInterfaceFraction.Bar}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Limit:e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?t.txtLimitUnder:t.txtLimitOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceLimitPos.Top?Asc.c_oAscMathInterfaceLimitPos.Bottom:Asc.c_oAscMathInterfaceLimitPos.Top}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtRemLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceLimitPos.None}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.Matrix:e=new Common.UI.MenuItem({caption:s.get_HidePlaceholder()?t.txtShowPlaceholder:t.txtHidePlaceholder,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HidePlaceholder",value:!s.get_HidePlaceholder()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.insertText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,equationProps:{type:i,callback:"insert_MatrixRow",value:!0}},{caption:t.insertRowBelowText,equationProps:{type:i,callback:"insert_MatrixRow",value:!1}},{caption:t.insertColumnLeftText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!0}},{caption:t.insertColumnRightText,equationProps:{type:i,callback:"insert_MatrixColumn",value:!1}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.deleteText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.deleteRowText,equationProps:{type:i,callback:"delete_MatrixRow"}},{caption:t.deleteColumnText,equationProps:{type:i,callback:"delete_MatrixColumn"}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtMatrixAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Top}},{caption:t.centerText,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:s.get_MatrixAlign()==Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom,equationProps:{type:i,callback:"put_MatrixAlign",value:Asc.c_oAscMathInterfaceMatrixMatrixAlign.Bottom}}]})}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtColumnAlign,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.leftText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Left,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Left}},{caption:t.centerText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Center,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Center}},{caption:t.rightText,checkable:!0,checked:s.get_ColumnAlign()==Asc.c_oAscMathInterfaceMatrixColumnAlign.Right,equationProps:{type:i,callback:"put_ColumnAlign",value:Asc.c_oAscMathInterfaceMatrixColumnAlign.Right}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.EqArray:e=new Common.UI.MenuItem({caption:t.txtInsertEqBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!0}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertEqAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_Equation",value:!1}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteEq,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_Equation"}}),n.push(e),e=new Common.UI.MenuItem({caption:t.alignmentText,equation:!0,disabled:t._currentParaObjDisabled,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtTop,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Top,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Top}},{caption:t.centerText,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Center,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Center}},{caption:t.txtBottom,checkable:!0,checked:s.get_Align()==Asc.c_oAscMathInterfaceEqArrayAlign.Bottom,equationProps:{type:i,callback:"put_Align",value:Asc.c_oAscMathInterfaceEqArrayAlign.Bottom}}]})}),n.push(e);break;case Asc.c_oAscMathInterfaceType.LargeOperator:e=new Common.UI.MenuItem({caption:t.txtLimitChange,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_LimitLocation",value:s.get_LimitLocation()==Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr?Asc.c_oAscMathInterfaceNaryLimitLocation.SubSup:Asc.c_oAscMathInterfaceNaryLimitLocation.UndOvr}}),n.push(e),void 0!==s.get_HideUpper()&&(e=new Common.UI.MenuItem({caption:s.get_HideUpper()?t.txtShowTopLimit:t.txtHideTopLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideUpper",value:!s.get_HideUpper()}}),n.push(e)),void 0!==s.get_HideLower()&&(e=new Common.UI.MenuItem({caption:s.get_HideLower()?t.txtShowBottomLimit:t.txtHideBottomLimit,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideLower",value:!s.get_HideLower()}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Delimiter:e=new Common.UI.MenuItem({caption:t.txtInsertArgBefore,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!0}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtInsertArgAfter,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_DelimiterArgument",value:!1}}),n.push(e),s.can_DeleteArgument()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_DelimiterArgument"}}),n.push(e)),e=new Common.UI.MenuItem({caption:s.has_Separators()?t.txtDeleteCharsAndSeparators:t.txtDeleteChars,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_DelimiterCharacters"}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_HideOpeningBracket()?t.txtShowOpenBracket:t.txtHideOpenBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideOpeningBracket",value:!s.get_HideOpeningBracket()}}),n.push(e),e=new Common.UI.MenuItem({caption:s.get_HideClosingBracket()?t.txtShowCloseBracket:t.txtHideCloseBracket,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideClosingBracket",value:!s.get_HideClosingBracket()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtStretchBrackets,equation:!0,disabled:t._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets(),equationProps:{type:i,callback:"put_StretchBrackets",value:!s.get_StretchBrackets()}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtMatchBrackets,equation:!0,disabled:!s.get_StretchBrackets()||t._currentParaObjDisabled,checkable:!0,checked:s.get_StretchBrackets()&&s.get_MatchBrackets(),equationProps:{type:i,callback:"put_MatchBrackets",value:!s.get_MatchBrackets()}}),n.push(e);break;case Asc.c_oAscMathInterfaceType.GroupChar:s.can_ChangePos()&&(e=new Common.UI.MenuItem({caption:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?t.txtGroupCharUnder:t.txtGroupCharOver,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:s.get_Pos()==Asc.c_oAscMathInterfaceGroupCharPos.Top?Asc.c_oAscMathInterfaceGroupCharPos.Bottom:Asc.c_oAscMathInterfaceGroupCharPos.Top}}),n.push(e),e=new Common.UI.MenuItem({caption:t.txtDeleteGroupChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_Pos",value:Asc.c_oAscMathInterfaceGroupCharPos.None}}),n.push(e));break;case Asc.c_oAscMathInterfaceType.Radical:void 0!==s.get_HideDegree()&&(e=new Common.UI.MenuItem({caption:s.get_HideDegree()?t.txtShowDegree:t.txtHideDegree,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"put_HideDegree",value:!s.get_HideDegree()}}),n.push(e)),e=new Common.UI.MenuItem({caption:t.txtDeleteRadical,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"remove_Radical"}}),n.push(e)}return s.can_IncreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtIncreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"increase_ArgumentSize"}}),n.push(e)),s.can_DecreaseArgumentSize()&&(e=new Common.UI.MenuItem({caption:t.txtDecreaseArg,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"decrease_ArgumentSize"}}),n.push(e)),s.can_InsertManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtInsertBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"insert_ManualBreak"}}),n.push(e)),s.can_DeleteManualBreak()&&(e=new Common.UI.MenuItem({caption:t.txtDeleteBreak,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"delete_ManualBreak"}}),n.push(e)),s.can_AlignToCharacter()&&(e=new Common.UI.MenuItem({caption:t.txtAlignToChar,equation:!0,disabled:t._currentParaObjDisabled,equationProps:{type:i,callback:"align_ToCharacter"}}),n.push(e)),n}},e.updateCustomItems=function(t,e){if(t&&e&&!(e.length<1)){var i=this,s=i.mode&&i.mode.lang?i.mode.lang.split(/[\-_]/)[0]:"en";i._preventCustomClick&&clearTimeout(i._preventCustomClick),i._hasCustomItems&&(i._preventCustomClick=setTimeout((function(){i._preventCustomClick=null}),500)),i._hasCustomItems=!0;var n,a=function(e,i){if(t&&t.items.length>0)for(var s=t.items.length-1;s>=0;s--)if(t.items[s].isCustomItem&&(void 0===i&&t.items[s].options.guid===e||t.items[s].options.guid===e&&t.items[s].value===i))return t.items[s]},o=function(t,e,n){var a=!1;return n?n.removeAll():((n=new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[]})).on("item:custom-click",(function(t,e,s){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(e.options.guid,e.value)})),n.on("menu:click",(function(t,e){i._preventCustomClick&&e.stopPropagation()}))),t.forEach((function(t){t.separator&&n.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e})),t.text&&n.addItem(new Common.UI.MenuItemCustom({caption:("object"==_typeof(t.text)?t.text[s]||t.text.en:t.text)||"",value:t.id,guid:e,menu:!!t.items&&o(t.items,e),iconsSet:t.icons,baseUrl:"",disabled:!!t.disabled})),a=a||!!t.icons})),a&&(n.cmpEl?n.cmpEl.toggleClass("shifted-right",!0):n.options.cls="shifted-right"),n};if(e.forEach((function(e){var l=!a(e.guid);e&&e.items&&e.items.length>0&&e.items.forEach((function(r){if(r.separator&&l&&t.addItem(new Common.UI.MenuItemCustom({caption:"--",guid:e.guid})),r.text){var c=a(e.guid,r.id),d=("object"==_typeof(r.text)?r.text[s]||r.text.en:r.text)||"";if(c)c.setCaption(d),c.setDisabled(!!r.disabled),r.items&&(c.menu?(c.menu.isVisible()&&c.menu.cmpEl.find(" > li:not(.divider):not(.disabled):visible").find("> a").filter(":focus").length>0&&(c.menu.isOver=!0,n=c.cmpEl),o(r.items,e.guid,c.menu)):c.setMenu(o(r.items,e.guid)));else{c=new Common.UI.MenuItemCustom({caption:d,value:r.id,guid:e.guid,menu:!!(r.items&&r.items.length>=0)&&o(r.items,e.guid),iconsSet:r.icons,baseUrl:"",disabled:!!r.disabled}).on("click",(function(t,e){!i._preventCustomClick&&i.api&&i.api.onPluginContextMenuItemClick&&i.api.onPluginContextMenuItemClick(t.options.guid,t.value)}));t.addItem(c)}}}))})),n){var l=$("> [role=menu]",n).find("> li:not(.divider):not(.disabled):visible > a");l.length>0&&l.eq(0).focus()}t.alignPosition()}},e.clearCustomItems=function(t){if(t&&t.items.length>0)for(var e=0;e<t.items.length;e++)t.items[e].isCustomItem&&(t.removeItem(t.items[e]),e--);this._hasCustomItems=!1}}})),void 0===Common)Common={};if(define("common/main/lib/view/SignDialog",[],(function(){"use strict";Common.Views.SignDialog=Common.UI.Window.extend(_.extend({options:{width:370,style:"min-width: 350px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.signType=this.options.signType||"invisible",this.signSize=this.options.signSize||{width:0,height:0},this.certificateId=null,this.signObject=null,this.fontStore=this.options.fontStore,this.font={size:11,name:"Arial",bold:!1,italic:!1};var e=Common.localStorage.getKeysFilter();this.appPrefix=e&&e.length?e.split(",")[0]:"",this.template=['<div class="box" style="height: '+("invisible"==this.signType?"132px;":"300px;")+'">','<div id="id-dlg-sign-invisible">','<div class="input-row">',"<label>"+this.textPurpose+"</label>","</div>",'<div id="id-dlg-sign-purpose" class="input-row"></div>',"</div>",'<div id="id-dlg-sign-visible">','<div class="input-row">',"<label>"+this.textInputName+"</label>","</div>",'<div id="id-dlg-sign-name" class="input-row" style="margin-bottom: 5px;"></div>','<div id="id-dlg-sign-fonts" class="input-row" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-font-size" class="input-row margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-bold" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div id="id-dlg-sign-italic" class="margin-left-3" style="display: inline-block;vertical-align: middle;"></div>','<div style="margin: 10px 0 5px 0;">',"<label>"+this.textUseImage+"</label>","</div>",'<button id="id-dlg-sign-image" class="btn btn-text-default auto">'+this.textSelectImage+"</button>",'<div class="input-row" style="margin-top: 10px;">','<label class="font-weight-bold">'+this.textSignature+"</label>","</div>",'<div style="border: 1px solid #cbcbcb;"><div id="signature-preview-img" style="width: 100%; height: 50px;position: relative;"></div></div>',"</div>",'<table style="margin-top: 30px;">',"<tr>",'<td><label class="font-weight-bold" style="margin-bottom: 3px;">'+this.textCertificate+'</label></td><td rowspan="2" class="padding-left-20" style="vertical-align: top;"><button id="id-dlg-sign-change" class="btn btn-text-default float-right">'+this.textSelect+"</button></td>","</tr>",'<tr><td><div id="id-dlg-sign-certificate" class="hidden" style="max-width: 240px;overflow: hidden;white-space: nowrap;"></td></tr>',"</table>","</div>"].join(""),this.templateCertificate=_.template(['<label style="display: block;margin-bottom: 3px;overflow: hidden;text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(name) %></label>','<label style="display: block;"><%= Common.Utils.String.htmlEncode(valid) %></label>'].join("")),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputPurpose=new Common.UI.InputField({el:$("#id-dlg-sign-purpose"),style:"width: 100%;"}),t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-name"),style:"width: 100%;",validateOnChange:!0}).on("changing",_.bind(t.onChangeName,t)),t.cmbFonts=new Common.UI.ComboBoxFonts({el:$("#id-dlg-sign-fonts"),cls:"input-group-nr",style:"width: 230px;",menuCls:"scrollable-menu",menuStyle:"min-width: 230px;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,takeFocusOnClose:!0,hint:t.tipFontName}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),i.name,t.font.size,t.font.italic,t.font.bold),t.font.name=i.name})),this.cmbFontSize=new Common.UI.ComboBox({el:$("#id-dlg-sign-font-size"),cls:"input-group-nr",style:"width: 50px;",menuCls:"scrollable-menu",menuStyle:"min-width: 50px;max-height: 270px;",hint:this.tipFontSize,takeFocusOnClose:!0,data:[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"},{value:96,displayValue:"96"}]}).on("selected",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,i.value,t.font.italic,t.font.bold),t.font.size=i.value})),this.cmbFontSize.setValue(this.font.size),this.cmbFontSize.on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize.on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),t.btnBold=new Common.UI.Button({parentEl:$("#id-dlg-sign-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:t.textBold}),t.btnBold.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,t.font.italic,e.pressed),t.font.bold=e.pressed})),t.btnItalic=new Common.UI.Button({parentEl:$("#id-dlg-sign-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:t.textItalic}),t.btnItalic.on("click",(function(e,i){t.signObject&&t.signObject.setText(t.inputName.getValue(),t.font.name,t.font.size,e.pressed,t.font.bold),t.font.italic=e.pressed})),t.btnSelectImage=new Common.UI.Button({el:"#id-dlg-sign-image"}),t.btnSelectImage.on("click",_.bind(t.onSelectImage,t)),t.btnChangeCertificate=new Common.UI.Button({el:"#id-dlg-sign-change"}),t.btnChangeCertificate.on("click",_.bind(t.onChangeCertificate,t)),t.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),t.btnOk.setDisabled(!0),t.cntCertificate=$("#id-dlg-sign-certificate"),t.cntVisibleSign=$("#id-dlg-sign-visible"),t.cntInvisibleSign=$("#id-dlg-sign-invisible"),"visible"==t.signType?t.cntInvisibleSign.addClass("hidden"):t.cntVisibleSign.addClass("hidden"),e.find(".dlg-btn").on("click",_.bind(t.onBtnClick,t)),t.afterRender()},getFocusedComponents:function(){return[this.inputPurpose,this.inputName,this.cmbFonts,this.cmbFontSize,this.btnBold,this.btnItalic,this.btnSelectImage,this.btnChangeCertificate].concat(this.getFooterButtons())},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){("visible"==t.signType?t.inputName:t.inputPurpose).cmpEl.find("input").focus()}),500)},close:function(){this.api.asc_unregisterCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_unregisterCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),Common.UI.Window.prototype.close.apply(this,arguments),this.signObject&&this.signObject.destroy()},afterRender:function(){this.api&&(this.binding||(this.binding={}),this.binding.certificateChanged=_.bind(this.onCertificateChanged,this),this.api.asc_registerCallback("on_signature_defaultcertificate_ret",this.binding.certificateChanged),this.api.asc_registerCallback("on_signature_selectsertificate_ret",this.binding.certificateChanged),this.api.asc_GetDefaultCertificate()),"visible"==this.signType&&(this.cmbFonts.fillFonts(this.fontStore),this.cmbFonts.selectRecord(this.fontStore.findWhere({name:this.font.name})||this.fontStore.at(0)),this.signObject=new AscCommon.CSignatureDrawer("signature-preview-img",this.api,this.signSize.width,this.signSize.height))},getSettings:function(){var t={};return t.certificateId=this.certificateId,"invisible"==this.signType?t.purpose=this.inputPurpose.getValue():t.images=this.signObject?this.signObject.getImages():[null,null],t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||this.signObject&&!this.signObject.isValid()))return void(this.btnOk.isDisabled()||(this.inputName.showError([this.textNameError]),this.inputName.focus()));this.options.handler.call(this,this,t)}this.close()},onChangeCertificate:function(){this.api.asc_SelectCertificate()},onCertificateChanged:function(t){this.certificateId=t.id;var e=t.date,i="string"==typeof e?e.split(" - "):["",""];this.cntCertificate.html(this.templateCertificate({name:t.name,valid:this.textValid.replace("%1",i[0]).replace("%2",i[1])})),this.cntCertificate.toggleClass("hidden",_.isEmpty(this.certificateId)||this.certificateId<0),this.btnChangeCertificate.setCaption(_.isEmpty(this.certificateId)||this.certificateId<0?this.textSelect:this.textChange),this.btnOk.setDisabled(_.isEmpty(this.certificateId)||this.certificateId<0)},onSelectImage:function(){this.signObject&&(this.signObject.selectImage(),this.inputName.setValue(""))},onChangeName:function(t,e){this.signObject&&this.signObject.setText(e,this.font.name,this.font.size,this.font.italic,this.font.bold)},onFontSizeChanged:function(t,e,i,s){var n;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(n=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return n=e.getValue(),e.setRawValue(n),s.preventDefault(),!1}else{var a="sse-"==this.appPrefix?409:300;n=(n=Common.Utils.String.parseFloat(i.value))>a?a:n<1?1:Math.floor(2*(n+.4))/2,e.setRawValue(n),this.signObject&&this.signObject.setText(this.inputName.getValue(),this.font.name,n,this.font.italic,this.font.bold),this.font.size=n}},textTitle:"Sign Document",textPurpose:"Purpose for signing this document",textCertificate:"Certificate",textValid:"Valid from %1 to %2",textChange:"Change",textInputName:"Input signer name",textUseImage:"or click 'Select Image' to use a picture as signature",textSelectImage:"Select Image",textSignature:"Signature looks as",tipFontName:"Font Name",tipFontSize:"Font Size",textBold:"Bold",textItalic:"Italic",textSelect:"Select",textNameError:"Signer name must not be empty."},Common.Views.SignDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/SignSettingsDialog",[],(function(){"use strict";Common.Views.SignSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 350px;",cls:"modal-dlg",type:"edit"},initialize:function(t){_.extend(this.options,{title:this.textTitle,buttons:["ok"].concat("edit"===(t.type||this.options.type)?["cancel"]:[])},t||{}),this.template=['<div class="box" style="height: 250px;">','<div class="input-row">',"<label>"+this.textInfoName+"</label>","</div>",'<div id="id-dlg-sign-settings-name" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoTitle+"</label>","</div>",'<div id="id-dlg-sign-settings-title" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+this.textInfoEmail+"</label>","</div>",'<div id="id-dlg-sign-settings-email" class="input-row" style="margin-bottom: 10px;"></div>','<div class="input-row">',"<label>"+this.textInstructions+"</label>","</div>",'<div id="id-dlg-sign-settings-instructions"></div>','<div id="id-dlg-sign-settings-date"></div>',"</div>"].join(""),this.api=this.options.api,this.type=this.options.type||"edit",this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();t.inputName=new Common.UI.InputField({el:$("#id-dlg-sign-settings-name"),style:"width: 100%;",disabled:"view"==this.type}),t.inputTitle=new Common.UI.InputField({el:$("#id-dlg-sign-settings-title"),style:"width: 100%;",disabled:"view"==this.type}),t.inputEmail=new Common.UI.InputField({el:$("#id-dlg-sign-settings-email"),style:"width: 100%;",disabled:"view"==this.type}),t.textareaInstructions=new Common.UI.TextareaField({el:e.find("#id-dlg-sign-settings-instructions"),style:"width: 100%; height: 35px;margin-bottom: 10px;",value:this.textDefInstruction,disabled:"view"==this.type}),this.chDate=new Common.UI.CheckBox({el:$("#id-dlg-sign-settings-date"),labelText:this.textShowDate,disabled:"view"==this.type,value:"checked"}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputName,this.inputTitle,this.inputEmail,this.textareaInstructions,this.chDate].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputName},setSettings:function(t){if(t){var e=this,i=t.asc_getSigner1();e.inputName.setValue(i||""),i=t.asc_getSigner2(),e.inputTitle.setValue(i||""),i=t.asc_getEmail(),e.inputEmail.setValue(i||""),i=t.asc_getInstructions(),e.textareaInstructions.setValue(i||""),e.chDate.setValue(t.asc_getShowDate()),e._currentGuid=t.asc_getGuid()}},getSettings:function(){var t=this,e=new AscCommon.asc_CSignatureLine;return e.asc_setSigner1(t.inputName.getValue()),e.asc_setSigner2(t.inputTitle.getValue()),e.asc_setEmail(t.inputEmail.getValue()),e.asc_setInstructions(t.textareaInstructions.getValue()),e.asc_setShowDate("checked"==t.chDate.getValue()),void 0!==t._currentGuid&&e.asc_setGuid(t._currentGuid),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},textInfo:"Signer Info",textInfoName:"Suggested signer",textInfoTitle:"Suggested signer's title",textInfoEmail:"Suggested signer's e-mail",textInstructions:"Instructions for signer",txtEmpty:"This field is required",textAllowComment:"Allow signer to add comment in the signature dialog",textShowDate:"Show sign date in signature line",textTitle:"Signature Setup",textDefInstruction:"Before signing this document, verify that the content you are signing is correct."},Common.Views.SignSettingsDialog||{}))})),define("common/main/lib/view/DocumentPropertyDialog",[],(function(){"use strict";Common.Views.DocumentPropertyDialog=Common.UI.Window.extend(_.extend({options:{width:320,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,defaultValue:{}},t),this.template=['<div style="display: flex; flex-direction: column; margin: 0 20px;">','<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTitleLabel+"</label>",'<div id="id-dlg-title"></div>',"</div>",'<div style="margin-bottom: 10px;flex-shrink:0;">',"<label>"+this.txtPropertyTypeLabel+"</label>",'<div id="id-dlg-type"></div>',"</div>",'<div style="flex-shrink:0;">',"<label>"+this.txtPropertyValueLabel+"</label>",'<div id="id-dlg-value-input"></div>','<div id="id-dlg-value-date"></div>','<div id="id-dlg-value-boolean"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.asc2type=function(t){return t===AscCommon.c_oVariantTypes.vtLpwstr?"text":t===AscCommon.c_oVariantTypes.vtI4||t===AscCommon.c_oVariantTypes.vtR8?"number":t===AscCommon.c_oVariantTypes.vtBool?"boolean":t===AscCommon.c_oVariantTypes.vtFiletime?"date":void 0},Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.inputTitle=new Common.UI.InputField({el:$("#id-dlg-title"),allowBlank:!1,blankError:this.txtPropertyTitleBlankError,validateOnBlur:!1,hideErrorOnInput:!0,validation:function(e){if(void 0!==t.options.nameValidator)return t.options.nameValidator(e)}}),this.options.defaultValue.name&&this.inputTitle.setValue(this.options.defaultValue.name),this.comboboxType=new Common.UI.ComboBox({el:$("#id-dlg-type"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyTypeText,value:"text"},{displayValue:this.txtPropertyTypeNumber,value:"number"},{displayValue:this.txtPropertyTypeDate,value:"date"},{displayValue:this.txtPropertyTypeBoolean,value:"boolean"}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0});var e=this.options.defaultValue.type?this.asc2type(this.options.defaultValue.type):"text";this.comboboxType.setValue(e),this.comboboxType.on("selected",_.bind((function(t,e){this.inputTextOrNumber.setVisible("text"===e.value||"number"===e.value),this.comboboxBoolean.setVisible("boolean"===e.value),this.datepicker.setVisible("date"===e.value)}),this)),this.inputTextOrNumber=new Common.UI.InputField({el:$("#id-dlg-value-input"),style:"width: 100%;",validateOnBlur:!1,hideErrorOnInput:!0,allowBlank:!1,blankError:this.txtPropertyValueBlankError,validation:function(t){return"number"!==this.comboboxType.getValue()||"number"==typeof t||!isNaN(t.replace(",","."))||this.txtPropertyTypeNumberInvalid}.bind(this)}),!this.options.defaultValue.value||"text"!==e&&"number"!==e||this.inputTextOrNumber.setValue(this.options.defaultValue.value),this.inputTextOrNumber.setVisible(this.options.defaultValue.type?this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtFiletime&&this.options.defaultValue.type!==AscCommon.c_oVariantTypes.vtBool:"text"===e||"number"===e),this.comboboxBoolean=new Common.UI.ComboBox({el:$("#id-dlg-value-boolean"),cls:"input-group-nr",menuStyle:"min-width: 85px; width: 100%;",editable:!1,data:[{displayValue:this.txtPropertyBooleanTrue,value:1},{displayValue:this.txtPropertyBooleanFalse,value:0}],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big",ariaLabel:this.strLineHeight,takeFocusOnClose:!0}),this.comboboxBoolean.setValue(void 0!==this.options.defaultValue.value&&"boolean"===e?this.options.defaultValue.value?1:0:1),this.comboboxBoolean.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtBool:"boolean"===e),this.datepicker=new Common.UI.InputFieldBtnCalendar({el:$("#id-dlg-value-date"),allowBlank:!1,blankError:this.txtPropertyValueBlankError,validateOnBlur:!1,value:"",hideErrorOnInput:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"small"}),this.options.defaultValue.value&&"date"===e&&(this.datepicker.setDate(this.options.defaultValue.value),this.datepicker.setValue(this.dateToString(this.options.defaultValue.value))),this.datepicker.setVisible(this.options.defaultValue.type?this.options.defaultValue.type===AscCommon.c_oVariantTypes.vtFiletime:"date"===e),this.datepicker.on("date:click",function(t,e){t.setValue(this.dateToString(e))}.bind(this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputTitle,this.comboboxType,this.inputTextOrNumber,this.comboboxBoolean,this.datepicker].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputTitle},show:function(){Common.UI.Window.prototype.show.apply(this,arguments);var t=this;_.delay((function(){t.inputTitle.focus()}),100)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler&&"ok"===t){if(!0!==this.inputTitle.checkValidate())return void this.inputTitle.focus();var e,i,s=this.inputTitle.getValue(),n=this.comboboxType.getValue();if("boolean"===n)e=1===this.comboboxBoolean.getValue(),i=AscCommon.c_oVariantTypes.vtBool;else if("date"===n){if(!0!==this.datepicker.checkValidate())return void this.datepicker.focus();if((e=this.datepicker.getDate())||(e=new Date(this.datepicker.getValue()))&&e instanceof Date&&!isNaN(e)||(e=void 0),!e){var a=this;return void Common.UI.warning({msg:a.errorDate,buttons:["ok","cancel"],callback:function(e){"ok"===e?(a.options.handler.call(this,t,s,AscCommon.c_oVariantTypes.vtLpwstr,a.datepicker.getValue()),a.close()):a.datepicker.focus()}})}i=AscCommon.c_oVariantTypes.vtFiletime}else{if(!0!==this.inputTextOrNumber.checkValidate())return void this.inputTextOrNumber.focus();var o=this.inputTextOrNumber.getValue();"text"===n?(i=AscCommon.c_oVariantTypes.vtLpwstr,e=o):("number"!=typeof o&&(o=o.replace(",",".")),o%1==0?(i=AscCommon.c_oVariantTypes.vtI4,e=parseInt(o)):(i=AscCommon.c_oVariantTypes.vtR8,e=parseFloat(o)))}this.options.handler.call(this,t,s,i,e)}this.close()},dateToString:function(t){var e="";if(t){t=new Date(t);var i=(this.options.lang||"en").replace("_","-").toLowerCase();try{i=="ar-SA".toLowerCase()&&(i+="-u-nu-latn-ca-gregory"),e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}catch(s){i="en",e=t.toLocaleString(i,{year:"numeric",month:"2-digit",day:"2-digit"})}}return e},txtTitle:"New Document Property",txtPropertyTitleLabel:"Title",txtPropertyTitleBlankError:"Property should have a title",txtPropertyTypeLabel:"Type",txtPropertyValueLabel:"Value",txtPropertyValueBlankError:"Property should have a value",txtPropertyTypeText:"Text",txtPropertyTypeNumber:"Number",txtPropertyTypeNumberInvalid:"Provide a valid number",txtPropertyTypeDate:"Date",txtPropertyTypeBoolean:'"Yes" or "no"',txtPropertyBooleanTrue:"Yes",txtPropertyBooleanFalse:"No",errorDate:"You can choose a value from the calendar to store the value as Date.<br>If you enter a value manually, it will be stored as Text."},Common.Views.DocumentPropertyDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/view/MacrosDialog",[],(function(){"use strict";Common.Views.MacrosDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=Math.max(Common.Utils.innerHeight()-Common.Utils.InternalSettings.get("window-inactive-area-top"),350),s=Math.max(Common.Utils.innerWidth(),600);_.extend(e,{id:"macros-dialog",title:this.textTitle,header:!0,help:!0,width:Math.min(810,s),height:Math.min(512,i),minwidth:750,minheight:350,resizable:!0,cls:"modal-dlg invisible-borders",buttons:[{value:"ok",caption:this.textSave},"cancel"]},t||{}),this.api=t.api,this.ItemTypes={CustomFunction:0,Macros:1},this._state={isFunctionsSupport:!!window.SSE,selectedItem:{record:null,type:null},currentValue:"",currentPos:{row:3,column:0}},this.template=['<div id="macros-dialog-content"><div id="macros-dialog-left" class="noselect"><div id="macros-menu" <% if(!isFunctionsSupport){%> style="height: 100%;" <% } %>><div class="menu-header"><label>'+this.textMacros+'</label><div id="btn-ai-macros-add"></div><div id="btn-macros-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-list"></div></div><div class="separator horizontal" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ></div><div id="functions-menu" <% if(!isFunctionsSupport){%> style="display: none;" <% } %> ><div class="menu-header"><label id="macros-dialog-functions-label">'+this.textCustomFunctions+'</label><div id="btn-function-add"></div></div><div class="separator horizontal" style="position: relative"></div><div id="functions-list"></div></div></div><div class="separator vertical" style="position: relative"></div><div id="macros-dialog-right"><div class="menu-header"><div id="btn-macros-undo"></div><div id="btn-macros-redo"></div><div id="btn-macros-run" class="lock-for-function"></div><div id="btn-macros-debug" class="lock-for-function"></div><div id="btn-macros-copy"></div><div id="btn-macros-rename"></div><div id="btn-macros-delete"></div><div id="ch-macros-autostart" class="lock-for-function"></div></div><div class="separator horizontal" style="position: relative"></div><div id="macros-code-editor" class="invisible"></div></div></div><div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)({isFunctionsSupport:this._state.isFunctionsSupport}),this.on({help:this.onHelp,drag:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])},resize:function(t){t[0].codeEditor&&t[0].codeEditor.enablePointerEvents("start"!==t[1])}}),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.aceContainer=e.find("#macros-code-editor"),t.createCodeEditor(),t.renderAfterAceLoaded(),t.calcHeaderBreakpoints(),t.collapseHeaderItems(),t.updateCustomFunctionLabel();var i=_.throttle(_.bind(this.collapseHeaderItems,this),100);this.on("resizing",(function(){i()}))},renderAfterAceLoaded:function(){this.btnUndo=new Common.UI.Button({parentEl:$("#btn-macros-undo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-undo icon-rtl",hint:this.tipUndo}).on("click",_.bind(this.onUndo,this)),this.btnRedo=new Common.UI.Button({parentEl:$("#btn-macros-redo"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-redo icon-rtl",hint:this.tipRedo}).on("click",_.bind(this.onRedo,this)),this.btnRun=new Common.UI.Button({parentEl:$("#btn-macros-run"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-run",caption:this.textRun,hint:this.tipMacrosRun}).on("click",_.bind(this.onRunMacros,this,!1)),this.btnDebug=new Common.UI.Button({parentEl:$("#btn-macros-debug"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-debug",caption:this.textDebug,hint:this.tipMacrosDebug}).on("click",_.bind(this.onRunMacros,this,!0)),this.btnCopy=new Common.UI.Button({parentEl:$("#btn-macros-copy"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-copy",caption:this.textCopy,hint:this.tipMacrosCopy}).on("click",_.bind(this.onCopyItem,this)),this.btnRename=new Common.UI.Button({parentEl:$("#btn-macros-rename"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-rename",caption:this.textRename,hint:this.tipMacrosRename}).on("click",_.bind(this.onRenameItem,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#btn-macros-delete"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-cc-remove",caption:this.textDelete,hint:this.tipMacrosDelete}).on("click",_.bind(this.onDeleteItem,this)),this.chAutostart=new Common.UI.CheckBox({el:$("#ch-macros-autostart"),labelText:this.textAutostart}).on("change",_.bind(this.onChangeAutostart,this));var t=this.api.checkAI();this.btnAiMacrosAdd=new Common.UI.Button({parentEl:$("#btn-ai-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-general-ai",menu:new Common.UI.Menu({additionalAlign:this.menuAddAlign,items:[{caption:this.textCreateFromDesc,value:"create",disabled:!t},{caption:this.textConvertFromVBA,value:"convert",disabled:!t}]}),hint:this.tipAi}),this.btnAiMacrosAdd.menu.on("item:click",_.bind(this.onAiMenu,this)),this.btnMacrosAdd=new Common.UI.Button({parentEl:$("#btn-macros-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipMacrosAdd}).on("click",_.bind(this.onCreateMacros,this,"")),this.listMacros=new Common.UI.ListView({el:$("#macros-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,itemTemplate:_.template(['<div class="listitem-autostart">',"<% if (autostart) { %>","<span>(A)</span>","<% } %>","</div>",'<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listMacros.on("item:add",_.bind(this.onAddListItem,this)),this.listMacros.on("item:select",_.bind(this.onSelectListMacrosItem,this)),this.setListMacros(),this._state.isFunctionsSupport&&(this.btnFunctionAdd=new Common.UI.Button({parentEl:$("#btn-function-add"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-zoomup",hint:this.tipFunctionAdd}).on("click",_.bind(this.onCreateFunction,this)),this.listFunctions=new Common.UI.ListView({el:$("#functions-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template(['<div class="listitem-autostart"></div>','<div id="<%= id %>" class="list-item" role="listitem"><%= Common.Utils.String.htmlEncode(name) %></div>'].join(""))}),this.listFunctions.on("item:add",_.bind(this.onAddListItem,this)),this.listFunctions.on("item:select",_.bind(this.onSelectListFunctionItem,this)),this.setListFunctions()),this.makeDragable()},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-code-editor"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue(t._state.currentValue,t._state.currentPos),setTimeout((function(){t.aceContainer.removeClass("invisible")}),10)})),this.codeEditor.on("change",(function(e,i){t._state.selectedItem.record&&(t._state.currentValue=e,t._state.currentPos=i,t._state.selectedItem.record.set("value",e),t._state.selectedItem.record.set("currentPos",i))}))},calcHeaderBreakpoints:function(){this.breakpoints=[];var t=this,e=10,i=[{btn:this.btnUndo,collapsible:!1},{btn:this.btnRedo,collapsible:!1},{btn:this.btnRun,collapsible:!0},{btn:this.btnDebug,collapsible:!0},{btn:this.btnCopy,collapsible:!0},{btn:this.btnRename,collapsible:!0},{btn:this.btnDelete,collapsible:!0},{btn:this.chAutostart,collapsible:!1,withoutMargin:!0}];this.collapsibleHeaderItems=i.filter((function(t){return t.collapsible})),i.forEach((function(t){var i=t.btn.$el.find(".caption"),s=i.hasClass("hide");i.removeClass("hide"),t.expandedWidth=t.btn.$el.outerWidth(!t.withoutMargin),t.collapsedWidth=t.collapsible?t.expandedWidth-i.outerWidth(!0):t.expandedWidth,e+=t.expandedWidth,s&&i.addClass("hide")})),this.collapsibleHeaderItems.forEach((function(i,s){if(0==s)t.breakpoints.push({width:e,collapseItems:[i]});else{var n=t.breakpoints[s-1],a=t.collapsibleHeaderItems[s-1];t.breakpoints.push({width:n.width-(a.expandedWidth-a.collapsedWidth),collapseItems:[i].concat(n.collapseItems)})}}))},collapseHeaderItems:function(){for(var t=this.getChild().find("#macros-dialog-right .menu-header").width(),e=null,i=this.breakpoints.length-1;i>=0;i--)if(t<this.breakpoints[i].width){e=this.breakpoints[i];break}this.collapsibleHeaderItems.forEach((function(t){var i=e&&-1!==e.collapseItems.indexOf(t);t.btn.$el.find(".caption").toggleClass("hide",!!i)}))},updateCustomFunctionLabel:function(){var t=this.getChild(),e=t.find("#macros-dialog-left"),i=t.find("#functions-menu .menu-header"),s=t.find("#btn-function-add"),n=t.find("#macros-dialog-functions-label"),a=(parseFloat(e.css("min-width"))||0)-((parseFloat(i.css("padding-left"))||0)+(parseFloat(i.css("padding-right"))||0))-(s.outerWidth(!0)||0);n.width()>a&&n.text(this.textFunctions)},setListMacros:function(){var t=this,e=this.parseDataFromApi(this.api.pluginMethod_GetMacros()),i=e.macrosArray,s=this.api.pluginMethod_GetVBAMacros();s&&"string"==typeof s&&s.includes("<Module")&&s.split("<Module ").filter((function(t){return t.includes('Type="Procedural"')||t.includes('Type="Class"')})).forEach((function(e){var s=e.indexOf("<SourceCode>")+12,n=e.indexOf("</SourceCode>",s),a=e.slice(s,n);s=e.indexOf('Name="')+6,n=e.indexOf('"',s);var o=e.slice(s,n);-1==i.findIndex((function(t){return t.name==o}))&&(a=(a=(a=(a=(a=(a=a.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')).replace(/Attribute [^\r\n]*\r\n/g,""),i.push({guid:t.createGuid(),name:o,autostart:!1,value:"(function()\n{\n\t/* Enter your code here. */\n})();\n\n/*\nExecution of VBA commands does not support.\n"+a+"*/"}))}));if(i.length>0){i.forEach((function(t){t.autostart=!!t.autostart,t.currentPos={row:3,column:0}})),this.listMacros.store.reset(i);var n=this.listMacros.store.at(e.current);n&&this.listMacros.selectRecord(n)}else this.onCreateMacros()},setListFunctions:function(){var t=this.parseDataFromApi(this.api.pluginMethod_GetCustomFunctions()).macrosArray;this.listFunctions.store.reset(t)},makeDragable:function(){var t,e,i=this,s=0,n=document.getElementById("macros-list"),a=document.getElementById("functions-list");function o(t,e){i.codeEditor.disableDrop(!0);var n=$(e.target).children(".list-item").attr("id");e.dataTransfer.setData("text/plain",n),e.dataTransfer.effectAllowed="move",e.target.classList.add("dragged"),s=t.store.indexOf(t.store.findWhere({id:n})),e.target.click()}function l(t,n){if(i.codeEditor.disableDrop(!1),n.target.classList.remove("dragged"),$(".dragHovered").removeClass("dragHovered"),s!==e&&null!=e){-1===e&&(e=t.store.length),s<e&&e--;var a=t.store.models.slice(),o=a.splice(s,1)[0];a.splice(e,0,o),t.store.reset(a),s=0}}function r(s,n,a){a.preventDefault(),t=a.target;var o=i._state.selectedItem.type===n;a.dataTransfer.dropEffect=o?"move":"none",t.classList.contains("draggable")&&o&&(e=function(t,e,i){var s=i.index(e),n=Common.Utils.getBoundingClientRect(e);return t>n.y+.45*n.height&&(s+=1),s}(a.clientY,t,$(s).find(".item")),$(".dragHovered").removeClass("dragHovered"),e<$(s).find(".item").length?($(s).find(".item").last().removeClass(["dragHovered","last"]),$(s).find(".item")[e].classList.add("dragHovered")):$(s).find(".item").last().addClass(["dragHovered","last"]))}function c(t){if(t.fromElement){if("list"==$(t.fromElement).attr("role")||"listitem"==$(t.fromElement).attr("role")||$(t.fromElement).parents('[role="listitem"]').length)return;$(".dragHovered").removeClass("dragHovered"),e=null}}n.addEventListener("dragstart",(function(t){o(i.listMacros,t)})),a.addEventListener("dragstart",(function(t){o(i.listFunctions,t)})),n.addEventListener("dragend",(function(t){l(i.listMacros,t)})),a.addEventListener("dragend",(function(t){l(i.listFunctions,t)})),n.addEventListener("dragover",(function(t){r(n,i.ItemTypes.Macros,t)})),a.addEventListener("dragover",(function(t){r(a,i.ItemTypes.CustomFunction,t)})),n.addEventListener("dragleave",(function(t){c(t)})),a.addEventListener("dragleave",(function(t){c(t)}))},selectItem:function(t,e){this._state.selectedItem.record=t,this._state.selectedItem.type=e,this.codeEditor.setValue(t.get("value"),void 0!==t.get("currentPos")?t.get("currentPos"):{row:3,column:0}),this.codeEditor.revealPositionInCenter(),this._state.currentValue=t.get("value"),this._state.currentPos=t.get("currentPos"),this.chAutostart.setValue(t.get("autostart")),this.getChild().find(".lock-for-function").toggleClass("hidden",e==this.ItemTypes.CustomFunction),e==this.ItemTypes.Macros&&this.listFunctions&&this.listFunctions.deselectAll(),e==this.ItemTypes.CustomFunction&&this.listMacros&&this.listMacros.deselectAll(),this.updateHintButtons(),this.setDisableButtons(!1)},updateHintButtons:function(){var t=this._state.selectedItem.type==this.ItemTypes.Macros?"Macros":"Function";this.btnCopy.updateHint(this["tip"+t+"Copy"]),this.btnRename.updateHint(this["tip"+t+"Rename"]),this.btnDelete.updateHint(this["tip"+t+"Delete"])},setDisableButtons:function(t){this.btnUndo.setDisabled(t),this.btnRedo.setDisabled(t),this.btnRun.setDisabled(t),this.btnDebug.setDisabled(t),this.btnCopy.setDisabled(t),this.btnRename.setDisabled(t),this.btnDelete.setDisabled(t),this.chAutostart.setDisabled(t)},parseDataFromApi:function(t){var e={macrosArray:[],current:-1};if(t)try{e=JSON.parse(t)}catch(t){e={macrosArray:[],current:-1}}return e},createGuid:function(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"");return e},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){},close:function(t){this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),"ok"===t&&(this.api.pluginMethod_SetMacros(JSON.stringify({macrosArray:this.listMacros.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),autostart:t.get("autostart"),value:t.get("value")}})),current:this.listMacros.store.indexOf(this.listMacros.getSelectedRec())})),this._state.isFunctionsSupport&&this.api.pluginMethod_SetCustomFunctions(JSON.stringify({macrosArray:this.listFunctions.store.models.map((function(t){return{guid:t.get("guid"),name:t.get("name"),value:t.get("value")}}))}))),this.close()},onAddListItem:function(t,e){e.$el.attr("draggable",!0),e.$el.addClass("draggable")},onCopyItem:function(){if(this._state.selectedItem.record){var t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record;t.store.add({guid:this.createGuid(),name:e.get("name")+"_copy",value:e.get("value"),autostart:e.get("autostart")}),t.selectRecord(t.store.at(-1))}},onRenameItem:function(){if(this._state.selectedItem.record){var t=this,e=300,i=90,s=Common.Utils.getBoundingClientRect(this.$window[0]);new Common.Views.TextInputDialog({value:t._state.selectedItem.record.get("name"),width:e,height:i,inputConfig:{allowBlank:!1,validation:function(t){return t.trim().length>0||""}},handler:function(e,i){"ok"==e&&t._state.selectedItem.record.set("name",i.trim())}}).show(s.left+(s.width-e)/2,s.top+(s.height-i)/2)}},onCreateMacros:function(t){var e=0,i="Macro",s=this.textMacro;this.listMacros.store.each((function(t,n){var a=t.get("name");if(0==a.indexOf(i)){n=parseInt(a.substr(5));!isNaN(n)&&e<n&&(e=n)}else if(0==a.indexOf(s)){n=parseInt(a.substr(s.length));!isNaN(n)&&e<n&&(e=n)}})),e++,this.listMacros.store.add({guid:this.createGuid(),name:s+" "+e,value:t||"(function()\n{\n    \n})();",autostart:!1,currentPos:{row:3,column:5}}),this.listMacros.selectRecord(this.listMacros.store.at(-1))},onSelectListMacrosItem:function(t,e,i){this.selectItem(i,this.ItemTypes.Macros)},onUndo:function(){this.codeEditor.undo()},onRedo:function(){this.codeEditor.redo()},onAiMenu:function(t,e){var i=this,s="",n="",a="Generate JavaScript code as an Immediately Invoked Function Expression (IIFE), in the format (function(){ ... })();, that [describe what the code should do]. The code should be self-contained and execute immediately. ",o=Common.Locale.getCurrentLanguage(),l=Common.util.LanguageInfo.getLocalLanguageName(Common.util.LanguageInfo.getLocalLanguageCode(o));l=l&&"string"==typeof l[1]?l[1]:null;var r="Document Editor";(window.PE&&(r="Presentation Editor"),window.SSE&&(r="Spreadsheet Editor"),"create"==e.value?(s=this.textCreateMacrosFromDesc,n="Create a macro for OnlyOffice. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The format of the code is JavaScript. Write comments in the same language as the user prompt. The description of what the macro should do is also described in the user message. "+a):"convert"==e.value&&(s=this.textConvertMacrosFromVBA,n="Convert macro for OnlyOffice from VBA. The macro should be written specifically for the OnlyOffice "+r+". Return only code with comments, as plain text without markdown. The code format is JavaScript. Write comments in "+o+(l?"("+l+")":"")+" language. The code of the macro in VBA should be presented in the user message. "+a),"create"==e.value||"convert"==e.value)&&new Common.Views.MacrosAiDialog({title:s,api:this.api,instruction:n,inputType:"create"==e.value?"textarea":"codeEditor",handler:function(t,e){"ok"==t&&i.onCreateMacros(e)}}).show()},onRunMacros:function(t){this.api.callCommand(t?"debugger;\n"+this._state.currentValue:this._state.currentValue)},onChangeAutostart:function(t,e){this._state.selectedItem.record&&this._state.selectedItem.record.set("autostart","checked"==e)},onDeleteItem:function(){if(this._state.selectedItem.record){var t=this._state.selectedItem.type==this.ItemTypes.Macros?this.listMacros:this.listFunctions,e=this._state.selectedItem.record,i=t.store.indexOf(e);if(t.store.remove(e),t.store.length>0){var s=i<t.store.length?i:t.store.length-1;t.selectByIndex(s)}else this.codeEditor.setValue("",{row:0,column:0},!0),this.setDisableButtons(!0)}},onCreateFunction:function(){var t=0,e=this.textCustomFunction;this.listFunctions.store.each((function(i,s){var n=i.get("name");if(0==n.indexOf("Custom function")){s=parseInt(n.substr(15));!isNaN(s)&&t<s&&(t=s)}else if(0==n.indexOf(e)){s=parseInt(n.substr(e.length));!isNaN(s)&&t<s&&(t=s)}})),t++,this.listFunctions.store.add({guid:this.createGuid(),name:e+" "+t,value:"(function()\n{\n\t/**\n\t * Function that returns the argument\n\t * @customfunction\n\t * @param {any} arg Any data.\n     * @returns {any} The argumet of the function.\n\t*/\n\tfunction myFunction(arg) {\n\t\t\n\t    return arg;\n\t}\n\tApi.AddCustomFunction(myFunction);\n})();",currentPos:{row:10,column:3}}),this.listFunctions.selectRecord(this.listFunctions.store.at(-1))},onSelectListFunctionItem:function(t,e,i){this.selectItem(i,this.ItemTypes.CustomFunction)},onThemeChanged:function(){this.calcHeaderBreakpoints(),this.collapseHeaderItems(),Common.UI.Window.prototype.onThemeChanged.call(this)},onHelp:function(){window.open("https://api.onlyoffice.com/docs/plugin-and-macros/macros/getting-started/","_blank")},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},textTitle:"Macros",textSave:"Save",textMacro:"Macro",textMacros:"Macros",textRun:"Run",textDebug:"Debug",textAutostart:"Autostart",textRename:"Rename",textDelete:"Delete",textCopy:"Copy",textCustomFunction:"Custom function",textCustomFunctions:"Custom functions",textFunctions:"Functions",textLoading:"Loading...",textCreateFromDesc:"Create from description",textCreateMacrosFromDesc:"Create macros from description",textConvertFromVBA:"Convert from VBA",textConvertMacrosFromVBA:"Convert macros from VBA",tipUndo:"Undo",tipRedo:"Redo",tipMacrosRename:"Rename macros",tipMacrosDelete:"Delete macros",tipMacrosCopy:"Copy macros",tipMacrosRun:"Run macros",tipMacrosDebug:"Debug macros",tipMacrosAdd:"Add macros",tipFunctionRename:"Rename custom function",tipFunctionDelete:"Delete custom function",tipFunctionCopy:"Copy custom function",tipFunctionAdd:"Add custom function",tipAi:"AI"},Common.Views.MacrosDialog||{}))})),define("common/main/lib/view/MacrosAiDialog",[],(function(){"use strict";Common.Views.MacrosAiDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i={width:{init:400,min:400,max:800},height:{init:200,min:200,max:400}},s="modal-dlg invisible-borders";"codeEditor"==t.inputType&&(i={width:{init:600,min:600,max:1e3},height:{init:400,min:400,max:600}},s+=" padding-none"),_.extend(e,{id:"macros-ai-dialog",title:t.title,width:i.width.init,height:i.height.init,minwidth:i.width.min,minheight:i.height.min,maxwidth:i.width.max,maxheight:i.height.max,resizable:!0,cls:s,buttons:[{caption:this.textCreate,value:"ok",primary:!0},"cancel"]},t||{}),this.api=t.api,this.instruction=t.instruction,this.inputType=t.inputType||"textarea",this._state={codeEditorValue:""},"textarea"==this.inputType?this.template=['<div class="box">','<div id="macros-ai-dialog-textarea"></div>',"</div>"].join(""):this.template=['<div id="macros-ai-dialog-code-editor"></div>','<div class="separator horizontal" style="position: relative"></div>'].join(""),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();"textarea"==this.inputType?this.textareaPrompt=new Common.UI.TextareaField({el:t.find("#macros-ai-dialog-textarea"),placeHolder:this.textAreaPlaceholder}):this.createCodeEditor(),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},createCodeEditor:function(){var t=this;this.codeEditor=new Common.UI.MonacoEditor({parentEl:"#macros-ai-dialog-code-editor",language:"vba"}),this.codeEditor.on("ready",(function(){t.codeEditor.updateTheme(),t.codeEditor.setValue("",{row:0,column:0})})),this.codeEditor.on("change",(function(e,i){t._state.codeEditorValue=e}))},getFocusedComponents:function(){return[].concat(this.getFooterButtons())},show:function(){if(Common.UI.Window.prototype.show.apply(this,arguments),this.textareaPrompt){var t=this;_.delay((function(){t.textareaPrompt.focus()}),50)}},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},close:function(t){this.codeEditor&&this.codeEditor.destroyEditor(),Common.UI.Window.prototype.close.call(this,arguments)},_handleInput:function(t){if(this.options.handler)if("ok"==t){var e=this,i="textarea"==this.inputType?this.textareaPrompt.getValue():this._state.codeEditorValue;e.api.AI({type:"text",data:[{role:"system",content:this.instruction},{role:"user",content:i}]},(function(i){if(i.error){if("no-engine"===i.type)return e._handleInput("cancel");console.log(i.error)}else{if(!i||!i.text)return e._handleInput("cancel");var s=i.text.replace(/```javascript|```/g,"");s=function(t,e,i){var s=e||0;if(-1!=s){var n=['"',"'","\n","\r"];for(!0===i&&n.push(" ");s<t.length&&n.includes(t[s]);)s++;for(var a=t.length-1;a>0&&n.includes(t[a]);)a--;if(a>s)return t.substring(s,a+1)}return t}(s,0,!0),e.close(),e.options.handler.call(e,t,s)}}))}else this.close(),this.options.handler.call(this,t)},textCreate:"Create",textAreaPlaceholder:"Input a prompt for the query"},Common.Views.MacrosAiDialog||{}))})),void 0===Common)Common={};if(define("common/main/lib/component/MonacoEditor",[],(function(){"use strict";Common.UI.MonacoEditor=Common.UI.BaseView.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t),this.id=_.uniqueId(),this.parentEl=t.parentEl,this.language=t.language||"javascript",this.parentEl&&this.render(this.parentEl)},render:function(t){this.parentEl="string"==typeof t?$(t):t,this.iframe=document.createElement("iframe"),this.iframe.width="100%",this.iframe.height="100%",this.iframe.align="top",this.iframe.frameBorder=0,this.iframe.scrolling="no",this.iframe.onload=_.bind(this._onLoad,this),this.parentEl.append(this.iframe),this.loadMask=new Common.UI.LoadMask({owner:this.parentEl}),this.loadMask.show();var e="../../../vendor/monaco/MonacoEditor.html";e+="?editorType="+(window.SSE?"cell":window.PE?"slide":"word"),e+="&language="+this.language,e+="&id="+this.id,this.iframe.src=e;var i=this;this._eventfunc=function(t){i._onMessage(t)},this._updatebind=function(){i.updateTheme()},this._bindWindowEvents.call(this)},_bindWindowEvents:function(){window.addEventListener?window.addEventListener("message",this._eventfunc,!1):window.attachEvent&&window.attachEvent("onmessage",this._eventfunc),Common.NotificationCenter.on("uitheme:changed",this._updatebind)},_unbindWindowEvents:function(){window.removeEventListener?window.removeEventListener("message",this._eventfunc):window.detachEvent&&window.detachEvent("onmessage",this._eventfunc),Common.NotificationCenter.off("uitheme:changed",this._updatebind)},_postMessage:function(t,e){t&&t.postMessage&&window.JSON&&(e.referer="monaco-editor-"+this.id,t.postMessage(window.JSON.stringify(e),"*"))},_onMessage:function(t){var e=t.data;if("[object String]"===Object.prototype.toString.apply(e)&&window.JSON){var i;try{i=window.JSON.parse(e)}catch(t){i=""}if(i&&i.referer=="monaco-editor-"+this.id)switch(i.command){case"changeValue":e=i.data||{},this.fireEvent("change",e.value,e.pos);break;case"monacoEditorReady":this.fireEvent("ready",i.data)}}},_onLoad:function(){this.updateTheme(),this.loadMask&&this.loadMask.hide()},setValue:function(t,e,i){this._postMessage(this.iframe.contentWindow,{command:"setValue",data:{value:t,readonly:i,currentPos:e}})},updateTheme:function(){this._postMessage(this.iframe.contentWindow,{command:"setTheme",data:Common.UI.Themes.getThemeColors()})},disableDrop:function(t){this._postMessage(this.iframe.contentWindow,{command:"disableDrop",data:t})},revealPositionInCenter:function(){this._postMessage(this.iframe.contentWindow,{command:"revealPositionInCenter",data:{}})},undo:function(){this._postMessage(this.iframe.contentWindow,{command:"undo",data:{}})},redo:function(){this._postMessage(this.iframe.contentWindow,{command:"redo",data:{}})},enablePointerEvents:function(t){this.iframe&&(this.iframe.style.pointerEvents=t?"":"none")},destroyEditor:function(){this._unbindWindowEvents()}})})),define("spreadsheeteditor/main/app/controller/DocumentHolderExt",[],(function(){"use strict";if(window.SSE&&window.SSE.Controllers&&window.SSE.Controllers.DocumentHolder){var t=window.SSE.Controllers.DocumentHolder.prototype;t.setEvents=function(){var t=this;this.addListeners({DocumentHolder:{createdelayedelements:this.onCreateDelayedElements,"equation:callback":this.equationCallback}}),Common.NotificationCenter.on({"tabs:dragend":_.bind(t.onDragEndMouseUp,t),"pivot:dragend":_.bind(t.onDragEndMouseUp,t)}),Common.Gateway.on("setactionlink",_.bind(t.onSetActionLink,t)),this.api&&(this.api.asc_registerCallback("asc_onContextMenu",_.bind(this.onApiContextMenu,this)),this.api.asc_registerCallback("asc_onMouseMove",_.bind(this.onApiMouseMove,this)),this.api.asc_registerCallback("asc_onHideComment",this.wrapEvents.apiHideComment),this.api.asc_registerCallback("asc_onHyperlinkClick",_.bind(this.onApiHyperlinkClick,this)),this.api.asc_registerCallback("asc_onSelectionChanged",_.bind(this.onSelectionChanged,this)),!0===this.permissions.isEdit&&(this.api.asc_registerCallback("asc_onSetAFDialog",_.bind(this.onApiAutofilter,this)),this.api.asc_registerCallback("asc_onEditCell",_.bind(this.onApiEditCell,this)),this.api.asc_registerCallback("asc_onEntriesListMenu",_.bind(this.onEntriesListMenu,this,!1)),this.api.asc_registerCallback("asc_onValidationListMenu",_.bind(this.onEntriesListMenu,this,!0)),this.api.asc_registerCallback("asc_onFormulaCompleteMenu",_.bind(this.onApiFormulaCompleteMenu,this)),this.api.asc_registerCallback("asc_onShowSpecialPasteOptions",_.bind(this.onShowSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onHideSpecialPasteOptions",_.bind(this.onHideSpecialPasteOptions,this)),this.api.asc_registerCallback("asc_onToggleAutoCorrectOptions",_.bind(this.onToggleAutoCorrectOptions,this)),this.api.asc_registerCallback("asc_onFormulaInfo",_.bind(this.onFormulaInfo,this)),this.api.asc_registerCallback("asc_ChangeCropState",_.bind(this.onChangeCropState,this)),this.api.asc_registerCallback("asc_onInputMessage",_.bind(this.onInputMessage,this)),this.api.asc_registerCallback("asc_onTableTotalMenu",_.bind(this.onTableTotalMenu,this)),this.api.asc_registerCallback("asc_onShowPivotHeaderDetailsDialog",_.bind(this.onShowPivotHeaderDetailsDialog,this)),this.api.asc_registerCallback("asc_onShowPivotGroupDialog",_.bind(this.onShowPivotGroupDialog,this)),this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle||(this.api.asc_registerCallback("asc_doubleClickOnTableOleObject",_.bind(this.onDoubleClickOnTableOleObject,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.Image,_.bind(this.onInsertImage,this)),this.api.asc_registerPlaceholderCallback(AscCommon.PlaceholderButtonType.ImageUrl,_.bind(this.onInsertImageUrl,this))),this.api.asc_registerCallback("asc_onShowMathTrack",_.bind(this.onShowMathTrack,this)),this.api.asc_registerCallback("asc_onHideMathTrack",_.bind(this.onHideMathTrack,this)),this.api.asc_registerCallback("asc_onHideEyedropper",_.bind(this.hideEyedropperTip,this)),this.api.asc_SetMathInputType(Common.localStorage.getBool("sse-equation-input-latex")?Asc.c_oAscMathInputType.LaTeX:Asc.c_oAscMathInputType.Unicode)),this.api.asc_registerCallback("asc_onShowForeignCursorLabel",_.bind(this.onShowForeignCursorLabel,this)),this.api.asc_registerCallback("asc_onHideForeignCursorLabel",_.bind(this.onHideForeignCursorLabel,this)),this.api.asc_registerCallback("onPluginContextMenu",_.bind(this.onPluginContextMenu,this)))},t.onCreateDelayedElements=function(t,e){var i=this;i.type=e,"edit"===e?(t.pmiCut.on("click",_.bind(i.onCopyPaste,i)),t.pmiCopy.on("click",_.bind(i.onCopyPaste,i)),t.pmiPaste.on("click",_.bind(i.onCopyPaste,i)),t.pmiImgCut.on("click",_.bind(i.onCopyPaste,i)),t.pmiImgCopy.on("click",_.bind(i.onCopyPaste,i)),t.pmiImgPaste.on("click",_.bind(i.onCopyPaste,i)),t.pmiTextCut.on("click",_.bind(i.onCopyPaste,i)),t.pmiTextCopy.on("click",_.bind(i.onCopyPaste,i)),t.pmiTextPaste.on("click",_.bind(i.onCopyPaste,i)),t.pmiCommonCut.on("click",_.bind(i.onCopyPaste,i)),t.pmiCommonCopy.on("click",_.bind(i.onCopyPaste,i)),t.pmiCommonPaste.on("click",_.bind(i.onCopyPaste,i)),t.pmiInsertEntire.on("click",_.bind(i.onInsertEntire,i)),t.pmiDeleteEntire.on("click",_.bind(i.onDeleteEntire,i)),t.pmiInsertCells.menu.on("item:click",_.bind(i.onInsertCells,i)),t.pmiDeleteCells.menu.on("item:click",_.bind(i.onDeleteCells,i)),t.pmiSparklines.menu.on("item:click",_.bind(i.onClear,i)),t.pmiSortCells.menu.on("item:click",_.bind(i.onSortCells,i)),t.pmiFilterCells.menu.on("item:click",_.bind(i.onFilterCells,i)),t.pmiReapply.on("click",_.bind(i.onReapply,i)),t.pmiCondFormat.on("click",_.bind(i.onCondFormat,i)),t.mnuRefreshPivot.on("click",_.bind(i.onRefreshPivot,i)),t.mnuExpandCollapsePivot.menu.on("item:click",_.bind(i.onExpandCollapsePivot,i)),t.mnuGroupPivot.on("click",_.bind(i.onGroupPivot,i)),t.mnuUnGroupPivot.on("click",_.bind(i.onGroupPivot,i)),t.mnuPivotSettings.on("click",_.bind(i.onPivotSettings,i)),t.mnuFieldSettings.on("click",_.bind(i.onFieldSettings,i)),t.mnuDeleteField.on("click",_.bind(i.onDeleteField,i)),t.mnuSubtotalField.on("click",_.bind(i.onSubtotalField,i)),t.mnuSummarize.menu.on("item:click",_.bind(i.onSummarize,i)),t.mnuShowAs.menu.on("item:click",_.bind(i.onShowAs,i)),t.mnuShowDetails.on("click",_.bind(i.onShowDetails,i)),t.mnuPivotSort.menu.on("item:click",_.bind(i.onPivotSort,i)),t.mnuPivotFilter.menu.on("item:click",_.bind(i.onPivotFilter,i)),t.pmiClear.menu.on("item:click",_.bind(i.onClear,i)),t.pmiSelectTable.menu.on("item:click",_.bind(i.onSelectTable,i)),t.pmiInsertTable.menu.on("item:click",_.bind(i.onInsertTable,i)),t.pmiDeleteTable.menu.on("item:click",_.bind(i.onDeleteTable,i)),t.pmiInsFunction.on("click",_.bind(i.onInsFunction,i)),t.menuAddHyperlink.on("click",_.bind(i.onInsHyperlink,i)),t.menuEditHyperlink.on("click",_.bind(i.onInsHyperlink,i)),t.menuRemoveHyperlink.on("click",_.bind(i.onDelHyperlink,i)),t.pmiRowHeight.menu.on("item:click",_.bind(i.onSetSize,i)),t.pmiColumnWidth.menu.on("item:click",_.bind(i.onSetSize,i)),t.pmiEntireHide.on("click",_.bind(i.onEntireHide,i)),t.pmiEntireShow.on("click",_.bind(i.onEntireShow,i)),t.pmiFreezePanes.on("click",_.bind(i.onFreezePanes,i)),t.pmiEntriesList.on("click",_.bind(i.onEntriesList,i)),t.pmiAddComment.on("click",_.bind(i.onAddComment,i)),t.pmiAddNamedRange.on("click",_.bind(i.onAddNamedRange,i)),t.menuImageArrange.menu.on("item:click",_.bind(i.onImgMenu,i)),t.menuImgRotate.menu.on("item:click",_.bind(i.onImgMenu,i)),t.menuImgCrop.menu.on("item:click",_.bind(i.onImgCrop,i)),t.menuImgResetCrop.on("click",_.bind(i.onImgResetCrop,i)),t.menuImageAlign.menu.on("item:click",_.bind(i.onImgMenuAlign,i)),t.menuShapesMerge.menu.on("item:click",_.bind(i.onShapesMerge,i)),t.menuParagraphVAlign.menu.on("item:click",_.bind(i.onParagraphVAlign,i)),t.menuParagraphDirection.menu.on("item:click",_.bind(i.onParagraphDirection,i)),t.menuParagraphBullets.menu.on("item:click",_.bind(i.onSelectBulletMenu,i)),t.menuParagraphBullets.menu.on("show:after",_.bind(i.onBulletMenuShowAfter,i)),t.menuAddHyperlinkShape.on("click",_.bind(i.onInsHyperlink,i)),t.menuEditHyperlinkShape.on("click",_.bind(i.onInsHyperlink,i)),t.menuRemoveHyperlinkShape.on("click",_.bind(i.onDelHyperlink,i)),t.pmiTextAdvanced.on("click",_.bind(i.onTextAdvanced,i)),t.mnuShapeAdvanced.on("click",_.bind(i.onShapeAdvanced,i)),t.mnuChartEdit.on("click",_.bind(i.onChartEdit,i)),t.mnuChartData.on("click",_.bind(i.onChartData,i)),t.mnuChartType.on("click",_.bind(i.onChartType,i)),t.mnuImgAdvanced.on("click",_.bind(i.onImgAdvanced,i)),t.mnuSlicerAdvanced.on("click",_.bind(i.onSlicerAdvanced,i)),t.textInShapeMenu.on("render:after",_.bind(i.onTextInShapeAfterRender,i)),t.menuSignatureEditSign.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureEditSetup.on("click",_.bind(i.onSignatureClick,i)),t.menuImgOriginalSize.on("click",_.bind(i.onOriginalSizeClick,i)),t.menuImgReplace.menu.on("item:click",_.bind(i.onImgReplace,i)),t.pmiCellFormat.on("click",_.bind(i.onCellFormat,i)),t.pmiNumFormat.menu.on("item:click",_.bind(i.onNumberFormatSelect,i)),t.pmiNumFormat.menu.on("show:after",_.bind(i.onNumberFormatOpenAfter,i)),t.pmiAdvancedNumFormat.on("click",_.bind(i.onCustomNumberFormat,i)),t.tableTotalMenu.on("item:click",_.bind(i.onTotalMenuClick,i)),t.menuImgMacro.on("click",_.bind(i.onImgMacro,i)),t.menuImgEditPoints.on("click",_.bind(i.onImgEditPoints,i)),t.pmiGetRangeList.on("click",_.bind(i.onGetLink,i)),t.menuParagraphEquation.menu.on("item:click",_.bind(i.convertEquation,i)),t.menuSaveAsPicture.on("click",_.bind(i.saveAsPicture,i)),t.fillMenu.on("item:click",_.bind(i.onFillSeriesClick,i)),t.fillMenu.on("hide:after",_.bind(i.onFillSeriesHideAfter,i)),t.menuEditObject.on("click",_.bind(i.onEditObject,i))):(t.menuViewCopy.on("click",_.bind(i.onCopyPaste,i)),t.menuViewUndo.on("click",_.bind(i.onUndo,i)),t.menuViewAddComment.on("click",_.bind(i.onAddComment,i)),t.menuSignatureViewSign.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureDetails.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureViewSetup.on("click",_.bind(i.onSignatureClick,i)),t.menuSignatureRemove.on("click",_.bind(i.onSignatureClick,i)),t.pmiViewGetRangeList.on("click",_.bind(i.onGetLink,i)));var s=function(t,e,i,s){t.addEventListener?t.addEventListener(e,i,s):t.attachEvent("on"+e,i)},n=t.cmpEl;if(n){n.on({mousedown:function(t){"canvas"==t.target.localName&&2!=t.button&&Common.UI.Menu.Manager.hideAll()},click:function(t){if(i.api&&(i.api.isTextAreaBlur=!1,"canvas"==t.target.localName&&(!i.isEditFormula||i.rangeSelectionMode)))if(i._preventClick)i._preventClick=!1;else{if(t.target.getAttribute&&t.target.getAttribute("oo_no_focused"))return;n.focus()}},touchstart:function(t){"canvas"==t.target.localName&&Common.UI.Menu.Manager.hideAll()}});var a=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";s(t.el,a,_.bind(this.onDocumentWheel,this),!1),i.cellEditor=$("#ce-cell-content")}Common.Utils.isChrome?s(document,"mousewheel",_.bind(this.onDocumentWheel,this),{passive:!1}):$(document).on("mousewheel",_.bind(this.onDocumentWheel,this)),this.onChangeProtectSheet()},t.initExternalEditors=function(){var t=this;if(!t.permissions.isEditMailMerge&&!t.permissions.isEditDiagram&&!t.permissions.isEditOle){var e=t.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&(e.on("internalmessage",_.bind((function(i,s){s.data.command;var n=s.data.data;t.api&&e.isEditMode()&&t.api.asc_editTableOleObject(n)}),t)),e.on("hide",_.bind((function(e,i){t.api&&(t.api.asc_enableKeyEvents(!0),t.api.asc_onCloseChartFrame()),setTimeout((function(){t.documentHolder.fireEvent("editcomplete",t.documentHolder)}),10)}),t)))}},t.onEditObject=function(){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.api){var t=this.api.asc_canEditTableOleObject(!0);if(t){var e=this.getApplication().getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}else this.api.asc_startEditCurrentOleObject()}},t.onCopyPaste=function(t){var e=this;if(e.api)if("cut"==t.value?e.api.asc_Cut():"copy"==t.value?e.api.asc_Copy():e.api.asc_Paste())Common.component.Analytics.trackEvent("ToolBar","Copy Warning");else{var i=Common.localStorage.getItem("sse-hide-copywarning");i&&1==parseInt(i)||new Common.Views.CopyWarningDialog({handler:function(t){t&&Common.localStorage.setItem("sse-hide-copywarning",1),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)}}).show()}Common.NotificationCenter.trigger("edit:complete",e.documentHolder)},t.onInsertEntire=function(t){if(this.api){switch(this.api.asc_getCellInfo().asc_getSelectionType()){case Asc.c_oAscSelectionType.RangeRow:this.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertRows);break;case Asc.c_oAscSelectionType.RangeCol:this.api.asc_insertCells(Asc.c_oAscInsertOptions.InsertColumns)}Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert Entire")}},t.onInsertCells=function(t,e){this.api&&(this.api.asc_insertCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert Cells"))},t.onDeleteEntire=function(t){if(this.api){switch(this.api.asc_getCellInfo().asc_getSelectionType()){case Asc.c_oAscSelectionType.RangeRow:this.api.asc_deleteCells(Asc.c_oAscDeleteOptions.DeleteRows);break;case Asc.c_oAscSelectionType.RangeCol:this.api.asc_deleteCells(Asc.c_oAscDeleteOptions.DeleteColumns)}Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete Entire")}},t.onDeleteCells=function(t,e){this.api&&(this.api.asc_deleteCells(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete Cells"))},t.onSortCells=function(t,e){Common.NotificationCenter.trigger("protect:check",this.onSortCellsCallback,this,[t,e])},t.onSortCellsCallback=function(t,e){if("advanced"!=e.value){if(this.api){var i=this.api.asc_sortCellsRangeExpand();switch(i){case Asc.c_oAscSelectionSortExpand.showExpandMessage:var s={width:500,title:this.txtSorting,msg:this.txtExpandSort,buttons:[{caption:this.txtExpand,primary:!0,value:"expand"},{caption:this.txtSortSelected,value:"sort"},"cancel"],callback:_.bind((function(t){"expand"!=t&&"sort"!=t||this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,"expand"==t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")}),this)};Common.UI.alert(s);break;case Asc.c_oAscSelectionSortExpand.showLockMessage:s={width:500,title:this.txtSorting,msg:this.txtLockSort,buttons:["yes","no"],primary:"yes",callback:_.bind((function(t){"yes"==t&&this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,!1),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")}),this)};Common.UI.alert(s);break;case Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage:case Asc.c_oAscSelectionSortExpand.notExpandAndNotShowMessage:this.api.asc_sortColFilter(e.value,"",void 0,e.value==Asc.c_oAscSortOptions.ByColorFill?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor,i===Asc.c_oAscSelectionSortExpand.expandAndNotShowMessage),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Sort Cells")}}}else Common.NotificationCenter.trigger("data:sortcustom",this)},t.onFilterCells=function(t,e){if(this.api){var i=new Asc.AutoFiltersOptions,s=new Asc.AutoFilterObj;if(e.value>0){s.asc_setFilter(new Asc.ColorFilter),s.asc_setType(Asc.c_oAscAutoFilterTypes.ColorFilter);var n=s.asc_getFilter();n.asc_setCellColor(1==e.value&&null),n.asc_setCColor(1==e.value?this.documentHolder.ssMenu.cellColor:this.documentHolder.ssMenu.fontColor)}else{s.asc_setFilter(new Asc.CustomFilters),s.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters);var a=s.asc_getFilter();a.asc_setCustomFilters([new Asc.CustomFilter]),a.asc_setAnd(!0),a.asc_getCustomFilters()[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.equals)}i.asc_setFilterObj(s),this.api.asc_applyAutoFilterByType(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Filter Cells")}},t.onReapply=function(){this.api.asc_reapplyAutoFilter(this.documentHolder.ssMenu.formatTableName)},t.onCondFormat=function(){var t=this,e=t.api.asc_getLocale();!e&&(e=t.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(t.permissions.lang)):1033),new SSE.Views.FormatRulesEditDlg({api:t.api,props:null,isEdit:!1,langId:e,handler:function(e,i){"ok"==e&&i&&t.api.asc_setCF([i],[])}}).show()},t.onRefreshPivot=function(){this.api&&this.propsPivot.originalProps.asc_refresh(this.api)},t.onExpandCollapsePivot=function(t,e,i){this.propsPivot.originalProps.asc_setExpandCollapseByActiveCell(this.api,e.value.isAll,e.value.visible)},t.onGroupPivot=function(t){"grouping"==t.value?this.api.asc_groupPivot():this.api.asc_ungroupPivot()},t.onShowPivotHeaderDetailsDialog=function(t,e){var i=this,s=this.api.asc_getCellInfo().asc_getPivotTableInfo(),n=s.asc_getCacheFields(),a=s.asc_getPivotFields(),o=_.map(a,(function(t,e){return{index:e,name:t.asc_getName()||n[e].asc_getName()}})),l=[];(l=t?s.asc_getRowFields():s.asc_getColumnFields())&&(l=_.filter(l,(function(t){var e=t.asc_getIndex();return e>-1||-2==e}))),l.forEach((function(t){var e=_.findIndex(o,(function(e){return t.asc_getIndex()==e.index}));o.splice(e,1)})),new SSE.Views.PivotShowDetailDialog({handler:function(t,s){"ok"==t&&s&&i.api.asc_pivotShowDetailsHeader(s.index,e)},fieldsNames:o}).show()},t.onShowPivotGroupDialog=function(t,e,i){var s,n,a=this;(s=new SSE.Views.PivotGroupDialog({date:!!e,handler:function(t,e){"ok"==e&&(n=t.getSettings(),a.api.asc_groupPivot(n[0],n[1]),Common.NotificationCenter.trigger("edit:complete",a.documentHolder))}})).show(),s.setSettings(t,e,i)},t.onPivotSettings=function(){var t=this.propsPivot.originalProps;if(t){var e=this;e.api&&new SSE.Views.PivotSettingsAdvanced({props:t,api:e.api,handler:function(i,s){"ok"==i&&e.api&&s&&(t.asc_set(e.api,s),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)}}).show()}},t.onFieldSettings=function(){var t=this.propsPivot.originalProps;if(t){var e=this;if(e.api)if(2===e.propsPivot.fieldType){var i=e.propsPivot.field;new SSE.Views.ValueFieldSettingsDialog({props:t,field:i,showAsValue:e.propsPivot.showAsValue,api:e.api,handler:function(s,n){"ok"===s&&e.api&&n&&(i.asc_set(e.api,t,e.propsPivot.index,n),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)}}).show()}else new SSE.Views.FieldSettingsDialog({props:t,fieldIndex:e.propsPivot.pivotIndex,api:e.api,type:e.propsPivot.fieldType,handler:function(i,s){"ok"===i&&e.api&&s&&(e.propsPivot.field.asc_set(e.api,t,e.propsPivot.pivotIndex,s),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)}}).show()}},t.onDeleteField=function(){if(this.api&&this.propsPivot.originalProps&&this.propsPivot.field)if(2===this.propsPivot.fieldType)if(this.propsPivot.rowTotal||this.propsPivot.colTotal){var t=new Asc.CT_pivotTableDefinition;t.asc_setRowGrandTotals(!this.propsPivot.rowTotal&&this.propsPivot.originalProps.asc_getRowGrandTotals()),t.asc_setColGrandTotals(!this.propsPivot.colTotal&&this.propsPivot.originalProps.asc_getColGrandTotals()),this.propsPivot.originalProps.asc_set(this.api,t)}else this.propsPivot.originalProps.asc_removeDataField(this.api,this.propsPivot.pivotIndex,this.propsPivot.index);else this.propsPivot.originalProps.asc_removeNoDataField(this.api,this.propsPivot.pivotIndex);Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onSubtotalField=function(t){if(this.api&&this.propsPivot.originalProps){var e=new Asc.CT_pivotTableDefinition;t.checked?(e.asc_setDefaultSubtotal(!0),e.asc_setSubtotalTop(!0)):e.asc_setDefaultSubtotal(!1),this.propsPivot.originalProps.asc_set(this.api,e)}},t.onSummarize=function(t,e,i){if(this.propsPivot.originalProps)if(-1===e.value)this.onFieldSettings();else if(void 0!==e.value&&null!==e.value){var s=new Asc.CT_DataField;s.asc_setSubtotal(e.value),this.propsPivot.fieldSourceName&&s.asc_setName(this.txtByField.replace("%1",e.caption).replace("%2",this.propsPivot.fieldSourceName)),this.propsPivot.field.asc_set(this.api,this.propsPivot.originalProps,this.propsPivot.index,s),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}},t.onShowAs=function(t,e,i){if(this.propsPivot.originalProps)if(-1===e.value||e.options.showMore)e.options.showMore&&(this.propsPivot.showAsValue=e.value),this.onFieldSettings();else if(void 0!==e.value&&null!==e.value){var s=new Asc.CT_DataField;s.asc_setShowDataAs(e.value);var n=new Asc.asc_CFormatCellsInfo;n.asc_setType(e.options.numFormat),n.asc_setDecimalPlaces(e.options.numFormat===Asc.c_oAscNumFormatType.Percent?2:0),n.asc_setSeparator(!1),s.asc_setNumFormat(this.api.asc_getFormatCells(n)[0]),this.propsPivot.field.asc_set(this.api,this.propsPivot.originalProps,this.propsPivot.index,s),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}},t.showCustomFilterDlg=function(t,e){var i=t.asc_getFilterObj();if(i.asc_getType()!==Asc.c_oAscAutoFilterTypes.CustomFilters){var s=new Asc.CustomFilters;s.asc_setCustomFilters([new Asc.CustomFilter]);var n=s.asc_getCustomFilters();n[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.equals),s.asc_setAnd(!0),n[0].asc_setVal(""),i.asc_setFilter(s),i.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)}var a=this,o=new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:e}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",a.documentHolder)}});o.setSettings(t),o.show()},t.onPivotFilter=function(t,e,i){if(this.propsPivot.filter){var s=this.propsPivot.filter,n=this;if("value"===e.value)s.asc_getPivotObj().asc_getDataFields().length<2?Common.UI.warning({title:this.textWarning,msg:this.warnFilterError,callback:function(){Common.NotificationCenter.trigger("edit:complete",n.documentHolder)}}):this.showCustomFilterDlg(s,e.value);else if("label"===e.value)this.showCustomFilterDlg(s,e.value);else if("top10"===e.value){var a=new SSE.Views.Top10FilterDialog({api:this.api,type:"value"}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",n.documentHolder)}});a.setSettings(s),a.show()}else"clear"===e.value&&(this.api.asc_clearFilterColumn(s.asc_getCellId(),s.asc_getDisplayName()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))}},t.onPivotSort=function(t,e,i){if(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter){var s=this;if("advanced"===e.value){var n=new SSE.Views.SortFilterDialog({api:this.api}).on({close:function(){Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}});n.setSettings({filter:this.propsPivot.filter,rowFilter:this.propsPivot.rowFilter,colFilter:this.propsPivot.colFilter}),n.show()}else{var a=this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter;this.api.asc_sortColFilter(e.value,a.asc_getCellId(),a.asc_getDisplayName()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}}},t.onShowDetails=function(t,e){this.propsPivot.originalProps&&this.api&&this.api.asc_pivotShowDetails(this.propsPivot.originalProps)},t.fillPivotProps=function(){var t=this.propsPivot.originalProps;if(t){var e=this.api.asc_getPivotInfo(),i=e.asc_getPageFieldIndex(),s=e.asc_getColFieldIndex(),n=e.asc_getRowFieldIndex(),a=e.asc_getDataFieldIndex();if(this.propsPivot.canExpandCollapse=e.asc_canExpandCollapse(),this.propsPivot.canGroup=e.asc_canGroup(),this.propsPivot.rowTotal=e.asc_getRowGrandTotals(),this.propsPivot.colTotal=e.asc_getColGrandTotals(),this.propsPivot.filter=e.asc_getFilter(),this.propsPivot.rowFilter=e.asc_getFilterRow(),this.propsPivot.colFilter=e.asc_getFilterCol(),this.propsPivot.showDetails=e.asc_showDetails(),s>-1){if(o=t.asc_getColumnFields())(l=o[s].asc_getIndex())>-1&&(this.propsPivot.pivotIndex=l,this.propsPivot.index=s,this.propsPivot.field=t.asc_getPivotFields()[l],this.propsPivot.fieldType=0,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||t.asc_getCacheFields()[l].asc_getName())}else if(n>-1){if(o=t.asc_getRowFields())(l=o[n].asc_getIndex())>-1&&(this.propsPivot.pivotIndex=l,this.propsPivot.index=n,this.propsPivot.field=t.asc_getPivotFields()[l],this.propsPivot.fieldType=1,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||t.asc_getCacheFields()[l].asc_getName())}else if(i>-1){var o,l;if(o=t.asc_getPageFields())(l=o[i].asc_getIndex())>-1&&(this.propsPivot.pivotIndex=l,this.propsPivot.index=i,this.propsPivot.field=t.asc_getPivotFields()[l],this.propsPivot.fieldType=3,this.propsPivot.fieldName=this.propsPivot.field.asc_getName()||t.asc_getCacheFields()[l].asc_getName())}if(a>-1)if(o=t.asc_getDataFields())(l=o[a].asc_getIndex())>-1&&(this.propsPivot.pivotIndex=l,this.propsPivot.index=a,this.propsPivot.field=o[a],this.propsPivot.fieldType=2,this.propsPivot.fieldName=this.propsPivot.field.asc_getName(),this.propsPivot.fieldSourceName=t.asc_getCacheFields()[l].asc_getName())}},t.onClear=function(t,e,i){e.value==Asc.c_oAscCleanOptions.Format&&!this._state.wsProps.FormatCells||e.value==Asc.c_oAscCleanOptions.All&&!this.api.asc_checkLockedCells()?this.onClearCallback(t,e):e.value==Asc.c_oAscCleanOptions.Comments?this._state.wsProps.Objects?Common.NotificationCenter.trigger("showerror",Asc.c_oAscError.ID.ChangeOnProtectedSheet,Asc.c_oAscError.Level.NoCritical):this.onClearCallback(t,e):Common.NotificationCenter.trigger("protect:check",this.onClearCallback,this,[t,e])},t.onClearCallback=function(t,e){this.api&&(e.value==Asc.c_oAscCleanOptions.Comments?this.api.asc_RemoveAllComments(!this.permissions.canDeleteComments,!0):this.api.asc_emptyCells(e.value,e.value==Asc.c_oAscCleanOptions.All&&!this.permissions.canDeleteComments),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Clear"))},t.onSelectTable=function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_changeSelectionFormatTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Select Table"))},t.onInsertTable=function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_insertCellsInTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Insert to Table"))},t.onDeleteTable=function(t,e){this.api&&this.documentHolder.ssMenu.formatTableName&&(this.api.asc_deleteCellsInTable(this.documentHolder.ssMenu.formatTableName,e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Delete from Table"))},t.onInsFunction=function(t){var e=this.getApplication().getController("FormulaDialog");e&&this.api&&e.showDialog(void 0,t.value==Asc.ETotalsRowFunction.totalrowfunctionCustom)},t.onInsHyperlink=function(t){Common.NotificationCenter.trigger("protect:check",this.onInsHyperlinkCallback,this,[t])},t.onInsHyperlinkCallback=function(t){var e,i,s=this;if(s.api){for(var n=s.api.asc_getWorksheetsCount(),a=-1,o=[];++a<n;)o.push({name:s.api.asc_getWorksheetName(a),hidden:s.api.asc_isWorksheetHidden(a)});var l=s.api.asc_getCellInfo();i=l.asc_getHyperlink(),(e=new SSE.Views.HyperlinkSettingsDialog({api:s.api,appOptions:s.permissions,handler:function(t,e){"ok"==e&&(i=t.getSettings(),s.api.asc_insertHyperlink(i)),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}})).show(),e.setSettings({sheets:o,ranges:s.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All,!0),currentSheet:s.api.asc_getActiveWorksheetIndex(),props:i,text:l.asc_getText(),isLock:l.asc_getLockText(),allowInternal:t.options.inCell})}Common.component.Analytics.trackEvent("DocumentHolder","Add Hyperlink")},t.onDelHyperlink=function(t){Common.NotificationCenter.trigger("protect:check",this.onDelHyperlinkCallback,this)},t.onDelHyperlinkCallback=function(t){this.api&&(this.api.asc_removeHyperlink(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Remove Hyperlink"))},t.onSetSize=function(t,e){if("row-height"==e.value||"column-width"==e.value){var i=this;new SSE.Views.SetValueDialog({title:e.caption,startvalue:"row-height"==e.value?i.api.asc_getRowHeight():i.api.asc_getColumnWidth(),maxvalue:"row-height"==e.value?Asc.c_oAscMaxRowHeight:Asc.c_oAscMaxColumnWidth,step:"row-height"==e.value?.75:1,rounding:"row-height"==e.value,defaultUnit:"row-height"==e.value?Common.Utils.Metric.getMetricName(Common.Utils.Metric.c_MetricUnits.pt):i.textSym,handler:function(t,s){if("ok"==s){var n=t.getSettings();isNaN(n)||("row-height"==e.value?i.api.asc_setRowHeight(n):i.api.asc_setColumnWidth(n))}Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}}).show()}else"auto-row-height"==e.value?this.api.asc_autoFitRowHeight():this.api.asc_autoFitColumnWidth(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onEntireHide=function(t){this.api&&this.api[t.isrowmenu?"asc_hideRows":"asc_hideColumns"]()},t.onEntireShow=function(t){this.api&&this.api[t.isrowmenu?"asc_showRows":"asc_showColumns"]()},t.onFreezePanes=function(t){this.api&&this.api.asc_freezePane()},t.onEntriesList=function(t){if(this.api){var e=this;setTimeout((function(){e.api.asc_showAutoComplete()}),10)}},t.onAddNamedRange=function(t){if(this.namedrange_locked)Common.NotificationCenter.trigger("namedrange:locked");else{for(var e=this,i=e.api.asc_getWorksheetsCount(),s=-1,n=[];++s<i;)this.api.asc_isWorksheetHidden(s)||n.push({displayValue:e.api.asc_getWorksheetName(s),value:s});new SSE.Views.NamedRangeEditDlg({api:e.api,handler:function(t,i){"ok"==t&&i&&(e.api.asc_setDefinedNames(i),Common.component.Analytics.trackEvent("DocumentHolder","New Named Range")),Common.NotificationCenter.trigger("edit:complete",e.documentHolder)},sheets:n,currentSheet:e.api.asc_getActiveWorksheetIndex(),props:e.api.asc_getDefaultDefinedName(),isEdit:!1}).show()}},t.onImgMenu=function(t,e){if(this.api)if("arrange"==e.options.type)this.api.asc_setSelectedDrawingObjectLayer(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Arrange");else if("group"==e.options.type)this.api["grouping"==e.value?"asc_groupGraphicsObjects":"asc_unGroupGraphicsObjects"](),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","grouping"==e.value?"Grouping":"Ungrouping");else if("rotate"==e.options.type){(i=new Asc.asc_CImgProperty).asc_putRotAdd(3.14159265358979*(1==e.value?90:270)/180),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Rotate")}else if("flip"==e.options.type){var i=new Asc.asc_CImgProperty;1==e.value?i.asc_putFlipHInvert(!0):i.asc_putFlipVInvert(!0),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Flip")}},t.onImgCrop=function(t,e){this.api&&(1==e.value?this.api.asc_cropFill():2==e.value?this.api.asc_cropFit():e.checked?this.api.asc_startEditCrop():this.api.asc_endEditCrop()),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onImgResetCrop=function(){if(this.api){var t=new Asc.asc_CImgProperty;t.put_ResetCrop(!0)}this.api.asc_setGraphicObjectProps(t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onImgMenuAlign=function(t,e){this.api&&(e.value>-1&&e.value<6?(this.api.asc_setSelectedDrawingObjectAlign(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Objects Align")):6==e.value?(this.api.asc_DistributeSelectedDrawingObjectHor(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Distribute")):7==e.value&&(this.api.asc_DistributeSelectedDrawingObjectVer(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Distribute")))},t.onShapesMerge=function(t,e,i){e&&e.value&&(this.api.asc_mergeSelectedShapes(e.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Shapes Merge"))},t.onParagraphVAlign=function(t,e){if(this.api){var i=new Asc.asc_CImgProperty;i.asc_putVerticalTextAlign(e.value),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Paragraph Vertical Align")}},t.onParagraphDirection=function(t,e){if(this.api){var i=new Asc.asc_CImgProperty;i.asc_putVert(e.options.direction),this.api.asc_setGraphicObjectProps(i),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Text Direction")}},t.onSelectBulletMenu=function(t,e){if(this.api)if(-1==e.options.value)this.api.asc_setListType(0,e.options.value),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","List Type");else if("settings"==e.options.value){for(var i,s=this,n=s.api.asc_getGraphicObjectProps(),a=0;a<n.length;a++)if(n[a].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){i=n[a].asc_getObjectValue();break}if(i){s.api.asc_getCurrentListType();new Common.Views.ListSettingsDialog({api:s.api,props:i,type:0,storage:s.permissions.canRequestInsertImage||s.permissions.fileChoiceUrl&&s.permissions.fileChoiceUrl.indexOf("{documentType}")>-1,interfaceLang:s.permissions.lang,handler:function(t,e){"ok"==t&&s.api&&(i.asc_putBullet(e),s.api.asc_setGraphicObjectProps(i)),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}}).show()}}},t.onSelectBullets=function(t,e,i,s){var n={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;n=i.toJSON()}else n=i;if(0===n.type&&4096===n.subtype){var a=n.customBullet;if(a)for(var o,l=this.api.asc_getGraphicObjectProps(),r=0;r<l.length;r++)if(l[r].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Paragraph){(o=l[r].asc_getObjectValue()).asc_putBullet(a),this.api.asc_setGraphicObjectProps(o);break}}else this.api.asc_setListType(n.type,n.subtype);"click"!==s.type&&this.documentHolder.textInShapeMenu.hide(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","List Type")},t.onTextAdvanced=function(t){var e=this;new SSE.Views.ParagraphSettingsAdvanced({paragraphProps:t.textInfo,api:e.api,handler:function(t,i){"ok"==t&&e.api&&(e.api.asc_setGraphicObjectProps(i.paragraphProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced paragraph settings")),Common.NotificationCenter.trigger("edit:complete",e)}}).show()},t.onShapeAdvanced=function(t){var e=this;new SSE.Views.ShapeSettingsAdvanced({shapeProps:t.shapeInfo,api:e.api,handler:function(t,i){"ok"==t&&e.api&&(e.api.asc_setGraphicObjectProps(i.shapeProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced shape settings")),Common.NotificationCenter.trigger("edit:complete",e)}}).show()},t.onImgAdvanced=function(t){var e=this;new SSE.Views.ImageSettingsAdvanced({imageProps:t.imageInfo,api:e.api,handler:function(t,i){"ok"==t&&e.api&&(e.api.asc_setGraphicObjectProps(i.imageProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply advanced image settings")),Common.NotificationCenter.trigger("edit:complete",e)}}).show()},t.onSlicerAdvanced=function(t){var e=this;new SSE.Views.SlicerSettingsAdvanced({imageProps:t.imageInfo,api:e.api,styles:t.imageInfo.asc_getSlicerProperties().asc_getStylesPictures(),handler:function(t,i){"ok"==t&&e.api&&(e.api.asc_setGraphicObjectProps(i.imageProps),Common.component.Analytics.trackEvent("DocumentHolder","Apply slicer settings")),Common.NotificationCenter.trigger("edit:complete",e)}}).show()},t.onChartEdit=function(t){var e,i=this;i.api&&(e=i.api.asc_getChartObject())&&new SSE.Views.ChartSettingsDlg({chartSettings:e,imageSettings:t.chartInfo,isChart:!0,api:i.api,handler:function(t,e){"ok"==t&&i.api&&(i.api.asc_editChartDrawingObject(e.chartSettings),e.imageSettings&&i.api.asc_setGraphicObjectProps(e.imageSettings)),Common.NotificationCenter.trigger("edit:complete",i)}}).show()},t.onChartData=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()){var e,i=this;if(i.api)if(e=i.api.asc_getChartObject())i._isEditRanges=!0,e.startEdit(),new SSE.Views.ChartDataDialog({chartSettings:e,api:i.api,handler:function(t,s){"ok"==t&&(e.endEdit(),i._isEditRanges=!1),Common.NotificationCenter.trigger("edit:complete",i)}}).on("close",(function(){i._isEditRanges&&e.cancelEdit(),i._isEditRanges=!1})).show()}},t.onChartType=function(t){var e,i=this;i.api&&((e=i.api.asc_getChartObject())&&(i._isEditType=!0,e.startEdit(),new SSE.Views.ChartTypeDialog({chartSettings:e,api:i.api,handler:function(t,s){"ok"==t&&(e.endEdit(),i._isEditType=!1),Common.NotificationCenter.trigger("edit:complete",i)}}).on("close",(function(){i._isEditType&&e.cancelEdit(),i._isEditType=!1})).show()))},t.onImgMacro=function(t){var e=this;new SSE.Views.MacroDialog({props:{macroList:e.api.asc_getAllMacrosNames(),current:e.api.asc_getCurrentDrawingMacrosName()},handler:function(t,i){"ok"==t&&e.api&&e.api.asc_assignMacrosToCurrentDrawing(i),Common.NotificationCenter.trigger("edit:complete",e)}}).show()},t.onImgEditPoints=function(t){this.api&&this.api.asc_editPointsGeometry()},t.onGetLink=function(t){if(this.api){var e=this.api.asc_getActiveRangeStr(Asc.referenceType.A,!1,!0),i=this.api.asc_getEscapeSheetName(this.api.asc_getWorksheetName(this.api.asc_getActiveWorksheetIndex()));(i=i+(""!==i&&""!==e?"!":"")+e)&&Common.Gateway.requestMakeActionLink({action:{type:"internallink",data:i}})}},t.onSetActionLink=function(t){if(!Common.Utils.InternalSettings.get("sse-dialog-link-visible")){var e=this;navigator.clipboard&&navigator.clipboard.writeText(t).then((function(){Common.NotificationCenter.trigger("showmessage",{msg:e.txtCopySuccess},{timeout:3e3,hideCloseTip:!0})})).catch((function(t){console.log(t)}))}},t.onApiMouseMove=function(t){if(!this._isFullscreenMenu&&t.length){for(var e,i,s,n,a,o,l,r,c,d,h=t.length;h>0;h--)switch(t[h-1].asc_getType()){case Asc.c_oAscMouseMoveType.Hyperlink:e=h;break;case Asc.c_oAscMouseMoveType.Comment:i=h;break;case Asc.c_oAscMouseMoveType.LockedObject:s=h;break;case Asc.c_oAscMouseMoveType.ResizeColumn:n=h;break;case Asc.c_oAscMouseMoveType.ResizeRow:a=h;break;case Asc.c_oAscMouseMoveType.Filter:o=h;break;case Asc.c_oAscMouseMoveType.Tooltip:l=h;break;case Asc.c_oAscMouseMoveType.ForeignSelect:r=h;break;case Asc.c_oAscMouseMoveType.Eyedropper:c=h;break;case Asc.c_oAscMouseMoveType.Placeholder:d=h}var p=this,u=[0,0],m=p.tooltips.coauth,g=p.tooltips.comment,b=p.tooltips.hyperlink,f=p.tooltips.row_column,v=p.tooltips.filter,C=p.tooltips.slicer,x=p.tooltips.foreignSelect,y=p.tooltips.eyedropper,_=p.tooltips.placeholder,A=[Common.Utils.getOffset(p.documentHolder.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(p.documentHolder.cmpEl).top-$(window).scrollTop()];if(e||p.hideHyperlinkTip(),void 0===n&&void 0===a&&!f.isHidden&&f.ref&&(f.ref.hide(),f.ref=void 0,f.text="",f.isHidden=!0),r||p.hideForeignSelectTips(),(p.permissions.isEdit||p.permissions.canViewComments)&&(!i||this.popupmenu)&&(g.moveCommentId=void 0,null!=g.viewCommentId)){g={};var w=this.getApplication().getController("Common.Controllers.Comments");w&&(this.permissions.canCoAuthoring&&this.permissions.canViewComments?setTimeout((function(){w.onApiHideComment(!0)}),200):w.onApiHideComment(!0))}if(p.permissions.isEdit&&(s||p.hideCoAuthTips(),void 0===l&&!C.isHidden&&C.ref&&(C.ref.hide(),C.ref=void 0,C.text="",C.isHidden=!0),d||p.hidePlaceholderTip()),(void 0===o||p.dlgFilter&&p.dlgFilter.isVisible()||p.currentMenu&&p.currentMenu.isVisible())&&!v.isHidden&&v.ref&&(v.ref.hide(),v.ref=void 0,v.text="",v.isHidden=!0),c||p.hideEyedropperTip(),e){b.parentEl||(b.parentEl=$('<div id="tip-container-hyperlinktip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(b.parentEl));var S=(I=t[e-1]).asc_getHyperlink();if(S.asc_getType()==Asc.c_oAscHyperlinkType.WebLink){var k=S.asc_getTooltip();(k=k||S.asc_getHyperlinkUrl()).length>256&&(k=k.substr(0,256)+"..."),k=Common.Utils.String.htmlEncode(k)+"<br><b>"+p.textCtrlClick+"</b>"}else k=Common.Utils.String.htmlEncode(S.asc_getTooltip()||S.asc_getLocation()),k+="<br><b>"+p.textCtrlClick+"</b>";if(b.ref&&b.ref.isVisible()&&b.text!=k&&(b.ref.hide(),b.ref=void 0,b.text="",b.isHidden=!0),!b.ref||!b.ref.isVisible()){b.text=k,b.ref=new Common.UI.Tooltip({owner:b.parentEl,html:!0,title:k}),b.ref.show([-1e4,-1e4]),b.isHidden=!1,(u=[I.asc_getX(),I.asc_getY()])[0]+=A[0]+6,u[1]+=A[1]-20,u[1]-=b.ref.getBSTip().$tip.height();var T=b.ref.getBSTip().$tip.width();u[0]+T>p.tooltips.coauth.bodyWidth&&(u[0]=p.tooltips.coauth.bodyWidth-T),b.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}if(void 0!==n||void 0!==a){f.parentEl||(f.parentEl=$('<div id="tip-container-rowcolumntip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(f.parentEl));var I=t[void 0!==n?n-1:a-1],D=Common.Utils.String.format(void 0!==n?this.textChangeColumnWidth:this.textChangeRowHeight,I.asc_getSizeCCOrPt().toFixed(2),I.asc_getSizePx().toFixed());if(f.ref&&f.ref.isVisible()&&f.text!=D&&(f.text=D,f.ref.setTitle(D),f.ref.updateTitle()),!f.ref||!f.ref.isVisible()){f.text=D,f.ref=new Common.UI.Tooltip({owner:f.parentEl,html:!0,title:D}),f.ref.show([-1e4,-1e4]),f.isHidden=!1,(u=[I.asc_getX(),I.asc_getY()])[0]+=A[0]+6,u[1]+=A[1]-20-f.ttHeight;T=f.ref.getBSTip().$tip.width();u[0]+T>p.tooltips.coauth.bodyWidth&&(u[0]=p.tooltips.coauth.bodyWidth-T-20),f.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}if((p.permissions.isEdit||p.permissions.canViewComments)&&i&&!this.popupmenu&&(I=t[i-1],!g.editCommentId&&g.moveCommentId!=I.asc_getCommentIndexes()[0])){g.moveCommentId=I.asc_getCommentIndexes()[0],g.moveCommentTimer&&clearTimeout(g.moveCommentTimer);var V=I.asc_getCommentIndexes(),P=I.asc_getX(),F=I.asc_getY(),R=I.asc_getReverseX();g.moveCommentTimer=setTimeout((function(){if(g.moveCommentId&&!g.editCommentId){g.viewCommentId=g.moveCommentId;var t=p.getApplication().getController("Common.Controllers.Comments");t&&(t.isSelectedComment||t.onApiShowComment(V,P,F,R,!1,!0))}}),400)}if(p.permissions.isEdit){if(s&&p.isUserVisible(t[s-1].asc_getUserId())&&(I=t[s-1],m.XY||p.onDocumentResize(),m.x_point!=I.asc_getX()||m.y_point!=I.asc_getY())){p.hideCoAuthTips(),m.x_point=I.asc_getX(),m.y_point=I.asc_getY();var U=$(document.createElement("div")),E=I.asc_getLockedObjectType()==Asc.c_oAscMouseMoveLockedObjectType.Sheet||I.asc_getLockedObjectType()==Asc.c_oAscMouseMoveLockedObjectType.TableProperties;m.ref=U,U.addClass("username-tip"),U.css({height:m.ttHeight+"px",position:"absolute",zIndex:"900",visibility:"visible"}),$(document.body).append(U),(u=[E?m.x_point+m.rightMenuWidth:m.bodyWidth-(m.x_point+m.XY[0]),m.y_point+m.XY[1]])[1]>=m.XY[1]&&u[1]+m.ttHeight<m.XY[1]+m.apiHeight&&(U.text(p.getUserName(I.asc_getUserId())),m.bodyWidth-u[0]<m.ref.outerWidth()?U.css({visibility:"visible",left:"0px",top:u[1]-m.ttHeight+"px"}):U.css({visibility:"visible",right:u[0]+"px",top:u[1]+"px"}))}if(d){var L;switch(_.parentEl||(_.parentEl=$('<div id="tip-container-placeholdertip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(_.parentEl)),(I=t[d-1]).asc_getPlaceholderType()){case AscCommon.PlaceholderButtonType.Image:L=p.documentHolder.txtInsImage;break;case AscCommon.PlaceholderButtonType.ImageUrl:L=p.documentHolder.txtInsImageUrl}if(_.ref&&_.ref.isVisible()&&_.text!=L&&(_.ref.hide(),_.ref=void 0,_.text="",_.isHidden=!0),!_.ref||!_.ref.isVisible()){_.text=L,_.ref=new Common.UI.Tooltip({owner:_.parentEl,html:!0,title:L}),_.ref.show([-1e4,-1e4]),_.isHidden=!1,(u=[I.asc_getX(),I.asc_getY()])[0]+=A[0]+6,u[1]+=A[1]-20,u[1]-=_.ref.getBSTip().$tip.height();T=_.ref.getBSTip().$tip.width();u[0]+T>p.tooltips.coauth.bodyWidth&&(u[0]=p.tooltips.coauth.bodyWidth-T),_.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}}if(r&&p.isUserVisible(t[r-1].asc_getUserId())&&(I=t[r-1],m.XY||p.onDocumentResize(),x.x_point!=I.asc_getX()||x.y_point!=I.asc_getY())){p.hideForeignSelectTips(),x.x_point=I.asc_getX(),x.y_point=I.asc_getY();U=$(document.createElement("div"));var M=I.asc_getColor();x.ref=U,x.userId=I.asc_getUserId(),U.addClass("username-tip"),U.css({height:x.ttHeight+"px",position:"absolute",zIndex:"900",visibility:"visible","background-color":"#"+Common.Utils.ThemeColor.getHexColor(M.get_r(),M.get_g(),M.get_b())}),$(document.body).append(U),u=[x.x_point+m.XY[0],x.y_point+m.XY[1]-x.ttHeight],U.text(p.getUserName(I.asc_getUserId())),U.css({visibility:"visible",left:(u[0]+x.ref.outerWidth()>m.bodyWidth-m.rightMenuWidth?m.bodyWidth-m.rightMenuWidth-x.ref.outerWidth():u[0])+"px",top:u[1]+"px"})}if(!(void 0===o||p.dlgFilter&&p.dlgFilter.isVisible()||p.currentMenu&&p.currentMenu.isVisible()||t[o-1].asc_getFilter().asc_getPivotObj())){v.parentEl||(v.parentEl=$('<div id="tip-container-filtertip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(v.parentEl));I=t[o-1],D=p.makeFilterTip(I.asc_getFilter());if(v.ref&&v.ref.isVisible()&&v.text!=D&&(v.text=D,v.ref.setTitle(D),v.ref.updateTitle()),!v.ref||!v.ref.isVisible()){v.text=D,v.ref=new Common.UI.Tooltip({owner:v.parentEl,html:!0,title:D,cls:"auto-tooltip"}),v.ref.show([-1e4,-1e4]),v.isHidden=!1,u=[I.asc_getX()+A[0]-10,I.asc_getY()+A[1]+20];var B=v.ref.getBSTip().$tip.height();u[1]+B>p.tooltips.coauth.bodyHeight&&(u[1]=p.tooltips.coauth.bodyHeight-B-5,u[0]+=20);T=v.ref.getBSTip().$tip.width();u[0]+T>p.tooltips.coauth.bodyWidth&&(u[0]=p.tooltips.coauth.bodyWidth-T-20),v.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}if(void 0!==l&&p.permissions.isEdit){C.parentEl||(C.parentEl=$('<div id="tip-container-slicertip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(C.parentEl));D=(I=t[l-1]).asc_getTooltip();if(C.ref&&C.ref.isVisible()&&C.text!=D&&(C.text=D,C.ref.setTitle(Common.Utils.String.htmlEncode(D)),C.ref.updateTitle()),!C.ref||!C.ref.isVisible()){C.text=D,C.ref=new Common.UI.Tooltip({owner:C.parentEl,html:!0,title:Common.Utils.String.htmlEncode(D)}),C.ref.show([-1e4,-1e4]),C.isHidden=!1,(u=[I.asc_getX(),I.asc_getY()])[0]+=A[0]+6,u[1]+=A[1]-20-C.ttHeight;T=C.ref.getBSTip().$tip.width();u[0]+T>p.tooltips.coauth.bodyWidth&&(u[0]=p.tooltips.coauth.bodyWidth-T-20),C.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}if(c){y.isHidden=!1,y.ref&&(y.ref.hide(),y.ref=void 0);var N=(M=(I=t[c-1]).asc_getColor()).get_r(),O=M.get_g(),H=M.get_b();if(null!=N){var W=Common.Utils.ThemeColor.getHexColor(N,O,H),z=M.asc_getName();if(!y.color){var G=$(document.createElement("div"));G.addClass("eyedropper-color"),G.appendTo(document.body),y.color=G}y.color.css({backgroundColor:"#"+W,left:I.asc_getX()+A[0]+23+"px",top:I.asc_getY()+A[1]-53+"px"}),y.tipInterval&&clearInterval(y.tipInterval),y.tipInterval=setInterval((function(){if(clearInterval(y.tipInterval),!p.tooltips.eyedropper.isHidden){y.parentEl||(y.parentEl=$('<div id="tip-container-eyedroppertip" style="position: absolute; z-index: 10000;"></div>'),p.documentHolder.cmpEl.append(y.parentEl));var t="<div>RGB ("+N+","+O+","+H+")</div><div>"+z+"</div>";y.ref||(y.ref=new Common.UI.Tooltip({owner:y.parentEl,html:!0,title:t,cls:"eyedropper-tooltip"})),y.ref.show([-1e4,-1e4]),y.tipWidth=y.ref.getBSTip().$tip.width(),(u=[I.asc_getX(),I.asc_getY()])[1]+=A[1]-57,u[0]+=A[0]+58,u[0]+y.tipWidth>p.tooltips.coauth.bodyWidth&&(u[0]=u[0]-y.tipWidth-40),y.ref.getBSTip().$tip.css({top:u[1]+"px",left:u[0]+"px"})}}),800)}}}},t.onApiHyperlinkClick=function(t){if(t){var e=this.api.asc_getUrlType(t);e===AscCommon.c_oAscUrlType.Http||e===AscCommon.c_oAscUrlType.Email?window.open(t,"_blank"):Common.UI.warning({msg:this.txtWarnUrl,buttons:["yes","no"],primary:"yes",callback:function(e){try{"yes"==e&&window.open(t,"_blank")}catch(t){t&&console.log(t.stack)}}})}else Common.UI.alert({msg:this.errorInvalidLink,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:_.bind((function(t){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}),this)})},t.onApiAutofilter=function(t){var e=this;if(!e.tooltips.filter.isHidden&&e.tooltips.filter.ref&&(e.tooltips.filter.ref.hide(),e.tooltips.filter.ref=void 0,e.tooltips.filter.text="",e.tooltips.filter.isHidden=!0),e.permissions.isEdit)if(e.dlgFilter)e.dlgFilter.close();else{if(e._state.wsProps.PivotTables&&t.asc_getPivotObj()||e._state.wsProps.AutoFilter&&!t.asc_getPivotObj())return;e.dlgFilter=new SSE.Views.AutoFilterDialog({api:this.api}).on({close:function(){e.api&&e.api.asc_enableKeyEvents(!0),e.dlgFilter=void 0}}),e.api&&e.api.asc_enableKeyEvents(!1),Common.UI.Menu.Manager.hideAll(),e.dlgFilter.setSettings(t);var i=Common.Utils.getOffset(e.documentHolder.cmpEl),s=t.asc_getCellCoord(),n=s.asc_getX()+s.asc_getWidth()+i.left,a=s.asc_getY()+s.asc_getHeight()+i.top,o=Common.Utils.innerWidth(),l=Common.Utils.innerHeight();n+e.dlgFilter.options.width>o&&(n=o-e.dlgFilter.options.width-5),a+e.dlgFilter.options.height>l&&(a=l-e.dlgFilter.options.height-5),e.dlgFilter.show(n,a)}},t.makeFilterTip=function(t){var e=t.asc_getFilterObj(),i=e.asc_getType(),s=(t.asc_getIsTextFilter(),t.asc_getColorsFill(),t.asc_getColorsFont(),"");if(i===Asc.c_oAscAutoFilterTypes.CustomFilters){var n=e.asc_getFilter(),a=n.asc_getCustomFilters();s=this.getFilterName(Asc.c_oAscAutoFilterTypes.CustomFilters,a[0].asc_getOperator())+' "'+Common.Utils.String.htmlEncode(a[0].asc_getVal())+'"',a.length>1&&(s=(s=s+" "+(n.asc_getAnd()?this.txtAnd:this.txtOr))+" "+this.getFilterName(Asc.c_oAscAutoFilterTypes.CustomFilters,a[1].asc_getOperator())+' "'+Common.Utils.String.htmlEncode(a[1].asc_getVal())+'"')}else if(i===Asc.c_oAscAutoFilterTypes.ColorFilter){var o=e.asc_getFilter();null===o.asc_getCellColor()?s=this.txtEqualsToCellColor:!1===o.asc_getCellColor()&&(s=this.txtEqualsToFontColor)}else if(i===Asc.c_oAscAutoFilterTypes.DynamicFilter)s=this.getFilterName(Asc.c_oAscAutoFilterTypes.DynamicFilter,e.asc_getFilter().asc_getType());else if(i===Asc.c_oAscAutoFilterTypes.Top10){var l=e.asc_getFilter(),r=l.asc_getPercent();s=this.getFilterName(Asc.c_oAscAutoFilterTypes.Top10,l.asc_getTop()),s+=" "+l.asc_getVal()+" "+(r||null===r?this.txtPercent:this.txtItems)}else if(i===Asc.c_oAscAutoFilterTypes.Filters){var c=0,d=0,h=void 0,p=t.asc_getValues();p.forEach((function(t){t.asc_getVisible()&&(d++,c<100&&t.asc_getText()&&(s+=Common.Utils.String.htmlEncode(t.asc_getText())+"; ",c=s.length)),t.asc_getText()||(h=t.asc_getVisible())})),d==p.length?s=this.txtAll:1==d&&h?s=this.txtEquals+' "'+this.txtBlanks+'"':d==p.length-1&&0==h?s=this.txtNotEquals+' "'+this.txtBlanks+'"':(h&&(s+=this.txtBlanks+"; "),s=this.txtEquals+' "'+s.substring(0,s.length-2)+'"')}else i===Asc.c_oAscAutoFilterTypes.None&&(s=this.txtAll);s.length>100&&(s=s.substring(0,100)+"...");var u=t.asc_getColumnName();return u&&(u=u.replace(/\n/g," ")),u.length>100&&(u=u.substring(0,100)+"..."),s="<b>"+(Common.Utils.String.htmlEncode(u)||"("+this.txtColumn+" "+Common.Utils.String.htmlEncode(t.asc_getSheetColumnName())+")")+":</b><br>"+s},t.getFilterName=function(t,e){var i="";if(t==Asc.c_oAscAutoFilterTypes.CustomFilters)switch(e){case Asc.c_oAscCustomAutoFilter.equals:i=this.txtEquals;break;case Asc.c_oAscCustomAutoFilter.isGreaterThan:i=this.txtGreater;break;case Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:i=this.txtGreaterEquals;break;case Asc.c_oAscCustomAutoFilter.isLessThan:i=this.txtLess;break;case Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo:i=this.txtLessEquals;break;case Asc.c_oAscCustomAutoFilter.doesNotEqual:i=this.txtNotEquals;break;case Asc.c_oAscCustomAutoFilter.beginsWith:i=this.txtBegins;break;case Asc.c_oAscCustomAutoFilter.doesNotBeginWith:i=this.txtNotBegins;break;case Asc.c_oAscCustomAutoFilter.endsWith:i=this.txtEnds;break;case Asc.c_oAscCustomAutoFilter.doesNotEndWith:i=this.txtNotEnds;break;case Asc.c_oAscCustomAutoFilter.contains:i=this.txtContains;break;case Asc.c_oAscCustomAutoFilter.doesNotContain:i=this.txtNotContains}else if(t==Asc.c_oAscAutoFilterTypes.DynamicFilter)switch(e){case Asc.c_oAscDynamicAutoFilter.aboveAverage:i=this.txtAboveAve;break;case Asc.c_oAscDynamicAutoFilter.belowAverage:i=this.txtBelowAve}else t==Asc.c_oAscAutoFilterTypes.Top10&&(i=e||null===e?this.txtFilterTop:this.txtFilterBottom);return i},t.onUndo=function(){this.api&&(this.api.asc_Undo(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder))},t.onSelectionChanged=function(t){if(!this.mouse.isLeftButtonDown&&!this.rangeSelectionMode&&this.currentMenu&&this.currentMenu.isVisible()&&(this.permissions.isEdit&&!this._isDisabled?this.fillMenuProps(t,!0):this.fillViewMenuProps(t,!0)),this.dlgFilter&&this.dlgFilter.isVisible()&&this.dlgFilter.close(),this.mouse.isLeftButtonDown&&this.permissions&&this.permissions.isEdit){for(var e=this.api.asc_getGraphicObjectProps(),i=-1,s=!1,n=!1;++i<e.length;){var a=e[i].asc_getObjectType();if(a===Asc.c_oAscTypeSelectElement.Math)s=!0;else if(a===Asc.c_oAscTypeSelectElement.Paragraph){var o=e[i].asc_getObjectValue();o&&(n=n||o.asc_getLocked())}}s&&(this._state.equationLocked=n,this.disableEquationBar())}},t.fillMenuProps=function(t,e,i){if(t){var s,n,a,o,l,r,c,d,h,p,u,m=this.documentHolder,g=t.asc_getSelectionType(),b=t.asc_getLocked(),f=!0===t.asc_getLockedTable(),v=!0===t.asc_getLockedPivotTable(),C=!1,x=this.getApplication().getController("Common.Controllers.Comments"),y=this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle,A=this.permissions.isEditMailMerge||this.permissions.isEditDiagram,w=t.asc_getXfs(),S=!1,k=!1;switch(g){case Asc.c_oAscSelectionType.RangeCells:s=!0;break;case Asc.c_oAscSelectionType.RangeRow:n=!0;break;case Asc.c_oAscSelectionType.RangeCol:a=!0;break;case Asc.c_oAscSelectionType.RangeMax:o=!0;break;case Asc.c_oAscSelectionType.RangeSlicer:case Asc.c_oAscSelectionType.RangeImage:r=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeShape:d=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeChart:l=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeChartText:h=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram);break;case Asc.c_oAscSelectionType.RangeShapeText:c=!(this.permissions.isEditMailMerge||this.permissions.isEditDiagram)}if(this.api.asc_getHeaderFooterMode()){if(!m.copyPasteMenu||!e&&!m.copyPasteMenu.isVisible())return;e&&this.showPopupMenu(m.copyPasteMenu,{},i)}else if(r||d||l){if(!m.imgMenu||!e&&!m.imgMenu.isVisible())return;r=d=l=u=!1,m.mnuImgAdvanced.imageInfo=void 0;for(var T,I=!1,D=this.api.asc_getGraphicObjectProps(),V=0;V<D.length;V++)if(D[V].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image){var P=D[V].asc_getObjectValue();if(C=C||P.asc_getLocked(),this._state.wsProps.Objects&&P.asc_getProtectionLocked())return;var F=P.asc_getShapeProperties();F?F.asc_getFromChart()?l=!0:F.asc_getFromImage()?p=!0:(m.mnuShapeAdvanced.shapeInfo=P,d=!0,F.asc_getFromSmartArt()&&(S=!0),F.asc_getFromSmartArtInternal()&&(k=!0)):P.asc_getChartProperties()?(m.mnuChartEdit.chartInfo=P,l=!0,I=!0):P.asc_getSlicerProperties()?(m.mnuSlicerAdvanced.imageInfo=P,u=!0):(m.mnuImgAdvanced.imageInfo=P,r=!0),this.permissions.isSignatureSupport&&(T=P.asc_getSignatureId())}m.mnuBringToFront.setDisabled(k),m.mnuSendToBack.setDisabled(k),m.mnuBringForward.setDisabled(k),m.mnuSendBackward.setDisabled(k);var R=this.api.asc_canGroupGraphicsObjects();m.mnuUnGroupImg.setDisabled(C||!this.api.asc_canUnGroupGraphicsObjects()),m.mnuGroupImg.setDisabled(C||!R),m.menuImageAlign.setDisabled(C||!R),m.menuShapesMerge.setDisabled(C||!this.api.asc_canMergeSelectedShapes()),m.menuShapesMerge.isDisabled()||m.menuShapesMerge.menu.items.forEach((function(t){t.setDisabled(!m.api.asc_canMergeSelectedShapes(t.value))}));var U=this.api.asc_getSelectedDrawingObjectsCount();m.menuImageAlign.menu.items[7].setDisabled(U<3),m.menuImageAlign.menu.items[8].setDisabled(U<3),m.mnuShapeAdvanced.setVisible(d&&!r&&!l),m.mnuShapeAdvanced.setDisabled(C),m.mnuChartEdit.setVisible(l&&!r&&!d&&I),m.mnuChartEdit.setDisabled(C),m.mnuChartData.setVisible(this.permissions.isEditOle&&l&&!r&&!d&&I),m.mnuChartData.setDisabled(C),m.mnuChartType.setVisible(this.permissions.isEditOle&&l&&!r&&!d&&I),m.mnuChartType.setDisabled(C),m.pmiImgCut.setDisabled(C),m.pmiImgPaste.setDisabled(C),m.mnuImgAdvanced.setVisible(r&&(!d||p)&&!l),m.mnuImgAdvanced.setDisabled(C),m.menuImgOriginalSize.setVisible(r&&(!d||p)&&!l),m.mnuImgAdvanced.imageInfo&&m.menuImgOriginalSize.setDisabled(C||null===m.mnuImgAdvanced.imageInfo.get_ImageUrl()||void 0===m.mnuImgAdvanced.imageInfo.get_ImageUrl()),m.mnuSlicerAdvanced.setVisible(u),m.mnuSlicerAdvanced.setDisabled(C);var E=m.mnuImgAdvanced.imageInfo?m.mnuImgAdvanced.imageInfo.asc_getPluginGuid():null;m.menuImgReplace.setVisible(p&&null==E),m.menuImgReplace.setDisabled(C||null===E),m.menuImgReplace.menu.items[2].setVisible(this.permissions.canRequestInsertImage||this.permissions.fileChoiceUrl&&this.permissions.fileChoiceUrl.indexOf("{documentType}")>-1),m.menuImageArrange.setDisabled(C);var L=null!=E;if(m.menuEditObject.setVisible(L),m.menuEditObjectSeparator.setVisible(L),L){var M=SSE.getCollection("Common.Collections.Plugins").findWhere({guid:E});m.menuEditObject.setDisabled(!this.api.asc_canEditTableOleObject()&&null==M||C)}m.menuImgRotate.setVisible(!l&&null==E&&!u),m.menuImgRotate.setDisabled(C||S),m.menuImgRotate.menu.items[3].setDisabled(k),m.menuImgRotate.menu.items[4].setDisabled(k),m.menuImgCrop.setVisible(this.api.asc_canEditCrop()),m.menuImgCrop.setDisabled(C),m.menuImgResetCrop.setVisible(r&&m.mnuImgAdvanced.imageInfo.asc_getIsCrop()),m.menuImgResetCrop.setDisabled(C);var B=!!T;m.menuSignatureEditSign.setVisible(B),m.menuSignatureEditSetup.setVisible(B),m.menuEditSignSeparator.setVisible(B),m.menuImgMacro.setVisible(!y),m.menuImgMacro.setDisabled(C);var N=this.api&&this.api.asc_canEditGeometry();m.menuImgEditPoints.setVisible(N),N&&m.menuImgEditPoints.setDisabled(C),e&&this.showPopupMenu(m.imgMenu,{},i),m.mnuShapeSeparator.setVisible(m.mnuShapeAdvanced.isVisible()||m.mnuChartEdit.isVisible()||m.mnuImgAdvanced.isVisible()),m.mnuSlicerSeparator.setVisible(m.mnuSlicerAdvanced.isVisible()),B&&(m.menuSignatureEditSign.cmpEl.attr("data-value",T),m.menuSignatureEditSetup.cmpEl.attr("data-value",T))}else if(c||h){if(!m.textInShapeMenu||!e&&!m.textInShapeMenu.isVisible())return;m.pmiTextAdvanced.textInfo=void 0;D=this.api.asc_getGraphicObjectProps();var O=!1;for(V=0;V<D.length;V++){var H=D[V].asc_getObjectType();if(H==Asc.c_oAscTypeSelectElement.Image){var $=D[V].asc_getObjectValue(),W=$.asc_getVerticalTextAlign(),z=$.asc_getVert(),G=this.api.asc_getCurrentListType(),j=$?$.asc_getShapeProperties():null;if(this._state.wsProps.Objects&&$.asc_getProtectionLockText())return;C=C||$.asc_getLocked(),S=!!j&&j.asc_getFromSmartArt(),k=!!j&&j.asc_getFromSmartArtInternal();var q="";switch(W){case Asc.c_oAscVAlign.Top:q="menu__icon btn-align-top";break;case Asc.c_oAscVAlign.Center:q="menu__icon btn-align-middle";break;case Asc.c_oAscVAlign.Bottom:q="menu__icon btn-align-bottom"}switch(m.menuParagraphVAlign.setIconCls(q),m.menuParagraphTop.setChecked(W==Asc.c_oAscVAlign.Top),m.menuParagraphCenter.setChecked(W==Asc.c_oAscVAlign.Center),m.menuParagraphBottom.setChecked(W==Asc.c_oAscVAlign.Bottom),q="",z){case Asc.c_oAscVertDrawingText.normal:q="menu__icon btn-text-orient-hor";break;case Asc.c_oAscVertDrawingText.vert:q="menu__icon btn-text-orient-rdown";break;case Asc.c_oAscVertDrawingText.vert270:q="menu__icon btn-text-orient-rup"}m.menuParagraphDirection.setIconCls(q),m.menuParagraphDirectH.setChecked(z==Asc.c_oAscVertDrawingText.normal),m.menuParagraphDirect90.setChecked(z==Asc.c_oAscVertDrawingText.vert),m.menuParagraphDirect270.setChecked(z==Asc.c_oAscVertDrawingText.vert270),m.menuParagraphBulletNone.setChecked(-1==G.get_ListType());var K,Y=G.get_ListType(),X=G.get_ListSubType(),J=m.paraBulletsPicker.store.at(7),Q=4096===J.get("subtype")&&(1===Y||4096!==X);if(1===Y||4096!==X)K=m.paraBulletsPicker.store.findWhere({type:Y,subtype:X});else{var Z=G.asc_getListCustom();if(Z){var tt=Z.asc_getType();if(tt===Asc.asc_PreviewBulletType.char){var et=Z.asc_getChar();if(et)(it=new Asc.asc_CBullet).asc_putSymbol(et),it.asc_putFont(Z.asc_getSpecialFont()),(K=J).set("subtype",4096),K.set("customBullet",it),K.set("numberingInfo",JSON.stringify(it.asc_getJsonBullet())),K.set("tip",""),m.paraBulletsPicker.dataViewItems&&this.updateBulletTip(m.paraBulletsPicker.dataViewItems[7],""),Q=!1}else if(tt===Asc.asc_PreviewBulletType.image){var it,st=Z.asc_getImageId();if(st)(it=new Asc.asc_CBullet).asc_fillBulletImage(st),(K=J).set("subtype",4096),K.set("customBullet",it),K.set("numberingInfo",JSON.stringify(it.asc_getJsonBullet())),K.set("tip",""),m.paraBulletsPicker.dataViewItems&&this.updateBulletTip(m.paraBulletsPicker.dataViewItems[7],""),Q=!1}}}m.paraBulletsPicker.selectRecord(K,!0),Q&&(J.set("subtype",8),J.set("numberingInfo",m._markersArr[7]),J.set("tip",m.tipMarkersDash),m.paraBulletsPicker.dataViewItems&&this.updateBulletTip(m.paraBulletsPicker.dataViewItems[7],m.tipMarkersDash))}else H==Asc.c_oAscTypeSelectElement.Paragraph?(m.pmiTextAdvanced.textInfo=D[V].asc_getObjectValue(),C=C||m.pmiTextAdvanced.textInfo.asc_getLocked()):H==Asc.c_oAscTypeSelectElement.Math&&(this._currentMathObj=D[V].asc_getObjectValue(),O=!0)}var nt=t.asc_getHyperlink(),at=this.api.asc_canAddShapeHyperlink();m.menuParagraphBullets.setVisible(!0!==h),m.menuHyperlinkShape.setVisible(c&&!1!==at&&nt),m.menuAddHyperlinkShape.setVisible(c&&!1!==at&&!nt),m.menuParagraphVAlign.setVisible(!0!==h&&!O),m.menuParagraphDirection.setVisible(!0!==h&&!O),m.textInShapeMenu.items[3].setVisible(!0!==h||c&&!1!==at),m.pmiTextAdvanced.setVisible(void 0!==m.pmiTextAdvanced.textInfo),_.each(m.textInShapeMenu.items,(function(t){t.setDisabled(C)})),m.pmiTextCopy.setDisabled(!1),m.menuHyperlinkShape.setDisabled(C||this._state.wsProps.InsertHyperlinks),m.menuAddHyperlinkShape.setDisabled(C||this._state.wsProps.InsertHyperlinks);if(this._currentParaObjDisabled=C,O?m.addEquationMenu(m.textInShapeMenu,4):m.clearEquationMenu(m.textInShapeMenu,4),m.menuParagraphEquation.setVisible(O),m.menuParagraphEquation.setDisabled(C),O){var ot=this.api.asc_GetMathInputType(),lt=Common.Utils.InternalSettings.get("sse-equation-toolbar-hide");m.menuParagraphEquation.menu.items[5].setChecked(ot===Asc.c_oAscMathInputType.Unicode),m.menuParagraphEquation.menu.items[6].setChecked(ot===Asc.c_oAscMathInputType.LaTeX),m.menuParagraphEquation.menu.items[8].options.isToolbarHide=lt,m.menuParagraphEquation.menu.items[8].setCaption(lt?m.showEqToolbar:m.hideEqToolbar)}e&&this.showPopupMenu(m.textInShapeMenu,{},i),m.menuParagraphBullets.setDisabled(S||k)}else if(!this.permissions.isEditMailMerge&&!this.permissions.isEditDiagram&&!this.permissions.isEditOle||g!==Asc.c_oAscSelectionType.RangeImage&&g!==Asc.c_oAscSelectionType.RangeShape&&g!==Asc.c_oAscSelectionType.RangeChart&&g!==Asc.c_oAscSelectionType.RangeChartText&&g!==Asc.c_oAscSelectionType.RangeShapeText&&g!==Asc.c_oAscSelectionType.RangeSlicer){if(!m.ssMenu||!e&&!m.ssMenu.isVisible())return;this.propsPivot={originalProps:t.asc_getPivotTableInfo()};var rt=this.api.isCellEdited,ct=t.asc_getFormatTableInfo(),dt=null!==t.asc_getSparklineInfo(),ht=null!==ct,pt=t.asc_getMultiselect(),ut=!!this.propsPivot.originalProps,mt=!0===t.asc_getUserProtected();m.ssMenu.formatTableName=ht?ct.asc_getTableName():null,m.ssMenu.cellColor=w.asc_getFillColor(),m.ssMenu.fontColor=w.asc_getFontColor(),m.pmiCut.setVisible(!ut),m.pmiPaste.setVisible(!ut),m.pmiInsertEntire.setVisible(n||a),m.pmiInsertEntire.setCaption(n?this.textInsertTop:this.textInsertLeft),m.pmiDeleteEntire.setVisible(n||a),m.pmiInsertCells.setVisible(s&&!rt&&!ht&&!ut),m.pmiDeleteCells.setVisible(s&&!rt&&!ht&&!ut),m.pmiSelectTable.setVisible(s&&!rt&&ht),m.pmiInsertTable.setVisible(s&&!rt&&ht),m.pmiDeleteTable.setVisible(s&&!rt&&ht),m.pmiSparklines.setVisible(dt),m.pmiSortCells.setVisible((s||o)&&!rt&&!ut),m.pmiSortCells.menu.items[2].setVisible(!A),m.pmiSortCells.menu.items[3].setVisible(!A),m.pmiSortCells.menu.items[4].setVisible(!y),m.pmiFilterCells.setVisible(s&&!rt&&!A&&!ut),m.pmiReapply.setVisible((s||o)&&!rt&&!A&&!ut),m.pmiCondFormat.setVisible(!rt&&!A),m.pmiInsFunction.setVisible(s&&!rt&&!ut),m.pmiAddNamedRange.setVisible(s&&!rt&&!y);var gt=s&&!rt&&!A&&ut;if(m.pmiCellSeparator.setVisible((s||o||dt)&&!rt&&!ut||gt),gt&&this.fillPivotProps(),m.mnuRefreshPivot.setVisible(gt),m.mnuPivotRefreshSeparator.setVisible(gt),m.mnuPivotSort.setVisible(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter),m.mnuPivotFilter.setVisible(!!this.propsPivot.filter),m.mnuPivotFilterSeparator.setVisible(this.propsPivot.filter||this.propsPivot.rowFilter||this.propsPivot.colFilter),m.mnuSubtotalField.setVisible(!!this.propsPivot.field&&(0===this.propsPivot.fieldType||1===this.propsPivot.fieldType)),m.mnuPivotSubtotalSeparator.setVisible(!!this.propsPivot.field&&(0===this.propsPivot.fieldType||1===this.propsPivot.fieldType)),m.mnuExpandCollapsePivot.setVisible(!!this.propsPivot.canExpandCollapse),m.mnuPivotExpandCollapseSeparator.setVisible(!!this.propsPivot.canExpandCollapse),m.mnuGroupPivot.setVisible(!!this.propsPivot.canGroup),m.mnuUnGroupPivot.setVisible(!!this.propsPivot.canGroup),m.mnuPivotGroupSeparator.setVisible(!!this.propsPivot.canGroup),m.mnuDeleteField.setVisible(!!this.propsPivot.field),m.mnuPivotDeleteSeparator.setVisible(!!this.propsPivot.field),m.mnuSummarize.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType),m.mnuShowAs.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType&&!this.propsPivot.rowTotal&&!this.propsPivot.colTotal),m.mnuPivotValueSeparator.setVisible(!!this.propsPivot.field&&2===this.propsPivot.fieldType),m.mnuShowDetails.setVisible(!!this.propsPivot.showDetails),m.mnuShowDetailsSeparator.setVisible(!!this.propsPivot.showDetails),m.mnuPivotSettings.setVisible(gt),m.mnuFieldSettings.setVisible(!!this.propsPivot.field),this.propsPivot.field)if(m.mnuDeleteField.setCaption(m.txtDelField+" "+(this.propsPivot.rowTotal||this.propsPivot.colTotal?m.txtGrandTotal:'"'+this.propsPivot.fieldName+'"')),m.mnuSubtotalField.setCaption(m.txtSubtotalField+' "'+this.propsPivot.fieldName+'"'),m.mnuFieldSettings.setCaption(2===this.propsPivot.fieldType?m.txtValueFieldSettings:m.txtFieldSettings),2===this.propsPivot.fieldType){var bt=this.propsPivot.field.asc_getSubtotal();for(V=0;V<m.mnuSummarize.menu.items.length;V++){void 0!==(ft=m.mnuSummarize.menu.items[V]).value&&ft.setChecked(ft.value===bt,!0)}if(!this.propsPivot.rowTotal&&!this.propsPivot.colTotal){bt=this.propsPivot.field.asc_getShowDataAs();for(V=0;V<m.mnuShowAs.menu.items.length;V++){var ft;void 0!==(ft=m.mnuShowAs.menu.items[V]).value&&ft.setChecked(ft.value===bt,!0)}}}else m.mnuSubtotalField.setChecked(!!this.propsPivot.field.asc_getDefaultSubtotal(),!0);this.propsPivot.filter&&(m.mnuPivotFilter.menu.items[0].setCaption(this.propsPivot.fieldName?Common.Utils.String.format(m.txtClearPivotField,' "'+this.propsPivot.fieldName+'"'):m.txtClear),m.mnuPivotFilter.menu.items[0].setDisabled(this.propsPivot.filter.asc_getFilterObj().asc_getType()===Asc.c_oAscAutoFilterTypes.None)),ut&&m.mnuPivotSort.menu.items[2].setDisabled(!(this.propsPivot.filter||this.propsPivot.rowFilter&&this.propsPivot.colFilter)),ht&&(m.pmiInsertTable.menu.items[0].setDisabled(!ct.asc_getIsInsertRowAbove()),m.pmiInsertTable.menu.items[1].setDisabled(!ct.asc_getIsInsertRowBelow()),m.pmiInsertTable.menu.items[2].setDisabled(!ct.asc_getIsInsertColumnLeft()),m.pmiInsertTable.menu.items[3].setDisabled(!ct.asc_getIsInsertColumnRight()),m.pmiDeleteTable.menu.items[0].setDisabled(!ct.asc_getIsDeleteRow()),m.pmiDeleteTable.menu.items[1].setDisabled(!ct.asc_getIsDeleteColumn()),m.pmiDeleteTable.menu.items[2].setDisabled(!ct.asc_getIsDeleteTable()));nt=t.asc_getHyperlink();m.menuHyperlink.setVisible(s&&nt&&!rt&&!pt&&!A&&!ut),m.menuAddHyperlink.setVisible(s&&!nt&&!rt&&!pt&&!A&&!ut),m.pmiRowHeight.setVisible(n||o),m.pmiColumnWidth.setVisible(a||o),m.pmiEntireHide.setVisible(a||n),m.pmiEntireShow.setVisible(a||n),m.pmiFreezePanes.setVisible(!rt),m.pmiFreezePanes.setCaption(this.api.asc_getSheetViewSettings().asc_getIsFreezePane()?m.textUnFreezePanes:m.textFreezePanes);var vt=t.asc_getComments();m.pmiAddCommentSeparator.setVisible(s&&!rt&&this.permissions.canCoAuthoring&&this.permissions.canComments&&vt&&vt.length<1),m.pmiAddComment.setVisible(s&&!rt&&this.permissions.canCoAuthoring&&this.permissions.canComments&&vt&&vt.length<1),m.pmiCellMenuSeparator.setVisible(s&&!rt||n||a||o),m.pmiEntireHide.isrowmenu=n,m.pmiEntireShow.isrowmenu=n,x&&x.blockPopover(!0),m.pmiClear.menu.items[0].setDisabled(!this.permissions.canModifyFilter),m.pmiClear.menu.items[1].setDisabled(rt),m.pmiClear.menu.items[2].setDisabled(rt||!this.permissions.canModifyFilter),m.pmiClear.menu.items[3].setDisabled(rt),m.pmiClear.menu.items[4].setDisabled(rt),m.pmiClear.menu.items[3].setVisible(!this.permissions.isEditDiagram),m.pmiClear.menu.items[4].setVisible(!this.permissions.isEditDiagram);var Ct=t.asc_getAutoFilterInfo(),xt=!!Ct&&Ct.asc_getIsApplyAutoFilter();Ct=Ct?Ct.asc_getIsAutoFilter():null,m.pmiInsertCells.menu.items[0].setDisabled(xt),m.pmiDeleteCells.menu.items[0].setDisabled(xt),m.pmiInsertCells.menu.items[1].setDisabled(xt),m.pmiDeleteCells.menu.items[1].setDisabled(xt),m.pmiEntriesList.setVisible(!rt&&!ut),m.pmiNumFormat.setVisible(!rt),m.pmiCellFormat.setVisible(!rt&&!(this.permissions.canBrandingExt&&this.permissions.customization&&!1===this.permissions.customization.rightMenu||!Common.UI.LayoutManager.isElementVisible("rightMenu"))),m.pmiAdvancedNumFormat.options.numformatinfo=m.pmiNumFormat.menu.options.numformatinfo=w.asc_getNumFormatInfo(),m.pmiAdvancedNumFormat.options.numformat=w.asc_getNumFormat(),m.pmiGetRangeList.setVisible(!Common.Utils.isIE&&s&&!rt&&!pt&&!y&&this.permissions.canMakeActionLink&&!!navigator.clipboard),_.each(m.ssMenu.items,(function(t){t.setDisabled(b||mt)})),m.pmiCopy.setDisabled(!1),m.pmiSelectTable.setDisabled(this._state.wsLock),m.pmiInsertEntire.setDisabled(b||f||n&&this._state.wsProps.InsertRows||a&&this._state.wsProps.InsertColumns||mt),m.pmiInsertCells.setDisabled(b||f||ut||this._state.wsLock||mt),m.pmiInsertTable.setDisabled(b||f||this._state.wsLock||mt),m.pmiDeleteEntire.setDisabled(b||f||n&&this._state.wsProps.DeleteRows||a&&this._state.wsProps.DeleteColumns||mt),m.pmiDeleteCells.setDisabled(b||f||ut||this._state.wsLock||mt),m.pmiDeleteTable.setDisabled(b||f||this._state.wsLock||mt),m.pmiClear.setDisabled(b||ut||mt),m.pmiFilterCells.setDisabled(b||f||null==Ct||ut||!Ct&&!this.permissions.canModifyFilter||this._state.wsLock||mt),m.pmiSortCells.setDisabled(b||f||null==Ct||ut||!this.permissions.canModifyFilter||this._state.wsProps.Sort||mt),m.pmiReapply.setDisabled(b||f||!0!==xt||mt),m.pmiCondFormat.setDisabled(b||f||this._state.wsProps.FormatCells||mt),m.menuHyperlink.setDisabled(b||ut||this._state.wsProps.InsertHyperlinks||mt),m.menuAddHyperlink.setDisabled(b||ut||this._state.wsProps.InsertHyperlinks||mt),m.pmiInsFunction.setDisabled(b||ut||mt),m.pmiFreezePanes.setDisabled(this.api.asc_isWorksheetLockedOrDeleted(this.api.asc_getActiveWorksheetIndex())),m.pmiRowHeight.setDisabled(b||this._state.wsProps.FormatRows),m.pmiColumnWidth.setDisabled(b||this._state.wsProps.FormatColumns),m.pmiEntireHide.setDisabled(b||a&&this._state.wsProps.FormatColumns||n&&this._state.wsProps.FormatRows),m.pmiEntireShow.setDisabled(b||a&&this._state.wsProps.FormatColumns||n&&this._state.wsProps.FormatRows),m.pmiNumFormat.setDisabled(b||this._state.wsProps.FormatCells||mt),m.pmiSparklines.setDisabled(b||this._state.wsLock||mt),m.pmiEntriesList.setDisabled(b||this._state.wsLock||mt),m.pmiAddNamedRange.setDisabled(b||this._state.wsLock),m.pmiAddComment.setDisabled(b||this._state.wsProps.Objects),m.pmiGetRangeList.setDisabled(!1),ut&&(m.mnuGroupPivot.setDisabled(v||this._state.wsLock),m.mnuUnGroupPivot.setDisabled(v||this._state.wsLock),m.mnuRefreshPivot.setDisabled(v||this._state.wsLock),m.mnuPivotSettings.setDisabled(v||this._state.wsLock),m.mnuFieldSettings.setDisabled(v||this._state.wsLock),m.mnuDeleteField.setDisabled(v||this._state.wsLock),m.mnuSubtotalField.setDisabled(v||this._state.wsLock),m.mnuSummarize.setDisabled(v||this._state.wsLock),m.mnuShowAs.setDisabled(v||this._state.wsLock),m.mnuShowDetails.setDisabled(this.api.asc_isWorkbookLocked()||this.api.asc_isProtectedWorkbook()),m.mnuPivotFilter.setDisabled(v||this._state.wsLock)),e&&this.showPopupMenu(m.ssMenu,{},i),m.pmiFunctionSeparator.setVisible(m.pmiInsFunction.isVisible()||m.menuAddHyperlink.isVisible()||m.menuHyperlink.isVisible()||n||a||o),m.pmiFreezeSeparator.setVisible(m.pmiFreezePanes.isVisible())}else if(this.permissions.isEditDiagram&&g==Asc.c_oAscSelectionType.RangeChartText){if(!e&&!m.textInShapeMenu.isVisible())return;m.pmiTextAdvanced.textInfo=void 0,m.menuHyperlinkShape.setVisible(!1),m.menuAddHyperlinkShape.setVisible(!1),m.menuParagraphVAlign.setVisible(!1),m.menuParagraphDirection.setVisible(!1),m.pmiTextAdvanced.setVisible(!1),m.menuParagraphEquation.setVisible(!1),m.textInShapeMenu.items[9].setVisible(!1),m.menuParagraphBullets.setVisible(!1),m.textInShapeMenu.items[3].setVisible(!1),m.pmiTextCopy.setDisabled(!1),e&&this.showPopupMenu(m.textInShapeMenu,{},i)}}},t.fillViewMenuProps=function(t,e,i){if(t){var s,n=this.documentHolder,a=t.asc_getSelectionType(),o=t.asc_getLocked(),l=!0===t.asc_getLockedTable(),r=this.getApplication().getController("Common.Controllers.Comments"),c=a==Asc.c_oAscSelectionType.RangeCells&&!this.permissions.isEditMailMerge&&!this.permissions.isEditDiagram&&!this.permissions.isEditOle,d=this.api.isCellEdited,h=!(a!=Asc.c_oAscSelectionType.RangeShape&&a!=Asc.c_oAscSelectionType.RangeImage||this.permissions.isEditMailMerge||this.permissions.isEditDiagram||this.permissions.isEditOle),p=t.asc_getMultiselect();if(n.viewModeMenu||n.createDelayedElementsViewer(),e||n.viewModeMenu.isVisible()){if(h&&this.permissions.isSignatureSupport)for(var u=this.api.asc_getGraphicObjectProps(),m=0;m<u.length;m++)u[m].asc_getObjectType()==Asc.c_oAscTypeSelectElement.Image&&(s=u[m].asc_getObjectValue().asc_getSignatureId());var g=s?this.api.asc_getSignatureSetup(s):null,b=!!g&&this._canProtect,f=c&&!d&&this.permissions.canCoAuthoring&&this.permissions.canComments&&!this._isDisabled&&t.asc_getComments()&&t.asc_getComments().length<1;n.menuViewUndo.setVisible(this.permissions.canCoAuthoring&&this.permissions.canComments&&!this._isDisabled),n.menuViewUndo.setDisabled(!this.api.asc_getCanUndo()),n.menuViewCopySeparator.setVisible(b);var v=!!g&&g.asc_getRequested();n.menuSignatureViewSign.setVisible(b&&v),n.menuSignatureDetails.setVisible(b&&!v),n.menuSignatureViewSetup.setVisible(b),n.menuSignatureRemove.setVisible(b&&!v),n.menuViewSignSeparator.setVisible(f),n.menuViewAddComment.setVisible(f),r&&r.blockPopover(!0),n.menuViewAddComment.setDisabled(o||l||this._state.wsProps.Objects);var C=!Common.Utils.isIE&&c&&!d&&!p&&this.permissions.canMakeActionLink&&!!navigator.clipboard;n.pmiViewGetRangeList.setVisible(C),n.pmiViewGetRangeList.setDisabled(!1),n.menuViewCommentSeparator.setVisible(C),e&&this.showPopupMenu(n.viewModeMenu,{},i),b&&(n.menuSignatureViewSign.cmpEl.attr("data-value",s),n.menuSignatureDetails.cmpEl.attr("data-value",g.asc_getId()),n.menuSignatureViewSetup.cmpEl.attr("data-value",s),n.menuSignatureRemove.cmpEl.attr("data-value",s))}}},t.fillSeriesMenuProps=function(t,e,i){if(t){for(var s=this.documentHolder,n=s.fillMenu.items,a=t.asc_getContextMenuAllowedProps(),o=0;o<n.length;o++){var l=a[n[o].value];n[o].setVisible(null!==l),n[o].setDisabled(!l)}s.fillMenu.seriesinfo=t,this.showPopupMenu(s.fillMenu,{},e,i)}},t.onEntriesListMenu=function(t,e,i){if(e&&e.length>0){var s=this,n=s.documentHolder,a=n.entriesMenu,o=n.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",a.id));if(t&&a.isVisible())return void a.hide();for(var l=0;l<a.items.length;l++)a.removeItem(a.items[l]),l--;_.each(e,(function(t,e){var n=new Common.UI.MenuItem({caption:t,value:i?i[e]:t,style:"string"==typeof t&&_.isEmpty(t.trim())?"min-height: 25px;":""}).on("click",(function(t,e){s.api.asc_insertInCell(t.value,Asc.c_oAscPopUpSelectorType.None,!1)}));a.addItem(n)})),Common.UI.Menu.Manager.hideAll(),a.rendered||(o.length<1&&(o=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',a.id)),n.cmpEl.append(o)),a.render(o),a.cmpEl.attr({tabindex:"-1"}));var r=s.api.asc_getActiveCellCoord(t),c={left:0,top:0},d=[r.asc_getX()+c.left+(t?r.asc_getWidth():0),(r.asc_getY()<0?0:r.asc_getY())+r.asc_getHeight()+c.top];o.css({left:d[0],top:d[1]}),a.menuAlign=t?"tr-br":"tl-bl",Common.UI.isRTL()&&(a.menuAlign="tr-br"===a.menuAlign?"tl-bl":"tr-br"),s._preventClick=t,t&&o.attr("data-value","prevent-canvas-click"),a.show(),a.alignPosition(),_.delay((function(){a.cmpEl.focus()}),10)}else this.documentHolder.entriesMenu.hide(),!t&&Common.UI.warning({title:this.notcriticalErrorTitle,maxwidth:600,msg:this.txtNoChoices,callback:_.bind((function(t){Common.NotificationCenter.trigger("edit:complete",this.documentHolder)}),this)})},t.onTableTotalMenu=function(t){if(void 0!==t){var e=this,i=e.documentHolder,s=i.tableTotalMenu,n=i.cmpEl.find(Common.Utils.String.format("#menu-container-{0}",s.id));if(s.isVisible())return void s.hide();Common.UI.Menu.Manager.hideAll(),s.rendered||(n.length<1&&(n=$(Common.Utils.String.format('<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',s.id)),i.cmpEl.append(n)),s.render(n),s.cmpEl.attr({tabindex:"-1"})),s.clearAll();var a=_.find(s.items,(function(e){return e.value==t}));a&&a.setChecked(!0,!0);var o=e.api.asc_getActiveCellCoord(),l={left:0,top:0},r=[o.asc_getX()+l.left+o.asc_getWidth(),(o.asc_getY()<0?0:o.asc_getY())+o.asc_getHeight()+l.top];n.css({left:r[0],top:r[1]}),e._preventClick=!0,n.attr("data-value","prevent-canvas-click"),s.show(),s.alignPosition(),_.delay((function(){s.cmpEl.focus()}),10)}else this.documentHolder.tableTotalMenu.hide()},t.onTotalMenuClick=function(t,e){e.value==Asc.ETotalsRowFunction.totalrowfunctionCustom?this.onInsFunction(e):this.api.asc_insertInCell(e.value,Asc.c_oAscPopUpSelectorType.TotalRowFunc),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onApiFormulaCompleteMenu=function(t,e){var i=this;setTimeout((function(){i.onFormulaCompleteMenu(t,e)}),0)},t.onFormulaCompleteMenu=function(t,e){if(this.documentHolder.funcMenu&&!Common.Utils.ModalWindow.isVisible()&&!this.rangeSelectionMode)if(t){for(var i=this,s=i.documentHolder,n=s.funcMenu,a=s.cmpEl.find("#menu-formula-selection"),o=i.getApplication().getController("FormulaDialog").getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")),l=0;l<n.items.length;l++){var r=n.items[l].cmpEl.data("bs.tooltip");r&&r.hide(),n.removeItem(n.items[l]),l--}t.sort((function(t,e){var i=t.asc_getType(),s=e.asc_getType();if(i===s&&i===Asc.c_oAscPopUpSelectorType.TableColumnName)return 0;if(i===Asc.c_oAscPopUpSelectorType.TableThisRow)return-1;if(s===Asc.c_oAscPopUpSelectorType.TableThisRow)return 1;if((i===Asc.c_oAscPopUpSelectorType.TableColumnName||s===Asc.c_oAscPopUpSelectorType.TableColumnName)&&i!==s)return i===Asc.c_oAscPopUpSelectorType.TableColumnName?-1:1;var n=t.asc_getName(!0).toLocaleUpperCase(),a=e.asc_getName(!0).toLocaleUpperCase();return n<a?-1:n>a?1:0})),_.each(t,(function(t,e){var s=t.asc_getType(),a=t.asc_getName(!0),l=i.api.asc_getFormulaNameByLocale(a),r="",c=a,d="";switch(s){case Asc.c_oAscPopUpSelectorType.Func:if(r="menu__icon btn-function",o&&o[l])d=o[l].d;else{var h=i.api.asc_getCustomFunctionInfo(l);d=h&&h.asc_getDescription()||""}break;case Asc.c_oAscPopUpSelectorType.Table:r="menu__icon btn-menu-table";break;case Asc.c_oAscPopUpSelectorType.Slicer:r="menu__icon btn-slicer";break;case Asc.c_oAscPopUpSelectorType.Range:r="menu__icon btn-named-range";break;case Asc.c_oAscPopUpSelectorType.TableColumnName:c="(...) "+a;break;case Asc.c_oAscPopUpSelectorType.TableThisRow:d=i.txtThisRowHint;break;case Asc.c_oAscPopUpSelectorType.TableAll:d=i.txtAllTableHint;break;case Asc.c_oAscPopUpSelectorType.TableData:d=i.txtDataTableHint;break;case Asc.c_oAscPopUpSelectorType.TableHeaders:d=i.txtHeadersTableHint;break;case Asc.c_oAscPopUpSelectorType.TableTotals:d=i.txtTotalsTableHint}var p=new Common.UI.MenuItem({iconCls:r,caption:c,name:a,hint:d}).on("click",(function(t,e){setTimeout((function(){i.api.asc_insertInCell(t.options.name,s,!1)}),10)}));n.addItem(p)})),n.rendered||(a.length<1&&(a=$(Common.Utils.String.format('<div id="menu-formula-selection" style="position: absolute; z-index: 10000;" class="no-stop-propagate"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>')),s.cmpEl.append(a)),n.onAfterKeydownMenu=function(t){if(t.keyCode!=Common.UI.Keys.RETURN||!t.ctrlKey&&!t.altKey){var e;if(arguments.length>1&&arguments[1]instanceof KeyboardEvent&&(t=arguments[1]),a.hasClass("open"))if(t.keyCode==Common.UI.Keys.TAB||t.keyCode==Common.UI.Keys.RETURN&&!t.ctrlKey&&!t.altKey)e=a.find("a.focus").closest("li");else if(t.keyCode==Common.UI.Keys.UP||t.keyCode==Common.UI.Keys.DOWN){var i,s=n.cmpEl,o=a.find("a.focus").closest("li"),l=s.innerHeight(),r=(l-s.height())/2,c=Common.Utils.getPosition(o).top,d=o.outerHeight();c<0?i=s.scrollTop()+c-r:c+d>l&&(i=s.scrollTop()+c+d-l+r),void 0!==i&&(n.scroller?n.scroller.scrollTop(i,0):s.scrollTop(i))}e&&(e.length>0&&e.click(),Common.UI.Menu.Manager.hideAll())}},n.on("hide:after",(function(){for(var t=0;t<n.items.length;t++){var e=n.items[t].cmpEl.data("bs.tooltip");e&&e.hide()}})),n.render(a),n.cmpEl.attr({tabindex:"-1"}));var c=i.cellEditor.is(":focus"),d=!1===this.tooltips.func_arg.isHidden;if(c)n.menuAlignEl=i.cellEditor,n.offset=[0,(e?e[1]:0)+(d?this.tooltips.func_arg.ref.getBSTip().$tip.height()+2:0)],i.focusInCellEditor=!0;else{n.menuAlignEl=void 0,n.offset=[0,0],i.focusInCellEditor=!1;var h=i.api.asc_getActiveCellCoord(),p=[h.asc_getX()+(e?e[0]:0),(h.asc_getY()<0?0:h.asc_getY())+h.asc_getHeight()+(e?e[1]:0)+(d?this.tooltips.func_arg.ref.getBSTip().$tip.height()+2:0)];a.css({left:p[0],top:p[1]})}n.alignPosition(),n.isVisible()||Common.UI.Menu.Manager.hideAll(),_.delay((function(){n.isVisible()||n.show(),n.scroller&&(n.scroller.update({alwaysVisibleY:!0}),n.scroller.scrollTop(0)),c&&i.cellEditor.focus(),n.cmpEl.toggleClass("from-cell-edit",c),_.delay((function(){var t=n.cmpEl.find("li:first a");t.addClass("focus");var e=t.parent().data("bs.tooltip");e&&e.show()}),10),c||_.delay((function(){n.cmpEl.focus()}),10)}),1)}else this.documentHolder.funcMenu.hide()},t.onFormulaInfo=function(t){if(Common.Utils.InternalSettings.get("sse-settings-function-tooltip")){var e=this.tooltips.func_arg;if(t){e.parentEl||(e.parentEl=$('<div id="tip-container-functip" style="position: absolute; z-index: 10000;"></div>'),this.documentHolder.cmpEl.append(e.parentEl));var i,s=this.getApplication().getController("FormulaDialog").getDescription(Common.Utils.InternalSettings.get("sse-settings-func-locale")),n="";if(s&&s[t])n=(n=this.api.asc_getFormulaLocaleName(t)+s[t].a).replace(/[,;]/g,this.api.asc_getFunctionArgumentSeparator());else{var a=this.api.asc_getCustomFunctionInfo(t),o=a&&a.asc_getArg()||[];n=this.api.asc_getFormulaLocaleName(t)+"("+o.map((function(t){return t.asc_getIsOptional()?"["+t.asc_getName()+"]":t.asc_getName()})).join(this.api.asc_getFunctionArgumentSeparator()+" ")+")"}if(e.ref&&e.ref.isVisible()&&e.text!=n&&(e.ref.hide(),e.ref=void 0,e.text="",e.isHidden=!0),!n)return;if(e.ref&&e.ref.isVisible()||(e.text=n,e.ref=new Common.UI.Tooltip({owner:e.parentEl,html:!0,title:n,cls:"auto-tooltip"}),e.ref.show([-1e4,-1e4]),e.isHidden=!1),this.cellEditor.is(":focus")||this.focusInCellEditor){var l=Common.Utils.getOffset(this.cellEditor);i=[l.left,l.top+this.cellEditor.height()+3]}else{var r=[Common.Utils.getOffset(this.documentHolder.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(this.documentHolder.cmpEl).top-$(window).scrollTop()],c=this.api.asc_getActiveCellCoord();i=[c.asc_getX()+r[0]-3,c.asc_getY()+r[1]+c.asc_getHeight()+4]}var d=e.ref.getBSTip().$tip.width();i[0]+d>this.tooltips.coauth.bodyWidth&&(i[0]=this.tooltips.coauth.bodyWidth-d),e.ref.getBSTip().$tip.css({top:i[1]+"px",left:i[0]+"px"})}else!e.isHidden&&e.ref&&(e.ref.hide(),e.ref=void 0,e.text="",e.isHidden=!0)}},t.changeInputMessagePosition=function(t){var e=[Common.Utils.getOffset(this.documentHolder.cmpEl).left-$(window).scrollLeft(),Common.Utils.getOffset(this.documentHolder.cmpEl).top-$(window).scrollTop()],i=this.api.asc_getActiveCellCoord(),s=[i.asc_getX()+e[0]-3,i.asc_getY()+e[1]-t.ref.getBSTip().$tip.height()-5],n=t.ref.getBSTip().$tip.width();s[0]+n>this.tooltips.coauth.bodyWidth&&(s[0]=this.tooltips.coauth.bodyWidth-n),s[1]<e[1]&&(s[1]=e[1]+i.asc_getY()+i.asc_getHeight()+5),t.ref.getBSTip().$tip.css({top:s[1]+"px",left:s[0]+"px","z-index":900})},t.onInputMessage=function(t,e){var i=this.tooltips.input_msg;if(e){i.parentEl||(i.parentEl=$('<div id="tip-container-inputtip" style="position: absolute; z-index: 10000;"></div>'),this.documentHolder.cmpEl.append(i.parentEl));var s=t?"<b>"+Common.Utils.String.htmlEncode(t||"")+"</b><br>":"";if(s+=Common.Utils.String.htmlEncode(e||""),i.ref&&i.ref.isVisible()&&i.text!=s&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0),!i.ref||!i.ref.isVisible())i.text=s,i.ref=new Common.UI.Tooltip({owner:i.parentEl,html:!0,title:s,keepvisible:!0}),i.ref.show([-1e4,-1e4]),i.ref.getBSTip().$tip.on("click",(function(){i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0})),i.isHidden=!1;this.changeInputMessagePosition(i)}else!i.isHidden&&i.ref&&(i.ref.hide(),i.ref=void 0,i.text="",i.isHidden=!0)},t.onShowSpecialPasteOptions=function(t){if(!this.permissions||this.permissions.isEdit){var e=this,i=e.documentHolder,s=t.asc_getCellCoord(),n=i.cmpEl.find("#special-paste-container"),a=t.asc_getOptions(),o=!!t.asc_getContainTables();if(a){if(n.length<1&&(e._arrSpecialPaste=[],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.paste]=[e.txtPaste,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormula]=[e.txtPasteFormulas,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaNumberFormat]=[e.txtPasteFormulaNumFormat,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaAllFormatting]=[e.txtPasteKeepSourceFormat,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaWithoutBorders]=[e.txtPasteBorders,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.formulaColumnWidth]=[e.txtPasteColWidths,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.mergeConditionalFormating]=[e.txtPasteMerge,0],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyValues]=[e.txtPasteValues,1],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.valueNumberFormat]=[e.txtPasteValNumFormat,1],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.valueAllFormating]=[e.txtPasteValFormat,1],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormating]=[e.txtPasteFormat,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.link]=[e.txtPasteLink,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.transpose]=[e.txtPasteTranspose,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.picture]=[e.txtPastePicture,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.linkedPicture]=[e.txtPasteLinkPicture,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.sourceformatting]=[e.txtPasteSourceFormat,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.destinationFormatting]=[e.txtPasteDestFormat,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.keepTextOnly]=[e.txtKeepTextOnly,2],e._arrSpecialPaste[Asc.c_oSpecialPasteProps.useTextImport]=[e.txtUseTextImport,3],n=$('<div id="special-paste-container" style="position: absolute;"><div id="id-document-holder-btn-special-paste"></div></div>'),i.cmpEl.find("#ws-canvas-outer").append(n),e.btnSpecialPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-special-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paste",caption:Common.Utils.String.format("({0})",Common.Utils.String.textCtrl),menu:new Common.UI.Menu({items:[]})}),e.initSpecialPasteEvents()),a.length>0){for(var l=e.btnSpecialPaste.menu,r=0;r<l.items.length;r++)l.removeItem(l.items[r]),r--;var c,d,h=[];for(r=0;r<3;r++)h[r]=[];_.each(a,(function(t,i){if(e._arrSpecialPaste[t]){var s=new Common.UI.MenuItem({caption:e._arrSpecialPaste[t][0]+(e.hkSpecPaste[t]?" ("+e.hkSpecPaste[t]+")":""),value:t,checkable:!0,toggleGroup:"specialPasteGroup"}).on("click",_.bind(e.onSpecialPasteItemClick,e));t==Asc.c_oSpecialPasteProps.paste?d=s:t==Asc.c_oSpecialPasteProps.useTextImport?c=s:h[e._arrSpecialPaste[t][1]].push(s),e._arrSpecialPaste[t][2]=s}}));var p=[e.txtFormula,e.txtValue,e.txtOther];d&&l.addItem(d);for(r=0;r<3;r++)h[r].length>0&&(l.items.length>0&&l.addItem(new Common.UI.MenuItem({caption:"--"})),l.addItem(new Common.UI.MenuItem({header:p[r],disabled:!0,cls:"menu-header"})),_.each(h[r],(function(t,e){l.addItem(t)})));if(l.items.length>0&&l.items[0].setChecked(!0,!0),e._state.lastSpecPasteChecked=l.items.length>0?l.items[0]:null,c&&(l.addItem(new Common.UI.MenuItem({caption:"--"})),l.addItem(c)),l.items.length>0&&t.asc_getShowPasteSpecial()){l.addItem(new Common.UI.MenuItem({caption:"--"}));var u=new Common.UI.MenuItem({caption:e.textPasteSpecial,value:"special"}).on("click",(function(t,i){new SSE.Views.SpecialPasteDialog({props:a,isTable:o,handler:function(t,i){"ok"==t&&(e._state.lastSpecPasteChecked&&e._state.lastSpecPasteChecked.setChecked(!1,!0),e._state.lastSpecPasteChecked=i&&e._arrSpecialPaste[i.asc_getProps()]?e._arrSpecialPaste[i.asc_getProps()][2]:null,e._state.lastSpecPasteChecked&&e._state.lastSpecPasteChecked.setChecked(!0,!0),e&&e.api&&e.api.asc_SpecialPaste(i))}}).show(),setTimeout((function(){l.hide()}),100)}));l.addItem(u)}}if(s[0].asc_getX()<0||s[0].asc_getY()<0)return n.is(":visible")&&n.hide(),void $(document).off("keyup",this.wrapEvents.onKeyUp);var m=s[0],g=s[1],b=e.tooltips.coauth.bodyWidth-e.tooltips.coauth.XY[0]-e.tooltips.coauth.rightMenuWidth-15,f=e.tooltips.coauth.apiHeight-15,v=[],C=[31,20],x=m.asc_getX()+m.asc_getWidth()+3+C[0],y=m.asc_getY()+m.asc_getHeight()+3+C[1],A=!1,w=this.getApplication().getController("Common.Controllers.Comments");if(w){var S=this.api.asc_getCellInfo().asc_getComments();A=S&&S.length>0&&w.getPopover().isVisible()&&w.findPopupComment(w.findComment(S[0].asc_getId()).get("id"))}x>b||A?(v[0]=void 0!==g?g.asc_getX():b-C[0]-3,y>f&&(v[0]-=C[0]+3),v[0]<0&&(v[0]=b-3-C[0])):v[0]=x-C[0],v[1]=y>f?f-3-C[1]:y-C[1],n.css({left:v[0],top:v[1]}),n.show(),setTimeout((function(){$(document).on("keyup",e.wrapEvents.onKeyUp)}),10),this.disableSpecialPaste()}}},t.onSpecialPasteItemClick=function(t,e){var i=this,s=this.btnSpecialPaste.menu;if(t.value==Asc.c_oSpecialPasteProps.useTextImport)new Common.Views.OpenDialog({title:i.txtImportWizard,closable:!0,type:Common.Utils.importTextType.Paste,preview:!0,api:i.api,handler:function(e,s){if("ok"==e){if(i&&i.api){var n=new Asc.SpecialPasteProps;n.asc_setProps(Asc.c_oSpecialPasteProps.useTextImport),n.asc_setAdvancedOptions(s.textOptions),i.api.asc_SpecialPaste(n)}i._state.lastSpecPasteChecked=t}else t.cmpEl&&(t.setChecked(!1,!0),i._state.lastSpecPasteChecked&&i._state.lastSpecPasteChecked.setChecked(!0,!0))}}).show(),setTimeout((function(){s.hide()}),100);else{i._state.lastSpecPasteChecked=t;var n=new Asc.SpecialPasteProps;n.asc_setProps(t.value),i.api.asc_SpecialPaste(n),setTimeout((function(){s.hide()}),100)}if(!t.cmpEl&&i._state.lastSpecPasteChecked)for(var a=0;a<s.items.length;a++)s.items[a].setChecked(s.items[a].value===i._state.lastSpecPasteChecked.value,!0),s.items[a].value===i._state.lastSpecPasteChecked.value&&(i._state.lastSpecPasteChecked=s.items[a]);return!1},t.initSpecialPasteEvents=function(){var t=this;t.hkSpecPaste=[],t.hkSpecPaste[Asc.c_oSpecialPasteProps.paste]="P",t.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormula]="F",t.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaNumberFormat]="O",t.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaAllFormatting]="K",t.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaWithoutBorders]="B",t.hkSpecPaste[Asc.c_oSpecialPasteProps.formulaColumnWidth]="W",t.hkSpecPaste[Asc.c_oSpecialPasteProps.mergeConditionalFormating]="G",t.hkSpecPaste[Asc.c_oSpecialPasteProps.transpose]="T",t.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyValues]="V",t.hkSpecPaste[Asc.c_oSpecialPasteProps.valueNumberFormat]="A",t.hkSpecPaste[Asc.c_oSpecialPasteProps.valueAllFormating]="E",t.hkSpecPaste[Asc.c_oSpecialPasteProps.pasteOnlyFormating]="R",t.hkSpecPaste[Asc.c_oSpecialPasteProps.link]="N",t.hkSpecPaste[Asc.c_oSpecialPasteProps.picture]="U",t.hkSpecPaste[Asc.c_oSpecialPasteProps.linkedPicture]="I",t.hkSpecPaste[Asc.c_oSpecialPasteProps.sourceformatting]="K",t.hkSpecPaste[Asc.c_oSpecialPasteProps.destinationFormatting]="M",t.hkSpecPaste[Asc.c_oSpecialPasteProps.keepTextOnly]="T";var e="";for(var i in t.hkSpecPaste)t.hkSpecPaste.hasOwnProperty(i)&&e.indexOf(t.hkSpecPaste[i])<0&&(e+=t.hkSpecPaste[i]+",");var s={};s[e=e.substring(0,e.length-1)]=_.bind((function(e){for(var i=this.btnSpecialPaste.menu,s=0;s<i.items.length;s++)if(this.hkSpecPaste[i.items[s].value]===String.fromCharCode(e.keyCode))return t.onSpecialPasteItemClick({value:i.items[s].value})}),t),Common.util.Shortcuts.delegateShortcuts({shortcuts:s}),Common.util.Shortcuts.suspendEvents(e,void 0,!0);var n=t.documentHolder.cmpEl.find("#special-paste-container");t.btnSpecialPaste.menu.on("show:after",(function(t){Common.util.Shortcuts.resumeEvents(e),n.addClass("has-open-menu")})).on("hide:after",(function(t){Common.util.Shortcuts.suspendEvents(e,void 0,!0),n.removeClass("has-open-menu")}))},t.onToggleAutoCorrectOptions=function(t){if(t){var e=this,i=e.documentHolder,s=t.asc_getCellCoord(),n=(u=i.cmpEl.find("#autocorrect-paste-container"),t.asc_getOptions());if(u.length<1&&(e._arrAutoCorrectPaste=[],e._arrAutoCorrectPaste[Asc.c_oAscAutoCorrectOptions.UndoTableAutoExpansion]={caption:e.txtUndoExpansion,icon:"menu__icon btn-undo icon-rtl"},e._arrAutoCorrectPaste[Asc.c_oAscAutoCorrectOptions.RedoTableAutoExpansion]={caption:e.txtRedoExpansion,icon:"menu__icon btn-redo icon-rtl"},u=$('<div id="autocorrect-paste-container" style="position: absolute;"><div id="id-document-holder-btn-autocorrect-paste"></div></div>'),i.cmpEl.append(u),e.btnAutoCorrectPaste=new Common.UI.Button({parentEl:$("#id-document-holder-btn-autocorrect-paste"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-autocorrect",menu:new Common.UI.Menu({cls:"shifted-right",items:[]})}),e.btnAutoCorrectPaste.menu.on("show:after",_.bind(e.onAutoCorrectOpenAfter,e))),n.length>0){for(var a=e.btnAutoCorrectPaste.menu,o=0;o<a.items.length;o++)a.removeItem(a.items[o]),o--;_.each(n,(function(t,i){var s=new Common.UI.MenuItem({caption:e._arrAutoCorrectPaste[t].caption,value:t,iconCls:e._arrAutoCorrectPaste[t].icon}).on("click",(function(t,i){e.api.asc_applyAutoCorrectOptions(t.value),setTimeout((function(){a.hide()}),100)}));a.addItem(s)})),e.mnuAutoCorrectStop=new Common.UI.MenuItem({caption:e.textStopExpand,checkable:!0,allowDepress:!0,checked:!Common.Utils.InternalSettings.get("sse-settings-autoformat-new-rows")}).on("click",(function(t){Common.localStorage.setBool("sse-settings-autoformat-new-rows",!t.checked),Common.Utils.InternalSettings.set("sse-settings-autoformat-new-rows",!t.checked),e.api.asc_setIncludeNewRowColTable(!t.checked),setTimeout((function(){a.hide()}),100)})),a.addItem(e.mnuAutoCorrectStop),a.addItem({caption:"--"});var l=new Common.UI.MenuItem({caption:e.textAutoCorrectSettings}).on("click",_.bind(e.onAutoCorrectOptions,e));a.addItem(l)}var r=e.tooltips.coauth.bodyWidth-e.tooltips.coauth.XY[0]-e.tooltips.coauth.rightMenuWidth-15,c=e.tooltips.coauth.apiHeight-15,d=[31,20],h=s.asc_getX()+s.asc_getWidth()+2+d[0],p=s.asc_getY()+s.asc_getHeight()+1+d[1];h>r||p>c||s.asc_getX()<0||s.asc_getY()<0?u.is(":visible")&&u.hide():(u.css({left:h-d[0],top:p-d[1]}),u.show())}else{var u;(u=this.documentHolder.cmpEl.find("#autocorrect-paste-container")).is(":visible")&&u.hide()}},t.onCellsRange=function(t){this.rangeSelectionMode=t!=Asc.c_oAscSelectionDialogType.None},t.onApiEditCell=function(t){this.isEditFormula=t==Asc.c_oAscCellEditorState.editFormula,this.isEditCell=t!=Asc.c_oAscCellEditorState.editEnd},t.onChangeCropState=function(t){this.documentHolder.menuImgCrop&&this.documentHolder.menuImgCrop.menu.items[0].setChecked(t,!0)},t.equationCallback=function(t){t&&this.api.asc_SetMathProps(t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onTextInShapeAfterRender=function(t){var e=this.documentHolder,i=e.paraBulletsPicker.conf;e.paraBulletsPicker=new Common.UI.DataView({el:$("#id-docholder-menu-bullets"),parentMenu:e.menuParagraphBullets.menu,outerMenu:{menu:e.menuParagraphBullets.menu,index:0},groups:e.paraBulletsPicker.groups,store:e.paraBulletsPicker.store,delayRenderTips:!0,itemTemplate:_.template('<% if (type==0) { %><div id="<%= id %>" class="item-markerlist"></div><% } else if (type==1) { %><div id="<%= id %>" class="item-multilevellist"></div><% } %>')}),e.paraBulletsPicker.on("item:click",_.bind(this.onSelectBullets,this)),e.menuParagraphBullets.menu.setInnerMenu([{menu:e.paraBulletsPicker,index:0}]),i&&e.paraBulletsPicker.selectRecord(i.rec,!0)},t.onBulletMenuShowAfter=function(){var t=this.documentHolder.paraBulletsPicker.store,e=[],i=[];t.each((function(t){("menu-list-bullet-group"===t.get("group")?i:e).push({numberingInfo:{bullet:"undefined"===t.get("numberingInfo")?void 0:JSON.parse(t.get("numberingInfo"))},divId:t.get("id")})})),this.api&&this.api.SetDrawImagePreviewBulletForMenu&&(this.api.SetDrawImagePreviewBulletForMenu(i,0),this.api.SetDrawImagePreviewBulletForMenu(e,1))},t.updateBulletTip=function(t,e){if(t){var i=$(t.el).data("bs.tooltip");i&&(i.options.title=e,i.$tip.find(".tooltip-inner").text(e))}},t.onSignatureClick=function(t){var e=t.cmpEl.attr("data-value");switch(t.value){case 0:Common.NotificationCenter.trigger("protect:sign",e);break;case 1:this.api.asc_ViewCertificate(e);break;case 2:Common.NotificationCenter.trigger("protect:signature","visible",this._isDisabled,e);break;case 3:var i=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtRemoveWarning,buttons:["ok","cancel"],primary:"ok",callback:function(t){"ok"==t&&i.api.asc_RemoveSignature(e)}})}},t.onOriginalSizeClick=function(t){if(this.api){var e=this.api.asc_getCropOriginalImageSize(),i=e.asc_getImageWidth(),s=e.asc_getImageHeight(),n=new Asc.asc_CImgProperty;n.asc_putWidth(i),n.asc_putHeight(s),n.put_Rot(0),this.api.asc_setGraphicObjectProps(n),Common.NotificationCenter.trigger("edit:complete",this.documentHolder),Common.component.Analytics.trackEvent("DocumentHolder","Set Image Original Size")}},t.onImgReplace=function(t,e){var i=this;this.api&&("file"==e.value?setTimeout((function(){i.api&&i.api.asc_changeImageFromFile(),Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}),10):"storage"==e.value?Common.NotificationCenter.trigger("storage:image-load","change"):new Common.Views.ImageFromUrlDialog({handler:function(t,e){if("ok"==t&&i.api){var s=e.replace(/ /g,"");if(!_.isEmpty(s)){var n=new Asc.asc_CImgProperty;n.asc_putImageUrl(s),i.api.asc_setGraphicObjectProps(n)}}Common.NotificationCenter.trigger("edit:complete",i.documentHolder)}}).show())},t.isPivotNumberFormat=function(){return!!(this.propsPivot&&this.propsPivot.originalProps&&this.propsPivot.field)&&this.propsPivot.originalProps.asc_getFieldGroupType(this.propsPivot.pivotIndex)!==Asc.c_oAscGroupType.Text},t.onNumberFormatSelect=function(t,e){if(void 0!==e.value&&"advanced"!==e.value&&this.api)if(this.isPivotNumberFormat()){var i=2===this.propsPivot.fieldType?new Asc.CT_DataField:new Asc.CT_PivotField;i.asc_setNumFormat(e.options.format),this.propsPivot.field.asc_set(this.api,this.propsPivot.originalProps,2===this.propsPivot.fieldType?this.propsPivot.index:this.propsPivot.pivotIndex,i)}else this.api.asc_setCellFormat(e.options.format);Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onCustomNumberFormat=function(t){var e=this,i=e.api.asc_getLocale();!i&&(i=e.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(e.permissions.lang)):1033),new SSE.Views.FormatSettingsDialog({api:e.api,handler:function(t,i){if(i)if(e.isPivotNumberFormat()){var s=2===e.propsPivot.fieldType?new Asc.CT_DataField:new Asc.CT_PivotField;s.asc_setNumFormat(i.format),e.propsPivot.field.asc_set(e.api,e.propsPivot.originalProps,2===e.propsPivot.fieldType?e.propsPivot.index:e.propsPivot.pivotIndex,s)}else e.api.asc_setCellFormat(i.format);Common.NotificationCenter.trigger("edit:complete",e.documentHolder)},props:{format:t.options.numformat,formatInfo:t.options.numformatinfo,langId:i}}).show(),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onNumberFormatOpenAfter=function(t){if(this.api){var e=this,i=e.api.asc_getLocale();if(!i&&(i=e.permissions.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(e.permissions.lang)):1033),this._state.langId!==i){this._state.langId=i;var s=new Asc.asc_CFormatCellsInfo;s.asc_setType(Asc.c_oAscNumFormatType.None),s.asc_setSymbol(this._state.langId);for(var n=this.api.asc_getFormatCells(s),a=0;a<t.items.length-2;a++)t.items[a].options.format=n[a]}for(a=0;a<t.items.length-2;a++){var o=t.items[a];o.options.exampleval=e.api.asc_getLocaleExample(o.options.format),$(o.el).find("label").text(o.options.exampleval)}}},t.onAutoCorrectOpenAfter=function(t){this.mnuAutoCorrectStop&&this.mnuAutoCorrectStop.setChecked(!Common.Utils.InternalSettings.get("sse-settings-autoformat-new-rows"))},t.onAutoCorrectOptions=function(){var t=new Common.Views.AutoCorrectDialog({api:this.api});t&&(t.show(),t.setActiveCategory(2))},t.onShowForeignCursorLabel=function(t,e,i,s){if(this.isUserVisible(t)){var n,a=this;a.tooltips&&a.tooltips.foreignSelect&&a.tooltips.foreignSelect.userId==t&&a.hideForeignSelectTips();for(var o=0;o<a.fastcoauthtips.length;o++)if(a.fastcoauthtips[o].attr("userid")==t){n=a.fastcoauthtips[o];break}var l=this.tooltips.coauth;e<0||e+l.XY[0]>l.bodyWidth-l.rightMenuWidth||i<0||i>l.apiHeight?n&&this.onHideForeignCursorLabel(t):(n||((n=$(document.createElement("div"))).addClass("username-tip"),n.attr("userid",t),n.css({height:a._TtHeight+"px",position:"absolute",zIndex:"900",display:"none","pointer-events":"none","background-color":"#"+Common.Utils.ThemeColor.getHexColor(s.get_r(),s.get_g(),s.get_b())}),n.text(a.getUserName(t)),$("#editor_sdk").append(n),a.fastcoauthtips.push(n),n.fadeIn(150)),n.css({left:(e+l.XY[0]+n.outerWidth()>l.bodyWidth-l.rightMenuWidth?l.bodyWidth-l.rightMenuWidth-n.outerWidth()-l.XY[0]:e)+"px",top:i-a._TtHeight+"px"}))}},t.onHideForeignCursorLabel=function(t){for(var e=this,i=0;i<e.fastcoauthtips.length;i++)if(e.fastcoauthtips[i].attr("userid")==t){var s=e.fastcoauthtips[i];e.fastcoauthtips[i].fadeOut(150,(function(){s.remove()})),e.fastcoauthtips.splice(i,1);break}},t.onDoubleClickOnTableOleObject=function(t){if(Common.Controllers.LaunchController.isScriptLoaded()&&this.permissions.isEdit&&!this._isDisabled){var e=SSE.getController("Common.Controllers.ExternalOleEditor").getView("Common.Views.ExternalOleEditor");e&&t&&(e.setEditMode(!0),e.show(),e.setOleData(Asc.asc_putBinaryDataToFrameFromTableOleObject(t)))}},t.onShowMathTrack=function(t){if(!this.permissions||this.permissions.isEdit)if(this.lastMathTrackBounds=t,Common.Controllers.LaunchController.isScriptLoaded())if(t[3]<0||Common.Utils.InternalSettings.get("sse-equation-toolbar-hide"))this.onHideMathTrack();else{var e=this,i=e.documentHolder,s=i.cmpEl.find("#equation-container");if(s.length<1){var n=e.getApplication().getCollection("EquationGroups"),a='<div id="equation-container" style="position: absolute;">';e.getApplication().getController("Toolbar").onMathTypes(),e.equationBtns=[];for(var o=0;o<n.length;++o)a+='<span id="id-document-holder-btn-equation-'+o+'"></span>';a+='<div class="separator"></div>',a+='<span id="id-document-holder-btn-equation-settings"></span>',a+="</div>",s=$(a),i.cmpEl.append(s);var l=function(t){var i=t.options.value,s=n.at(i);new Common.UI.DataViewSimple({el:$("#id-document-holder-btn-equation-menu-"+i,t.cmpEl),parentMenu:t,store:s.get("groupStore"),scrollAlwaysVisible:!0,showLast:!1,restoreHeight:450,itemTemplate:_.template('<div class="item-equation" style="" ><div class="equation-icon" style="background-position:<%= posX %>px <%= posY %>px;width:<%= width %>px;height:<%= height %>px;" id="<%= id %>"></div></div>')}).on("item:click",(function(t,i,s,n){e.api&&s&&e.api.asc_AddMath(s.get("data").equationType)})),t.off("show:before",l)},r=function(t){s.addClass("has-open-menu")},c=function(t){s.removeClass("has-open-menu")};for(o=0;o<n.length;++o){var d=n.at(o),h=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-"+o,i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"svgicon "+d.get("groupIcon"),hint:d.get("groupName"),menu:new Common.UI.Menu({value:o,items:[{template:_.template('<div id="id-document-holder-btn-equation-menu-'+o+'" class="menu-shape margin-left-5" style="width:'+(d.get("groupWidth")+8)+"px; "+d.get("groupHeightStr")+'"></div>')}]})});h.menu.on("show:before",l),h.menu.on("show:before",r),h.menu.on("hide:after",c),e.equationBtns.push(h)}e.equationSettingsBtn=new Common.UI.Button({parentEl:$("#id-document-holder-btn-equation-settings",i.cmpEl),cls:"btn-toolbar no-caret",iconCls:"toolbar__icon btn-more-vertical",hint:e.documentHolder.advancedEquationText,menu:e.documentHolder.createEquationMenu("popuptbeqinput","tl-bl")}),e.equationSettingsBtn.menu.options.initMenu=function(){var t=e.api.asc_GetMathInputType(),i=e.equationSettingsBtn.menu,s=Common.Utils.InternalSettings.get("sse-equation-toolbar-hide");i.items[5].setChecked(t===Asc.c_oAscMathInputType.Unicode),i.items[6].setChecked(t===Asc.c_oAscMathInputType.LaTeX),i.items[8].options.isToolbarHide=s,i.items[8].setCaption(s?e.documentHolder.showEqToolbar:e.documentHolder.hideEqToolbar)},e.equationSettingsBtn.menu.on("item:click",_.bind(e.convertEquation,e)),e.equationSettingsBtn.menu.on("show:before",(function(t){r(),t.options.initMenu()})),e.equationSettingsBtn.menu.on("hide:after",c)}e.tooltips.coauth.XY||e.onDocumentResize();var p=[(t[0]+t[2])/2-s.outerWidth()/2,t[1]-s.outerHeight()-10];p[0]<0&&(p[0]=0),p[1]<0&&(p[1]=t[3]+10),p[1]=Math.min(e.tooltips.coauth.apiHeight-s.outerHeight(),Math.max(0,p[1])),s.css({left:p[0],top:p[1]});var u=e.tooltips.coauth.apiHeight-p[1]-s.outerHeight(),m=e.tooltips.coauth.XY[1]+p[1],g=u<220&&u<.9*m?"bl-tl":"tl-bl";Common.UI.isRTL()&&(g="bl-tl"===g?"br-tr":"tr-br"),e.equationBtns.forEach((function(t){t&&(t.menu.menuAlign=g)})),e.equationSettingsBtn.menu.menuAlign=g,s.is(":visible")?e.equationSettingsBtn.menu.isVisible()&&(e.equationSettingsBtn.menu.options.initMenu(),e.equationSettingsBtn.menu.alignPosition()):s.show(),e.disableEquationBar()}else this.showMathTrackOnLoad=!0},t.convertEquation=function(t,e,i){this.api&&("input"==e.options.type?(this.api.asc_SetMathInputType(e.value),Common.localStorage.setBool("sse-equation-input-latex",e.value===Asc.c_oAscMathInputType.LaTeX)):"view"==e.options.type?this.api.asc_ConvertMathView(e.value.linear,e.value.all):"hide"==e.options.type&&(e.options.isToolbarHide=!e.options.isToolbarHide,Common.Utils.InternalSettings.set("sse-equation-toolbar-hide",e.options.isToolbarHide),Common.localStorage.setBool("sse-equation-toolbar-hide",e.options.isToolbarHide),e.options.isToolbarHide?this.onHideMathTrack():this.onShowMathTrack(this.lastMathTrackBounds)))},t.saveAsPicture=function(){this.api&&this.api.asc_SaveDrawingAsPicture()},t.onInsertImage=function(t,e,i){this.api&&this.api.asc_addImage(t),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onInsertImageUrl=function(t,e,i){var s=this;new Common.Views.ImageFromUrlDialog({handler:function(e,i){if("ok"==e&&s.api){var n=i.replace(/ /g,"");_.isEmpty(n)||s.api.AddImageUrl([n],void 0,void 0,t)}Common.NotificationCenter.trigger("edit:complete",s.documentHolder)}}).show()},t.onFillSeriesClick=function(t,e){if(this._state.fillSeriesItemClick=!0,this.api)if(e.value===Asc.c_oAscFillType.series){var i,s=this;new SSE.Views.FillSeriesDialog({handler:function(t,n){"ok"==t&&n&&(i=t,s.api.asc_FillCells(e.value,n)),Common.NotificationCenter.trigger("edit:complete",s.documentHolder)},props:t.seriesinfo}).on("close",(function(){"ok"!==i&&s.api.asc_CancelFillCells()})).show()}else this.api.asc_FillCells(e.value,t.seriesinfo),Common.NotificationCenter.trigger("edit:complete",this.documentHolder)},t.onFillSeriesHideAfter=function(){this.api&&!this._state.fillSeriesItemClick&&this.api.asc_CancelFillCells(),this._state.fillSeriesItemClick=!1},t.onCellFormat=function(){this.getApplication().getController("RightMenu").onRightMenuOpen(Common.Utils.documentSettingsType.Cell)}}})),define("spreadsheeteditor/main/app/view/FileMenuPanels",[],(function(){"use strict";!SSE.Views.FileMenuPanels&&(SSE.Views.FileMenuPanels={}),SSE.Views.FileMenuPanels.ViewSaveAs=Common.UI.BaseView.extend({el:"#panel-saveas",menu:void 0,formats:[[{name:"XLSX",imgCls:"xlsx",type:Asc.c_oAscFileType.XLSX},{name:"ODS",imgCls:"ods",type:Asc.c_oAscFileType.ODS},{name:"CSV",imgCls:"csv",type:Asc.c_oAscFileType.CSV},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF}],[{name:"XLTX",imgCls:"xltx",type:Asc.c_oAscFileType.XLTX},{name:"OTS",imgCls:"ots",type:Asc.c_oAscFileType.OTS},{name:"XLSB",imgCls:"xlsb",type:Asc.c_oAscFileType.XLSB},{name:"XLSM",imgCls:"xlsm",type:Asc.c_oAscFileType.XLSM},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA}],[]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.XLSM || fileType=="xlsm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"xlsx").toLowerCase(),header:Common.Locale.get("btnDownloadCaption",{name:"SSE.Views.FileMenu",default:this.textDownloadAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var s=e.length;s>t&&(t=s)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format;!_.isUndefined(e)&&this.menu&&this.menu.fireEvent("saveas:format",[this.menu,parseInt(e.value)])},textDownloadAs:"Download as"}),SSE.Views.FileMenuPanels.ViewSaveCopy=Common.UI.BaseView.extend({el:"#panel-savecopy",menu:void 0,formats:[[{name:"XLSX",imgCls:"xlsx",type:Asc.c_oAscFileType.XLSX,ext:".xlsx"},{name:"ODS",imgCls:"ods",type:Asc.c_oAscFileType.ODS,ext:".ods"},{name:"CSV",imgCls:"csv",type:Asc.c_oAscFileType.CSV,ext:".csv"},{name:"PDF",imgCls:"pdf",type:Asc.c_oAscFileType.PDF,ext:".pdf"}],[{name:"XLTX",imgCls:"xltx",type:Asc.c_oAscFileType.XLTX,ext:".xltx"},{name:"OTS",imgCls:"ots",type:Asc.c_oAscFileType.OTS,ext:".ots"},{name:"XLSB",imgCls:"xlsb",type:Asc.c_oAscFileType.XLSB,ext:".xlsb"},{name:"XLSM",imgCls:"xlsm",type:Asc.c_oAscFileType.XLSM,ext:".xlsm"},{name:"PDFA",imgCls:"pdfa",type:Asc.c_oAscFileType.PDFA,ext:".pdf"}],[{name:"JPG",imgCls:"jpg",type:Asc.c_oAscFileType.JPG,ext:".zip"},{name:"PNG",imgCls:"png",type:Asc.c_oAscFileType.PNG,ext:".zip"}]],template:_.template(['<div class="content-container">','<div class="header"><%= header %></div>','<div class="format-items">',"<% _.each(rows, function(row) { %>","<% _.each(row, function(item) { %>",'<% if (item.type!==Asc.c_oAscFileType.XLSM || fileType=="xlsm") { %>','<div class="format-item float-left"><div class="btn-doc-format" format="<%= item.type %>" format-ext="<%= item.ext %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="4, 4">','<div class ="svg-format-<%= item.imgCls %>"></div>',"</div></div>","<% } %>","<% }) %>",'<div class="divider"></div>',"<% }) %>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.fileType=t.fileType,Common.NotificationCenter.on({"window:resize":_.bind((function(){var t=Common.Utils.innerWidth()>=this.maxWidth;this.isDivided!==t&&(this.$el.find(".divider").css("width",t?"100%":"0"),this.isDivided=t)}),this)})},render:function(){this.$el.html(this.template({rows:this.formats,fileType:(this.fileType||"xlsx").toLowerCase(),header:Common.Locale.get("btnSaveCopyAsCaption",{name:"SSE.Views.FileMenu",default:this.textSaveCopyAs})})),$(".btn-doc-format",this.el).on("click",_.bind(this.onFormatClick,this)),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0}));var t=0;return this.formats.forEach(_.bind((function(e,i){var s=e.length;s>t&&(t=s)}),this)),this.maxWidth=$("#file-menu-panel .panel-menu").outerWidth()+20+10+94*t,Common.Utils.innerWidth()>=this.maxWidth&&(this.$el.find(".divider").css("width","100%"),this.isDivided=!0),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},onFormatClick:function(t){var e=t.currentTarget.attributes.format,i=t.currentTarget.attributes["format-ext"];_.isUndefined(e)||_.isUndefined(i)||!this.menu||this.menu.fireEvent("savecopy:format",[this.menu,parseInt(e.value),i.value])},textSaveCopyAs:"Save Copy as"}),SSE.Views.FileMenuPanels.MainSettingsGeneral=Common.UI.BaseView.extend(_.extend({el:"#panel-settings",menu:void 0,template:_.template(['<div class="flex-settings">','<div class="header"><%= scope.txtAdvancedSettings %></div>','<table class="main"><tbody>','<tr class="editsave">','<td class="group-name top" colspan="2"><label><%= scope.txtEditingSaving %></label></td>',"</tr>",'<tr class="autosave">','<td colspan = "2"><span id="fms-chb-autosave"></span></td>',"</tr>",'<tr class="forcesave">','<td colspan="2"><span id="fms-chb-forcesave"></span></td>',"</tr>",'<tr class="edit">','<td colspan = "2"><div id="fms-chb-paste-settings"></div></td>',"</tr>",'<tr class="edit">','<td colspan = "2"><div id="fms-chb-function-tooltip"></div></td>',"</tr>",'<tr class ="editsave divider-group"></tr>','<tr class="collaboration" >','<td class="group-name" colspan="2"><label><%= scope.txtCollaboration %></label></td>',"</tr>",'<tr class="coauth changes">','<td class="subgroup-name" colspan="2"><label><%= scope.strCoAuthMode %></label></td>',"</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex;" role="radiogroup" aria-owns="fms-rb-coauth-mode-strict">','<div id="fms-rb-coauth-mode-fast"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strFast %></label>','<label class="comment-text"><%= scope.txtFastTip %></label></span>',"</div></td>","</tr>",'<tr class="coauth changes">','<td colspan="2"><div style="display: flex; ">','<div id="fms-rb-coauth-mode-strict"></div>','<span style ="display: flex; flex-direction: column;"><label><%= scope.strStrict %></label>','<label class="comment-text"><%= scope.txtStrictTip %></label></span>',"</div></td>","</div></tr>",'<tr class ="divider coauth changes"></tr>','<tr class="live-viewer">','<td colspan="2"><div id="fms-chb-live-viewer"></div></td>',"</tr>",'<tr class="divider live-viewer"></tr>','<tr class="comments">','<td colspan="2"><div id="fms-chb-live-comment"></div></td>',"</tr>",'<tr class="comments">','<td colspan="2"><div id="fms-chb-resolved-comment"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>','<tr class="appearance">','<td colspan="2" class="group-name"><label><%= scope.txtAppearance %></label></td>',"</tr>",'<tr class="themes">',"<td><label><%= scope.strTheme %></label></td>",'<td><span id="fms-cmb-theme"></span></td>',"</tr>",'<tr class="tab-style">',"<td><label><%= scope.strTabStyle %></label></td>",'<td><div id="fms-cmb-tab-style"></div></td>',"</tr>",'<tr class="tab-background">','<td colspan="2"><div id="fms-chb-tab-background"></div></td>',"</tr>",'<tr class ="collaboration divider-group"></tr>',"<tr >",'<td class="group-name" colspan="2"><label><%= scope.txtWorkspace %></label></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-scrn-reader"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-r1c1-style"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-use-alt-key"></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-smooth-scroll"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-show-hscroll"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-chb-show-vscroll"></div></td>',"</tr>",'<tr class="divider edit"></tr>','<tr class="edit">','<td colspan="2" class="subgroup-name"><label><%= scope.txtSheetDir %></label></td>',"</tr>",'<tr class="edit">','<td colspan="2" style="padding-top:0;padding-bottom:0;"><label class="comment-text"><%= scope.txtSheetDirDesc %></label></td>',"</tr>",'<tr class="edit">','<td colspan="2" role="radiogroup" aria-owns="fms-rb-sheet-rtl"><div id="fms-rb-sheet-ltr"></div></td>',"</tr>",'<tr class="edit">','<td colspan="2"><div id="fms-rb-sheet-rtl"></div></td>',"</tr>",'<tr class ="divider edit"></tr>','<tr class="edit quick-access">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-customize-quick-access" style="width:auto;display:inline-block;padding-right:10px;padding-left:10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtCustomizeQuickAccess %></button></div></td>',"</tr>","<tr>","<td><label><%= scope.strUnit %></label></td>",'<td><span id="fms-cmb-unit"></span></td>',"</tr>","<tr>","<td><label><%= scope.strZoom %></label></td>",'<td><div id="fms-cmb-zoom" class="input-group-nr"></div></td>',"</tr>","<tr>","<td><label><%= scope.strFontRender %></label></td>",'<td><span id="fms-cmb-font-render"></span></td>',"</tr>",'<tr class="macros">',"<td><label><%= scope.strMacrosSettings %></label></td>","<td>",'<div><div id="fms-cmb-macros"></div>',"</td>","</tr>",'<tr class ="divider-group"></tr>',"<tr>",'<td class="group-name" colspan="2"><label><%= scope.strRegSettings %></label></td>',"</tr>",'<tr class="">',"<td><label><%= scope.strFuncLocale %></label></td>","<td>",'<div><div id="fms-cmb-func-locale"></div>','<label id="fms-lbl-func-locale"><%= scope.strFuncLocaleEx %></label></div></td>',"</tr>","<tr>","<td><label><%= scope.txtRegion %></label></td>","<td>",'<div><div id="fms-cmb-reg-settings"></div>','<label id="fms-lbl-reg-settings"></label></div></td>',"</tr>","<tr>",'<td colspan="2"><div id="fms-chb-separator-settings"></div></td>',"</tr>","<tr>",'<td><label class = "label-separator"><%= scope.strDecimalSeparator %></label></td>','<td><div id="fms-decimal-separator"></div></td>',"</tr>","<tr>",'<td><label class = "label-separator"><%= scope.strThousandsSeparator %></label></td>','<td><div id="fms-thousands-separator"></div></td>',"</tr>",'<tr class ="divider-group"></tr>','<tr class="edit">','<td colspan="2" class="group-name"><label><%= scope.txtProofing %></label></td>',"</tr>",'<tr class="spellcheck">',"<td><label><%= scope.strDictionaryLanguage %></label></td>",'<td><span id="fms-cmb-dictionary-language"></span></td>',"</tr>",'<tr class="spellcheck">','<td colspan="2"><span id="fms-chb-ignore-uppercase-words"></span></td>',"</tr>",'<tr class="spellcheck">','<td colspan="2"><span id="fms-chb-ignore-numbers-words"></span></td>',"</tr>",'<tr  class="edit">','<td colspan="2"><button type="button" class="btn btn-text-default" id="fms-btn-auto-correct" style="width:auto; display: inline-block;padding-right: 10px;padding-left: 10px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtAutoCorrect %></button></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>','<tr class="edit">','<td colspan="2" class="group-name"><label><%= scope.txtCalculating %></label></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-date-1904"></span></td>',"</tr>",'<tr class="edit">','<td colspan="2"><span id="fms-chb-iterative-calc"></span></td>',"</tr>",'<tr class="edit">',"<td><label><%= scope.strMaxIterations %></label></td>",'<td><div id="fms-max-iterations"></div></td>',"</tr>",'<tr class="edit">',"<td><label><%= scope.strMaxChange %></label></td>",'<td><div id="fms-max-change"></div></td>',"</tr>",'<tr class ="edit divider-group"></tr>','<tr class="fms-btn-apply">','<td style="padding-top:15px; padding-bottom: 15px;"><button class="btn normal dlg-btn primary" data-hint="3" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>",'<div class="fms-flex-apply hidden">','<table class="main" style="margin: 10px 20px; width: 100%"><tbody>',"<tr>",'<td><button class="btn normal dlg-btn primary" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.okButtonText %></button></td>',"<td></td>","</tr>","</tbody></table>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu},render:function(t){var e=this,i=$(this.template({scope:this}));this.chLiveComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-comment"),labelText:this.strShowComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,s,n){e.chResolvedComment.setDisabled("checked"!==t.getValue())})),this.chResolvedComment=new Common.UI.CheckBox({el:i.findById("#fms-chb-resolved-comment"),labelText:this.strShowResolvedComments,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chR1C1Style=new Common.UI.CheckBox({el:i.findById("#fms-chb-r1c1-style"),labelText:this.strReferenceStyle,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chUseAltKey=new Common.UI.CheckBox({el:i.findById("#fms-chb-use-alt-key"),labelText:Common.Utils.isMac?this.txtUseOptionKey:this.txtUseAltKey,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),(Common.Utils.isIE||Common.Utils.isMac&&Common.Utils.isGecko)&&this.chUseAltKey.$el.parent().parent().hide(),this.chSmoothScroll=new Common.UI.CheckBox({el:i.findById("#fms-chb-smooth-scroll"),labelText:this.strSmoothScroll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chHScroll=new Common.UI.CheckBox({el:i.findById("#fms-chb-show-hscroll"),labelText:this.strHScroll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chVScroll=new Common.UI.CheckBox({el:i.findById("#fms-chb-show-vscroll"),labelText:this.strVScroll,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chScreenReader=new Common.UI.CheckBox({el:i.findById("#fms-chb-scrn-reader"),labelText:this.txtScreenReader,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbCoAuthModeFast=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-fast"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strFast+" "+this.txtFastTip}).on("change",(function(t,i,s){i&&e.chAutosave.setValue(1)})),this.rbCoAuthModeFast.$el.parent().on("click",(function(){e.rbCoAuthModeFast.setValue(!0)})),this.rbCoAuthModeStrict=new Common.UI.RadioBox({el:i.findById("#fms-rb-coauth-mode-strict"),name:"coauth-mode",dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",ariaLabel:this.strStrict+" "+this.txtStrictTip}),this.rbCoAuthModeStrict.$el.parent().on("click",(function(){e.rbCoAuthModeStrict.setValue(!0)})),this.chLiveViewer=new Common.UI.CheckBox({el:i.findById("#fms-chb-live-viewer"),labelText:this.strShowOthersChanges,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbZoom=new Common.UI.ComboBox({el:i.findById("#fms-cmb-zoom"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%; max-height: 157px;",data:[{value:-3,displayValue:this.txtLastUsed},{value:50,displayValue:"50%"},{value:60,displayValue:"60%"},{value:70,displayValue:"70%"},{value:80,displayValue:"80%"},{value:90,displayValue:"90%"},{value:100,displayValue:"100%"},{value:110,displayValue:"110%"},{value:120,displayValue:"120%"},{value:150,displayValue:"150%"},{value:175,displayValue:"175%"},{value:200,displayValue:"200%"},{value:300,displayValue:"300%"},{value:400,displayValue:"400%"},{value:500,displayValue:"500%"}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var s=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "custom") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>"].join(""));this.cmbFontRender=new Common.UI.ComboBox({el:i.findById("#fms-cmb-font-render"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",menuStyle:"min-width:100%;",itemsTemplate:s,data:[{value:Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling,displayValue:this.txtWin},{value:Asc.c_oAscFontRenderingModeType.noHinting,displayValue:this.txtMac},{value:Asc.c_oAscFontRenderingModeType.hinting,displayValue:this.txtNative},{value:"custom",displayValue:this.txtCacheMode}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbFontRender.on("selected",_.bind(this.onFontRenderSelected,this)),this.chAutosave=new Common.UI.CheckBox({el:i.findById("#fms-chb-autosave"),labelText:this.textAutoSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",(function(t,i,s,n){"checked"!==t.getValue()&&e.rbCoAuthModeFast.getValue()&&e.rbCoAuthModeStrict.setValue(!0)})),this.chForcesave=new Common.UI.CheckBox({el:i.findById("#fms-chb-forcesave"),labelText:this.textForceSave,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.cmbUnit=new Common.UI.ComboBox({el:i.findById("#fms-cmb-unit"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:Common.Utils.Metric.c_MetricUnits.cm,displayValue:this.txtCm},{value:Common.Utils.Metric.c_MetricUnits.pt,displayValue:this.txtPt},{value:Common.Utils.Metric.c_MetricUnits.inch,displayValue:this.txtInch}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var n=[];SSE.Collections.formulasLangs.forEach((function(t){var i=t.replace(/[\-_]/,"");i=i.charAt(0).toUpperCase()+i.substring(1,i.length),n.push({value:t,displayValue:e["txt"+i+"lang"]||e["txt"+i],exampleValue:e["txtExample"+i]||e.txtExampleEn})})),n.sort((function(t,e){return t.displayValue<e.displayValue?-1:t.displayValue>e.displayValue?1:0})),this.cmbFuncLocale=new Common.UI.ComboBox({el:i.findById("#fms-cmb-func-locale"),style:"width: 200px;",menuStyle:"min-width:100%; max-height: 185px;",editable:!1,restoreMenuHeightAndTop:110,cls:"input-group-nr",data:n,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.updateFuncExample(i.exampleValue)}));var a=[{value:1025},{value:1068},{value:1026},{value:1029},{value:1030},{value:3079},{value:1031},{value:2055},{value:1032},{value:3081},{value:14345},{value:2057},{value:1033},{value:3082},{value:2058},{value:1035},{value:1036},{value:4108},{value:1057},{value:1040},{value:2064},{value:1041},{value:1042},{value:1062},{value:1038},{value:1043},{value:1045},{value:1046},{value:2070},{value:1049},{value:1051},{value:1060},{value:10266},{value:9242},{value:2077},{value:1053},{value:1055},{value:1058},{value:1066},{value:2052},{value:1028}];a.forEach((function(t){var e=Common.util.LanguageInfo.getLocalLanguageName(t.value),i=Common.util.LanguageInfo.getLocalLanguageDisplayName(t.value);t.displayValue=i.native,t.displayValueEn=i.english,t.langName=e[0]})),this.cmbRegSettings=new Common.UI.ComboBox({el:i.findById("#fms-cmb-reg-settings"),style:"width: 200px;",menuStyle:"min-width:100%; max-height: 185px;",restoreMenuHeightAndTop:110,editable:!1,cls:"input-group-nr",itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= item.displayValue %>","</div>",'<label style="opacity: 0.6"><%= item.displayValueEn %></label>',"</a>","</li>","<% }); %>"].join("")),search:!0,searchFields:["displayValue","displayValueEn"],data:a,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}).on("selected",(function(t,i){e.updateRegionalExample(i.value),"checked"===e.chSeparator.getValue()&&(e.inputDecimalSeparator.setValue(e.api.asc_getDecimalSeparator(i.value),!0),e.inputThousandsSeparator.setValue(e.api.asc_getGroupSeparator(i.value),!0))})),this.cmbRegSettings.scroller&&this.cmbRegSettings.scroller.update({alwaysVisibleY:!0}),this.chSeparator=new Common.UI.CheckBox({el:i.findById("#fms-chb-separator-settings"),labelText:this.strUseSeparatorsBasedOnRegionalSettings,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("change",_.bind((function(t,e,i,s){var n="checked"===t.getValue();if(n){var a=this.cmbRegSettings.getValue(),o=this.api.asc_getDecimalSeparator(_.isNumber(a)?a:void 0),l=this.api.asc_getGroupSeparator(_.isNumber(a)?a:void 0);this.inputDecimalSeparator.setValue(o),this.inputThousandsSeparator.setValue(l)}this.inputDecimalSeparator.setDisabled(n),this.inputThousandsSeparator.setDisabled(n),n?this.$el.find(".label-separator").addClass("disabled"):this.$el.find(".label-separator").removeClass("disabled")}),this));var o=function(t){var e=t.key,i=t.target.value;"ArrowLeft"!==e&&"ArrowDown"!==e&&"ArrowUp"!==e&&"ArrowRight"!==e&&"Home"!==e&&"End"!==e&&"Backspace"!==e&&"Delete"!==e&&i.length>0&&t.target.selectionEnd-t.target.selectionStart==0&&t.preventDefault()};this.inputDecimalSeparator=new Common.UI.InputField({el:i.findById("#fms-decimal-separator"),style:"width: 35px;",validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.inputDecimalSeparator.$el.find("input").on("keydown",o),this.inputThousandsSeparator=new Common.UI.InputField({el:i.findById("#fms-thousands-separator"),style:"width: 35px;",validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.inputThousandsSeparator.$el.find("input").on("keydown",o),this.cmbMacros=new Common.UI.ComboBox({el:i.findById("#fms-cmb-macros"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",data:[{value:2,displayValue:this.txtStopMacros,descValue:this.txtStopMacrosDesc},{value:0,displayValue:this.txtWarnMacros,descValue:this.txtWarnMacrosDesc},{value:1,displayValue:this.txtRunMacros,descValue:this.txtRunMacrosDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPaste=new Common.UI.CheckBox({el:i.findById("#fms-chb-paste-settings"),labelText:this.strPasteButton,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chTooltip=new Common.UI.CheckBox({el:i.findById("#fms-chb-function-tooltip"),labelText:this.strFunctionTooltip,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnCustomizeQuickAccess=new Common.UI.Button({el:i.findById("#fms-btn-customize-quick-access")}),this.btnCustomizeQuickAccess.on("click",_.bind(this.customizeQuickAccess,this)),this.cmbTheme=new Common.UI.ComboBox({el:i.findById("#fms-cmb-theme"),style:"width: 160px;",editable:!1,restoreMenuHeightAndTop:!0,menuStyle:"min-width:100%;",cls:"input-group-nr",dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbTabStyle=new Common.UI.ComboBox({el:i.findById("#fms-cmb-tab-style"),style:"width: 160px;",menuStyle:"min-width:100%;",editable:!1,restoreMenuHeightAndTop:!0,cls:"input-group-nr",data:[{value:"fill",displayValue:this.textFill},{value:"line",displayValue:this.textLine}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var l="app-settings-recent-langs";return this.cmbDictionaryLanguage=new Common.UI.ComboBoxRecent({el:i.findById("#fms-cmb-dictionary-language"),cls:"input-group-nr",style:"width: 200px;",editable:!1,restoreMenuHeightAndTop:110,menuStyle:"min-width: 100%; max-height: 209px;",itemTemplate:_.template(['<li id="<%= id %>" data-value="<%= value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= displayValue %>","</div>",'<label style="opacity: 0.6"><%= displayValueEn %></label>',"</a>","</li>"].join("")),search:!0,searchFields:["displayValue","displayValueEn"],recent:{count:Common.Utils.InternalSettings.get(l+"-count")||5,offset:Common.Utils.InternalSettings.get(l+"-offset")||0,key:l,valueField:"shortName"},dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chIgnoreUppercase=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-uppercase-words"),labelText:this.strIgnoreWordsInUPPERCASE,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chIgnoreNumbers=new Common.UI.CheckBox({el:i.findById("#fms-chb-ignore-numbers-words"),labelText:this.strIgnoreWordsWithNumbers,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chDateSystem=new Common.UI.CheckBox({el:i.findById("#fms-chb-date-1904"),labelText:this.strDateFormat1904,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnAutoCorrect=new Common.UI.Button({el:i.findById("#fms-btn-auto-correct")}),this.btnAutoCorrect.on("click",_.bind(this.autoCorrect,this)),this.chTabBack=new Common.UI.CheckBox({el:i.findById("#fms-chb-tab-background"),labelText:this.txtTabBack,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),i.find(".btn.primary").each((function(t,i){new Common.UI.Button({el:$(i)}).on("click",_.bind(e.applySettings,e))})),this.chIterative=new Common.UI.CheckBox({el:i.findById("#fms-chb-iterative-calc"),labelText:this.strEnableIterative,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.inputMaxChange=new Common.UI.InputField({el:i.findById("#fms-max-change"),style:"width: 60px;",validateOnBlur:!1,maskExp:/[0-9,\.]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small",validation:function(t){return!!(_.isEmpty(t)||/^(\d*(\.|,)?\d+)$|^(\d+(\.|,)?\d*)$/.test(t)&&!isNaN(Common.Utils.String.parseFloat(t)))||e.txtErrorNumber}}),this.spnMaxIterations=new Common.UI.MetricSpinner({el:i.findById("#fms-max-iterations"),step:1,width:60,defaultUnit:"",value:100,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbSheetLtr=new Common.UI.RadioBox({el:i.findById("#fms-rb-sheet-ltr"),name:"sheet-dir",labelText:this.txtSheetLtr,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.rbSheetRtl=new Common.UI.RadioBox({el:i.findById("#fms-rb-sheet-rtl"),name:"sheet-dir",labelText:this.txtSheetRtl,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=this.pnlSettings.find("table"),this.trApply=i.find(".fms-btn-apply"),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSettings(),this.updateScroller()},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.parent().height()+25+this.pnlApply.height();this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible()),this.cmbZoom.options.menuAlignEl=t?this.pnlSettings:null,this.cmbUnit.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFontRender.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTheme.options.menuAlignEl=t?this.pnlSettings:null,this.cmbMacros.options.menuAlignEl=t?this.pnlSettings:null,this.cmbFuncLocale.options.menuAlignEl=t?this.pnlSettings:null,this.cmbRegSettings.options.menuAlignEl=t?this.pnlSettings:null,this.cmbDictionaryLanguage.options.menuAlignEl=t?this.pnlSettings:null,this.cmbTabStyle.options.menuAlignEl=t?this.pnlSettings:null}},setMode:function(t){this.mode=t;var e=Common.Utils.InternalSettings.get("sse-settings-coauthmode");$("tr.editsave",this.el)[t.isEdit||t.canForcesave?"show":"hide"](),$("tr.collaboration",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.edit",this.el)[t.isEdit?"show":"hide"](),$("tr.autosave",this.el)[!t.isEdit||!t.canChangeCoAuthoring&&e?"hide":"show"](),this.mode.isDesktopApp&&this.mode.isOffline&&this.chAutosave.setCaption(this.textAutoRecover),$("tr.forcesave",this.el)[t.canForcesave?"show":"hide"](),$("tr.comments",this.el)[t.canCoAuthoring?"show":"hide"](),$("tr.coauth.changes",this.el)[t.isEdit&&!t.isOffline&&t.canCoAuthoring&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.live-viewer",this.el)[t.canLiveView&&!t.isOffline&&t.canChangeCoAuthoring?"show":"hide"](),$("tr.macros",this.el)[t.customization&&!1===t.customization.macros?"hide":"show"](),$("tr.quick-print",this.el)[!t.canQuickPrint||t.compactHeader&&t.isEdit?"hide":"show"](),$("tr.tab-background",this.el)[!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)?"show":"hide"](),$("tr.tab-style",this.el)[Common.Utils.isIE||Common.Controllers.Desktop.isWinXp()||!Common.UI.FeaturesManager.canChange("tabStyle",!0)?"hide":"show"](),Common.UI.Themes.available()||$("tr.themes, tr.themes + tr.divider",this.el).hide(),$("tr.appearance",this.el)[Common.Utils.isIE?"hide":"show"](),$("tr.spellcheck",this.el)[Common.UI.FeaturesManager.canChange("spellcheck")&&t.isEdit?"show":"hide"](),t.compactHeader&&$("tr.quick-access",this.el).hide()},setApi:function(t){this.api=t},updateSettings:function(){r=null!==(r=Common.Utils.InternalSettings.get("sse-settings-zoom"))?parseInt(r):this.mode.customization&&this.mode.customization.zoom?parseInt(this.mode.customization.zoom):100;var t=this.cmbZoom.store.findWhere({value:r});this.cmbZoom.setValue(t?parseInt(t.get("value")):r>0?r+"%":100),this.chUseAltKey.setValue(Common.Utils.InternalSettings.get("sse-settings-show-alt-hints")),this.chScreenReader.setValue(Common.Utils.InternalSettings.get("app-settings-screen-reader")),this.chLiveComment.setValue(Common.Utils.InternalSettings.get("sse-settings-livecomment")),this.chResolvedComment.setValue(Common.Utils.InternalSettings.get("sse-settings-resolvedcomment")),this.chR1C1Style.setValue(Common.Utils.InternalSettings.get("sse-settings-r1c1")),this.chSmoothScroll.setValue(!Common.Utils.InternalSettings.get("sse-settings-smooth-scroll"));var e=Common.Utils.InternalSettings.get("sse-settings-coauthmode");this.rbCoAuthModeFast.setValue(e),this.rbCoAuthModeStrict.setValue(!e),this.chLiveViewer.setValue(Common.Utils.InternalSettings.get("sse-settings-coauthmode")),r=Common.Utils.InternalSettings.get("sse-settings-fontrender"),t=this.cmbFontRender.store.findWhere({value:parseInt(r)}),this.cmbFontRender.setValue(t?t.get("value"):Asc.c_oAscFontRenderingModeType.hintingAndSubpixeling),this._fontRender=this.cmbFontRender.getValue(),r=Common.Utils.InternalSettings.get("sse-settings-cachemode"),(t=this.cmbFontRender.store.findWhere({value:"custom"}))&&r&&t.set("checked",!!r),t&&r&&this.cmbFontRender.cmpEl.find("#"+t.get("id")+" a").addClass("checked"),r=Common.Utils.InternalSettings.get("sse-settings-unit"),t=this.cmbUnit.store.findWhere({value:r}),this.cmbUnit.setValue(t?parseInt(t.get("value")):Common.Utils.Metric.getDefaultMetric()),this._oldUnits=this.cmbUnit.getValue(),r=Common.Utils.InternalSettings.get("sse-settings-autosave"),this.chAutosave.setValue(1==r),this.mode.canForcesave&&this.chForcesave.setValue(Common.Utils.InternalSettings.get("sse-settings-forcesave")),r=Common.Utils.InternalSettings.get("sse-settings-func-locale"),!(t=this.cmbFuncLocale.store.findWhere({value:r}))&&r&&(t=this.cmbFuncLocale.store.findWhere({value:r.split(/[\-\_]/)[0]})),this.cmbFuncLocale.setValue(t?t.get("value"):"en"),this.updateFuncExample(t?t.get("exampleValue"):this.txtExampleEn),(r=this.api.asc_getLocale())?(t=this.cmbRegSettings.store.findWhere({value:r}),this.cmbRegSettings.setValue(t?t.get("value"):Common.util.LanguageInfo.getLocalLanguageName(r)[1]),t&&(r=this.cmbRegSettings.getValue())):(r=this.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.mode.lang)):1033,this.cmbRegSettings.setValue(Common.util.LanguageInfo.getLocalLanguageName(r)[1])),this.updateRegionalExample(r);var i,s,n=Common.Utils.InternalSettings.get("sse-settings-use-base-separator");if(this.chSeparator.setValue(n,!0),n){var a=this.cmbRegSettings.getValue();i=this.api.asc_getDecimalSeparator(_.isNumber(a)?a:void 0),s=this.api.asc_getGroupSeparator(_.isNumber(a)?a:void 0)}else i=Common.Utils.InternalSettings.get("sse-settings-decimal-separator")||this.api.asc_getDecimalSeparator(),s=Common.Utils.InternalSettings.get("sse-settings-group-separator")||this.api.asc_getGroupSeparator();this.inputDecimalSeparator.setValue(i),this.inputThousandsSeparator.setValue(s),this.inputDecimalSeparator.setDisabled(n),this.inputThousandsSeparator.setDisabled(n),n?this.$el.find(".label-separator").addClass("disabled"):this.$el.find(".label-separator").removeClass("disabled"),t=this.cmbMacros.store.findWhere({value:Common.Utils.InternalSettings.get("sse-macros-mode")}),this.cmbMacros.setValue(t?t.get("value"):0),this.chPaste.setValue(Common.Utils.InternalSettings.get("sse-settings-paste-button")),this.chTooltip.setValue(Common.Utils.InternalSettings.get("sse-settings-function-tooltip")),(r=this.api.asc_GetCalcSettings())&&(this.chIterative.setValue(!!r.asc_getIterativeCalc()),this.spnMaxIterations.setValue(r.asc_getMaxIterations()),this.inputMaxChange.setValue(r.asc_getMaxChange())),r=Common.Utils.InternalSettings.get("sse-settings-def-sheet-rtl"),this.rbSheetLtr.setValue(!r),this.rbSheetRtl.setValue(r);var o=[];for(var l in Common.UI.Themes.map())o.push({value:l,displayValue:Common.UI.Themes.get(l).text});if(o.length&&(this.cmbTheme.setData(o),t=this.cmbTheme.store.findWhere({value:Common.UI.Themes.currentThemeId()}),this.cmbTheme.setValue(t?t.get("value"):Common.UI.Themes.defaultThemeId())),this.chTabBack.setValue("toolbar"===Common.Utils.InternalSettings.get("settings-tab-background")),r=Common.Utils.InternalSettings.get("settings-tab-style"),t=this.cmbTabStyle.store.findWhere({value:r}),this.cmbTabStyle.setValue(t?t.get("value"):"fill"),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit){var r,c=SSE.getController("Spellcheck").loadLanguages(),d=c[0],h=c[1],p=c[2],u=Common.Utils.InternalSettings.get("sse-spellcheck-locale");if(r=u?parseInt(u):this.mode.lang?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(this.mode.lang)):1033,h&&h.length>0)(0===this.cmbDictionaryLanguage.store.length||p)&&this.cmbDictionaryLanguage.setData(h),!(t=this.cmbDictionaryLanguage.store.findWhere({value:r}))&&d[r]&&(r=d[r][0].split(/[\-\_]/)[0],(t=this.cmbDictionaryLanguage.store.find((function(t){return 0==t.get("shortName").indexOf(r)})))||(t=this.cmbDictionaryLanguage.store.findWhere({shortName:"en-US"}))),this.cmbDictionaryLanguage.setValue(t?t.get("value"):h[0].value),(r=this.cmbDictionaryLanguage.getValue())!==parseInt(u)&&Common.Utils.InternalSettings.set("sse-spellcheck-locale",r);else this.cmbDictionaryLanguage.setValue(Common.util.LanguageInfo.getLocalLanguageName(r)[1]),this.cmbDictionaryLanguage.setDisabled(!0);this.chIgnoreUppercase.setValue(Common.Utils.InternalSettings.get("sse-spellcheck-ignore-uppercase-words")),this.chIgnoreNumbers.setValue(Common.Utils.InternalSettings.get("sse-spellcheck-ignore-numbers-words")),this.chDateSystem.setValue(this.api.asc_getDate1904())}this.mode.isEdit&&(this.chHScroll.setValue(this.api.asc_GetShowHorizontalScroll()),this.chVScroll.setValue(this.api.asc_GetShowVerticalScroll()))},isValid:function(){if(!this.mode.isEdit||!0===this.inputMaxChange.checkValidate())return!0;this.inputMaxChange.focus()},applySettings:function(){if(this.isValid()){Common.UI.Themes.setTheme(this.cmbTheme.getValue()),Common.localStorage.setItem("sse-settings-show-alt-hints",this.chUseAltKey.isChecked()?1:0),Common.Utils.InternalSettings.set("sse-settings-show-alt-hints",Common.localStorage.getBool("sse-settings-show-alt-hints")),Common.localStorage.setItem("sse-settings-zoom",this.cmbZoom.getValue()),Common.localStorage.setItem("app-settings-screen-reader",this.chScreenReader.isChecked()?1:0),Common.localStorage.setItem("sse-settings-livecomment",this.chLiveComment.isChecked()?1:0),Common.localStorage.setItem("sse-settings-resolvedcomment",this.chResolvedComment.isChecked()?1:0),this.mode.isEdit&&!this.mode.isOffline&&this.mode.canCoAuthoring&&this.mode.canChangeCoAuthoring?Common.localStorage.setItem("sse-settings-coauthmode",this.rbCoAuthModeFast.getValue()?1:0):this.mode.canLiveView&&!this.mode.isOffline&&this.mode.canChangeCoAuthoring&&Common.localStorage.setItem("sse-settings-view-coauthmode",this.chLiveViewer.isChecked()?1:0),Common.localStorage.setItem("sse-settings-r1c1",this.chR1C1Style.isChecked()?1:0),Common.localStorage.setItem("sse-settings-smooth-scroll",this.chSmoothScroll.isChecked()?0:1),Common.localStorage.setItem("sse-settings-fontrender",this.cmbFontRender.getValue());var t=this.cmbFontRender.store.findWhere({value:"custom"});Common.localStorage.setItem("sse-settings-cachemode",t&&!t.get("checked")?0:1),Common.localStorage.setItem("sse-settings-unit",this.cmbUnit.getValue()),!this.mode.isEdit||!this.mode.canChangeCoAuthoring&&Common.Utils.InternalSettings.get("sse-settings-coauthmode")||Common.localStorage.setItem("sse-settings-autosave",this.chAutosave.isChecked()?1:0),this.mode.canForcesave&&Common.localStorage.setItem("sse-settings-forcesave",this.chForcesave.isChecked()?1:0),Common.localStorage.setItem("sse-settings-func-locale",this.cmbFuncLocale.getValue()),this.cmbRegSettings.getSelectedRecord()&&Common.localStorage.setItem("sse-settings-reg-settings",this.cmbRegSettings.getValue());var e=this.chSeparator.isChecked();if(e||((i=this.inputDecimalSeparator.getValue()).length>0&&(Common.localStorage.setItem("sse-settings-decimal-separator",i),Common.Utils.InternalSettings.set("sse-settings-decimal-separator",i)),(i=this.inputThousandsSeparator.getValue()).length>0&&(Common.localStorage.setItem("sse-settings-group-separator",i),Common.Utils.InternalSettings.set("sse-settings-group-separator",i))),Common.localStorage.setBool("sse-settings-use-base-separator",e),Common.Utils.InternalSettings.set("sse-settings-use-base-separator",e),Common.localStorage.setItem("sse-macros-mode",this.cmbMacros.getValue()),Common.Utils.InternalSettings.set("sse-macros-mode",this.cmbMacros.getValue()),Common.localStorage.setItem("sse-settings-paste-button",this.chPaste.isChecked()?1:0),Common.localStorage.setItem("sse-settings-function-tooltip",this.chTooltip.isChecked()?1:0),Common.Utils.InternalSettings.set("sse-settings-function-tooltip",this.chTooltip.isChecked()?1:0),this.mode.isEdit&&Common.localStorage.setBool("sse-settings-def-sheet-rtl",this.rbSheetRtl.getValue()),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabBackground",!0)&&Common.UI.TabStyler.setBackground(this.chTabBack.isChecked()?"toolbar":"header"),!Common.Utils.isIE&&Common.UI.FeaturesManager.canChange("tabStyle",!0)&&Common.UI.TabStyler.setStyle(this.cmbTabStyle.getValue()),Common.localStorage.save(),this.menu&&(this.menu.fireEvent("settings:apply",[this.menu]),this._oldUnits!==this.cmbUnit.getValue()&&Common.NotificationCenter.trigger("settings:unitschanged",this)),Common.UI.FeaturesManager.canChange("spellcheck")&&this.mode.isEdit){var i=this.chIgnoreUppercase.isChecked();Common.localStorage.setBool("sse-spellcheck-ignore-uppercase-words",i),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-uppercase-words",i),i=this.chIgnoreNumbers.isChecked(),Common.localStorage.setBool("sse-spellcheck-ignore-numbers-words",i),Common.Utils.InternalSettings.set("sse-spellcheck-ignore-numbers-words",i),this.cmbDictionaryLanguage.isDisabled()||(i=this.cmbDictionaryLanguage.getValue(),Common.localStorage.setItem("sse-spellcheck-locale",i),Common.Utils.InternalSettings.set("sse-spellcheck-locale",i)),Common.localStorage.save(),this.menu&&this.menu.fireEvent("spellcheck:apply",[this.menu])}this.mode.isEdit&&(this.api.asc_setDate1904(this.chDateSystem.isChecked()),(i=this.api.asc_GetCalcSettings())&&(i.asc_setIterativeCalc(this.chIterative.isChecked()),i.asc_setMaxIterations(this.spnMaxIterations.getNumberValue()),this.inputMaxChange.getValue()&&i.asc_setMaxChange(Common.Utils.String.parseFloat(this.inputMaxChange.getValue())),this.api.asc_UpdateCalcSettings(i)),this.api.asc_SetShowHorizontalScroll(this.chHScroll.isChecked()),this.api.asc_SetShowVerticalScroll(this.chVScroll.isChecked()))}},updateRegionalExample:function(t){if(this.api){var e="";if(t){var i=new Asc.asc_CFormatCellsInfo;i.asc_setType(Asc.c_oAscNumFormatType.None),i.asc_setSymbol(t);var s=this.api.asc_getFormatCells(i);e=(e=(e=this.api.asc_getLocaleExample(s[4],1000.01,t))+" "+this.api.asc_getLocaleExample(s[5],Asc.cDate().getExcelDateWithTime(!0),t))+" "+this.api.asc_getLocaleExample(s[7],Asc.cDate().getExcelDateWithTime(!0),t)}$("#fms-lbl-reg-settings").text(_.isEmpty(e)?"":this.strRegSettingsEx+e)}},updateFuncExample:function(t){$("#fms-lbl-func-locale").text(_.isEmpty(t)?"":this.strRegSettingsEx+" "+t)},onFontRenderSelected:function(t,e){if("custom"==e.value){var i=t.store.findWhere({value:"custom"});i&&i.set("checked",!e.checked),t.cmpEl.find("#"+e.id+" a").toggleClass("checked",!e.checked),t.setValue(this._fontRender)}this._fontRender=t.getValue()},autoCorrect:function(){this.dlgAutoCorrect&&this.dlgAutoCorrect.isVisible()||(this.dlgAutoCorrect=new Common.Views.AutoCorrectDialog({api:this.api}),this.dlgAutoCorrect.show())},SetDisabled:function(t){t?this.$el.hide():this.mode.isEdit&&this.$el.show()},customizeQuickAccess:function(){this.dlgQuickAccess&&this.dlgQuickAccess.isVisible()||(this.dlgQuickAccess=new Common.Views.CustomizeQuickAccessDialog({showSave:this.mode.showSaveButton&&Common.UI.LayoutManager.isElementVisible("header-save"),showPrint:this.mode.canPrint&&this.mode.twoLevelHeader,showQuickPrint:this.mode.canQuickPrint&&this.mode.twoLevelHeader,mode:this.mode,props:{save:Common.localStorage.getBool("sse-quick-access-save",!0),print:Common.localStorage.getBool("sse-quick-access-print",!0),quickPrint:Common.localStorage.getBool("sse-quick-access-quick-print",!0),undo:Common.localStorage.getBool("sse-quick-access-undo",!0),redo:Common.localStorage.getBool("sse-quick-access-redo",!0)}}),this.dlgQuickAccess.show())},strZoom:"Default Zoom Value",okButtonText:"Apply",txtWin:"as Windows",txtMac:"as OS X",txtNative:"Native",strFontRender:"Font Hinting",strUnit:"Unit of Measurement",txtCm:"Centimeter",txtPt:"Point",textAutoSave:"Autosave",txtEn:"English",txtDe:"Deutsch",txtRu:"Russian",txtPl:"Polish",txtEs:"Spanish",txtFr:"French",txtIt:"Italian",txtExampleEn:"SUM; MIN; MAX; COUNT",txtExampleDe:"SUMME; MIN; MAX; ANZAHL",txtExampleRu:"; ; ; ",txtExamplePl:"SUMA; MIN; MAX; ILE.LICZB",txtExampleEs:"SUMA; MIN; MAX; CALCULAR",txtExampleFr:"SOMME; MIN; MAX; NB",txtExampleIt:"SOMMA; MIN; MAX; CONTA.NUMERI",strFuncLocale:"Formula Language",strFuncLocaleEx:"Example: SUM; MIN; MAX; COUNT",strRegSettings:"Regional Settings",strRegSettingsEx:"Example: ",strCoAuthMode:"Co-editing mode",strFast:"Fast",strStrict:"Strict",textAutoRecover:"Autorecover",txtInch:"Inch",textForceSave:"Save to Server",textRefStyle:"Reference Style",strUseSeparatorsBasedOnRegionalSettings:"Use separators based on regional settings",strDecimalSeparator:"Decimal separator",strThousandsSeparator:"Thousands separator",txtCacheMode:"Default cache mode",strMacrosSettings:"Macros Settings",txtWarnMacros:"Show Notification",txtRunMacros:"Enable All",txtStopMacros:"Disable All",txtWarnMacrosDesc:"Disable all macros with notification",txtRunMacrosDesc:"Enable all macros without notification",txtStopMacrosDesc:"Disable all macros without notification",strTheme:"Theme",txtThemeLight:"Light",txtThemeDark:"Dark",strPasteButton:"Show Paste Options button when content is pasted",txtBe:"Belarusian",txtBg:"Bulgarian",txtCa:"Catalan",txtZh:"Chinese",txtCs:"Czech",txtDa:"Danish",txtNl:"Dutch",txtFi:"Finnish",txtEl:"Greek",txtHu:"Hungarian",txtId:"Indonesian",txtJa:"Japanese",txtKo:"Korean",txtLv:"Latvian",txtLo:"Lao",txtNb:"Norwegian",txtPtlang:"Portuguese (Portugal)",txtPtbr:"Portuguese (Brazil)",txtRo:"Romanian",txtSk:"Slovak",txtSl:"Slovenian",txtSv:"Swedish",txtTr:"Turkish",txtUk:"Ukrainian",txtVi:"Vietnamese",txtExampleBe:"; ; ; ",txtExampleCa:"SUMA; MIN; MAX; COMPT",txtExampleCs:"SUMA; MIN; MAX; POET",txtExampleDa:"SUM; MIN; MAKS; TL",txtExampleNl:"SOM; MIN; MAX; AANTAL",txtExampleFi:"SUMMA; MIN; MAKS; LASKE",txtExampleHu:"SZUM; MIN; MAX; DARAB",txtExampleNb:"SUMMER; MIN; STRST; ANTALL",txtExamplePt:"SOMA; MNIMO; MXIMO; CONTAR",txtExamplePtbr:"SOMA; MNIMO; MXIMO; CONT.NM",txtExampleSv:"SUMMA; MIN; MAX; ANTAL",txtExampleTr:"TOPLA; MN; MAK; BA_DE_SAY",txtEditingSaving:"Editing and saving",txtCollaboration:"Collaboration",strShowComments:"Show comments in sheet",strShowResolvedComments:"Show resolved comments",txtWorkspace:"Workspace",strReferenceStyle:"R1C1 reference style",txtUseAltKey:"Use Alt key to navigate the user interface using the keyboard",txtUseOptionKey:"Use Option key to navigate the user interface using the keyboard",txtRegion:"Region",txtProofing:"Proofing",strDictionaryLanguage:"Dictionary language",strIgnoreWordsInUPPERCASE:"Ignore words in UPPERCASE",strIgnoreWordsWithNumbers:"Ignore words with numbers",txtAutoCorrect:"AutoCorrect options...",txtFastTip:"Real-time co-editing. All changes are saved automatically",txtStrictTip:"Use the 'Save' button to sync the changes you and others make",strShowOthersChanges:"Show changes from other users",txtCalculating:"Calculating",strDateFormat1904:"Use 1904 date system",txtAdvancedSettings:"Advanced Settings",txtQuickPrint:"Show the Quick Print button in the editor header",txtQuickPrintTip:"The document will be printed on the last selected or default printer",txtHy:"Armenian",txtLastUsed:"Last used",txtScreenReader:"Turn on screen reader support",strMaxIterations:"Maximum iterations",strMaxChange:"Maximum change",strEnableIterative:"Enable iterative calculation",txtErrorNumber:"Your entry cannot be used. An integer or decimal number may be required.",txtCustomizeQuickAccess:"Customize quick access",txtTabBack:"Use toolbar color as tabs background",strTabStyle:"Tab style",textFill:"Fill",textLine:"Line",txtAppearance:"Appearance"},SSE.Views.FileMenuPanels.MainSettingsGeneral||{})),SSE.Views.FileMenuPanels.CreateNew=Common.UI.BaseView.extend(_.extend({el:"#panel-createnew",menu:void 0,events:function(){return{"click .blank-document":_.bind(this._onBlankDocument,this),"click .thumb-list .thumb-wrap":_.bind(this._onDocumentTemplate,this)}},template:_.template(['<div class="header"><%= scope.txtCreateNew %></div>','<div class="thumb-list">',"<% if (blank) { %> ",'<div class="blank-document" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="blank-document-btn">','<div class="btn-blank-format"><div class="svg-format-blank"></div></div>',"</div>",'<div class="title"><%= scope.txtBlank %></div>',"</div>","<% } %>","<% _.each(docs, function(item, index) { %>",'<div class="thumb-wrap" template="<%= item.url %>" data-hint="2" data-hint-direction="left-top" data-hint-offset="22, 13">','<div class="thumb" ',"<% if (!_.isEmpty(item.image)) {%> ",' style="background-image: url(<%= item.image %>);">'," <%} else {print(\"><div class='btn-blank-format'><div class='svg-file-template'></div></div>\") } %>","</div>",'<div class="title"><%= Common.Utils.String.htmlEncode(item.title || item.name || "") %></div>',"</div>","<% }) %>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.docs=t.docs,this.blank=!!t.blank},render:function(){this.$el.html(this.template({scope:this,docs:this.docs,blank:this.blank}));var t=(this.blank?[{title:this.txtBlank}]:[]).concat(this.docs),e=this.$el.find(".thumb-wrap, .blank-document");return _.each(e,(function(e,i){$(e).find(".title").tooltip({title:t[i].title,placement:"cursor"})})),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},_onBlankDocument:function(){this.menu&&this.menu.fireEvent("create:new",[this.menu,"blank"])},_onDocumentTemplate:function(t){this.menu&&this.menu.fireEvent("create:new",[this.menu,t.currentTarget.attributes.template.value])},txtBlank:"Blank spreadsheet",txtCreateNew:"Create New"},SSE.Views.FileMenuPanels.CreateNew||{})),SSE.Views.FileMenuPanels.DocumentInfo=Common.UI.BaseView.extend(_.extend({el:"#panel-info",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<table class="main">','<tbody><td class="header">'+this.txtSpreadsheetInfo+"</td></tbody>","<tbody>",'<tr><td class="title"><label>'+this.txtCommon+"</label></td></tr>","<tr>",'<td class="left"><label>'+this.txtPlacement+"</label></td>",'<td class="right"><label id="id-info-placement">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtOwner+"</label></td>",'<td class="right"><label id="id-info-owner">-</label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtUploaded+"</label></td>",'<td class="right"><label id="id-info-uploaded">-</label></td>',"</tr>","<tr></tr>","<tr>",'<td class="left"><label>'+this.txtModifyDate+"</label></td>",'<td class="right"><label id="id-info-modify-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtModifyBy+"</label></td>",'<td class="right"><label id="id-info-modify-by"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtCreated+"</label></td>",'<td class="right"><label id="id-info-date"></label></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtAppName+"</label></td>",'<td class="right"><label id="id-info-appname"></label></td>',"</tr>","</tbody>",'<tbody class="properties-tab">','<tr><td class="title"><label>'+this.txtProperties+"</label></td></tr>",'<tr class="author-info">','<td class="left"><label>'+this.txtAuthor+"</label></td>",'<td class="right"><div id="id-info-author">',"<table>","<tr>",'<td><div id="id-info-add-author"><input type="text" spellcheck="false" class="form-control" placeholder="'+this.txtAddAuthor+'"></div></td>',"</tr>","</table>","</div></td>","</tr>","<tr>",'<td class="left"><label>'+this.txtTitle+"</label></td>",'<td class="right"><div id="id-info-title"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtTags+"</label></td>",'<td class="right"><div id="id-info-tags"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtSubject+"</label></td>",'<td class="right"><div id="id-info-subject"></div></td>',"</tr>","<tr>",'<td class="left"><label>'+this.txtComment+"</label></td>",'<td class="right"><div id="id-info-comment"></div></td>',"</tr>","</tbody>","<tbody>","<tr>",'<td class="left"></td>','<td class="right">','<button id="fminfo-btn-add-property" class="btn" data-hint="2" data-hint-direction="bottom" data-hint-offset="big">',"<span>"+this.txtAddProperty+"</span>","</button>","</td>","</tr>","</tbody>","</table>"].join("")),this.menu=t.menu,this.coreProps=null,this.authors=[],this._locked=!1},render:function(t){var e=this,i=$(e.template({scope:e}));this.lblPlacement=i.findById("#id-info-placement"),this.lblOwner=i.findById("#id-info-owner"),this.lblUploaded=i.findById("#id-info-uploaded");var s=function(t,e){if(e.keyCode===Common.UI.Keys.ESC){var i=t._input.val(),s=t.getValue();i!==s&&(t.setValue(s),e.stopPropagation())}};return this.inputTitle=new Common.UI.InputField({el:i.findById("#id-info-title"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s).on("keydown:before",s).on("changed:after",(function(t,i){e.coreProps.asc_putTitle(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputTags=new Common.UI.InputField({el:i.findById("#id-info-tags"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s).on("changed:after",(function(t,i){e.coreProps.asc_putKeywords(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputSubject=new Common.UI.InputField({el:i.findById("#id-info-subject"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s).on("changed:after",(function(t,i){e.coreProps.asc_putSubject(i),e.api.asc_setCoreProps(e.coreProps)})),this.inputComment=new Common.UI.InputField({el:i.findById("#id-info-comment"),style:"width: 200px;",placeHolder:this.txtAddText,validateOnBlur:!1,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("keydown:before",s).on("changed:after",(function(t,i){e.coreProps.asc_putDescription(i),e.api.asc_setCoreProps(e.coreProps)})),this.lblModifyDate=i.findById("#id-info-modify-date"),this.lblModifyBy=i.findById("#id-info-modify-by"),this.lblDate=i.findById("#id-info-date"),this.lblApplication=i.findById("#id-info-appname"),this.tblAuthor=i.findById("#id-info-author table"),this.trAuthor=i.findById("#id-info-add-author").closest("tr"),this.authorTpl='<tr><td><div style="display: inline-block;width: 200px;"><input type="text" spellcheck="false" class="form-control" readonly="true" value="{0}" ></div><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></td></tr>',this.tblAuthor.on("click",(function(t){var s=i.find(t.target);if(s.hasClass("close")&&!s.hasClass("disabled")){var n=s.closest("tr"),a=e.tblAuthor.find("tr").index(n);n.remove(),e.authors.splice(a,1),e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps),e.updateScroller(!0)}})),this.inputAuthor=new Common.UI.InputField({el:i.findById("#id-info-add-author"),style:"width: 200px;",validateOnBlur:!1,placeHolder:this.txtAddAuthor,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}).on("changed:after",(function(t,i,s,n){if(i!=s){var a=i.trim();if(a&&a!==s.trim()){var o=n&&n.relatedTarget&&"fminfo-btn-apply"==n.relatedTarget.id;a.split(/\s*[,;]\s*/).forEach((function(t){var i=t.trim();if(i&&(e.authors.push(t),!o)){var s=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(i)));e.trAuthor.before(s),e.updateScroller()}})),!o&&e.inputAuthor.setValue("")}e.coreProps.asc_putCreator(e.authors.join(";")),e.api.asc_setCoreProps(e.coreProps)}})).on("keydown:before",s),this.btnAddProperty=new Common.UI.Button({el:i.findById("#fminfo-btn-add-property")}),this.btnAddProperty.on("click",_.bind(this.onAddPropertyClick,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(i),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,alwaysVisibleY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateFileInfo(),this.scroller&&this.scroller.scrollTop(0),this.updateScroller()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateScroller:function(t){this.scroller&&this.scroller.update(t?{}:void 0)},updateInfo:function(t){if(this.doc=t,this.rendered){var e=!1;if((t=t||{}).info)t.info.folder&&this.lblPlacement.text(t.info.folder),e=this._ShowHideInfoItem(this.lblPlacement,void 0!==t.info.folder&&null!==t.info.folder)||e,(s=t.info.owner)&&this.lblOwner.text(s),e=this._ShowHideInfoItem(this.lblOwner,!!s)||e,(s=t.info.uploaded)&&this.lblUploaded.text(s),e=this._ShowHideInfoItem(this.lblUploaded,!!s)||e;else this._ShowHideDocInfo(!1);$("tr.divider.general",this.el)[e?"show":"hide"]();var i=this.api?this.api.asc_getAppProps():null;if(i&&(i=(i.asc_getApplication()||"")+(i.asc_getAppVersion()?" ":"")+(i.asc_getAppVersion()||""),this.lblApplication.text(i)),this._ShowHideInfoItem(this.lblApplication,!!i),this.coreProps=this.api?this.api.asc_getCoreProps():null,this.coreProps){var s=this.coreProps.asc_getCreated();this.lblDate.text(this.dateToString(s)),this._ShowHideInfoItem(this.lblDate,!!s)}}},updateFileInfo:function(){if(this.rendered){var t,e=this,i=this.api?this.api.asc_getCoreProps():null;if(this.coreProps=i,i){var s=!1;t=i.asc_getModified(),this.lblModifyDate.text(this.dateToString(t)),s=this._ShowHideInfoItem(this.lblModifyDate,!!t)||s,(t=i.asc_getLastModifiedBy())&&this.lblModifyBy.text(AscCommon.UserInfoParser.getParsedName(t)),s=this._ShowHideInfoItem(this.lblModifyBy,!!t)||s,$("tr.divider.modify",this.el)[s?"show":"hide"](),t=i.asc_getTitle(),this.inputTitle.setValue(t||""),t=i.asc_getKeywords(),this.inputTags.setValue(t||""),t=i.asc_getSubject(),this.inputSubject.setValue(t||""),t=i.asc_getDescription(),this.inputComment.setValue(t||""),this.inputAuthor.setValue(""),this.tblAuthor.find("tr:not(:last-of-type)").remove(),this.authors=[],(t=i.asc_getCreator())&&t.split(/\s*[,;]\s*/).forEach((function(t){var i=$(Common.Utils.String.format(e.authorTpl,Common.Utils.String.htmlEncode(t)));e.trAuthor.before(i),e.authors.push(t)})),this.tblAuthor.find(".close").toggleClass("hidden",!this.mode.isEdit),!this.mode.isEdit&&this._ShowHideInfoItem(this.tblAuthor,!!this.authors.length)}this.renderCustomProperties(),this.SetDisabled()}},_ShowHideInfoItem:function(t,e){return t.closest("tr")[e?"show":"hide"](),e},_ShowHideDocInfo:function(t){this._ShowHideInfoItem(this.lblPlacement,t),this._ShowHideInfoItem(this.lblOwner,t),this._ShowHideInfoItem(this.lblUploaded,t)},setMode:function(t){return this.mode=t,this.inputAuthor.setVisible(t.isEdit),this.btnAddProperty.setVisible(t.isEdit),this.tblAuthor.find(".close").toggleClass("hidden",!t.isEdit),t.isEdit||(this.inputTitle._input.attr("placeholder",""),this.inputTags._input.attr("placeholder",""),this.inputSubject._input.attr("placeholder",""),this.inputComment._input.attr("placeholder",""),this.inputAuthor._input.attr("placeholder","")),this.SetDisabled(),this},setApi:function(t){return this.api=t,this.api.asc_registerCallback("asc_onLockCore",_.bind(this.onLockCore,this)),this.updateInfo(this.doc),this},onLockCore:function(t){this._locked=t,this.updateFileInfo()},tplCustomProperty:function(t,e,i){return e===AscCommon.c_oVariantTypes.vtBool?i=i?this.txtYes:this.txtNo:e===AscCommon.c_oVariantTypes.vtFiletime&&(i=this.dateToString(new Date(i),!0)),'<tr data-custom-property><td class="left"><label>'+Common.Utils.String.htmlEncode(t)+'</label></td><td class="right"><div class="custom-property-wrapper"><input type="text" spellcheck="false" class="form-control" readonly style="width: 200px;" value="'+i+'"><div class="tool close img-colored" data-hint="2" data-hint-direction="right" data-hint-offset="small"></div></div></td></tr>'},dateToString:function(t,e){var i="";if(t){var s=(this.mode.lang||"en").replace("_","-").toLowerCase();try{s=="ar-SA".toLowerCase()&&(s+="-u-nu-latn-ca-gregory"),i=t.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(s,{timeStyle:"short"}))}catch(n){s="en",i=t.toLocaleString(s,{year:"numeric",month:"2-digit",day:"2-digit"})+(e?"":" "+t.toLocaleString(s,{timeStyle:"short"}))}}return i},renderCustomProperties:function(){if(this.api){$("tr[data-custom-property]").remove();var t=this.api.asc_getAllCustomProperties();_.each(t,_.bind((function(e,i){var s=this,n=e.asc_getName(),a=e.asc_getType(),o=e.asc_getValue(),l=$(this.tplCustomProperty(n,a,o));$("tbody.properties-tab").append(l),l.on("click",(function(e){if(!l.find("div.disabled").length){var r=l.find(e.target);r.hasClass("close")?(s.api.asc_removeCustomProperty(i),s.renderCustomProperties()):r.hasClass("form-control")&&new Common.Views.DocumentPropertyDialog({title:s.txtDocumentPropertyUpdateTitle,lang:s.mode.lang,defaultValue:{name:n,type:a,value:o},nameValidator:function(e){return e===n||!_.some(t,(function(t){return t.asc_getName()===e}))||s.txtPropertyTitleConflictError},handler:function(t,e,n,a){"ok"===t&&(s.api.asc_modifyCustomProperty(i,e,n,a),s.renderCustomProperties())}}).show()}}))}),this))}},setDisabledCustomProperties:function(t){_.each($("tr[data-custom-property]"),(function(e){$(e).find("div.custom-property-wrapper")[t?"addClass":"removeClass"]("disabled"),$(e).find("div.close")[t?"hide":"show"]()}))},onAddPropertyClick:function(){var t=this;new Common.Views.DocumentPropertyDialog({lang:t.mode.lang,nameValidator:function(e){var i=t.api.asc_getAllCustomProperties();return!_.some(i,(function(t){return t.asc_getName()===e}))||t.txtPropertyTitleConflictError},handler:function(e,i,s,n){"ok"===e&&(t.api.asc_addCustomProperty(i,s,n),t.renderCustomProperties())}}).show()},SetDisabled:function(){var t=!this.mode.isEdit||this._locked;this.inputTitle.setDisabled(t),this.inputTags.setDisabled(t),this.inputSubject.setDisabled(t),this.inputComment.setDisabled(t),this.inputAuthor.setDisabled(t),this.tblAuthor.find(".close").toggleClass("disabled",this._locked),this.tblAuthor.toggleClass("disabled",t),this.btnAddProperty.setDisabled(t),this.setDisabledCustomProperties(t)},txtPlacement:"Location",txtOwner:"Owner",txtUploaded:"Uploaded",txtAppName:"Application",txtTitle:"Title",txtTags:"Tags",txtSubject:"Subject",txtComment:"Comment",txtModifyDate:"Last Modified",txtModifyBy:"Last Modified By",txtCreated:"Created",txtAuthor:"Author",txtAddAuthor:"Add Author",txtAddText:"Add Text",txtMinutes:"min",okButtonText:"Apply",txtSpreadsheetInfo:"Spreadsheet Info",txtCommon:"Common",txtProperties:"Properties",txtDocumentPropertyUpdateTitle:"Document Property",txtAddProperty:"Add property",txtYes:"Yes",txtNo:"No",txtPropertyTitleConflictError:"Property with this title already exists"},SSE.Views.FileMenuPanels.DocumentInfo||{})),SSE.Views.FileMenuPanels.DocumentRights=Common.UI.BaseView.extend(_.extend({el:"#panel-rights",menu:void 0,initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.rendered=!1,this.template=_.template(['<div class="header">'+this.txtAccessRights+"</div>",'<table class="main">','<tr class="rights">','<td class="left" style="vertical-align: top;"><label>'+this.txtRights+"</label></td>",'<td class="right"><div id="id-info-rights"></div></td>',"</tr>",'<tr class="edit-rights">','<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary auto">'+this.txtBtnAccessRights+"</button></td>","</tr>","</table>"].join("")),this.templateRights=_.template(["<table>","<% _.each(users, function(item) { %>","<tr>",'<td><span class="userLink img-commonctrl <% if (item.isLink) { %>sharedLink<% } %>"></span><span><%= Common.Utils.String.htmlEncode(item.user) %></span></td>',"<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>","</tr>","<% }); %>","</table>"].join("")),this.menu=t.menu},render:function(t){var e=$(this.template());return this.cntRights=e.findById("#id-info-rights"),this.btnEditRights=new Common.UI.Button({el:e.findById("#id-info-btn-edit")}),this.btnEditRights.on("click",_.bind(this.changeAccessRights,this)),this.rendered=!0,this.updateInfo(this.doc),this.$el=$(t).html(e),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),Common.NotificationCenter.on("collaboration:sharingupdate",this.updateSharingSettings.bind(this)),Common.NotificationCenter.on("collaboration:sharingdeny",this.onLostEditRights.bind(this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.scroller&&this.scroller.update()},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments)},updateInfo:function(t){this.doc=t,this.rendered&&((t=t||{}).info?(t.info.sharingSettings&&this.cntRights.html(this.templateRights({users:t.info.sharingSettings})),this._ShowHideInfoItem("rights",void 0!==t.info.sharingSettings&&null!==t.info.sharingSettings&&t.info.sharingSettings.length>0),this._ShowHideInfoItem("edit-rights",(!!this.sharingSettingsUrl&&this.sharingSettingsUrl.length||this.mode.canRequestSharingSettings)&&!0!==this._readonlyRights)):this._ShowHideDocInfo(!1))},_ShowHideInfoItem:function(t,e){$("tr."+t,this.el)[e?"show":"hide"]()},_ShowHideDocInfo:function(t){this._ShowHideInfoItem("rights",t),this._ShowHideInfoItem("edit-rights",t)},setMode:function(t){return this.mode=t,this.sharingSettingsUrl=t.sharingSettingsUrl,this},changeAccessRights:function(t,e,i){Common.NotificationCenter.trigger("collaboration:sharing")},updateSharingSettings:function(t){this._ShowHideInfoItem("rights",void 0!==this.doc.info.sharingSettings&&null!==this.doc.info.sharingSettings&&this.doc.info.sharingSettings.length>0),this.cntRights.html(this.templateRights({users:this.doc.info.sharingSettings}))},onLostEditRights:function(){this._readonlyRights=!0,this.rendered&&this._ShowHideInfoItem("edit-rights",!1)},txtRights:"Persons who have rights",txtBtnAccessRights:"Change access rights",txtAccessRights:"Access Rights"},SSE.Views.FileMenuPanels.DocumentRights||{})),SSE.Views.FileMenuPanels.Help=Common.UI.BaseView.extend({el:"#panel-help",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-help-contents" style="position: absolute; width:220px; top: 0; bottom: 0;" class="no-padding"></div>','<div id="id-help-frame" class="no-padding"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this.urlPref="resources/help/en/",this.openUrl=null,this.en_data=[{src:"ProgramInterface/ProgramInterface.htm",name:"Introducing Spreadsheet Editor user interface",headername:"Program Interface"},{src:"ProgramInterface/FileTab.htm",name:"File tab"},{src:"ProgramInterface/HomeTab.htm",name:"Home Tab"},{src:"ProgramInterface/InsertTab.htm",name:"Insert tab"},{src:"ProgramInterface/PluginsTab.htm",name:"Plugins tab"},{src:"UsageInstructions/OpenCreateNew.htm",name:"Create a new spreadsheet or open an existing one",headername:"Basic operations"},{src:"UsageInstructions/CopyPasteData.htm",name:"Cut/copy/paste data"},{src:"UsageInstructions/UndoRedo.htm",name:"Undo/redo your actions"},{src:"UsageInstructions/ManageSheets.htm",name:"Manage sheets",headername:"Operations with sheets"},{src:"UsageInstructions/FontTypeSizeStyle.htm",name:"Set font type, size, style, and colors",headername:"Cell text formatting"},{src:"UsageInstructions/AddHyperlinks.htm",name:"Add hyperlinks"},{src:"UsageInstructions/ClearFormatting.htm",name:"Clear text, format in a cell, copy cell format"},{src:"UsageInstructions/AddBorders.htm",name:"Add borders",headername:"Editing cell properties"},{src:"UsageInstructions/AlignText.htm",name:"Align data in cells"},{src:"UsageInstructions/MergeCells.htm",name:"Merge cells"},{src:"UsageInstructions/ChangeNumberFormat.htm",name:"Change number format"},{src:"UsageInstructions/InsertDeleteCells.htm",name:"Manage cells, rows, and columns",headername:"Editing rows/columns"},{src:"UsageInstructions/SortData.htm",name:"Sort and filter data"},{src:"UsageInstructions/InsertFunction.htm",name:"Insert function",headername:"Work with functions"},{src:"UsageInstructions/UseNamedRanges.htm",name:"Use named ranges"},{src:"UsageInstructions/InsertImages.htm",name:"Insert images",headername:"Operations on objects"},{src:"UsageInstructions/InsertChart.htm",name:"Insert chart"},{src:"UsageInstructions/InsertAutoshapes.htm",name:"Insert and format autoshapes"},{src:"UsageInstructions/InsertTextObjects.htm",name:"Insert text objects"},{src:"UsageInstructions/ManipulateObjects.htm",name:"Manipulate objects"},{src:"UsageInstructions/InsertEquation.htm",name:"Insert equations",headername:"Math equations"},{src:"HelpfulHints/CollaborativeEditing.htm",name:"Collaborative spreadsheet editing",headername:"Spreadsheet co-editing"},{src:"UsageInstructions/ViewDocInfo.htm",name:"View file information",headername:"Tools and settings"},{src:"UsageInstructions/SavePrintDownload.htm",name:"Save/print/download your spreadsheet"},{src:"HelpfulHints/AdvancedSettings.htm",name:"Advanced settings of Spreadsheet Editor"},{src:"HelpfulHints/Navigation.htm",name:"View settings and navigation tools"},{src:"HelpfulHints/Search.htm",name:"Search and replace functions"},{src:"HelpfulHints/About.htm",name:"About Spreadsheet Editor",headername:"Helpful hints"},{src:"HelpfulHints/SupportedFormats.htm",name:"Supported formats of spreadsheets"},{src:"HelpfulHints/KeyboardShortcuts.htm",name:"Keyboard shortcuts"}],Common.Utils.isIE&&(window.onhelp=function(){return!1})},render:function(){var t=this;return this.$el.html(this.template()),this.viewHelpPicker=new Common.UI.DataView({el:$("#id-help-contents"),store:new Common.UI.DataViewStore([]),keyMoveDirection:"vertical",itemTemplate:_.template(['<div id="<%= id %>" class="help-item-wrap">','<div class="caption"><%= name %></div>',"</div>"].join(""))}),this.viewHelpPicker.on("item:add",(function(t,e,i){i.has("headername")&&$(e.el).before('<div class="header-name">'+i.get("headername")+"</div>")})),this.viewHelpPicker.on("item:select",(function(e,i,s){t.onSelectItem(s.get("src"))})),this.iFrame=document.createElement("iframe"),this.iFrame.src="",this.iFrame.align="top",this.iFrame.frameBorder="0",this.iFrame.width="100%",this.iFrame.height="100%",(Common.Utils.isChrome||Common.Utils.isOpera||Common.Utils.isGecko&&Common.Utils.firefoxVersion>86)&&(this.iFrame.onload=function(){try{t.findUrl(t.iFrame.contentWindow.location.href)}catch(t){}}),Common.Gateway.on("internalcommand",(function(e){"help:hyperlink"==e.type&&t.findUrl(e.data)})),$("#id-help-frame").append(this.iFrame),this},setLangConfig:function(t){var e=this,i=this.viewHelpPicker.store;if(t){t=t.split(/[\-\_]/)[0];var s={dataType:"json",error:function(){e.urlPref.indexOf("resources/help/en/")<0?(e.urlPref="resources/help/en/",i.url="resources/help/en/Contents.json",i.fetch(s)):(e.urlPref="resources/help/en/",i.reset(e.en_data))},success:function(){var t=e.openUrl?i.find((function(t){return e.openUrl.indexOf(t.get("src"))>=0})):i.at(0);t&&(e.viewHelpPicker.selectRecord(t,!0),e.viewHelpPicker.scrollToRecord(t)),e.onSelectItem(e.openUrl?e.openUrl:t.get("src"))}};Common.Controllers.Desktop.isActive()?Common.Controllers.Desktop.isHelpAvailable()?(e.urlPref=Common.Controllers.Desktop.helpUrl()+"/",i.url=e.urlPref+"Contents.json",i.fetch(s)):(e.noHelpContents=!0,e.iFrame.src="../../common/main/resources/help/download.html"):(i.url="resources/help/"+t+"/Contents.json",i.fetch(s),this.urlPref="resources/help/"+t+"/")}},show:function(t){Common.UI.BaseView.prototype.show.call(this),this._scrollerInited||(this.viewHelpPicker.scroller.update(),this._scrollerInited=!0),t&&(this.viewHelpPicker.store.length>0?(this.findUrl(t),this.onSelectItem(t)):this.openUrl=t)},onSelectItem:function(t){this.iFrame.src=this.urlPref+t},findUrl:function(t){var e=this.viewHelpPicker.store.find((function(e){return t.indexOf(e.get("src"))>=0}));e&&(this.viewHelpPicker.selectRecord(e,!0),this.viewHelpPicker.scrollToRecord(e))}}),SSE.Views.FileMenuPanels.ProtectDoc=Common.UI.BaseView.extend(_.extend({el:"#panel-protect",menu:void 0,template:_.template(['<label id="id-fms-lbl-protect-header"><%= scope.strProtect %></label>','<div id="id-fms-password">','<label class="header"><%= scope.strEncrypt %></label>','<div class="encrypt-block">','<div class="description"><%= scope.txtProtectSpreadsheet %></div>','<div id="fms-btn-add-pwd"></div>',"</div>",'<div class="encrypted-block">','<div class="description"><%= scope.txtEncrypted %></div>','<div class="buttons">','<div id="fms-btn-change-pwd"></div>','<div id="fms-btn-delete-pwd" class="margin-left-16"></div>',"</div>","</div>","</div>",'<div id="id-fms-signature">','<label class="header"><%= scope.strSignature %></label>','<div class="add-signature-block">','<div class="description"><%= scope.txtAddSignature %></div>','<div id="fms-btn-invisible-sign"></div>',"</div>",'<div class="added-signature-block">','<div class="description"><%= scope.txtAddedSignature %></div>',"</div>",'<div id="id-fms-signature-view"></div>',"</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu;this.templateSignature=_.template(['<div class="<% if (!hasRequested && !hasSigned) { %>hidden<% } %>"">','<div class="signature-tip"><%= tipText %></div>','<div class="buttons">','<label class="link signature-view-link margin-right-20" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtView+"</label>",'<label class="link signature-edit-link <% if (!hasSigned) { %>hidden<% } %>" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium">'+this.txtEdit+"</label>","</div>","</div>"].join(""))},render:function(){this.$el.html(this.template({scope:this}));var t=SSE.getController("Common.Controllers.Protection").getView();return this.btnAddPwd=t.getButton("add-password"),this.btnAddPwd.render(this.$el.find("#fms-btn-add-pwd")),this.btnAddPwd.on("click",_.bind(this.closeMenu,this)),this.btnChangePwd=t.getButton("change-password"),this.btnChangePwd.render(this.$el.find("#fms-btn-change-pwd")),this.btnChangePwd.on("click",_.bind(this.closeMenu,this)),this.btnDeletePwd=t.getButton("del-password"),this.btnDeletePwd.render(this.$el.find("#fms-btn-delete-pwd")),this.btnDeletePwd.on("click",_.bind(this.closeMenu,this)),this.cntPassword=$("#id-fms-password"),this.cntEncryptBlock=this.$el.find(".encrypt-block"),this.cntEncryptedBlock=this.$el.find(".encrypted-block"),this.btnAddInvisibleSign=t.getButton("signature"),this.btnAddInvisibleSign.render(this.$el.find("#fms-btn-invisible-sign")),this.btnAddInvisibleSign.on("click",_.bind(this.closeMenu,this)),this.cntSignature=$("#id-fms-signature"),this.cntSignatureView=$("#id-fms-signature-view"),this.cntAddSignature=this.$el.find(".add-signature-block"),this.cntAddedSignature=this.$el.find(".added-signature-block"),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el,suppressScrollX:!0,alwaysVisibleY:!0})),this.$el.on("click",".signature-edit-link",_.bind(this.onEdit,this)),this.$el.on("click",".signature-view-link",_.bind(this.onView,this)),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.updateSignatures(),this.updateEncrypt(),this.scroller&&this.scroller.update()},setMode:function(t){this.mode=t,this.cntSignature.toggleClass("hidden",!this.mode.isSignatureSupport),this.cntPassword.toggleClass("hidden",!this.mode.isPasswordSupport)},setApi:function(t){return this.api=t,this},closeMenu:function(){this.menu&&this.menu.hide()},onEdit:function(){this.menu&&this.menu.hide();var t=this;Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.txtEditWarning,buttons:["ok","cancel"],primary:"ok",callback:function(e){"ok"==e&&t.api.asc_RemoveAllSignatures()}})},onView:function(){this.menu&&this.menu.hide(),SSE.getController("RightMenu").rightmenu.SetActivePane(Common.Utils.documentSettingsType.Signature,!0)},updateSignatures:function(){var t=this.api.asc_getRequestSignatures(),e=this.api.asc_getSignatures(),i=t&&t.length>0,s=!1,n=!1;_.each(e,(function(t,e){0==t.asc_getValid()?s=!0:n=!0}));var a=n?this.txtSignedInvalid:s?this.txtSigned:"";i&&(a=this.txtRequestedSignatures+(""!=a?"<br><br>":"")+a),this.cntSignatureView.html(this.templateSignature({tipText:a,hasSigned:s||n,hasRequested:i}));var o=this.btnAddInvisibleSign.$el.find("button").hasClass("hidden");this.cntAddSignature.toggleClass("hidden",o),this.cntAddedSignature.toggleClass("hidden",!o)},updateEncrypt:function(){var t=this.btnAddPwd.$el.find("button").hasClass("hidden");this.cntEncryptBlock.toggleClass("hidden",t),this.cntEncryptedBlock.toggleClass("hidden",!t)},strProtect:"Protect Workbook",strSignature:"With Signature",txtView:"View signatures",txtEdit:"Edit workbook",txtSigned:"Valid signatures has been added to the workbook. The workbook is protected from editing.",txtSignedInvalid:"Some of the digital signatures in workbook are invalid or could not be verified. The workbook is protected from editing.",txtRequestedSignatures:"This workbook needs to be signed.",notcriticalErrorTitle:"Warning",txtEditWarning:"Editing will remove the signatures from the workbook.<br>Are you sure you want to continue?",strEncrypt:"With Password",txtProtectSpreadsheet:"Encrypt this spreadsheet with a password",txtEncrypted:"A password is required to open this spreadsheet",txtAddSignature:"Ensure the integrity of the spreadsheet by adding an<br>invisible digital signature",txtAddedSignature:"Valid signatures have been added to the spreadsheet.<br>The spreadsheet is protected from editing."},SSE.Views.FileMenuPanels.ProtectDoc||{})),SSE.Views.PrintWithPreview=Common.UI.BaseView.extend(_.extend({el:"#panel-print",menu:void 0,template:_.template(['<div style="width:100%; height:100%; position: relative;">','<div id="id-print-settings" class="no-padding">','<div class="print-settings">','<div class="flex-settings ps-container oo settings-container">','<div class="main-header"><%= scope.txtPrint %></div>','<table style="width: 100%;">',"<tbody>",'<tr class="hidden-for-webapp"><td><label class="font-weight-bold"><%= scope.txtPrinter %></label></td></tr>','<tr class="hidden-for-webapp"><td class="padding-large"><div id="print-combo-printer" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPrintRange %></label></td></tr>','<tr><td class="padding-small"><div id="print-combo-range" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large"><div id="print-chb-ignore" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<div class="pages">',"<label><%= scope.txtPages %></label>",'<div id="print-spin-pages-from"></div>',"<label><%= scope.txtTo %></label>",'<div id="print-spin-pages-to"></div>',"</div>","</td></tr>",'<tr class="desktop-settings"><td class="padding-large">','<div class="pages">',"<label><%= scope.txtCopies %>:</label>",'<div id="print-txt-copies"></div>',"</div>","</td></tr>",'<tr class="desktop-settings"><td><label class="font-weight-bold"><%= scope.txtPrintSides %></label></td></tr>','<tr class="desktop-settings"><td class="padding-large"><div id="print-combo-sides" style="width: 248px;"></div></td></tr>','<tr class="desktop-settings"><td class="padding-large"><div class="separator horizontal" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtSettingsOfSheet %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-sheets" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageSize %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-pages" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtPageOrientation %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-orient" style="width: 134px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtMargins %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-margins" style="width: 248px;"></div></td></tr>','<tr><td><label class="font-weight-bold"><%= scope.txtScaling %></label></td></tr>','<tr><td class="padding-large"><div id="print-combo-layout" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large">','<table class="print-titles-container"><tbody>','<tr class="print-titles-header"><td>','<span class="print-titles-caret img-commonctrl"></span>','<label class="font-weight-bold"><%= scope.txtPrintTitles %></label>',"</td></tr>",'<tr class="print-titles-options"><td><label><%= scope.txtRepeatRowsAtTop %></label></td></tr>','<tr class="print-titles-options"><td class="padding-small">',"<table><tbody><tr>",'<td><div id="print-txt-top" style="width: 145px;"></div></td>','<td><div id="print-presets-top" style="width: 95px;"></div></td>',"</tr></tbody></table>","</td></tr>",'<tr class="print-titles-options"><td><label><%= scope.txtRepeatColumnsAtLeft %></label></td></tr>','<tr class="print-titles-options"><td>',"<table><tbody><tr>",'<td><div id="print-txt-left" style="width: 145px;"></div></td>','<td><div id="print-presets-left" style="width: 95px;"></div></td>',"</tr></tbody></table>","</td></tr>","</tbody></table>","</td></tr>",'<tr><td class="padding-small"><label class="font-weight-bold"><%= scope.txtGridlinesAndHeadings %></label></td></tr>','<tr><td class="padding-small"><div id="print-chb-grid" style="width: 248px;"></div></td></tr>','<tr><td class="padding-large"><div id="print-chb-rows" style="width: 248px;"></div></td></tr>','<tr class="header-settings"><td class="padding-large"><label class="link" id="print-header-footer-settings" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtHeaderFooterSettings %></label></td></tr>','<tr><td class="padding-large first-page">',"<label><%= scope.txtFirstPageNumber %></label>",'<div id="print-spin-first-page"></div>',"</td></tr>",'<tr class="header-settings hidden-for-webapp"><td class="padding-large"><label class="link" id="print-btn-system-dialog" data-hint="2" data-hint-direction="bottom" data-hint-offset="medium"><%= scope.txtPrintUsingSystemDialog %></label></td></tr>','<tr class="fms-btn-apply"><td>','<div class="footer justify">','<button id="print-btn-print-0" class="btn normal dlg-btn primary" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-save-0" class="btn normal dlg-btn" result="save" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button>',"</div>","</td></tr>","</tbody>","</table>","</div>",'<div class="fms-flex-apply hidden">','<div class="footer justify">','<button id="print-btn-print-1" class="btn normal dlg-btn primary" result="print" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button>','<button id="print-btn-save-1" class="btn normal dlg-btn" result="save" style="width: 96px;" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button>',"</div>","</div>","</div>","</div>",'<div id="print-preview-box" class="no-padding">','<div id="print-preview-wrapper">','<div id="print-preview"></div>',"</div>",'<div id="print-navigation">',"<% if (!isRTL) { %>",'<div id="print-prev-page"></div>','<div id="print-next-page"></div>',"<% } else { %>",'<div id="print-next-page"></div>','<div id="print-prev-page"></div>',"<% } %>",'<div class="page-number margin-left-10">',"<label><%= scope.txtPage %></label>",'<div id="print-number-page" class="margin-left-4"></div>','<label id="print-count-page" class="margin-left-4"><%= scope.txtOf %></label>',"</div>",'<label id="print-active-sheet"><%= scope.txtSheet %></label>','<div id="print-zoom-to-page"></div>',"</div>","</div>",'<div id="print-preview-empty" class="hidden">',"<div><%= scope.txtEmptyTable %></div>","</div>","</div>"].join("")),initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,arguments),this.menu=t.menu,this._defaultPaperSizeList=[{value:"215.9|279.4",displayValue:["US Letter","21,59","27,94","cm"],caption:"US Letter",size:[215.9,279.4]},{value:"215.9|355.6",displayValue:["US Legal","21,59","35,56","cm"],caption:"US Legal",size:[215.9,355.6]},{value:"210|297",displayValue:["A4","21","29,7","cm"],caption:"A4",size:[210,297]},{value:"148|210",displayValue:["A5","14,8","21","cm"],caption:"A5",size:[148,210]},{value:"176|250",displayValue:["B5","17,6","25","cm"],caption:"B5",size:[176,250]},{value:"104.8|241.3",displayValue:["Envelope #10","10,48","24,13","cm"],caption:"Envelope #10",size:[104.8,241.3]},{value:"110|220",displayValue:["Envelope DL","11","22","cm"],caption:"Envelope DL",size:[110,220]},{value:"279.4|431.8",displayValue:["Tabloid","27,94","43,18","cm"],caption:"Tabloid",size:[279.4,431.8]},{value:"297|420",displayValue:["A3","29,7","42","cm"],caption:"A3",size:[297,420]},{value:"296.9|457.2",displayValue:["Tabloid Oversize","29,69","45,72","cm"],caption:"Tabloid Oversize",size:[296.9,457.2]},{value:"196.8|273",displayValue:["ROC 16K","19,68","27,3","cm"],caption:"ROC 16K",size:[196.8,273]},{value:"120|235",displayValue:["Envelope Choukei 3","12","23,5","cm"],caption:"Envelope Choukei 3",size:[120,235]},{value:"305|487",displayValue:["Super B/A3","30,5","48,7","cm"],caption:"Super B/A3",size:[305,487]}],this._initSettings=!0,this._originalPageSize=void 0,this.extendedPrintTitles=Common.localStorage.getBool("sse-print-titles-extended",!0)},render:function(t){var e=this,i=$(this.template({scope:this,isRTL:Common.UI.isRTL()}));this.mode.isDesktopApp&&(this.cmbPrinter=new Common.UI.ComboBox({el:i.findById("#print-combo-printer"),menuStyle:"width: 248px; max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",placeHolder:this.txtPrinterNotSelected,itemsTemplate:_.template(["<% if (items.length > 0) { %>","<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem" <% if (typeof(item.checked) !== "undefined" && item.checked) { %> class="checked" <% } %> ><%= scope.getDisplayValue(item) %></a></li>',"<% }); %>","<% } else { %>",'<li><a style="background:none; cursor: default;" onclick="event.stopPropagation();">'+this.txtPrintersNotFound+"</a></li>","<% } %>"].join("")),data:[],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbPrinter.on("selected",_.bind(this.onPrinterSelected,this))),this.cmbRange=new Common.UI.ComboBox({el:i.findById("#print-combo-range"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPrintType.ActiveSheets,displayValue:this.txtActiveSheets},{value:Asc.c_oAscPrintType.EntireWorkbook,displayValue:this.txtAllSheets},{value:Asc.c_oAscPrintType.Selection,displayValue:this.txtSelection}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.chIgnorePrintArea=new Common.UI.CheckBox({el:i.findById("#print-chb-ignore"),labelText:this.txtIgnore,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnPagesFrom=new Common.UI.MetricSpinner({el:i.findById("#print-spin-pages-from"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,allowBlank:!0,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnPagesTo=new Common.UI.MetricSpinner({el:i.findById("#print-spin-pages-to"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,allowBlank:!0,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.spnCopies=new Common.UI.MetricSpinner({el:i.findById("#print-txt-copies"),step:1,width:60,defaultUnit:"",value:1,maxValue:32767,minValue:1,allowDecimal:!1,maskExp:/[0-9]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides=new Common.UI.ComboBox({el:i.findById("#print-combo-sides"),menuStyle:"width:100%;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc},{value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label class="font-weight-bold"><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= item.descValue %></label></a></li>',"<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbSides.setValue("one"),this.cmbSheet=new Common.UI.ComboBox({el:i.findById("#print-combo-sheets"),menuStyle:"min-width: 248px;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var s=Common.UI.isRTL()?_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem" dir="ltr">','(<span dir="rtl"><%= item.displayValue[2] %> <%= item.displayValue[3] %></span>',"<span> x </span>",'<span dir="rtl"><%= item.displayValue[1] %> <%= item.displayValue[3] %></span>)',"<span> <%= item.displayValue[0] %></span>","</a></li>","<% }); %>"].join("")):_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<%= item.displayValue[0] %>"," (<%= item.displayValue[1] %> <%= item.displayValue[3] %> x"," <%= item.displayValue[2] %> <%= item.displayValue[3] %>)","</a></li>","<% }); %>"].join("")),n=_.template(['<div class="input-group combobox input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">','<div class="form-control" style="padding-top:3px; line-height: 14px; cursor: pointer; width: 248px; <%= style %>"',Common.UI.isRTL()?'dir="rtl"':"","></div>",'<div style="display: table-cell;"></div>','<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>','<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">'].concat(s).concat(["</ul>","</div>"]).join(""));this.cmbPaperSize=new Common.UI.ComboBoxCustom({el:i.findById("#print-combo-pages"),menuStyle:"max-height: 280px; width: 248px;",editable:!1,takeFocusOnClose:!0,template:n,itemsTemplate:s,data:[].concat(this._defaultPaperSizeList),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big",updateFormControl:function(t,e){var i=$(this.el).find(".form-control");if(t||e){var s=e||t.get("displayValue");"string"==typeof s?i[0].innerHTML=s:Common.UI.isRTL()?i[0].innerHTML='<span dir="ltr">(<span dir="rtl">'+s[2]+" "+s[3]+'</span><span> x </span><span dir="rtl">'+s[1]+" "+s[3]+"</span>)<span> "+s[0]+"</span></span>":i[0].innerHTML=s[0]+" ("+s[1]+" "+s[3]+" x "+s[2]+" "+s[3]+")"}else i[0].innerHTML=""}}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:i.findById("#print-combo-orient"),menuStyle:"min-width: 134px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.txtPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.txtLandscape}],dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"});var a=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "customoptions") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem">',"<%= scope.getDisplayValue(item) %>","</a></li>","<% }); %>"].join(""));if(this.cmbLayout=new Common.UI.ComboBox({el:i.findById("#print-combo-layout"),menuStyle:"min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:"customoptions",displayValue:this.txtCustomOptions}],itemsTemplate:a,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtRangeTop=new Common.UI.InputField({el:i.findById("#print-txt-top"),allowBlank:!0,validateOnChange:!0,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnPresetsTop=new Common.UI.Button({parentEl:i.findById("#print-presets-top"),cls:"btn-text-menu-default",caption:this.txtRepeat,style:"width: 95px;",menu:!0,takeFocusOnClose:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.txtRangeLeft=new Common.UI.InputField({el:i.findById("#print-txt-left"),allowBlank:!0,validateOnChange:!0,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.btnPresetsLeft=new Common.UI.Button({parentEl:i.findById("#print-presets-left"),cls:"btn-text-menu-default",caption:this.txtRepeat,style:"width: 95px;",menu:!0,takeFocusOnClose:!0,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.$printTitlesHeader=i.find(".print-titles-header"),this.$printTitlesHeader.on("click",_.bind(this.expandPrintTitles,this)),this.$printTitlesBlock=i.find(".print-titles-container"),this.extendedPrintTitles||this.$printTitlesBlock.addClass("no-expand"),this.cmbPaperMargins=new Common.UI.ComboBox({el:i.findById("#print-combo-margins"),menuStyle:"max-height: 280px; min-width: 248px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.txtMarginsNormal,size:[19.1,17.8,19.1,17.8]},{value:1,displayValue:this.txtMarginsNarrow,size:[19.1,6.4,19.1,6.4]},{value:2,displayValue:this.txtMarginsWide,size:[25.4,25.4,25.4,25.4]},{value:-1,displayValue:this.txtCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div style="display: inline-block;margin-right: 20px;min-width: 80px;"><label style="display: block;">'+this.txtTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.txtBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.txtRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join("")),dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.chPrintGrid=new Common.UI.CheckBox({el:i.findById("#print-chb-grid"),labelText:this.txtPrintGrid,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.chPrintRows=new Common.UI.CheckBox({el:i.findById("#print-chb-rows"),labelText:this.txtPrintHeadings,dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.spnFirstPage=new Common.UI.MetricSpinner({el:i.findById("#print-spin-first-page"),step:1,width:60,defaultUnit:"",value:"1",maxValue:32767,minValue:-32767,allowDecimal:!1,maskExp:/[0-9,\-]/,dataHint:"2",dataHintDirection:"bottom",dataHintOffset:"big"}),this.pnlSettings=i.find(".flex-settings").addBack().filter(".flex-settings"),this.pnlApply=i.find(".fms-flex-apply").addBack().filter(".fms-flex-apply"),this.pnlTable=$(this.pnlSettings.find("table")[0]),this.trApply=i.find(".fms-btn-apply"),this.btnPrintSystemDialog=i.findById("#print-btn-system-dialog"),this.btnsSave=[],this.btnsPrint=[],this.mode.isDesktopApp){this.btnsPrintPDF=[];for(var o=0;o<2;o++){var l=["<table>","<tr>",'<td><button id="print-btn-print-<%= index %>" class="btn normal dlg-btn primary auto" result="print" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrint %></button></td>','<td><button id="print-btn-print-pdf-<%= index %>" class="btn normal dlg-btn auto" result="save-pdf" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtPrintToPDF %></button></td>','<td><button id="print-btn-save-<%= index %>" class="btn normal dlg-btn auto" result="save" data-hint="2" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtSave %></button></td>',"</tr>","</table>"].join(""),r=_.template(l)({scope:this,index:o});$(i.find(".footer")[o]).html(r),this.btnsPrintPDF.push(new Common.UI.Button({el:i.findById("#print-btn-print-pdf-"+o)}))}i.find(".footer").addClass("footer-with-pdf")}for(o=0;o<2;o++)this.btnsSave.push(new Common.UI.Button({el:i.findById("#print-btn-save-"+o)})),this.btnsPrint.push(new Common.UI.Button({el:i.findById("#print-btn-print-"+o),disabled:this.mode.isDesktopApp}));return i.find(".hidden-for-webapp").toggleClass("hidden",!this.mode.isDesktopApp),this.btnPrevPage=new Common.UI.Button({parentEl:i.findById("#print-prev-page"),cls:"btn-prev-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnNextPage=new Common.UI.Button({parentEl:i.findById("#print-next-page"),cls:"btn-next-page",iconCls:"arrow",scaling:!1,dataHint:"2",dataHintDirection:"top"}),this.btnZoomToPage=new Common.UI.Button({parentEl:i.findById("#print-zoom-to-page"),cls:"btn-zoom-to-page btn-toolbar",iconCls:"toolbar__icon btn-ic-zoomtopage",dataHint:"2",dataHintDirection:"top",enableToggle:!0,pressed:!0}),this.countOfPages=i.findById("#print-count-page"),this.txtNumberPage=new Common.UI.InputField({el:i.findById("#print-number-page"),allowBlank:!0,validateOnChange:!0,style:"width: 50px;",maskExp:/[0-9]/,validation:function(t){return!!(/(^[0-9]+$)/.test(t)&&void 0!==(t=parseInt(t))&&t>0&&t<=e.pageCount)||e.txtPageNumInvalid},dataHint:"2",dataHintDirection:"left",dataHintOffset:"small"}),this.txtActiveSheet=i.findById("#print-active-sheet"),this.$el=$(t).html(i),this.$el.on("click","#print-header-footer-settings",_.bind(this.openHeaderSettings,this)),this.$previewBox=$("#print-preview-box"),this.$previewEmpty=$("#print-preview-empty"),this.applyMode(),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.pnlSettings,suppressScrollX:!0,alwaysVisibleY:!0})),_.isUndefined(this.printScroller)&&(this.printScroller=new Common.UI.Scroller({el:$("#print-preview-wrapper"),alwaysVisibleX:!0,alwaysVisibleY:!0,suppressScrollX:!0,suppressScrollY:!0})),Common.NotificationCenter.on({"window:resize":function(){e.isVisible()&&e.updateScroller()}}),this.updateMetricUnit(),this.fireEvent("render:after",this),this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this._initSettings&&(this.updateMetricUnit(),this._initSettings=!1),this.updateScroller(),this.fireEvent("show",this)},updateCmbPrinter:function(t,e){var i;e=e||[],t&&!_.some(e,(function(e){return e.name==t}))&&e.push({name:t,duplex_supported:!0,paperSupported:this._defaultPaperSizeList}),i=e.map((function(t){return{value:t.name,displayValue:t.name,paperSupported:t.paper_supported,isDuplexSupported:t.duplex_supported}})),this.cmbPrinter.setData(i),this.cmbPrinter.setValue(t),this.cmbPrinter.trigger("selected",this,this.cmbPrinter.getSelectedRecord())},setCmbSidesOptions:function(t){var e=this.cmbSides.getValue(),i=[{value:"one",displayValue:this.txtOneSide,descValue:this.txtOneSideDesc}];t?i.push({value:"both-long",displayValue:this.txtBothSides,descValue:this.txtBothSidesLongDesc},{value:"both-short",displayValue:this.txtBothSides,descValue:this.txtBothSidesShortDesc}):"one"!=e&&(e="one"),this.cmbSides.setData(i),this.cmbSides.setValue(e)},setCmbPaperSizeOptions:function(t){var e=[];e=t&&t.length>0?t.map((function(t,e){return{value:e,displayValue:[t.name,t.width/10,t.height/10,"cm"],caption:t.name,size:[t.width,t.height]}})):[].concat(this._defaultPaperSizeList);var i=this.cmbPaperSize.store.findWhere({value:this.cmbPaperSize.getValue()}),s=null;function n(t,e,i){return _.find(t,(function(t){return Math.abs(t.size[0]-e)<.1&&Math.abs(t.size[1]-i)<.1}))}if(i&&(s=n(e,Math.round(i.get("size")[0]),Math.round(i.get("size")[1]))),!s)if(i)s={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[0]).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(i.get("size")[1]).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]};else{var a=this._originalPageSize?this._originalPageSize.w:210,o=this._originalPageSize?this._originalPageSize.h:297;s||(s=n(e,a,o)),s||(s={custom:!0,value:[this.txtCustom,parseFloat(Common.Utils.Metric.fnRecalcFromMM(a).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(o).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()]}),!s&&e[0]&&(s=e[0])}this.cmbPaperSize.setData(e),this.updatePaperSizeMetricUnit(),s?s.custom?this.cmbPaperSize.setValue(void 0,s.value):this.cmbPaperSize.setValue(s.value):this.cmbPaperSize.setValue(null)},updateScroller:function(){if(this.scroller){Common.UI.Menu.Manager.hideAll();var t=this.$el.height()<this.pnlTable.height()+25+this.pnlApply.height()+this.$el.find(".main-header").outerHeight(!0);this.pnlApply.toggleClass("hidden",!t),this.trApply.toggleClass("hidden",t),this.pnlSettings.css("overflow",t?"hidden":"visible"),this.scroller.update(),this.pnlSettings.toggleClass("bordered",this.scroller.isVisible())}this.printScroller&&this.printScroller.update()},setMode:function(t){this.mode=t,!this._initSettings&&this.applyMode()},applyMode:function(){this.mode&&this.$el&&(this.$el.find(".header-settings")[this.mode.isEdit?"show":"hide"](),!this.mode.isDesktopApp&&this.$el.find(".desktop-settings").hide())},setApi:function(t){},onPrinterSelected:function(t,e){this.setCmbSidesOptions(!e||e.isDuplexSupported),this.setCmbPaperSizeOptions(e?e.paperSupported:null),this.btnsPrint.forEach((function(t){t.setDisabled(!e)}))},updateMetricUnit:function(){this.updatePaperSizeMetricUnit(),this.cmbPaperMargins.onResetItems()},updatePaperSizeMetricUnit:function(){if(this.cmbPaperSize){for(var t=this.cmbPaperSize.store,e=0;e<t.length;e++){var i=t.at(e),s=i.get("size"),n=s[0],a=s[1];i.set("displayValue",[i.get("caption"),parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2)),parseFloat(Common.Utils.Metric.fnRecalcFromMM(a).toFixed(2)),Common.Utils.Metric.getCurrentMetricName()])}this.cmbPaperSize.onResetItems()}},addCustomScale:function(t){t?this.cmbLayout.setData([{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:4,displayValue:this.txtCustom},{value:"customoptions",displayValue:this.txtCustomOptions}]):this.cmbLayout.setData([{value:0,displayValue:this.txtActualSize},{value:1,displayValue:this.txtFitPage},{value:2,displayValue:this.txtFitCols},{value:3,displayValue:this.txtFitRows},{value:"customoptions",displayValue:this.txtCustomOptions}])},applySettings:function(){this.menu&&this.menu.hide()},isVisible:function(){return(this.$el||$(this.el)).is(":visible")},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},setIgnorePrintArea:function(t){this.chIgnorePrintArea.setValue(t)},getIgnorePrintArea:function(){return"checked"==this.chIgnorePrintArea.getValue()},getPagesFrom:function(){return this.spnPagesFrom.getNumberValue()},getPagesTo:function(){return this.spnPagesTo.getNumberValue()},comboRangeChange:function(t,e){this.fireEvent("changerange",this)},openHeaderSettings:function(){this.fireEvent("openheader",this)},updateCountOfPages:function(t){this.countOfPages.text(Common.Utils.String.format(this.txtOf,t)),this.pageCount=t},updateActiveSheet:function(t){this.txtActiveSheet.text(Common.Utils.String.format(this.txtSheet,t))},updateCurrentPage:function(t){this.txtNumberPage.setValue(t+1)},setOriginalPageSize:function(t,e){this._originalPageSize={w:t,h:e}},expandPrintTitles:function(){this.extendedPrintTitles=!this.extendedPrintTitles,this.$printTitlesBlock[this.extendedPrintTitles?"removeClass":"addClass"]("no-expand"),Common.localStorage.setBool("sse-print-titles-extended",this.extendedPrintTitles)},txtPrint:"Print",txtSave:"Save",txtPrintToPDF:"Print to PDF",txtPrinter:"Printer",txtPrinterNotSelected:"Printer not selected",txtPrintersNotFound:"Printers not found",txtPrintUsingSystemDialog:"Print using the system dialog",txtPrintRange:"Print range",txtCurrentSheet:"Current sheet",txtActiveSheets:"Active sheets",txtPages:"Pages:",txtTo:"to",txtAllSheets:"All sheets",txtSelection:"Selection",txtSettingsOfSheet:"Settings of sheet",txtPageSize:"Page size",txtPageOrientation:"Page orientation",txtPortrait:"Portrait",txtLandscape:"Landscape",txtScaling:"Scaling",txtActualSize:"Actual Size",txtFitPage:"Fit Sheet on One Page",txtFitCols:"Fit All Columns on One Page",txtFitRows:"Fit All Rows on One Pag",txtCustom:"Custom",txtCustomOptions:"Custom Options",txtPrintTitles:"Print titles",txtRepeatRowsAtTop:"Repeat rows at top",txtRepeatColumnsAtLeft:"Repeat columns at left",txtRepeat:"Repeat...",txtMargins:"Margins",txtTop:"Top",txtBottom:"Bottom",txtLeft:"Left",txtRight:"Right",txtGridlinesAndHeadings:"Gridlines and headings",txtPrintGrid:"Print gridlines",txtPrintHeadings:"Print row and columns headings",txtHeaderFooterSettings:"Header/footer settings",txtApplyToAllSheets:"Apply to all sheets",txtIgnore:"Ignore print area",txtPage:"Page",txtOf:"of {0}",txtSheet:"Sheet: {0}",txtPageNumInvalid:"Page number invalid",txtEmptyTable:"There is nothing to print because the table is empty",txtFirstPageNumber:"First page number:",txtCopies:"Copies",txtPrintSides:"Print sides",txtOneSide:"Print one sided",txtOneSideDesc:"Only print on one side of the page",txtBothSides:"Print on both sides",txtBothSidesLongDesc:"Flip pages on long edge",txtBothSidesShortDesc:"Flip pages on short edge",txtMarginsNormal:"Normal",txtMarginsNarrow:"Narrow",txtMarginsWide:"Wide",txtMarginsLast:"Last Custom"},SSE.Views.PrintWithPreview||{}))})),define("spreadsheeteditor/main/app/view/DocumentHolderExt",[],(function(){"use strict";if(window.SSE&&window.SSE.Views&&window.SSE.Views.DocumentHolder){var t=window.SSE.Views.DocumentHolder.prototype;t.createDelayedElementsViewer=function(){var t=this;t.menuViewCopy||(t.menuViewCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.txtCopy,value:"copy"}),t.menuViewUndo=new Common.UI.MenuItem({iconCls:"menu__icon btn-undo icon-rtl",caption:t.textUndo}),t.menuViewCopySeparator=new Common.UI.MenuItem({caption:"--"}),t.menuViewAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",id:"id-context-menu-item-view-add-comment",caption:t.txtAddComment}),t.pmiViewGetRangeList=new Common.UI.MenuItem({caption:t.txtGetLink}),t.menuSignatureViewSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),t.menuSignatureDetails=new Common.UI.MenuItem({caption:this.strDetails,value:1}),t.menuSignatureViewSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),t.menuSignatureRemove=new Common.UI.MenuItem({caption:this.strDelete,value:3}),t.menuViewSignSeparator=new Common.UI.MenuItem({caption:"--"}),t.menuViewCommentSeparator=new Common.UI.MenuItem({caption:"--"}),this.viewModeMenu=new Common.UI.Menu({cls:"shifted-right",items:[t.menuViewCopy,t.menuViewUndo,t.menuViewCopySeparator,t.menuSignatureViewSign,t.menuSignatureDetails,t.menuSignatureViewSetup,t.menuSignatureRemove,t.menuViewSignSeparator,t.menuViewAddComment,t.menuViewCommentSeparator,t.pmiViewGetRangeList]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e)})),t.fireEvent("createdelayedelements",[t,"view"]))},t.createDelayedElements=function(){var t=this;if(!t.pmiCut&&(window.styles_loaded||t.mode.isEditDiagram||t.mode.isEditMailMerge||t.mode.isEditOle)){t.pmiCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.txtCut,value:"cut"}),t.pmiCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.txtCopy,value:"copy"}),t.pmiPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.txtPaste,value:"paste"}),t.pmiSelectTable=new Common.UI.MenuItem({caption:t.txtSelect,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.selectRowText,value:Asc.c_oAscChangeSelectionFormatTable.row},{caption:this.selectColumnText,value:Asc.c_oAscChangeSelectionFormatTable.column},{caption:this.selectDataText,value:Asc.c_oAscChangeSelectionFormatTable.data},{caption:this.selectTableText,value:Asc.c_oAscChangeSelectionFormatTable.all}]})}),t.pmiInsertEntire=new Common.UI.MenuItem({caption:t.txtInsert}),t.pmiInsertCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:t.txtInsert,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtShiftRight,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftRight},{caption:t.txtShiftDown,value:Asc.c_oAscInsertOptions.InsertCellsAndShiftDown},{caption:t.txtRow,value:Asc.c_oAscInsertOptions.InsertRows},{caption:t.txtColumn,value:Asc.c_oAscInsertOptions.InsertColumns}]})}),t.pmiInsertTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-addcell",caption:t.txtInsert,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.insertRowAboveText,value:Asc.c_oAscInsertOptions.InsertTableRowAbove},{caption:t.insertRowBelowText,value:Asc.c_oAscInsertOptions.InsertTableRowBelow},{caption:t.insertColumnLeftText,value:Asc.c_oAscInsertOptions.InsertTableColLeft},{caption:t.insertColumnRightText,value:Asc.c_oAscInsertOptions.InsertTableColRight}]})}),t.pmiDeleteEntire=new Common.UI.MenuItem({caption:t.txtDelete}),t.pmiDeleteCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:t.txtDelete,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtShiftLeft,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftLeft},{caption:t.txtShiftUp,value:Asc.c_oAscDeleteOptions.DeleteCellsAndShiftTop},{caption:t.txtRow,value:Asc.c_oAscDeleteOptions.DeleteRows},{caption:t.txtColumn,value:Asc.c_oAscDeleteOptions.DeleteColumns}]})}),t.pmiDeleteTable=new Common.UI.MenuItem({iconCls:"menu__icon btn-delcell",caption:t.txtDelete,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.deleteRowText,value:Asc.c_oAscDeleteOptions.DeleteRows},{caption:this.deleteColumnText,value:Asc.c_oAscDeleteOptions.DeleteColumns},{caption:this.deleteTableText,value:Asc.c_oAscDeleteOptions.DeleteTable}]})}),t.pmiClear=new Common.UI.MenuItem({iconCls:"menu__icon btn-clearstyle",caption:t.txtClear,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtClearAll,value:Asc.c_oAscCleanOptions.All},{caption:t.txtClearText,value:Asc.c_oAscCleanOptions.Text},{caption:t.txtClearFormat,value:Asc.c_oAscCleanOptions.Format},{caption:t.txtClearComments,value:Asc.c_oAscCleanOptions.Comments},{caption:t.txtClearHyper,value:Asc.c_oAscCleanOptions.Hyperlinks}]})}),t.pmiSortCells=new Common.UI.MenuItem({caption:t.txtSort,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{iconCls:"menu__icon btn-sort-down",caption:t.txtAscending,value:Asc.c_oAscSortOptions.Ascending},{iconCls:"menu__icon btn-sort-up",caption:t.txtDescending,value:Asc.c_oAscSortOptions.Descending},{caption:t.txtSortCellColor,value:Asc.c_oAscSortOptions.ByColorFill},{caption:t.txtSortFontColor,value:Asc.c_oAscSortOptions.ByColorFont},{caption:t.txtCustomSort,value:"advanced"}]})}),t.pmiFilterCells=new Common.UI.MenuItem({iconCls:"menu__icon btn-autofilter",caption:t.txtFilter,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtFilterValue,value:0},{caption:t.txtFilterCellColor,value:1},{caption:t.txtFilterFontColor,value:2}]})}),t.pmiReapply=new Common.UI.MenuItem({caption:t.txtReapply}),t.mnuRefreshPivot=new Common.UI.MenuItem({caption:t.txtRefresh}),t.mnuExpandCollapsePivot=new Common.UI.MenuItem({caption:this.txtExpandCollapse,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:this.txtExpand,value:{visible:!0,isAll:!1}},{caption:this.txtCollapse,value:{visible:!1,isAll:!1}},{caption:this.txtExpandEntire,value:{visible:!0,isAll:!0}},{caption:this.txtCollapseEntire,value:{visible:!1,isAll:!0}}]})}),t.mnuGroupPivot=new Common.UI.MenuItem({caption:this.txtGroup,value:"grouping"}),t.mnuUnGroupPivot=new Common.UI.MenuItem({caption:this.txtUngroup,value:"ungrouping"}),t.mnuPivotSettings=new Common.UI.MenuItem({caption:this.txtPivotSettings}),t.mnuFieldSettings=new Common.UI.MenuItem({caption:this.txtFieldSettings}),t.mnuPivotFilter=new Common.UI.MenuItem({caption:this.txtFilter,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtClear,value:"clear"},{caption:"--"},{caption:t.txtTop10,value:"top10"},{caption:t.txtValueFilter,value:"value"},{caption:t.txtLabelFilter,value:"label"}]})}),t.mnuPivotSort=new Common.UI.MenuItem({caption:this.txtSort,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{iconCls:"menu__icon btn-sort-down",caption:t.txtAscending,value:Asc.c_oAscSortOptions.Ascending},{iconCls:"menu__icon btn-sort-up",caption:t.txtDescending,value:Asc.c_oAscSortOptions.Descending},{caption:t.txtSortOption,value:"advanced"}]})}),t.mnuDeleteField=new Common.UI.MenuItem({caption:this.txtDelField}),t.mnuSubtotalField=new Common.UI.MenuItem({caption:this.txtSubtotalField,checkable:!0,allowDepress:!0}),t.mnuSummarize=new Common.UI.MenuItem({caption:this.txtSummarize,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtSum,value:Asc.c_oAscDataConsolidateFunction.Sum,checkable:!0},{caption:t.txtCount,value:Asc.c_oAscDataConsolidateFunction.Count,checkable:!0},{caption:t.txtAverage,value:Asc.c_oAscDataConsolidateFunction.Average,checkable:!0},{caption:t.txtMax,value:Asc.c_oAscDataConsolidateFunction.Max,checkable:!0},{caption:t.txtMin,value:Asc.c_oAscDataConsolidateFunction.Min,checkable:!0},{caption:t.txtProduct,value:Asc.c_oAscDataConsolidateFunction.Product,checkable:!0},{caption:"--"},{caption:t.txtMoreOptions,value:-1}]})}),t.mnuShowAs=new Common.UI.MenuItem({caption:this.txtShowAs,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtNormal,value:Asc.c_oAscShowDataAs.Normal,numFormat:Asc.c_oAscNumFormatType.General,checkable:!0},{caption:t.txtPercentOfGrand,value:Asc.c_oAscShowDataAs.PercentOfTotal,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:t.txtPercentOfCol,value:Asc.c_oAscShowDataAs.PercentOfCol,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:t.txtPercentOfTotal,value:Asc.c_oAscShowDataAs.PercentOfRow,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:t.txtPercent,value:Asc.c_oAscShowDataAs.Percent,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:t.txtPercentOfParentRow,value:Asc.c_oAscShowDataAs.PercentOfParentRow,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:t.txtPercentOfParentCol,value:Asc.c_oAscShowDataAs.PercentOfParentCol,numFormat:Asc.c_oAscNumFormatType.Percent,checkable:!0},{caption:t.txtPercentOfParent,value:Asc.c_oAscShowDataAs.PercentOfParent,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:t.txtDifference,value:Asc.c_oAscShowDataAs.Difference,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:t.txtPercentDiff,value:Asc.c_oAscShowDataAs.PercentDiff,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:t.txtRunTotal,value:Asc.c_oAscShowDataAs.RunTotal,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:t.txtPercentOfRunTotal,value:Asc.c_oAscShowDataAs.PercentOfRunningTotal,numFormat:Asc.c_oAscNumFormatType.Percent,showMore:!0,checkable:!0},{caption:t.txtRankAscending,value:Asc.c_oAscShowDataAs.RankAscending,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:t.txtRankDescending,value:Asc.c_oAscShowDataAs.RankDescending,numFormat:Asc.c_oAscNumFormatType.General,showMore:!0,checkable:!0},{caption:t.txtIndex,value:Asc.c_oAscShowDataAs.Index,numFormat:Asc.c_oAscNumFormatType.General,checkable:!0},{caption:"--"},{caption:t.txtMoreOptions,value:-1}]})}),t.mnuShowDetails=new Common.UI.MenuItem({caption:t.txtShowDetails}),t.mnuPivotRefreshSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotSubtotalSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotExpandCollapseSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotGroupSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotDeleteSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotValueSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuPivotFilterSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuShowDetailsSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiInsFunction=new Common.UI.MenuItem({iconCls:"menu__icon btn-function",caption:t.txtFormula}),t.menuAddHyperlink=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.txtInsHyperlink,inCell:!0}),t.menuEditHyperlink=new Common.UI.MenuItem({caption:t.editHyperlinkText,inCell:!0}),t.menuRemoveHyperlink=new Common.UI.MenuItem({caption:t.removeHyperlinkText}),t.menuHyperlink=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.txtInsHyperlink,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlink,t.menuRemoveHyperlink]})}),t.pmiRowHeight=new Common.UI.MenuItem({caption:t.txtRowHeight,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtAutoRowHeight,value:"auto-row-height"},{caption:t.txtCustomRowHeight,value:"row-height"}]})}),t.pmiColumnWidth=new Common.UI.MenuItem({caption:t.txtColumnWidth,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtAutoColumnWidth,value:"auto-column-width"},{caption:t.txtCustomColumnWidth,value:"column-width"}]})}),t.pmiEntireHide=new Common.UI.MenuItem({caption:t.txtHide}),t.pmiEntireShow=new Common.UI.MenuItem({caption:t.txtShow}),t.pmiAddComment=new Common.UI.MenuItem({iconCls:"menu__icon btn-add-comment",id:"id-context-menu-item-add-comment",caption:t.txtAddComment}),t.pmiAddCommentSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiCellMenuSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiFunctionSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiFreezeSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiCellSeparator=new Common.UI.MenuItem({caption:"--"}),t.pmiAddNamedRange=new Common.UI.MenuItem({id:"id-context-menu-item-add-named-range",caption:t.txtAddNamedRange}),t.pmiFreezePanes=new Common.UI.MenuItem({caption:t.textFreezePanes}),t.pmiEntriesList=new Common.UI.MenuItem({caption:t.textEntriesList}),t.pmiSparklines=new Common.UI.MenuItem({caption:t.txtSparklines,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.txtClearSparklines,value:Asc.c_oAscCleanOptions.Sparklines},{caption:t.txtClearSparklineGroups,value:Asc.c_oAscCleanOptions.SparklineGroups}]})});var e=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div style="position: relative;"><div class="display-value"><%= caption %></div><label class="example-val" style="cursor: pointer;"><%= options.exampleval ? options.exampleval : "" %></label></div></a>');t.pmiNumFormat=new Common.UI.MenuItem({caption:t.txtNumFormat,menu:new Common.UI.Menu({cls:"shifted-right format-num-cls",menuAlign:"tl-tr",items:[{caption:this.txtGeneral,template:e,format:"General",exampleval:"100",value:Asc.c_oAscNumFormatType.General},{caption:this.txtNumber,template:e,format:"0.00",exampleval:"100,00",value:Asc.c_oAscNumFormatType.Number},{caption:this.txtScientific,template:e,format:"0.00E+00",exampleval:"1,00E+02",value:Asc.c_oAscNumFormatType.Scientific},{caption:this.txtAccounting,template:e,format:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',exampleval:"100,00 $",value:Asc.c_oAscNumFormatType.Accounting},{caption:this.txtCurrency,template:e,format:"$#,##0.00",exampleval:"100,00 $",value:Asc.c_oAscNumFormatType.Currency},{caption:this.txtDateShort,template:e,format:"MM-dd-yyyy",exampleval:"04-09-1900",value:Asc.c_oAscNumFormatType.Date},{caption:this.txtDateLong,template:e,format:"MMMM d yyyy",exampleval:"April 9 1900",value:Asc.c_oAscNumFormatType.Date},{caption:this.txtTime,template:e,format:"HH:MM:ss",exampleval:"00:00:00",value:Asc.c_oAscNumFormatType.Time},{caption:this.txtPercentage,template:e,format:"0.00%",exampleval:"100,00%",value:Asc.c_oAscNumFormatType.Percent},{caption:this.txtFraction,template:e,format:"# ?/?",exampleval:"100",value:Asc.c_oAscNumFormatType.Fraction},{caption:this.txtText,template:e,format:"@",exampleval:"100",value:Asc.c_oAscNumFormatType.Text},{caption:"--"},t.pmiAdvancedNumFormat=new Common.UI.MenuItem({caption:t.textMoreFormats,value:"advanced"})]})}),t.pmiCellFormat=new Common.UI.MenuItem({caption:t.txtCellFormat}),t.pmiCondFormat=new Common.UI.MenuItem({caption:t.txtCondFormat}),t.pmiGetRangeList=new Common.UI.MenuItem({caption:t.txtGetLink}),t.ssMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,id:"id-context-menu-cell",items:[t.pmiCut,t.pmiCopy,t.pmiPaste,{caption:"--"},t.pmiSelectTable,t.pmiInsertEntire,t.pmiInsertCells,t.pmiInsertTable,t.pmiDeleteEntire,t.pmiDeleteCells,t.pmiDeleteTable,t.pmiClear,t.pmiCellSeparator,t.pmiSparklines,t.pmiSortCells,t.pmiFilterCells,t.pmiReapply,t.mnuRefreshPivot,t.mnuPivotRefreshSeparator,t.mnuPivotSort,t.mnuPivotFilter,t.mnuPivotFilterSeparator,t.mnuSubtotalField,t.mnuPivotSubtotalSeparator,t.mnuExpandCollapsePivot,t.mnuPivotExpandCollapseSeparator,t.mnuGroupPivot,t.mnuUnGroupPivot,t.mnuPivotGroupSeparator,t.mnuDeleteField,t.mnuPivotDeleteSeparator,t.mnuSummarize,t.mnuShowAs,t.mnuPivotValueSeparator,t.mnuShowDetails,t.mnuShowDetailsSeparator,t.mnuFieldSettings,t.mnuPivotSettings,t.pmiAddCommentSeparator,t.pmiAddComment,t.pmiCellMenuSeparator,t.pmiCellFormat,t.pmiNumFormat,t.pmiCondFormat,t.pmiEntriesList,t.pmiGetRangeList,t.pmiAddNamedRange,t.pmiFunctionSeparator,t.pmiInsFunction,t.menuAddHyperlink,t.menuHyperlink,t.pmiRowHeight,t.pmiColumnWidth,t.pmiEntireHide,t.pmiEntireShow,t.pmiFreezeSeparator,t.pmiFreezePanes]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e)})),t.mnuGroupImg=new Common.UI.MenuItem({caption:this.txtGroup,iconCls:"menu__icon btn-shape-group",type:"group",value:"grouping"}),t.mnuUnGroupImg=new Common.UI.MenuItem({caption:this.txtUngroup,iconCls:"menu__icon btn-shape-ungroup",type:"group",value:"ungrouping"}),t.mnuShapeSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuShapeAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-shape",caption:t.advancedShapeText}),t.mnuImgAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-image",caption:t.advancedImgText}),t.mnuSlicerSeparator=new Common.UI.MenuItem({caption:"--"}),t.mnuSlicerAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-slicer",caption:t.advancedSlicerText}),t.mnuChartEdit=new Common.UI.MenuItem({iconCls:"menu__icon btn-menu-chart",caption:t.chartText}),t.mnuChartData=new Common.UI.MenuItem({iconCls:"menu__icon btn-select-range",caption:t.chartDataText}),t.mnuChartType=new Common.UI.MenuItem({caption:t.chartTypeText}),t.pmiImgCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.txtCut,value:"cut"}),t.pmiImgCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.txtCopy,value:"copy"}),t.pmiImgPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.txtPaste,value:"paste"}),t.menuSignatureEditSign=new Common.UI.MenuItem({caption:this.strSign,value:0}),t.menuSignatureEditSetup=new Common.UI.MenuItem({caption:this.strSetup,value:2}),t.menuEditSignSeparator=new Common.UI.MenuItem({caption:"--"}),t.menuImgOriginalSize=new Common.UI.MenuItem({caption:t.originalSizeText}),t.menuImgReplace=new Common.UI.MenuItem({caption:t.textReplace,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:this.textFromFile,value:"file"}),new Common.UI.MenuItem({caption:this.textFromUrl,value:"url"}),new Common.UI.MenuItem({caption:this.textFromStorage,value:"storage"})]})}),t.menuImgCrop=new Common.UI.MenuItem({caption:t.textCrop,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({caption:t.textCrop,checkable:!0,allowDepress:!0,value:0}),new Common.UI.MenuItem({caption:t.textCropFill,value:1}),new Common.UI.MenuItem({caption:t.textCropFit,value:2})]})}),t.menuImgResetCrop=new Common.UI.MenuItem({caption:t.textResetCrop,iconCls:"menu__icon btn-reset"}),t.mnuBringToFront=new Common.UI.MenuItem({caption:this.textArrangeFront,iconCls:"menu__icon btn-arrange-front",type:"arrange",value:Asc.c_oAscDrawingLayerType.BringToFront}),t.mnuSendToBack=new Common.UI.MenuItem({caption:this.textArrangeBack,iconCls:"menu__icon btn-arrange-back",type:"arrange",value:Asc.c_oAscDrawingLayerType.SendToBack}),t.mnuBringForward=new Common.UI.MenuItem({caption:this.textArrangeForward,iconCls:"menu__icon btn-arrange-forward",type:"arrange",value:Asc.c_oAscDrawingLayerType.BringForward}),t.mnuSendBackward=new Common.UI.MenuItem({caption:this.textArrangeBackward,iconCls:"menu__icon btn-arrange-backward",type:"arrange",value:Asc.c_oAscDrawingLayerType.SendBackward}),t.menuImageArrange=new Common.UI.MenuItem({caption:t.textArrange,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.mnuBringToFront,t.mnuSendToBack,t.mnuBringForward,t.mnuSendBackward,{caption:"--"},t.mnuGroupImg,t.mnuUnGroupImg]})}),t.menuImageAlign=new Common.UI.MenuItem({caption:t.textAlign,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:t.textShapeAlignLeft,iconCls:"menu__icon btn-shape-align-left",value:0},{caption:t.textShapeAlignCenter,iconCls:"menu__icon btn-shape-align-center",value:4},{caption:t.textShapeAlignRight,iconCls:"menu__icon btn-shape-align-right",value:1},{caption:t.textShapeAlignTop,iconCls:"menu__icon btn-shape-align-top",value:3},{caption:t.textShapeAlignMiddle,iconCls:"menu__icon btn-shape-align-middle",value:5},{caption:t.textShapeAlignBottom,iconCls:"menu__icon btn-shape-align-bottom",value:2},{caption:"--"},{caption:t.txtDistribHor,iconCls:"menu__icon btn-shape-distribute-hor",value:6},{caption:t.txtDistribVert,iconCls:"menu__icon btn-shape-distribute-vert",value:7}]})});var i=SSE.getController("Toolbar").getView("Toolbar");t.menuShapesMerge=new Common.UI.MenuItem({iconCls:"menu__icon btn-combine-shapes",caption:t.textShapesMerge,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{caption:i.textShapesUnion,iconCls:"menu__icon btn-union-shapes",value:"unite"},{caption:i.textShapesCombine,iconCls:"menu__icon btn-combine-shapes",value:"exclude"},{caption:i.textShapesFragment,iconCls:"menu__icon btn-fragment-shapes",value:"divide"},{caption:i.textShapesIntersect,iconCls:"menu__icon btn-intersect-shapes",value:"intersect"},{caption:i.textShapesSubstract,iconCls:"menu__icon btn-substract-shapes",value:"subtract"}]})}),t.menuImgRotate=new Common.UI.MenuItem({caption:t.textRotate,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-90",caption:t.textRotate90,type:"rotate",value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-rotate-270",caption:t.textRotate270,type:"rotate",value:0}),{caption:"--"},new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-hor",caption:t.textFlipH,type:"flip",value:1}),new Common.UI.MenuItem({iconCls:"menu__icon btn-flip-vert",caption:t.textFlipV,type:"flip",value:0})]})}),t.menuImgMacro=new Common.UI.MenuItem({caption:t.textMacro}),t.menuSaveAsPicture=new Common.UI.MenuItem({caption:t.textSaveAsPicture});var s=new Common.UI.MenuItem({caption:"--"});t.menuImgEditPoints=new Common.UI.MenuItem({iconCls:"menu__icon btn-edit-points",caption:t.textEditPoints}),t.menuEditObject=new Common.UI.MenuItem({caption:t.txtEditObject}),t.menuEditObjectSeparator=new Common.UI.MenuItem({caption:"--"}),this.imgMenu=new Common.UI.Menu({cls:"shifted-right",restoreHeightAndTop:!0,scrollToCheckedItem:!1,items:[t.pmiImgCut,t.pmiImgCopy,t.pmiImgPaste,t.menuEditObjectSeparator,t.menuEditObject,{caption:"--"},t.menuSignatureEditSign,t.menuSignatureEditSetup,t.menuEditSignSeparator,t.menuImageArrange,t.menuImageAlign,t.menuShapesMerge,t.menuImgRotate,t.menuImgMacro,s,t.menuSaveAsPicture,t.mnuShapeSeparator,t.menuImgCrop,t.menuImgResetCrop,t.mnuChartData,t.mnuChartType,t.mnuChartEdit,t.menuImgEditPoints,t.mnuShapeAdvanced,t.menuImgOriginalSize,t.menuImgReplace,t.mnuImgAdvanced,t.mnuSlicerSeparator,t.mnuSlicerAdvanced]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e)})),this.menuParagraphVAlign=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:this.vertAlignText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphTop=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-top",caption:t.topCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Top}),t.menuParagraphCenter=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-middle",caption:t.centerCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Center}),this.menuParagraphBottom=new Common.UI.MenuItem({iconCls:"menu__icon btn-align-bottom",caption:t.bottomCellText,checkable:!0,checkmark:!1,toggleGroup:"popupparagraphvalign",value:Asc.c_oAscVAlign.Bottom})]})}),t.menuParagraphDirection=new Common.UI.MenuItem({iconCls:"menu__icon btn-text-orient-hor",caption:t.directionText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuParagraphDirectH=new Common.UI.MenuItem({caption:t.directHText,iconCls:"menu__icon btn-text-orient-hor",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.normal}),t.menuParagraphDirect90=new Common.UI.MenuItem({caption:t.direct90Text,iconCls:"menu__icon btn-text-orient-rdown",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert}),t.menuParagraphDirect270=new Common.UI.MenuItem({caption:t.direct270Text,iconCls:"menu__icon btn-text-orient-rup",checkable:!0,checkmark:!1,checked:!1,toggleGroup:"popupparagraphdirect",direction:Asc.c_oAscVertDrawingText.vert270})]})}),t.menuParagraphBullets=new Common.UI.MenuItem({iconCls:"menu__icon btn-setmarkers",caption:t.bulletsText,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[{template:_.template('<div id="id-docholder-menu-bullets" class="menu-layouts" style="width: 376px;"></div>')},{caption:"--"},t.menuParagraphBulletNone=new Common.UI.MenuItem({caption:t.textNone,checkable:!0,checked:!1,value:-1}),t.mnuListSettings=new Common.UI.MenuItem({caption:t.textListSettings,value:"settings"})]})}),t._markersArr=['{"bulletTypeface":{"type":"bufont","typeface":"Symbol"},"bulletType":{"type":"char","char":"","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Courier New"},"bulletType":{"type":"char","char":"o","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"v","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Wingdings"},"bulletType":{"type":"char","char":"","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Symbol"},"bulletType":{"type":"char","char":"","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"char","char":"","startAt":null}}'],t._numbersArr=['{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaUcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaLcParenR","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"alphaLcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"arabicPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"arabicParenR","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"romanUcPeriod","startAt":null}}','{"bulletTypeface":{"type":"bufont","typeface":"Arial"},"bulletType":{"type":"autonum","char":null,"autoNumType":"romanLcPeriod","startAt":null}}'],t.paraBulletsPicker={conf:{rec:null},delayRenderTips:!0,store:new Common.UI.DataViewStore([{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:1,numberingInfo:t._markersArr[0],skipRenderOnChange:!0,tip:this.tipMarkersFRound},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:2,numberingInfo:t._markersArr[1],skipRenderOnChange:!0,tip:this.tipMarkersHRound},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:3,numberingInfo:t._markersArr[2],skipRenderOnChange:!0,tip:this.tipMarkersFSquare},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:4,numberingInfo:t._markersArr[3],skipRenderOnChange:!0,tip:this.tipMarkersStar},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:5,numberingInfo:t._markersArr[4],skipRenderOnChange:!0,tip:this.tipMarkersArrow},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:6,numberingInfo:t._markersArr[5],skipRenderOnChange:!0,tip:this.tipMarkersCheckmark},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:7,numberingInfo:t._markersArr[6],skipRenderOnChange:!0,tip:this.tipMarkersFRhombus},{group:"menu-list-bullet-group",id:"id-markers-"+Common.UI.getId(),type:0,subtype:8,numberingInfo:t._markersArr[7],skipRenderOnChange:!0,tip:this.tipMarkersDash},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:4,numberingInfo:t._numbersArr[0],skipRenderOnChange:!0,tip:this.tipNumCapitalLetters},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:5,numberingInfo:t._numbersArr[1],skipRenderOnChange:!0,tip:this.tipNumLettersParentheses},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:6,numberingInfo:t._numbersArr[2],skipRenderOnChange:!0,tip:this.tipNumLettersPoints},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:1,numberingInfo:t._numbersArr[3],skipRenderOnChange:!0,tip:this.tipNumNumbersPoint},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:2,numberingInfo:t._numbersArr[4],skipRenderOnChange:!0,tip:this.tipNumNumbersParentheses},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:3,numberingInfo:t._numbersArr[5],skipRenderOnChange:!0,tip:this.tipNumRoman},{group:"menu-list-number-group",id:"id-numbers-"+Common.UI.getId(),type:1,subtype:7,numberingInfo:t._numbersArr[6],skipRenderOnChange:!0,tip:this.tipNumRomanSmall}]),groups:new Common.UI.DataViewGroupStore([{id:"menu-list-bullet-group",caption:this.textBullets},{id:"menu-list-number-group",caption:this.textNumbering}]),selectRecord:function(t){this.conf.rec=t}},t.menuAddHyperlinkShape=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.txtInsHyperlink}),t.menuEditHyperlinkShape=new Common.UI.MenuItem({caption:t.editHyperlinkText}),t.menuRemoveHyperlinkShape=new Common.UI.MenuItem({caption:t.removeHyperlinkText}),t.menuHyperlinkShape=new Common.UI.MenuItem({iconCls:"menu__icon btn-inserthyperlink",caption:t.txtInsHyperlink,menu:new Common.UI.Menu({cls:"shifted-right",menuAlign:"tl-tr",items:[t.menuEditHyperlinkShape,t.menuRemoveHyperlinkShape]})}),this.pmiTextAdvanced=new Common.UI.MenuItem({iconCls:"menu__icon btn-paragraph",caption:t.txtTextAdvanced}),t.pmiTextCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.txtCut,value:"cut"}),t.pmiTextCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.txtCopy,value:"copy"}),t.pmiTextPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.txtPaste,value:"paste"}),t.menuParagraphEquation=new Common.UI.MenuItem({caption:t.advancedEquationText,iconCls:"menu__icon btn-equation",menu:t.createEquationMenu("popupparaeqinput","tl-tr")}),this.textInShapeMenu=new Common.UI.Menu({cls:"shifted-right",scrollToCheckedItem:!1,items:[t.pmiTextCut,t.pmiTextCopy,t.pmiTextPaste,{caption:"--"},t.menuParagraphVAlign,t.menuParagraphDirection,t.menuParagraphBullets,t.menuAddHyperlinkShape,t.menuHyperlinkShape,{caption:"--"},t.pmiTextAdvanced,t.menuParagraphEquation]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e)})),t.pmiCommonCut=new Common.UI.MenuItem({iconCls:"menu__icon btn-cut",caption:t.txtCut,value:"cut"}),t.pmiCommonCopy=new Common.UI.MenuItem({iconCls:"menu__icon btn-copy",caption:t.txtCopy,value:"copy"}),t.pmiCommonPaste=new Common.UI.MenuItem({iconCls:"menu__icon btn-paste",caption:t.txtPaste,value:"paste"}),t.copyPasteMenu=new Common.UI.Menu({cls:"shifted-right",items:[t.pmiCommonCut,t.pmiCommonCopy,t.pmiCommonPaste]}).on("hide:after",(function(e,i,s){t.clearCustomItems(e)})),this.entriesMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,items:[]}).on("show:after",(function(){this.scroller.update({alwaysVisibleY:!0})})).on("keydown:before",(function(t,e){if(e.altKey&&e.keyCode==Common.UI.Keys.DOWN){var i=$(e.target).closest("li");i.length>0?i.click():t.hide()}})),this.funcMenu=new Common.UI.Menu({maxHeight:200,cyclic:!1,items:[]}).on("render:after",(function(t){t.cmpEl.removeAttr("oo_editor_input").attr("oo_editor_keyboard",!0)})),this.tableTotalMenu=new Common.UI.Menu({maxHeight:160,menuAlign:"tr-br",cyclic:!1,cls:"lang-menu",items:[{caption:this.textNone,value:Asc.ETotalsRowFunction.totalrowfunctionNone,checkable:!0},{caption:this.textAverage,value:Asc.ETotalsRowFunction.totalrowfunctionAverage,checkable:!0},{caption:this.textCount,value:Asc.ETotalsRowFunction.totalrowfunctionCount,checkable:!0},{caption:this.textMax,value:Asc.ETotalsRowFunction.totalrowfunctionMax,checkable:!0},{caption:this.textMin,value:Asc.ETotalsRowFunction.totalrowfunctionMin,checkable:!0},{caption:this.textSum,value:Asc.ETotalsRowFunction.totalrowfunctionSum,checkable:!0},{caption:this.textStdDev,value:Asc.ETotalsRowFunction.totalrowfunctionStdDev,checkable:!0},{caption:this.textVar,value:Asc.ETotalsRowFunction.totalrowfunctionVar,checkable:!0},{caption:this.textMore,value:Asc.ETotalsRowFunction.totalrowfunctionCustom,checkable:!0}]}),t.fillMenu=new Common.UI.Menu({restoreHeightAndTop:!0,items:[{caption:this.textCopyCells,value:Asc.c_oAscFillType.copyCells},{caption:this.textFillSeries,value:Asc.c_oAscFillType.fillSeries},{caption:this.textFillFormatOnly,value:Asc.c_oAscFillType.fillFormattingOnly},{caption:this.textFillWithoutFormat,value:Asc.c_oAscFillType.fillWithoutFormatting},{caption:"--"},{caption:this.textFillDays,value:Asc.c_oAscFillType.fillDays},{caption:this.textFillWeekdays,value:Asc.c_oAscFillType.fillWeekdays},{caption:this.textFillMonths,value:Asc.c_oAscFillType.fillMonths},{caption:this.textFillYears,value:Asc.c_oAscFillType.fillYears},{caption:"--"},{caption:this.textLinearTrend,value:Asc.c_oAscFillType.linearTrend},{caption:this.textGrowthTrend,value:Asc.c_oAscFillType.growthTrend},{caption:this.textFlashFill,value:Asc.c_oAscFillType.flashFill},{caption:this.textSeries,value:Asc.c_oAscFillType.series}]}),t.fireEvent("createdelayedelements",[t,"edit"])}}}})),define("spreadsheeteditor/main/app/view/PivotShowDetailDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.PivotShowDetailDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"PivotShowDetailDialog",separator:!1,contentWidth:300},initialize:function(t){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="input-label">',this.textDescription,"</label>",'<div id="pivot-show-detail-list" class="range-tableview" style="width:100%; height: 165px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,this.fieldsNames=t.fieldsNames||[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.rangeList=new Common.UI.ListView({el:$("#pivot-show-detail-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div style="pointer-events:none;">','<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:186px;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>","</div>"].join("")),tabindex:1}),this.rangeList.on("item:dblclick",_.bind(this.onDblClickFunction,this)),this.rangeList.on("entervalue",_.bind(this.onPrimary,this)),this.afterRender()},getFocusedComponents:function(){return[this.rangeList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults()},_setDefaults:function(){if(this.fieldsNames){var t=this;this.rangeList.store.reset(this.fieldsNames),this.rangeList.store.length>0&&this.rangeList.selectByIndex(0),this.rangeList.scroller.update({alwaysVisibleY:!0}),_.delay((function(){t.rangeList.focus()}),100,this)}},getSettings:function(){var t=this.rangeList.getSelectedRec();return t?{index:t.get("index"),name:t.get("name")}:null},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close(),!1},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onDblClickFunction:function(){this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close()},txtTitle:"Show Detail",textDescription:"Choose the field containing the detail you want to show:"},SSE.Views.PivotShowDetailDialog||{}))})),define("spreadsheeteditor/main/app/view/ChartDataDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.ChartDataDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,id:"window-chart-data"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="input-label">',e.textData,"</label>","</td>","</tr>","<tr>",'<td class="padding-small" width="200">','<div id="chart-dlg-txt-range" class="input-row" style=""></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',e.textSeries,"</label>",'<div id="chart-dlg-series-list" class="" style="width:100%; height: 93px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-add">',e.textAdd,"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-edit">',e.textEdit,"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-delete">',e.textDelete,"</button>",'<div class="up-down-btns float-right">','<div id="chart-dlg-btn-up" class="margin-right-2"></div>','<div id="chart-dlg-btn-down"></div>',"</div>","</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-switch" style="min-width: 70px;">',e.textSwitch,"</button>","</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">',e.textCategory,"</label>",'<div id="chart-dlg-category-list" class="" style="width:100%; height: 93px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<button type="button" class="btn btn-text-default auto margin-right-5" id="chart-dlg-btn-category-edit" style="min-width: 70px;">',e.textEdit,"</button>","</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._noApply=!0,this._changedProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.currentChartType=Asc.c_oAscChartTypeSettings.barNormal,this._isOpen=!1},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.on("animate:after",_.bind(this.onAnimateAfter,this)),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#chart-dlg-txt-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.txtDataRange.on("changed:after",(function(e,i,s,n){i!=s&&t.changeChartRange(i)})),this.seriesList=new Common.UI.ListView({el:$("#chart-dlg-series-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="min-height: 15px;"><%= Common.Utils.String.htmlEncode(value) %></div>'),tabindex:1}),this.seriesList.onKeyDown=_.bind(this.onListKeyDown,this,"series"),this.seriesList.on("item:select",_.bind(this.onSelectSeries,this)),this.seriesList.store.comparator=function(t){return t.get("order")},this.btnAdd=new Common.UI.Button({el:$("#chart-dlg-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddSeries,this,!1)),this.btnDelete=new Common.UI.Button({el:$("#chart-dlg-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteSeries,this)),this.btnEdit=new Common.UI.Button({el:$("#chart-dlg-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEditSeries,this,!1)),this.btnUp=new Common.UI.Button({parentEl:$("#chart-dlg-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#chart-dlg-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.btnSwitch=new Common.UI.Button({el:$("#chart-dlg-btn-switch")}),this.btnSwitch.on("click",_.bind(this.onSwitch,this)),this.categoryList=new Common.UI.ListView({el:$("#chart-dlg-category-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="min-height: 15px;"><%= Common.Utils.String.htmlEncode(value) %></div>'),tabindex:1}),this.btnEditCategory=new Common.UI.Button({el:$("#chart-dlg-btn-category-edit")}),this.btnEditCategory.on("click",_.bind(this.onEditCategory,this,!1)),this.afterRender()},getFocusedComponents:function(){return[this.txtDataRange,this.seriesList,this.btnAdd,this.btnEdit,this.btnDelete,this.btnUp,this.btnDown,this.btnSwitch,this.categoryList,this.btnEditCategory].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.txtDataRange},afterRender:function(){this._setDefaults(this.chartSettings)},onAnimateAfter:function(){this.chartSettings&&!this._isOpen&&(this.updateCategoryList(this.chartSettings.getCatValues(),!0),this._isOpen=!0)},close:function(){this.clearCategoryListTimer(),this.api.asc_onCloseChartFrame(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){if(t){this.chartSettings=t,this.currentChartType=t.getType();var e=t.getRange();this.txtDataRange.setValue(e||""),this.txtDataRange.validation=function(t){return!0},this.updateSeriesList(t.getSeries(),0),this.updateCategoryList(t.getCatValues())}this.updateButtons()},getSettings:function(){return{chartSettings:this.chartSettings}},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;if("ok"==e){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)}this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},isRangeValid:function(){var t;if(!0===(t=this.chartSettings.isValidRange(this.txtDataRange.getValue()))||t==Asc.c_oAscError.ID.No)return!0;var e=this.textInvalidRange;switch(t){case Asc.c_oAscError.ID.StockChartError:e=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:e=this.errorMaxRows;break;case Asc.c_oAscError.ID.MaxDataPointsError:e=this.errorMaxPoints;break;case Asc.c_oAscError.ID.ErrorInFormula:e=this.errorInFormula;break;case Asc.c_oAscError.ID.InvalidReference:e=this.errorInvalidReference;break;case Asc.c_oAscError.ID.NoSingleRowCol:e=this.errorNoSingleRowCol;break;case Asc.c_oAscError.ID.NoValues:e=this.errorNoValues}return Common.UI.warning({msg:e,maxwidth:600}),!1},changeChartRange:function(t){var e=this;e.isRangeValid(t)&&(e.txtDataRange.checkValidate(),e.chartSettings.setRange(t),e.updateSeriesList(e.chartSettings.getSeries(),0),e.updateCategoryList(e.chartSettings.getCatValues()),e.updateButtons())},onSelectData:function(t){var e=this;if(e.api){var i=new SSE.Views.CellRangeDialog({handler:function(i,s){"ok"==s&&(t.setValue(i.getSettings()),_.delay((function(){e.changeChartRange(i.getSettings())}),10))}}).on("close",(function(){e.show()})),s=Common.Utils.getOffset(e.$window);e.hide(),i.show(e.$window,s),i.setSettings({api:e.api,range:e.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}})}},onListKeyDown:function(t,e,i){var s=this.seriesList;s.disabled||(_.isUndefined(void 0)&&(i=e),(i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled())&&Common.UI.DataView.prototype.onKeyDown.call(s,e,i))},onSelectSeries:function(t,e,i){this.updateMoveButtons()},updateRange:function(){this.txtDataRange.setValue(this.chartSettings.getRange()||"")},updateButtons:function(){this.btnEdit.setDisabled(this.seriesList.store.length<1),this.btnDelete.setDisabled(this.seriesList.store.length<1),this.btnSwitch.setDisabled(this.seriesList.store.length<1||!this.chartSettings.getRange()),this.updateMoveButtons()},updateMoveButtons:function(){var t=this.seriesList.getSelectedRec(),e=t?this.seriesList.store.indexOf(t):-1;this.btnUp.setDisabled(e<1),this.btnDown.setDisabled(e<0||e==this.seriesList.store.length-1)},onAddSeries:function(){var t=this;t.chartSettings.startEditData();var e=t.chartSettings.addSeries(),i=e.asc_IsScatter();this.changeDataRange(1,{series:e,isScatter:i},(function(e,i){"ok"==i&&(t.updateRange(),t.updateSeriesList(t.chartSettings.getSeries(),t.seriesList.store.length-1),t.updateCategoryList(t.chartSettings.getCatValues()),t.updateButtons(),t.chartSettings.endEditData(),t._isEditRanges=!1)}))},onDeleteSeries:function(){var t=this.seriesList.getSelectedRec();if(t){var e=t.get("order");t.get("series").asc_Remove(),this.updateRange(),this.updateSeriesList(this.chartSettings.getSeries(),e),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateButtons()}},onEditSeries:function(){var t=this.seriesList.getSelectedRec();if(t){var e=t.get("series"),i=e.asc_IsScatter(),s=this;s.chartSettings.startEditData(),this.changeDataRange(1,{series:e,isScatter:i},(function(i,n){"ok"==n&&(t.set("value",e.asc_getSeriesName()),s.updateRange(),s.updateCategoryList(s.chartSettings.getCatValues()),s.updateButtons(),s.chartSettings.endEditData(),s._isEditRanges=!1)}))}},onEditCategory:function(){var t=this;t.chartSettings.startEditData(),this.changeDataRange(0,{category:this.chartSettings.getCatFormula(),values:this.chartSettings.getCatValues()},(function(e,i){"ok"==i&&(t.updateCategoryList(t.chartSettings.getCatValues()),t.updateRange(),t.updateButtons(),t.chartSettings.endEditData(),t._isEditRanges=!1)}))},changeDataRange:function(t,e,i){var s=this,n=new SSE.Views.ChartDataRangeDialog({type:t,isScatter:!!e.isScatter,handler:i}).on("close",(function(){s._isEditRanges&&s.chartSettings.cancelEditData(),s._isEditRanges=!1,s.show()}));s._isEditRanges=!0;var a=Common.Utils.getOffset(s.$window);s.hide(),n.show(a.left+(s.$window.outerWidth()-n.options.width)/2,a.top+(s.$window.outerHeight()-150)/2),n.setSettings({api:s.api,props:e,chartSettings:s.chartSettings})},onMoveClick:function(t){var e=this.seriesList.store,i=e.length,s=this.seriesList.getSelectedRec();if(s){var n=e.indexOf(s),a=s.get("order"),o=t?Math.max(0,n-1):Math.min(i-1,n+1),l=e.at(o),r=l.get("order");e.add(e.remove(s),{at:o}),s.set("order",r),l.set("order",a),t?s.get("series").asc_MoveUp():s.get("series").asc_MoveDown(),this.seriesList.selectRecord(s),this.seriesList.scrollToRecord(s),this.updateRange(),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateButtons()}},updateSeriesList:function(t,e){this.btnEditCategory.setDisabled(!!(t&&t.length>0)&&t[0].asc_IsScatter());for(var i=[],s=this.seriesList.store,n=0,a=t.length;n<a;n++){var o=t[n],l=new Common.UI.DataViewModel;l.set({value:o.asc_getSeriesName(),index:o.asc_getIdx(),order:o.asc_getOrder(),series:o}),i.push(l)}s.reset(i),a>0&&this.seriesList.selectByIndex(Math.min(e||0,s.length-1))},updateCategoryList:function(t,e){this.clearCategoryListTimer();var i=this,s=this.categoryList.store,n=t.length,a=function(t){for(var e=[],i=0,s=t.length;i<s;i++){var n=t[i],a=new Common.UI.DataViewModel;a.set({value:n}),e.push(a)}return e},o=function(e){i._categoryListIndex=e,i._loadCategoryListTimer=setInterval((function(){i._categoryListIndex+1>=n?i.clearCategoryListTimer():(s.add(a(t.slice(i._categoryListIndex,i._categoryListIndex+10))),i._categoryListIndex+=10)}),10)};e?n>s.length&&o(10):(t.length<10?s.reset(a(t)):(s.reset(a(t.slice(0,9))),this._isOpen&&_.defer((function(){o(10)}),0)),n>0&&this.categoryList.selectByIndex(0))},clearCategoryListTimer:function(){this._loadCategoryListTimer&&(clearInterval(this._loadCategoryListTimer),this._loadCategoryListTimer=void 0)},onSwitch:function(){this.chartSettings.switchRowCol()===Asc.c_oAscError.ID.MaxDataSeriesError?Common.UI.warning({msg:this.errorMaxRows,maxwidth:600}):(this.updateSeriesList(this.chartSettings.getSeries(),0),this.updateCategoryList(this.chartSettings.getCatValues()),this.updateRange(),this.updateButtons())},textTitle:"Chart Data",textInvalidRange:"Invalid cells range",textSelectData:"Select data",errorMaxRows:"The maximum number of data series per chart is 255.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price.",errorMaxPoints:"The maximum number of points in series per chart is 4096.",textSeries:"Legend Entries (Series)",textAdd:"Add",textEdit:"Edit",textDelete:"Remove",textSwitch:"Switch Row/Column",textCategory:"Horizontal (Category) Axis Labels",textUp:"Up",textDown:"Down",textData:"Chart data range",errorInFormula:"There's an error in formula you entered.",errorInvalidReference:"The reference is not valid. Reference must be to an open worksheet.",errorNoSingleRowCol:"The reference is not valid. References for titles, values, sizes, or data labels must be a single cell, row, or column.",errorNoValues:"To create a chart, the series must contain at least one value."},SSE.Views.ChartDataDialog||{}))})),define("text!spreadsheeteditor/main/app/template/SortDialog.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td>\n                    <label style="margin-bottom: 4px;"><%= scope.textLevels %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-add"><%= scope.textBtnNew %></button>\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-copy"><%= scope.textBtnCopy %></button>\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="sort-dialog-btn-options"><%= scope.textOptions %></button>\n                    <div id="sort-dialog-btn-up" style="display: inline-block;"></div>\n                    <div id="sort-dialog-btn-down" style="display: inline-block;"></div>\n                </td>\n                <td style="width:80px;" class="padding-small">\n                    <button type="button" class="btn btn-text-default auto" id="sort-dialog-btn-delete" style="min-width: 80px;"><%= scope.textBtnDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2">\n                    <div id="sort-dialog-list" class="" style="width:100%; height: 173px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/SortDialog",["text!spreadsheeteditor/main/app/template/SortDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{};var e=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",(function(){e.render(),e.trigger("change",e,e.model)})),e.listenTo(e.model,"change:selected",(function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))})),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.SortDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"SortDialog",contentWidth:560,separator:!1,buttons:["ok","cancel"]},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this.levels=[],this.sortOptions={},this.options.handler=function(t,i){if(i||(i=new Asc.CSortProperties).asc_setSelection(e.props.asc_getSelection()),"ok"==t&&!this.isListValid())return!0;e.handler&&e.handler.call(this,t,i)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this,i=$('<span style="position: absolute; visibility: hidden;"></span>');t.$window.append(i),i.text(this.textSortBy);var s=i.width();i.text(this.textThenBy),s=Math.ceil(Math.max(s,i.width()))+10,i.remove(),this.sortList=new Common.UI.ListView({el:$("#sort-dialog-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",headers:[{name:t.textColumn,width:212},{name:t.textSort,width:157},{name:t.textOrder,width:156}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;display: flex;align-items:center;" id="sort-dialog-item-<%= levelIndex %>">','<label class="level-caption" style="width: '+s+'px;flex-shrink:0;cursor: pointer;"></label>','<div style="display:inline-block;flex-grow: 1;">','<div style="width: 33%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-col-<%= levelIndex %>" class="input-group-nr" style=""></div></div>','<div style="width: 33%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-sort-<%= levelIndex %>" class="input-group-nr"></div></div>',"<% if (sort==Asc.c_oAscSortOptions.ByColorFill || sort==Asc.c_oAscSortOptions.ByColorFont) { %>",'<div style="width: 17%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-btn-color-<%= levelIndex %>" class="input-group-nr"></div></div>','<div style="width: 17%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-order-<%= levelIndex %>" class="input-group-nr" style=""></div></div>',"<% } else { %>",'<div style="width: 34%;padding: 0 5px;display: inline-block;vertical-align: top;"><div id="sort-dialog-cmb-order-<%= levelIndex %>" class="input-group-nr" style=""></div></div>',"<% } %>","</div>","</div>"].join("")),tabindex:1}),this.sortList.createNewItem=function(t){return new e({template:this.itemTemplate,model:t})},this.sortList.on("item:select",_.bind(this.onSelectLevel,this)).on("item:deselect",_.bind(this.onDeselectLevel,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:remove",_.bind(this.onRemoveLevel,this)).on("entervalue",_.bind(this.onPrimary,this)),this.btnAdd=new Common.UI.Button({el:$("#sort-dialog-btn-add")}),this.btnAdd.on("click",_.bind(this.onAddLevel,this,!1)),this.btnDelete=new Common.UI.Button({el:$("#sort-dialog-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteLevel,this)),this.btnCopy=new Common.UI.Button({el:$("#sort-dialog-btn-copy")}),this.btnCopy.on("click",_.bind(this.onCopyLevel,this,!1)),this.btnOptions=new Common.UI.Button({el:$("#sort-dialog-btn-options")}),this.btnOptions.on("click",_.bind(this.onOptions,this,!1)),this.btnUp=new Common.UI.Button({parentEl:$("#sort-dialog-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#sort-dialog-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.afterRender()},afterRender:function(){this._setDefaults(this.props)},getDefaultFocusableComponent:function(){return this.sortList},_setDefaults:function(t){Common.UI.FocusManager.add(this,[this.btnAdd,this.btnDelete,this.btnCopy,this.btnOptions,this.btnUp,this.btnDown,this.sortList].concat(this.getFooterButtons())),t&&(this.sortOptions={headers:t.asc_getHasHeaders(),sortcol:t.asc_getColumnSort(),lockHeaders:!!t.asc_getLockChangeHeaders(),lockOrientation:!!t.asc_getLockChangeOrientation()},this.sortList.setHeaderName(0,t.asc_getColumnSort()?this.textColumn:this.textRow),this.fillSortValues(),this.sort_data=[{value:Asc.c_oAscSortOptions.ByValue,displayValue:this.textValues},{value:Asc.c_oAscSortOptions.ByColorFill,displayValue:this.textCellColor},{value:Asc.c_oAscSortOptions.ByColorFont,displayValue:this.textFontColor}],this.order_data=[{value:Asc.c_oAscSortOptions.Ascending,displayValue:this.textAZ},{value:Asc.c_oAscSortOptions.Descending,displayValue:this.textZA}],this.sortList.on("item:add",_.bind(this.addControls,this,!1)),this.sortList.on("item:change",_.bind(this.addControls,this,!0)),this.refreshList(t.asc_getLevels()),this.initListHeaders())},refreshList:function(t){this.levels=[];var e=[];if(t||1!=this.column_data.length||(t=[{columnIndex:this.column_data[0].value,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending}]),t)for(var i=0;i<t.length;i++){var s=t[i],n=s.asc_getIndex?s.asc_getIndex():s.columnIndex,a=this.props.asc_getLevelProps(n),o=s.asc_getSortBy?s.asc_getSortBy():s.sort,l=!a||a.asc_getIsTextData(),r=o!==Asc.c_oAscSortOptions.ByValue;if(e.push({columnIndex:n,levelIndex:i,sort:o,order:s.asc_getDescending?s.asc_getDescending():s.order,color:s.asc_getColor?s.asc_getColor():void 0}),r){var c=[],d=this;if(a)(o==Asc.c_oAscSortOptions.ByColorFill?a.asc_getColorsFill():a.asc_getColorsFont()).forEach((function(t,e){if(t){var i=Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase();c.push({value:i,displayValue:"",color:t,styleObj:{"background-color":"#"+i},styleStr:"background-color: #"+i+";"})}else c.unshift({value:-1,displayValue:o==Asc.c_oAscSortOptions.ByColorFill?d.textNone:d.textAuto,color:null,styleObj:{"background-color":"transparent"},styleStr:"background-color:transparent;"})}))}this.levels[i]={levelProps:a,order_data:[{value:Asc.c_oAscSortOptions.Ascending,displayValue:r?this.sortOptions.sortcol?this.textTop:this.textLeft:l?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:r?this.sortOptions.sortcol?this.textBelow:this.textRight:l?this.textZA:this.textDesc}],color_data:c}}else e.push({columnIndex:null,levelIndex:0,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending});this.beforeLevelsReset(this.sortList.store),this.sortList.store.reset(e),this.sortList.store.length>0&&this.sortList.selectByIndex(0);d=this;setTimeout((function(){d.sortList.focus()}),1),this.updateButtons()},initListHeaders:function(){var t,e=Common.UI.isRTL(),i=0,s=0,n=this.sortList.cmpEl.find("#sort-dialog-cmb-sort-0"),a=this.sortList.headerEl.width(),o=parseFloat(this.sortList.headerEl.css(e?"padding-right":"padding-left")),l=Common.Utils.getPosition(n);e?l&&(i=a+o-(Math.floor(l.left)+n.width())):l&&(i=Math.floor(l.left)-o),!(n=this.sortList.cmpEl.find("#sort-dialog-btn-color-0"))[0]&&(n=this.sortList.cmpEl.find("#sort-dialog-cmb-order-0")),l=Common.Utils.getPosition(n),e?l&&(s=a+o-(Math.floor(l.left)+n.width())-i):l&&(s=Math.floor(l.left)-o-i),t=a-i-s,this.sortList.setHeaderWidth(0,i),this.sortList.setHeaderWidth(1,s),this.sortList.setHeaderWidth(2,t)},onShowMenu:function(){this.sortList.enableKeyEvents=!1},onHideMenu:function(){this.sortList.enableKeyEvents=!0},addControls:function(t,e,i,s){if(s){var n=this,a=s.get("levelIndex"),o=this.sortList.cmpEl.find("#sort-dialog-item-"+a),l=[];this.levels[a]||(this.levels[a]={order_data:this.order_data});var r=this.levels[a],c=new Common.UI.ComboBox({el:o.find("#sort-dialog-cmb-col-"+a),editable:!1,cls:"input-group-nr",menuCls:"menu-absolute",menuStyle:"max-height: 135px;",takeFocusOnClose:!0,data:this.column_data}).on("selected",(function(t,e){if(-1==e.value){var i=s.get("columnIndex");t.setValue(null!==i?i:""),n.onSelectOther(t,s)}else s.set("columnIndex",e.value),r.levelProps=n.props.asc_getLevelProps(e.value),n.updateOrderList(a,s,!0)})),d=s.get("columnIndex");null!==d&&c.setValue(s.get("columnIndex")),r.cmbColumn=c,l.push(c),c.on("show:after",_.bind(this.onShowMenu,this)),c.on("hide:after",_.bind(this.onHideMenu,this)),c=new Common.UI.ComboBox({el:o.find("#sort-dialog-cmb-sort-"+a),editable:!1,cls:"input-group-nr",menuCls:"menu-absolute",takeFocusOnClose:!0,data:this.sort_data}).on("selected",(function(t,e){s.set("sort",e.value),n.updateOrderList(a,s)})),null!==(d=s.get("sort"))&&c.setValue(d),r.cmbSort=c,l.push(c),c.on("show:after",_.bind(this.onShowMenu,this)),c.on("hide:after",_.bind(this.onHideMenu,this));var h=s.get("sort");if(h==Asc.c_oAscSortOptions.ByColorFill||h==Asc.c_oAscSortOptions.ByColorFont){c=new Common.UI.ComboBoxColor({el:o.find("#sort-dialog-btn-color-"+a),editable:!1,menuCls:"menu-absolute",menuStyle:"max-height: 135px;",takeFocusOnClose:!0,data:r.color_data,disabled:!r.color_data||r.color_data.length<1}).on("selected",(function(t,e){s.set("color",e.color)})),d=s.get("color"),c.setValue(d?Common.Utils.ThemeColor.getHexColor(d.get_r(),d.get_g(),d.get_b()).toLocaleUpperCase():-1);var p=c.getSelectedRecord();p&&s.set("color",p.color),r.cmbColor=c,l.push(c),c.on("show:after",_.bind(this.onShowMenu,this)),c.on("hide:after",_.bind(this.onHideMenu,this))}c=new Common.UI.ComboBox({el:o.find("#sort-dialog-cmb-order-"+a),editable:!1,cls:"input-group-nr",menuCls:"menu-absolute",takeFocusOnClose:!0,data:r.order_data}).on("selected",(function(t,e){s.set("order",e.value)})),null!==(d=s.get("order"))&&c.setValue(d),r.cmbOrder=c,l.push(c),c.on("show:after",_.bind(this.onShowMenu,this)),c.on("hide:after",_.bind(this.onHideMenu,this)),o.on("mousedown",".combobox",(function(){n.sortList.selectRecord(s)})),s.set("controls",{combobox:l},{silent:!0}),t&&setTimeout((function(){e.focus()}),1),this.updateLevelCaptions(!0)}},onOptions:function(){var t=this;new SSE.Views.SortOptionsDialog({props:t.sortOptions,handler:function(e,i){if("ok"==e&&i){t.sortList.setHeaderName(0,i.sortcol?t.textColumn:t.textRow),t.props.asc_setHasHeaders(i.headers),t.props.asc_setColumnSort(i.sortcol);var s=t.sortOptions.sortcol==i.sortcol;t.props.asc_updateSortList(s),t.sortOptions=i,t.updateSortValues(s)}}}).on("close",(function(){t.btnOptions.focus()})).show()},fillSortValues:function(){var t=this.props.asc_getSortList(),e=t.length;this.column_data=[];for(var i=0;i<e;i++)null!=t[i]&&this.column_data.push({value:i,displayValue:t[i]});this.column_data.length>=500&&this.column_data.push({value:-1,displayValue:this.sortOptions.sortcol?this.textMoreCols:this.textMoreRows})},updateSortValues:function(t){this.fillSortValues();var e=this;this.sortList.store.each((function(i){var s=t?i.get("columnIndex"):0,n=i.get("levelIndex");t||(i.set("columnIndex",s,{silent:!0}),i.set("color",null,{silent:!0})),e.levels[n].levelProps=null!==s?e.props.asc_getLevelProps(s):void 0,e.addControls(!1,null,null,i),e.updateOrderList(n,i,!0)}))},onAddLevel:function(){var t=this.sortList.store,e=this.sortList.getSelectedRec(),i=1==this.column_data.length?this.column_data[0].value:null,s=this.levels.length;if(null!==i){var n=this.props.asc_getLevelProps(i),a=!n||n.asc_getIsTextData();this.levels[s]={levelProps:n,order_data:[{value:Asc.c_oAscSortOptions.Ascending,displayValue:a?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:a?this.textZA:this.textDesc}]}}(e=t.add({columnIndex:i,levelIndex:s,sort:Asc.c_oAscSortOptions.ByValue,order:Asc.c_oAscSortOptions.Ascending},{at:e?t.indexOf(e)+1:t.length}))&&(this.sortList.selectRecord(e),this.sortList.scrollToRecord(e)),this.updateButtons()},onCopyLevel:function(){var t=this.sortList.store,e=this.sortList.getSelectedRec(),i=this.levels.length,s=this.levels[e?e.get("levelIndex"):null];this.levels[i]={levelProps:s?s.levelProps:null,order_data:s?s.order_data:null,color_data:s?s.color_data:null},(e=t.add({levelIndex:i,columnIndex:e?e.get("columnIndex"):null,sort:e?e.get("sort"):Asc.c_oAscSortOptions.ByValue,order:e?e.get("order"):Asc.c_oAscSortOptions.Ascending,color:e?e.get("color"):null},{at:e?t.indexOf(e)+1:t.length}))&&(this.sortList.selectRecord(e),this.sortList.scrollToRecord(e)),this.updateButtons()},onDeleteLevel:function(){var t=this.sortList.store,e=this.sortList.getSelectedRec();if(e){var i=e.get("levelIndex");this.levels[i]=void 0,i=t.indexOf(e),t.remove(e),t.length>0&&this.sortList.selectByIndex(i<t.length?i:t.length-1),this.sortList.scrollToRecord(this.sortList.getSelectedRec()),this.onHideMenu()}this.updateButtons()},onMoveClick:function(t){var e=this.sortList.store,i=e.length,s=this.sortList.getSelectedRec();if(s){var n=e.indexOf(s);e.add(e.remove(s),{at:t?Math.max(0,n-1):Math.min(i-1,n+1)}),this.sortList.selectRecord(s),this.sortList.scrollToRecord(s),this.onHideMenu()}this.updateMoveButtons(),this.updateLevelCaptions()},onSelectLevel:function(t,e,i,s){if(this.updateMoveButtons(),i&&i.get("controls")){var n=i.get("controls"),a=Common.UI.FocusManager.insert(this,n.combobox,-1*this.getFooterButtons().length);void 0!==a&&(n.index=a),s&&setTimeout((function(){t.focus()}),1)}},onDeselectLevel:function(t,e,i){if(i&&i.get("controls")){var s=i.get("controls");Common.UI.FocusManager.remove(this,s.index,s.combobox.length),s.index=void 0}},onRemoveLevel:function(t,e,i){if(i&&i.get("selected")&&i.get("controls")){var s=i.get("controls");Common.UI.FocusManager.remove(this,s.index,s.combobox.length),s.index=void 0}},beforeLevelsReset:function(t){for(var e=0;e<t.length;e++){var i=t.at(e);if(i){var s=i.get("controls");if(s&&void 0!==s.index){Common.UI.FocusManager.remove(this,s.index,s.combobox.length);break}}}},updateOrderList:function(t,e,i){var s=this.levels[t],n=!s.levelProps||s.levelProps.asc_getIsTextData(),a=s.cmbSort.getValue()!==Asc.c_oAscSortOptions.ByValue,o=s.cmbOrder.getValue();if(s.order_data=[{value:Asc.c_oAscSortOptions.Ascending,displayValue:a?this.sortOptions.sortcol?this.textTop:this.textLeft:n?this.textAZ:this.textAsc},{value:Asc.c_oAscSortOptions.Descending,displayValue:a?this.sortOptions.sortcol?this.textBelow:this.textRight:n?this.textZA:this.textDesc}],s.cmbOrder.setData(s.order_data),s.cmbOrder.setValue(o),a){s.color_data=[];var l,r=e?e.get("color"):null,c=r?Common.Utils.ThemeColor.getHexColor(r.get_r(),r.get_g(),r.get_b()).toLocaleUpperCase():-1;if(s.levelProps){var d=this;(s.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFill?s.levelProps.asc_getColorsFill():s.levelProps.asc_getColorsFont()).forEach((function(t,e){var i=t?Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase():-1,n={value:i,displayValue:t?"":s.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFill?d.textNone:d.textAuto,color:t,styleObj:{"background-color":t?"#"+i:"transparent"},styleStr:t?"background-color: #"+i+";":"background-color:transparent;"};t?s.color_data.push(n):s.color_data.unshift(n),c==n.value&&(l=c)}))}s.cmbColor.setData(s.color_data),s.cmbColor.setDisabled(s.color_data.length<1),s.color_data.length>0&&s.cmbColor.setValue(l&&i?l:s.color_data[0].value);var h=s.cmbColor.getSelectedRecord();h&&e&&e.set("color",h.color)}},getSettings:function(){var t=new Asc.CSortProperties;t.asc_setHasHeaders(this.sortOptions.headers),t.asc_setColumnSort(this.sortOptions.sortcol);var e=this,i=[];return this.sortList.store.each((function(t){var s=t.get("columnIndex"),n=e.levels[t.get("levelIndex")];if(null!==s&&n){var a=new Asc.CSortPropertiesLevel;if(a.asc_setIndex(s),a.asc_setSortBy(n.cmbSort.getValue()),a.asc_setDescending(n.cmbOrder.getValue()),n.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFill||n.cmbSort.getValue()==Asc.c_oAscSortOptions.ByColorFont){var o=n.cmbColor.getSelectedRecord();o&&a.asc_setColor(o.color)}i.push(a)}})),t.asc_setLevels(i),t.asc_setSelection(this.props.asc_getSelection()),t},isListValid:function(){var t=this,e=this.sortList.store.findWhere({columnIndex:null}),i=function(e){t.sortList.focus()};if(e)Common.UI.warning({msg:this.errorEmpty,callback:i});else{for(var s=this.sortList.store,n=s.length,a=0;a<n;a++){for(var o=s.at(a),l=this.levels[o.get("levelIndex")],r=l.cmbSort.getValue(),c=r==Asc.c_oAscSortOptions.ByColorFill||r==Asc.c_oAscSortOptions.ByColorFont?l.cmbColor.getSelectedRecord():null,d=a-1;d>=0;d--){var h=s.at(d),p=this.levels[h.get("levelIndex")];if(o.get("columnIndex")==h.get("columnIndex")&&r==p.cmbSort.getValue()){if(r!=Asc.c_oAscSortOptions.ByColorFill&&r!=Asc.c_oAscSortOptions.ByColorFont){e=l.cmbColumn.getSelectedRecord().displayValue,e=this.errorSameColumnValue.replace("%1",e);break}var u=p.cmbColor.getSelectedRecord();if(c&&u&&c.value==u.value){e=l.cmbColumn.getSelectedRecord().displayValue,e=this.errorSameColumnColor.replace("%1",e);break}}}if(e)break}e&&Common.UI.warning({msg:e,callback:i})}return!e},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||this.onDeleteLevel()},updateButtons:function(){this.btnAdd.setDisabled(this.sortList.store.length>63),this.btnCopy.setDisabled(this.sortList.store.length<1),this.btnDelete.setDisabled(this.sortList.store.length<1),this.updateMoveButtons(),this.updateLevelCaptions(!0),this.sortList.scroller&&this.sortList.scroller.update()},updateMoveButtons:function(){var t=this.sortList.getSelectedRec(),e=t?this.sortList.store.indexOf(t):-1;this.btnUp.setDisabled(e<1),this.btnDown.setDisabled(e<0||e==this.sortList.store.length-1)},updateLevelCaptions:function(t){var e=this.$window.find(".level-caption");e.length<1||(t?e.text(this.textThenBy):e.length>1&&(e[1].innerText=this.textThenBy),e[0].innerText=this.textSortBy)},onSelectOther:function(t,e){var i=this;if(i.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){if("ok"==n){var a,o=s.getSettings();if(_.isEmpty(o)||(a=i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.CustomSort,o,!0,!i.sortOptions.sortcol)),a==Asc.c_oAscError.ID.No){var l=i.props.asc_addBySortList(o);return i.fillSortValues(),t.setData(i.column_data),t.setValue(l),e.set("columnIndex",l),i.levels[e.get("levelIndex")].levelProps=i.props.asc_getLevelProps(l),i.updateOrderList(e.get("levelIndex"),e,!0),!1}return a==Asc.c_oAscError.ID.CustomSortMoreOneSelectedError?Common.UI.warning({msg:i.sortOptions.sortcol?i.errorMoreOneCol:i.errorMoreOneRow}):a==Asc.c_oAscError.ID.CustomSortNotOriginalSelectError?Common.UI.warning({msg:i.sortOptions.sortcol?i.errorNotOriginalCol:i.errorNotOriginalRow}):Common.UI.warning({msg:i.txtInvalidRange}),!0}}}).on("close",(function(){i.show()})),n=Common.Utils.getOffset(i.$window);i.hide(),s.show(i.$window,n),s.setSettings({api:i.api,range:i.props.asc_getRangeStr(),type:Asc.c_oAscSelectionDialogType.CustomSort})}},txtTitle:"Sort",textLevels:"Levels",textBtnNew:"New",textBtnDelete:"Delete",textBtnCopy:"Copy",textColumn:"Column",textRow:"Row",textSort:"Sort on",textOrder:"Order",textUp:"Move level up",textDown:"Move level down",textOptions:"Options",textValues:"Values",textCellColor:"Cell color",textFontColor:"Font color",textAZ:"A to Z",textZA:"Z to A",textDesc:"Descending",textAsc:"Ascending",textTop:"Top",textBelow:"Below",textLeft:"Left",textRight:"Right",errorEmpty:"All sort criteria must have a column or row specified.",textAuto:"Auto",textNone:"None",errorNotOriginalCol:"The column you selected is not in the original selected range.",errorNotOriginalRow:"The row you selected is not in the original selected range.",errorMoreOneRow:"More than one row is selected.",errorMoreOneCol:"More than one column is selected.",txtInvalidRange:"Invalid cells range.",textMoreRows:"(More rows...)",textMoreCols:"(More columns...)",errorSameColumnValue:"%1 is being sorted by values more than once.<br>Delete the duplicate sort criteria and try again.",errorSameColumnColor:"%1 is being sorted by the same color more than once.<br>Delete the duplicate sort criteria and try again.",textSortBy:"Sort by",textThenBy:"Then by"},SSE.Views.SortDialog||{}))})),define("spreadsheeteditor/main/app/view/ViewManagerDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ViewManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ViewManagerDlg",separator:!1,contentWidth:460},initialize:function(t){_.extend(this.options,{title:this.txtTitle,buttons:[{value:"ok",caption:this.textGoTo,primary:!0},"close"],contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">',"<label>"+this.textViews+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<button type="button" class="btn btn-text-default auto margin-right-5" id="view-manager-btn-new" style="min-width: 80px;">'+this.textNew+"</button>",'<button type="button" class="btn btn-text-default auto margin-right-5" id="view-manager-btn-rename" style="min-width: 80px;">'+this.textRename+"</button>",'<button type="button" class="btn btn-text-default auto" id="view-manager-btn-duplicate" style="min-width: 80px;">'+this.textDuplicate+"</button>",'<button type="button" class="btn btn-text-default auto float-right" id="view-manager-btn-delete" style="min-width: 80px;">'+this.textDelete+"</button>","</td>","</tr>","<tr>","<td>",'<div id="view-manager-list" class="range-tableview" style="width:440px; height: 166px;"></div>',"</td>","</tr>","</table>","</div>","</div>"].join(""))({scope:this})},t),this.api=t.api,this.views=t.views||[],this.userTooltip=!0,this.currentView=void 0,this.wrapEvents={onRefreshNamedSheetViewList:_.bind(this.onRefreshNamedSheetViewList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.viewList=new Common.UI.ListView({el:$("#view-manager-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,emptyText:this.textEmpty,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;height: 20px;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div style="width:100%;"><%= Common.Utils.String.htmlEncode(name) %></div>',"<% if (lock) { %>",'<div class="lock-user"><%=Common.Utils.String.htmlEncode(lockuser)%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.viewList.on("item:select",_.bind(this.onSelectItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNew=new Common.UI.Button({el:$("#view-manager-btn-new")}),this.btnNew.on("click",_.bind(this.onNew,this,!1)),this.btnRename=new Common.UI.Button({el:$("#view-manager-btn-rename")}),this.btnRename.on("click",_.bind(this.onRename,this)),this.btnDuplicate=new Common.UI.Button({el:$("#view-manager-btn-duplicate")}),this.btnDuplicate.on("click",_.bind(this.onNew,this,!0)),this.btnDelete=new Common.UI.Button({el:$("#view-manager-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDelete,this)),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},getFocusedComponents:function(){return[this.btnNew,this.btnRename,this.btnDuplicate,this.viewList,this.btnDelete].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.viewList},afterRender:function(){this._setDefaults()},_setDefaults:function(t){this.refreshList(this.views),this.api.asc_registerCallback("asc_onRefreshNamedSheetViewList",this.wrapEvents.onRefreshNamedSheetViewList)},onRefreshNamedSheetViewList:function(){this.refreshList(this.api.asc_getNamedSheetViews(),this.currentView)},refreshList:function(t,e){var i=0;if(t){this.views=t;for(var s=[],n=0;n<this.views.length;n++){var a=this.views[n],o=a.asc_getIsLock();s.push({name:a.asc_getName(!0),active:a.asc_getIsActive(),view:a,lock:null!=o,lockuser:o?this.isUserVisible(o)?this.getUserName(o):this.lockText:this.guestText}),a.asc_getIsActive()&&(i=n)}this.viewList.store.reset(s)}var l=this.viewList.store.length;this.btnRename.setDisabled(!l),this.btnDuplicate.setDisabled(!l),this.btnDelete.setDisabled(!l),this.btnOk.setDisabled(!l),l>0&&(null==e&&(e=i),_.isNumber(e)&&(e>l-1&&(e=l-1),this.viewList.selectByIndex(e),setTimeout((function(){r.viewList.scrollToRecord(r.viewList.store.at(e))}),50)),!0===this.userTooltip&&this.viewList.cmpEl.find(".lock-user").length>0&&this.viewList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)));var r=this;_.delay((function(){r.viewList.cmpEl.find(".listview").focus(),r.viewList.scroller.update({alwaysVisibleY:!0})}),100,this)},onMouseOverLock:function(t,e,i){if(!0===this.userTooltip&&$(t.target).hasClass("lock-user")){var s=this,n=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip");this.userTooltip=n.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),n.show(),setTimeout((function(){s.userTipHide()}),5e3)}},userTipHide:function(){"object"==_typeof(this.userTooltip)&&(this.userTooltip.remove(),this.userTooltip=void 0,this.viewList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==_typeof(this.userTooltip)&&this.userTipHide()},onNew:function(t){var e=t?this.viewList.getSelectedRec().get("view"):void 0;this.currentView=this.viewList.store.length,this.api.asc_addNamedSheetView(e)},onDelete:function(){var t,e=this,i=this.viewList.getSelectedRec();i&&(t=i.get("active")?this.warnDeleteView.replace("%1",Common.Utils.String.htmlEncode(i.get("name"))):this.warnDeleteAnotherView,Common.UI.warning({msg:t,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t&&e.api.asc_deleteNamedSheetViews([i.get("view")])}}))},onRename:function(){var t=this.viewList.getSelectedRec();if(t){var e=this;new Common.Views.TextInputDialog({label:e.textRenameLabel,value:t.get("name"),inputConfig:{allowBlank:!1,blankError:e.textRenameError,validation:function(t){return t.length<128||e.textLongName}},handler:function(e,i){"ok"==e&&t.get("view").asc_setName(i)}}).on("close",(function(){e.getDefaultFocusableComponent().focus()})).show()}},getSettings:function(){var t=this.viewList.getSelectedRec();return t?t.get("name"):null},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return AscCommon.UserInfoParser.getParsedName(i.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},onSelectItem:function(t,e,i){if(i){this.userTipHide();var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON(),this.currentView=_.indexOf(this.viewList.store.models,i),this.btnRename.setDisabled(s.lock),this.btnDelete.setDisabled(s.lock)}}},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onRefreshNamedSheetViewList",this.wrapEvents.onRefreshNamedSheetViewList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||this.onDelete()},onDblClickItem:function(t,e,i){this.onPrimary()},onPrimary:function(){return!this.btnOk.isDisabled()&&(this.handler&&this.handler.call(this,"ok",this.getSettings())?void 0:(this.close(),!1))},txtTitle:"Sheet View Manager",textViews:"Sheet views",closeButtonText:"Close",textNew:"New",textRename:"Rename",textDuplicate:"Duplicate",textDelete:"Delete",textGoTo:"Go to view",textEmpty:"No views have been created yet.",guestText:"Guest",tipIsLocked:"This element is being edited by another user.",textRenameLabel:"Rename view",textRenameError:"View name must not be empty.",warnDeleteView:"You are trying to delete the currently enabled view '%1'.<br>Close this view and delete it?",warnDeleteAnotherView:"Are you sure you want to delete this sheet view?",textLongName:"Enter a name that is less than 128 characters.",lockText:"Locked"},SSE.Views.ViewManagerDlg||{}))})),define("spreadsheeteditor/main/app/view/ChartTypeDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";var t=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",(function(){e.render(),e.trigger("change",e,e.model)})),e.listenTo(e.model,"change:selected",(function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))})),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.ChartTypeDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,contentHeight:300,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-large">','<label class="header">',this.textType,"</label>",'<div id="chart-type-dlg-button-type" style=""></div>',"</td>","</tr>",'<tr class="simple-chart">','<td class="padding-small">','<label class="header">',this.textStyle,"</label>",'<div id="chart-type-dlg-styles-list" class="" style="width:100%; height: 176px;"></div>',"</td>","</tr>",'<tr class="combined-chart">','<td class="padding-small">','<div id="chart-type-dlg-series-list" class="" style="width:100%; height: 203px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.currentChartType=Asc.c_oAscChartTypeSettings.barNormal,this.wrapEvents={onAddChartStylesPreview:_.bind(this.onAddChartStylesPreview,this)},this.api.asc_registerCallback("asc_onAddChartStylesPreview",this.wrapEvents.onAddChartStylesPreview)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var e=this,i=Common.define.chartData.getChartGroupData();this._arrSeriesGroups=[],i.forEach((function(t){"menu-chart-group-combo"!==t.id&&"menu-chart-group-stock"!==t.id&&e._arrSeriesGroups.push(t)})),i=Common.define.chartData.getChartData(),this._arrSeriesType=[],i.forEach((function(t){!t.is3d&&t.type!==Asc.c_oAscChartTypeSettings.stock&&t.type!==Asc.c_oAscChartTypeSettings.comboBarLine&&t.type!==Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&t.type!==Asc.c_oAscChartTypeSettings.comboAreaBar&&t.type!==Asc.c_oAscChartTypeSettings.comboCustom&&e._arrSeriesType.push(t)})),this.btnChartType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-bar-normal",menu:new Common.UI.Menu({style:"width: 364px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="chart-type-dlg-menu-type" class="menu-insertchart"></div>')}]}),takeFocusOnClose:!0}),this.btnChartType.on("render:after",(function(t){e.mnuChartTypePicker=new Common.UI.DataView({el:$("#chart-type-dlg-menu-type",e.$window),parentMenu:t.menu,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(i),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})})),this.btnChartType.render($("#chart-type-dlg-button-type"),this.$window),this.mnuChartTypePicker.on("item:click",_.bind(this.onSelectType,this)),this.stylesList=new Common.UI.DataView({el:$("#chart-type-dlg-styles-list",this.$window),store:new Common.UI.DataViewStore,cls:"bordered",itemTemplate:_.template(['<div class="style" id="<%= id %>">','<img src="<%= imageUrl %>" width="50" height="50" <% if(typeof imageUrl === "undefined" || imageUrl===null || imageUrl==="") { %> style="visibility: hidden;" <% } %>/>','<% if (typeof title !== "undefined") {%>','<span class="title"><%= title %></span>',"<% } %>","</div>"].join("")),delayRenderTips:!0,tabindex:1}),this.stylesList.on("item:select",_.bind(this.onSelectStyles,this)),this.stylesList.on("entervalue",_.bind(this.onPrimary,this)),this.seriesList=new Common.UI.ListView({el:$("#chart-type-dlg-series-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,headers:[{name:e.textSeries,width:108},{name:e.textType,width:105},{name:e.textSecondary,width:123,style:"text-align: center;"}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;" id="chart-type-dlg-item-<%= seriesIndex %>">','<div class="series-color" id="chart-type-dlg-series-preview-<%= seriesIndex %>"></div>','<div class="series-value"><%= Common.Utils.String.htmlEncode(value) %></div>','<div class="series-cmb"><div id="chart-type-dlg-cmb-series-<%= seriesIndex %>" class="input-group-nr" style=""></div></div>','<div class="series-chk"><div id="chart-type-dlg-chk-series-<%= seriesIndex %>" style=""></div></div>',"</div>"].join("")),tabindex:1}),this.seriesList.createNewItem=function(e){return new t({template:this.itemTemplate,model:e})},this.NotCombinedSettings=$(".simple-chart",this.$window),this.CombinedSettings=$(".combined-chart",this.$window),this.afterRender()},afterRender:function(){this._setDefaults(this.chartSettings)},getFocusedComponents:function(){return[this.btnChartType,this.stylesList,this.seriesList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.btnChartType},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},close:function(){this.api.asc_onCloseChartFrame(),this.api.asc_unregisterCallback("asc_onAddChartStylesPreview",this.wrapEvents.onAddChartStylesPreview),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},_setDefaults:function(t){if(t){this.chartSettings=t,this.currentChartType=t.getType();var e=this.mnuChartTypePicker.store.findWhere({type:this.currentChartType});if(this.mnuChartTypePicker.selectRecord(e,!0),e)this.btnChartType.setIconCls("svgicon chart-"+e.get("iconCls"));else{var i="";switch(this.currentChartType){case Asc.c_oAscChartTypeSettings.surfaceNormal:i="chart-surface-normal";break;case Asc.c_oAscChartTypeSettings.surfaceWireframe:i="chart-surface-wireframe";break;case Asc.c_oAscChartTypeSettings.contourNormal:case Asc.c_oAscChartTypeSettings.contourWireframe:i="chart-contour-wireframe"}this.btnChartType.setIconCls("svgicon "+i)}this.seriesList.on("item:add",_.bind(this.addControls,this)),this.seriesList.on("item:change",_.bind(this.addControls,this)),this.seriesList.on("item:select",_.bind(this.onSelectSeries,this)),this.seriesList.on("item:deselect",_.bind(this.onDeselectSeries,this)),this.seriesList.on("entervalue",_.bind(this.onPrimary,this)),this.ShowHideSettings(this.currentChartType),this.currentChartType==Asc.c_oAscChartTypeSettings.comboBarLine||this.currentChartType==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||this.currentChartType==Asc.c_oAscChartTypeSettings.comboAreaBar||this.currentChartType==Asc.c_oAscChartTypeSettings.comboCustom?this.updateSeriesList(this.chartSettings.getSeries()):(this.updateChartStyles(this.api.asc_getChartPreviews(this.currentChartType,void 0,!0)),this.api.asc_generateChartPreviews(this.currentChartType))}},getSettings:function(){return{chartSettings:this.chartSettings}},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onSelectType:function(t,e,i){var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON()}else s=i;var n=s.type==Asc.c_oAscChartTypeSettings.comboBarLine||s.type==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||s.type==Asc.c_oAscChartTypeSettings.comboAreaBar||s.type==Asc.c_oAscChartTypeSettings.comboCustom;n&&this.chartSettings.getSeries().length<2?Common.UI.warning({msg:this.errorComboSeries,maxwidth:600}):this.chartSettings.changeType(s.type)?(this.btnChartType.setIconCls("svgicon chart-"+s.iconCls),this.currentChartType=s.type,this.ShowHideSettings(this.currentChartType),n?this.updateSeriesList(this.chartSettings.getSeries()):(this.updateChartStyles(this.api.asc_getChartPreviews(this.currentChartType,void 0,!0)),this.api.asc_generateChartPreviews(this.currentChartType))):t.selectRecord(t.store.findWhere({type:this.currentChartType}),!0)},updateChartStyles:function(t){var e=this;if(t&&t.length>0){var i=this.stylesList.store;if(i){var s=[];_.each(t,(function(t,i){s.push({imageUrl:t.asc_getImage(),data:t.asc_getName(),tip:e.textStyle+" "+t.asc_getName()})})),i.reset(s,{silent:!1})}}else this.stylesList.store.reset();this.stylesList.setDisabled(!t||t.length<1)},onSelectStyles:function(t,e,i){i&&this.chartSettings.putStyle(i.get("data"))},onAddChartStylesPreview:function(t){if(t&&t.length>0){var e=this.stylesList.store;e&&_.each(t,(function(t,i){var s=e.findWhere({data:t.asc_getName()});s&&s.set("imageUrl",t.asc_getImage())}))}},updateSeriesList:function(t,e){var i=this,s=[],n=this.seriesList.store;this.beforeSeriesReset(n);for(var a=0,o=t.length;a<o;a++){var l=t[a],r=new Common.UI.DataViewModel;r.set({value:l.asc_getSeriesName(),type:l.asc_getChartType(),isSecondary:l.asc_getIsSecondaryAxis(),canChangeSecondary:l.asc_canChangeAxisType(),seriesIndex:a,series:l}),s.push(r)}n.reset(s),s.length>0&&void 0!==e&&e<s.length&&this.seriesList.selectByIndex(e),s.length>0&&void 0!==e&&(e<s.length&&this.seriesList.selectByIndex(e),setTimeout((function(){i.seriesList.focus()}),10))},addControls:function(t,e,i){if(i){var s=this,n=i.get("seriesIndex"),a=this.seriesList.cmpEl.find("#chart-type-dlg-item-"+n),o=i.get("series");o.asc_drawPreviewRect("chart-type-dlg-series-preview-"+n);var l=this.initSeriesType("#chart-type-dlg-cmb-series-"+n,n,i),r=new Common.UI.CheckBox({el:a.find("#chart-type-dlg-chk-series-"+n),value:i.get("isSecondary"),disabled:!i.get("canChangeSecondary")});r.on("change",(function(t,e,i,a){o.asc_TryChangeAxisType("checked"==t.getValue())!==Asc.c_oAscError.ID.No?t.setValue("checked"!=t.getValue(),!0):s.updateSeriesList(s.chartSettings.getSeries(),n)})),a.on("mousedown",".combobox",(function(){s.seriesList.selectRecord(i)})),i.set("controls",{checkbox:r,combobox:l},{silent:!0})}},onDeselectSeries:function(t,e,i){if(i&&i.get("controls")){var s=i.get("controls");Common.UI.FocusManager.remove(this,s.index,2),s.index=void 0}},onSelectSeries:function(t,e,i,s){if(i&&i.get("controls")){var n=i.get("controls"),a=Common.UI.FocusManager.insert(this,[n.combobox,n.checkbox],-1*this.getFooterButtons().length);void 0!==a&&(n.index=a),s&&setTimeout((function(){t.focus()}),1)}},beforeSeriesReset:function(t){for(var e=0;e<t.length;e++){var i=t.at(e);if(i){var s=i.get("controls");if(s&&void 0!==s.index){Common.UI.FocusManager.remove(this,s.index,2);break}}}},initSeriesType:function(t,e,i){var s=this,n=i.get("series"),a=new Common.UI.DataViewStore(s._arrSeriesType),o=a.findWhere({type:i.get("type")}),l=$(t),r=new Common.UI.ComboBoxDataView({el:l,additionalAlign:this.menuAddAlign,cls:"move-focus",menuCls:"menu-absolute",menuStyle:"width: 318px;",dataViewCls:"menu-insertchart",restoreHeight:535,groups:new Common.UI.DataViewGroupStore(s._arrSeriesGroups),store:a,formTemplate:_.template(['<input type="text" class="form-control" spellcheck="false">'].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:function(t){$(this.el).find("input").val(t?t.get("tip"):"")}});return r.selectRecord(o),r.on("item:click",(function(t,a,o,l){var r=i.get("type"),c=n.asc_TryChangeChartType(l.get("type"));if(c===Asc.c_oAscError.ID.No)t.selectRecord(l),s.updateSeriesList(s.chartSettings.getSeries(),e);else{var d=a.store.findWhere({type:r});a.selectRecord(d,!0),c===Asc.c_oAscError.ID.SecondaryAxis&&Common.UI.warning({msg:s.errorSecondaryAxis,maxwidth:500})}})),r},ShowHideSettings:function(t){var e=t==Asc.c_oAscChartTypeSettings.comboBarLine||t==Asc.c_oAscChartTypeSettings.comboBarLineSecondary||t==Asc.c_oAscChartTypeSettings.comboAreaBar||t==Asc.c_oAscChartTypeSettings.comboCustom;this.NotCombinedSettings.toggleClass("hidden",e),this.CombinedSettings.toggleClass("hidden",!e)},textTitle:"Chart Type",textType:"Type",textStyle:"Style",textSeries:"Series",textSecondary:"Secondary Axis",errorSecondaryAxis:"The selected chart type requires the secondary axis that an existing chart is using. Select another chart type.",errorComboSeries:"To create a combination chart, select at least two series of data."},SSE.Views.ChartTypeDialog||{}))})),define("spreadsheeteditor/main/app/view/ExternalLinksDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ExternalLinksDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ExternalLinksDlg",contentWidth:510,separator:!1,buttons:["close"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 10px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<div id="external-links-btn-update" class="float-left margin-right-5"></div>','<div id="external-links-btn-change" class="float-left margin-right-5"></div>','<div id="external-links-btn-open" class="float-left margin-right-5"></div>','<div id="external-links-btn-delete" class="float-left"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="external-links-list" class="range-tableview" style="width:100%; height: 171px;"></div>',"</td>","</tr>","<tr>",'<td class="">','<div id="external-links-auto-update"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.isUpdating=t.isUpdating||!1,this.canRequestReferenceData=t.canRequestReferenceData||!1,this.canRequestOpen=t.canRequestOpen||!1,this.canRequestReferenceSource=t.canRequestReferenceSource||!1,this.isOffline=t.isOffline||!1,this.linkStatus=[],this.wrapEvents={onUpdateExternalReferenceList:_.bind(this.refreshList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.linksList=new Common.UI.ListView({el:$("#external-links-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,headers:[{name:this.textSource,width:240},{name:this.textStatus,width:175}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:240px;" data-toggle="tooltip"><%= value %></div>','<div style="width:175px;" data-toggle="tooltip"><%= status %></div>',"</div>"].join("")),tabindex:1}),this.linksList.on("item:add",_.bind(this.addTooltips,this)),this.linksList.on("item:change",_.bind(this.addTooltips,this)),this.linksList.on("reset:before",_.bind(this.resetItemsBefore,this)),this.btnUpdate=new Common.UI.Button({parentEl:$("#external-links-btn-update",this.$window),cls:"btn-text-split-default auto",caption:this.textUpdate,split:!0,visible:!!this.canRequestReferenceData,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textUpdate,value:0},{caption:this.textUpdateAll,value:1}]}),takeFocusOnClose:!0});var t=$(this.btnUpdate.cmpEl.find("button")[0]);t.css("min-width",Math.max(87,t.outerWidth())+"px"),this.btnUpdate.on("click",_.bind(this.onUpdate,this)),this.btnUpdate.menu.on("item:click",_.bind(this.onUpdateMenu,this)),this.btnDelete=new Common.UI.Button({parentEl:$("#external-links-btn-delete",this.$window),cls:"btn-text-split-default auto",caption:this.textDelete,split:!0,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textDelete,value:0},{caption:this.textDeleteAll,value:1}]}),takeFocusOnClose:!0}),$(this.btnDelete.cmpEl.find("button")[0]).css("min-width","87px"),this.btnDelete.on("click",_.bind(this.onDelete,this)),this.btnDelete.menu.on("item:click",_.bind(this.onDeleteMenu,this)),this.btnOpen=new Common.UI.Button({parentEl:$("#external-links-btn-open",this.$window),cls:"btn-text-default auto",caption:this.textOpen,visible:!!this.canRequestOpen}),this.btnOpen.on("click",_.bind(this.onOpen,this)),this.btnChange=new Common.UI.Button({parentEl:$("#external-links-btn-change",this.$window),cls:"btn-text-default auto",caption:this.textChange,visible:!!this.canRequestReferenceSource}),this.btnChange.on("click",_.bind(this.onChange,this)),this.chUpdate=new Common.UI.CheckBox({el:$("#external-links-auto-update"),labelText:this.textAutoUpdate}),this.chUpdate.on("change",_.bind((function(t,e,i,s){this.api&&this.api.asc_setUpdateLinks("checked"===t.getValue())}),this)),this.afterRender()},afterRender:function(){this._setDefaults(),this.api.asc_registerCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),this.isUpdating&&this.setIsUpdating(this.isUpdating,!0)},getFocusedComponents:function(){return[this.btnUpdate,this.btnChange,this.btnOpen,this.btnDelete,this.linksList,this.chUpdate].concat(this.getFooterButtons())},close:function(){this.api.asc_unregisterCallback("asc_onUpdateExternalReferenceList",this.wrapEvents.onUpdateExternalReferenceList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},getDefaultFocusableComponent:function(){return this.linksList},_setDefaults:function(t){this.refreshList(),this.api&&this.chUpdate.setValue(this.api.asc_getUpdateLinks(),!0)},refreshList:function(){var t=[],e=this.api.asc_getExternalReferences();if(e)for(var i=0;i<e.length;i++)t.push({linkid:e[i].asc_getId(),value:(e[i].asc_getSource()||"").replace(new RegExp("%20","g")," "),idx:i,externalRef:e[i],status:this.linkStatus[e[i].asc_getId()]||this.textUnknown});this.linksList.store.reset(t),this.linksList.store.length>0&&this.linksList.selectByIndex(0),this.updateButtons()},onUpdate:function(){if(!this.isUpdating){var t=this.linksList.getSelectedRec();t&&(this.isOffline&&this.setLinkStatus(t.get("linkid"),this.textOk),this.api.asc_updateExternalReferences([t.get("externalRef")]))}},onUpdateMenu:function(t,e){if(!this.isUpdating)if(1==e.value){var i=[],s=this;this.linksList.store.each((function(t){i.push(t.get("externalRef")),s.isOffline&&s.setLinkStatus(t.get("linkid"),s.textOk)}),this),i.length>0&&this.api.asc_updateExternalReferences(i)}else this.onUpdate()},onDelete:function(){if(!this.isUpdating){var t=this.linksList.getSelectedRec();t&&this.api.asc_removeExternalReferences([t.get("externalRef")]),this.refreshList()}},onDeleteMenu:function(t,e){if(!this.isUpdating)if(1==e.value){var i=[];this.linksList.store.each((function(t){i.push(t.get("externalRef"))}),this),i.length>0&&this.api.asc_removeExternalReferences(i),this.refreshList()}else this.onDelete()},onOpen:function(){var t=this.linksList.getSelectedRec();if(t){var e=this.api.asc_openExternalReference(t.get("externalRef"));if(e){switch(e.asc_getType()){case Asc.c_oAscExternalReferenceType.link:e={link:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.path:e={path:e.asc_getData()};break;case Asc.c_oAscExternalReferenceType.referenceData:e={referenceData:e.asc_getData(),path:e.asc_getPath()}}e.windowName="wname-"+Date.now(),window.open("",e.windowName),Common.Gateway.requestOpen(e)}}},onChange:function(){var t=this.linksList.getSelectedRec();t&&(this.isOffline?this.api.asc_changeExternalReference(t.get("externalRef")):this.fireEvent("change:source",this,t.get("externalRef")))},updateButtons:function(){var t=this.linksList.store.length>0&&!!this.linksList.getSelectedRec();this.btnUpdate.setDisabled(!t||this.isUpdating),this.btnDelete.setDisabled(!t||this.isUpdating),this.btnOpen.setDisabled(!t||this.isUpdating),this.btnChange.setDisabled(!t||this.isUpdating)},setIsUpdating:function(t,e){if(e=e||!t,this.isUpdating=t,!t&&this.timerId&&(clearTimeout(this.timerId),this.timerId=0),e)this.updateButtons(),this.btnUpdate.setCaption(t?this.textUpdating:this.textUpdate);else if(!this.timerId){var i=this;i.timerId=setTimeout((function(){i.updateButtons(),i.btnUpdate.setCaption(t?i.textUpdating:i.textUpdate)}),500)}!t&&this.refreshList()},setLinkStatus:function(t,e){t&&(this.linkStatus[t]=e||this.textOk)},resetItemsBefore:function(t){t.dataViewItems&&_.each(t.dataViewItems,(function(t){t.tipsArray&&t.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}))}),this)},addTooltips:function(t,e,i){e.tipsArray&&e.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}));var s=document.createElement("span"),n=Common.UI.Themes.getThemeProps("font");s.style.fontSize=n&&n.size?n.size:"11px",s.style.fontFamily=n&&n.name?n.name:'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.fontFamily=document.documentElement.style.getPropertyValue("--font-family-base-custom")||'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",document.body.appendChild(s);var a=$(e.el).find(".list-item > div");this.checkTextOfItem(s,e,$(a[0]),i.get("value"),this.linksList.options.headers[0].width),this.checkTextOfItem(s,e,$(a[1]),i.get("status"),this.linksList.options.headers[1].width),document.body.removeChild(s),e.tipsArray=[]},checkTextOfItem:function(t,e,i,s,n){t.innerHTML=s;var a=this.linksList;t.offsetWidth>n&&i.one("mouseenter",(function(t){var i=$(t.target);i.tooltip({title:s,placement:"cursor",zIndex:a.tipZIndex}),i.mouseenter(),e.tipsArray.push(i.data("bs.tooltip"))}))},txtTitle:"External Links",textUpdate:"Update Values",textUpdateAll:"Update All",textSource:"Source",closeButtonText:"Close",textDelete:"Break Links",textDeleteAll:"Break All Links",textOpen:"Open Source",textChange:"Change Source",textStatus:"Status",textOk:"OK",textUnknown:"Unknown",textUpdating:"Updating...",textAutoUpdate:"Update automatically"},SSE.Views.ExternalLinksDlg||{}))})),define("text!spreadsheeteditor/main/app/template/FormatRulesEditDlg.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n    <table cols="1" role="presentation">\n        <tr>\n            <td class="padding-small">\n                <div class="rule margin-right-10 display-inline-block-top">\n                    <label class="header"><%= scope.textRule %></label>\n                    <div id="format-rules-edit-combo-category" class="input-group-nr"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-large">\n                <div id="format-rules-edit-combo-rule" class="input-group-nr margin-right-10 display-inline-block-top"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-txt-r1" class="margin-right-10 display-inline-block-top"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-txt-r2" class="display-inline-block-top"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-spin-rank" class="display-inline-block-top margin-right-10"></div>\x3c!--\n                --\x3e<div id="format-rules-edit-combo-percent" class="display-inline-block-top"></div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-small">\n                <label class="header"><%= scope.textFormat %></label>\n                <div>\n                    <div id="format-rules-format-preset" class="input-group-nr display-inline-block-middle"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="hasformat">\n            <td class="padding-large">\n                <div class="scaling-flex-row">\n                    <div id="format-rules-bold" class="display-inline-block-middle"></div>\n                    <div id="format-rules-italic" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-underline" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-strikeout" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-fontcolor" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-fillcolor" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-borders" class="margin-left-3 display-inline-block-middle"></div>\n                    <div id="format-rules-edit-combo-num-format" class="input-group-nr margin-left-3 display-inline-block-middle"></div>\x3c!--\n                    --\x3e<button type="button" class="btn btn-text-default auto margin-left-10 display-inline-block-middle" id="format-rules-edit-btn-clear"><%= scope.textClear %></button>\n                    </div>\n                </td>\n            </tr>\n        <tr class="hasformat">\n            <td class="padding-small">\n                <label class="header"><%= scope.textPreview %></label>\n                <div class="edit-preview-format">\n                    <div id="format-rules-edit-preview-format"></div>\n                    </div>\n                </td>\n            </tr>\n        <tr class="scale">\n            <td class="padding-large scale-container">\n                <div class="scale-1 margin-right-10">\n                    <label><%= scope.textMinpoint %></label>\n                    <div id="format-rules-edit-combo-scale-1" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-1"></div>\n                    <div id="format-rules-edit-color-scale-1"></div>\n                </div>\x3c!--\n                --\x3e<div class="scale-2 margin-right-10">\n                    <label id="format-rules-edit-lbl-scale-2"><%= scope.textMidpoint %></label>\n                    <div id="format-rules-edit-combo-scale-2" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-2"></div>\n                    <div id="format-rules-edit-color-scale-2"></div>\n                </div>\x3c!--\n                --\x3e<div class="scale-3">\n                    <label><%= scope.textMaxpoint %></label>\n                    <div id="format-rules-edit-combo-scale-3" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-scale-3"></div>\n                    <div id="format-rules-edit-color-scale-3"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="scale">\n            <td colspan="3" class="padding-small">\n                <label class="header"><%= scope.textPreview %></label>\n                <div class="preview-scale">\n                    <div id="format-rules-edit-preview-scale"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-large databar-container">\n                <div class="bar-1 margin-right-10">\n                    <label style="display: block;"><%= scope.textMinimum %></label>\n                    <div id="format-rules-edit-combo-bar-1" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-bar-1"></div>\n                </div>\x3c!--\n                 --\x3e<div class="bar-2">\n                    <label style="display: block;"><%= scope.textMaximum %></label>\n                    <div id="format-rules-edit-combo-bar-2" class="input-group-nr"></div>\n                    <div id="format-rules-edit-txt-bar-2"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-very-small">\n                <label class="header"><%= scope.textAppearance %></label>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-large">\n                <div class="fill margin-right-10">\n                    <label><%= scope.textFill %></label>\n                    <div id="format-rules-edit-combo-fill" class="input-group-nr"></div>\n                    <div class="color-pos-fill">\n                        <label><%= scope.textPositive %></label>\n                        <div id="format-rules-edit-color-pos-fill" class="float-right"></div>\n                    </div>\n                    <div class="color-neg-fill">\n                        <label style="margin-top: 4px;"><%= scope.textNegative %></label>\n                        <div id="format-rules-edit-color-neg-fill" class="float-right"></div>\n                    </div>\n                    <div id="format-rules-edit-chk-fill"></div>\n                </div>\x3c!--\n                --\x3e<div class="border margin-right-10">\n                    <label><%= scope.textBorder %></label>\n                    <div id="format-rules-edit-combo-border" class="input-group-nr"></div>\n                    <div class="color-pos-border">\n                        <label><%= scope.textPositive %></label>\n                        <div id="format-rules-edit-color-pos-border" class="float-right"></div>\n                        </div>\n                    <div class="color-neg-border">\n                        <label><%= scope.textNegative %></label>\n                        <div id="format-rules-edit-color-neg-border" class="float-right"></div>\n                        </div>\n                    <div id="format-rules-edit-chk-border"></div>\n                </div>\x3c!--\n                --\x3e<div class="direction">\n                    <label><%= scope.textBarDirection %></label>\n                    <div id="format-rules-edit-combo-direction" class="input-group-nr"></div>\n                    <div id="format-rules-edit-chk-show-bar"></div>\n                </div>\n            </td>\n        </tr>\n        <tr class="databar">\n            <td class="padding-small">\n                <div class="axis float-left">\n                    <label class="header"><%= scope.textAxis %></label>\n                    <label class="position-label margin-right-10"><%= scope.textPosition %></label>\n                    <div id="format-rules-edit-combo-axis-pos" class="input-group-nr margin-right-10 display-inline-block-middle"></div>\n                    <div id="format-rules-edit-color-axis-color" class="display-inline-block-middle"></div>\n                    </div>\n                <div class="preview float-right">\n                    <label class="header"><%= scope.textPreview %></label>\n                    <div class="preview-databar">\n                        <div id="format-rules-edit-preview-databar"></div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        <tr class="iconset">\n            <td>\n                <table role="presentation">\n                    <tr>\n                        <td class="padding-large icon-style">\n                            <label class="header"><%= scope.textIconStyle %></label>\n                            <div>\n                                <div id="format-rules-icon-style" class="input-group-nr display-inline-block-middle"></div>\n                                <div id="format-rules-edit-chk-icon-show" class="margin-left-10 display-inline-block-middle"></div>\n                                <button type="button" class="btn btn-text-default auto float-right" id="format-rules-edit-btn-icon-reverse"><%= scope.textReverse %></button>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr class="icons-5">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-5" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-5" class="iconset-label margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-5" class="input-group-nr margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-5" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-5" class="input-group-nr display-inline-block-middle"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-4">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-4" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-4" class="iconset-label margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-4" class="input-group-nr margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-4" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-4" class="input-group-nr display-inline-block-middle"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-3">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-3" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-3" class="iconset-label margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-3" class="input-group-nr margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-3" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-3" class="input-group-nr display-inline-block-middle"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-2">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-2" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-2" class="iconset-label margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-2" class="input-group-nr margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-2" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-2" class="input-group-nr display-inline-block-middle"></div>\n                        </td>\n                    </tr>\n                    <tr class="icons-1">\n                        <td class="padding-small">\n                            <div id="format-rules-combo-icon-1" class="margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-txt-icon-1" class="iconset-label margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-op-1" class="input-group-nr hidden margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-txt-value-1" class="hidden margin-right-5 display-inline-block-middle"></div>\x3c!--\n                            --\x3e<div id="format-rules-edit-combo-type-1" class="input-group-nr hidden display-inline-block-middle"></div>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n    </div>\n</div>\n'})),define("spreadsheeteditor/main/app/view/FormatRulesEditDlg",["text!spreadsheeteditor/main/app/template/FormatRulesEditDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{},SSE.Views.FormatRulesEditDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"FormatRulesEditDlg",contentWidth:491,id:"window-format-rules"},initialize:function(e){_.extend(this.options,{title:this.txtTitleNew,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.isEdit=e.isEdit||!1,this.props=e.props,this.type=e.type,this.subtype=e.subtype,this.percent=e.percent,this.langId=e.langId,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.dataValTypes=[{value:Asc.c_oAscCfvoType.Number,displayValue:this.txtNumber},{value:Asc.c_oAscCfvoType.Percent,displayValue:this.textPercent},{value:Asc.c_oAscCfvoType.Formula,displayValue:this.textFormula},{value:Asc.c_oAscCfvoType.Percentile,displayValue:this.textPercentile}];var e=[{name:Common.define.conditionalData.textValue,type:Asc.c_oAscCFType.cellIs,rules:[{name:Common.define.conditionalData.textGreater,subtype:Asc.c_oAscCFOperator.greaterThan},{name:Common.define.conditionalData.textGreaterEq,subtype:Asc.c_oAscCFOperator.greaterThanOrEqual},{name:Common.define.conditionalData.textLess,subtype:Asc.c_oAscCFOperator.lessThan},{name:Common.define.conditionalData.textLessEq,subtype:Asc.c_oAscCFOperator.lessThanOrEqual},{name:Common.define.conditionalData.textEqual,subtype:Asc.c_oAscCFOperator.equal},{name:Common.define.conditionalData.textNotEqual,subtype:Asc.c_oAscCFOperator.notEqual},{name:Common.define.conditionalData.textBetween,subtype:Asc.c_oAscCFOperator.between},{name:Common.define.conditionalData.textNotBetween,subtype:Asc.c_oAscCFOperator.notBetween}]},{name:Common.define.conditionalData.textTop+"/"+Common.define.conditionalData.textBottom,type:Asc.c_oAscCFType.top10,rules:[{name:Common.define.conditionalData.textTop,subtype:0},{name:Common.define.conditionalData.textBottom,subtype:1}]},{name:Common.define.conditionalData.textAverage,type:Asc.c_oAscCFType.aboveAverage,rules:[{name:Common.define.conditionalData.textAbove,subtype:0},{name:Common.define.conditionalData.textBelow,subtype:1},{name:Common.define.conditionalData.textEqAbove,subtype:2},{name:Common.define.conditionalData.textEqBelow,subtype:3},{name:Common.define.conditionalData.text1Above,subtype:4},{name:Common.define.conditionalData.text1Below,subtype:5},{name:Common.define.conditionalData.text2Above,subtype:6},{name:Common.define.conditionalData.text2Below,subtype:7},{name:Common.define.conditionalData.text3Above,subtype:8},{name:Common.define.conditionalData.text3Below,subtype:9}]},{name:Common.define.conditionalData.textText,type:Asc.c_oAscCFType.containsText,rules:[{name:Common.define.conditionalData.textContains,type:Asc.c_oAscCFType.containsText},{name:Common.define.conditionalData.textNotContains,type:Asc.c_oAscCFType.notContainsText},{name:Common.define.conditionalData.textBegins,type:Asc.c_oAscCFType.beginsWith},{name:Common.define.conditionalData.textEnds,type:Asc.c_oAscCFType.endsWith}]},{name:Common.define.conditionalData.textDate,type:Asc.c_oAscCFType.timePeriod,rules:[{name:Common.define.conditionalData.textYesterday,subtype:Asc.c_oAscTimePeriod.yesterday},{name:Common.define.conditionalData.textToday,subtype:Asc.c_oAscTimePeriod.today},{name:Common.define.conditionalData.textTomorrow,subtype:Asc.c_oAscTimePeriod.tomorrow},{name:Common.define.conditionalData.textLast7days,subtype:Asc.c_oAscTimePeriod.last7Days},{name:Common.define.conditionalData.textLastWeek,subtype:Asc.c_oAscTimePeriod.lastWeek},{name:Common.define.conditionalData.textThisWeek,subtype:Asc.c_oAscTimePeriod.thisWeek},{name:Common.define.conditionalData.textNextWeek,subtype:Asc.c_oAscTimePeriod.nextWeek},{name:Common.define.conditionalData.textLastMonth,subtype:Asc.c_oAscTimePeriod.lastMonth},{name:Common.define.conditionalData.textThisMonth,subtype:Asc.c_oAscTimePeriod.thisMonth},{name:Common.define.conditionalData.textNextMonth,subtype:Asc.c_oAscTimePeriod.nextMonth}]},{name:Common.define.conditionalData.textBlank+"/"+Common.define.conditionalData.textError,type:Asc.c_oAscCFType.containsBlanks,rules:[{name:Common.define.conditionalData.textBlanks,type:Asc.c_oAscCFType.containsBlanks},{name:Common.define.conditionalData.textNotBlanks,type:Asc.c_oAscCFType.notContainsBlanks},{name:Common.define.conditionalData.textErrors,type:Asc.c_oAscCFType.containsErrors},{name:Common.define.conditionalData.textNotErrors,type:Asc.c_oAscCFType.notContainsErrors}]},{name:Common.define.conditionalData.textDuplicate+"/"+Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.duplicateValues,rules:[{name:Common.define.conditionalData.textDuplicate,type:Asc.c_oAscCFType.duplicateValues},{name:Common.define.conditionalData.textUnique,type:Asc.c_oAscCFType.uniqueValues}]},{name:this.text2Scales,type:Asc.c_oAscCFType.colorScale,num:2},{name:this.text3Scales,type:Asc.c_oAscCFType.colorScale,num:3},{name:Common.define.conditionalData.textDataBar,type:Asc.c_oAscCFType.dataBar},{name:Common.define.conditionalData.textIconSets,type:Asc.c_oAscCFType.iconSet},{name:Common.define.conditionalData.textFormula,type:Asc.c_oAscCFType.expression}],i=[],s=[];_.each(e,(function(t,e){var n=[];t.rules&&_.each(t.rules,(function(t,e){n.push({name:t.name,type:t.type,subtype:t.subtype,allowSelected:!0,selected:!1})}));var a=new Backbone.Collection(n);i.push({name:t.name,type:t.type,rules:a,num:t.num,index:e}),s.push({value:e,displayValue:t.name})})),this.ruleStore=new Backbone.Collection(i),this.cmbCategory=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-category"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:s,takeFocusOnClose:!0,scrollAlwaysVisible:!1}).on("selected",(function(e,i){t.refreshRules(i.value)})),Common.UI.FocusManager.add(this,this.cmbCategory),this.cmbRule=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-rule"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",(function(e,i){t.setControls(t.cmbCategory.getValue(),i.value)})),Common.UI.FocusManager.add(this,this.cmbRule),this.txtRange1=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-r1"),name:"range",style:"width: 150px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1}),this.txtRange1.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,this.txtRange1),this.txtRange2=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-r2"),name:"range",style:"width: 150px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1}),this.txtRange2.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,this.txtRange2),this.cmbPercent=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-percent"),style:"width: 100px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textItem},{value:1,displayValue:this.textPercent}],takeFocusOnClose:!0}).on("selected",(function(e,i){i.value;t.numRank.setValue(t.numRank.getNumberValue())})),this.cmbPercent.setValue(0),Common.UI.FocusManager.add(this,this.cmbPercent),this.numRank=new Common.UI.MetricSpinner({el:$("#format-rules-edit-spin-rank"),step:1,width:100,defaultUnit:"",defaultValue:10,allowDecimal:!1,value:"10",maxValue:1e12,minValue:-1e12}),this.numRank.on("change",_.bind((function(t,e,i,s){}),this)),Common.UI.FocusManager.add(this,this.numRank),this.CFPresets=this.api.asc_getCFPresets();var n=this.CFPresets[Asc.c_oAscCFRuleTypeSettings.format],a=[],o=_.template(['<a id="<%= id %>" tabindex="-1" type="menuitem" style="padding: 3px 10px;">','<div style="height: 22px;padding: 4px 0;<%= options.styleStr %>"><%= caption %></div>',"</a>"].join(""));_.each(n,(function(t,e){a.push({value:e,presetSettings:{fontColor:t[0],fillColor:t[1],borderColor:t[2],styleObj:{"background-color":t[1]?"#"+t[1]:"#ffffff",color:t[0]?"#"+t[0]:"transparent",border:t[2]?"1px solid #"+t[2]:"","text-align":"center"}},caption:t[0]?Common.define.conditionalData.exampleText:"",template:o,styleStr:"background-color: "+(t[1]?"#"+t[1]:"#ffffff")+";color:"+(t[0]?"#"+t[0]:"transparent")+";"+(t[2]?"border: 1px solid #"+t[2]+";":"text-align: center;")})})),this.btnFormats=new Common.UI.Button({parentEl:$("#format-rules-format-preset"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 150px;",menu:new Common.UI.Menu({style:"min-width: 150px;",maxHeight:211,additionalAlign:this.menuAddAlign,items:a}),takeFocusOnClose:!0}),this.btnFormats.menu.on("item:click",_.bind(this.onFormatsSelect,this)),Common.UI.FocusManager.add(this,this.btnFormats),this.btnBold=new Common.UI.Button({parentEl:$("#format-rules-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold}),this.btnBold.on("click",_.bind(this.onBoldClick,this)),Common.UI.FocusManager.add(this,this.btnBold),this.btnItalic=new Common.UI.Button({parentEl:$("#format-rules-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic}),this.btnItalic.on("click",_.bind(this.onItalicClick,this)),Common.UI.FocusManager.add(this,this.btnItalic),this.btnUnderline=new Common.UI.Button({parentEl:$("#format-rules-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline}),this.btnUnderline.on("click",_.bind(this.onUnderlineClick,this)),Common.UI.FocusManager.add(this,this.btnUnderline),this.btnStrikeout=new Common.UI.Button({parentEl:$("#format-rules-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout}),this.btnStrikeout.on("click",_.bind(this.onStrikeoutClick,this)),Common.UI.FocusManager.add(this,this.btnStrikeout);var l,r=function(t){t.setMenu(),t.currentColor="000000";var e=t.getPicker();return e.currentColor=t.currentColor,e};if(this.btnTextColor=new Common.UI.ButtonColored({parentEl:$("#format-rules-fontcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,additionalAlign:this.menuAddAlign,color:"000000",menu:!0,takeFocusOnClose:!0}),this.mnuTextColorPicker=r(this.btnTextColor),this.btnTextColor.on("color:select",_.bind(this.onFormatTextColorSelect,this)),Common.UI.FocusManager.add(this,this.btnTextColor),this.btnFillColor=new Common.UI.ButtonColored({parentEl:$("#format-rules-fillcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-paracolor",hint:this.fillColor,additionalAlign:this.menuAddAlign,color:"000000",transparent:!0,menu:!0,takeFocusOnClose:!0}),this.mnuFillColorPicker=r(this.btnFillColor),this.btnFillColor.on("color:select",_.bind(this.onFormatFillColorSelect,this)),Common.UI.FocusManager.add(this,this.btnFillColor),this.btnBorders=new Common.UI.Button({parentEl:$("#format-rules-borders"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-border-out",hint:this.tipBorders,icls:"btn-border-out",borderId:"outer",borderswidth:Asc.c_oAscBorderStyles.Thin,split:!0,takeFocusOnClose:!0,menu:new Common.UI.Menu({items:[{caption:this.textBottomBorders,iconCls:"menu__icon btn-border-bottom",icls:"btn-border-bottom",borderId:Asc.c_oAscBorderOptions.Bottom},{caption:this.textTopBorders,iconCls:"menu__icon btn-border-top",icls:"btn-border-top",borderId:Asc.c_oAscBorderOptions.Top},{caption:this.textLeftBorders,iconCls:"menu__icon btn-border-left",icls:"btn-border-left",borderId:Asc.c_oAscBorderOptions.Left},{caption:this.textRightBorders,iconCls:"menu__icon btn-border-right",icls:"btn-border-right",borderId:Asc.c_oAscBorderOptions.Right},{caption:"--"},{caption:this.textNoBorders,iconCls:"menu__icon btn-border-no",icls:"btn-border-no",borderId:"none"},{caption:this.textAllBorders,iconCls:"menu__icon btn-border-all",icls:"btn-border-all",borderId:"all"},{caption:this.textOutBorders,iconCls:"menu__icon btn-border-out",icls:"btn-border-out",borderId:"outer"},{caption:this.textInsideBorders,iconCls:"menu__icon btn-border-inside",icls:"btn-border-inside",borderId:"inner"},{caption:"--"},{caption:this.textMiddleBorders,iconCls:"menu__icon btn-border-insidehor",icls:"btn-border-insidehor",borderId:Asc.c_oAscBorderOptions.InnerH},{caption:this.textCenterBorders,iconCls:"menu__icon btn-border-insidevert",icls:"btn-border-insidevert",borderId:Asc.c_oAscBorderOptions.InnerV},{caption:this.textDiagDownBorder,iconCls:"menu__icon btn-border-diagdown",icls:"btn-border-diagdown",borderId:Asc.c_oAscBorderOptions.DiagD},{caption:this.textDiagUpBorder,iconCls:"menu__icon btn-border-diagup",icls:"btn-border-diagup",borderId:Asc.c_oAscBorderOptions.DiagU},{caption:"--"},{id:"format-rules-borders-border-width",caption:this.textBordersStyle,iconCls:"menu__icon btn-border-style",menu:(l=_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><div class="border-size-item"><svg><use xlink:href="#<%= options.imgId %>"></use></svg></div></a>'),t.mnuBorderWidth=new Common.UI.Menu({style:"min-width: 100px;",menuAlign:"tl-tr",items:[{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thin,imgId:"solid-s",checked:!0},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Hair,imgId:"dots-s"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dotted,imgId:"dashes-s"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Dashed,imgId:"dashes-m"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDot,imgId:"dash-dot-s"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.DashDotDot,imgId:"dash-dot-dot-s"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Medium,imgId:"solid-m"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashed,imgId:"dashes-l"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDot,imgId:"dash-dot-m"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.MediumDashDotDot,imgId:"dash-dot-dot-m"},{template:l,checkable:!0,toggleGroup:"border-width",value:Asc.c_oAscBorderStyles.Thick,imgId:"solid-l"}]}),t.mnuBorderWidth)},this.mnuBorderColor=new Common.UI.MenuItem({id:"format-rules-borders-border-color",caption:this.textBordersColor,iconCls:"mnu-icon-item mnu-border-color",template:_.template('<a id="<%= id %>" tabindex="-1" type="menuitem"><span class="menu-item-icon" style="background-image: none; width: 12px; height: 12px; border-style: solid; border-width: 3px; border-color: #000;"></span><%= caption %></a>'),menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{template:_.template('<div id="format-rules-borders-menu-bordercolor" style="width: 164px; display: inline-block;"></div>')},{caption:"--"},{id:"format-rules-borders-menu-new-bordercolor",template:_.template('<a tabindex="-1" type="menuitem" style="'+(Common.UI.isRTL()?"padding-right: 12px;":"padding-left: 12px;")+'">'+this.textNewColor+"</a>")}]})})]})}),this.btnBorders.menu.on("item:click",_.bind(this.onBordersMenu,this)),this.btnBorders.on("click",_.bind(this.onBorders,this)),this.mnuBorderColorPicker=new Common.UI.ThemeColorPalette({el:$("#format-rules-borders-menu-bordercolor"),outerMenu:{menu:this.mnuBorderColor.menu,index:0,focusOnShow:!0}}),this.mnuBorderColor.menu.setInnerMenu([{menu:this.mnuBorderColorPicker,index:0}]),this.mnuBorderColorPicker.on("select",_.bind(this.onBordersColor,this)),this.mnuBorderColorPicker.on("close:extended",(function(){setTimeout((function(){t.btnBorders.focus()}),1)})),$("#format-rules-borders-menu-new-bordercolor").on("click",(function(){t.mnuBorderColorPicker.addNewColor()})),this.mnuBorderWidth.on("item:toggle",_.bind(this.onBordersWidth,this)),Common.UI.FocusManager.add(this,this.btnBorders),this.ascFormatOptions={General:"General",Number:"0.00",Currency:"$#,##0.00",Accounting:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)',DateShort:"m/d/yyyy",DateLong:"[$-F800]dddd, mmmm dd, yyyy",Time:"[$-F400]h:mm:ss AM/PM",Percentage:"0.00%",Percent:"0%",Fraction:"# ?/?",Scientific:"0.00E+00",Text:"@"},this.numFormatData=[{value:Asc.c_oAscNumFormatType.General,format:this.ascFormatOptions.General,displayValue:this.txtGeneral,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Number,format:this.ascFormatOptions.Number,displayValue:this.txtNumber,exampleval:"100,00"},{value:Asc.c_oAscNumFormatType.Scientific,format:this.ascFormatOptions.Scientific,displayValue:this.txtScientific,exampleval:"1,00E+02"},{value:Asc.c_oAscNumFormatType.Accounting,format:this.ascFormatOptions.Accounting,displayValue:this.txtAccounting,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Currency,format:this.ascFormatOptions.Currency,displayValue:this.txtCurrency,exampleval:"100,00 $"},{value:Asc.c_oAscNumFormatType.Date,format:"MM-dd-yyyy",displayValue:this.txtDateShort,exampleval:"04-09-1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Date,format:"MMMM d yyyy",displayValue:this.txtDateLong,exampleval:"April 9 1900",customDisplayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,format:"HH:MM:ss",displayValue:this.txtTime,exampleval:"00:00:00"},{value:Asc.c_oAscNumFormatType.Percent,format:this.ascFormatOptions.Percentage,displayValue:this.txtPercentage,exampleval:"100,00%"},{value:Asc.c_oAscNumFormatType.Fraction,format:this.ascFormatOptions.Fraction,displayValue:this.txtFraction,exampleval:"100"},{value:Asc.c_oAscNumFormatType.Text,format:this.ascFormatOptions.Text,displayValue:this.txtText,exampleval:"100"}],this.api){var c=new Asc.asc_CFormatCellsInfo;c.asc_setType(Asc.c_oAscNumFormatType.None),c.asc_setSymbol(this.langId);var d=this.api.asc_getFormatCells(c);this.numFormatData.forEach((function(e,i){e.format=d[i],e.exampleval=t.api.asc_getLocaleExample(e.format,100)}))}var h=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">','<div style="position: relative;"><div class="display-value"><%= scope.getDisplayValue(item) %></div>','<div class="example-val"><%= item.exampleval ? item.exampleval : "" %></div>',"</div></a></li>","<% }); %>"].join(""));this.cmbNumberFormat=new Common.UI.ComboBoxCustom({el:$("#format-rules-edit-combo-num-format"),cls:"input-group-nr",style:"width: 113px;",menuStyle:"min-width: 100%;max-height: 211px;",hint:this.tipNumFormat,itemsTemplate:h,editable:!1,focusWhenNoSelection:!1,data:this.numFormatData,takeFocusOnClose:!0,updateFormControl:function(t){this.clearSelection(),t&&this.setRawValue(t.get("customDisplayValue")||t.get("displayValue"))}}),this.cmbNumberFormat.setValue(Asc.c_oAscNumFormatType.General),this.cmbNumberFormat.on("selected",_.bind(this.onNumberFormatSelect,this)),Common.UI.FocusManager.add(this,this.cmbNumberFormat),this.btnClear=new Common.UI.Button({el:$("#format-rules-edit-btn-clear")}),this.btnClear.on("click",_.bind(this.clearFormat,this)),Common.UI.FocusManager.add(this,this.btnClear),this.panels={format:{el:this.$window.find(".hasformat"),rendered:!1,initColors:!1},scale:{el:this.$window.find(".scale"),rendered:!1,initColors:!1},databar:{el:this.$window.find(".databar"),rendered:!1,initColors:!1},iconset:{el:this.$window.find(".iconset"),rendered:!1,initColors:!1}},this.panels.format.rendered=!0,this.afterRender()},addNewIconsLine:function(){var t=this,e=this.iconsControls.length;this.iconsControls.push({});var i=new Common.UI.ComboBoxDataView({el:$("#format-rules-combo-icon-"+(e+1)),additionalAlign:this.menuAddAlign,additionalItemsBefore:[{caption:this.txtNoCellIcon,checkable:!0,allowDepress:!1,toggleGroup:"no-cell-icons-"+(e+1)}],cls:"move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 217px; margin: 0 5px;",store:new Common.UI.DataViewStore(t.iconsList),formTemplate:_.template(['<div class="form-control image" style="display: block;width: 85px;">','<div style="display: inline-block;overflow: hidden;width: 100%;height: 100%;padding-top: 2px;background-repeat: no-repeat; background-position: 27px center;white-space:nowrap;"></div>',"</div>"].join("")),itemTemplate:_.template('<img id="<%= id %>" class="item-icon" src="<%= imgUrl %>" style="width: 16px; height: 16px;">'),takeFocusOnClose:!0,updateFormControl:function(e){var i=$(this.el).find(".form-control > div");i.css("background-image",e?"url("+e.get("imgUrl")+")":""),i.text(e?"":t.txtNoCellIcon)}}),s=i.getPicker(),n=i.getMenu();i.on("item:click",_.bind(this.onSelectIcon,this)),n.items[0].on("toggle",_.bind(this.onSelectNoIcon,this,i,s)),n.on("show:before",(function(){if(!n.items[0].isChecked()){var t=s.store.findWhere({value:s.currentIconValue});t&&s.selectRecord(t,!0)}})).on("hide:after",(function(){s.deselectAll(!0)})),Common.UI.FocusManager.add(this,i),this.iconsControls[e].cmbIcons=i,this.iconsControls[e].pickerIcons=s,this.iconsControls[e].itemNoIcons=n.items[0],(i=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-op-"+(e+1)),style:"width: 55px;",menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:!0,displayValue:">=",prevOp:"<"},{value:!1,displayValue:">",prevOp:"<="}],type:e,takeFocusOnClose:!0}).on("selected",(function(e,i){t.fillIconsLabels()}))).setValue(1),this.iconsControls[e].cmbOperator=i,Common.UI.FocusManager.add(this,i);var a=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-value-"+(e+1)),name:"range",style:"width: 100px;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:e}).on("changed:after",(function(e,i,s,n){t.fillIconsLabels()}));a.setValue(""),this.iconsControls[e].value=a,a.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,a),(i=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-type-"+(e+1)),style:"width: 80px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:this.dataValTypes,type:e,takeFocusOnClose:!0}).on("selected",(function(t,e){}))).setValue(Asc.c_oAscCfvoType.Percent),this.iconsControls[e].cmbType=i,Common.UI.FocusManager.add(this,i),this.iconsControls[e].label=$("#format-rules-txt-icon-"+(e+1))},renderIconsPanel:function(){if(!this.panels.iconset.rendered){var t=this;this.collectionPresets=SSE.getCollection("ConditionalFormatIconsPresets"),this.collectionPresets.length<1&&SSE.getController("Main").fillCondFormatIconsPresets(this.api.asc_getCFIconsByType()),this.collectionIcons=SSE.getCollection("ConditionalFormatIcons"),this.collectionIcons.length<1&&SSE.getController("Main").fillCondFormatIcons(this.api.asc_getFullCFIcons()),this.iconsList=[],t.collectionIcons.each((function(e,i){t.iconsList.push({value:e.get("index"),imgUrl:e.get("icon")})}));var e=[],i=this.collectionPresets.length,s=this.CFPresets[Asc.c_oAscCFRuleTypeSettings.icons];_.each(s,(function(s,n){if(!(n>=i)){for(var a=[],o=0;o<s.length;o++){var l=new Asc.asc_CConditionalFormatValueObject;l.asc_setType(s[o][0]),l.asc_setVal(s[o][1]),s[o][2],a.push(l)}e.push({value:n,data:{iconSet:t.collectionPresets.at(n).get("icons"),values:a,icons:t.collectionIcons}})}})),this.cmbIconsPresets=new Common.UI.ComboBoxIcons({el:$("#format-rules-icon-style"),editable:!1,style:"width: 120px;",menuStyle:"max-height: 220px;min-width: 100%;",data:e}).on("selected",(function(e,i){e.skipFocus=!0,t.fillIconsControls(i.value,i.data.values),_.delay((function(){t.iconsControls[t.iconsProps.iconsLength-1].cmbOperator.focus()}),50)})).on("hide:after",(function(t){!t.skipFocus&&setTimeout((function(){t.focus()}),1),t.skipFocus=!1})),Common.UI.FocusManager.add(this,this.cmbIconsPresets),this.cmbIconsPresets.setValue(3),this.iconsProps={iconsSet:3},this.chIconShow=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-icon-show"),labelText:this.textShowIcon}),this.chIconShow.on("change",(function(t,e,i,s){})),Common.UI.FocusManager.add(this,this.chIconShow),this.btnReverse=new Common.UI.Button({el:$("#format-rules-edit-btn-icon-reverse")}),this.btnReverse.on("click",(function(){t.iconsProps.isReverse=!t.iconsProps.isReverse,t.reverseIconsControls()})),Common.UI.FocusManager.add(this,this.btnReverse),this.iconsControls=[];for(var n=0;n<3;n++)this.addNewIconsLine();var a=this.cmbIconsPresets.getSelectedRecord();a&&this.fillIconsControls(a.value,a.data.values),this.panels.iconset.rendered=!0}},renderDataBarPanel:function(){if(!this.panels.databar.rendered){var t=this;this.barControls=[];for(var e=0;e<2;e++){var i=this.dataValTypes;0==e?(i=[{value:Asc.c_oAscCfvoType.Minimum,displayValue:this.textMinimum}].concat(i)).push({value:Asc.c_oAscCfvoType.AutoMin,displayValue:this.textAutomatic}):(i=[{value:Asc.c_oAscCfvoType.Maximum,displayValue:this.textMaximum}].concat(i)).push({value:Asc.c_oAscCfvoType.AutoMax,displayValue:this.textAutomatic});var s=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-bar-"+(e+1)),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:i,type:e,takeFocusOnClose:!0}).on("selected",(function(e,i){t.barControls[e.options.type].range.setDisabled(i.value==Asc.c_oAscCfvoType.Minimum||i.value==Asc.c_oAscCfvoType.Maximum||i.value==Asc.c_oAscCfvoType.AutoMin||i.value==Asc.c_oAscCfvoType.AutoMax),t.setDefComboValue(e.options.type,i.value,t.barControls[e.options.type].range)})),n=0==e?Asc.c_oAscCfvoType.AutoMin:Asc.c_oAscCfvoType.AutoMax;s.setValue(n),Common.UI.FocusManager.add(this,s);var a=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-bar-"+(e+1)),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:e,disabled:n==Asc.c_oAscCfvoType.AutoMin||n==Asc.c_oAscCfvoType.AutoMax||n==Asc.c_oAscCfvoType.Minimum||n==Asc.c_oAscCfvoType.Maximum});t.setDefComboValue(e,n,a),a.on("button:click",_.bind(this.onSelectData,this)),this.barControls.push({combo:s,range:a}),Common.UI.FocusManager.add(this,a)}this.cmbFill=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-fill"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:!1,displayValue:this.textSolid},{value:!0,displayValue:this.textGradient}],takeFocusOnClose:!0}).on("selected",(function(e,i){t.barProps&&(t.barProps.asc_setGradient(i.value),t.previewFormat())})),this.cmbFill.setValue(!1),Common.UI.FocusManager.add(this,this.cmbFill),this.btnPosFill=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-pos-fill"),style:"width:45px;",menu:!0,color:"638EC6",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnPosFill),this.btnNegFill=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-neg-fill"),style:"width:45px;",menu:!0,color:"FF0000",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnNegFill),this.chFill=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-fill"),labelText:this.textSameAs}),this.chFill.on("change",(function(e,i,s,n){t.btnNegFill.setDisabled("checked"==e.getValue())})),Common.UI.FocusManager.add(this,this.chFill),this.cmbBorder=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-border"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:!1,displayValue:this.textSolid},{value:!0,displayValue:this.textNone}],takeFocusOnClose:!0}).on("selected",(function(e,i){var s=!i.value;t.btnPosBorder.setDisabled(!s),t.btnNegBorder.setDisabled(!s||"checked"==t.chBorder.getValue()),t.chBorder.setDisabled(!s),t.barProps&&(s?t.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(t.btnPosBorder.colorPicker.currentColor)):t.barProps.asc_setBorderColor(null),t.previewFormat())})),this.cmbBorder.setValue(!1),Common.UI.FocusManager.add(this,this.cmbBorder),this.btnPosBorder=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-pos-border"),style:"width:45px;",menu:!0,color:"000000",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnPosBorder),this.btnNegBorder=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-neg-border"),style:"width:45px;",menu:!0,color:"000000",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnNegBorder),this.chBorder=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-border"),labelText:this.textSameAs}),this.chBorder.on("change",(function(e,i,s,n){t.btnNegBorder.setDisabled("checked"==e.getValue())})),Common.UI.FocusManager.add(this,this.chBorder),this.cmbBarDirection=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-direction"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscDataBarDirection.context,displayValue:this.textContext},{value:Asc.c_oAscDataBarDirection.leftToRight,displayValue:this.textLeft2Right},{value:Asc.c_oAscDataBarDirection.rightToLeft,displayValue:this.textRight2Left}],takeFocusOnClose:!0}).on("selected",(function(e,i){t.barProps&&(t.barProps.asc_setDirection(i.value),t.previewFormat())})),this.cmbBarDirection.setValue(Asc.c_oAscDataBarDirection.context),Common.UI.FocusManager.add(this,this.cmbBarDirection),this.chShowBar=new Common.UI.CheckBox({el:$("#format-rules-edit-chk-show-bar"),labelText:this.textShowBar}),Common.UI.FocusManager.add(this,this.chShowBar),this.cmbAxisPos=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-axis-pos"),style:"width: 150px;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscDataBarAxisPosition.automatic,displayValue:this.textAutomatic},{value:Asc.c_oAscDataBarAxisPosition.middle,displayValue:this.textCellMidpoint},{value:Asc.c_oAscDataBarAxisPosition.none,displayValue:this.textNone}],takeFocusOnClose:!0}).on("selected",(function(e,i){t.btnAxisColor.setDisabled(i.value==Asc.c_oAscDataBarAxisPosition.none)})),this.cmbAxisPos.setValue(Asc.c_oAscDataBarDirection.context),Common.UI.FocusManager.add(this,this.cmbAxisPos),this.btnAxisColor=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-axis-color"),style:"width:45px;",menu:!0,color:"000000",takeFocusOnClose:!0}),Common.UI.FocusManager.add(this,this.btnAxisColor),this.panels.databar.rendered=!0,this.updateThemeColors()}},renderScalesPanel:function(){if(!this.panels.scale.rendered){var t=this;this.scaleControls=[],this.lblMidScale=this.$window.find("#format-rules-edit-lbl-scale-2");for(var e=0;e<3;e++){var i=this.dataValTypes;0==e?i=[{value:Asc.c_oAscCfvoType.Minimum,displayValue:this.textMinimum}].concat(i):2==e&&(i=[{value:Asc.c_oAscCfvoType.Maximum,displayValue:this.textMaximum}].concat(i));var s=new Common.UI.ComboBox({el:$("#format-rules-edit-combo-scale-"+(e+1)),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:i,type:e,takeFocusOnClose:!0}).on("selected",(function(e,i){t.scaleControls[e.options.type].range.setDisabled(i.value==Asc.c_oAscCfvoType.Minimum||i.value==Asc.c_oAscCfvoType.Maximum),t.setDefComboValue(e.options.type,i.value,t.scaleControls[e.options.type].range)}));s.setValue(1==e?Asc.c_oAscCfvoType.Percentile:i[0].value),Common.UI.FocusManager.add(this,s);var n=new Common.UI.InputFieldBtn({el:$("#format-rules-edit-txt-scale-"+(e+1)),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,validateOnChange:!1,type:e,disabled:1!=e});n.setValue(1==e?50:""),n.on("button:click",_.bind(this.onSelectData,this)),Common.UI.FocusManager.add(this,n);var a=new Common.UI.ColorButton({parentEl:$("#format-rules-edit-color-scale-"+(e+1)),menu:!0,type:e,color:"000000",takeFocusOnClose:!0});Common.UI.FocusManager.add(this,a),this.scaleControls.push({combo:s,range:n,color:a})}this.panels.scale.rendered=!0,this.updateThemeColors()}},afterRender:function(){this.updateThemeColors(),this._setDefaults(this.props),this.setTitle(this.isEdit?this.txtTitleEdit:this.txtTitleNew)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){this._originalProps=t;var e,i,s=t?t.asc_getType():this.type,n=this.subtype,a=!!this.percent;if(t)switch(s){case Asc.c_oAscCFType.containsText:case Asc.c_oAscCFType.notContainsText:case Asc.c_oAscCFType.beginsWith:case Asc.c_oAscCFType.endsWith:i=t.asc_getContainsText(),this.txtRange1.setValue(i||"");break;case Asc.c_oAscCFType.timePeriod:n=t.asc_getTimePeriod();break;case Asc.c_oAscCFType.aboveAverage:var o=t.asc_getAboveAverage(),l=t.asc_getEqualAverage(),r=t.asc_getStdDev();n=o?0:1,l?n+=2:r&&(n+=2+2*r);break;case Asc.c_oAscCFType.top10:n=t.asc_getBottom()?1:0,a=t.asc_getPercent(),this.numRank.setValue(t.asc_getRank()?t.asc_getRank():10);break;case Asc.c_oAscCFType.cellIs:n=t.asc_getOperator(),this.txtRange1.setValue(t.asc_getValue1()||""),this.txtRange2.setValue(t.asc_getValue2()||"");break;case Asc.c_oAscCFType.expression:this.txtRange1.setValue(t.asc_getValue1()||"");break;case Asc.c_oAscCFType.colorScale:this.renderScalesPanel();var c=(i=t.asc_getColorScaleOrDataBarOrIconSetRule()).asc_getCFVOs(),d=i.asc_getColors();n=c.length;for(var h=2==c.length?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,p=0;p<c.length;p++){var u=c[p].asc_getType(),m=c[p].asc_getVal(),g=d[p];(f=h[p]).combo.setValue(u),f.range.setDisabled(u==Asc.c_oAscCfvoType.Minimum||u==Asc.c_oAscCfvoType.Maximum),f.range.setValue(u!==Asc.c_oAscCfvoType.Minimum&&u!==Asc.c_oAscCfvoType.Maximum&&null!=m?m:""),this.setColor(g,f.color)}break;case Asc.c_oAscCFType.dataBar:this.renderDataBarPanel();var b=(i=t.asc_getColorScaleOrDataBarOrIconSetRule()).asc_getCFVOs();for(h=this.barControls,p=0;p<b.length;p++){var f,v=b[p].asc_getType();m=b[p].asc_getVal();(f=h[p]).combo.setValue(v),f.range.setDisabled(v==Asc.c_oAscCfvoType.Minimum||v==Asc.c_oAscCfvoType.Maximum||v==Asc.c_oAscCfvoType.AutoMin||v==Asc.c_oAscCfvoType.AutoMax),f.range.setValue(v!==Asc.c_oAscCfvoType.Minimum&&v!==Asc.c_oAscCfvoType.Maximum&&v!==Asc.c_oAscCfvoType.AutoMin&&v!==Asc.c_oAscCfvoType.AutoMax&&null!=m?m:"")}this.cmbFill.setValue(i.asc_getGradient()),this.setColor(i.asc_getColor(),this.btnPosFill),this.setColor(i.asc_getNegativeColor()||i.asc_getColor(),this.btnNegFill),this.chFill.setValue(i.asc_getNegativeBarColorSameAsPositive());g=i.asc_getBorderColor();this.cmbBorder.setValue(null===g),this.btnPosBorder.setDisabled(null===g),g&&(this.setColor(i.asc_getBorderColor(),this.btnPosBorder),this.setColor(i.asc_getNegativeBorderColor()||i.asc_getBorderColor(),this.btnNegBorder)),this.chBorder.setValue(i.asc_getNegativeBarBorderColorSameAsPositive()),this.chBorder.setDisabled(null===g),this.btnNegBorder.setDisabled(null===g||i.asc_getNegativeBarBorderColorSameAsPositive()),this.cmbBarDirection.setValue(i.asc_getDirection()),this.chShowBar.setValue(!i.asc_getShowValue()),this.cmbAxisPos.setValue(i.asc_getAxisPosition()),i.asc_getAxisColor()&&this.setColor(i.asc_getAxisColor(),this.btnAxisColor),this.btnAxisColor.setDisabled(i.asc_getAxisPosition()==Asc.c_oAscDataBarAxisPosition.none);break;case Asc.c_oAscCFType.iconSet:this.renderIconsPanel(),i=t.asc_getColorScaleOrDataBarOrIconSetRule(),this.chIconShow.setValue(!i.asc_getShowValue()),this.iconsProps.isReverse=i.asc_getReverse(),this.fillIconsControls(i.asc_getIconSet(),i.asc_getCFVOs(),i.asc_getIconSets())}s!==Asc.c_oAscCFType.containsText&&s!==Asc.c_oAscCFType.notContainsText&&s!==Asc.c_oAscCFType.beginsWith&&s!==Asc.c_oAscCFType.endsWith&&s!==Asc.c_oAscCFType.containsBlanks&&s!==Asc.c_oAscCFType.notContainsBlanks&&s!==Asc.c_oAscCFType.duplicateValues&&s!==Asc.c_oAscCFType.uniqueValues&&s!==Asc.c_oAscCFType.containsErrors&&s!==Asc.c_oAscCFType.notContainsErrors&&s!==Asc.c_oAscCFType.timePeriod&&s!==Asc.c_oAscCFType.aboveAverage&&s!==Asc.c_oAscCFType.top10&&s!==Asc.c_oAscCFType.cellIs&&s!==Asc.c_oAscCFType.expression||(t?this.xfsFormat=t.asc_getDxf():this.onFormatsSelect(this.btnFormats.menu,this.btnFormats.menu.items[0]));var C=this.ruleStore.where({type:s});if(C.length>1)s==Asc.c_oAscCFType.colorScale&&(C=n==C[0].get("num")?C[0]:C[1]);else if(0==C.length){var x=this.ruleStore;for(p=0;p<x.length;p++){var y=x.at(p);if((_=y.get("rules"))&&_.findWhere({type:s})){C=y,e=s;break}}}else{var _;(_=(C=C[0]).get("rules"))&&_.findWhere({type:s})?e=s:void 0!==n&&_&&_.findWhere({subtype:n})&&(e=n)}C||(C=this.ruleStore.at(0)),C&&(this.cmbCategory.setValue(C.get("index")),this.refreshRules(C.get("index"),e),s===Asc.c_oAscCFType.top10&&this.cmbPercent.setValue(a?1:0));var A=this.xfsFormat?this.xfsFormat:new Asc.asc_CellXfs;this.fillXfsFormatInfo(A),this.previewFormat(),Common.UI.FocusManager.add(this,this.getFooterButtons())},setColor:function(t,e,i){return i=e?e.colorPicker:i,t=t&&!t.get_auto()?t.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()),effectValue:t.get_value()}:Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()):i.options.transparent?"transparent":"000000",e&&e.setColor(t),Common.Utils.ThemeColor.selectPickerColorByEffect(t,i),i&&(i.currentColor=t),e&&(e.currentColor=t),t},fillXfsFormatInfo:function(t){if(t){this.btnBold.toggle(!0===t.asc_getFontBold(),!0),this.btnItalic.toggle(!0===t.asc_getFontItalic(),!0),this.btnUnderline.toggle(!0===t.asc_getFontUnderline(),!0),this.btnStrikeout.toggle(!0===t.asc_getFontStrikeout(),!0);this.setColor(t.asc_getFontColor(),this.btnTextColor,this.mnuTextColorPicker);this.setColor(t.asc_getFillColor(),this.btnFillColor,this.mnuFillColorPicker);var e=t.asc_getNumFormatInfo();e&&this.cmbNumberFormat.setValue(e.asc_getType(),this.textCustom)}},getSettings:function(){var t,e=this.ruleStore.findWhere({index:this.cmbCategory.getValue()});if(e){t=this._originalProps||new Asc.asc_CConditionalFormattingRule;var i=e.get("type"),s=i!==t.asc_getType();switch(t.asc_setType(i),i!=Asc.c_oAscCFType.containsText&&i!=Asc.c_oAscCFType.containsBlanks&&i!=Asc.c_oAscCFType.duplicateValues&&i!=Asc.c_oAscCFType.timePeriod&&i!=Asc.c_oAscCFType.aboveAverage&&i!=Asc.c_oAscCFType.top10&&i!=Asc.c_oAscCFType.cellIs&&i!=Asc.c_oAscCFType.expression||(this.xfsFormat||null===this.xfsFormat)&&t.asc_setDxf(this.xfsFormat),i){case Asc.c_oAscCFType.containsText:(A=this.txtRange1.getValue())&&t.asc_setContainsText(A),t.asc_setType(this.cmbRule.getValue());break;case Asc.c_oAscCFType.containsBlanks:case Asc.c_oAscCFType.duplicateValues:t.asc_setType(this.cmbRule.getValue());break;case Asc.c_oAscCFType.timePeriod:t.asc_setTimePeriod(this.cmbRule.getValue());break;case Asc.c_oAscCFType.aboveAverage:var n=this.cmbRule.getValue(),a=!(n%2);t.asc_setAboveAverage(a),t.asc_setEqualAverage(2==n||3==n),t.asc_setStdDev(n>3?Math.floor(n/2)-1:0);break;case Asc.c_oAscCFType.top10:t.asc_setBottom(!!this.cmbRule.getValue()),t.asc_setPercent(!!this.cmbPercent.getValue()),""!==this.numRank.getValue()&&t.asc_setRank(this.numRank.getNumberValue());break;case Asc.c_oAscCFType.cellIs:t.asc_setOperator(this.cmbRule.getValue()),t.asc_setValue1(this.txtRange1.getValue()),this.txtRange2.isVisible()&&t.asc_setValue2(this.txtRange2.getValue());break;case Asc.c_oAscCFType.expression:t.asc_setValue1(this.txtRange1.getValue());break;case Asc.c_oAscCFType.colorScale:for(var o=s?new Asc.asc_CColorScale:t.asc_getColorScaleOrDataBarOrIconSetRule(),l=e.get("num"),r=2==l?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,c=[],d=[],h=0;h<l;h++){var p=new Asc.asc_CConditionalFormatValueObject,u=r[h];p.asc_setType(u.combo.getValue()),p.asc_setVal(u.range.getValue()),d.push(p),c.push(Common.Utils.ThemeColor.getRgbColor(u.colorPicker.currentColor))}o.asc_setColors(c),o.asc_setCFVOs(d),t.asc_setColorScaleOrDataBarOrIconSetRule(o);break;case Asc.c_oAscCFType.dataBar:var m=s?new Asc.asc_CDataBar:t.asc_getColorScaleOrDataBarOrIconSetRule();s&&m.asc_setInterfaceDefault();r=this.barControls;var g=[];for(h=0;h<r.length;h++){var b=new Asc.asc_CConditionalFormatValueObject,f=(u=r[h]).combo.getValue();b.asc_setType(f),f!==Asc.c_oAscCfvoType.Minimum&&f!==Asc.c_oAscCfvoType.Maximum&&f!==Asc.c_oAscCfvoType.AutoMin&&f!==Asc.c_oAscCfvoType.AutoMax&&b.asc_setVal(u.range.getValue()),g.push(b)}m.asc_setCFVOs(g),m.asc_setGradient(this.cmbFill.getValue()),m.asc_setColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosFill.colorPicker.currentColor)),m.asc_setNegativeColor(Common.Utils.ThemeColor.getRgbColor("checked"==this.chFill.getValue()?this.btnPosFill.colorPicker.currentColor:this.btnNegFill.colorPicker.currentColor)),m.asc_setNegativeBarColorSameAsPositive("checked"==this.chFill.getValue()),!this.cmbBorder.getValue()?(m.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosBorder.colorPicker.currentColor)),m.asc_setNegativeBorderColor(Common.Utils.ThemeColor.getRgbColor("checked"==this.chBorder.getValue()?this.btnPosBorder.colorPicker.currentColor:this.btnNegBorder.colorPicker.currentColor)),m.asc_setNegativeBarBorderColorSameAsPositive("checked"==this.chBorder.getValue())):(m.asc_setBorderColor(null),m.asc_setNegativeBorderColor(null)),m.asc_setDirection(this.cmbBarDirection.getValue()),m.asc_setShowValue("checked"!==this.chShowBar.getValue());var v=this.cmbAxisPos.getValue();m.asc_setAxisPosition(v),v!==Asc.c_oAscDataBarAxisPosition.none?m.asc_setAxisColor(Common.Utils.ThemeColor.getRgbColor(this.btnAxisColor.colorPicker.currentColor)):m.asc_setAxisColor(null),t.asc_setColorScaleOrDataBarOrIconSetRule(m);break;case Asc.c_oAscCFType.iconSet:var C=s?new Asc.asc_CIconSet:t.asc_getColorScaleOrDataBarOrIconSetRule();C.asc_setShowValue("checked"!==this.chIconShow.getValue()),C.asc_setReverse(!!this.iconsProps.isReverse),C.asc_setIconSet(this.iconsProps.iconsSet);r=this.iconsControls;var x=this.iconsProps.iconsLength,y=this.cmbIconsPresets.getSelectedRecord()?null:[],_=[];for(h=0;h<x;h++){var A;u=r[h];if((A=new Asc.asc_CConditionalFormatValueObject).asc_setType(u.cmbType.getValue()),A.asc_setVal(u.value.getValue()),A.asc_setGte(u.cmbOperator.getValue()),_.push(A),y)if(u.itemNoIcons.isChecked())(w=new Asc.asc_CConditionalFormatIconSet).asc_setIconSet(Asc.EIconSetType.NoIcons),w.asc_setIconId(0),this.iconsProps.isReverse?y.unshift(w):y.push(w);else for(var w=u.pickerIcons.currentIconValue+1,S=0;S<this.collectionPresets.length;S++){for(var k=this.collectionPresets.at(S).get("icons"),T=0;T<k.length;T++)if(w==k[T]){(w=new Asc.asc_CConditionalFormatIconSet).asc_setIconSet(S),w.asc_setIconId(T),this.iconsProps.isReverse?y.unshift(w):y.push(w);break}if("object"==_typeof(w))break}}C.asc_setCFVOs(_),C.asc_setIconSets(y),t.asc_setColorScaleOrDataBarOrIconSetRule(C)}}return t},refreshRules:function(t,e){var i=this.ruleStore.findWhere({index:t});if(i){var s=i.get("rules"),n=[];s&&s.each((function(t,e){n.push({value:void 0!==t.get("type")?t.get("type"):t.get("subtype"),displayValue:t.get("name")})})),this.cmbRule.setData(n),n.length>0&&this.cmbRule.setValue(void 0!==e?e:n[0].value)}if(this.setControls(t,this.cmbRule.getValue()),this.setInnerHeight(9==t?370:280),i){var a=i.get("type");if(this._changedProps=new Asc.asc_CConditionalFormattingRule,this._changedProps.asc_setType(a),a==Asc.c_oAscCFType.containsText||a==Asc.c_oAscCFType.containsBlanks||a==Asc.c_oAscCFType.duplicateValues||a==Asc.c_oAscCFType.timePeriod||a==Asc.c_oAscCFType.aboveAverage||a==Asc.c_oAscCFType.top10||a==Asc.c_oAscCFType.cellIs||a==Asc.c_oAscCFType.expression)(this.xfsFormat||null===this.xfsFormat)&&this._changedProps.asc_setDxf(this.xfsFormat);else if(a==Asc.c_oAscCFType.colorScale){for(var o=2==i.get("num")?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,l=[],r=[],c=0;c<o.length;c++){var d=new Asc.asc_CConditionalFormatValueObject,h=o[c];d.asc_setType(h.combo.getValue()),d.asc_setVal(h.range.getValue()),r.push(d),l.push(Common.Utils.ThemeColor.getRgbColor(h.colorPicker.currentColor))}this.scaleProps=new Asc.asc_CColorScale,this.scaleProps.asc_setColors(l),this.scaleProps.asc_setCFVOs(r),this._changedProps.asc_setColorScaleOrDataBarOrIconSetRule(this.scaleProps)}else if(a==Asc.c_oAscCFType.dataBar){this.barProps=new Asc.asc_CDataBar,this.barProps.asc_setInterfaceDefault(),this.barProps.asc_setGradient(this.cmbFill.getValue()),this.barProps.asc_setColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosFill.colorPicker.currentColor)),!this.cmbBorder.getValue()?this.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(this.btnPosBorder.colorPicker.currentColor)):this.barProps.asc_setBorderColor(null),this.barProps.asc_setDirection(this.cmbBarDirection.getValue()),this._changedProps.asc_setColorScaleOrDataBarOrIconSetRule(this.barProps)}this.previewFormat()}},setControls:function(t,e){var i;this.$window.find(".hasformat").toggleClass("hidden",t>=7&&t<=10),this.cmbRule.setVisible(t<7),this.txtRange1.setVisible(0==t||3==t||11==t),this.txtRange2.setVisible(0==t&&(e==Asc.c_oAscCFOperator.between||e==Asc.c_oAscCFOperator.notBetween)),this.cmbPercent.setVisible(1==t),this.numRank.setVisible(1==t),this.txtRange1.cmpEl.width(11==t?310:150),7!=t&&8!=t||(this.renderScalesPanel(),this.scaleControls[1].combo.setVisible(8==t),this.scaleControls[1].range.setVisible(8==t),this.scaleControls[1].color.setVisible(8==t),this.lblMidScale.toggleClass("hidden",7==t)),this.$window.find(".scale").toggleClass("hidden",t<7||t>8),9==t&&this.renderDataBarPanel(),10==t&&this.renderIconsPanel(),this.$window.find(".databar").toggleClass("hidden",9!==t),this.$window.find(".iconset").toggleClass("hidden",10!==t),t<7?i=this.cmbRule:7==t||8==t?i=this.scaleControls[0].combo:9==t?i=this.barControls[0].combo:10==t&&(i=this.iconsControls[this.iconsProps.iconsLength-1].cmbOperator),i&&_.delay((function(){i.focus()}),50)},onSelectData:function(t){var e=this;if(e.api){var i=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.setValue(e.getSettings()),t.checkValidate())}}).on("close",(function(){e.show()})),s=Common.Utils.getOffset(e.$window);e.hide(),i.show(e.$window,s),i.setSettings({api:e.api,range:_.isEmpty(t.getValue())||1!=t.checkValidate()?"":t.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}})}},onFormatsSelect:function(t,e){var i=new Asc.asc_CellXfs,s=e.options.presetSettings;if(s&&s.fontColor&&i.asc_setFontColor(Common.Utils.ThemeColor.getRgbColor(s.fontColor)),s&&s.fillColor&&i.asc_setFillColor(Common.Utils.ThemeColor.getRgbColor(s.fillColor)),s&&s.borderColor){var n=[],a=Asc.c_oAscBorderStyles.Thin,o=Common.Utils.ThemeColor.getRgbColor(s.borderColor);n[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(a,o),n[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(a,o),n[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(a,o),n[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(a,o),i.asc_setBorder(n)}this.xfsFormat=i,this._changedProps&&this._changedProps.asc_setDxf(i),this.fillXfsFormatInfo(i),this.previewFormat()},clearFormat:function(){this.xfsFormat=null,this._changedProps&&this._changedProps.asc_setDxf(null),this.fillXfsFormatInfo(new Asc.asc_CellXfs),this.previewFormat()},onBoldClick:function(){!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontBold(this.btnBold.isActive()),this.previewFormat()},onItalicClick:function(){!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontItalic(this.btnItalic.isActive()),this.previewFormat()},onUnderlineClick:function(){!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontUnderline(this.btnUnderline.isActive()),this.previewFormat()},onStrikeoutClick:function(){!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontStrikeout(this.btnStrikeout.isActive()),this.previewFormat()},onBordersWidth:function(t,e,i){i&&(this.btnBorders.options.borderswidth=e.value,this.onBorders(this.btnBorders))},onBordersColor:function(t,e){$("#format-rules-borders-border-color .menu-item-icon").css("border-color","#"+("object"==_typeof(e)?e.color:e)),this.mnuBorderColor.onUnHoverItem(),this.btnBorders.options.borderscolor=Common.Utils.ThemeColor.getRgbColor(e),this.onBorders(this.btnBorders);var i=this;setTimeout((function(){i.btnBorders.menu.hide()}),1)},onBorders:function(t){var e;_.each(t.menu.items,(function(i){if(t.options.borderId==i.options.borderId)return e=i,!1})),e&&this.onBordersMenu(t.menu,e)},onBordersMenu:function(t,e){if(!_.isUndefined(e.options.borderId)){var i=this.btnBorders,s=[],n=i.options.borderswidth,a=i.options.borderscolor;i.rendered&&(i.$icon.removeClass(i.options.icls).addClass(e.options.icls),i.options.icls=e.options.icls),i.options.borderId=e.options.borderId,"inner"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(n,a)):"all"==e.options.borderId?(s[Asc.c_oAscBorderOptions.InnerV]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.InnerH]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(n,a)):"outer"==e.options.borderId?(s[Asc.c_oAscBorderOptions.Left]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Top]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Right]=new Asc.asc_CBorder(n,a),s[Asc.c_oAscBorderOptions.Bottom]=new Asc.asc_CBorder(n,a)):"none"!=e.options.borderId&&(s[e.options.borderId]=new Asc.asc_CBorder(n,a)),!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setBorder(s),this.previewFormat()}},onFormatTextColorSelect:function(t,e,i){this.btnTextColor.currentColor=e,this.mnuTextColorPicker.currentColor=e,!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFontColor(Common.Utils.ThemeColor.getRgbColor(this.mnuTextColorPicker.currentColor)),this.previewFormat()},onFormatFillColorSelect:function(t,e,i){this.btnFillColor.currentColor=e,this.mnuFillColorPicker.currentColor=e,!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setFillColor("transparent"==this.mnuFillColorPicker.currentColor?null:Common.Utils.ThemeColor.getRgbColor(this.mnuFillColorPicker.currentColor)),this.previewFormat()},onNumberFormatSelect:function(t,e){!this.xfsFormat&&(this.xfsFormat=new Asc.asc_CellXfs),this.xfsFormat.asc_setNumFormatInfo(e.format),this.previewFormat()},previewFormat:function(){if(this._changedProps){var t=this._changedProps.asc_getType();t==Asc.c_oAscCFType.containsText||t==Asc.c_oAscCFType.notContainsText||t==Asc.c_oAscCFType.beginsWith||t==Asc.c_oAscCFType.endsWith||t==Asc.c_oAscCFType.containsBlanks||t==Asc.c_oAscCFType.notContainsBlanks||t==Asc.c_oAscCFType.duplicateValues||t==Asc.c_oAscCFType.uniqueValues||t==Asc.c_oAscCFType.containsErrors||t==Asc.c_oAscCFType.notContainsErrors||t==Asc.c_oAscCFType.timePeriod||t==Asc.c_oAscCFType.aboveAverage||t==Asc.c_oAscCFType.top10||t==Asc.c_oAscCFType.cellIs||t==Asc.c_oAscCFType.expression?(this.xfsFormat&&!this._changedProps.asc_getDxf()&&this._changedProps.asc_setDxf(this.xfsFormat),this._changedProps.asc_getPreview("format-rules-edit-preview-format",this.xfsFormat?Common.define.conditionalData.exampleText:Common.define.conditionalData.noFormatText)):t==Asc.c_oAscCFType.colorScale?this._changedProps.asc_getPreview("format-rules-edit-preview-scale",""):t==Asc.c_oAscCFType.dataBar&&this._changedProps.asc_getPreview("format-rules-edit-preview-databar","")}},updateThemeColors:function(){if(this.panels.scale.rendered&&!this.panels.scale.initColors){for(var t=0;t<this.scaleControls.length;t++){var e=this.scaleControls[t].color;e.setMenu();var i=e.getPicker();i.options.type=t,i.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),i.currentColor=0==t?"FFC000":1==t?"FFFF00":"92D050",i.select(i.currentColor,!0),e.setColor(i.currentColor),this.scaleControls[t].colorPicker=i,e.on("color:select",_.bind(this.onScaleColorsSelect,this))}this.panels.scale.initColors=!0}if(this.panels.databar.rendered&&!this.panels.databar.initColors){var s=function(t){t.setMenu();var e=t.getPicker();e.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),t.colorPicker=e,e.currentColor=t.color,e.select(e.currentColor,!0)};s(this.btnPosFill),this.btnPosFill.on("color:select",_.bind(this.onBarColorsSelect,this,"pos")),s(this.btnNegFill),this.btnNegFill.on("color:select",_.bind(this.onBarColorsSelect,this,"")),s(this.btnPosBorder),this.btnPosBorder.on("color:select",_.bind(this.onBarColorsSelect,this,"pos-border")),s(this.btnNegBorder),this.btnNegBorder.on("color:select",_.bind(this.onBarColorsSelect,this,"")),s(this.btnAxisColor),this.btnAxisColor.on("color:select",_.bind(this.onBarColorsSelect,this,"")),this.panels.databar.initColors=!0}this.panels.format.rendered&&!this.panels.format.initColors&&(this.mnuTextColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuFillColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuBorderColorPicker.updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.panels.format.initColors=!0)},onScaleColorsSelect:function(t,e){if(t.colorPicker.currentColor=e,this.scaleProps){var i=this.scaleProps.asc_getColors();i[Math.min(t.options.type,i.length-1)]=Common.Utils.ThemeColor.getRgbColor(t.colorPicker.currentColor),this.scaleProps.asc_setColors(i),this.previewFormat()}},onBarColorsSelect:function(t,e,i){e.colorPicker.currentColor=i,!this.barProps||"pos"!=t&&"pos-border"!=t||("pos"==t?this.barProps.asc_setColor(Common.Utils.ThemeColor.getRgbColor(i)):this.barProps.asc_setBorderColor(Common.Utils.ThemeColor.getRgbColor(i)),this.previewFormat())},setDefComboValue:function(t,e,i){var s=this.cmbCategory.getValue(),n="";switch(e){case Asc.c_oAscCfvoType.Number:n=0;break;case Asc.c_oAscCfvoType.Percent:n=0==t?0:1==t&&8==s?50:100;break;case Asc.c_oAscCfvoType.Percentile:n=0==t?10:1==t&&8==s?50:90}i.setValue(n)},fillIconsControls:function(t,e,i){var s=this;this.iconsProps.iconsSet=t,this.iconsProps.iconsLength=e.length,this.$window.find(".icons-5").toggleClass("hidden",this.iconsProps.iconsLength<5),this.$window.find(".icons-4").toggleClass("hidden",this.iconsProps.iconsLength<4);var n=this.iconsControls;n.length<this.iconsProps.iconsLength&&this.addNewIconsLine(),n.length<this.iconsProps.iconsLength&&this.addNewIconsLine();for(var a=0;a<e.length;a++){(c=n[a]).cmbType.setValue(e[a].asc_getType()),c.value.setValue(e[a].asc_getVal()||""),c.cmbOperator.setValue(e[a].asc_getGte())}var o=[];i&&i.length>0?(this.cmbIconsPresets.setValue(this.textCustom),_.each(i,(function(t){t.asc_getIconSet()==Asc.EIconSetType.NoIcons?o.push(-1):o.push(s.collectionPresets.at(t.asc_getIconSet()).get("icons")[t.asc_getIconId()])}))):(this.cmbIconsPresets.setValue(t),o=s.collectionPresets.at(t).get("icons"));var l=this.iconsProps.isReverse,r=o.length;for(a=0;a<o.length;a++){var c=n[l?r-a-1:a],d=-1==o[a]?null:c.pickerIcons.store.findWhere({value:o[a]-1});c.cmbIcons.selectRecord(d),c.pickerIcons.currentIconValue=d?d.get("value"):-1,c.itemNoIcons.setChecked(!d,!0)}this.fillIconsLabels()},fillIconsLabels:function(){var t=this.iconsControls,e=this.iconsProps.iconsLength,i=new RegExp("^s*[-]?[0-9]+[,.]?[0-9]*s*$"),s=t[1].value.getValue();t[0].label.text(Common.Utils.String.format(this.textIconLabelFirst,t[1].cmbOperator.getSelectedRecord().prevOp,i.test(s)?parseFloat(s):this.textFormula));for(var n=1;n<e-1;n++)s=t[n+1].value.getValue(),t[n].label.text(Common.Utils.String.format(this.textIconLabel,t[n+1].cmbOperator.getSelectedRecord().prevOp,i.test(s)?parseFloat(s):this.textFormula));t[e-1].label.text(this.textIconLabelLast)},reverseIconsControls:function(){for(var t=this.iconsControls,e=this.iconsProps.iconsLength,i=0;i<e/2;i++){var s=t[i],n=t[e-i-1],a=s.itemNoIcons.isChecked()?-1:s.pickerIcons.currentIconValue,o=n.itemNoIcons.isChecked()?-1:n.pickerIcons.currentIconValue,l=s.pickerIcons.store.findWhere({value:o});s.cmbIcons.selectRecord(l),s.pickerIcons.currentIconValue=l?l.get("value"):-1,s.itemNoIcons.setChecked(!l,!0),l=n.pickerIcons.store.findWhere({value:a}),n.cmbIcons.selectRecord(l),n.pickerIcons.currentIconValue=l?l.get("value"):-1,n.itemNoIcons.setChecked(!l,!0)}},onSelectIcon:function(t,e,i,s){e.currentIconValue=s.get("value"),t.getMenu().items[0].setChecked(!1,!0),this.cmbIconsPresets.setValue(this.textCustom)},onSelectNoIcon:function(t,e,i,s){s&&(t.selectRecord(null),this.cmbIconsPresets.setValue(this.textCustom))},isRangeValid:function(){var t,e=this.ruleStore.findWhere({index:this.cmbCategory.getValue()});if(e){var i,s,n=e.get("type"),a=[];switch(n){case Asc.c_oAscCFType.containsText:case Asc.c_oAscCFType.expression:""===this.txtRange1.getValue()?i=n==Asc.c_oAscCFType.containsText?this.textEmptyText:this.textEmptyFormulaExt:(t=this.api.asc_isValidDataRefCf(n,[[this.txtRange1.getValue()]]))&&(t=t[0]),(t||i)&&(s=this.txtRange1);break;case Asc.c_oAscCFType.cellIs:var o=this.cmbRule.getValue();""===this.txtRange1.getValue()?(i=this.textEmptyValue,s=this.txtRange1):o!=Asc.c_oAscCFOperator.notBetween&&o!=Asc.c_oAscCFOperator.between||""!==this.txtRange2.getValue()?(a=[[this.txtRange1.getValue()]],o!=Asc.c_oAscCFOperator.notBetween&&o!=Asc.c_oAscCFOperator.between||a.push([this.txtRange2.getValue()]),(t=this.api.asc_isValidDataRefCf(n,a))&&(s=t[1]?this.txtRange2:this.txtRange1,t=t[0])):(i=this.textEmptyValue,s=this.txtRange2);break;case Asc.c_oAscCFType.top10:var l=!!this.cmbPercent.getValue();(t=this.api.asc_isValidDataRefCf(n,[[this.numRank.getNumberValue(),l]]))&&(t=t[0]),t==Asc.c_oAscError.ID.ErrorTop10Between&&(i=Common.Utils.String.format(this.textErrorTop10Between,l?0:1,l?100:1e3));break;case Asc.c_oAscCFType.colorScale:for(var r=e.get("num"),c=2==r?[this.scaleControls[0],this.scaleControls[2]]:this.scaleControls,d=0;d<r;d++)if(!c[d].range.isDisabled()&&""===c[d].range.getValue()){i=c[d].combo.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,s=c[d].range;break}if(!i){for(d=0;d<r;d++)a.push([c[d].range.getValue(),c[d].combo.getValue()]);if(t=this.api.asc_isValidDataRefCf(n,a)){var h=t[1];s=c[h].range,(t=t[0])==Asc.c_oAscError.ID.ValueMustBeGreaterThen?i=Common.Utils.String.format(this.textErrorGreater,0==h?this.textMinpoint:h==r-1?this.textMaxpoint:this.textMidpoint,h==r-1&&3==r?this.textMidpoint:this.textMinpoint):t==Asc.c_oAscError.ID.NotValidPercentage?i=Common.Utils.String.format(this.textNotValidPercentageExt,0==h?this.textMinpoint:h==r-1?this.textMaxpoint:this.textMidpoint):t==Asc.c_oAscError.ID.NotValidPercentile&&(i=Common.Utils.String.format(this.textNotValidPercentileExt,0==h?this.textMinpoint:h==r-1?this.textMaxpoint:this.textMidpoint))}}break;case Asc.c_oAscCFType.dataBar:var p=this.barControls;for(d=0;d<p.length;d++)if(!p[d].range.isDisabled()&&""===p[d].range.getValue()){i=p[d].combo.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,s=p[d].range;break}if(!i){for(d=0;d<p.length;d++)a.push([p[d].range.getValue(),p[d].combo.getValue()]);if(t=this.api.asc_isValidDataRefCf(n,a)){h=t[1];s=p[h].range,(t=t[0])==Asc.c_oAscError.ID.NotValidPercentage?i=Common.Utils.String.format(this.textNotValidPercentageExt,h?this.textLongBar:this.textShortBar):t==Asc.c_oAscError.ID.NotValidPercentile&&(i=Common.Utils.String.format(this.textNotValidPercentileExt,h?this.textLongBar:this.textShortBar))}}break;case Asc.c_oAscCFType.iconSet:var u=this.iconsControls;for(d=0;d<this.iconsProps.iconsLength;d++)if(!u[d].value.isDisabled()&&""===u[d].value.getValue()){i=u[d].cmbType.getValue()==Asc.c_oAscCfvoType.Formula?this.textEmptyFormula:this.textEmptyText,s=u[d].value;break}if(!i){for(d=0;d<this.iconsProps.iconsLength;d++)a.push([u[d].value.getValue(),u[d].cmbType.getValue()]);(t=this.api.asc_isValidDataRefCf(n,a))&&(s=u[t[1]].value,t=t[0])}}if(!i&&t){var m=SSE.getController("Main");switch(t){case Asc.c_oAscError.ID.NotValidPercentile:i=this.textNotValidPercentile;break;case Asc.c_oAscError.ID.NotValidPercentage:i=this.textNotValidPercentage;break;case Asc.c_oAscError.ID.CannotAddConditionalFormatting:i=this.textCannotAddCF;break;case Asc.c_oAscError.ID.NotSingleReferenceCannotUsed:i=this.textSingleRef;break;case Asc.c_oAscError.ID.CannotUseRelativeReference:i=this.textRelativeRef;break;case Asc.c_oAscError.ID.IconDataRangesOverlap:i=this.textIconsOverlap;break;case Asc.c_oAscError.ID.FrmlWrongCountParentheses:i=m.errorWrongBracketsCount;break;case Asc.c_oAscError.ID.FrmlWrongOperator:i=m.errorWrongOperator;break;case Asc.c_oAscError.ID.FrmlWrongMaxArgument:i=m.errorCountArgExceed;break;case Asc.c_oAscError.ID.FrmlWrongCountArgument:i=m.errorCountArg;break;case Asc.c_oAscError.ID.FrmlWrongFunctionName:i=m.errorFormulaName;break;case Asc.c_oAscError.ID.FrmlAnotherParsingError:i=m.errorFormulaParsing;break;case Asc.c_oAscError.ID.FrmlWrongArgumentRange:i=m.errorArgsRange;break;case Asc.c_oAscError.ID.FrmlOperandExpected:i=m.errorOperandExpected;break;case Asc.c_oAscError.ID.FrmlWrongReferences:i=m.errorFrmlWrongReferences;break;case Asc.c_oAscError.ID.FrmlMaxTextLength:i=m.errorFrmlMaxTextLength;break;case Asc.c_oAscError.ID.FrmlMaxReference:i=m.errorFrmlMaxReference;break;case Asc.c_oAscError.ID.FrmlMaxLength:i=m.errorFrmlMaxLength;break;default:i=this.textInvalid}}return i&&Common.UI.warning({msg:i,maxwidth:600,callback:function(t){s&&s.focus()}}),!i}},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;if("ok"==e){if(!this.isRangeValid())return;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0)}this.close()},txtTitleNew:"New Formatting Rule",txtTitleEdit:"Edit Formatting Rule",textSelectData:"Select Data",textApply:"Apply to Range",textRule:"Rule",txtEmpty:"This field is required",textInvalidRange:"ERROR! Invalid cells range",notcriticalErrorTitle:"Warning",textFormat:"Format",textCustom:"Custom",textBold:"Bold",textItalic:"Italic",textUnderline:"Underline",textStrikeout:"Strikeout",textSuperscript:"Superscript",textSubscript:"Subscript",textColor:"Text color",fillColor:"Background color",textMinpoint:"Minpoint",textMidpoint:"Midpoint",textMaxpoint:"Maxpoint",textMinimum:"Minimum",textMaximum:"Maximum",textAppearance:"Bar Appearance",txtNumber:"Number",txtGeneral:"General",txtCurrency:"Currency",txtAccounting:"Accounting",txtDate:"Date",txtDateShort:"Short Date",txtDateLong:"Long Date",txtTime:"Time",txtPercentage:"Percentage",txtFraction:"Fraction",txtScientific:"Scientific",txtText:"Text",tipBorders:"Borders",textOutBorders:"Outside Borders",textAllBorders:"All Borders",textTopBorders:"Top Borders",textBottomBorders:"Bottom Borders",textLeftBorders:"Left Borders",textRightBorders:"Right Borders",textNoBorders:"No Borders",textInsideBorders:"Inside Borders",textMiddleBorders:"Inside Horizontal Borders",textCenterBorders:"Inside Vertical Borders",textDiagDownBorder:"Diagonal Down Border",textDiagUpBorder:"Diagonal Up Border",textBordersStyle:"Border Style",textBordersColor:"Borders Color",textNewColor:"Add New Custom Color",tipNumFormat:"Number Format",textPreview:"Preview",text2Scales:"2 Color scale",text3Scales:"3 Color scale",textPercent:"Percent",textFormula:"Formula",textPercentile:"Percentile",textAutomatic:"Automatic",textContext:"Context",textLeft2Right:"Left to right",textRight2Left:"Right to left",textNone:"None",textSolid:"Solid",textCellMidpoint:"Cell midpoint",textGradient:"Gradient",textFill:"Fill",textPositive:"Positive",textNegative:"Negative",textBorder:"Border",textBarDirection:"Bar Direction",textAxis:"Axis",textPosition:"Position",textShowBar:"Show bar only",textSameAs:"Same as positive",textIconStyle:"Icon Style",textReverse:"Reverse Icons Order",textShowIcon:"Show icon only",textIconLabelFirst:"when {0} {1}",textIconLabel:"when {0} {1} and",textIconLabelLast:"when value is",textEmptyText:"Enter a value.",textEmptyFormula:"Enter a valid formula.",textEmptyFormulaExt:"The formula you entered does not evaluate to a number, date, time or string.",textEmptyValue:"The value you entered is not a valid number, date, time or string.",textErrorTop10Between:"Enter a number between {0} and {1}.",textNotValidPercentage:"One or more of the specified values is not a valid percentage.",textNotValidPercentile:"One or more of the specified values is not a valid percentile.",textNotValidPercentageExt:"The specified {0} value is not a valid percentage.",textNotValidPercentileExt:"The specified {0} value is not a valid percentile.",textShortBar:"shortest bar",textLongBar:"longest bar",textCannotAddCF:"Cannot add the conditional formatting.",textIconsOverlap:"One or more icon data ranges overlap.<br>Adjust icon data range values so that the ranges do not overlap.",textSingleRef:"This type of reference cannot be used in a conditional formatting formula.<br>Change the reference to a single cell, or use the reference with a worksheet function, such as =SUM(A1:B5).",textRelativeRef:"You cannot use relative references in conditional formatting criteria for color scales, data bars, and icon sets.",textErrorGreater:"The value for the {0} must be greater than the value for the {1}.",textInvalid:"Invalid data range.",textClear:"Clear",textItem:"Item",textPresets:"Presets",txtNoCellIcon:"No Icon"},SSE.Views.FormatRulesEditDlg||{}))})),define("text!spreadsheeteditor/main/app/template/FormatRulesManagerDlg.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan=2>\n                     <label><%= scope.textScope %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="format-manager-combo-scope" class="input-group-nr" style="width:185px;"></div>\n                </td>\n                <td id="format-manager-btn-group" class="padding-small text-align-right">\n                    <button type="button" class="btn btn-text-default format-manager-btn-text margin-right-5" id="format-manager-btn-new"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default format-manager-btn-text margin-right-5" id="format-manager-btn-edit"><%= scope.textEdit %></button>\n                    <div id="format-manager-btn-up" style="display: inline-block;"></div>\n                    <div id="format-manager-btn-down" class="margin-right-15" style="display: inline-block;"></div>\n                    <button type="button" class="btn btn-text-default format-manager-btn-text" id="format-manager-btn-delete"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2>\n                    <div style="position: relative;">\n                    <div style="width: 100%;" id="format-manager-rules-list">\n                        <div id="id-preview">\n                            <div>\n                                <div style="position: absolute; top: 0;width:100%;"><div id="id-preview-data" class="range-tableview"></div></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/FormatRulesManagerDlg",["text!spreadsheeteditor/main/app/template/FormatRulesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{};var e=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:name",(function(){e.render(),e.trigger("change",e,e.model)})),e.listenTo(e.model,"change:lock",(function(){e.render(),e.trigger("change",e,e.model)})),e.listenTo(e.model,"change:tip",(function(){var t=e.$el||$(e.el),i=t.data("bs.tooltip");if(i){var s=i.options.zIndex;t.removeData("bs.tooltip"),t.tooltip({title:e.model.get("tip"),placement:"cursor",zIndex:s})}})),e.listenTo(e.model,"change:selected",(function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))})),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.FormatRulesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"FormatRulesManagerDlg",separator:!1,contentWidth:560},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this.langId=e.langId,this.rules=[],this.rulesStores={},this.rulesDeleted=[],this.listSettings={data:[],start:0,end:0,min:0,max:0},this.locked=e.locked||!1,this.userTooltip=!0,this.wrapEvents={onLockCFManager:_.bind(this.onLockCFManager,this),onUnLockCFManager:_.bind(this.onUnLockCFManager,this),onLockCFRule:_.bind(this.onLockCFRule,this),onUnLockCFRule:_.bind(this.onUnLockCFRule,this)},this.nLastScroll=-1e3,this.itemHeight=30,this.previewListHeight=203,this.maxItemsCount=parseInt(this.previewListHeight/this.itemHeight),this._keydowncounter=0,this._keydownTimer=void 0,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbScope=new Common.UI.ComboBox({el:$("#format-manager-combo-scope"),menuStyle:"min-width: 100%;max-height: 211px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",(function(e,i){t.refreshRuleList(i)})),this.rulesList=new Common.UI.ListView({el:$("#id-preview-data",this.$window),store:new Common.UI.DataViewStore,emptyText:"",headers:[{name:this.textRules,width:198},{name:this.textApply,width:196},{name:this.textFormat,width:130}],isRTL:!0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;display:inline-block;" id="format-manager-item-<%= ruleIndex %>">','<div style="width:197px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 10px;display: inline-block;vertical-align: middle;overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div style="width:197px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 10px;display: inline-block;vertical-align: middle;"><div id="format-manager-txt-rule-<%= ruleIndex %>" style=""></div></div>','<div style="width:128px;display: inline-block;vertical-align: middle;"><div id="format-manager-item-preview-<%= ruleIndex %>" style="height:22px;background-color: #ffffff;"></div></div>',"<% if (lock) { %>",'<div class="lock-user"><%=Common.Utils.String.htmlEncode(lockuser)%></div>',"<% } %>","</div>"].join("")),allowScrollbar:!1,tabindex:1}),this.rulesList.moveKeys=[],this.rulesList.createNewItem=function(t){return new e({template:this.itemTemplate,model:t})},this.rulesList.on("item:select",_.bind(this.onSelectRule,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:keyup",_.bind(this.onKeyUp,this)).on("item:dblclick",_.bind(this.onEditRule,this,!0)).on("entervalue",_.bind((function(t){t.store.length&&this.onEditRule(!0)}),this)),this.btnNew=new Common.UI.Button({el:$("#format-manager-btn-new")}),this.btnNew.on("click",_.bind(this.onEditRule,this,!1)),this.btnEdit=new Common.UI.Button({el:$("#format-manager-btn-edit")}),this.btnEdit.on("click",_.bind(this.onEditRule,this,!0)),this.btnDelete=new Common.UI.Button({el:$("#format-manager-btn-delete")}),this.btnDelete.on("click",_.bind(this.onDeleteRule,this)),this.btnUp=new Common.UI.Button({parentEl:$("#format-manager-btn-up"),cls:"btn-toolbar bg-white",iconCls:"caret-up",scaling:!1,hint:this.textUp}),this.btnUp.on("click",_.bind(this.onMoveClick,this,!0)),this.btnDown=new Common.UI.Button({parentEl:$("#format-manager-btn-down"),cls:"btn-toolbar bg-white",iconCls:"caret-down",scaling:!1,hint:this.textDown}),this.btnDown.on("click",_.bind(this.onMoveClick,this,!1)),this.previewPanel=this.$window.find("#id-preview-data"),this.previewParent=this.previewPanel.parent(),this.previewScrolled=this.$window.find("#id-preview"),this.previewInner=this.previewScrolled.find("> div:first-child"),this.previewPanel.css("height",this.previewListHeight+"px"),this.previewScrolled.css("height",this.previewListHeight+"px"),this.afterRender()},getDefaultFocusableComponent:function(){return this.cmbScope},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){Common.UI.FocusManager.add(this,this.cmbScope),Common.UI.FocusManager.add(this,this.btnNew),Common.UI.FocusManager.add(this,this.btnEdit),Common.UI.FocusManager.add(this,this.btnUp),Common.UI.FocusManager.add(this,this.btnDown),Common.UI.FocusManager.add(this,this.btnDelete),Common.UI.FocusManager.add(this,this.rulesList),this.rulesList.on("item:add",_.bind(this.addControls,this)),this.rulesList.on("item:change",_.bind(this.addControls,this)),this.currentSheet=this.api.asc_getActiveWorksheetIndex(),this.refreshScopeList(),this.refreshRuleList(this.cmbScope.getSelectedRecord()),this.api.asc_registerCallback("asc_onLockCFManager",this.wrapEvents.onLockCFManager),this.api.asc_registerCallback("asc_onUnLockCFManager",this.wrapEvents.onUnLockCFManager),this.api.asc_registerCallback("asc_onLockCFRule",this.wrapEvents.onLockCFRule),this.api.asc_registerCallback("asc_onUnLockCFRule",this.wrapEvents.onUnLockCFRule),Common.UI.FocusManager.add(this,this.getFooterButtons())},refreshScopeList:function(){this.api.asc_getWorksheetsCount();var t=[{value:Asc.c_oAscSelectionForCFType.selection,displayValue:this.textSelection,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.worksheet,displayValue:this.textThisSheet,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.table,displayValue:this.textThisTable,sheetIndex:-1},{value:Asc.c_oAscSelectionForCFType.pivot,displayValue:this.textThisPivot,sheetIndex:-1}];this.cmbScope.setData(t),this.cmbScope.setValue(Asc.c_oAscSelectionForCFType.selection)},refreshRuleList:function(t){this.rules=[];var e=t.sheetIndex>-1?t.sheetIndex:this.currentSheet,i=this.rulesStores[e];if(!i){i=[];var s=this.api.asc_getCF(Asc.c_oAscSelectionForCFType.worksheet,e),n=s[0];if(this.currentRange=s[1],n)for(var a=0;a<n.length;a++){var o=n[a],l=this.getRuleName(o),r=o.asc_getLocation(),c=o.asc_getIsLock();i.push({ruleIndex:a,ruleId:o.asc_getId(),name:l,tip:l,range:r[1],activeSheet:r[0],priority:o.asc_getPriority(),ruleChanged:!1,props:o,lock:null!=c,lockuser:c?this.isUserVisible(c)?this.getUserName(c):this.lockText:this.guestText})}this.rulesStores[e]=i}this.nLastScroll=-1e3,this.updateRulesCount(!0),this.scrollerY||(this.scrollerY=new Common.UI.Scroller({el:this.previewScrolled,minScrollbarLength:20,wheelSpeed:20,scrollYStyle:this.rulesList.scrollYStyle,onChange:_.bind((function(){this.scrollerY&&(this._preventUpdateScroll=!0,this.onScrollEnd(),this._preventUpdateScroll=!1,this.previewParent.height(this.previewListHeight),this.previewParent.css({top:this.scrollerY.getScrollTop()}))}),this)})),this.scrollerY.update(),this.scrollerY.scrollTop(0),this.listSettings.data.length>0&&(this.listSettings.current=0,this.rulesList.selectByIndex(0)),this.updateButtons()},onScrollEnd:function(){if(this.scrollerY.getScrollTop()!==this.nLastScroll){this.nLastScroll=this.scrollerY.getScrollTop();var t=this.scrollerY.getScrollTop(),e=Math.floor(t/this.itemHeight+.5),i=e+this.maxItemsCount-1;i>this.listSettings.data.length-1&&(i=this.listSettings.data.length-1,e=Math.max(0,i-this.maxItemsCount+1)),this.previewDataBlock(e,i)}},previewDataBlock:function(t,e){this.listSettings.start=t,this.listSettings.end=e;var i=this.rulesStores[this.currentSheet],s=[];this.rulesList.store.remove(this.rulesList.store.models);for(var n=t;n<=e;n++)s.push(i[this.listSettings.data[n]]);this.rulesList.store.add(s),this.listSettings.current<=this.listSettings.end&&this.rulesList.selectByIndex(this.listSettings.current-this.listSettings.start),this._preventUpdateScroll||(this.scrollerY.update({minScrollbarLength:20,wheelSpeed:20}),this.scrollerY.scrollTop(this.listSettings.start*this.itemHeight)),!0===this.userTooltip&&this.rulesList.cmpEl.find(".lock-user").length>0&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))},onMouseOverLock:function(t,e,i){if(!0===this.userTooltip&&$(t.target).hasClass("lock-user")){var s=this,n=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip");this.userTooltip=n.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),n.show(),setTimeout((function(){s.userTipHide()}),5e3)}},userTipHide:function(){"object"==_typeof(this.userTooltip)&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rulesList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==_typeof(this.userTooltip)&&this.userTipHide()},getRuleName:function(t){var e="";switch(t.asc_getType()){case Asc.c_oAscCFType.aboveAverage:e=this.textAbove;var i=t.asc_getAboveAverage(),s=t.asc_getEqualAverage(),n=t.asc_getStdDev();switch(a=i?0:1,s?a+=2:n&&(a+=2+2*n),a){case 0:e=this.textAbove;break;case 1:e=this.textBelow;break;case 2:e=this.textEqAbove;break;case 3:e=this.textEqBelow;break;case 4:e=this.text1Above;break;case 5:e=this.text1Below;break;case 6:e=this.text2Above;break;case 7:e=this.text2Below;break;case 8:e=this.text3Above;break;case 9:e=this.text3Below}break;case Asc.c_oAscCFType.beginsWith:e=this.textBeginsWith+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.cellIs:switch(e=this.textCellValue,a=t.asc_getOperator()){case Asc.c_oAscCFOperator.greaterThan:e=e+" "+">"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.greaterThanOrEqual:e=e+" "+">="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.lessThan:e=e+" "+"<"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.lessThanOrEqual:e=e+" "+"<="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.equal:e=e+" "+"="+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.notEqual:e=e+" "+"<>"+" "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFOperator.between:e=e+" "+Common.Utils.String.format(this.textBetween,t.asc_getValue1()||"",t.asc_getValue2()||"");break;case Asc.c_oAscCFOperator.notBetween:e=e+" "+Common.Utils.String.format(this.textNotBetween,t.asc_getValue1()||"",t.asc_getValue2()||"")}break;case Asc.c_oAscCFType.colorScale:e=this.textColorScale;break;case Asc.c_oAscCFType.containsBlanks:e=this.textContainsBlank;break;case Asc.c_oAscCFType.containsErrors:e=this.textContainsError;break;case Asc.c_oAscCFType.containsText:e=this.textContains+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.dataBar:e=Common.define.conditionalData.textDataBar;break;case Asc.c_oAscCFType.duplicateValues:e=this.textDuplicate;break;case Asc.c_oAscCFType.expression:e=Common.define.conditionalData.textFormula+": "+(t.asc_getValue1()||"");break;case Asc.c_oAscCFType.iconSet:e=this.textIconSet;break;case Asc.c_oAscCFType.notContainsBlanks:e=this.textNotContainsBlank;break;case Asc.c_oAscCFType.notContainsErrors:e=this.textNotContainsError;break;case Asc.c_oAscCFType.notContainsText:e=this.textNotContains+" "+(t.asc_getContainsText()||"");break;case Asc.c_oAscCFType.timePeriod:var a;switch(a=t.asc_getTimePeriod()){case Asc.c_oAscTimePeriod.yesterday:e=Common.define.conditionalData.textYesterday;break;case Asc.c_oAscTimePeriod.today:e=Common.define.conditionalData.textToday;break;case Asc.c_oAscTimePeriod.tomorrow:e=Common.define.conditionalData.textTomorrow;break;case Asc.c_oAscTimePeriod.last7Days:e=Common.define.conditionalData.textLast7days;break;case Asc.c_oAscTimePeriod.lastWeek:e=Common.define.conditionalData.textLastWeek;break;case Asc.c_oAscTimePeriod.thisWeek:e=Common.define.conditionalData.textThisWeek;break;case Asc.c_oAscTimePeriod.nextWeek:e=Common.define.conditionalData.textNextWeek;break;case Asc.c_oAscTimePeriod.lastMonth:e=Common.define.conditionalData.textLastMonth;break;case Asc.c_oAscTimePeriod.thisMonth:e=Common.define.conditionalData.textThisMonth;break;case Asc.c_oAscTimePeriod.nextMonth:e=Common.define.conditionalData.textNextMonth}break;case Asc.c_oAscCFType.top10:e=(e=t.asc_getBottom()?Common.define.conditionalData.textBottom:Common.define.conditionalData.textTop)+" "+t.asc_getRank()+(t.asc_getPercent()?"%":"");break;case Asc.c_oAscCFType.uniqueValues:e=this.textUnique;break;case Asc.c_oAscCFType.endsWith:e=this.textEnds+" "+(t.asc_getContainsText()||"")}return e},addControls:function(t,e,i){if(i){var s=this,n=i.get("ruleIndex"),a=this.rulesList.cmpEl.find("#format-manager-item-"+n);this.rules[n]||(this.rules[n]={});var o=this.rules[n],l=new Common.UI.InputFieldBtn({el:a.find("#format-manager-txt-rule-"+n),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,disabled:!i.get("activeSheet")||i.get("lock"),validateOnChange:!0}).on("changed:after",(function(t,e,n,a){o.dataRangeValid!==e&&(s.isRangeValid(e)?(o.dataRangeValid=e,i.set("ruleChanged",!0),i.get("props").asc_setLocation(o.dataRangeValid),i.set("range",o.dataRangeValid),s.rulesStores[s.currentSheet][i.get("indexInStore")].ruleChanged=!0,s.rulesStores[s.currentSheet][i.get("indexInStore")].range=o.dataRangeValid):o.txtDataRange.setValue(o.dataRangeValid))})).on("button:click",_.bind(this.onSelectData,this,o,i));l.cmpEl.on("dblclick","input",(function(t){t.stopPropagation()})),Common.UI.FocusManager.add(this,l);var r=i.get("range");null!==r&&l.setValue(r),o.txtDataRange=l,o.dataRangeValid=r,o.previewDiv="format-manager-item-preview-"+n,s.drawRulePreview(i),a.on("mousedown","input",(function(){s.rulesList.selectRecord(i)}))}},drawRulePreview:function(t){var e=t.get("props"),i=e.asc_getType(),s="";i!=Asc.c_oAscCFType.containsText&&i!=Asc.c_oAscCFType.notContainsText&&i!=Asc.c_oAscCFType.beginsWith&&i!=Asc.c_oAscCFType.endsWith&&i!=Asc.c_oAscCFType.containsBlanks&&i!=Asc.c_oAscCFType.notContainsBlanks&&i!=Asc.c_oAscCFType.duplicateValues&&i!=Asc.c_oAscCFType.uniqueValues&&i!=Asc.c_oAscCFType.containsErrors&&i!=Asc.c_oAscCFType.notContainsErrors&&i!=Asc.c_oAscCFType.timePeriod&&i!=Asc.c_oAscCFType.aboveAverage&&i!=Asc.c_oAscCFType.top10&&i!=Asc.c_oAscCFType.cellIs&&i!=Asc.c_oAscCFType.expression||(s=e.asc_getDxf()?Common.define.conditionalData.exampleText:Common.define.conditionalData.noFormatText),e.asc_getPreview(this.rules[t.get("ruleIndex")].previewDiv,s)},isRangeValid:function(t){return Asc.c_oAscError.ID.No===this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,t,!0)},onSelectData:function(t,e){var i=this;if(i.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){"ok"==n&&(i.isRangeValid(s.getSettings())&&(t.dataRangeValid=s.getSettings(),e.set("ruleChanged",!0),e.get("props").asc_setLocation(t.dataRangeValid),e.set("range",t.dataRangeValid),i.rulesStores[i.currentSheet][e.get("indexInStore")].ruleChanged=!0,i.rulesStores[i.currentSheet][e.get("indexInStore")].range=t.dataRangeValid),t.txtDataRange.setValue(t.dataRangeValid))}}).on("close",(function(){i.show()})),n=Common.Utils.getOffset(i.$window);i.hide(),s.show(i.$window,n),s.setSettings({api:i.api,range:_.isEmpty(t.txtDataRange.getValue())?t.dataRangeValid:t.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}})}},onEditRule:function(t){var e,i=this,s=Common.Utils.getOffset(i.$window),n=this.rulesList.getSelectedRec(),a=new SSE.Views.FormatRulesEditDlg({api:i.api,props:t&&n?n.get("props"):null,isEdit:t,langId:i.langId,handler:function(s,a){if("ok"==s&&a){var o=i.getRuleName(a);if(t){var l=i.rulesStores[i.currentSheet][n.get("indexInStore")];l.name=l.tip=o,l.ruleChanged=!0,l.props=a,n.set("name",o),n.set("tip",o),n.set("ruleChanged",!0),n.set("props",a),e=n}else{a.asc_setLocation(i.currentRange);var r=i.rulesStores[i.currentSheet];e=r.unshift({ruleIndex:i.rules.length,name:o,tip:o,range:i.currentRange,activeSheet:!0,ruleChanged:!0,priority:1,props:a,lock:!1,lockuser:""}),i.updateRulesPriority(r)}}}}).on("close",(function(){i.show(),t?e&&i.drawRulePreview(e):e&&(i.cmbScope.setValue(Asc.c_oAscSelectionForCFType.selection),i.refreshRuleList(i.cmbScope.getSelectedRecord()))}));i.hide(),a.show(s.left,s.top)},onDeleteRule:function(){var t=this.rulesList.store,e=this.rulesList.getSelectedRec();if(e){var i=e.get("ruleId");void 0!==i&&this.rulesDeleted.push(i),this.rules[e.get("ruleIndex")]=void 0,this.rulesStores[this.currentSheet].splice(e.get("indexInStore"),1);var s=t.indexOf(e);this.updateRulesCount(!0);var n=this.listSettings.start,a=n+this.maxItemsCount-1;a>this.listSettings.data.length-1&&(a=this.listSettings.data.length-1,n=Math.max(0,a-this.maxItemsCount+1)),this.previewDataBlock(n,a),this.listSettings.data.length>0&&this.rulesList.selectByIndex(Math.min(s,t.length-1))}this.updateButtons()},onMoveClick:function(t){var e=this.rulesStores[this.currentSheet],i=this.rulesList.getSelectedRec(),s=this.rulesList.store.indexOf(i);if(i){var n=i.get("indexInStore"),a=t?this.getPrevRuleIndex(n):this.getNextRuleIndex(n),o=e[a],l=o.priority;i=e[n],o.priority=i.priority,i.priority=l,e.splice(a,1,i),e.splice(n,1,o);var r=0===s&&t?this.listSettings.start-1:!t&&s>=this.maxItemsCount-1?this.listSettings.start+1:this.listSettings.start,c=r+this.maxItemsCount-1;c>this.listSettings.data.length-1&&(c=this.listSettings.data.length-1,r=Math.max(0,c-this.maxItemsCount+1)),t?this.listSettings.current--:this.listSettings.current++,this.updateRulesCount(),this.previewDataBlock(r,c)}this.updateMoveButtons()},onSelectRule:function(t,e,i){var s=_.indexOf(t.store.models,i);this.listSettings.current=this.listSettings.start+s,this.userTipHide(),this.updateButtons()},updateButtons:function(){var t=this.rulesList.getSelectedRec(),e=!!t&&t.get("lock");this.btnNew.setDisabled(this.locked),this.btnDelete.setDisabled(this.listSettings.data.length<1||e),this.btnEdit.setDisabled(this.listSettings.data.length<1||e),this.updateMoveButtons()},updateMoveButtons:function(){var t=this.rulesList.getSelectedRec(),e=t?this.rulesList.store.indexOf(t):-1;this.btnUp.setDisabled(e+this.listSettings.start<1||this.locked),this.btnDown.setDisabled(e<0||e+this.listSettings.start>=this.listSettings.data.length-1||this.locked)},getPrevRuleIndex:function(t){if(this.cmbScope.getValue()===Asc.c_oAscSelectionForCFType.worksheet)return Math.max(0,t-1);for(var e=this.rulesStores[this.currentSheet],i=t-1;i>=this.listSettings.min;i--)if("hidden"!==e[i].cls)return i;return this.listSettings.min},getNextRuleIndex:function(t){if(this.cmbScope.getValue()==Asc.c_oAscSelectionForCFType.worksheet)return Math.min(this.listSettings.data.length-1,t+1);for(var e=this.rulesStores[this.currentSheet],i=t+1;i<=this.listSettings.max;i++)if("hidden"!==e[i].cls)return i;return this.listSettings.max},updateRulesCount:function(t){var e=this.rulesStores[this.currentSheet],i=this.cmbScope.getSelectedRecord(),s=this;t&&(this.listSettings.data=[]),this.listSettings.min=-1,this.listSettings.max=0,e.forEach((function(e,n){var a=i.value!==Asc.c_oAscSelectionForCFType.worksheet&&!e.props.asc_checkScope(i.value);e.cls=a?"hidden":void 0,e.indexInStore=n,a||(t&&s.listSettings.data.push(n),s.listSettings.max=n,s.listSettings.min<0&&(s.listSettings.min=n))})),t&&this.previewInner.height(this.listSettings.data.length*this.itemHeight+this.rulesList.headerHeight)},updateRulesPriority:function(t){for(var e=1;e<t.length;e++)t[e].priority++},getSettings:function(){var t=[];for(var e in this.rulesStores)if(this.rulesStores.hasOwnProperty(e)){var i=this.rulesStores[e],s=[];i&&i.forEach((function(t){var e=t.props;t.priority!==e.asc_getPriority()&&(e.asc_setPriority(t.priority),t.ruleChanged=!0),t.ruleChanged&&s.push(e)})),s.length>0&&(t[e]=s)}return{rules:t,deleted:this.rulesDeleted}},onKeyDown:function(t,e,i){if(i.keyCode!=Common.UI.Keys.UP&&i.keyCode!=Common.UI.Keys.DOWN||(i.preventDefault(),i.stopPropagation()),0===this._keydowncounter)this._keydowncounter++,this.onKeyEvent(t,i);else if(!this._keyEventBusy){this._keyEventBusy=!0;var s=this;this._keydownTimer=setTimeout((function(){s.onKeyEvent(t,i,!0)}),1)}},onKeyUp:function(t,e){this._keydowncounter=0,this._keydownTimer&&(clearTimeout(this._keydownTimer),this._keydownTimer=void 0),this._keyEventBusy=void 0},onKeyEvent:function(t,e,i){if(e.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||/form-control/.test(e.target.className)){if(e.keyCode==Common.UI.Keys.UP||e.keyCode==Common.UI.Keys.DOWN){var s=t.getSelectedRec(),n=_.indexOf(t.store.models,s);n>=0&&(e.keyCode==Common.UI.Keys.UP&&(n>0?(n--,this.listSettings.current--,t.selectByIndex(n)):this.listSettings.start>0&&(this.listSettings.current--,this.previewDataBlock(this.listSettings.start-1,this.listSettings.end-1))),e.keyCode==Common.UI.Keys.DOWN&&(n<t.store.length-1?(n++,this.listSettings.current++,t.selectByIndex(n)):this.listSettings.end<this.listSettings.data.length-1&&(this.listSettings.current++,this.previewDataBlock(this.listSettings.start+1,this.listSettings.end+1))))}}else this.onDeleteRule();var a=this;i&&(this._keydownTimer=setTimeout((function(){a.onKeyEvent(t,e,!0)}),1))},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockCFManager",this.wrapEvents.onLockCFManager),this.api.asc_unregisterCallback("asc_onUnLockCFManager",this.wrapEvents.onUnLockCFManager),this.api.asc_unregisterCallback("asc_onLockCFRule",this.wrapEvents.onLockCFRule),this.api.asc_unregisterCallback("asc_onUnLockCFRule",this.wrapEvents.onUnLockCFRule),this._keydownTimer&&clearTimeout(this._keydownTimer),Common.UI.Window.prototype.close.call(this)},onLockCFManager:function(t){this.currentSheet===t&&(this.locked=!0,this.updateButtons(),!0===this.userTooltip&&this.rulesList.cmpEl.find(".lock-user").length>0&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockCFManager:function(t){this.currentSheet===t&&(this.locked=!1,this.updateButtons())},onLockCFRule:function(t,e,i){if(this.currentSheet===t){var s=this.rulesStores[this.currentSheet],n=_.findWhere(s,{ruleId:e});n&&(n.lockuser=i?this.isUserVisible(i)?this.getUserName(i):this.lockText:this.guestText,n.lock=!0),(n=this.rulesList.store.findWhere({ruleId:e}))&&(n.set("lockuser",s[n.get("indexInStore")].lockuser),n.set("lock",!0),this.updateButtons()),!0===this.userTooltip&&this.rulesList.cmpEl.find(".lock-user").length>0&&this.rulesList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))}},onUnLockCFRule:function(t,e){if(this.currentSheet===t){var i=this.rulesStores[this.currentSheet],s=_.findWhere(i,{ruleId:e});s&&(s.lockuser="",s.lock=!1),(s=this.rulesList.store.findWhere({ruleId:e}))&&(s.set("lockuser",""),s.set("lock",!1),this.updateButtons())}},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return AscCommon.UserInfoParser.getParsedName(i.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},txtTitle:"Conditional Formatting",textNew:"New",textEdit:"Edit",textDelete:"Delete",textUp:"Move rule up",textDown:"Move rule down",textSelection:"Current selection",textThisSheet:"This worksheet",textThisTable:"This table",textThisPivot:"This pivot",textScope:"Show formatting rules for",textRules:"Rules",textApply:"Apply to",textFormat:"Format",textSelectData:"Select data",textAbove:"Above average",textBelow:"Below average",textEqAbove:"Equal to or above average",textEqBelow:"Equal to or below average",text1Above:"1 std dev above average",text1Below:"1 std dev below average",text2Above:"2 std dev above average",text2Below:"2 std dev below average",text3Above:"3 std dev above average",text3Below:"3 std dev below average",textBeginsWith:"Cell value begins with",textCellValue:"Cell value",textBetween:"is between {0} and {1}",textNotBetween:"is not between {0} and {1}",textColorScale:"Graded color scale",textContainsBlank:"Cell contains a blank value",textContainsError:"Cell contains an error",textContains:"Cell value contains",textNotContains:"Cell value does not contain",textNotContainsError:"Cell does not contain an error",textNotContainsBlank:"Cell does not contain a blank value",textEnds:"Cell value ends with",textIconSet:"Icon set",textDuplicate:"Duplicate values",textUnique:"Unique values",tipIsLocked:"This element is being edited by another user.",guestText:"Guest",lockText:"Locked"},SSE.Views.FormatRulesManagerDlg||{}))})),define("spreadsheeteditor/main/app/view/MacroDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.MacroDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:250,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 0 5px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-extra-small">','<label class="input-label">',this.textMacro,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="macro-dlg-txt-name"></div>',"</td>","</tr>","<tr>","<td>",'<div id="macro-dlg-list" style="width:100%; height: 169px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtName=new Common.UI.InputField({el:$("#macro-dlg-txt-name"),allowBlank:!0,validateOnChange:!0,validateOnBlur:!0,style:"width: 100%;",value:"",maxLength:40,validation:function(t){return!0}}).on("changing",(function(e,i){t.findMacro(i)})),this.macroList=new Common.UI.ListView({el:$("#macro-dlg-list",this.$window),store:new Common.UI.DataViewStore,tabindex:1,cls:"dbl-clickable",itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="overflow: hidden; text-overflow: ellipsis;width:216px;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.macroList.on("item:dblclick",_.bind(this.onDblClickMacro,this)),this.macroList.on("entervalue",_.bind(this.onPrimary,this)),this.macroList.on("item:select",_.bind(this.onSelectMacro,this)),this.afterRender()},getFocusedComponents:function(){return[this.txtName,this.macroList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.txtName},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.props=t,this.refreshList()},getSettings:function(){return this.txtName.getValue()},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close(),!1},refreshList:function(){if(this.props&&this.props.macroList){for(var t=this.props.macroList,e=[],i=0;i<t.length;i++)e.push({value:t[i]});this.macroList.store.reset(e),this.props.current&&(this.txtName.setValue(this.props.current),this.findMacro(this.props.current))}},onSelectMacro:function(t,e,i){i&&this.txtName.setValue(i.get("value"))},onDblClickMacro:function(t,e,i){this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close()},findMacro:function(t){var e=this.macroList.store.findWhere({value:t});e?(this.macroList.selectRecord(e),this.macroList.scrollToRecord(e)):this.macroList.deselectAll()},textTitle:"Assign Macro",textMacro:"Macro name"},SSE.Views.MacroDialog||{}))})),define("text!spreadsheeteditor/main/app/template/NameManagerDlg.template",[],(function(){return'<div class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="header"><%= scope.textFilter %></label>\r\n                    <div id="name-manager-combo-filter" class="input-group-nr" style="width:180px;"></div>\r\n                </td>\r\n                <td id="name-manager-group-btn" class="padding-small text-align-right">\r\n                    <button type="button" class="btn btn-text-default margin-right-5" id="name-manager-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\r\n                    <button type="button" class="btn btn-text-default margin-right-15" id="name-manager-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\r\n                    <button type="button" class="btn btn-text-default" id="name-manager-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=2">\r\n                    <div id="name-manager-range-list" class="range-tableview" style="width:100%; height: 191px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("spreadsheeteditor/main/app/view/NameManagerDlg",["text!spreadsheeteditor/main/app/template/NameManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NameManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NameManagerDlg",contentWidth:540,buttons:["close"],separator:!1,id:"window-name-manager"},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.sheets=e.sheets||[],this.sheetNames=e.sheetNames||[],this.ranges=e.ranges||[],this.props=e.props,this.sort=e.sort||{type:"name",direction:1},this.locked=e.locked||!1,this.userTooltip=!0,this.currentNamedRange=void 0,this.rangesStore=new Common.UI.DataViewStore,this.wrapEvents={onRefreshDefNameList:_.bind(this.onRefreshDefNameList,this),onLockDefNameManager:_.bind(this.onLockDefNameManager,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbFilter=new Common.UI.ComboBox({el:$("#name-manager-combo-filter"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textFilterAll},{value:1,displayValue:this.textFilterDefNames},{value:2,displayValue:this.textFilterTableNames},{value:3,displayValue:this.textFilterSheet},{value:4,displayValue:this.textFilterWorkbook}],takeFocusOnClose:!0}).on("selected",(function(e,i){t.refreshRangeList(null,0)})),this.cmbFilter.setValue(0),this.rangeList=new Common.UI.ListView({el:$("#name-manager-range-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,emptyText:this.textEmpty,headers:[{name:t.textRanges,width:171,sortType:"name",style:(Common.UI.isRTL(),"left")},{name:t.textScope,width:122,sortType:"scopeName",style:(Common.UI.isRTL(),"left")},{name:t.textDataRange,width:213}],initSort:{type:this.sort.type,direction:this.sort.direction},itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="listitem-icon toolbar__icon margin-right-5 <% print(isTable?"btn-menu-table":(isSlicer ? "btn-slicer" : "btn-named-range")) %>"></div>','<div style="width:146px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 5px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div style="width:122px;padding-<% if (Common.UI.isRTL()) { %>left<% } else {%>right<% } %>: 5px;"><%= Common.Utils.String.htmlEncode(scopeName) %></div>','<div style="width:209px;"><%= Common.Utils.String.htmlEncode(range) %></div>',"<% if (lock) { %>",'<div class="lock-user"><%=Common.Utils.String.htmlEncode(lockuser)%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.store.comparator=function(e,i){var s=e.get(t.sort.type).toLowerCase(),n=i.get(t.sort.type).toLowerCase();return s==n?0:s<n?-t.sort.direction:t.sort.direction},this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#name-manager-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#name-manager-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#name-manager-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.rangeList.on("header:click",_.bind(this.onSortNames,this)),this.afterRender()},getFocusedComponents:function(){return[this.cmbFilter,this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRangeList(this.ranges,0),this.api.asc_registerCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_registerCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList)},onRefreshDefNameList:function(){this.refreshRangeList(this.api.asc_getDefinedNames(Asc.c_oAscGetDefinedNamesList.All),this.currentNamedRange)},refreshRangeList:function(t,e){if(t){this.ranges=t;for(var i=[],s=0;s<this.ranges.length;s++){var n=this.ranges[s].asc_getScope(),a=this.ranges[s].asc_getIsLock(),o=this.ranges[s].asc_getType();i.push({name:this.ranges[s].asc_getName(!0),scope:n,scopeName:null===n?this.textWorkbook:this.sheetNames[n],range:o===Asc.c_oAscDefNameType.slicer?"":this.ranges[s].asc_getRef(),lock:null!=a,lockuser:a?this.isUserVisible(a)?this.getUserName(a):this.lockText:this.guestText,type:o,isTable:o===Asc.c_oAscDefNameType.table,isSlicer:o===Asc.c_oAscDefNameType.slicer})}this.rangesStore.reset(i),this.rangeList.setEmptyText(this.rangesStore.length>0?this.textnoNames:this.textEmpty)}var l=this,r=this.rangeList.store,c=this.rangesStore.models,d=this.cmbFilter.getValue(),h=d<3?2==d:-1,p=d>2?4==d:-1;if(d>0&&(c=this.rangesStore.filter((function(t){return-1!==h?h===t.get("isTable"):-1!==p&&p===(null===t.get("scope"))}))),r.reset(c,{silent:!1}),d=r.length,this.btnEditRange.setDisabled(!d),this.btnDeleteRange.setDisabled(!d),d>0){if(null==e&&(e=0),_.isNumber(e))e>d-1&&(e=d-1),this.rangeList.selectByIndex(e),setTimeout((function(){l.rangeList.scrollToRecord(r.at(e))}),50);else if(e){var u=r.findWhere({name:e.asc_getName(!0),scope:e.asc_getScope()});u&&(this.rangeList.selectRecord(u),setTimeout((function(){l.rangeList.scrollToRecord(u)}),50))}!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(l.onMouseOverLock,l)).on("mouseout",_.bind(l.onMouseOutLock,l))}_.delay((function(){l.rangeList.scroller.update({alwaysVisibleY:!0})}),100,this)},onMouseOverLock:function(t,e,i){if(!0===this.userTooltip&&$(t.target).hasClass("lock-user")){var s=this,n=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip");this.userTooltip=n.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),n.show(),setTimeout((function(){s.userTipHide()}),5e3)}},userTipHide:function(){"object"==_typeof(this.userTooltip)&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==_typeof(this.userTooltip)&&this.userTipHide()},onEditRange:function(t){if(!this._isWarningVisible)if(this.locked)Common.NotificationCenter.trigger("namedrange:locked");else{var e=this,i=Common.Utils.getOffset(e.$window),s=this.rangeList.getSelectedRec(),n=(_.indexOf(this.rangeList.store.models,s),t&&s?new Asc.asc_CDefName(s.get("name"),s.get("range"),s.get("scope"),s.get("type"),void 0,void 0,void 0,!0):null),a=new SSE.Views.NamedRangeEditDlg({api:e.api,sheets:this.sheets,props:t?n:this.props,isEdit:t,handler:function(i,s){"ok"==i&&s&&(t?(e.currentNamedRange=s,e.api.asc_editDefinedNames(n,s)):(e.cmbFilter.setValue(0),e.currentNamedRange=s,e.api.asc_setDefinedNames(s)))}}).on("close",(function(){e.show(),setTimeout((function(){e.getDefaultFocusableComponent().focus()}),100)}));e.hide(),a.show(i.left+65,i.top+77)}},onDeleteRange:function(){var t=this.rangeList.getSelectedRec();if(t){var e=this;e._isWarningVisible=!0,Common.UI.warning({msg:Common.Utils.String.format(e.warnDelete,t.get("name")),buttons:["ok","cancel"],callback:function(i){"ok"==i&&(e.currentNamedRange=_.indexOf(e.rangeList.store.models,t),e.api.asc_delDefinedNames(new Asc.asc_CDefName(t.get("name"),t.get("range"),t.get("scope"),t.get("type"),void 0,void 0,void 0,!0))),setTimeout((function(){e.getDefaultFocusableComponent().focus()}),100),e._isWarningVisible=!1}})}},getSettings:function(){return this.sort},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value),this.close()},onSortNames:function(t,e){this.sort={type:t,direction:e},this.rangeList.store.sort(),this.rangeList.onResetItems(),this.rangeList.scroller.update({alwaysVisibleY:!0})},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return AscCommon.UserInfoParser.getParsedName(i.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){if(i){this.userTipHide();var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON(),this.currentNamedRange=_.indexOf(this.rangeList.store.models,i),this.btnEditRange.setDisabled(s.lock),this.btnDeleteRange.setDisabled(s.lock||s.isTable||s.isSlicer)}}},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_unregisterCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onLockDefNameManager:function(t){this.locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager},txtTitle:"Name Manager",closeButtonText:"Close",textDataRange:"Data Range",textNew:"New",textEdit:"Edit",textDelete:"Delete",textRanges:"Named Ranges",textScope:"Scope",textFilter:"Filter",textEmpty:"No named ranges have been created yet.<br>Create at least one named range and it will appear in this field.",textnoNames:"No named ranges matching your filter could be found.",textFilterAll:"All",textFilterDefNames:"Defined names",textFilterTableNames:"Table names",textFilterSheet:"Names Scoped to Sheet",textFilterWorkbook:"Names Scoped to Workbook",textWorkbook:"Workbook",guestText:"Guest",tipIsLocked:"This element is being edited by another user.",warnDelete:"Are you sure you want to delete the name {0}?",lockText:"Locked"},SSE.Views.NameManagerDlg||{}))})),define("spreadsheeteditor/main/app/view/NamedRangePasteDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NamedRangePasteDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NamedRangePasteDlg",separator:!1,contentWidth:250},initialize:function(t){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="input-label">',this.textNames,"</label>",'<div id="named-range-paste-list" class="range-tableview" style="width:100%; height: 169px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,this.ranges=t.ranges||[],Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rangeList=new Common.UI.ListView({el:$("#named-range-paste-list",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,cls:"dbl-clickable",itemTemplate:_.template(['<div style="pointer-events:none;">','<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="listitem-icon toolbar__icon margin-right-5 <% print(isTable?"btn-menu-table":(isSlicer ? "btn-slicer" : "btn-named-range")) %>"></div>','<div class="padding-right-5" style="width:186px;"><%= Common.Utils.String.htmlEncode(name) %></div>',"</div>","</div>"].join("")),tabindex:1}),this.rangeList.store.comparator=function(t,e){var i=t.get("name").toLowerCase(),s=e.get("name").toLowerCase();return i==s?0:i<s?-1:1},this.rangeList.on("item:dblclick",_.bind(this.onDblClickFunction,this)),this.rangeList.on("entervalue",_.bind(this.onPrimary,this)),this.afterRender()},getFocusedComponents:function(){return[this.rangeList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults()},_setDefaults:function(){if(this.ranges){for(var t=this,e=[],i="",s=0;s<this.ranges.length;s++){var n=this.ranges[s].asc_getName(!0);if(n!==i){var a=this.ranges[s].asc_getType();e.push({name:n,scope:this.ranges[s].asc_getScope(),range:this.ranges[s].asc_getRef(),type:a,isTable:a===Asc.c_oAscDefNameType.table,isSlicer:a===Asc.c_oAscDefNameType.slicer})}i=n}this.rangeList.store.reset(e),this.rangeList.store.sort(),this.rangeList.store.length>0&&this.rangeList.selectByIndex(0),this.rangeList.scroller.update({alwaysVisibleY:!0}),_.delay((function(){t.rangeList.focus()}),100,this)}},getSettings:function(){var t=this.rangeList.getSelectedRec();return t?new Asc.asc_CDefName(t.get("name"),t.get("range"),t.get("scope"),t.get("type"),void 0,void 0,void 0,!0):null},onPrimary:function(){return this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close(),!1},onDlgBtnClick:function(t){var e=t.currentTarget.attributes.result.value;this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onDblClickFunction:function(){this.handler&&this.handler.call(this,"ok",this.getSettings()),this.close()},txtTitle:"Paste Name",textNames:"Named Ranges"},SSE.Views.NamedRangePasteDlg||{}))})),define("text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template",[],(function(){return'<div id="id-adv-paragraph-indents" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <div>\r\n            <div class="padding-large" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textAlign %></label>\r\n                <div id="paragraphadv-spin-text-alignment"></div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-very-small"><label class="header"><%= scope.strIndent %></label></div>\r\n        <div>\r\n            <div class="padding-large margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsLeftText %></label>\r\n                <div id="paragraphadv-spin-indent-left"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="padding-large margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsRightText %></label>\r\n                <div id="paragraphadv-spin-indent-right"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="padding-large" style="display: inline-block;vertical-align: top">\r\n                <div>\r\n                    <label class="input-label"><%= scope.strIndentsSpecial %></label>\r\n                </div>\r\n                <div>\r\n                    <div id="paragraphadv-spin-special" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                 --\x3e<div id="paragraphadv-spin-special-by" style="display: inline-block;"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-very-small"><label class="header"><%= scope.strSpacing %></label></div>\r\n        <div>\r\n            <div class="margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsSpacingBefore %></label>\r\n                <div id="paragraphadv-spin-spacing-before"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div class="margin-right-3" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.strIndentsSpacingAfter %></label>\r\n                <div id="paragraphadv-spin-spacing-after"></div>\r\n            </div>\x3c!--\r\n         --\x3e<div style="display: inline-block;vertical-align: top">\r\n                <div>\r\n                    <label class="input-label"><%= scope.strIndentsLineSpacing %></label>\r\n                </div>\r\n                <div>\r\n                    <div id="paragraphadv-spin-line-rule" class="margin-right-3" style="display: inline-block;"></div>\x3c!--\r\n                 --\x3e<div id="paragraphadv-spin-line-height" style="display: inline-block;"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="padding-large" style="padding-top: 16px; display: none;">\r\n            <div style="border: 1px solid #cbcbcb; width: 350px;">\r\n                <div id="paragraphadv-indent-preview" style="height: 80px; position: relative;"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-font" class="settings-panel">\r\n    <div class="inner-content" style="width: 100%;">\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textEffects %></label>\r\n        </div>\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-subscript"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="paragraphadv-checkbox-double-strike"></div>\r\n                </td>\r\n                <td class="padding-small padding-left-40">\r\n                    <div id="paragraphadv-checkbox-small-caps"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="paragraphadv-checkbox-superscript"></div>\r\n                </td>\r\n                <td class="padding-large padding-left-40">\r\n                    <div id="paragraphadv-checkbox-all-caps"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="padding-very-small">\r\n            <label class="header"><%= scope.textCharacterSpacing %></label>\r\n        </div>\r\n        <div class="padding-large">\r\n            <div style="display: inline-block;">\r\n                <div id="paragraphadv-spin-spacing"></div>\r\n            </div>\r\n        </div>\r\n        <div class="doc-content-color" style="border: 1px solid #cbcbcb;">\r\n            <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative; margin: 0 auto;"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="id-adv-paragraph-tabs" class="settings-panel">\r\n    <div class="inner-content">\r\n        <div class="padding-large">\r\n            <label class="input-label"><%= scope.textDefault %></label>\r\n            <div id="paraadv-spin-default-tab"></div>\r\n\r\n        </div>\r\n        <div>\r\n            <div class="padding-large margin-right-9" style="display: inline-block;">\r\n                <label class="input-label"><%= scope.textTabPosition %></label>\r\n                <div id="paraadv-spin-tab"></div>\r\n            </div>\r\n            <div class="padding-large margin-right-9" style=" display: inline-block;">\r\n                <label class="input-label"><%= scope.textAlign %></label>\r\n                <div id="paraadv-cmb-align"></div>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <div colspan=3 class="padding-large">\r\n                <div id="paraadv-list-tabs" style="width:348px; height: 116px;"></div>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-add-tab" style="width:108px; display: inline-block;"><%= scope.textSet %></button>\r\n            <button type="button" class="btn btn-text-default margin-right-9" id="paraadv-button-remove-tab" style="width:108px; display: inline-block;"><%= scope.textRemove %></button>\r\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:108px;display: inline-block;"><%= scope.textRemoveAll %></button>\r\n        </div>\r\n    </div>\r\n</div>'})),define("spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.ParagraphSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:370,contentHeight:309,toggleGroup:"paragraph-adv-settings-group",storageName:"sse-para-settings-adv-category"},initialize:function(e){var i=this;_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-paragraph-indents",panelCaption:this.strParagraphIndents},{panelId:"id-adv-paragraph-font",panelCaption:this.strParagraphFont},{panelId:"id-adv-paragraph-tabs",panelCaption:this.strTabs}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this.checkGroup=0,this._noApply=!0,this._tabListChanged=!1,this.spinners=[],this.FirstLine=void 0,this.Spacing=null,this.api=this.options.api,this._originalProps=new Asc.asc_CParagraphProperty(this.options.paragraphProps),this._arrLineRule=[{displayValue:this.textAuto,defaultValue:1,value:c_paragraphLinerule.LINERULE_AUTO,minValue:.5,step:.01,defaultUnit:""},{displayValue:this.textExact,defaultValue:5,value:c_paragraphLinerule.LINERULE_EXACT,minValue:.03,step:.01,defaultUnit:"cm"}];var s=this._originalProps.asc_getSpacing().asc_getLineRule(),n=_.findWhere(this._arrLineRule,{value:s});this.CurLineRuleIdx=this._arrLineRule.indexOf(n),this._arrTextAlignment=[{displayValue:this.textTabLeft,value:c_paragraphTextAlignment.LEFT},{displayValue:this.textTabCenter,value:c_paragraphTextAlignment.CENTERED},{displayValue:this.textTabRight,value:c_paragraphTextAlignment.RIGHT},{displayValue:this.textJustified,value:c_paragraphTextAlignment.JUSTIFIED}],this._arrSpecial=[{displayValue:this.textNoneSpecial,value:c_paragraphSpecial.NONE_SPECIAL,defaultValue:0},{displayValue:this.textFirstLine,value:c_paragraphSpecial.FIRST_LINE,defaultValue:12.7},{displayValue:this.textHanging,value:c_paragraphSpecial.HANGING,defaultValue:12.7}],this._arrTabAlign=[{value:Asc.c_oAscTabType.Left,displayValue:this.textTabLeft},{value:Asc.c_oAscTabType.Center,displayValue:this.textTabCenter},{value:Asc.c_oAscTabType.Right,displayValue:this.textTabRight}],this._arrKeyTabAlign=[],this._arrTabAlign.forEach((function(t){i._arrKeyTabAlign[t.value]=t.displayValue}))},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbTextAlignment=new Common.UI.ComboBox({el:$("#paragraphadv-spin-text-alignment"),cls:"input-group-nr",editable:!1,data:this._arrTextAlignment,style:"width: 173px;",menuStyle:"min-width: 173px;",takeFocusOnClose:!0}),this.cmbTextAlignment.setValue(""),this.cmbTextAlignment.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_putJc(e.value>-1?e.value:null)}),this)),this.numIndentsLeft=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-left"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsLeft.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue();this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.asc_getInd().put_Left(Common.Utils.Metric.fnRecalcToMM(n)))}),this)),this.spinners.push(this.numIndentsLeft),this.numIndentsRight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-indent-right"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.numIndentsRight.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd),this._changedProps.asc_getInd().put_Right(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numIndentsRight),this.cmbSpecial=new Common.UI.ComboBox({el:$("#paragraphadv-spin-special"),cls:"input-group-nr",editable:!1,data:this._arrSpecial,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbSpecial.setValue(""),this.cmbSpecial.on("selected",_.bind(this.onSpecialSelect,this)),this.numSpecialBy=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-special-by"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numSpecialBy),this.numSpecialBy.on("change",_.bind(this.onFirstLineChange,this)),this.numSpacingBefore=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-before"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingBefore.on("change",_.bind((function(t,e,i,s){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.asc_getSpacing()}this.Spacing.put_Before(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.numSpacingBefore),this.numSpacingAfter=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing-after"),step:.1,width:85,value:"",defaultUnit:"cm",maxValue:55.88,minValue:0,allowAuto:!0,autoText:this.txtAutoText}),this.numSpacingAfter.on("change",_.bind((function(t,e,i,s){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.asc_getSpacing()}this.Spacing.put_After(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}),this)),this.spinners.push(this.numSpacingAfter),this.cmbLineRule=new Common.UI.ComboBox({el:$("#paragraphadv-spin-line-rule"),cls:"input-group-nr",editable:!1,data:this._arrLineRule,style:"width: 85px;",menuStyle:"min-width: 85px;",takeFocusOnClose:!0}),this.cmbLineRule.setValue(""),this.cmbLineRule.on("selected",_.bind(this.onLineRuleSelect,this)),this.numLineHeight=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-line-height"),step:.01,width:85,value:"",defaultUnit:"",maxValue:132,minValue:.5}),this.spinners.push(this.numLineHeight),this.numLineHeight.on("change",_.bind(this.onNumLineHeightChange,this)),this.chStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-strike"),labelText:this.strStrike}),this.chStrike.on("change",_.bind(this.onStrikeChange,this)),this.chDoubleStrike=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-double-strike"),labelText:this.strDoubleStrike}),this.chDoubleStrike.on("change",_.bind(this.onDoubleStrikeChange,this)),this.chSuperscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-superscript"),labelText:this.strSuperscript}),this.chSuperscript.on("change",_.bind(this.onSuperscriptChange,this)),this.chSubscript=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-subscript"),labelText:this.strSubscript}),this.chSubscript.on("change",_.bind(this.onSubscriptChange,this)),this.chSmallCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-small-caps"),labelText:this.strSmallCaps}),this.chSmallCaps.on("change",_.bind(this.onSmallCapsChange,this)),this.chAllCaps=new Common.UI.CheckBox({el:$("#paragraphadv-checkbox-all-caps"),labelText:this.strAllCaps}),this.chAllCaps.on("change",_.bind(this.onAllCapsChange,this)),this.numSpacing=new Common.UI.MetricSpinner({el:$("#paragraphadv-spin-spacing"),step:.01,width:100,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:55.87,minValue:-55.87}),this.numSpacing.on("change",_.bind((function(t,e,i,s){if(this._changedProps&&this._changedProps.asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}}),this)),this.spinners.push(this.numSpacing),this.numTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.spinners.push(this.numTab),this.numDefaultTab=new Common.UI.MetricSpinner({el:$("#paraadv-spin-default-tab"),step:.1,width:108,defaultUnit:"cm",value:"1.25 cm",maxValue:55.87,minValue:0}),this.numDefaultTab.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_putDefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()).toFixed(1)))}),this)),this.spinners.push(this.numDefaultTab),this.tabList=new Common.UI.ListView({el:$("#paraadv-list-tabs"),emptyText:this.noTabs,store:new Common.UI.DataViewStore,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div style="width: 117px;display: inline-block;"><%= value %></div>','<div style="display: inline-block;"><%= displayTabAlign %></div>',"</div>"].join("")),tabindex:1}),this.tabList.store.comparator=function(t){return t.get("tabPos")},this.tabList.on("item:select",_.bind(this.onSelectTab,this));var e=function(){t._noApply||(t._tabListChanged=!0)};this.listenTo(this.tabList.store,"add",e),this.listenTo(this.tabList.store,"remove",e),this.listenTo(this.tabList.store,"reset",e),this.cmbAlign=new Common.UI.ComboBox({el:$("#paraadv-cmb-align"),style:"width: 108px;",menuStyle:"min-width: 108px;",editable:!1,cls:"input-group-nr",data:this._arrTabAlign,takeFocusOnClose:!0}),this.cmbAlign.setValue(Asc.c_oAscTabType.Left),this.btnAddTab=new Common.UI.Button({el:$("#paraadv-button-add-tab")}),this.btnAddTab.on("click",_.bind(this.addTab,this)),this.btnRemoveTab=new Common.UI.Button({el:$("#paraadv-button-remove-tab")}),this.btnRemoveTab.on("click",_.bind(this.removeTab,this)),this.btnRemoveAll=new Common.UI.Button({el:$("#paraadv-button-remove-all")}),this.btnRemoveAll.on("click",_.bind(this.removeAllTabs,this)),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.cmbTextAlignment,this.numIndentsLeft,this.numIndentsRight,this.cmbSpecial,this.numSpecialBy,this.numSpacingBefore,this.numSpacingAfter,this.cmbLineRule,this.numLineHeight,this.chStrike,this.chSubscript,this.chDoubleStrike,this.chSmallCaps,this.chSuperscript,this.chAllCaps,this.numSpacing,this.numDefaultTab,this.numTab,this.cmbAlign,this.tabList,this.btnAddTab,this.btnRemoveTab,this.btnRemoveAll]).concat(this.getFooterButtons())},onCategoryClick:function(t,e,i,s){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var n=this;setTimeout((function(){switch(e){case 0:n.cmbTextAlignment.focus();break;case 1:n.chStrike.focus(),s&&s instanceof jQuery.Event&&n.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n._originalProps||new Asc.asc_CParagraphProperty);break;case 2:n.numDefaultTab.focus()}}),10)},onAnimateAfter:function(){1==this.getActiveCategory()&&this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",this._originalProps||new Asc.asc_CParagraphProperty)},getSettings:function(){return this._tabListChanged&&(null!==this._changedProps.asc_getTabs()&&void 0!==this._changedProps.asc_getTabs()||this._changedProps.asc_putTabs(new Asc.asc_CParagraphTabs),this.tabList.store.each((function(t,e){var i=new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(t.get("tabPos")),t.get("tabAlign"));this._changedProps.asc_getTabs().add_Tab(i)}),this)),null!==this.Spacing&&this._changedProps.asc_putSpacing(this.Spacing),{paragraphProps:this._changedProps}},_setDefaults:function(t){if(t){this._originalProps=new Asc.asc_CParagraphProperty(t),this.FirstLine=null!==t.asc_getInd()?t.asc_getInd().asc_getFirstLine():null,this.numIndentsLeft.setValue(null!==t.asc_getInd()&&null!==t.asc_getInd().asc_getLeft()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getInd().asc_getLeft()):"",!0),this.numIndentsRight.setValue(null!==t.asc_getInd()&&null!==t.asc_getInd().asc_getRight()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getInd().asc_getRight()):"",!0),this.cmbTextAlignment.setValue(void 0!==t.asc_getJc()&&null!==t.asc_getJc()?t.asc_getJc():""),void 0===this.CurSpecial&&(this.CurSpecial=0===t.asc_getInd().asc_getFirstLine()?c_paragraphSpecial.NONE_SPECIAL:t.asc_getInd().asc_getFirstLine()>0?c_paragraphSpecial.FIRST_LINE:c_paragraphSpecial.HANGING),this.cmbSpecial.setValue(this.CurSpecial),this.numSpecialBy.setValue(null!==this.FirstLine?Math.abs(Common.Utils.Metric.fnRecalcFromMM(this.FirstLine)):"",!0),this.numSpacingBefore.setValue(null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getBefore()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getBefore()):"",!0),this.numSpacingAfter.setValue(null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getAfter()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getAfter()):"",!0);var e=t.asc_getSpacing().asc_getLineRule();this.cmbLineRule.setValue(null!==e?e:""),null!==t.asc_getSpacing()&&null!==t.asc_getSpacing().asc_getLine()?this.numLineHeight.setValue(e==c_paragraphLinerule.LINERULE_AUTO?t.asc_getSpacing().asc_getLine():Common.Utils.Metric.fnRecalcFromMM(t.asc_getSpacing().asc_getLine()),!0):this.numLineHeight.setValue("",!0),this._noApply=!0,this.chStrike.setValue(null!==t.asc_getStrikeout()&&void 0!==t.asc_getStrikeout()?t.asc_getStrikeout():"indeterminate",!0),this.chDoubleStrike.setValue(null!==t.asc_getDStrikeout()&&void 0!==t.asc_getDStrikeout()?t.asc_getDStrikeout():"indeterminate",!0),this.chSubscript.setValue(null!==t.asc_getSubscript()&&void 0!==t.asc_getSubscript()?t.asc_getSubscript():"indeterminate",!0),this.chSuperscript.setValue(null!==t.asc_getSuperscript()&&void 0!==t.asc_getSuperscript()?t.asc_getSuperscript():"indeterminate",!0),this.chSmallCaps.setValue(null!==t.asc_getSmallCaps()&&void 0!==t.asc_getSmallCaps()?t.asc_getSmallCaps():"indeterminate",!0),this.chAllCaps.setValue(null!==t.asc_getAllCaps()&&void 0!==t.asc_getAllCaps()?t.asc_getAllCaps():"indeterminate",!0),this.numSpacing.setValue(null!==t.asc_getTextSpacing()&&void 0!==t.asc_getTextSpacing()?Common.Utils.Metric.fnRecalcFromMM(t.asc_getTextSpacing()):"",!0),this.numDefaultTab.setValue(null!==t.asc_getDefaultTab()&&void 0!==t.asc_getDefaultTab()?Common.Utils.Metric.fnRecalcFromMM(parseFloat(t.asc_getDefaultTab().toFixed(1))):"",!0);var i=this.tabList.store,s=t.asc_getTabs();if(s){for(var n=[],a=s.asc_getCount(),o=0;o<a;o++){var l=s.asc_getTab(o),r=Common.Utils.Metric.fnRecalcFromMM(parseFloat(l.asc_getPos().toFixed(1))),c=new Common.UI.DataViewModel;c.set({tabPos:r,value:parseFloat(r.toFixed(3))+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:l.asc_getValue(),displayTabAlign:this._arrKeyTabAlign[l.asc_getValue()]}),n.push(c)}i.reset(n,{silent:!1}),this.tabList.selectByIndex(0)}this._noApply=!1,this._changedProps=new Asc.asc_CParagraphProperty}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),"paragraphadv-spin-spacing"==e.el.id||"paragraphadv-spin-position"==e.el.id||"paragraphadv-spin-spacing-before"==e.el.id||"paragraphadv-spin-spacing-after"==e.el.id?e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01):e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.1)}if(this._arrLineRule[1].defaultUnit=Common.Utils.Metric.getCurrentMetricName(),this._arrLineRule[1].minValue=parseFloat(Common.Utils.Metric.fnRecalcFromMM(.3).toFixed(2)),this._arrLineRule[1].step=Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01,null!==this.CurLineRuleIdx){var i=this._arrLineRule[-1!==this.CurLineRuleIdx?this.CurLineRuleIdx:0];this.numLineHeight.setDefaultUnit(i.defaultUnit),this.numLineHeight.setStep(i.step)}},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},onStrikeChange:function(t,e,i,s){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.asc_putStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chDoubleStrike.setValue(0),this._changedProps&&this._changedProps.asc_putDStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putStrikeout("checked"==t.getValue()),n.asc_putDStrikeout("checked"==this.chDoubleStrike.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onDoubleStrikeChange:function(t,e,i,s){if(this._changedProps&&1!=this.checkGroup&&this._changedProps.asc_putDStrikeout("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=1,this.chStrike.setValue(0),this._changedProps&&this._changedProps.asc_putStrikeout(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putDStrikeout("checked"==t.getValue()),n.asc_putStrikeout("checked"==this.chStrike.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSuperscriptChange:function(t,e,i,s){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.asc_putSuperscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSubscript.setValue(0),this._changedProps&&this._changedProps.asc_putSubscript(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putSuperscript("checked"==t.getValue()),n.asc_putSubscript("checked"==this.chSubscript.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSubscriptChange:function(t,e,i,s){if(this._changedProps&&2!=this.checkGroup&&this._changedProps.asc_putSubscript("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=2,this.chSuperscript.setValue(0),this._changedProps&&this._changedProps.asc_putSuperscript(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putSubscript("checked"==t.getValue()),n.asc_putSuperscript("checked"==this.chSuperscript.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onSmallCapsChange:function(t,e,i,s){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.asc_putSmallCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chAllCaps.setValue(0),this._changedProps&&this._changedProps.asc_putAllCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putSmallCaps("checked"==t.getValue()),n.asc_putAllCaps("checked"==this.chAllCaps.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},onAllCapsChange:function(t,e,i,s){if(this._changedProps&&3!=this.checkGroup&&this._changedProps.asc_putAllCaps("checked"==t.getValue()),this.checkGroup=0,"checked"==t.getValue()&&(this.checkGroup=3,this.chSmallCaps.setValue(0),this._changedProps&&this._changedProps.asc_putSmallCaps(!1),this.checkGroup=0),this.api&&!this._noApply){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;n.asc_putAllCaps("checked"==t.getValue()),n.asc_putSmallCaps("checked"==this.chSmallCaps.getValue()),this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img",n)}},addTab:function(t,e){var i=this.numTab.getNumberValue(),s=this.cmbAlign.getValue(),n=this._arrKeyTabAlign[s],a=this.tabList.store,o=a.find((function(t){return Math.abs(t.get("tabPos")-i)<.001}));o?(o.set("tabAlign",s),o.set("displayTabAlign",n),this._tabListChanged=!0):((o=new Common.UI.DataViewModel).set({tabPos:i,value:i+" "+Common.Utils.Metric.getCurrentMetricName(),tabAlign:s,displayTabAlign:n}),a.add(o)),this.tabList.selectRecord(o),this.tabList.scrollToRecord(o)},removeTab:function(t,e){var i=this.tabList.getSelectedRec();if(i){var s=this.tabList.store,n=_.indexOf(s.models,i);s.remove(i),n>s.length-1&&(n=s.length-1),s.length>0&&(this.tabList.selectByIndex(n),this.tabList.scrollToRecord(s.at(n)))}},removeAllTabs:function(t,e){this.tabList.store.reset()},onSelectTab:function(t,e,i){if(i){var s={};if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;s=i.toJSON()}else s=i;this.numTab.setValue(s.tabPos),this.cmbAlign.setValue(s.tabAlign)}},onSpecialSelect:function(t,e){if(this.CurSpecial=e.value,this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&this.numSpecialBy.setValue(0,!0),this._changedProps){null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var i=Common.Utils.Metric.fnRecalcToMM(this.numSpecialBy.getNumberValue());0===i&&(this.numSpecialBy.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrSpecial[e.value].defaultValue),!0),i=this._arrSpecial[e.value].defaultValue),this.CurSpecial===c_paragraphSpecial.HANGING&&(i=-i),this._changedProps.asc_getInd().put_FirstLine(i)}},onFirstLineChange:function(t,e,i,s){if(this._changedProps){null!==this._changedProps.asc_getInd()&&void 0!==this._changedProps.asc_getInd()||this._changedProps.put_Ind(new Asc.asc_CParagraphInd);var n=Common.Utils.Metric.fnRecalcToMM(t.getNumberValue());this.CurSpecial===c_paragraphSpecial.HANGING?n=-n:this.CurSpecial===c_paragraphSpecial.NONE_SPECIAL&&n>0?(this.CurSpecial=c_paragraphSpecial.FIRST_LINE,this.cmbSpecial.setValue(c_paragraphSpecial.FIRST_LINE)):0===n&&(this.CurSpecial=c_paragraphSpecial.NONE_SPECIAL,this.cmbSpecial.setValue(c_paragraphSpecial.NONE_SPECIAL)),this._changedProps.asc_getInd().put_FirstLine(n)}},onLineRuleSelect:function(t,e){if(null===this.Spacing){var i=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=i.asc_getSpacing()}this.Spacing.put_LineRule(e.value);var s=_.findWhere(this._arrLineRule,{value:e.value}),n=this._arrLineRule.indexOf(s);this.CurLineRuleIdx!==n&&(this.numLineHeight.setDefaultUnit(this._arrLineRule[n].defaultUnit),this.numLineHeight.setMinValue(this._arrLineRule[n].minValue),this.numLineHeight.setStep(this._arrLineRule[n].step),this.Spacing.get_LineRule()===c_paragraphLinerule.LINERULE_AUTO?this.numLineHeight.setValue(this._arrLineRule[n].defaultValue):this.numLineHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(this._arrLineRule[n].defaultValue)),this.CurLineRuleIdx=n)},onNumLineHeightChange:function(t,e,i,s){if(""!==this.cmbLineRule.getRawValue()){if(null===this.Spacing){var n=this._originalProps?this._originalProps:new Asc.asc_CParagraphProperty;this.Spacing=n.asc_getSpacing()}this.Spacing.put_Line(this.cmbLineRule.getValue()==c_paragraphLinerule.LINERULE_AUTO?t.getNumberValue():Common.Utils.Metric.fnRecalcToMM(t.getNumberValue()))}},textTitle:"Paragraph - Advanced Settings",strIndentsLeftText:"Left",strIndentsRightText:"Right",strParagraphIndents:"Indents & Spacing",strParagraphFont:"Font",textEffects:"Effects",textCharacterSpacing:"Character Spacing",strDoubleStrike:"Double strikethrough",strStrike:"Strikethrough",strSuperscript:"Superscript",strSubscript:"Subscript",strSmallCaps:"Small caps",strAllCaps:"All caps",strTabs:"Tab",textSet:"Specify",textRemove:"Remove",textRemoveAll:"Remove All",textTabLeft:"Left",textTabRight:"Right",textTabCenter:"Center",textAlign:"Alignment",textTabPosition:"Tab Position",textDefault:"Default Tab",noTabs:"The specified tabs will appear in this field",textJustified:"Justified",strIndentsSpecial:"Special",textNoneSpecial:"(none)",textFirstLine:"First line",textHanging:"Hanging",strIndentsSpacingBefore:"Before",strIndentsSpacingAfter:"After",strIndentsLineSpacing:"Line Spacing",txtAutoText:"Auto",textAuto:"Multiple",textExact:"Exactly",strIndent:"Indents",strSpacing:"Spacing"},SSE.Views.ParagraphSettingsAdvanced||{}))})),define("text!spreadsheeteditor/main/app/template/PrintSettings.template",[],(function(){return'<div class="settings-panel active">\r\n    <div class="padding-large inner-content" >\r\n        <div id="printadv-dlg-combo-range" class="input-group-nr"></div>\r\n        <div id="printadv-dlg-chb-ignore" style="margin-top: 5px;"></div>\r\n        <div id="printadv-dlg-pages">\r\n            <label class="margin-right-6 vertical-align-baseline"><%= scope.textPages %></label>\r\n            <div id="printadv-dlg-spin-pages-from" class="margin-right-6 vertical-align-baseline"></div>\r\n            <label class="margin-right-6 vertical-align-baseline"><%= scope.textTo %></label>\r\n            <div id="printadv-dlg-spin-pages-to" class="vertical-align-baseline"></div>\r\n        </div>\r\n    </div>\r\n    <div class="padding-large inner-content" >\r\n        <div id="printadv-dlg-combo-sheets" class="input-group-nr"></div>\r\n    </div>\r\n    <div class="padding-large inner-content" >\r\n        <div id="printadv-dlg-combo-pages" class="input-group-nr"></div>\r\n    </div>\r\n    <div class="padding-large inner-content" >\r\n        <span id="printadv-dlg-combo-orient"></span>\r\n    </div>\r\n    <div class="padding-large inner-content" >\r\n        <span id="printadv-dlg-combo-layout"></span>\r\n    </div>\r\n    <div id="printadv-dlg-content-to-hide">\r\n        <div class="padding-large inner-content" >\r\n            <table cols="2" class="no-padding" role="presentation">\r\n                <tr>\r\n                    <td colspan="2" ><label><%= scope.textRepeatTop %></label></td>\r\n                </tr>\r\n                <tr>\r\n                    <td class="padding-small"><div id="printadv-dlg-txt-top" class="margin-right-10"></div></td>\r\n                    <td class="padding-small"><div id="printadv-dlg-presets-top"></div></td>\r\n                </tr>\r\n                <tr>\r\n                    <td colspan="2" ><label><%= scope.textRepeatLeft %></label></td>\r\n                </tr>\r\n                <tr>\r\n                    <td><div id="printadv-dlg-txt-left" class="margin-right-10"></div></td>\r\n                    <td><div id="printadv-dlg-presets-left"></div></td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div class="padding-large inner-content" >\r\n            <span id="printadv-dlg-combo-margins"></span>\r\n        </div>\r\n        <div class="padding-small"></div>\r\n        <div class="inner-content">\r\n            <div id="printadv-dlg-chb-grid" style="margin-bottom: 10px;"></div>\r\n            <div id="printadv-dlg-chb-rows"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("spreadsheeteditor/main/app/view/PrintSettings",["text!spreadsheeteditor/main/app/template/PrintSettings.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.PrintSettings=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"PrintSettings",contentWidth:280,contentHeight:468,buttons:null},initialize:function(e){this.type=e.type||"print";var i="print"==this.type?this.btnPrint:"export"==this.type?this.btnExport:this.btnDownload;_.extend(this.options,{title:"print"==this.type?this.textTitle:this.textTitlePDF,template:['<div class="box">','<div class="menu-panel" style="overflow: hidden;">','<div style="height: 84px; line-height: 42px;" class="div-category">'+("print"==this.type?this.textPrintRange:this.textRange)+"</div>",'<div style="height: 52px; line-height: 66px;" class="div-category">'+this.textSettings+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageSize+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageOrientation+"</div>",'<div style="height: 38px; line-height: 38px;" class="div-category">'+this.textPageScaling+"</div>",'<div style="height: 98px; line-height: 33px;" class="div-category">'+this.strPrintTitles+"</div>",'<div style="height: 41px; line-height: 41px;" class="div-category">'+this.strMargins+"</div>",'<div style="height: 58px; line-height: 44px;" class="div-category">'+("print"==this.type?this.strPrint:this.strShow)+"</div>","</div>",'<div class="content-panel">'+_.template(t)({scope:this})+"</div>","</div>",'<div class="separator horizontal"></div>','<div class="footer justify">','<button id="printadv-dlg-btn-hide" class="btn btn-text-default" style="min-width: 100px;width: auto;">'+this.textHideDetails+"</button>",'<button class="btn normal dlg-btn float-right" result="cancel" style="width: 86px;">'+this.cancelButtonText+"</button>",'<button class="btn normal dlg-btn primary float-right margin-left-10" result="ok" style="min-width: 150px;width: auto;">'+i+"</button>","</div>"].join("")},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.cmbRange=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-range"),style:"width: 242px;",menuStyle:"min-width: 100%;max-height: 280px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPrintType.ActiveSheets,displayValue:this.textActiveSheets},{value:Asc.c_oAscPrintType.EntireWorkbook,displayValue:this.textAllSheets},{value:Asc.c_oAscPrintType.Selection,displayValue:this.textSelection}]}),this.cmbRange.on("selected",_.bind(this.comboRangeChange,this)),this.chIgnorePrintArea=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-ignore"),labelText:this.textIgnore}),this.spnPagesFrom=new Common.UI.MetricSpinner({el:$("#printadv-dlg-spin-pages-from"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,allowBlank:!0,maskExp:/[0-9]/}),this.spnPagesTo=new Common.UI.MetricSpinner({el:$("#printadv-dlg-spin-pages-to"),step:1,width:60,defaultUnit:"",value:"",maxValue:1e6,minValue:1,allowDecimal:!1,allowBlank:!0,maskExp:/[0-9]/}),this.cmbSheet=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-sheets"),style:"width: 242px;",menuStyle:"min-width: 242px;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.cmbPaperSize=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-pages"),style:"width: 242px;",menuStyle:"max-height: 280px; min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:"215.9|279.4",displayValue:"US Letter (21,59 cm x 27,94 cm)",caption:"US Letter",size:[215.9,279.4]},{value:"215.9|355.6",displayValue:"US Legal (21,59 cm x 35,56 cm)",caption:"US Legal",size:[215.9,355.6]},{value:"210|297",displayValue:"A4 (21 cm x 29,7 cm)",caption:"A4",size:[210,297]},{value:"148|210",displayValue:"A5 (14,8 cm x 21 cm)",caption:"A5",size:[148,210]},{value:"176|250",displayValue:"B5 (17,6 cm x 25 cm)",caption:"B5",size:[176,250]},{value:"104.8|241.3",displayValue:"Envelope #10 (10,48 cm x 24,13 cm)",caption:"Envelope #10",size:[104.8,241.3]},{value:"110|220",displayValue:"Envelope DL (11 cm x 22 cm)",caption:"Envelope DL",size:[110,220]},{value:"279.4|431.8",displayValue:"Tabloid (27,94 cm x 43,18 cm)",caption:"Tabloid",size:[279.4,431.8]},{value:"297|420",displayValue:"A3 (29,7 cm x 42 cm)",caption:"A3",size:[297,420]},{value:"296.9|457.2",displayValue:"Tabloid Oversize (29,69 cm x 45,72 cm)",caption:"Tabloid Oversize",size:[296.9,457.2]},{value:"196.8|273",displayValue:"ROC 16K (19,68 cm x 27,3 cm)",caption:"ROC 16K",size:[196.8,273]},{value:"120|235",displayValue:"Envelope Choukei 3 (12 cm x 23,5 cm)",caption:"Envelope Choukei 3",size:[120,235]},{value:"305|487",displayValue:"Super B/A3 (30,5 cm x 48,7 cm)",caption:"Super B/A3",size:[305,487]}]}),this.cmbPaperOrientation=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-orient"),style:"width: 132px;",menuStyle:"min-width: 132px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:Asc.c_oAscPageOrientation.PagePortrait,displayValue:this.strPortrait},{value:Asc.c_oAscPageOrientation.PageLandscape,displayValue:this.strLandscape}]}),this.chPrintGrid=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-grid"),labelText:"print"==this.type?this.textPrintGrid:this.textShowGrid}),this.chPrintRows=new Common.UI.CheckBox({el:$("#printadv-dlg-chb-rows"),labelText:"print"==this.type?this.textPrintHeadings:this.textShowHeadings}),this.cmbPaperMargins=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-margins"),style:"width: 242px;",menuStyle:"max-height: 280px; min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textMarginsNormal,size:[19.1,17.8,19.1,17.8]},{value:1,displayValue:this.textMarginsNarrow,size:[19.1,6.4,19.1,6.4]},{value:2,displayValue:this.textMarginsWide,size:[25.4,25.4,25.4,25.4]},{value:-1,displayValue:this.textCustom,size:null}],itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>"><a tabindex="-1" type="menuitem">',"<div><b><%= scope.getDisplayValue(item) %></b></div>",'<% if (item.size !== null) { %><div style="display: inline-block;margin-right: 20px;min-width: 80px;"><label style="display: block;">'+this.strTop+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[0]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.strLeft+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[1]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><div style="display: inline-block;"><label style="display: block;">'+this.strBottom+': <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[2]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label><label style="display: block;">'+this.strRight+": <%= parseFloat(Common.Utils.Metric.fnRecalcFromMM(item.size[3]).toFixed(2)) %> <%= Common.Utils.Metric.getCurrentMetricName() %></label></div><% } %>","<% }); %>"].join(""))});var t=_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%= item.value %>" <% if (item.value === "customoptions") { %> class="border-top" <% } %> ><a tabindex="-1" type="menuitem">',"<%= scope.getDisplayValue(item) %>","</a></li>","<% }); %>"].join(""));this.cmbLayout=new Common.UI.ComboBox({el:$("#printadv-dlg-combo-layout"),style:"width: 242px;",menuStyle:"min-width: 242px;",editable:!1,takeFocusOnClose:!0,cls:"input-group-nr",data:[{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:"customoptions",displayValue:this.textCustomOptions}],itemsTemplate:t}),this.txtRangeTop=new Common.UI.InputFieldBtn({el:$("#printadv-dlg-txt-top"),style:"width: 137px;",allowBlank:!0,validateOnChange:!0}),this.btnPresetsTop=new Common.UI.Button({parentEl:$("#printadv-dlg-presets-top"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:!0,takeFocusOnClose:!0}),this.txtRangeLeft=new Common.UI.InputFieldBtn({el:$("#printadv-dlg-txt-left"),style:"width: 137px;",allowBlank:!0,validateOnChange:!0}),this.btnPresetsLeft=new Common.UI.Button({parentEl:$("#printadv-dlg-presets-left"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:!0,takeFocusOnClose:!0}),this.btnHide=new Common.UI.Button({el:$("#printadv-dlg-btn-hide")}),this.btnHide.on("click",_.bind(this.handlerShowDetails,this)),this.panelDetails=$("#printadv-dlg-content-to-hide"),this.updateMetricUnit(),this.options.afterrender&&this.options.afterrender.call(this);var e=Common.localStorage.getItem("sse-hide-print-settings");this.extended=null!==e&&0==parseInt(e),this.handlerShowDetails(this.btnHide)},getFocusedComponents:function(){return[this.cmbRange,this.chIgnorePrintArea,this.spnPagesFrom,this.spnPagesTo,this.cmbSheet,this.cmbPaperSize,this.cmbPaperOrientation,this.cmbLayout,this.txtRangeTop,this.btnPresetsTop,this.txtRangeLeft,this.btnPresetsLeft,this.cmbPaperMargins,this.chPrintGrid,this.chPrintRows,this.btnHide].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.cmbRange},addCustomScale:function(t){t?this.cmbLayout.setData([{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:4,displayValue:this.textCustom},{value:"customoptions",displayValue:this.textCustomOptions}]):this.cmbLayout.setData([{value:0,displayValue:this.textActualSize},{value:1,displayValue:this.textFitPage},{value:2,displayValue:this.textFitCols},{value:3,displayValue:this.textFitRows},{value:"customoptions",displayValue:this.textCustomOptions}])},setRange:function(t){this.cmbRange.setValue(t)},getRange:function(){return this.cmbRange.getValue()},setIgnorePrintArea:function(t){this.chIgnorePrintArea.setValue(t)},getIgnorePrintArea:function(){return"checked"==this.chIgnorePrintArea.getValue()},getPagesFrom:function(){return this.spnPagesFrom.getNumberValue()},getPagesTo:function(){return this.spnPagesTo.getNumberValue()},comboRangeChange:function(t,e){this.fireEvent("changerange",this)},updateMetricUnit:function(){for(var t=this.cmbPaperSize.store,e=0;e<t.length;e++){var i=t.at(e),s=i.get("value"),n=/^\d{3}\.?\d*/.exec(s),a=/\d{3}\.?\d*$/.exec(s);i.set("displayValue",i.get("caption")+" ("+parseFloat(Common.Utils.Metric.fnRecalcFromMM(n).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+" x "+parseFloat(Common.Utils.Metric.fnRecalcFromMM(a).toFixed(2))+" "+Common.Utils.Metric.getCurrentMetricName()+")")}this.cmbPaperSize.onResetItems(),this.cmbPaperMargins.onResetItems()},handlerShowDetails:function(t){this.extended?(this.extended=!1,this.panelDetails.css({display:"block"}),this.setInnerHeight(468),t.setCaption(this.textHideDetails),Common.localStorage.setItem("sse-hide-print-settings",0)):(this.extended=!0,this.panelDetails.css({display:"none"}),this.setInnerHeight(259),t.setCaption(this.textShowDetails),Common.localStorage.setItem("sse-hide-print-settings",1))},textTitle:"Print Settings",strLeft:"Left",strRight:"Right",strTop:"Top",strBottom:"Bottom",strPortrait:"Portrait",strLandscape:"Landscape",textPrintGrid:"Print Gridlines",textPrintHeadings:"Print Rows and Columns Headings",textPageSize:"Page Size",textPageOrientation:"Page Orientation",strMargins:"Margins",strPrint:"Print",btnPrint:"Save & Print",textPrintRange:"Print Range",textLayout:"Layout",textCurrentSheet:"Current Sheet",textActiveSheets:"Active Sheets",textAllSheets:"All Sheets",textSelection:"Selection",textActualSize:"Actual Size",textFitPage:"Fit Sheet on One Page",textFitCols:"Fit All Columns on One Page",textFitRows:"Fit All Rows on One Page",textShowDetails:"Show Details",textHideDetails:"Hide Details",textPageScaling:"Scaling",textSettings:"Sheet Settings",textTitlePDF:"PDF Settings",textShowGrid:"Show Gridlines",textShowHeadings:"Show Rows and Columns Headings",strShow:"Show",btnDownload:"Save & Download",textRange:"Range",textIgnore:"Ignore Print Area",textCustomOptions:"Custom Options",textCustom:"Custom",strPrintTitles:"Print Titles",textRepeatTop:"Repeat rows at top",textRepeatLeft:"Repeat columns at left",textRepeat:"Repeat...",textPages:"Pages:",textTo:"to",textMarginsNormal:"Normal",textMarginsNarrow:"Narrow",textMarginsWide:"Wide",txtMarginsLast:"Last Custom",btnExport:"Save & Export"},SSE.Views.PrintSettings||{}))})),define("text!spreadsheeteditor/main/app/template/ProtectRangesDlg.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <label><%= scope.textRangesDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <button type="button" class="btn btn-text-default auto margin-right-5" id="protect-ranges-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default auto" id="protect-ranges-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\n                </td>\n                <td class="padding-small text-align-right" style="width:90px;">\n                    <button type="button" class="btn btn-text-default auto" id="protect-ranges-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>            \n            <tr>\n                <td colspan=2>\n                    <div id="protect-ranges-list" class="range-tableview" style="width:100%; height: 164px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/ProtectRangesDlg",["text!spreadsheeteditor/main/app/template/ProtectRangesDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ProtectRangesDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ProtectRangesDlg",contentWidth:480,separator:!1,id:"window-protect-ranges"},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this.locked=e.locked||!1,this.userTooltip=!0,this.currentRange=void 0,this.deletedArr=[],this.wrapEvents={onLockProtectedRangeManager:_.bind(this.onLockProtectedRangeManager,this),onUnLockProtectedRangeManager:_.bind(this.onUnLockProtectedRangeManager,this),onLockProtectedRange:_.bind(this.onLockProtectedRange,this),onUnLockProtectedRange:_.bind(this.onUnLockProtectedRange,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.rangeList=new Common.UI.ListView({el:$("#protect-ranges-list",this.$window),store:new Common.UI.DataViewStore,emptyText:this.textEmpty,headers:[{name:this.textTitle,width:184},{name:this.textRange,width:180},{name:this.textPwd,width:82}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="padding-right-5" style="width:184px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:180px;"><%= range %></div>','<div style="width:70px;"><% if (pwd) { %>',this.txtYes,"<% } else { %>",this.txtNo,"<% } %></div>","<% if (lock) { %>",'<div class="lock-user"><%=Common.Utils.String.htmlEncode(lockuser)%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.store.comparator=function(t,e){var i=t.get("name").toLowerCase(),s=e.get("name").toLowerCase();return i==s?0:i<s?-1:1},this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#protect-ranges-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#protect-ranges-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#protect-ranges-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.afterRender()},getFocusedComponents:function(){return[this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.refreshRangeList(t,0),this.currentSheet=this.api.asc_getActiveWorksheetIndex(),this.api.asc_registerCallback("asc_onLockProtectedRangeManager",this.wrapEvents.onLockProtectedRangeManager),this.api.asc_registerCallback("asc_onUnLockProtectedRangeManager",this.wrapEvents.onUnLockProtectedRangeManager),this.api.asc_registerCallback("asc_onLockProtectedRange",this.wrapEvents.onLockProtectedRange),this.api.asc_registerCallback("asc_onUnLockProtectedRange",this.wrapEvents.onUnLockProtectedRange)},refreshRangeList:function(t,e){if(t){for(var i=[],s=0;s<t.length;s++){var n=t[s].asc_getIsLock();i.push({name:t[s].asc_getName()||"",pwd:t[s].asc_isPassword(),range:t[s].asc_getSqref()||"",rangeId:t[s].asc_getId(),props:t[s],rangeChanged:!1,lock:null!=n,lockuser:n?this.isUserVisible(n)?this.getUserName(n):this.lockText:this.guestText})}this.rangeList.store.reset(i)}var a=this,o=this.rangeList.store,l=o.length;if(l>0){if(null==e&&(e=0),_.isNumber(e))e>l-1&&(e=l-1),this.rangeList.selectByIndex(e),setTimeout((function(){a.rangeList.scrollToRecord(o.at(e))}),50);else if(e){var r=o.findWhere({name:e.asc_getName(!0)});r&&(this.rangeList.selectRecord(r),setTimeout((function(){a.rangeList.scrollToRecord(r)}),50))}!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(a.onMouseOverLock,a)).on("mouseout",_.bind(a.onMouseOutLock,a))}this.updateButtons(),_.delay((function(){a.rangeList.scroller.update({alwaysVisibleY:!0})}),100,this)},onMouseOverLock:function(t,e,i){if(!0===this.userTooltip&&$(t.target).hasClass("lock-user")){var s=this,n=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip");this.userTooltip=n.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),n.show(),setTimeout((function(){s.userTipHide()}),5e3)}},userTipHide:function(){"object"==_typeof(this.userTooltip)&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==_typeof(this.userTooltip)&&this.userTipHide()},onEditRange:function(t){if(!this._isWarningVisible)if(this.locked)Common.NotificationCenter.trigger("protectedrange:locked");else{var e,i=this,s=Common.Utils.getOffset(i.$window),n=this.rangeList.getSelectedRec();t?e=n.get("props"):(e=new Asc.CProtectedRange).asc_setSqref(i.api.asc_getActiveRangeStr(Asc.referenceType.A));var a=[];this.rangeList.store.each((function(t){a.push(t.get("name").toLowerCase())}));var o=new SSE.Views.ProtectDialog({title:t?i.txtEditRange:i.txtNewRange,type:"range",props:e,names:a,isEdit:t,api:i.api,buttons:["ok","cancel"],handler:function(e,s,a){"ok"==e&&(s&&a.asc_setPassword(s),t?(n.set("props",a),n.set("name",a.asc_getName()),n.set("range",a.asc_getSqref()),n.set("pwd",a.asc_isPassword()),n.set("rangeChanged",!0)):(n=i.rangeList.store.add({name:a.asc_getName(),pwd:a.asc_isPassword(),range:a.asc_getSqref(),props:a,isNew:!0,rangeChanged:!0,lock:!1,lockuser:this.guestText}),i.rangeList.selectRecord(n),i.rangeList.scrollToRecord(i.rangeList.getSelectedRec()),i.updateButtons()))}}).on("close",(function(){i.show(),setTimeout((function(){i.getDefaultFocusableComponent().focus()}),100)}));i.hide(),o.show(s.left+65,s.top)}},onDeleteRange:function(){var t=this.rangeList.store,e=this.rangeList.getSelectedRec();if(e){!e.get("isNew")&&this.deletedArr.push(e.get("props"));var i=t.indexOf(e);t.remove(e),t.length>0&&this.rangeList.selectByIndex(i),this.rangeList.scrollToRecord(this.rangeList.getSelectedRec())}this.updateButtons()},getSettings:function(){var t=[];return this.rangeList.store.each((function(e){e.get("rangeChanged")&&t.push(e.get("props"))})),{arr:t,deletedArr:this.deletedArr}},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},getUserName:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return AscCommon.UserInfoParser.getParsedName(i.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){if(i){this.userTipHide();if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;i.toJSON(),this.currentNamedRange=_.indexOf(this.rangeList.store.models,i)}this.updateButtons()}},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onLockProtectedRangeManager",this.wrapEvents.onLockProtectedRangeManager),this.api.asc_unregisterCallback("asc_onUnLockProtectedRangeManager",this.wrapEvents.onUnLockProtectedRangeManager),this.api.asc_unregisterCallback("asc_onLockProtectedRange",this.wrapEvents.onLockProtectedRange),this.api.asc_unregisterCallback("asc_onUnLockProtectedRange",this.wrapEvents.onUnLockProtectedRange),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onLockProtectedRangeManager:function(t){this.currentSheet===t&&(this.locked=!0,this.updateButtons(),!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this)))},onUnLockProtectedRangeManager:function(t){this.currentSheet===t&&(this.locked=!1,this.updateButtons())},onLockProtectedRange:function(t,e,i){if(this.currentSheet===t){var s=this.rangeList.store.findWhere({rangeId:e});s&&(s.set("lockuser",i?this.isUserVisible(i)?this.getUserName(i):this.lockText:this.guestText),s.set("lock",!0),this.updateButtons()),!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))}},onUnLockProtectedRange:function(t,e){if(this.currentSheet===t){var i=this.rangeList.store.findWhere({rangeId:e});i&&(i.set("lockuser",""),i.set("lock",!1),this.updateButtons())}},updateButtons:function(){var t=this.rangeList.getSelectedRec(),e=!!t&&t.get("lock"),i=this.rangeList.store.length;this.btnDeleteRange.setDisabled(i<1||e),this.btnEditRange.setDisabled(i<1||e)},txtTitle:"Allow Users to Edit Ranges",textRangesDesc:"Ranges unlocked by a password when sheet is protected (this works only for locked cells)",textTitle:"Title",textRange:"Range",textPwd:"Password",textNew:"New",textEdit:"Edit",textDelete:"Delete",textEmpty:"No ranges allowed for edit.",guestText:"Guest",tipIsLocked:"This element is being edited by another user.",warnDelete:"Are you sure you want to delete the name {0}?",textProtect:"Protect Sheet",txtYes:"Yes",txtNo:"No",txtEditRange:"Edit Range",txtNewRange:"New Range",lockText:"Locked"},SSE.Views.ProtectRangesDlg||{}))})),define("text!spreadsheeteditor/main/app/template/ProtectedRangesManagerDlg.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan=2 class="padding-very-small">\n                    <label><%= scope.textRangesDesc %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textFilter %></label>\n                    <div id="protect-edit-ranges-combo-filter" class="input-group-nr" style="width:170px;"></div>\n                </td>\n                <td id="protect-edit-group-btn" class="padding-small">\n                    <button type="button" class="btn btn-text-default margin-right-5" id="protect-edit-ranges-btn-new" style="min-width: 80px;"><%= scope.textNew %></button>\n                    <button type="button" class="btn btn-text-default margin-right-15" id="protect-edit-ranges-btn-edit" style="min-width: 80px;"><%= scope.textEdit %></button>\n                    <button type="button" class="btn btn-text-default" id="protect-edit-ranges-btn-delete" style="min-width: 80px;"><%= scope.textDelete %></button>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-very-small"></td>\n            </tr>\n            <tr>\n                <td colspan=2>\n                    <div id="protect-edit-ranges-list" class="range-tableview" style="width:100%; height: 188px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/ProtectedRangesManagerDlg",["text!spreadsheeteditor/main/app/template/ProtectedRangesManagerDlg.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{},SSE.Views.ProtectedRangesManagerDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"ProtectedRangesManagerDlg",contentWidth:490,separator:!1,buttons:["close"]},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.locked=e.locked||!1,this.userTooltip=!0,this.currentRange=0,this.currentUser=e.currentUser,this.canRequestUsers=e.canRequestUsers,this.wrapEvents={onRefreshUserProtectedRangesList:_.bind(this.onRefreshUserProtectedRangesList,this),onLockUserProtectedManager:_.bind(this.onLockUserProtectedManager,this),onApiSheetChanged:_.bind(this.onApiSheetChanged,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbFilter=new Common.UI.ComboBox({el:$("#protect-edit-ranges-combo-filter"),menuStyle:"min-width: 100%;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}).on("selected",(function(e,i){t.refreshRangeList(0)})),this.rangeList=new Common.UI.ListView({el:$("#protect-edit-ranges-list",this.$window),store:new Common.UI.DataViewStore,multiSelect:!0,simpleAddMode:!0,emptyText:this.textEmpty,headers:[{name:this.textTitle,width:184},{name:this.textRange,width:191},{name:this.txtAccess,width:70}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;<% if (!lock) { %>pointer-events:none;<% } %>">','<div class="padding-right-5" style="width:184px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:191px;"><%= Common.Utils.String.htmlEncode(range) %></div>','<div style="width:70px;"><% if (type===Asc.c_oSerUserProtectedRangeType.edit) { %>',t.txtEdit,"<% } else if (type===Asc.c_oSerUserProtectedRangeType.view) { %>",t.txtView,"<% } else { %>",t.txtDenied,"<% } %></div>","<% if (lock) { %>",'<div class="lock-user"><%=Common.Utils.String.htmlEncode(lockuser)%></div>',"<% } %>","</div>"].join("")),tabindex:1}),this.rangeList.on("item:select",_.bind(this.onSelectRangeItem,this)).on("item:deselect",_.bind(this.onDeselectRangeItem,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickItem,this)).on("entervalue",_.bind(this.onDblClickItem,this)),this.btnNewRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-new")}),this.btnNewRange.on("click",_.bind(this.onEditRange,this,!1)),this.btnEditRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-edit")}),this.btnEditRange.on("click",_.bind(this.onEditRange,this,!0)),this.btnDeleteRange=new Common.UI.Button({el:$("#protect-edit-ranges-btn-delete")}),this.btnDeleteRange.on("click",_.bind(this.onDeleteRange,this)),this.afterRender()},getFocusedComponents:function(){return[this.cmbFilter,this.btnNewRange,this.btnEditRange,this.btnDeleteRange,this.rangeList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.rangeList},afterRender:function(){this._setDefaults()},_setDefaults:function(){this.onApiSheetChanged(),this.api.asc_registerCallback("asc_onRefreshUserProtectedRangesList",this.wrapEvents.onRefreshUserProtectedRangesList),this.api.asc_registerCallback("asc_onLockUserProtectedManager",this.wrapEvents.onLockUserProtectedManager),this.api.asc_registerCallback("asc_onSheetsChanged",this.wrapEvents.onApiSheetChanged)},refreshRangeList:function(t){var e=this.cmbFilter.getValue(),i=this.api.asc_getUserProtectedRanges(e>=0?this.api.asc_getWorksheetName(e):void 0);if(i){for(var s=[],n=this.currentUser.id,a=0;a<i.length;a++){var o=i[a].asc_getIsLock(),l=i[a].asc_getUsers(),r=i[a].asc_getType(),c=_.find(l,(function(t){return t.asc_getId()===n}));c&&(r=c.asc_getType()),s.push({name:i[a].asc_getName()||"",range:i[a].asc_getRef()||"",rangeId:i[a].asc_getId()||"",users:l,props:i[a],type:r,canEdit:r===Asc.c_oSerUserProtectedRangeType.edit,lock:null!=o,lockuser:o?this.isUserVisible(o)?this.getUserName(o):this.lockText:this.guestText})}this.rangeList.store.reset(s)}var d=this,h=this.rangeList.store,p=h.length;if(p>0){if(null==t&&(t=0),_.isNumber(t))t>p-1&&(t=p-1),this.rangeList.selectByIndex(t),setTimeout((function(){d.rangeList.scrollToRecord(h.at(t))}),50);else if(t){var u=h.findWhere({rangeId:t.asc_getId()});u&&(this.rangeList.selectRecord(u),setTimeout((function(){d.rangeList.scrollToRecord(u)}),50))}!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(d.onMouseOverLock,d)).on("mouseout",_.bind(d.onMouseOutLock,d))}this.updateButtons(),_.delay((function(){d.rangeList.scroller.update({alwaysVisibleY:!0})}),100,this)},onMouseOverLock:function(t,e,i){if(!0===this.userTooltip&&$(t.target).hasClass("lock-user")){var s=this,n=$(t.target).tooltip({title:this.tipIsLocked,trigger:"manual"}).data("bs.tooltip");this.userTooltip=n.tip(),this.userTooltip.css("z-index",parseInt(this.$window.css("z-index"))+10),n.show(),setTimeout((function(){s.userTipHide()}),5e3)}},userTipHide:function(){"object"==_typeof(this.userTooltip)&&(this.userTooltip.remove(),this.userTooltip=void 0,this.rangeList.cmpEl.off("mouseover").off("mouseout"))},onMouseOutLock:function(t,e,i){"object"==_typeof(this.userTooltip)&&this.userTipHide()},onEditRange:function(t){if(!this._isWarningVisible)if(this.locked)Common.NotificationCenter.trigger("protectedrange:locked");else{var e,i=this,s=Common.Utils.getOffset(i.$window),n=this.rangeList.getSelectedRec();if(t){if(!n||1!==n.length)return;e=n[0].get("props")}else(e=new Asc.CUserProtectedRange).asc_setRef(i.api.asc_getActiveRangeStr(Asc.referenceType.A));var a=new SSE.Views.ProtectedRangesEditDlg({title:t?i.txtEditRange:i.txtNewRange,props:e,isEdit:t,api:i.api,canRequestUsers:i.canRequestUsers,currentUser:{id:i.currentUser.id,name:i.getUserName(i.currentUser.id,!0)},handler:function(s,n){"ok"==s&&(i.currentRange=n,t?i.api.asc_changeUserProtectedRange(e,n):i.api.asc_addUserProtectedRange(n))}}).on("close",(function(){i.show(),setTimeout((function(){i.getDefaultFocusableComponent().focus()}),100)}));i.hide(),a.show(s.left+65,s.top)}},onDeleteRange:function(){var t=this.rangeList.getSelectedRec();if(t&&t.length>0){var e=this;e._isWarningVisible=!0,Common.UI.warning({msg:t.length>1?e.warnDeleteRanges:Common.Utils.String.format(e.warnDelete,t[0].get("name")),maxwidth:500,buttons:["ok","cancel"],callback:function(i){"ok"==i&&(e.currentRange=_.indexOf(e.rangeList.store.models,t[t.length-1])-t.length+1,e.api.asc_deleteUserProtectedRange(_.map(t,(function(t){return t.get("props")})))),setTimeout((function(){e.getDefaultFocusableComponent().focus()}),100),e._isWarningVisible=!1}})}},getSettings:function(){},onPrimary:function(){return!0},onDlgBtnClick:function(t){this.handler&&this.handler.call(this,t.currentTarget.attributes.result.value,this.getSettings()),this.close()},getUserName:function(t,e){var i=SSE.getCollection("Common.Collections.Users");if(i){var s=e?i.findOriginalUser(t):i.findUser(t);if(s)return AscCommon.UserInfoParser.getParsedName(s.get("username"))}return this.guestText},isUserVisible:function(t){var e=SSE.getCollection("Common.Collections.Users");if(e){var i=e.findUser(t);if(i)return!i.get("hidden")}return!0},onSelectRangeItem:function(t,e,i){if(i){this.userTipHide();if(_.isFunction(i.toJSON)){if(!i.get("selected"))return;i.toJSON(),this.currentRange=_.indexOf(this.rangeList.store.models,i)}this.updateButtons()}},onDeselectRangeItem:function(t,e,i){this.userTipHide(),this.updateButtons()},hide:function(){this.userTipHide(),Common.UI.Window.prototype.hide.call(this)},close:function(){this.userTipHide(),this.api.asc_unregisterCallback("asc_onRefreshUserProtectedRangesList",this.wrapEvents.onRefreshUserProtectedRangesList),this.api.asc_unregisterCallback("asc_onLockUserProtectedManager",this.wrapEvents.onLockUserProtectedManager),this.api.asc_unregisterCallback("asc_onSheetsChanged",this.wrapEvents.onApiSheetChanged),Common.UI.Window.prototype.close.call(this)},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDeleteRange.isDisabled()||this.onDeleteRange()},onDblClickItem:function(t,e,i){this.btnEditRange.isDisabled()||this.onEditRange(!0)},onRefreshUserProtectedRangesList:function(){this.refreshRangeList(this.currentRange)},onLockUserProtectedManager:function(t){this.locked=!!t,this.updateButtons(),this.locked&&!0===this.userTooltip&&this.rangeList.cmpEl.find(".lock-user").length>0&&this.rangeList.cmpEl.on("mouseover",_.bind(this.onMouseOverLock,this)).on("mouseout",_.bind(this.onMouseOutLock,this))},updateButtons:function(){var t=this.rangeList.getSelectedRec(),e=!(t&&t.length>0)||_.find(t,(function(t){return!!t.get("lock")})),i=this.rangeList.store.length,s=!!(t&&t.length>0)&&!_.find(t,(function(t){return!t.get("canEdit")}));this.btnDeleteRange.setDisabled(i<1||e||!s||!!this.currentUser.anonymous),this.btnEditRange.setDisabled(i<1||!(t&&1===t.length)||e||!s||!!this.currentUser.anonymous),this.btnNewRange.setDisabled(!!this.currentUser.anonymous)},onApiSheetChanged:function(){for(var t=this.cmbFilter.store.length>0?this.cmbFilter.getValue():this.api.asc_getActiveWorksheetIndex(),e=this.api.asc_getWorksheetsCount(),i=-1,s=[];++i<e;)this.api.asc_isWorksheetHidden(i)||s.push({displayValue:this.api.asc_getWorksheetName(i),value:i});this.cmbFilter.setData([{value:-1,displayValue:this.textFilterAll}].concat(s)),this.cmbFilter.setValue(t,-1),this.refreshRangeList(this.cmbFilter.getValue()!==t?0:this.currentRange)},txtTitle:"Protected Ranges",textRangesDesc:"You can restrict editing or viewing ranges to selected people.",textTitle:"Title",textRange:"Range",textNew:"New",textEdit:"Edit",textDelete:"Delete",textEmpty:"No protected ranges have been created yet.<br>Create at least one protected range and it will appear in this field.",guestText:"Guest",tipIsLocked:"This element is being edited by another user.",warnDelete:"Are you sure you want to delete the protected range {0}?<br>Anyone who has edit access to the spreadsheet will be able to edit content in the range.",warnDeleteRanges:"Are you sure you want to delete the protected ranges?<br>Anyone who has edit access to the spreadsheet will be able to edit content in those ranges.",textProtect:"Protect Sheet",txtEdit:"Edit",txtView:"View",txtEditRange:"Edit Range",txtNewRange:"New Range",lockText:"Locked",textFilter:"Filter",textFilterAll:"All",txtDenied:"Denied",txtAccess:"Access"},SSE.Views.ProtectedRangesManagerDlg||{}))})),define("spreadsheeteditor/main/app/view/RemoveDuplicatesDialog",[],(function(){"use strict";SSE.Views.RemoveDuplicatesDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 16px;">',"<label>"+this.textDescription+"</label>","</div>",'<div class="input-row">','<div id="rem-duplicates-dlg-headers"></div>',"</div>",'<div class="input-row">','<label class="font-weight-bold">'+this.textColumns+"</label>","</div>",'<div id="rem-duplicates-dlg-columns" class="" style="width: 100%; height: 162px; overflow: hidden;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.props=this.options.props,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.chHeaders=new Common.UI.CheckBox({el:$("#rem-duplicates-dlg-headers"),labelText:this.textHeaders}),this.chHeaders.on("change",_.bind((function(t,e,i,s){this.props.asc_setHasHeaders("checked"==t.getValue()),this.props.asc_updateColumnList(),this.updateColumnsList()}),this)),this.columnsList=new Common.UI.ListView({el:$("#rem-duplicates-dlg-columns",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,tabindex:1,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="has-checkbox">',Common.UI.CheckBoxTemplate,'<div id="<%= id %>" class="list-item margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join(""))}),this.columnsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.columnsList.onKeyDown=_.bind(this.onListKeyDown,this),this.columnsList.on("entervalue",_.bind(this.onPrimary,this)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},updateColumnsList:function(){var t=!1,e=0,i=[],s=this.columnsList.store;s.length<1?(this.props.asc_getColumnList().forEach((function(t,s){var n=t.asc_getVisible();i.push(new Common.UI.DataViewModel({id:s,selected:!1,allowSelected:!0,value:t.asc_getVal(),groupid:"1",check:n})),n&&e++})),e==i.length?t=!0:e>0&&(t="indeterminate"),i.length>0&&i.unshift(new Common.UI.DataViewModel({id:i.length,selected:!1,allowSelected:!0,value:this.textSelectAll,groupid:"0",check:t,throughIndex:0})),this.columnsList.store.reset(i),this.columnsList.scroller.update({minScrollbarLength:this.columnsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})):this.props.asc_getColumnList().forEach((function(t,e){s.at(e+1).set("value",t.asc_getVal())}))},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){if(!this.checkCellTrigerBlock){var s="",n=!1,a=null,o=window.event?window.event:window._event;if(o){if((s=$(o.currentTarget).find(".list-item")).length){a=Common.Utils.getBoundingClientRect(s.get(0));var l=o.clientX*Common.Utils.zoom(),r=o.clientY*Common.Utils.zoom();a.left<l&&l<a.right&&a.top<r&&r<a.bottom&&(n=!0)}(n||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay((function(){t.focus()}),100,this))}}},onListKeyDown:function(t,e){var i=this.columnsList;i.disabled||(_.isUndefined(void 0)&&(e=t),e.keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.columnsList,t,e))},updateCellCheck:function(t,e){if(e&&t){var i=t.store,s=!e.get("check");if("0"==e.get("groupid"))i.each((function(t){t.set("check",s)}));else{e.set("check",s);for(var n=s,a=0;a<i.length;a++){var o=i.at(a);if("1"==o.get("groupid")&&o.get("check")!==s){n="indeterminate";break}}this.checkCellTrigerBlock=!0,i.at(0).set("check",n),this.checkCellTrigerBlock=void 0}t.scroller.update({minScrollbarLength:t.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})}},getFocusedComponents:function(){return[this.chHeaders,this.columnsList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.columnsList},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.chHeaders.setValue(!!t.asc_getHasHeaders(),!0),this.updateColumnsList())},getSettings:function(){var t=this.columnsList.store,e=this.props.asc_getColumnList();return t.each((function(t,i){"1"==t.get("groupid")&&e[i-1].asc_setVisible(t.get("check"))})),this.props},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():this.props),this.close()},txtTitle:"Remove Duplicates",textDescription:"To delete duplicate values, select one or more columns that contain duplicates.",textHeaders:"My data has headers",textColumns:"Columns",textSelectAll:"Select All"},SSE.Views.RemoveDuplicatesDialog||{}))})),define("spreadsheeteditor/main/app/view/SlicerAddDialog",[],(function(){"use strict";SSE.Views.SlicerAddDialog=Common.UI.Window.extend(_.extend({options:{width:250,style:"min-width: 230px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<label class="font-weight-bold">'+this.textColumns+"</label>","</div>",'<div id="add-slicers-dlg-columns" class="" style="width: 100%; height: 162px; overflow: hidden;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=this.options.props,this.handler=this.options.handler,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.columnsList=new Common.UI.ListView({el:$("#add-slicers-dlg-columns",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="has-checkbox">',Common.UI.CheckBoxTemplate,'<div id="<%= id %>" class="list-item margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join("")),tabindex:1}),this.columnsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.columnsList.onKeyDown=_.bind(this.onListKeyDown,this),this.columnsList.on("entervalue",_.bind(this.onPrimary,this)),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.columnsList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.columnsList},updateColumnsList:function(t){var e=[];t&&t.length>0&&(this.props.forEach((function(t,i){e.push(new Common.UI.DataViewModel({id:i,selected:!1,allowSelected:!0,value:t,check:!1}))})),this.columnsList.store.reset(e),this.columnsList.scroller.update({minScrollbarLength:this.columnsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0}))},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){if(!this.checkCellTrigerBlock){var s="",n=!1,a=null,o=window.event?window.event:window._event;if(o){if((s=$(o.currentTarget).find(".list-item")).length){a=Common.Utils.getBoundingClientRect(s.get(0));var l=o.clientX*Common.Utils.zoom(),r=o.clientY*Common.Utils.zoom();a.left<l&&l<a.right&&a.top<r&&r<a.bottom&&(n=!0)}(n||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay((function(){t.focus()}),100,this))}}},onListKeyDown:function(t,e){var i=this.columnsList;i.disabled||(_.isUndefined(void 0)&&(e=t),e.keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.columnsList,t,e))},updateCellCheck:function(t,e){e&&t&&e.set("check",!e.get("check"))},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&this.updateColumnsList(t);var e=this;_.delay((function(){e.columnsList.focus()}),100,this)},getSettings:function(){var t=this.columnsList.store,e=[];return t.each((function(t,i){t.get("check")&&e.push(t.get("value"))})),e},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onDblClickFormat:function(){this._handleInput("ok")},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():this.props),this.close()},txtTitle:"Insert Slicers",textColumns:"Columns"},SSE.Views.SlicerAddDialog||{}))})),define("spreadsheeteditor/main/app/view/Spellcheck",[],(function(){"use strict";SSE.Views.Spellcheck=Common.UI.BaseView.extend(_.extend({el:"#left-panel-spellcheck",template:_.template(['<div id="spellcheck-box" class="layout-ct active">','<div class="spellcheck-settings">','<div class="spellcheck-settings-inner">','<div style="display: flex; width: 100%; padding-bottom: 8px; padding-top: 16px;">','<div id="spellcheck-current-word"></div>','<div id="spellcheck-next" style=""></div>',"</div>",'<div id="spellcheck-suggestions-list"></div>','<div id="spellcheck-change" style=""></div>','<div id="spellcheck-ignore" class="padding-large margin-left-6"></div>','<button class="btn btn-text-default auto" id="spellcheck-add-to-dictionary" data-hint="1" data-hint-direction="bottom" data-hint-offset="big"><%= scope.txtAddToDictionary %></button>','<label class="header" style="display: block;"><%= scope.txtDictionaryLanguage %></label>','<div id="spellcheck-dictionary-language"></div>','<div id="spellcheck-complete" class="hidden">','<i class="btn-resolve margin-right-10"></i>',"<%= scope.txtComplete %>","</div>","</div>","</div>",'<div id="spellcheck-header">','<label role="heading"><%= scope.txtSpelling %></label>','<div id="spellcheck-btn-close" class="float-right margin-left-4"></div>',"</div>","</div>"].join("")),initialize:function(t){_.extend(this,t),Common.UI.BaseView.prototype.initialize.call(this,arguments)},render:function(t){return t=t||this.el,this.$el=$(t),this.$el.html(this.template({scope:this})),this.buttonClose=new Common.UI.Button({parentEl:$("#spellcheck-btn-close",this.$el),cls:"btn-toolbar",iconCls:"toolbar__icon btn-close",hint:this.txtClosePanel,dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.buttonClose.on("click",_.bind(this.onClickClosePanel,this)),this.currentWord=new Common.UI.InputField({el:$("#spellcheck-current-word"),allowBlank:!0,validateOnBlur:!1,disabled:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.buttonNext=new Common.UI.Button({parentEl:$("#spellcheck-next"),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon btn-nextitem icon-rtl",hint:this.txtNextTip,dataHint:"1",dataHintDirection:"bottom"}),this.suggestionList=new Common.UI.ListView({el:$("#spellcheck-suggestions-list"),emptyText:this.noSuggestions,store:new Common.UI.DataViewStore,scrollAlwaysVisible:!0,dataHint:"1",dataHintDirection:"left",dataHintOffset:"big"}),this.btnChange=new Common.UI.Button({parentEl:$("#spellcheck-change"),cls:"btn-text-split-default",caption:this.textChange,split:!0,width:110,disabled:!0,menu:new Common.UI.Menu({style:"min-width: 110px",items:[{caption:this.textChange,value:0},{caption:this.textChangeAll,value:1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnIgnore=new Common.UI.Button({parentEl:$("#spellcheck-ignore"),cls:"btn-text-split-default",caption:this.textIgnore,split:!0,width:110,disabled:!0,menu:new Common.UI.Menu({style:"min-width: 110px;",items:[{caption:this.textIgnore,value:0},{caption:this.textIgnoreAll,value:1}]}),dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.cmbDictionaryLanguage=new Common.UI.ComboBoxRecent({el:$("#spellcheck-dictionary-language"),style:"width: 100%",menuStyle:"width: 100%;max-height: 163px;",editable:!1,cls:"input-group-nr",scroller:{suppressScrollX:!0},itemTemplate:_.template(['<li id="<%= id %>" data-value="<%= value %>">','<a tabindex="-1" type="menuitem" role="menuitemcheckbox" aria-checked="false">',"<div>","<%= displayValue %>","</div>",'<label style="opacity: 0.6"><%= displayValueEn %></label>',"</a>","</li>"].join("")),search:!0,searchFields:["displayValue","displayValueEn"],dataHint:"1",dataHintDirection:"bottom",dataHintOffset:"big"}),this.btnToDictionary=new Common.UI.Button({el:$("#spellcheck-add-to-dictionary"),disabled:!0}),this.lblComplete=this.$el.find("#spellcheck-complete"),this.trigger("render:after",this),_.isUndefined(this.scroller)&&(this.scroller=new Common.UI.Scroller({el:this.$el.find(".spellcheck-settings-inner"),suppressScrollX:!0,alwaysVisibleY:!0})),$(window).on("resize",_.bind((function(){this.scroller.update({alwaysVisibleY:!0})}),this)),this.rendered=!0,this},show:function(){Common.UI.BaseView.prototype.show.call(this,arguments),this.fireEvent("show",this)},hide:function(){Common.UI.BaseView.prototype.hide.call(this,arguments),this.fireEvent("hide",this)},ChangeSettings:function(t){},onClickClosePanel:function(){Common.NotificationCenter.trigger("leftmenu:change","hide")},txtSpelling:"Spelling",noSuggestions:"No spelling suggestions",textChange:"Change",textChangeAll:"Change All",textIgnore:"Ignore",textIgnoreAll:"Ignore All",txtAddToDictionary:"Add To Dictionary",txtDictionaryLanguage:"Dictionary Language",txtComplete:"Spellcheck has been complete",txtNextTip:"Go to the next word",txtClosePanel:"Close spelling"},SSE.Views.Spellcheck||{}))})),define("text!spreadsheeteditor/main/app/template/WatchDialog.template",[],(function(){return'<div class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <button type="button" class="btn btn-text-default auto sort-dialog-btn-text" id="watch-dialog-btn-add"><%= scope.textAdd %></button>\n                    <div id="watch-dialog-btn-delete" style="display: inline-block;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <div id="watch-dialog-list" class="range-tableview" style="width:100%; height: 164px;"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/WatchDialog",["text!spreadsheeteditor/main/app/template/WatchDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views=SSE.Views||{},SSE.Views.WatchDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"WatchDialog",contentWidth:560,modal:!1,separator:!1,buttons:["close"]},initialize:function(e){_.extend(this.options,{title:this.txtTitle,contentStyle:"padding: 10px 0 0;",contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.wrapEvents={onRefreshWatchList:_.bind(this.refreshList,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.watchList=new Common.UI.ListView({el:$("#watch-dialog-list",this.$window),multiSelect:!0,store:new Common.UI.DataViewStore,simpleAddMode:!0,headers:[{name:this.textBook,width:70},{name:this.textSheet,width:70},{name:this.textName,width:70},{name:this.textCell,width:70},{name:this.textValue,width:110},{name:this.textFormula,width:135}],itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(book) %></div>','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(sheet) %></div>','<div class="padding-right-5" style="width:70px;"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="padding-right-5" style="width:70px;"><%= cell %></div>','<div class="padding-right-5" style="width:110px;" data-toggle="tooltip"><%= Common.Utils.String.htmlEncode(value) %></div>','<div style="width:135px;" data-toggle="tooltip"><%= Common.Utils.String.htmlEncode(formula) %></div>',"</div>"].join("")),tabindex:1}),this.watchList.on("item:select",_.bind(this.onSelectWatch,this)).on("item:deselect",_.bind(this.onSelectWatch,this)).on("item:keydown",_.bind(this.onKeyDown,this)).on("item:dblclick",_.bind(this.onDblClickWatch,this)).on("entervalue",_.bind(this.onEnterValue,this)).on("item:add",_.bind(this.addTooltips,this)).on("item:change",_.bind(this.addTooltips,this)).on("reset:before",_.bind(this.resetItemsBefore,this)),this.btnAdd=new Common.UI.Button({el:$("#watch-dialog-btn-add",this.$window)}),this.btnAdd.on("click",_.bind(this.onAddWatch,this,!1)),this.btnDelete=new Common.UI.Button({parentEl:$("#watch-dialog-btn-delete",this.$window),cls:"btn-text-split-default auto",caption:this.textDelete,split:!0,menu:new Common.UI.Menu({style:"min-width:100px;",items:[{caption:this.textDelete,value:0},{caption:this.textDeleteAll,value:1}]}),takeFocusOnClose:!0}),$(this.btnDelete.cmpEl.find("button")[0]).css("min-width","87px"),this.btnDelete.on("click",_.bind(this.onDeleteWatch,this)),this.btnDelete.menu.on("item:click",_.bind(this.onDeleteMenu,this)),this.afterRender()},afterRender:function(){this._setDefaults()},getFocusedComponents:function(){return[this.btnAdd,this.btnDelete,this.watchList]},getDefaultFocusableComponent:function(){return this.watchList},_setDefaults:function(t){this.refreshList(),this.api.asc_registerCallback("asc_onUpdateCellWatches",this.wrapEvents.onRefreshWatchList)},refreshList:function(t){if(t){for(var e in t)if(t.hasOwnProperty(e)){var i=parseInt(e),s=t[e],n=this.watchList.store;if(i>=0&&i<n.length)n.at(i).set({book:s.asc_getWorkbook(),sheet:s.asc_getSheet(),name:s.asc_getName(),cell:s.asc_getCell(),value:s.asc_getValue(),formula:s.asc_getFormula(),props:s})}}else{var a=[];if(t=this.api.asc_getCellWatches())for(var o=0;o<t.length;o++){var l=t[o];a.push({book:l.asc_getWorkbook(),sheet:l.asc_getSheet(),name:l.asc_getName(),cell:l.asc_getCell(),value:l.asc_getValue(),formula:l.asc_getFormula(),props:l})}if(this.watchList.store.reset(a),void 0!==this._deletedIndex){(n=this.watchList.store).length>0&&this.watchList.selectByIndex(this._deletedIndex<n.length?this._deletedIndex:n.length-1);var r=this.watchList.getSelectedRec();r&&r.length>0&&this.watchList.scrollToRecord(r[0]),this._fromKeyDown&&this.watchList.focus(),this._fromKeyDown=!1,this._deletedIndex=void 0}this.updateButtons()}},onAddWatch:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&t.api.asc_addCellWatches(e.getSettings())}}).on("close",(function(){t.show()})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:t.api.asc_getEscapeSheetName(t.api.asc_getWorksheetName(t.api.asc_getActiveWorksheetIndex()))+"!"+t.api.asc_getActiveRangeStr(Asc.referenceType.A),type:Asc.c_oAscSelectionDialogType.Chart})}},onDeleteWatch:function(){var t=this,e=this.watchList.getSelectedRec();if(e){var i=[];_.each(e,(function(e,s){t._deletedIndex=t.watchList.store.indexOf(e)-i.length,i[s]=e.get("props")})),this.api.asc_deleteCellWatches(i)}},onDeleteMenu:function(t,e){1==e.value?this.api.asc_deleteCellWatches(void 0,!0):this.onDeleteWatch()},onSelectWatch:function(t,e,i){this.updateButtons()},onDblClickWatch:function(t,e,i){i&&this.api.asc_findCell("'"+i.get("sheet")+"'!"+i.get("cell"))},onEnterValue:function(t,e){0!==this.watchList.store.length&&e&&this.api.asc_findCell("'"+e.get("sheet")+"'!"+e.get("cell"))},onKeyDown:function(t,e,i){i.keyCode!=Common.UI.Keys.DELETE||this.btnDelete.isDisabled()||(this._fromKeyDown=!0,this.onDeleteWatch())},updateButtons:function(){var t=this.watchList.getSelectedRec();this.btnDelete.setDisabled(!(t&&t.length>0)),this.watchList.scroller&&this.watchList.scroller.update({alwaysVisibleY:!0})},close:function(){this.api.asc_unregisterCallback("asc_onUpdateCellWatches",this.wrapEvents.onRefreshWatchList),Common.Views.AdvancedSettingsWindow.prototype.close.call(this)},resetItemsBefore:function(t){t.dataViewItems&&_.each(t.dataViewItems,(function(t){t.tipsArray&&t.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}))}),this)},addTooltips:function(t,e,i){e.tipsArray&&e.tipsArray.forEach((function(t){t&&(void 0===t.dontShow&&(t.dontShow=!0),t.tip().remove())}));var s=document.createElement("span"),n=Common.UI.Themes.getThemeProps("font");s.style.fontSize=n&&n.size?n.size:"11px",s.style.fontFamily=n&&n.name?n.name:'Arial, Helvetica, "Helvetica Neue", sans-serif',s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",document.body.appendChild(s);var a=$(e.el).find(".list-item > div");this.checkTextOfItem(s,e,$(a[4]),i.get("value"),this.watchList.options.headers[4].width),this.checkTextOfItem(s,e,$(a[5]),i.get("formula"),this.watchList.options.headers[5].width),document.body.removeChild(s),e.tipsArray=[]},checkTextOfItem:function(t,e,i,s,n){t.innerHTML=Common.Utils.String.htmlEncode(s);var a=this.watchList;t.offsetWidth>n&&i.one("mouseenter",(function(t){var i=$(t.target);i.tooltip({title:s,placement:"cursor",zIndex:a.tipZIndex}),i.mouseenter(),e.tipsArray.push(i.data("bs.tooltip"))}))},txtTitle:"Watch Window",textAdd:"Add watch",textDelete:"Delete watch",textDeleteAll:"Delete all",closeButtonText:"Close",textBook:"Book",textSheet:"Sheet",textName:"Name",textCell:"Cell",textValue:"Value",textFormula:"Formula"},SSE.Views.WatchDialog||{}))})),define("spreadsheeteditor/main/app/view/FormatSettingsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.FormatSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,contentHeight:260},initialize:function(t){var e=this;e.numFormatData=[{value:Asc.c_oAscNumFormatType.General,displayValue:this.txtGeneral},{value:Asc.c_oAscNumFormatType.Number,displayValue:this.txtNumber},{value:Asc.c_oAscNumFormatType.Scientific,displayValue:this.txtScientific},{value:Asc.c_oAscNumFormatType.Accounting,displayValue:this.txtAccounting},{value:Asc.c_oAscNumFormatType.Currency,displayValue:this.txtCurrency},{value:Asc.c_oAscNumFormatType.Date,displayValue:this.txtDate},{value:Asc.c_oAscNumFormatType.Time,displayValue:this.txtTime},{value:Asc.c_oAscNumFormatType.Percent,displayValue:this.txtPercentage},{value:Asc.c_oAscNumFormatType.Fraction,displayValue:this.txtFraction},{value:Asc.c_oAscNumFormatType.Text,displayValue:this.txtText},{value:Asc.c_oAscNumFormatType.Custom,displayValue:this.txtCustom}],e.FractionData=[{displayValue:this.txtUpto1,value:"# ?/?"},{displayValue:this.txtUpto2,value:"# ??/??"},{displayValue:this.txtUpto3,value:"# ???/???"},{displayValue:this.txtAs2,value:"# ?/2"},{displayValue:this.txtAs4,value:"# ?/4"},{displayValue:this.txtAs8,value:"# ?/8"},{displayValue:this.txtAs16,value:"# ??/16"},{displayValue:this.txtAs10,value:"# ?/10"},{displayValue:this.txtAs100,value:"# ??/100"}],e.CurrencySymbolsData=null,e.langId=1033,this.api=t.api,this.handler=t.handler,this.props=t.props,this.linked=t.linked||!1;var i=this.linked?275:260;_.extend(this.options,{title:this.textTitle,contentHeight:i,contentStyle:"padding: 5px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="width:170px;padding-bottom: 3px;">','<label class="header">',e.textCategory,"</label>",'<div id="format-settings-combo-format" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td class="padding-large" style="white-space: nowrap;">','<label class="format-sample margin-right-4" style="vertical-align: middle;">'+e.txtSample+"</label>",'<label class="format-sample" id="format-settings-label-example" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;">100</label>',"</td>","</tr>",'<tr class="format-no-code">','<td class="padding-small">',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large" style="vertical-align: bottom;">','<label class="header">',e.textDecimal,"</label>",'<div id="format-settings-spin-decimal"></div>',"</td>","</tr>",'<tr class="format-separator">','<td class="padding-large">','<div id="format-settings-checkbox-separator"></div>',"</td>","</tr>",'<tr class="format-symbols">','<td class="padding-large">','<label class="header">',e.textSymbols,"</label>",'<div id="format-settings-combo-symbols" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-decimal">','<td class="padding-large format-negative">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-combo-negative" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-type">','<td class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-combo-type" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>",'<tr class="format-code">','<td colspan="1" class="padding-large">','<label class="header">',e.textFormat,"</label>",'<div id="format-settings-txt-code" class="input-group-nr" style="width:264px;margin-bottom: 8px;"></div>','<div id="format-settings-list-code" style="width:264px; height: 116px;"></div>',"</td>","</tr>","<tr>",'<td colspan="1">','<div id="format-settings-chk-linked"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={hasDecimal:!1,hasNegative:!1,hasSeparator:!1,hasType:!1,hasSymbols:!1,hasCode:!1},this.FormatType=Asc.c_oAscNumFormatType.General,this.Format="General",this.FormatInfo=new Asc.asc_CFormatCellsInfo,this.CustomFormat=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.cmbFormat=new Common.UI.ComboBox({el:$("#format-settings-combo-format"),cls:"input-group-nr",menuStyle:"min-width: 264px;",editable:!1,data:this.numFormatData,takeFocusOnClose:!0}),this.cmbFormat.setValue(this.FormatType),this.cmbFormat.on("selected",_.bind(this.onFormatSelect,this)),this.cmbNegative=new Common.UI.ComboBox({el:$("#format-settings-combo-negative"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbNegative.on("selected",_.bind(this.onNegativeSelect,this)),this.spnDecimal=new Common.UI.MetricSpinner({el:$("#format-settings-spin-decimal"),step:1,width:45,defaultUnit:"",value:2,maxValue:30,minValue:0,allowDecimal:!1}),this.spnDecimal.on("change",_.bind(this.onDecimalChange,this)),this.chSeparator=new Common.UI.CheckBox({el:$("#format-settings-checkbox-separator"),labelText:this.textSeparator}),this.chSeparator.on("change",_.bind(this.onSeparatorChange,this)),this.cmbSymbols=new Common.UI.ComboBox({el:$("#format-settings-combo-symbols"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0,search:!0}),this.cmbSymbols.on("selected",_.bind(this.onSymbolsSelect,this)),this.cmbType=new Common.UI.ComboBox({el:$("#format-settings-combo-type"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:235px;",editable:!1,data:[],scrollAlwaysVisible:!0,takeFocusOnClose:!0}),this.cmbType.on("selected",_.bind(this.onTypeSelect,this)),this.codesList=new Common.UI.ListView({el:$("#format-settings-list-code"),store:new Common.UI.DataViewStore,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;overflow: hidden; text-overflow: ellipsis;"><%= Common.Utils.String.htmlEncode(value) %></div>')}),this.codesList.on("item:select",_.bind(this.onCodeSelect,this)),this.codesList.on("entervalue",_.bind(this.onPrimary,this)),this.inputCustomFormat=new Common.UI.InputField({el:$("#format-settings-txt-code"),allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){t.codesList.deselectAll(),t.Format=t.api.asc_convertNumFormatLocal2NumFormat(i),t.lblExample.text(t.api.asc_getLocaleExample(t.Format)),t.chLinked.setValue(!1,!0),t._state.warning||(e.showWarning([t.txtCustomWarning]),t._state.warning=!0)})),this.chLinked=new Common.UI.CheckBox({el:$("#format-settings-chk-linked"),labelText:this.textLinked}).on("change",(function(e,i,s,n){t.props.linked="checked"==e.getValue(),t.props.linked&&(t.props.chartFormat.putSourceLinked(!0),t.props.format=t.props.chartFormat.getFormatCode(),t.props.formatInfo=t.props.chartFormat.getFormatCellsInfo(),t._setDefaults(t.props))})),this.chLinked.setVisible(this.linked),this._decimalPanel=this.$window.find(".format-decimal"),this._negativePanel=this.$window.find(".format-negative"),this._separatorPanel=this.$window.find(".format-separator"),this._typePanel=this.$window.find(".format-type"),this._symbolsPanel=this.$window.find(".format-symbols"),this._codePanel=this.$window.find(".format-code"),this._nocodePanel=this.$window.find(".format-no-code"),this.$window.find(".format-sample").toggleClass("hidden",this.linked),this.lblExample=this.$window.find("#format-settings-label-example"),this.afterRender()},getFocusedComponents:function(){return[this.cmbFormat,this.spnDecimal,this.chSeparator,this.cmbSymbols,this.cmbNegative,this.cmbType,this.inputCustomFormat,this.codesList,this.chLinked].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFormat},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t&&t.formatInfo&&(this.langId&&(this.langId=t.langId),this.cmbFormat.setValue(t.formatInfo.asc_getType(),this.txtCustom),this.FormatInfo=t.formatInfo,t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Custom&&t.format&&(this.CustomFormat=this.Format=t.format),this.onFormatSelect(this.cmbFormat,this.cmbFormat.getSelectedRecord(),null,t.formatInfo),this._state.hasDecimal&&this.spnDecimal.setValue(t.formatInfo.asc_getDecimalPlaces()),this._state.hasSeparator&&this.chSeparator.setValue(t.formatInfo.asc_getSeparator()),this._state.hasSymbols&&this.cmbSymbols.setValue(t.formatInfo.asc_getSymbol()||t.formatInfo.asc_getCurrencySymbol()),t.format)){if(this._state.hasNegative)(e=this.cmbNegative.store.findWhere({value:t.format}))?this.cmbNegative.selectRecord(e):this.cmbNegative.setValue(this.api.asc_getLocaleExample(t.format));else if(this._state.hasType){var e;(e=this.cmbType.store.findWhere({value:t.format}))?this.cmbType.selectRecord(e):t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Fraction?this.cmbType.setValue(this.txtCustom):t.formatInfo.asc_getType()==Asc.c_oAscNumFormatType.Time?this.cmbType.setValue(this.api.asc_getLocaleExample(t.format,1.534)):this.cmbType.setValue(this.api.asc_getLocaleExample(t.format,38822))}this.Format=t.format,this.lblExample.text(this.api.asc_getLocaleExample(this.Format))}t&&t.chartFormat&&this.chLinked.setValue(!!t.chartFormat.getSourceLinked(),!0)},getSettings:function(){return{format:this.Format,formatInfo:this.FormatInfo,linked:"checked"===this.chLinked.getValue()}},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onNegativeSelect:function(t,e){this.Format=e.value,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSymbolsSelect:function(t,e){var i=this,s=new Asc.asc_CFormatCellsInfo;s.asc_setType(this.FormatType),s.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),s.asc_setSeparator(!1),"string"==typeof e.value?s.asc_setCurrencySymbol(e.value):s.asc_setSymbol(e.value);var n=this.api.asc_getFormatCells(s),a=[];n.forEach((function(t){a.push({value:t,displayValue:i.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(a),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=n[0],this.FormatInfo=s,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onDecimalChange:function(t,e,i,s){var n=this,a=new Asc.asc_CFormatCellsInfo;if(a.asc_setType(this.FormatType),a.asc_setDecimalPlaces(t.getNumberValue()),a.asc_setSeparator(this.FormatType==Asc.c_oAscNumFormatType.Number&&"checked"==this.chSeparator.getValue()),this.FormatType==Asc.c_oAscNumFormatType.Currency||this.FormatType==Asc.c_oAscNumFormatType.Accounting){var o=this.cmbSymbols.getValue();"string"==typeof o?a.asc_setCurrencySymbol(o):a.asc_setSymbol(o)}else a.asc_setSymbol(!1);var l=this.api.asc_getFormatCells(a);if(this.FormatType==Asc.c_oAscNumFormatType.Number||this.FormatType==Asc.c_oAscNumFormatType.Currency||this.FormatType==Asc.c_oAscNumFormatType.Accounting){var r=[];l.forEach((function(t){r.push({value:t,displayValue:n.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(r),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=l[0]}else this.Format=l[0];this.FormatInfo=a,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onSeparatorChange:function(t,e,i,s){var n=this,a=new Asc.asc_CFormatCellsInfo;a.asc_setType(this.FormatType),a.asc_setDecimalPlaces(this.spnDecimal.getNumberValue()),a.asc_setSeparator("checked"==t.getValue());var o=this.api.asc_getFormatCells(a),l=[];o.forEach((function(t){l.push({value:t,displayValue:n.api.asc_getLocaleExample(t,-1234.1234567890124)})})),this.cmbNegative.setData(l),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"}),this.Format=o[0],this.FormatInfo=a,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onTypeSelect:function(t,e){this.Format=e.value,this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.chLinked.setValue(!1,!0)},onCodeSelect:function(t,e,i){i&&(this.Format=i.get("format"),this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this.inputCustomFormat.setValue(i.get("value")),this.chLinked.setValue(!1,!0),this.inputCustomFormat.showWarning(),this._state.warning=!1)},onFormatSelect:function(t,e,i,s){if(e){this.FormatType=e.value;var n=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Scientific||e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Percent,a=e.value==Asc.c_oAscNumFormatType.Number||e.value==Asc.c_oAscNumFormatType.Currency||e.value==Asc.c_oAscNumFormatType.Accounting,o=e.value==Asc.c_oAscNumFormatType.Number,l=e.value==Asc.c_oAscNumFormatType.Date||e.value==Asc.c_oAscNumFormatType.Time||e.value==Asc.c_oAscNumFormatType.Fraction,r=e.value==Asc.c_oAscNumFormatType.Accounting||e.value==Asc.c_oAscNumFormatType.Currency,c=e.value==Asc.c_oAscNumFormatType.Custom,d=this,h=s?s.asc_getDecimalPlaces():this.spnDecimal.getNumberValue(),p=s?s.asc_getSeparator():"checked"==this.chSeparator.getValue(),u=s?s.asc_getSymbol()||s.asc_getCurrencySymbol():this.langId;if(e.value!==Asc.c_oAscNumFormatType.Custom){if((C=new Asc.asc_CFormatCellsInfo).asc_setType(e.value),C.asc_setDecimalPlaces(n?h:0),C.asc_setSeparator(!!o&&p),a||e.value==Asc.c_oAscNumFormatType.Date||e.value==Asc.c_oAscNumFormatType.Time){if(r){if(!d.CurrencySymbolsData){d.CurrencySymbolsData=[];var m=this.api.asc_getCurrencySymbols();for(var g in m)m.hasOwnProperty(g)&&d.CurrencySymbolsData.push({value:parseInt(g),displayValue:m[g]+" "+Common.util.LanguageInfo.getLocalLanguageName(g)[1]});d.CurrencySymbolsData.sort((function(t,e){return t.displayValue<e.displayValue?-1:t.displayValue>e.displayValue?1:0})),d.CurrencySymbolsData.unshift({value:null,displayValue:d.txtNone}),(m=this.api.asc_getAdditionalCurrencySymbols()).forEach((function(t){d.CurrencySymbolsData.push({value:t,displayValue:t})})),this.cmbSymbols.setData(this.CurrencySymbolsData),this.cmbSymbols.setValue(u)}C.asc_setSymbol(this.cmbSymbols.getValue())}var b=this.api.asc_getFormatCells(C),f=[],v=e.value==Asc.c_oAscNumFormatType.Date?38822:e.value==Asc.c_oAscNumFormatType.Time?1.534:parseFloat("-1234.12345678901234567890");b.forEach((function(t){f.push({value:t,displayValue:d.api.asc_getLocaleExample(t,v)})})),a?(this.cmbNegative.setData(f),this.cmbNegative.selectRecord(this.cmbNegative.store.at(0)),this.cmbNegative.cmpEl.find("li:nth-child(2) a, li:nth-child(4) a").css({color:"#ff0000"})):(this.cmbType.setData(f),this.cmbType.selectRecord(this.cmbType.store.at(0))),this.Format=b[0]}else e.value==Asc.c_oAscNumFormatType.Fraction?(this.cmbType.setData(this.FractionData),this.cmbType.selectRecord(this.cmbType.store.at(0)),this.Format=this.cmbType.getValue()):this.Format=this.api.asc_getFormatCells(C)[0];this.FormatInfo=C}else{var C;(C=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Custom),C.asc_setSymbol(u),this.FormatInfo=C;b=this.api.asc_getFormatCells(C),f=[];var x,y=!!this.CustomFormat;if(b.forEach((function(t){var e=new Common.UI.DataViewModel;e.set({value:d.api.asc_convertNumFormat2NumFormatLocal(t),format:t}),f.push(e),d.CustomFormat==t&&(y=!1)})),y)(x=new Common.UI.DataViewModel).set({value:d.api.asc_convertNumFormat2NumFormatLocal(this.CustomFormat),format:this.CustomFormat}),f.push(x);this.codesList.store.reset(f,{silent:!1}),(x=this.codesList.store.findWhere({value:this.Format}))&&this.codesList.selectRecord(x),x&&this.codesList.scrollToRecord(x),this.inputCustomFormat.setValue(d.api.asc_convertNumFormat2NumFormatLocal(this.Format))}this.lblExample.text(this.api.asc_getLocaleExample(this.Format)),this._decimalPanel.toggleClass("hidden",!n),this._negativePanel.toggleClass("hidden",!a),this._separatorPanel.toggleClass("hidden",!o),this._typePanel.toggleClass("hidden",!l),this._symbolsPanel.toggleClass("hidden",!r),this._codePanel.toggleClass("hidden",!c),this._nocodePanel.toggleClass("hidden",c),this._state={hasDecimal:n,hasNegative:a,hasSeparator:o,hasType:l,hasSymbols:r,hasCode:c},!s&&this.chLinked.setValue(!1,!0)}},textTitle:"Number Format",textCategory:"Category",textDecimal:"Decimal",textSeparator:"Use 1000 separator",textFormat:"Format",textSymbols:"Symbols",txtGeneral:"General",txtNumber:"Number",txtCustom:"Custom",txtCurrency:"Currency",txtAccounting:"Accounting",txtDate:"Date",txtTime:"Time",txtPercentage:"Percentage",txtFraction:"Fraction",txtScientific:"Scientific",txtText:"Text",txtUpto1:"Up to one digit (1/3)",txtUpto2:"Up to two digits (12/25)",txtUpto3:"Up to three digits (131/135)",txtAs2:"As halfs (1/2)",txtAs8:"As eighths (4/8)",txtAs4:"As fourths (2/4)",txtAs16:"As sixteenths (8/16)",txtAs10:"As tenths (5/10)",txtAs100:"As hundredths (50/100)",txtSample:"Sample:",txtNone:"None",textLinked:"Linked to source",txtCustomWarning:"Please enter the custom number format carefully. Spreadsheet Editor does not check custom formats for errors that may affect the xlsx file."},SSE.Views.FormatSettingsDialog||{}))})),define("spreadsheeteditor/main/app/view/ValueFieldSettingsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.ValueFieldSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" class="padding-small" style="white-space: nowrap;">','<label class="header margin-right-2" class="margin-right-4" style="vertical-align: middle;">'+e.txtSourceName+"</label>",'<label id="value-field-settings-source" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;"></label>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header">',e.txtCustomName,"</label>",'<div id="value-field-settings-custom" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header">',e.txtSummarize,"</label>",'<div id="value-field-settings-summarize" class="input-group-nr" style="width:264px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-large">','<label class="header" style="display:block;">',e.txtShowAs,"</label>",'<div id="value-field-settings-showas" class="input-group-nr float-left" style="width:128px;"></div>','<div id="value-field-settings-numformat" class="float-right" style="width:128px;"></div>',"</td>","</tr>",'<tr class="format-code">','<td class="padding-small">','<label class="header">',e.txtBaseField,"</label>",'<div id="value-field-settings-field" class="input-group-nr" style="width:128px;"></div>',"</td>",'<td class="padding-small float-right">','<label class="header">',e.txtBaseItem,"</label>",'<div id="value-field-settings-item" class="input-group-nr" style="width:128px;"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.props=t.props,this.field=t.field||0,this.showAsValue=t.showAsValue,this.baseFieldChanged=!1,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.inputCustomName=new Common.UI.InputField({el:$("#value-field-settings-custom"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.cmbSummarize=new Common.UI.ComboBox({el:$("#value-field-settings-summarize"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:160px;",scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0,data:[{value:Asc.c_oAscDataConsolidateFunction.Sum,displayValue:this.txtSum},{value:Asc.c_oAscDataConsolidateFunction.Count,displayValue:this.txtCount},{value:Asc.c_oAscDataConsolidateFunction.Average,displayValue:this.txtAverage},{value:Asc.c_oAscDataConsolidateFunction.Max,displayValue:this.txtMax},{value:Asc.c_oAscDataConsolidateFunction.Min,displayValue:this.txtMin},{value:Asc.c_oAscDataConsolidateFunction.Product,displayValue:this.txtProduct},{value:Asc.c_oAscDataConsolidateFunction.CountNums,displayValue:this.txtCountNums},{value:Asc.c_oAscDataConsolidateFunction.StdDev,displayValue:this.txtStdDev},{value:Asc.c_oAscDataConsolidateFunction.StdDevp,displayValue:this.txtStdDevp},{value:Asc.c_oAscDataConsolidateFunction.Var,displayValue:this.txtVar},{value:Asc.c_oAscDataConsolidateFunction.Varp,displayValue:this.txtVarp}]}),this.cmbSummarize.setValue(Asc.c_oAscDataConsolidateFunction.Sum),this.cmbSummarize.on("selected",_.bind(this.onSummarizeSelect,this)),this.cmbShowAs=new Common.UI.ComboBox({el:$("#value-field-settings-showas"),cls:"input-group-nr",menuStyle:"min-width: 264px;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[{value:Asc.c_oAscShowDataAs.Normal,displayValue:this.txtNormal,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentOfTotal,displayValue:this.txtPercentOfGrand,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfCol,displayValue:this.txtPercentOfCol,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfRow,displayValue:this.txtPercentOfTotal,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.Percent,displayValue:this.txtPercent,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParentRow,displayValue:this.txtPercentOfParentRow,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParentCol,displayValue:this.txtPercentOfParentCol,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.PercentOfParent,displayValue:this.txtPercentOfParent,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.Difference,displayValue:this.txtDifference,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentDiff,displayValue:this.txtPercentDiff,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.RunTotal,displayValue:this.txtRunTotal,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.PercentOfRunningTotal,displayValue:this.txtPercentOfRunTotal,numFormat:Asc.c_oAscNumFormatType.Percent},{value:Asc.c_oAscShowDataAs.RankAscending,displayValue:this.txtRankAscending,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.RankDescending,displayValue:this.txtRankDescending,numFormat:Asc.c_oAscNumFormatType.General},{value:Asc.c_oAscShowDataAs.Index,displayValue:this.txtIndex,numFormat:Asc.c_oAscNumFormatType.General}]}),this.cmbShowAs.setValue(Asc.c_oAscShowDataAs.Normal),this.cmbShowAs.on("selected",_.bind(this.onShowAsSelect,this)),this.cmbBaseField=new Common.UI.ComboBox({el:$("#value-field-settings-field"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[],scrollAlwaysVisible:!0}),this.cmbBaseField.on("selected",_.bind(this.onBaseFieldSelect,this)),this.cmbBaseItem=new Common.UI.ComboBox({el:$("#value-field-settings-item"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height:160px;",editable:!1,takeFocusOnClose:!0,data:[],scrollAlwaysVisible:!0}),this.cmbBaseItem.on("selected",_.bind(this.onBaseItemSelect,this)),this.lblSourceName=this.$window.find("#value-field-settings-source"),this.btnFormat=new Common.UI.Button({parentEl:$("#value-field-settings-numformat"),cls:"btn-text-default",style:"width: 128px;",caption:this.textNumFormat}),this.btnFormat.on("click",_.bind(this.openFormat,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputCustomName,this.cmbSummarize,this.cmbShowAs,this.btnFormat,this.cmbBaseField,this.cmbBaseItem].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputCustomName},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.format={defFormats:[]};var e=new Asc.asc_CFormatCellsInfo;if(e.asc_setType(Asc.c_oAscNumFormatType.General),e.asc_setDecimalPlaces(0),e.asc_setSeparator(!1),this.format.defFormats[Asc.c_oAscNumFormatType.General]={formatStr:this.api.asc_getFormatCells(e)[0],formatInfo:e},(e=new Asc.asc_CFormatCellsInfo).asc_setType(Asc.c_oAscNumFormatType.Percent),e.asc_setDecimalPlaces(2),e.asc_setSeparator(!1),this.format.defFormats[Asc.c_oAscNumFormatType.Percent]={formatStr:this.api.asc_getFormatCells(e)[0],formatInfo:e},t){var i=this.field,s=this;this.cache_names=t.asc_getCacheFields(),this.pivot_names=t.asc_getPivotFields(),this.format.formatStr=i.asc_getNumFormat(),this.format.formatInfo=i.asc_getNumFormatInfo(),this.lblSourceName.html(Common.Utils.String.htmlEncode(this.cache_names[i.asc_getIndex()].asc_getName())),this.inputCustomName.setValue(i.asc_getName()),this.cmbSummarize.setValue(i.asc_getSubtotal());var n=i.asc_getShowDataAs();this.cmbShowAs.setValue(n),this.format.show_as=n;var a=[];this.pivot_names.forEach((function(t,e){a.push({value:e,displayValue:t.asc_getName()||s.cache_names[e].asc_getName()})}));var o=this.api.asc_getPivotShowValueAsInfo(Asc.c_oAscShowDataAs.Difference);this.cmbBaseField.setData(a);var l=n===Asc.c_oAscShowDataAs.Normal||n===Asc.c_oAscShowDataAs.PercentOfTotal||n===Asc.c_oAscShowDataAs.PercentOfRow||n===Asc.c_oAscShowDataAs.PercentOfCol||n===Asc.c_oAscShowDataAs.PercentOfParentRow||n===Asc.c_oAscShowDataAs.PercentOfParentCol||n===Asc.c_oAscShowDataAs.Index;this.cmbBaseField.setDisabled(l),this.cmbBaseField.setValue(l&&o?o.asc_getBaseField():i.asc_getBaseField(),""),a=[],this.pivot_names[i.asc_getBaseField()].asc_getBaseItemObject(this.cache_names[i.asc_getBaseField()]).forEach((function(t,e){a.push({value:t.baseItem,displayValue:0===e?s.textPrev:1===e?s.textNext:t.name})})),this.cmbBaseItem.setData(a),this.cmbBaseItem.setDisabled(a.length<1||n!==Asc.c_oAscShowDataAs.Difference&&n!==Asc.c_oAscShowDataAs.Percent&&n!==Asc.c_oAscShowDataAs.PercentDiff),this.cmbBaseItem.setValue(a.length>0&&(n===Asc.c_oAscShowDataAs.Difference||n===Asc.c_oAscShowDataAs.Percent||n===Asc.c_oAscShowDataAs.PercentDiff)?i.asc_getBaseItem():"",""),this.btnFormat.setDisabled(this.props.asc_getFieldGroupType(i.asc_getIndex())===Asc.c_oAscGroupType.Text),this.getDefFormat(n)===Asc.c_oAscNumFormatType.General&&(this.format.defFormats[Asc.c_oAscNumFormatType.General]={formatStr:this.format.formatStr,formatInfo:this.format.formatInfo})}void 0!==this.showAsValue&&(this.cmbShowAs.setValue(this.showAsValue),this.onShowAsSelect(this.cmbShowAs,this.cmbShowAs.getSelectedRecord()))},getSettings:function(){var t=new Asc.CT_DataField;return t.asc_setName(this.inputCustomName.getValue()),t.asc_setSubtotal(this.cmbSummarize.getValue()),t.asc_setShowDataAs(this.cmbShowAs.getValue()),this.format.isChanged&&this.cmbShowAs.getSelectedRecord()&&t.asc_setNumFormat(this.format.formatStr),this.cmbBaseField.isDisabled()||t.asc_setBaseField(this.cmbBaseField.getValue()),this.cmbBaseItem.isDisabled()||t.asc_setBaseItem(this.cmbBaseItem.getValue()),t},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onSummarizeSelect:function(t,e){this.inputCustomName.setValue(this.txtByField.replace("%1",e.displayValue).replace("%2",this.lblSourceName.text()))},onShowAsSelect:function(t,e){var i=e.value,s=i===Asc.c_oAscShowDataAs.Normal||i===Asc.c_oAscShowDataAs.PercentOfTotal||i===Asc.c_oAscShowDataAs.PercentOfRow||i===Asc.c_oAscShowDataAs.PercentOfCol||i===Asc.c_oAscShowDataAs.PercentOfParentRow||i===Asc.c_oAscShowDataAs.PercentOfParentCol||i===Asc.c_oAscShowDataAs.Index;if(this.cmbBaseField.setDisabled(s),this.baseFieldChanged)this.cmbBaseItem.setValue((i===Asc.c_oAscShowDataAs.Difference||i===Asc.c_oAscShowDataAs.Percent||i===Asc.c_oAscShowDataAs.PercentDiff)&&this.cmbBaseItem.store.length>0?this.cmbBaseItem.store.at(this.cmbBaseItem.store.length>2?2:0).get("value"):"","");else{var n=this.api.asc_getPivotShowValueAsInfo(i);n&&(this.cmbBaseField.setValue(n.asc_getBaseField(),""),this.cmbBaseField.getSelectedRecord()&&this.changeBaseField(n.asc_getBaseItem()))}this.cmbBaseItem.setDisabled(this.cmbBaseItem.store.length<1||i!==Asc.c_oAscShowDataAs.Difference&&i!==Asc.c_oAscShowDataAs.Percent&&i!==Asc.c_oAscShowDataAs.PercentDiff);var a=this.getDefFormat(i);a!==this.getDefFormat(this.format.show_as)&&(this.format.isChanged=!0,this.format.formatStr=this.format.defFormats[a].formatStr,this.format.formatInfo=this.format.defFormats[a].formatInfo),this.format.show_as=i},onBaseFieldSelect:function(t,e){this.changeBaseField(),this.baseFieldChanged=!0},changeBaseField:function(t){var e=this.cmbBaseField.getValue(),i=this.pivot_names[e].asc_getBaseItemObject(this.cache_names[e]),s=[],n=this;i.forEach((function(t,e){s.push({value:t.baseItem,displayValue:0===e?n.textPrev:1===e?n.textNext:t.name})})),this.cmbBaseItem.setData(s),void 0===t&&s.length>0&&(t=this.cmbBaseItem.store.at(s.length>2?2:0).get("value"));var a=this.cmbShowAs.getValue();this.cmbBaseItem.setDisabled(s.length<1||a!==Asc.c_oAscShowDataAs.Difference&&a!==Asc.c_oAscShowDataAs.Percent&&a!==Asc.c_oAscShowDataAs.PercentDiff),this.cmbBaseItem.setValue((a===Asc.c_oAscShowDataAs.Difference||a===Asc.c_oAscShowDataAs.Percent||a===Asc.c_oAscShowDataAs.PercentDiff)&&s.length>0?t:"","")},onBaseItemSelect:function(t,e){},openFormat:function(){var t=this,e=t.api.asc_getLocale(),i=Common.Utils.InternalSettings.get("sse-config-lang");!e&&(e=i?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i)):1033),new SSE.Views.FormatSettingsDialog({api:t.api,handler:function(e,i){"ok"==e&&i&&(t.format.isChanged=!0,t.format.formatStr=i.format,t.format.formatInfo=i.formatInfo,t.getDefFormat(t.format.show_as)===Asc.c_oAscNumFormatType.General&&(t.format.defFormats[Asc.c_oAscNumFormatType.General].formatStr=i.format,t.format.defFormats[Asc.c_oAscNumFormatType.General].formatInfo=i.formatInfo))},props:{format:this.format.formatStr,formatInfo:this.format.formatInfo,langId:e}}).on("close",(function(){t.btnFormat.cmpEl.focus()})).show()},getDefFormat:function(t){return t===Asc.c_oAscShowDataAs.Normal||t===Asc.c_oAscShowDataAs.Difference||t===Asc.c_oAscShowDataAs.RunTotal||t===Asc.c_oAscShowDataAs.RankAscending||t===Asc.c_oAscShowDataAs.RankDescending||t===Asc.c_oAscShowDataAs.Index?Asc.c_oAscNumFormatType.General:Asc.c_oAscNumFormatType.Percent},textTitle:"Value Field Settings",txtSourceName:"Source name:",txtCustomName:"Custom name",txtSummarize:"Summarize value field by",txtShowAs:"Show values as",txtBaseField:"Base field",txtBaseItem:"Base item",txtAverage:"Average",txtCount:"Count",txtCountNums:"Count Numbers",txtMax:"Max",txtMin:"Min",txtProduct:"Product",txtStdDev:"StdDev",txtStdDevp:"StdDevp",txtSum:"Sum",txtVar:"Var",txtVarp:"Varp",txtNormal:"No calculation",txtDifference:"Difference from",txtPercent:"% of",txtPercentDiff:"% difference from",txtRunTotal:"Running total in",txtPercentOfRunTotal:"% running total in",txtPercentOfCol:"% of column total",txtPercentOfTotal:"% of row total",txtPercentOfGrand:"% of grand total",txtIndex:"Index",txtByField:"%1 of %2",txtPercentOfParentRow:"% of parent row total",txtPercentOfParentCol:"% of parent column total",txtPercentOfParent:"% of parent total",txtRankAscending:"Rank smallest to largest",txtRankDescending:"Rank largest to smallest",textPrev:"(previous)",textNext:"(next)",textNumFormat:"Number format"},SSE.Views.ValueFieldSettingsDialog||{}))})),define("spreadsheeteditor/main/app/view/SpecialPasteDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.SpecialPasteDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:350,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan=2 class="padding-small">','<label class="header">',this.textPaste,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-all"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-without-borders"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-formulas"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-formats"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-values"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-col-width"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-formats"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-formula-num-format"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-comments"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-value-num-format"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">','<div id="paste-radio-col-width"></div>',"</td>",'<td class="padding-large">','<div id="paste-radio-value-formats"></div>',"</td>","</tr>","<tr>",'<td colspan=2 class="padding-small">','<label class="header">',this.textOperation,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-none"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-mult"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-add"></div>',"</td>",'<td class="padding-small">','<div id="paste-radio-div"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-radio-sub"></div>',"</td>",'<td class="padding-small">',"</td>","</tr>","<tr>",'<td colspan=2 class="padding-small" style="border-top: 1px solid #cbcbcb;">',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="paste-checkbox-transpose"></div>',"</td>",'<td class="padding-small">','<div id="paste-checkbox-blanks"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.handler=t.handler,this.props=t.props,this._changedProps=null,this.isTable=!!t.isTable,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.propControls=[],this.radioAll=new Common.UI.RadioBox({el:$("#paste-radio-all"),name:"asc-radio-paste",labelText:this.textAll,value:Asc.c_oSpecialPasteProps.paste,disabled:!0}),this.radioAll.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.paste]=this.radioAll,this.radioFormulas=new Common.UI.RadioBox({el:$("#paste-radio-formulas"),name:"asc-radio-paste",labelText:this.textFormulas,value:Asc.c_oSpecialPasteProps.pasteOnlyFormula,disabled:!0}),this.radioFormulas.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyFormula]=this.radioFormulas,this.radioValues=new Common.UI.RadioBox({el:$("#paste-radio-values"),name:"asc-radio-paste",labelText:this.textValues,value:Asc.c_oSpecialPasteProps.pasteOnlyValues,disabled:!0}),this.radioValues.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyValues]=this.radioValues,this.radioFormats=new Common.UI.RadioBox({el:$("#paste-radio-formats"),name:"asc-radio-paste",labelText:this.textFormats,value:Asc.c_oSpecialPasteProps.pasteOnlyFormating,disabled:!0}),this.radioFormats.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.pasteOnlyFormating]=this.radioFormats,this.radioComments=new Common.UI.RadioBox({el:$("#paste-radio-comments"),name:"asc-radio-paste",labelText:this.textComments,value:Asc.c_oSpecialPasteProps.comments,disabled:!0}),this.radioComments.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.comments]=this.radioComments,this.radioColWidth=new Common.UI.RadioBox({el:$("#paste-radio-col-width"),name:"asc-radio-paste",labelText:this.textColWidth,value:Asc.c_oSpecialPasteProps.columnWidth,disabled:!0}),this.radioColWidth.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.columnWidth]=this.radioColWidth,this.radioWBorders=new Common.UI.RadioBox({el:$("#paste-radio-without-borders"),name:"asc-radio-paste",labelText:this.textWBorders,value:Asc.c_oSpecialPasteProps.formulaWithoutBorders,disabled:!0}),this.radioWBorders.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaWithoutBorders]=this.radioWBorders,this.radioFFormat=new Common.UI.RadioBox({el:$("#paste-radio-formula-formats"),name:"asc-radio-paste",labelText:this.textFFormat,value:Asc.c_oSpecialPasteProps.formulaAllFormatting,disabled:!0}),this.radioFFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaAllFormatting]=this.radioFFormat,this.radioFWidth=new Common.UI.RadioBox({el:$("#paste-radio-formula-col-width"),name:"asc-radio-paste",labelText:this.textFWidth,value:Asc.c_oSpecialPasteProps.formulaColumnWidth,disabled:!0}),this.radioFWidth.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaColumnWidth]=this.radioFWidth,this.radioFNFormat=new Common.UI.RadioBox({el:$("#paste-radio-formula-num-format"),name:"asc-radio-paste",labelText:this.textFNFormat,value:Asc.c_oSpecialPasteProps.formulaNumberFormat,disabled:!0}),this.radioFNFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.formulaNumberFormat]=this.radioFNFormat,this.radioVNFormat=new Common.UI.RadioBox({el:$("#paste-radio-value-num-format"),name:"asc-radio-paste",labelText:this.textVNFormat,value:Asc.c_oSpecialPasteProps.valueNumberFormat,disabled:!0}),this.radioVNFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.valueNumberFormat]=this.radioVNFormat,this.radioVFormat=new Common.UI.RadioBox({el:$("#paste-radio-value-formats"),name:"asc-radio-paste",labelText:this.textVFormat,value:Asc.c_oSpecialPasteProps.valueAllFormating,disabled:!0}),this.radioVFormat.on("change",_.bind(this.onRadioPasteChange,this)),this.propControls[Asc.c_oSpecialPasteProps.valueAllFormating]=this.radioVFormat,this.radioNone=new Common.UI.RadioBox({el:$("#paste-radio-none"),name:"asc-radio-paste-operation",labelText:this.textNone,value:Asc.c_oSpecialPasteOperation.none,checked:!0}),this.radioNone.on("change",_.bind(this.onRadioOperationChange,this)),this.radioAdd=new Common.UI.RadioBox({el:$("#paste-radio-add"),name:"asc-radio-paste-operation",labelText:this.textAdd,value:Asc.c_oSpecialPasteOperation.add}),this.radioAdd.on("change",_.bind(this.onRadioOperationChange,this)),this.radioMult=new Common.UI.RadioBox({el:$("#paste-radio-mult"),name:"asc-radio-paste-operation",labelText:this.textMult,value:Asc.c_oSpecialPasteOperation.multiply}),this.radioMult.on("change",_.bind(this.onRadioOperationChange,this)),this.radioSub=new Common.UI.RadioBox({el:$("#paste-radio-sub"),name:"asc-radio-paste-operation",labelText:this.textSub,value:Asc.c_oSpecialPasteOperation.subtract}),this.radioSub.on("change",_.bind(this.onRadioOperationChange,this)),this.radioDiv=new Common.UI.RadioBox({el:$("#paste-radio-div"),name:"asc-radio-paste-operation",labelText:this.textDiv,value:Asc.c_oSpecialPasteOperation.divide}),this.radioDiv.on("change",_.bind(this.onRadioOperationChange,this)),this.chBlanks=new Common.UI.CheckBox({el:$("#paste-checkbox-blanks"),labelText:this.textBlanks}),this.chTranspose=new Common.UI.CheckBox({el:$("#paste-checkbox-transpose"),labelText:this.textTranspose}),this.afterRender()},getFocusedComponents:function(){return[this.radioAll,this.radioFormulas,this.radioValues,this.radioFormats,this.radioComments,this.radioColWidth,this.radioWBorders,this.radioFFormat,this.radioFWidth,this.radioFNFormat,this.radioVNFormat,this.radioVFormat,this.radioNone,this.radioAdd,this.radioMult,this.radioSub,this.radioDiv,this.chBlanks,this.chTranspose].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.radioAll},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){var e=this;t&&_.each(t,(function(t,i){e.propControls[t]&&e.propControls[t].setDisabled(!1)})),this._changedProps=new Asc.SpecialPasteProps,this._changedProps.asc_setProps(Asc.c_oSpecialPasteProps.paste),this._changedProps.asc_setOperation(Asc.c_oSpecialPasteOperation.none),this.radioAll.setValue(!0)},getSettings:function(){return this._changedProps&&(this._changedProps.asc_setTranspose("checked"==this.chTranspose.getValue()),this._changedProps.asc_setSkipBlanks("checked"==this.chBlanks.getValue())),this._changedProps},onDlgBtnClick:function(t){this._handleInput("object"==_typeof(t)?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){this.handler&&this.handler.call(this,t,"ok"==t?this.getSettings():void 0),this.close()},onRadioPasteChange:function(t,e,i){if(e&&this._changedProps){this._changedProps.asc_setProps(t.options.value);var s=t.options.value==Asc.c_oSpecialPasteProps.pasteOnlyFormating||t.options.value==Asc.c_oSpecialPasteProps.comments||t.options.value==Asc.c_oSpecialPasteProps.columnWidth,n=this.isTable&&!!this._changedProps.asc_getTableAllowed();this.radioNone.setDisabled(s||n),this.radioAdd.setDisabled(s||n),this.radioDiv.setDisabled(s||n),this.radioSub.setDisabled(s||n),this.radioMult.setDisabled(s||n),this.chBlanks.setDisabled(n),this.chTranspose.setDisabled(n)}},onRadioOperationChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setOperation(t.options.value)},textTitle:"Paste Special",textAll:"All",textFormulas:"Formulas",textValues:"Values",textFormats:"Formats",textComments:"Comments",textColWidth:"Column widths",textWBorders:"All except borders",textFFormat:"Formulas & formatting",textFWidth:"Formulas & column widths",textFNFormat:"Formulas & number formats",textVNFormat:"Values & number formats",textVFormat:"Values & formatting",textNone:"None",textAdd:"Add",textMult:"Multiply",textDiv:"Divide",textSub:"Subtract",textBlanks:"Skip blanks",textTranspose:"Transpose",textOperation:"Operation",textPaste:"Paste"},SSE.Views.SpecialPasteDialog||{}))})),define("text!spreadsheeteditor/main/app/template/FieldSettingsDialog.template",[],(function(){return'<div id="id-pivot-field-settings-layout" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small" style="white-space: nowrap;">\n                    <label class="header margin-right-4" style="vertical-align: middle;"><%= scope.txtSourceName %></label>\n                    <label id="field-settings-source" style="vertical-align: middle; max-width: 220px; overflow: hidden; text-overflow: ellipsis;"></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.txtCustomName %></label>\n                    <div id="field-settings-custom" style="width:264px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.textReport %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-tab"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-outline"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-compact" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-numformat" style="width:128px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-repeat"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-blank"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-subtotals"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-radio-top" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <div id="field-settings-radio-bottom" class="margin-left-20"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-empty"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-pivot-field-settings-subtotals" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <label class="header"><%= scope.txtSummarize %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-sum"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-count"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-ave"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-max"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-min"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-product"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-num"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-dev"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-devp"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-var"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="field-settings-chk-varp"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),define("spreadsheeteditor/main/app/view/FieldSettingsDialog",["text!spreadsheeteditor/main/app/template/FieldSettingsDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.FieldSettingsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:284,contentHeight:365,toggleGroup:"pivot-field-settings-group",storageName:"sse-pivot-field-settings-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-pivot-field-settings-layout",panelCaption:this.strLayout},{panelId:"id-pivot-field-settings-subtotals",panelCaption:this.strSubtotals}],contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this.fieldIndex=e.fieldIndex||0,this.type=e.type||0,this.format={formatStr:"General"},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.inputCustomName=new Common.UI.InputField({el:$("#field-settings-custom"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.lblSourceName=this.$window.find("#field-settings-source"),this.radioTabular=new Common.UI.RadioBox({el:$("#field-settings-radio-tab"),labelText:this.txtTabular,name:"asc-radio-report-form"}),this.radioOutline=new Common.UI.RadioBox({el:$("#field-settings-radio-outline"),labelText:this.txtOutline,name:"asc-radio-report-form",checked:!0}),this.chCompact=new Common.UI.CheckBox({el:$("#field-settings-chk-compact"),labelText:this.txtCompact}),this.chRepeat=new Common.UI.CheckBox({el:$("#field-settings-chk-repeat"),labelText:this.txtRepeat}),this.chBlank=new Common.UI.CheckBox({el:$("#field-settings-chk-blank"),labelText:this.txtBlank}),this.chSubtotals=new Common.UI.CheckBox({el:$("#field-settings-chk-subtotals"),labelText:this.txtShowSubtotals}),this.radioTop=new Common.UI.RadioBox({el:$("#field-settings-radio-top"),labelText:this.txtTop,name:"asc-radio-show-subtotals"}),this.radioBottom=new Common.UI.RadioBox({el:$("#field-settings-radio-bottom"),labelText:this.txtBottom,name:"asc-radio-show-subtotals",checked:!0}),this.chEmpty=new Common.UI.CheckBox({el:$("#field-settings-chk-empty"),labelText:this.txtEmpty}),this.chSum=new Common.UI.CheckBox({el:$("#field-settings-chk-sum"),labelText:this.txtSum}),this.chCount=new Common.UI.CheckBox({el:$("#field-settings-chk-count"),labelText:this.txtCount}),this.chAve=new Common.UI.CheckBox({el:$("#field-settings-chk-ave"),labelText:this.txtAverage}),this.chMax=new Common.UI.CheckBox({el:$("#field-settings-chk-max"),labelText:this.txtMax}),this.chMin=new Common.UI.CheckBox({el:$("#field-settings-chk-min"),labelText:this.txtMin}),this.chProduct=new Common.UI.CheckBox({el:$("#field-settings-chk-product"),labelText:this.txtProduct}),this.chNum=new Common.UI.CheckBox({el:$("#field-settings-chk-num"),labelText:this.txtCountNums}),this.chDev=new Common.UI.CheckBox({el:$("#field-settings-chk-dev"),labelText:this.txtStdDev}),this.chDevp=new Common.UI.CheckBox({el:$("#field-settings-chk-devp"),labelText:this.txtStdDevp}),this.chVar=new Common.UI.CheckBox({el:$("#field-settings-chk-var"),labelText:this.txtVar}),this.chVarp=new Common.UI.CheckBox({el:$("#field-settings-chk-varp"),labelText:this.txtVarp}),this.btnFormat=new Common.UI.Button({parentEl:$("#field-settings-numformat"),cls:"btn-text-default",style:"width: 128px;",caption:this.textNumFormat}),this.btnFormat.on("click",_.bind(this.openFormat,this)),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputCustomName,this.radioTabular,this.radioOutline,this.chCompact,this.btnFormat,this.chRepeat,this.chBlank,this.chSubtotals,this.radioTop,this.radioBottom,this.chEmpty,this.chSum,this.chCount,this.chAve,this.chMax,this.chMin,this.chProduct,this.chNum,this.chDev,this.chDevp,this.chVar,this.chVarp]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputCustomName.focus();break;case 1:i.chSum.focus()}}),10)},afterRender:function(){if(this._setDefaults(this.props),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){var e=this,i=t.asc_getPivotFields()[this.fieldIndex];if(this.format.formatStr=i.asc_getNumFormat(),this.format.formatInfo=i.asc_getNumFormatInfo(),this.lblSourceName.html(Common.Utils.String.htmlEncode(t.getCacheFieldName(this.fieldIndex))),this.inputCustomName.setValue(t.getPivotFieldName(this.fieldIndex)),i.asc_getOutline()?this.radioOutline.setValue(!0):this.radioTabular.setValue(!0),this.chCompact.setValue(i.asc_getOutline()&&i.asc_getCompact()),this.chRepeat.setValue(i.asc_getFillDownLabelsDefault()),this.chBlank.setValue(i.asc_getInsertBlankRow()),this.chSubtotals.setValue(i.asc_getDefaultSubtotal()),i.asc_getSubtotalTop()?this.radioTop.setValue(!0):this.radioBottom.setValue(!0),this.chEmpty.setValue(i.asc_getShowAll()),i.asc_getDefaultSubtotal()){var s=i.asc_getSubtotals();s&&_.each(s,(function(t){switch(t){case Asc.c_oAscItemType.Sum:e.chSum.setValue(!0);break;case Asc.c_oAscItemType.Count:e.chNum.setValue(!0);break;case Asc.c_oAscItemType.Avg:e.chAve.setValue(!0);break;case Asc.c_oAscItemType.Max:e.chMax.setValue(!0);break;case Asc.c_oAscItemType.Min:e.chMin.setValue(!0);break;case Asc.c_oAscItemType.Product:e.chProduct.setValue(!0);break;case Asc.c_oAscItemType.CountA:e.chCount.setValue(!0);break;case Asc.c_oAscItemType.StdDev:e.chDev.setValue(!0);break;case Asc.c_oAscItemType.StdDevP:e.chDevp.setValue(!0);break;case Asc.c_oAscItemType.Var:e.chVar.setValue(!0);break;case Asc.c_oAscItemType.VarP:e.chVarp.setValue(!0)}}))}this.btnFormat.setVisible(t.asc_getFieldGroupType(this.fieldIndex)!==Asc.c_oAscGroupType.Text)}},getSettings:function(){var t=new Asc.CT_PivotField;if(t.asc_setName(this.inputCustomName.getValue()),t.asc_setOutline(this.radioOutline.getValue()),t.asc_setCompact(this.radioOutline.getValue()&&"checked"==this.chCompact.getValue()),t.asc_setFillDownLabelsDefault("checked"==this.chRepeat.getValue()),t.asc_setInsertBlankRow("checked"==this.chBlank.getValue()),t.asc_setDefaultSubtotal("checked"==this.chSubtotals.getValue()),t.asc_setSubtotalTop(this.radioTop.getValue()),t.asc_setShowAll("checked"==this.chEmpty.getValue()),t.asc_getDefaultSubtotal()){var e=[];"checked"==this.chSum.getValue()&&e.push(Asc.c_oAscItemType.Sum),"checked"==this.chNum.getValue()&&e.push(Asc.c_oAscItemType.Count),"checked"==this.chAve.getValue()&&e.push(Asc.c_oAscItemType.Avg),"checked"==this.chMax.getValue()&&e.push(Asc.c_oAscItemType.Max),"checked"==this.chMin.getValue()&&e.push(Asc.c_oAscItemType.Min),"checked"==this.chProduct.getValue()&&e.push(Asc.c_oAscItemType.Product),"checked"==this.chCount.getValue()&&e.push(Asc.c_oAscItemType.CountA),"checked"==this.chDev.getValue()&&e.push(Asc.c_oAscItemType.StdDev),"checked"==this.chDevp.getValue()&&e.push(Asc.c_oAscItemType.StdDevP),"checked"==this.chVar.getValue()&&e.push(Asc.c_oAscItemType.Var),"checked"==this.chVarp.getValue()&&e.push(Asc.c_oAscItemType.VarP),t.asc_setSubtotals(e)}return this.format.isChanged&&t.asc_setNumFormat(this.format.formatStr),t},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;"ok"==e&&this.handler&&this.handler.call(this,e,"ok"==e?this.getSettings():void 0),this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},openFormat:function(){var t=this,e=t.api.asc_getLocale(),i=Common.Utils.InternalSettings.get("sse-config-lang");!e&&(e=i?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(i)):1033),new SSE.Views.FormatSettingsDialog({api:t.api,handler:function(e,i){"ok"==e&&i&&(t.format.isChanged=!0,t.format.formatStr=i.format,t.format.formatInfo=i.formatInfo)},props:{format:this.format.formatStr,formatInfo:this.format.formatInfo,langId:e}}).on("close",(function(){t.btnFormat.cmpEl.focus()})).show()},textTitle:"Field Settings",strSubtotals:"Subtotals",strLayout:"Layout",txtSourceName:"Source name:",txtCustomName:"Custom name",textReport:"Report Form",txtTabular:"Tabular",txtOutline:"Outline",txtCompact:"Compact",txtRepeat:"Repeat items labels at each row",txtBlank:"Insert blank rows after each item",txtShowSubtotals:"Show subtotals",txtTop:"Show at top of group",txtBottom:"Show at bottom of group",txtEmpty:"Show items with no data",txtSummarize:"Functions for Subtotals",txtAverage:"Average",txtCount:"Count",txtCountNums:"Count Numbers",txtMax:"Max",txtMin:"Min",txtProduct:"Product",txtStdDev:"StdDev",txtStdDevp:"StdDevp",txtSum:"Sum",txtVar:"Var",txtVarp:"Varp",textNumFormat:"Number format"},SSE.Views.FieldSettingsDialog||{}))})),define("text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template",[],(function(){return'<div id="id-chart-settings-dlg-style" class="settings-panel active">\r\n    <div class="inner-content">\r\n        <table cols="1" style="" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textType %></label>\r\n                    <div id="chart-dlg-button-type" class="margin-right-15"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-chart-settings-dlg-layout" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small" width="50%">\r\n                    <label class="input-label"><%= scope.textChartTitle %></label>\r\n                    <div id="chart-dlg-combo-chart-title" class="input-group-nr margin-right-7"></div>\r\n                </td>\r\n                <td class="padding-small" width="50%">\r\n                    <label class="input-label margin-left-7"><%= scope.textLegendPos %></label>\r\n                    <div id="chart-dlg-combo-legend-pos" class="input-group-nr margin-left-7"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="50%">\r\n                    <label class="input-label"><%= scope.textDataLabels %></label>\r\n                    <div id="chart-dlg-combo-data-labels" class="input-group-nr margin-right-7"></div>\r\n                </td>\r\n                <td rowspan="2" class="padding-small" width="50%">\r\n                    <div id="chart-dlg-check-series"></div>\r\n                    <div id="chart-dlg-check-category"></div>\r\n                    <div id="chart-dlg-check-value"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="50%">\r\n                    <label class="input-label"><%= scope.textSeparator %></label>\r\n                    <div id="chart-dlg-txt-separator" class="input-row margin-right-7"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="50%">\r\n                    <label id="chart-dlg-label-lines" class="input-label"><%= scope.textLines %></label>\r\n                    <div id="chart-dlg-combo-lines" class="input-group-nr margin-right-7"></div>\r\n                </td>\r\n                <td class="padding-small" style="vertical-align: bottom;" width="50%">\r\n                    <div id="chart-dlg-check-markers" class="margin-left-7"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" colspan=2></td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textTrendlineOptions %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="2">\r\n                    <div id="chart-dlg-chk-show-equation"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-chart-settings-dlg-vert" class="settings-panel">\r\n</div>\r\n<div id="id-chart-settings-dlg-vert-sec" class="settings-panel">\r\n</div>\r\n<div id="id-chart-settings-dlg-hor" class="settings-panel">\r\n</div>\r\n<div id="id-chart-settings-dlg-hor-sec" class="settings-panel">\r\n</div>\r\n<div id="id-spark-settings-dlg-style" class="settings-panel">\r\n    <div class="inner-content padding-large">\r\n        <table cols="2" style="" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textType %></label>\r\n                    <div id="spark-dlg-button-type" class="margin-right-15"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textStyle %></label>\r\n                    <div id="spark-dlg-combo-style" style="width: 190px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textEmptyCells %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="230">\r\n                    <label class="input-label"><%= scope.textShowEmptyCells %></label>\r\n                    <div id="spark-dlg-combo-empty" class="input-group-nr margin-right-10"></div>\r\n                </td>\r\n                <td></td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=2>\r\n                    <div id="spark-dlg-check-show-data"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-spark-settings-dlg-axis" class="settings-panel">\r\n    <div class="inner-content">\r\n        <div class="padding-large" >\r\n            <label class="header padding-small" style="display: block;"><%= scope.textHorAxis %></label>\r\n            <div id="spark-dlg-check-show" class="padding-small" style="display: block;"></div>\r\n            <div id="spark-dlg-check-reverse" class="padding-small" style="display: block;"></div>\r\n        </div>\r\n        <table cols="3" style="width: 100%" role="presentation">\r\n            <tr>\r\n                <td colspan="3">\r\n                    <label class="header  padding-small"><%= scope.textVertAxis %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="100">\r\n                    <label class="input-label"><%= scope.textMinValue %></label>\r\n                </td>\r\n                <td class="padding-small padding-right-10" width="115">\r\n                    <div id="spark-dlg-combo-mintype"></div>\r\n                </td>\r\n                <td class="padding-small" width="90">\r\n                    <div id="spark-dlg-input-min-value"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large" width="100">\r\n                    <label class="input-label"><%= scope.textMaxValue %></label>\r\n                </td>\r\n                <td class="padding-large padding-right-10" width="115">\r\n                    <div id="spark-dlg-combo-maxtype"></div>\r\n                </td>\r\n                <td class="padding-large" width="90">\r\n                    <div id="spark-dlg-input-max-value"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-chart-settings-dlg-snap" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" role="presentation">\r\n            <tr>\r\n                <td class="padding-small" role="radiogroup" aria-owns="chart-dlg-radio-onecell chart-dlg-radio-absolute">\r\n                    <div id="chart-dlg-radio-twocell"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="chart-dlg-radio-onecell"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="chart-dlg-radio-absolute"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-chart-settings-dlg-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="chart-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="chart-advanced-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("text!spreadsheeteditor/main/app/template/ChartVertAxis.template",[],(function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%" role="presentation">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-vert-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-vert-title-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-vert-grid-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%" role="presentation">\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textMinValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-mintype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-min-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textMaxValue %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-maxtype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-max-value-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="100">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-large padding-right-10" width="115">\n                <div id="chart-dlg-combo-v-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-large" width="90">\n                <div id="chart-dlg-input-v-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="2" role="presentation">\n        <tr>\n            <td class="padding-small padding-right-10" style="min-width: 100px;">\n                <label class="input-label"><%= scope.textUnits %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-units-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <div id="chart-dlg-check-v-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <div id="chart-dlg-check-v-logscale-<%=idx%>"></div>\n            </td>\n            <td class="padding-large">\n                <div class="base float-right">\n                    <label class="input-label vertical-align-baseline"><%= scope.textBase %></label>\n                    <div id="chart-dlg-input-base-<%=idx%>" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\n                </div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-v-major-type-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-v-minor-type-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <label class="input-label"><%= scope.textLabelPos %></label>\n            </td>\n            <td>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <div id="chart-dlg-combo-v-label-pos-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td>\n                <button type="button" class="btn btn-text-default auto margin-left-15" id="chart-dlg-btn-v-format-<%=idx%>" style="min-width: 100px;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'})),define("text!spreadsheeteditor/main/app/template/ChartHorAxis.template",[],(function(){return'<div class="inner-content">\n    <table cols="2" style="width: 100%" role="presentation">\n        <tr>\n            <td colspan="2" class="padding-small">\n                <div id="chart-dlg-chk-hor-hide-<%=idx%>" class="input-group-nr"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large">\n                <label class="input-label"><%= scope.textAxisTitle %></label>\n                <div id="chart-dlg-combo-hor-title-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-large">\n                <label class="input-label margin-left-15"><%= scope.textGridLines %></label>\n                <div id="chart-dlg-combo-hor-grid-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n    </table>\n    <table cols="3" style="width: 100%" role="presentation">\n        <tr>\n            <td class="padding-small" width="100">\n                <label class="input-label"><%= scope.textAxisCrosses %></label>\n            </td>\n            <td class="padding-small padding-right-10" width="115">\n                <div id="chart-dlg-combo-h-crosstype-<%=idx%>"></div>\n            </td>\n            <td class="padding-small" width="90">\n                <div id="chart-dlg-input-h-axis-crosses-<%=idx%>"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="100">\n                <label class="input-label"><%= scope.textAxisPos %></label>\n            </td>\n            <td colspan=2 class="padding-large">\n                <div id="chart-dlg-combo-axis-pos-<%=idx%>" class="input-group-nr" style="width:140px;"></div>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=3 class="padding-large">\n                <div id="chart-dlg-check-h-reverse-<%=idx%>"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textTickOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="140">\n                <label class="input-label"><%= scope.textMajorType %></label>\n                <div id="chart-dlg-combo-h-major-type-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label margin-left-15"><%= scope.textMinorType %></label>\n                <div id="chart-dlg-combo-h-minor-type-<%=idx%>" class="input-group-nr margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textMarksInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-large" width="140">\n                <div id="chart-dlg-input-marks-interval-<%=idx%>"></div>\n            </td>\n            <td class="padding-large">\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="inner-content">\n    <table cols="2" style="width: 100%;" role="presentation">\n        <tr>\n            <td colspan=2 class="padding-small">\n                <label class="header"><%= scope.textLabelOptions %></label>\n            </td>\n        </tr>\n        <tr>\n            <td class="padding-small" width="140">\n                <label class="input-label"><%= scope.textLabelPos %></label>\n                <div id="chart-dlg-combo-h-label-pos-<%=idx%>" class="input-group-nr"></div>\n            </td>\n            <td class="padding-small">\n                <label class="input-label margin-left-15"><%= scope.textLabelDist %></label>\n                <div id="chart-dlg-input-label-dist-<%=idx%>" class="margin-left-15"></div>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <label class="input-label"><%= scope.textLabelInterval %></label>\n            </td>\n        </tr>\n        <tr>\n            <td width="100%" colspan="2">\n                <div id="chart-dlg-combo-label-int-<%=idx%>" class="input-group-nr" style="display: inline-block;width: 100px;vertical-align: middle;"></div>\n                <div id="chart-dlg-input-label-int-<%=idx%>" class="margin-left-3" style="display: inline-block;width: 60px;vertical-align: middle;"></div>\n                <button type="button" class="btn btn-text-default auto float-right margin-left-5" id="chart-dlg-btn-h-format-<%=idx%>" style="min-width:100px; vertical-align: middle;"><%= scope.textFormat %></button>\n            </td>\n        </tr>\n    </table>\n</div>'})),define("spreadsheeteditor/main/app/view/ChartSettingsDlg",["text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template","text!spreadsheeteditor/main/app/template/ChartVertAxis.template","text!spreadsheeteditor/main/app/template/ChartHorAxis.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t,e,i){"use strict";SSE.Views.ChartSettingsDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:327,contentHeight:460,toggleGroup:"chart-settings-dlg-group",storageName:"sse-chart-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-chart-settings-dlg-style",panelCaption:this.textType},{panelId:"id-chart-settings-dlg-layout",panelCaption:this.textLayout},{panelId:"id-chart-settings-dlg-vert",panelCaption:this.textVertAxis},{panelId:"id-chart-settings-dlg-vert-sec",panelCaption:this.textVertAxisSec},{panelId:"id-chart-settings-dlg-hor",panelCaption:this.textHorAxis},{panelId:"id-chart-settings-dlg-hor-sec",panelCaption:this.textHorAxisSec},{panelId:"id-spark-settings-dlg-style",panelCaption:this.textTypeData},{panelId:"id-spark-settings-dlg-axis",panelCaption:this.textAxisOptions},{panelId:"id-chart-settings-dlg-snap",panelCaption:this.textSnap},{panelId:"id-chart-settings-dlg-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),this.options.handler=function(t,i){if("ok"==t&&!this.isRangeValid())return!0;e.handler&&e.handler.call(this,t,i)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._state={ChartType:Asc.c_oAscChartTypeSettings.barNormal,SparkType:-1},this._noApply=!0,this._changedProps=null,this._changedImageProps=null,this.api=this.options.api,this.chartSettings=this.options.chartSettings,this.imageSettings=this.options.imageSettings,this.sparklineStyles=this.options.sparklineStyles,this.isChart=this.options.isChart,this.isDiagramMode=!!this.options.isDiagramMode,this.vertAxisProps=[],this.vertAxisPropsIndexes=[],this.horAxisProps=[],this.horAxisPropsIndexes=[],this.currentAxisProps=[],this.dataRangeValid="",this.sparkDataRangeValid="",this.dataLocationRangeValid="",this.currentChartType=this._state.ChartType,this.storageName=this.isChart?"sse-chart-settings-adv-category":"sse-spark-settings-adv-category"},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.getChild();this.isDiagramMode&&(this.btnChartType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-bar-normal",menu:new Common.UI.Menu({style:"width: 364px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="id-chart-dlg-menu-type" class="menu-insertchart"></div>')}]})}),this.btnChartType.on("render:after",(function(e){t.mnuChartTypePicker=new Common.UI.DataView({el:$("#id-chart-dlg-menu-type"),parentMenu:e.menu,restoreHeight:535,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getChartGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getChartData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})})),this.btnChartType.render($("#chart-dlg-button-type")),this.mnuChartTypePicker.on("item:click",_.bind(this.onSelectType,this,this.btnChartType))),this.cmbChartTitle=new Common.UI.ComboBox({el:$("#chart-dlg-combo-chart-title"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartTitleShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartTitleShowSettings.overlay,displayValue:this.textOverlay},{value:Asc.c_oAscChartTitleShowSettings.noOverlay,displayValue:this.textNoOverlay}],takeFocusOnClose:!0}),this.cmbLegendPos=new Common.UI.ComboBox({el:$("#chart-dlg-combo-legend-pos"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartLegendShowSettings.none,displayValue:this.textNone},{value:Asc.c_oAscChartLegendShowSettings.bottom,displayValue:this.textLegendBottom},{value:Asc.c_oAscChartLegendShowSettings.top,displayValue:this.textLegendTop},{value:Asc.c_oAscChartLegendShowSettings.right,displayValue:this.textLegendRight},{value:Asc.c_oAscChartLegendShowSettings.left,displayValue:this.textLegendLeft},{value:Asc.c_oAscChartLegendShowSettings.leftOverlay,displayValue:this.textLeftOverlay},{value:Asc.c_oAscChartLegendShowSettings.rightOverlay,displayValue:this.textRightOverlay}],takeFocusOnClose:!0}),this.cmbDataLabels=new Common.UI.ComboBox({el:$("#chart-dlg-combo-data-labels"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter},{value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}],takeFocusOnClose:!0}),this.cmbDataLabels.on("selected",_.bind(t.onSelectDataLabels,this)),this.txtSeparator=new Common.UI.InputField({el:$("#chart-dlg-txt-separator"),name:"range",style:"width: 100%;",allowBlank:!0,blankError:this.txtEmpty}),this.chSeriesName=new Common.UI.CheckBox({el:$("#chart-dlg-check-series"),labelText:this.textSeriesName}),this.chCategoryName=new Common.UI.CheckBox({el:$("#chart-dlg-check-category"),labelText:this.textCategoryName}),this.chValue=new Common.UI.CheckBox({el:$("#chart-dlg-check-value"),labelText:this.textValue}),this.cmbLines=new Common.UI.ComboBox({el:$("#chart-dlg-combo-lines"),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:0,displayValue:this.textNone},{value:1,displayValue:this.textStraight},{value:2,displayValue:this.textSmooth}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.chartSettings&&(this.chartSettings.putLine(0!==e.value),e.value>0&&this.chartSettings.putSmooth(2==e.value))}),this)),this.chMarkers=new Common.UI.CheckBox({el:$("#chart-dlg-check-markers"),labelText:this.textMarkers}).on("change",_.bind((function(t,e){this.chartSettings&&this.chartSettings.putShowMarker("checked"==e)}),this)),this.lblLines=$("#chart-dlg-label-lines"),this.chShowEquation=new Common.UI.CheckBox({el:$("#chart-dlg-chk-show-equation"),labelText:this.textShowEquation}).on("change",_.bind((function(t,e){this.chartSettings&&this.chartSettings.putDisplayTrendlinesEquation("checked"===e)}),this)),this.cmbMinType=[],this.spnMinValue=[],this.cmbMaxType=[],this.spnMaxValue=[],this.cmbVCrossType=[],this.spnVAxisCrosses=[],this.cmbUnits=[],this.chVReverse=[],this.cmbVMajorType=[],this.cmbVMinorType=[],this.cmbVLabelPos=[],this.cmbVertTitle=[],this.cmbVertGrid=[],this.chVertHide=[],this.btnVFormat=[],this.chVLogScale=[],this.spnBase=[],this._arrVertTitle=[{value:Asc.c_oAscChartVertAxisLabelShowSettings.none,displayValue:t.textNone},{value:Asc.c_oAscChartVertAxisLabelShowSettings.rotated,displayValue:t.textRotated},{value:Asc.c_oAscChartVertAxisLabelShowSettings.horizontal,displayValue:t.textHorizontal}],this.cmbHCrossType=[],this.cmbAxisPos=[],this.spnHAxisCrosses=[],this.chHReverse=[],this.cmbHMajorType=[],this.cmbHMinorType=[],this.spnMarksInterval=[],this.cmbHLabelPos=[],this.spnLabelDist=[],this.cmbLabelInterval=[],this.spnLabelInterval=[],this.cmbHorTitle=[],this.cmbHorGrid=[],this.chHorHide=[],this.btnHFormat=[],this._arrHorTitle=[{value:Asc.c_oAscChartHorAxisLabelShowSettings.none,displayValue:t.textNone},{value:Asc.c_oAscChartHorAxisLabelShowSettings.noOverlay,displayValue:t.textNoOverlay}],this.btnSparkType=new Common.UI.Button({cls:"btn-large-dataview",iconCls:"svgicon chart-spark-column",menu:new Common.UI.Menu({style:"width: 167px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="id-spark-dlg-menu-type" class="menu-insertchart"></div>')}]}),takeFocusOnClose:!0}),this.btnSparkType.on("render:after",(function(e){t.mnuSparkTypePicker=new Common.UI.DataView({el:$("#id-spark-dlg-menu-type"),parentMenu:e.menu,restoreHeight:120,groups:new Common.UI.DataViewGroupStore(Common.define.chartData.getSparkGroupData()),store:new Common.UI.DataViewStore(Common.define.chartData.getSparkData()),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>')})})),this.btnSparkType.render($("#spark-dlg-button-type")),this.mnuSparkTypePicker.on("item:click",_.bind(this.onSelectSparkType,this,this.btnSparkType)),this.cmbSparkStyle=new Common.UI.ComboDataView({itemWidth:50,itemHeight:50,menuMaxHeight:272,enableKeyEvents:!0,cls:"combo-spark-style",minWidth:190}),this.cmbSparkStyle.render($("#spark-dlg-combo-style")),this.cmbSparkStyle.on("click",_.bind(this.onSelectSparkStyle,this)),this.cmbSparkStyle.openButton.menu.on("show:after",(function(){t.cmbSparkStyle.menuPicker.scroller.update({alwaysVisibleY:!0})})),this._arrEmptyCells=[{value:Asc.c_oAscEDispBlanksAs.Gap,displayValue:this.textGaps},{value:Asc.c_oAscEDispBlanksAs.Zero,displayValue:this.textZero},{value:Asc.c_oAscEDispBlanksAs.Span,displayValue:this.textEmptyLine}],this.cmbEmptyCells=new Common.UI.ComboBox({el:$("#spark-dlg-combo-empty"),menuStyle:"min-width: 220px;",editable:!1,cls:"input-group-nr",takeFocusOnClose:!0}),this.cmbEmptyCells.on("selected",_.bind((function(t,e){this._changedProps&&this._changedProps.asc_setDisplayEmpty(e.value)}),this)),this.chShowEmpty=new Common.UI.CheckBox({el:$("#spark-dlg-check-show-data"),labelText:this.textShowData}),this.chShowEmpty.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_setDisplayHidden("checked"==t.getValue())}),this)),this.chShowAxis=new Common.UI.CheckBox({el:$("#spark-dlg-check-show"),labelText:this.textShowSparkAxis}),this.chShowAxis.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_setDisplayXAxis("checked"==t.getValue())}),this)),this.chReverse=new Common.UI.CheckBox({el:$("#spark-dlg-check-reverse"),labelText:this.textReverseOrder}),this.chReverse.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_setRightToLeft("checked"==t.getValue())}),this)),this.cmbSparkMinType=new Common.UI.ComboBox({el:$("#spark-dlg-combo-mintype"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:this.textAutoEach,value:Asc.c_oAscSparklineAxisMinMax.Individual},{displayValue:this.textSameAll,value:Asc.c_oAscSparklineAxisMinMax.Group},{displayValue:this.textFixed,value:Asc.c_oAscSparklineAxisMinMax.Custom}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.spnSparkMinValue.setDisabled(e.value!==Asc.c_oAscSparklineAxisMinMax.Custom),this._changedProps&&this._changedProps.asc_setMinAxisType(e.value),e.value==Asc.c_oAscSparklineAxisMinMax.Custom&&_.isEmpty(this.spnSparkMinValue.getValue())&&this.spnSparkMinValue.setValue(0)}),this)),this.spnSparkMinValue=new Common.UI.MetricSpinner({el:$("#spark-dlg-input-min-value"),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,i){this._changedProps&&this._changedProps.asc_setManualMin(t.getNumberValue())}),this)),this.cmbSparkMaxType=new Common.UI.ComboBox({el:$("#spark-dlg-combo-maxtype"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:this.textAutoEach,value:Asc.c_oAscSparklineAxisMinMax.Individual},{displayValue:this.textSameAll,value:Asc.c_oAscSparklineAxisMinMax.Group},{displayValue:this.textFixed,value:Asc.c_oAscSparklineAxisMinMax.Custom}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){this.spnSparkMaxValue.setDisabled(e.value!==Asc.c_oAscSparklineAxisMinMax.Custom),this._changedProps&&this._changedProps.asc_setMaxAxisType(e.value),e.value==Asc.c_oAscSparklineAxisMinMax.Custom&&_.isEmpty(this.spnSparkMaxValue.getValue())&&this.spnSparkMaxValue.setValue(0)}),this)),this.spnSparkMaxValue=new Common.UI.MetricSpinner({el:$("#spark-dlg-input-max-value"),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,i){this._changedProps&&this._changedProps.asc_setManualMax(t.getNumberValue())}),this)),this.radioTwoCell=new Common.UI.RadioBox({el:$("#chart-dlg-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#chart-dlg-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#chart-dlg-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#chart-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 1:i.cmbChartTitle.focus();break;case 2:case 3:e-=2;var t=i.vertAxisPropsIndexes[e];i.onVCategoryClick(e),i.vertAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType[t].focus():i.cmbHCrossType[t].isDisabled()?i.btnHFormat[t].focus():i.cmbHCrossType[t].focus();break;case 4:case 5:e-=4;t=i.horAxisPropsIndexes[e];i.onHCategoryClick(e),i.horAxisProps[e].getAxisType()===Asc.c_oAscAxisType.val?i.cmbMinType[t].focus():i.cmbHCrossType[t].isDisabled()?i.btnHFormat[t].focus():i.cmbHCrossType[t].focus();break;case 6:i.btnSparkType.focus();break;case 7:i.chShowAxis.focus();break;case 8:i.radioTwoCell.focus();break;case 9:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this._setDefaults(this.chartSettings),this.setTitle(this.isChart?this.textTitle:this.textTitleSparkline),this.btnsCategory[0].setVisible(this.isDiagramMode),this.isChart?(this.btnsCategory[6].setVisible(!1),this.btnsCategory[7].setVisible(!1)):(this.btnsCategory[1].setVisible(!1),this.btnsCategory[2].setVisible(!1),this.btnsCategory[3].setVisible(!1),this.btnsCategory[4].setVisible(!1),this.btnsCategory[5].setVisible(!1),this.btnsCategory[8].setVisible(!1),this.btnsCategory[9].setVisible(!1)),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0),2==(t=this.getActiveCategory())||3==t?this.onVCategoryClick(t-2):4!=t&&5!=t||this.onHCategoryClick(t-4)}},addControlsV:function(t){var i=this,s=i.chVertHide.length,n=$(_.template(e)({scope:i,idx:s}));return t.append(n),i.chVertHide[s]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-vert-hide-"+s),labelText:i.textHideAxis}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putShow("checked"!==e)}),i)),Common.UI.FocusManager.add(this,i.chVertHide[s]),i.cmbVertTitle[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-title-"+s),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:i._arrVertTitle,takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putLabel(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVertTitle[s]),i.cmbVertGrid[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-vert-grid-"+s),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:i.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:i.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:i.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:i.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putGridlines(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVertGrid[s]),i.cmbMinType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-mintype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:i.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putMinValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&i.spnMinValue[s].setValue(i._originalAxisVValues[s].minAuto,!0))}),i)),Common.UI.FocusManager.add(this,i.cmbMinType[s]),i.spnMinValue[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-min-value-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbMinType[s].suspendEvents(),i.cmbMinType[s].setValue(Asc.c_oAscValAxisRule.fixed),i.cmbMinType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putMinValRule(Asc.c_oAscValAxisRule.fixed),i.currentAxisProps[s].putMinVal(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnMinValue[s]),i.cmbMaxType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-maxtype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscValAxisRule.auto},{displayValue:i.textFixed,value:Asc.c_oAscValAxisRule.fixed}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putMaxValRule(e.value),e.value==Asc.c_oAscValAxisRule.auto&&i.spnMaxValue[s].setValue(i._originalAxisVValues[s].maxAuto,!0))}),i)),Common.UI.FocusManager.add(this,i.cmbMaxType[s]),i.spnMaxValue[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-max-value-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbMaxType[s].suspendEvents(),i.cmbMaxType[s].setValue(Asc.c_oAscValAxisRule.fixed),i.cmbMaxType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putMaxValRule(Asc.c_oAscValAxisRule.fixed),i.currentAxisProps[s].putMaxVal(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnMaxValue[s]),i.cmbVCrossType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-crosstype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:i.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:i.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:i.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:i.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){if(i.currentAxisProps[s])switch(i.currentAxisProps[s].putCrossesRule(e.value),e.value){case Asc.c_oAscCrossesRule.minValue:i.spnVAxisCrosses[s].setValue(i.spnMinValue[s].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.maxValue:i.spnVAxisCrosses[s].setValue(i.spnMaxValue[s].getNumberValue(),!0);break;case Asc.c_oAscCrossesRule.auto:i.spnVAxisCrosses[s].setValue(i._originalAxisVValues[s].crossesAuto,!0)}}),i)),Common.UI.FocusManager.add(this,i.cmbVCrossType[s]),i.spnVAxisCrosses[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-v-axis-crosses-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,e,n){i.cmbVCrossType[s].suspendEvents(),i.cmbVCrossType[s].setValue(Asc.c_oAscCrossesRule.value),i.cmbVCrossType[s].resumeEvents(),i.currentAxisProps[s]&&(i.currentAxisProps[s].putCrossesRule(Asc.c_oAscCrossesRule.value),i.currentAxisProps[s].putCrosses(t.getNumberValue()))}),i)),Common.UI.FocusManager.add(this,i.spnVAxisCrosses[s]),i.cmbUnits[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-units-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscValAxUnits.none},{displayValue:i.textHundreds,value:Asc.c_oAscValAxUnits.HUNDREDS},{displayValue:i.textThousands,value:Asc.c_oAscValAxUnits.THOUSANDS},{displayValue:i.textTenThousands,value:Asc.c_oAscValAxUnits.TEN_THOUSANDS},{displayValue:i.textHundredThousands,value:Asc.c_oAscValAxUnits.HUNDRED_THOUSANDS},{displayValue:i.textMillions,value:Asc.c_oAscValAxUnits.MILLIONS},{displayValue:i.textTenMillions,value:Asc.c_oAscValAxUnits.TEN_MILLIONS},{displayValue:i.textHundredMil,value:Asc.c_oAscValAxUnits.HUNDRED_MILLIONS},{displayValue:i.textBillions,value:Asc.c_oAscValAxUnits.BILLIONS},{displayValue:i.textTrillions,value:Asc.c_oAscValAxUnits.TRILLIONS}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putDispUnitsRule(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbUnits[s]),i.chVReverse[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-reverse-"+s),labelText:i.textReverse}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putInvertValOrder("checked"==e)}),i)),Common.UI.FocusManager.add(this,i.chVReverse[s]),i.cmbVMajorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-major-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:i.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:i.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:i.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putMajorTickMark(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVMajorType[s]),i.cmbVMinorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-minor-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:i.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:i.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:i.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putMinorTickMark(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVMinorType[s]),i.cmbVLabelPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-v-label-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 100%;",editable:!1,data:[{displayValue:i.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:i.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:i.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:i.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,e){i.currentAxisProps[s]&&i.currentAxisProps[s].putTickLabelsPos(e.value)}),i)),Common.UI.FocusManager.add(this,i.cmbVLabelPos[s]),i.btnVFormat[s]=new Common.UI.Button({el:$("#chart-dlg-btn-v-format-"+s)}).on("click",_.bind(i.openFormat,i,s)),Common.UI.FocusManager.add(this,i.btnVFormat[s]),i.chVLogScale[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-v-logscale-"+s),labelText:i.textLogScale}).on("change",_.bind((function(t,e){i.currentAxisProps[s]&&(i.currentAxisProps[s].putLogScale("checked"==e),"checked"==e&&i.currentAxisProps[s].putLogBase(i.spnBase[s].getNumberValue())),i.spnBase[s].setDisabled("checked"!==e)}),i)),Common.UI.FocusManager.add(this,i.chVLogScale[s]),i.spnBase[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-base-"+s),maxValue:1e3,minValue:2,step:1,defaultUnit:"",value:10}).on("change",_.bind((function(t,e,n){i.currentAxisProps[s]&&i.currentAxisProps[s].putLogBase(t.getNumberValue())}),i)),Common.UI.FocusManager.add(this,i.spnBase[s]),s},addControlsH:function(t){var e=this,s=e.chHorHide.length,n=$(_.template(i)({scope:e,idx:s}));return t.append(n),e.chHorHide[s]=new Common.UI.CheckBox({el:$("#chart-dlg-chk-hor-hide-"+s),labelText:e.textHideAxis}).on("change",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putShow("checked"!==i)}),e)),Common.UI.FocusManager.add(this,e.chHorHide[s]),e.cmbHorTitle[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-title-"+s),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:e._arrHorTitle,takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabel(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHorTitle[s]),e.cmbHorGrid[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-hor-grid-"+s),menuStyle:"min-width: 140px;",editable:!1,cls:"input-group-nr",data:[{value:Asc.c_oAscGridLinesSettings.none,displayValue:e.textNone},{value:Asc.c_oAscGridLinesSettings.major,displayValue:e.textMajor},{value:Asc.c_oAscGridLinesSettings.minor,displayValue:e.textMinor},{value:Asc.c_oAscGridLinesSettings.majorMinor,displayValue:e.textMajorMinor}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putGridlines(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHorGrid[s]),e.cmbHCrossType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-crosstype-"+s),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:e.textAuto,value:Asc.c_oAscCrossesRule.auto},{displayValue:e.textValue,value:Asc.c_oAscCrossesRule.value},{displayValue:e.textMinValue,value:Asc.c_oAscCrossesRule.minValue},{displayValue:e.textMaxValue,value:Asc.c_oAscCrossesRule.maxValue}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&(e.currentAxisProps[s].putCrossesRule(i.value),i.value==Asc.c_oAscCrossesRule.auto?e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].crossesAuto,!0):i.value==Asc.c_oAscCrossesRule.minValue?e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].minAuto,!0):i.value==Asc.c_oAscCrossesRule.maxValue&&e.spnHAxisCrosses[s].setValue(e._originalAxisHValues[s].maxAuto,!0))}),e)),Common.UI.FocusManager.add(this,e.cmbHCrossType[s]),e.spnHAxisCrosses[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-h-axis-crosses-"+s),maxValue:1e6,minValue:-1e6,step:.1,defaultUnit:"",defaultValue:0,value:""}).on("change",_.bind((function(t,i,n){e.cmbHCrossType[s].suspendEvents(),e.cmbHCrossType[s].setValue(Asc.c_oAscCrossesRule.value),e.cmbHCrossType[s].resumeEvents(),e.currentAxisProps[s]&&(e.currentAxisProps[s].putCrossesRule(Asc.c_oAscCrossesRule.value),e.currentAxisProps[s].putCrosses(t.getNumberValue()))}),e)),Common.UI.FocusManager.add(this,e.spnHAxisCrosses[s]),e.cmbAxisPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-axis-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:e.textOnTickMarks,value:Asc.c_oAscLabelsPosition.byDivisions},{displayValue:e.textBetweenTickMarks,value:Asc.c_oAscLabelsPosition.betweenDivisions}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabelsPosition(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbAxisPos[s]),e.chHReverse[s]=new Common.UI.CheckBox({el:$("#chart-dlg-check-h-reverse-"+s),labelText:e.textReverse}).on("change",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putInvertCatOrder("checked"==i)}),e)),Common.UI.FocusManager.add(this,e.chHReverse[s]),e.cmbHMajorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-major-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:e.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:e.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:e.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putMajorTickMark(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHMajorType[s]),e.cmbHMinorType[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-minor-type-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickMark.TICK_MARK_NONE},{displayValue:e.textCross,value:Asc.c_oAscTickMark.TICK_MARK_CROSS},{displayValue:e.textIn,value:Asc.c_oAscTickMark.TICK_MARK_IN},{displayValue:e.textOut,value:Asc.c_oAscTickMark.TICK_MARK_OUT}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putMinorTickMark(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHMinorType[s]),e.spnMarksInterval[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-marks-interval-"+s),width:140,maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.currentAxisProps[s]&&e.currentAxisProps[s].putIntervalBetweenTick(t.getNumberValue())}),e)),Common.UI.FocusManager.add(this,e.spnMarksInterval[s]),e.cmbHLabelPos[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-h-label-pos-"+s),cls:"input-group-nr",menuStyle:"min-width: 140px;",editable:!1,data:[{displayValue:e.textNone,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE},{displayValue:e.textLow,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW},{displayValue:e.textHigh,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH},{displayValue:e.textNextToAxis,value:Asc.c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&e.currentAxisProps[s].putTickLabelsPos(i.value)}),e)),Common.UI.FocusManager.add(this,e.cmbHLabelPos[s]),e.spnLabelDist[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-dist-"+s),width:140,maxValue:1e3,minValue:0,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.currentAxisProps[s]&&e.currentAxisProps[s].putLabelsAxisDistance(t.getNumberValue())}),e)),Common.UI.FocusManager.add(this,e.spnLabelDist[s]),e.spnLabelInterval[s]=new Common.UI.MetricSpinner({el:$("#chart-dlg-input-label-int-"+s),width:60,maxValue:1e6,minValue:1,step:1,defaultUnit:"",value:""}).on("change",_.bind((function(t,i,n){e.cmbLabelInterval[s].suspendEvents(),e.cmbLabelInterval[s].setValue(Asc.c_oAscBetweenLabelsRule.manual),e.cmbLabelInterval[s].resumeEvents(),e.currentAxisProps[s]&&(e.currentAxisProps[s].putIntervalBetweenLabelsRule(Asc.c_oAscBetweenLabelsRule.manual),e.currentAxisProps[s].putIntervalBetweenLabels(t.getNumberValue()))}),e)),Common.UI.FocusManager.add(this,e.spnLabelInterval[s]),e.cmbLabelInterval[s]=new Common.UI.ComboBox({el:$("#chart-dlg-combo-label-int-"+s),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:[{displayValue:e.textAuto,value:Asc.c_oAscBetweenLabelsRule.auto},{displayValue:e.textManual,value:Asc.c_oAscBetweenLabelsRule.manual}],takeFocusOnClose:!0}).on("selected",_.bind((function(t,i){e.currentAxisProps[s]&&(e.currentAxisProps[s].putIntervalBetweenLabelsRule(i.value),i.value==Asc.c_oAscBetweenLabelsRule.auto&&e.spnLabelInterval[s].setValue(1,!0))}),e)),Common.UI.FocusManager.add(this,e.cmbLabelInterval[s]),e.btnHFormat[s]=new Common.UI.Button({el:$("#chart-dlg-btn-h-format-"+s)}).on("click",_.bind(e.openFormat,e,s)),Common.UI.FocusManager.add(this,e.btnHFormat[s]),s},onSelectType:function(t,e,i,s){if(!this._noApply){var n={};if(_.isFunction(s.toJSON)){if(!s.get("selected"))return;n=s.toJSON()}else n=s;this.btnChartType.setIconCls("svgicon chart-"+n.iconCls),this.chartSettings.changeType(n.type),this.updateAxisProps(n.type,!0),this.vertAxisProps=this.chartSettings.getVertAxesProps(),this.horAxisProps=this.chartSettings.getHorAxesProps(),this.updateDataLabels(n.type,this.cmbDataLabels.getValue()),this.currentChartType=n.type}},updateAxisProps:function(t,e){var i=t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine;this.chMarkers.setVisible(i),this.cmbLines.setVisible(i),this.lblLines.toggleClass("hidden",!i),this.lblLines.closest("tr").toggleClass("hidden",!i),i&&(this.chMarkers.setValue(this.chartSettings.getShowMarker(),!0),this.cmbLines.setValue(this.chartSettings.getLine()?this.chartSettings.getSmooth()?2:1:0)),i=t==Asc.c_oAscChartTypeSettings.pie||t==Asc.c_oAscChartTypeSettings.doughnut||t==Asc.c_oAscChartTypeSettings.pie3d,this.btnsCategory[2].setDisabled(i),this.btnsCategory[3].setDisabled(i),this.btnsCategory[4].setDisabled(i),this.btnsCategory[5].setDisabled(i),this.btnsCategory[2].setVisible(this.vertAxisProps.length>0),this.btnsCategory[3].setVisible(this.vertAxisProps.length>1),this.btnsCategory[4].setVisible(this.horAxisProps.length>0),this.btnsCategory[5].setVisible(this.horAxisProps.length>1),i=t==Asc.c_oAscChartTypeSettings.barNormal3d||t==Asc.c_oAscChartTypeSettings.barStacked3d||t==Asc.c_oAscChartTypeSettings.barStackedPer3d||t==Asc.c_oAscChartTypeSettings.hBarNormal3d||t==Asc.c_oAscChartTypeSettings.hBarStacked3d||t==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||t==Asc.c_oAscChartTypeSettings.barNormal3dPerspective;for(var s=0;s<this.cmbAxisPos.length;s++)this.cmbAxisPos[s].setDisabled(i)},updateDataLabels:function(t,e){if(t!==this.currentChartType){var i=[{value:Asc.c_oAscChartDataLabelsPos.none,displayValue:this.textNone},{value:Asc.c_oAscChartDataLabelsPos.ctr,displayValue:this.textCenter}];t==Asc.c_oAscChartTypeSettings.barNormal||t==Asc.c_oAscChartTypeSettings.hBarNormal?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}):t==Asc.c_oAscChartTypeSettings.barStacked||t==Asc.c_oAscChartTypeSettings.barStackedPer||t==Asc.c_oAscChartTypeSettings.hBarStacked||t==Asc.c_oAscChartTypeSettings.hBarStackedPer?i.push({value:Asc.c_oAscChartDataLabelsPos.inBase,displayValue:this.textInnerBottom},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop}):t==Asc.c_oAscChartTypeSettings.lineNormal||t==Asc.c_oAscChartTypeSettings.lineStacked||t==Asc.c_oAscChartTypeSettings.lineStackedPer||t==Asc.c_oAscChartTypeSettings.lineNormalMarker||t==Asc.c_oAscChartTypeSettings.lineStackedMarker||t==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||t==Asc.c_oAscChartTypeSettings.stock||t==Asc.c_oAscChartTypeSettings.scatter||t==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||t==Asc.c_oAscChartTypeSettings.scatterSmooth||t==Asc.c_oAscChartTypeSettings.scatterLineMarker||t==Asc.c_oAscChartTypeSettings.scatterLine?i.push({value:Asc.c_oAscChartDataLabelsPos.l,displayValue:this.textLeft},{value:Asc.c_oAscChartDataLabelsPos.r,displayValue:this.textRight},{value:Asc.c_oAscChartDataLabelsPos.t,displayValue:this.textTop},{value:Asc.c_oAscChartDataLabelsPos.b,displayValue:this.textBottom}):t!=Asc.c_oAscChartTypeSettings.pie&&t!=Asc.c_oAscChartTypeSettings.pie3d||i.push({value:Asc.c_oAscChartDataLabelsPos.bestFit,displayValue:this.textFit},{value:Asc.c_oAscChartDataLabelsPos.inEnd,displayValue:this.textInnerTop},{value:Asc.c_oAscChartDataLabelsPos.outEnd,displayValue:this.textOuterTop}),this.cmbDataLabels.setData(i)}void 0!==e?this.cmbDataLabels.store.findWhere({value:e})||(e=Asc.c_oAscChartDataLabelsPos.ctr):e=Asc.c_oAscChartDataLabelsPos.none;this.cmbDataLabels.setValue(e),this.onSelectDataLabels(this.cmbDataLabels,{value:e})},onVCategoryClick:function(t){this.vertAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t]):this.fillHProps(this.vertAxisProps[t],this.vertAxisPropsIndexes[t],!0)},onHCategoryClick:function(t){this.horAxisProps[t].getAxisType()==Asc.c_oAscAxisType.val?this.fillVProps(this.horAxisProps[t],this.horAxisPropsIndexes[t],!0):this.fillHProps(this.horAxisProps[t],this.horAxisPropsIndexes[t])},fillVProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.val){null==this._originalAxisVValues&&(this._originalAxisVValues=[]),null==this._originalAxisVValues[e]&&(this._originalAxisVValues[e]={minAuto:null==t.getMinVal()?0:t.getMinVal(),maxAuto:null==t.getMaxVal()?10:t.getMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chVertHide[e].setValue(!t.getShow()),this.cmbVertGrid[e].setValue(t.getGridlines()),this.cmbVertTitle[e].setData(i?this._arrHorTitle:this._arrVertTitle),this.cmbVertTitle[e].setValue(t.getLabel()),this.cmbVertTitle[e].setDisabled(!!t.isRadarAxis()),this.cmbMinType[e].setValue(t.getMinValRule());var s=t.getMinValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].minAuto:t.getMinVal();switch(this.spnMinValue[e].setValue(null==s?"":s,!0),this.cmbMaxType[e].setValue(t.getMaxValRule()),s=t.getMaxValRule()==Asc.c_oAscValAxisRule.auto?this._originalAxisVValues[e].maxAuto:t.getMaxVal(),this.spnMaxValue[e].setValue(null==s?"":s,!0),s=t.getCrossesRule(),this.cmbVCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this.spnMinValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.maxValue:s=this.spnMaxValue[e].getNumberValue();break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisVValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnVAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbUnits[e].setValue(t.getDispUnitsRule()),this.chVReverse[e].setValue(t.getInvertValOrder(),!0),this.cmbVMajorType[e].setValue(t.getMajorTickMark()),this.cmbVMinorType[e].setValue(t.getMinorTickMark()),this.cmbVLabelPos[e].setValue(t.getTickLabelsPos()),s=t.getLogScale(),this.chVLogScale[e].setValue(!!s,!0),this.spnBase[e].setDisabled(!s),s&&this.spnBase[e].setValue(t.getLogBase(),!0),this.currentAxisProps[e]=t}},fillHProps:function(t,e,i){if(t.getAxisType()===Asc.c_oAscAxisType.cat){null==this._originalAxisHValues&&(this._originalAxisHValues=[]),null==this._originalAxisHValues[e]&&(this._originalAxisHValues[e]={minAuto:null==t.getCrossMinVal()?0:t.getCrossMinVal(),maxAuto:null==t.getCrossMaxVal()?10:t.getCrossMaxVal(),crossesAuto:null==t.getCrosses()?0:t.getCrosses()}),this.chHorHide[e].setValue(!t.getShow()),this.cmbHorGrid[e].setValue(t.getGridlines()),this.cmbHorTitle[e].setData(i?this._arrVertTitle:this._arrHorTitle),this.cmbHorTitle[e].setValue(t.getLabel());var s=t.getCrossesRule();switch(this.cmbHCrossType[e].setValue(s),s){case Asc.c_oAscCrossesRule.minValue:s=this._originalAxisHValues[e].minAuto;break;case Asc.c_oAscCrossesRule.maxValue:s=this._originalAxisHValues[e].maxAuto;break;case Asc.c_oAscCrossesRule.auto:s=this._originalAxisHValues[e].crossesAuto;break;default:s=t.getCrosses()}this.spnHAxisCrosses[e].setValue(null==s?"":s,!0),this.cmbAxisPos[e].setValue(t.getLabelsPosition()),this.chHReverse[e].setValue(t.getInvertCatOrder(),!0),this.cmbHMajorType[e].setValue(t.getMajorTickMark()),this.cmbHMinorType[e].setValue(t.getMinorTickMark()),this.spnMarksInterval[e].setValue(t.getIntervalBetweenTick(),!0),this.cmbHLabelPos[e].setValue(t.getTickLabelsPos()),this.spnLabelDist[e].setValue(t.getLabelsAxisDistance(),!0),s=t.getIntervalBetweenLabelsRule(),this.cmbLabelInterval[e].setValue(s),this.spnLabelInterval[e].setValue(s===Asc.c_oAscBetweenLabelsRule.manual?t.getIntervalBetweenLabels():1,!0),s=!!t.isRadarAxis(),this.chHorHide[e].setDisabled(s),this.cmbHorTitle[e].setDisabled(s),this.cmbHorGrid[e].setDisabled(s),this.cmbHCrossType[e].setDisabled(s),this.spnHAxisCrosses[e].setDisabled(s),this.chHReverse[e].setDisabled(s),this.cmbHMajorType[e].setDisabled(s),this.cmbHMinorType[e].setDisabled(s),this.spnMarksInterval[e].setDisabled(s),this.cmbHLabelPos[e].setDisabled(s),this.spnLabelDist[e].setDisabled(s),this.cmbLabelInterval[e].setDisabled(s),this.spnLabelInterval[e].setDisabled(s);var n=this.currentChartType;s=!!t.isRadarAxis()||n==Asc.c_oAscChartTypeSettings.barNormal3d||n==Asc.c_oAscChartTypeSettings.barStacked3d||n==Asc.c_oAscChartTypeSettings.barStackedPer3d||n==Asc.c_oAscChartTypeSettings.hBarNormal3d||n==Asc.c_oAscChartTypeSettings.hBarStacked3d||n==Asc.c_oAscChartTypeSettings.hBarStackedPer3d||n==Asc.c_oAscChartTypeSettings.barNormal3dPerspective,this.cmbAxisPos[e].setDisabled(s),this.currentAxisProps[e]=t}},updateSparkStyles:function(t){if(t&&t.length>1){var e=this.cmbSparkStyle.menuPicker.store;if(e.length==t.length-1)for(var i=e.models,s=0;s<t.length-1;s++)i[s].set("imageUrl",t[s]);else{var n=[],a=t[t.length-1];for(s=0;s<t.length-1;s++)n.push({imageUrl:t[s],data:s});e.reset(n,{silent:!1}),this.cmbSparkStyle.fillComboView(e.at(a<0?0:a),a>-1)}}},onSelectSparkType:function(t,e,i,s){if(!this._noApply){var n={};if(_.isFunction(s.toJSON)){if(!s.get("selected"))return;n=s.toJSON()}else n=s;this.btnSparkType.setIconCls("svgicon chart-"+n.iconCls),this._changedProps&&this._changedProps.asc_setType(n.type),this._state.SparkType=n.type;var a=!1,o=this.cmbEmptyCells.getValue();n.type!==Asc.c_oAscSparklineType.Line&&this._arrEmptyCells.length>2?(this._arrEmptyCells.pop(),a=!0):n.type==Asc.c_oAscSparklineType.Line&&this._arrEmptyCells.length<3&&(this._arrEmptyCells.push({value:Asc.c_oAscEDispBlanksAs.Span,displayValue:this.textEmptyLine}),a=!0),a&&(this.cmbEmptyCells.setData(this._arrEmptyCells),this.cmbEmptyCells.setValue(n.type!==Asc.c_oAscSparklineType.Line&&o==Asc.c_oAscEDispBlanksAs.Span?this.textEmptyLine:o)),this.updateSparkStyles(this.chartSettings.asc_getStyles(n.type))}},onSelectSparkStyle:function(t,e){this._noApply||this._changedProps&&this._changedProps.asc_setStyle(e.get("data"))},_setDefaults:function(t){if(Common.UI.FocusManager.add(this,this.btnsCategory),t)if(this.chartSettings=t,this.isChart){if(this._state.ChartType=t.getType(),this._noApply=!0,this.isDiagramMode){var e=this.mnuChartTypePicker.store.findWhere({type:this._state.ChartType});this.mnuChartTypePicker.selectRecord(e,!0),e?this.btnChartType.setIconCls("svgicon chart-"+e.get("iconCls")):this.btnChartType.setIconCls("svgicon")}this._noApply=!1,this.cmbChartTitle.setValue(t.getTitle()),this.cmbLegendPos.setValue(t.getLegendPos()),this.updateDataLabels(this._state.ChartType,t.getDataLabelsPos()),this.cmbDataLabels.setDisabled(this._state.ChartType==Asc.c_oAscChartTypeSettings.surfaceNormal||this._state.ChartType==Asc.c_oAscChartTypeSettings.surfaceWireframe),this.chSeriesName.setValue(this.chartSettings.getShowSerName(),!0),this.chCategoryName.setValue(this.chartSettings.getShowCatName(),!0),this.chValue.setValue(this.chartSettings.getShowVal(),!0);var i=t.getSeparator();if(this.txtSeparator.setValue(i||""),i=this.chartSettings.getDisplayTrendlinesEquation(),this.chShowEquation.setValue(void 0!==i?!!i:"indeterminate",!0),this.chShowEquation.setDisabled(null===i,!0),Common.UI.FocusManager.add(this,[this.cmbChartTitle,this.cmbLegendPos,this.cmbDataLabels,this.chSeriesName,this.chCategoryName,this.chValue,this.txtSeparator,this.cmbLines,this.chMarkers,this.chShowEquation]),this.vertAxisProps=t.getVertAxesProps(),this.vertAxisProps.length>0){var s=this.$window.find("#id-chart-settings-dlg-vert");this.vertAxisPropsIndexes[0]=this.vertAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(s):this.addControlsH(s)}if(this.vertAxisProps.length>1){s=this.$window.find("#id-chart-settings-dlg-vert-sec");this.vertAxisPropsIndexes[1]=this.vertAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(s):this.addControlsH(s)}if(this.horAxisProps=t.getHorAxesProps(),this.horAxisProps.length>0){s=this.$window.find("#id-chart-settings-dlg-hor");this.horAxisPropsIndexes[0]=this.horAxisProps[0].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(s):this.addControlsH(s)}if(this.horAxisProps.length>1){s=this.$window.find("#id-chart-settings-dlg-hor-sec");this.horAxisPropsIndexes[1]=this.horAxisProps[1].getAxisType()===Asc.c_oAscAxisType.val?this.addControlsV(s):this.addControlsH(s)}if(Common.UI.FocusManager.add(this,[this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]),this.updateAxisProps(this._state.ChartType),this.currentChartType=this._state.ChartType,this.imageSettings)switch(i=this.imageSettings.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=this.imageSettings.asc_getDescription(),this.textareaAltDescription.val(i||""),i=this.imageSettings.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}}else{Common.UI.FocusManager.add(this,[this.btnSparkType,this.cmbEmptyCells,this.chShowEmpty,this.chShowAxis,this.chReverse,this.cmbSparkMinType,this.spnSparkMinValue,this.cmbSparkMaxType,this.spnSparkMaxValue]),this._state.SparkType=t.asc_getType();e=this.mnuSparkTypePicker.store.findWhere({type:this._state.SparkType});this.mnuSparkTypePicker.selectRecord(e,!0),e?this.btnSparkType.setIconCls("svgicon chart-"+e.get("iconCls")):this.btnSparkType.setIconCls("svgicon"),this.updateSparkStyles(this.sparklineStyles?this.sparklineStyles:t.asc_getStyles()),this._state.SparkType!==Asc.c_oAscSparklineType.Line&&this._arrEmptyCells.pop(),this.cmbEmptyCells.setData(this._arrEmptyCells);i=t.asc_getDisplayEmpty();this.cmbEmptyCells.setValue(this._state.SparkType!==Asc.c_oAscSparklineType.Line&&i==Asc.c_oAscEDispBlanksAs.Span?this.textEmptyLine:i),this.chShowEmpty.setValue(t.asc_getDisplayHidden(),!0),this.chShowAxis.setValue(t.asc_getDisplayXAxis(),!0),this.chReverse.setValue(t.asc_getRightToLeft(),!0),this.cmbSparkMinType.setValue(t.asc_getMinAxisType(),!0),this.cmbSparkMaxType.setValue(t.asc_getMaxAxisType(),!0),this.spnSparkMinValue.setDisabled(t.asc_getMinAxisType()!==Asc.c_oAscSparklineAxisMinMax.Custom),this.spnSparkMaxValue.setDisabled(t.asc_getMaxAxisType()!==Asc.c_oAscSparklineAxisMinMax.Custom),this.spnSparkMinValue.setValue(null!==t.asc_getManualMin()?t.asc_getManualMin():"",!0),this.spnSparkMaxValue.setValue(null!==t.asc_getManualMax()?t.asc_getManualMax():"",!0),this._changedProps=new Asc.sparklineGroup,this._noApply=!1}Common.UI.FocusManager.add(this,this.getFooterButtons())},getSettings:function(){var t;if(this.isChart){var e=this.currentChartType;if(this.isDiagramMode){var i=this.mnuChartTypePicker.getSelectedRec();i&&(e=i.get("type"))}return this.chartSettings.putType(e),this.chartSettings.putTitle(this.cmbChartTitle.getValue()),this.chartSettings.putLegendPos(this.cmbLegendPos.getValue()),this.chartSettings.putDataLabelsPos(this.cmbDataLabels.getValue()),this.chartSettings.putShowSerName("checked"==this.chSeriesName.getValue()),this.chartSettings.putShowCatName("checked"==this.chCategoryName.getValue()),this.chartSettings.putShowVal("checked"==this.chValue.getValue()),this.chartSettings.putSeparator(_.isEmpty(this.txtSeparator.getValue())?" ":this.txtSeparator.getValue()),this.chMarkers.isVisible()&&this.chartSettings.putShowMarker("checked"==this.chMarkers.getValue()),(t=e==Asc.c_oAscChartTypeSettings.lineNormal||e==Asc.c_oAscChartTypeSettings.lineStacked||e==Asc.c_oAscChartTypeSettings.lineStackedPer||e==Asc.c_oAscChartTypeSettings.lineNormalMarker||e==Asc.c_oAscChartTypeSettings.lineStackedMarker||e==Asc.c_oAscChartTypeSettings.lineStackedPerMarker||e==Asc.c_oAscChartTypeSettings.scatter||e==Asc.c_oAscChartTypeSettings.scatterSmoothMarker||e==Asc.c_oAscChartTypeSettings.scatterSmooth||e==Asc.c_oAscChartTypeSettings.scatterLineMarker||e==Asc.c_oAscChartTypeSettings.scatterLine)&&(t=this.cmbLines.getValue(),this.chartSettings.putLine(0!==t),t>0&&this.chartSettings.putSmooth(2==t)),!this.isAltTitleChanged&&!this.isAltDescChanged||this._changedImageProps||(this._changedImageProps=new Asc.asc_CImgProperty),this.isAltTitleChanged&&this._changedImageProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedImageProps.asc_putDescription(this.textareaAltDescription.val()),{chartSettings:this.chartSettings,imageSettings:this._changedImageProps}}return{chartSettings:this._changedProps}},onRadioSnapChange:function(t,e,i){e&&(this._changedImageProps||(this._changedImageProps=new Asc.asc_CImgProperty),this._changedImageProps.asc_putAnchor(t.options.value))},isRangeValid:function(){if(this.isChart){var t,e=this.chartSettings.getRange();if(_.isEmpty(e))return!0;var i=this.currentChartType;if(this.isDiagramMode){var s=this.mnuChartTypePicker.getSelectedRec();s&&(i=s.get("type"))}return(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,e,!0,this.chartSettings.getInRows(),i))==Asc.c_oAscError.ID.No||(this.setActiveCategory(0),t==Asc.c_oAscError.ID.StockChartError?Common.UI.warning({msg:this.errorStockChart}):t==Asc.c_oAscError.ID.MaxDataSeriesError?Common.UI.warning({msg:this.errorMaxRows}):t==Asc.c_oAscError.ID.MaxDataPointsError&&Common.UI.warning({msg:this.errorMaxPoints}),!1)}return!0},onSelectDataLabels:function(t,e,i){var s=e.value==Asc.c_oAscChartDataLabelsPos.none;this.chSeriesName.setDisabled(s),this.chCategoryName.setDisabled(s),this.chValue.setDisabled(s),this.txtSeparator.setDisabled(s),s||"checked"===this.chSeriesName.getValue()||"checked"===this.chCategoryName.getValue()||"checked"===this.chValue.getValue()||this.chValue.setValue("checked",!0)},onSelectSparkData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.sparkDataRangeValid=e.getSettings(),t.txtSparkDataRange.setValue(t.sparkDataRangeValid),t.txtSparkDataRange.checkValidate())}}).on("close",(function(){t.show()})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtSparkDataRange.getValue())||1!=t.txtSparkDataRange.checkValidate()?t.sparkDataRangeValid:t.txtSparkDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},onSelectLocationData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.dataLocationRangeValid=e.getSettings(),t.txtSparkDataLocation.setValue(t.dataLocationRangeValid),t.txtSparkDataLocation.checkValidate())}}).on("close",(function(){t.show()})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtSparkDataLocation.getValue())||1!=t.txtSparkDataLocation.checkValidate()?t.dataLocationRangeValid:t.txtSparkDataLocation.getValue(),type:Asc.c_oAscSelectionDialogType.FormatTable})}},openFormat:function(t,e){var i=this,s=i.currentAxisProps[t].getNumFmt(),n=i.api.asc_getLocale(),a=Common.Utils.InternalSettings.get("sse-config-lang");!n&&(n=a?parseInt(Common.util.LanguageInfo.getLocalLanguageCode(a)):1033);var o=new SSE.Views.FormatSettingsDialog({api:i.api,handler:function(t,e){"ok"==t&&e&&(s.putSourceLinked(e.linked),s.putFormatCode(e.format),i.chartSettings.endEditData(),i._isEditFormat=!1)},linked:!0,props:{format:s.getFormatCode(),formatInfo:s.getFormatCellsInfo(),langId:n,chartFormat:s}}).on("close",(function(){i._isEditFormat&&i.chartSettings.cancelEditData(),i._isEditFormat=!1,e.focus()}));i._isEditFormat=!0,i.chartSettings.startEditData(),o.show()},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},close:function(){this.api.asc_onCloseChartFrame(),Common.Views.AdvancedSettingsWindow.prototype.close.apply(this,arguments)},textTitle:"Chart - Advanced Settings",textShowValues:"Display chart values",textShowBorders:"Display chart borders",textDataRows:"in rows",textDataColumns:"in columns",textDisplayLegend:"Display Legend",textLegendBottom:"Bottom",textLegendTop:"Top",textLegendRight:"Right",textLegendLeft:"Left",textChartTitle:"Chart Title",textXAxisTitle:"X Axis Title",textYAxisTitle:"Y Axis Title",txtEmpty:"This field is required",textInvalidRange:"ERROR! Invalid cells range",textChartElementsLegend:"Chart Elements &<br>Chart Legend",textLayout:"Layout",textLegendPos:"Legend",textDataLabels:"Data Labels",textSeparator:"Data Labels Separator",textSeriesName:"Series Name",textCategoryName:"Category Name",textValue:"Value",textAxisOptions:"Axis Options",textMinValue:"Minimum Value",textMaxValue:"Maximum Value",textAxisCrosses:"Axis Crosses",textUnits:"Display Units",textTickOptions:"Tick Options",textMajorType:"Major Type",textMinorType:"Minor Type",textLabelOptions:"Label Options",textLabelPos:"Label Position",textReverse:"Values in reverse order",textVertAxis:"Vertical Axis",textHorAxis:"Horizontal Axis",textMarksInterval:"Interval between Marks",textLabelDist:"Axis Label Distance",textLabelInterval:"Interval between Labels",textAxisPos:"Axis Position",textLeftOverlay:"Left Overlay",textRightOverlay:"Right Overlay",textOverlay:"Overlay",textNoOverlay:"No Overlay",textRotated:"Rotated",textHorizontal:"Horizontal",textInnerBottom:"Inner Bottom",textInnerTop:"Inner Top",textOuterTop:"Outer Top",textNone:"None",textCenter:"Center",textFixed:"Fixed",textAuto:"Auto",textCross:"Cross",textIn:"In",textOut:"Out",textLow:"Low",textHigh:"High",textNextToAxis:"Next to axis",textHundreds:"Hundreds",textThousands:"Thousands",textTenThousands:"10 000",textHundredThousands:"100 000",textMillions:"Millions",textTenMillions:"10 000 000",textHundredMil:"100 000 000",textBillions:"Billions",textTrillions:"Trillions",textCustom:"Custom",textManual:"Manual",textBetweenTickMarks:"Between Tick Marks",textOnTickMarks:"On Tick Marks",textLines:"Lines",textMarkers:"Markers",textMajor:"Major",textMinor:"Minor",textMajorMinor:"Major and Minor",textStraight:"Straight",textSmooth:"Smooth",textType:"Type",textTypeData:"Type & Data",textStyle:"Style",textSelectData:"Select data",errorMaxRows:"ERROR! The maximum number of data series per chart is 255.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price.",textAxisSettings:"Axis Settings",textGridLines:"Gridlines",textShow:"Show",textHide:"Hide",textLeft:"Left",textRight:"Right",textTop:"Top",textBottom:"Bottom",textFit:"Fit Width",textSparkRanges:"Sparkline Ranges",textLocationRange:"Location Range",textEmptyCells:"Hidden and Empty cells",textShowEmptyCells:"Show empty cells as",textShowData:"Show data in hidden rows and columns",textGroup:"Group Sparkline",textSingle:"Single Sparkline",textGaps:"Gaps",textZero:"Zero",textEmptyLine:"Connect data points with line",textShowSparkAxis:"Show Axis",textReverseOrder:"Reverse order",textAutoEach:"Auto for Each",textSameAll:"Same for All",textTitleSparkline:"Sparkline - Advanced Settings",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",errorMaxPoints:"ERROR! The maximum number of points in series per chart is 4096.",textSnap:"Cell Snapping",textAbsolute:"Don't move or size with cells",textOneCell:"Move but don't size with cells",textTwoCell:"Move and size with cells",textVertAxisSec:"Secondary Vertical Axis",textHorAxisSec:"Secondary Horizontal Axis",textAxisTitle:"Title",textHideAxis:"Hide axis",textFormat:"Label format",textBase:"Base",textLogScale:"Logarithmic Scale",textTrendlineOptions:"Trendline options",textShowEquation:"Display equation on chart"},SSE.Views.ChartSettingsDlg||{}))})),void 0===Common)Common={};if(define("spreadsheeteditor/main/app/view/CellRangeDialog",[],(function(){"use strict";SSE.Views.CellRangeDialog=Common.UI.Window.extend(_.extend({options:{width:350,cls:"modal-dlg",modal:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtTitle},t),this.template=['<div class="box">','<div id="id-dlg-cell-range" class="input-row" style="margin-bottom: 5px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.inputRange=new Common.UI.InputField({el:$("#id-dlg-cell-range"),name:"range",style:"width: 100%;",allowBlank:this.options.allowBlank||!1,blankError:this.txtEmpty,validateOnChange:!0}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("close",_.bind(this.onClose,this))},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){var e=this;this.settings=t,this.inputRange.setValue(t.range?t.range:""),void 0===t.type&&(t.type=Asc.c_oAscSelectionDialogType.Chart),t.api&&(e.api=t.api,e.wrapEvents={onApiRangeChanged:_.bind(e.onApiRangeChanged,e)},e.api.asc_setSelectionDialogMode(t.type,t.range?t.range:""),e.api.asc_registerCallback("asc_onSelectionRangeChanged",e.wrapEvents.onApiRangeChanged),Common.NotificationCenter.trigger("cells:range",t.type)),e.inputRange.validation=function(i){return t.validation?t.validation.call(e,i):(t.type===Asc.c_oAscSelectionDialogType.Function&&(t.argvalues[t.argindex]=i,e.api.asc_insertArgumentsInFormula(t.argvalues)),(t.type===Asc.c_oAscSelectionDialogType.Function||e.api.asc_checkDataRange(t.type,i,!1))!=Asc.c_oAscError.ID.DataRangeError||e.txtInvalidRange)},t.type==Asc.c_oAscSelectionDialogType.Function&&(_.delay((function(){e.inputRange._input.focus(),t.selection&&(e.inputRange._input[0].selectionStart=t.selection.start,e.inputRange._input[0].selectionEnd=t.selection.end)}),10),e.inputRange._input.on("focus",(function(){e._addedTextLength=0,e.api.asc_cleanSelectRange()})))},getSettings:function(){return this.inputRange.getValue()},onApiRangeChanged:function(t){if(this.settings.type==Asc.c_oAscSelectionDialogType.Function){var e=this._addedTextLength||0,i=this.inputRange.getValue(),s=this.inputRange._input[0],n=s.selectionStart-e,a=s.selectionEnd,o=n>0&&0==e&&!this.api.asc_canEnterWizardRange(i.charAt(n-1))?"+":"";this._addedTextLength=t.length,i=i.substring(0,n)+o+t+i.substring(a,i.length),this.inputRange.setValue(i),s.selectionStart=s.selectionEnd=n+o.length+this._addedTextLength,this.settings.argvalues[this.settings.argindex]=i,this.api.asc_insertArgumentsInFormula(this.settings.argvalues)}else this.settings.type==Asc.c_oAscSelectionDialogType.DataValidation||this.settings.type==Asc.c_oAscSelectionDialogType.ConditionalFormattingRule?this.inputRange.setValue("="+t):this.inputRange.setValue(t);this.inputRange.cmpEl.hasClass("error")&&this.inputRange.cmpEl.removeClass("error")},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onClose:function(t){this.api&&(this.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),this.api.asc_unregisterCallback("asc_onSelectionRangeChanged",this.wrapEvents.onApiRangeChanged)),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.None),SSE.getController("RightMenu").SetDisabled(!1)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.inputRange.checkValidate())return;if(this.options.handler.call(this,this,t))return}this.close()},show:function(){arguments.length>1&&"object"===_typeof(arguments[0])&&"object"===_typeof(arguments[1])?Common.UI.Window.prototype.show.apply(this,[arguments[1].left+(arguments[0].outerWidth()-this.options.width)/2,arguments[1].top+(arguments[0].outerHeight()-150)/2]):Common.UI.Window.prototype.show.apply(this,arguments),SSE.getController("RightMenu").SetDisabled(!0)},txtTitle:"Select Data Range",txtEmpty:"This field is required",txtInvalidRange:"ERROR! Invalid cells range",errorMaxRows:"ERROR! The maximum number of data series per chart is 255.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price."},SSE.Views.CellRangeDialog||{}))})),void 0===Common)Common={};if(define("spreadsheeteditor/main/app/view/ChartDataRangeDialog",[],(function(){"use strict";SSE.Views.ChartDataRangeDialog=Common.UI.Window.extend(_.extend({options:{type:0,width:350,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){this.type=t.type||0,this.isScatter=t.isScatter,_.extend(this.options,{title:1==this.type?this.txtTitleSeries:this.txtTitleCategory},t),this.template=['<div class="box">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2">',"<label>"+(1==this.type?this.txtSeriesName:this.txtAxisLabel)+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range1"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl1" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;">'+this.txtChoose+"</label>","</td>","</tr>","<% if (type==1) { %>","<tr>",'<td colspan="2">',"<label>"+(this.isScatter?this.txtXValues:this.txtValues)+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range2"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl2" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;"></label>',"</td>","</tr>","<% if (isScatter) { %>","<tr>",'<td colspan="2">',"<label>"+this.txtYValues+"</label>","</td>","</tr>","<tr>",'<td style="padding-bottom: 8px;width: 100%;">','<div id="id-dlg-chart-range-range3"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label id="id-dlg-chart-range-lbl3" class="margin-left-5" style="width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 4px;"></label>',"</td>","</tr>","<% } %>","<% } %>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=this;e.inputRange1=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range1"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",(function(t,i,s,n){i!=s&&e.updateRangeData(1,i)})).on("changing",(function(t,e,i,s){})).on("button:click",_.bind(this.onSelectData,this,1)),this.lblRange1=t.find("#id-dlg-chart-range-lbl1"),e.inputRange2=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range2"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",(function(t,i,s,n){i!=s&&e.updateRangeData(2,i)})).on("changing",(function(t,e,i,s){})).on("button:click",_.bind(this.onSelectData,this,2)),this.lblRange2=t.find("#id-dlg-chart-range-lbl2"),e.inputRange3=new Common.UI.InputFieldBtn({el:$("#id-dlg-chart-range-range3"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",(function(t,i,s,n){i!=s&&e.updateRangeData(3,i)})).on("changing",(function(t,e,i,s){})).on("button:click",_.bind(this.onSelectData,this,3)),this.lblRange3=t.find("#id-dlg-chart-range-lbl3"),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this))},getFocusedComponents:function(){return[this.inputRange1,this.inputRange2,this.inputRange3].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.inputRange1},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){if(this.api=t.api,this.props=t.props,this.chartSettings=t.chartSettings,1==this.type){if(this.props.series){var e=this.props.series;if(this.inputRange1.setValue(e.asc_getName()),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(e.asc_getNameVal()||""):this.txtChoose),this.props.isScatter){var i=e.asc_getXValuesArr();this.inputRange2.setValue(e.asc_getXValues()),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(i?i.join("; "):""):this.txtChoose),this.inputRange3.setValue(e.asc_getYValues()),i=e.asc_getYValuesArr(),this.lblRange3.text(""!==this.inputRange3.getValue()?"= "+(i?i.join("; "):""):this.txtChoose)}else{i=e.asc_getValuesArr();this.inputRange2.setValue(e.asc_getValues()),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(i?i.join("; "):""):this.txtChoose)}}}else{i=this.props.values;this.inputRange1.setValue(this.props.category||""),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(i?i.join("; "):""):this.txtChoose)}},getSettings:function(){return{name:this.inputRange1.getValue(),valuesX:this.inputRange2.getValue(),valuesY:this.inputRange3.getValue()}},onSelectData:function(t,e){var i=this;if(i.api){var s=new SSE.Views.CellRangeDialog({allowBlank:!0,handler:function(s,n){"ok"==n&&(e.setValue(s.getSettings()),_.delay((function(){i.updateRangeData(t,s.getSettings())}),10))}}).on("close",(function(){i.show(),_.delay((function(){i._noApply=!0,e.focus(),i._noApply=!1}),1)})),n=Common.Utils.getOffset(i.$window);i.hide(),s.show(i.$window,n),s.setSettings({api:i.api,range:_.isEmpty(e.getValue())?"":e.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}})}},isRangeValid:function(t,e){var i;switch(t){case 1:i=this.props.series?this.props.series.asc_IsValidName(e):this.chartSettings.isValidCatFormula(e);break;case 2:i=this.props.isScatter?this.props.series.asc_IsValidXValues(e):this.props.series.asc_IsValidValues(e);break;case 3:i=this.props.series.asc_IsValidYValues(e)}if(!0===i||i==Asc.c_oAscError.ID.No)return!0;var s=this.textInvalidRange;switch(i){case Asc.c_oAscError.ID.StockChartError:s=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:s=this.errorMaxRows;break;case Asc.c_oAscError.ID.MaxDataPointsError:s=this.errorMaxPoints;break;case Asc.c_oAscError.ID.ErrorInFormula:s=this.errorInFormula;break;case Asc.c_oAscError.ID.InvalidReference:s=this.errorInvalidReference;break;case Asc.c_oAscError.ID.NoSingleRowCol:s=this.errorNoSingleRowCol;break;case Asc.c_oAscError.ID.NoValues:s=this.errorNoValues}return Common.UI.warning({msg:s,maxwidth:600}),!1},updateRangeData:function(t,e){if(this.isRangeValid(t,e))if(this.props.series){var i=this.props.series;switch(t){case 1:i.asc_setName(e),this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(i.asc_getNameVal()||""):this.txtChoose);break;case 2:if(this.isScatter){var s=i.asc_getXValuesArr();i.asc_setXValues(e),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}else{s=i.asc_getValuesArr();i.asc_setValues(e),this.lblRange2.text(""!==this.inputRange2.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}break;case 3:s=i.asc_getYValuesArr();i.asc_setYValues(e),this.lblRange3.text(""!==this.inputRange3.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}}else{this.chartSettings.setCatFormula(e);s=this.chartSettings.getCatValues();this.lblRange1.text(""!==this.inputRange1.getValue()?"= "+(s?s.join("; "):""):this.txtChoose)}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.options.handler){if("ok"==t){if(!this.isRangeValid(1,this.inputRange1.getValue()))return;if(1==this.type&&!this.isRangeValid(2,this.inputRange2.getValue()))return;if(1==this.type&&this.isScatter&&!this.isRangeValid(3,this.inputRange3.getValue()))return}if(this.options.handler.call(this,this,t))return}this.close()},txtTitleSeries:"Edit Series",txtTitleCategory:"Axis Labels",txtSeriesName:"Series name",txtValues:"Values",txtXValues:"X Values",txtYValues:"Y Values",txtAxisLabel:"Axis label range",txtChoose:"Choose range",textSelectData:"Select data",textInvalidRange:"Invalid cells range",errorMaxRows:"The maximum number of data series per chart is 255.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price.",errorMaxPoints:"The maximum number of points in series per chart is 4096.",errorInFormula:"There's an error in formula you entered.",errorInvalidReference:"The reference is not valid. Reference must be to an open worksheet.",errorNoSingleRowCol:"The reference is not valid. References for titles, values, sizes, or data labels must be a single cell, row, or column.",errorNoValues:"To create a chart, the series must contain at least one value."},SSE.Views.ChartDataRangeDialog||{}))})),define("spreadsheeteditor/main/app/view/ChartWizardDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";var t=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:sort",(function(){e.render(),e.trigger("change",e,e.model)})),e.listenTo(e.model,"change:selected",(function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))})),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.ChartWizardDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:455,contentHeight:400,toggleGroup:"chart-recommend-group",storageName:"sse-chart-recommend-category"},initialize:function(t){var e=this,i=[],s=[],n=Common.define.chartData.getChartData();if(this._currentTabIndex=void 0,this._arrSeriesGroups=[],this._arrSeriesType=[],t.props.recommended)for(var a in t.props.recommended)if(!isNaN(parseInt(a)))for(var o=0;o<n.length;o++)if(parseInt(a)===n[o].type){i.push(n[o]);break}i.length>0&&s.push({panelId:"id-chart-recommended-rec",panelCaption:e.textRecommended,groupId:"rec",charts:i,categoryIcon:"toolbar__icon btn-chartcategory-recommended",categoryCls:"png-icons"}),Common.define.chartData.getChartGroupData().forEach((function(i){var a=[];n.forEach((function(n){i.id===n.group&&(a.push(n),t.type===n.type&&(e._currentTabIndex=s.length))})),s.push({panelId:"id-chart-recommended-"+i.id,panelCaption:i.caption,groupId:i.id,charts:a,categoryIcon:"toolbar__icon btn-chartcategory-"+a[0].iconCls,categoryCls:"png-icons"}),"menu-chart-group-combo"!==i.id&&"menu-chart-group-stock"!==i.id&&e._arrSeriesGroups.push(i)})),n.forEach((function(t){!t.is3d&&t.type!==Asc.c_oAscChartTypeSettings.stock&&t.type!==Asc.c_oAscChartTypeSettings.comboBarLine&&t.type!==Asc.c_oAscChartTypeSettings.comboBarLineSecondary&&t.type!==Asc.c_oAscChartTypeSettings.comboAreaBar&&t.type!==Asc.c_oAscChartTypeSettings.comboCustom&&e._arrSeriesType.push(t)})),this.chartTabTemplate=['<div class="inner-content">','<div class="buttons-container">',"<% _.each(group.charts, function(chart) { %>",'<div id="id-<%= group.groupId %>-btn-<%= chart.type %>" class="margin-right-5" style="display: inline-block;margin-bottom:8px;"></div>',"<% }); %>","</div>","</div>",'<div class="inner-content" style="'+(Common.UI.isRTL()?"padding-left: 0;":"padding-right: 0;")+'">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small"></td>',"</tr>","<tr>","<td>",'<label class="header" id="id-<%= group.groupId %>-lbl"></label>',"</td>","</tr>",'<tr class="chart-error">','<td class="padding-very-small"></td>',"</tr>",'<tr class="chart-error">',"<td>",'<label id="id-<%= group.groupId %>-lbl-error"></label>',"</td>","</tr>",'<tr class="preview-list">','<td style="padding-bottom:12px;">','<div id="id-<%= group.groupId %>-list-preview" style="width:100%; height: <% if (group.groupId === "menu-chart-group-combo") {%>163<% } else { %>258<% } %>px;"></div>',"</td>","</tr>",'<tr class="preview-one hidden">','<td style="padding: '+(Common.UI.isRTL()?"3px 3px 12px 12px":"3px 12px 12px 3px")+';">','<div id="id-<%= group.groupId %>-preview" class="preview-canvas-container" style="<% if (group.groupId === "menu-chart-group-combo") {%>width:280px; height: 160px;<% } else { %>width:100%; height:258px;<% } %>"></div>',"</td>","</tr>",'<% if (group.groupId === "menu-chart-group-combo") {%>','<tr class="preview-combo">',"<td>","<label>"+this.txtSeriesDesc+"</label>","</td>","</tr>",'<tr class="preview-combo">','<td style="padding: '+(Common.UI.isRTL()?"3px 3px 3px 12px":"3px 12px 3px 3px")+';">','<div id="id-<%= group.groupId %>-combo-preview" class="" style="width:100%; height: 113px;"></div>',"</td>","</tr>","<% } %>","</table>","</div>"].join("");var l=["<% _.each(groups, function(group) { %>",'<div id="<%= group.panelId %>" class="settings-panel"></div>',"<% }); %>"].join("");_.extend(this.options,{title:t.isEdit?this.textTitleChange:this.textTitle,items:s,contentTemplate:_.template(l)({groups:s,scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.api=this.options.api,this.allCharts=[],this._currentChartType=null,this._currentChartSpace=null,this._currentPreviews=[],this._currentPreviewSize=[430,258],this._currentTabSettings=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.chartButtons=[],this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")}),this.afterRender()},onCategoryClick:function(t,e){if(!$("#"+t.options.contentTarget).hasClass("active")){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this,s=this.options.items[e];!s.rendered&&this.renderChartTab(s),this.fillPreviews(s);var n=s.chartButtons;n.length>0&&(n[i._openedButtonIndex].toggle(!0),setTimeout((function(){n[i._openedButtonIndex].focus()}),10))}},renderChartTab:function(t){var e=this,i=this.getChild();i.find("#"+t.panelId).append($(_.template(this.chartTabTemplate)({group:t,scope:e}))),e._openedButtonIndex=0,t.chartButtons=[],t.charts.forEach((function(s,n){var a=new Common.UI.Button({parentEl:i.find("#id-"+t.groupId+"-btn-"+s.type),cls:"btn-options huge-1 svg-chartlist",iconCls:"svgicon chart-"+s.iconCls,chart:s,hint:s.tip,enableToggle:!0,allowDepress:!1,toggleGroup:"toggle-"+t.groupId});a.on("toggle",(function(n,a){a&&(i.find("#id-"+t.groupId+"-lbl").text(s.tip),e._currentChartType=s.type,e.updatePreview())})),t.chartButtons.push(a),e.chartButtons.push(a),s.type===e.options.type&&"rec"!==t.groupId&&(e._openedButtonIndex=n),Common.UI.FocusManager.insert(e,a,-1*e.getFooterButtons().length)})),t.divErrorEl=i.find("#"+t.panelId+" .chart-error"),t.lblError=i.find("#id-"+t.groupId+"-lbl-error"),t.divPreviewEl=i.find("#"+t.panelId+" .preview-one"),t.divPreviewId="id-"+t.groupId+"-preview",t.listViewEl=i.find("#"+t.panelId+" .preview-list"),t.listPreview=new Common.UI.DataView({el:i.find("#id-"+t.groupId+"-list-preview"),cls:"focus-inner",scrollAlwaysVisible:!0,store:new Common.UI.DataViewStore,itemTemplate:_.template(['<div class="style" id="<%= id %>" style="width:210px; height:120px;"></div>'].join("")),tabindex:1}),t.listPreview.on({"item:select":function(t,i,s){s&&(e._currentChartSpace=s.get("data"),"menu-chart-group-combo"===e._currentTabSettings.groupId&&e.updateSeriesList(e._currentChartSpace.asc_getSeries()))},"item:add":function(t,e,i){i&&i.get("data").updateView(i.get("id"))},entervalue:_.bind(this.onPrimary,this)}),Common.UI.FocusManager.insert(this,t.listPreview,-1*this.getFooterButtons().length),"menu-chart-group-combo"===t.groupId&&this.renderSeries(t),t.rendered=!0},renderSeries:function(e){this.seriesList=new Common.UI.ListView({el:this.$window.find("#id-"+e.groupId+"-combo-preview"),store:new Common.UI.DataViewStore,emptyText:"",scrollAlwaysVisible:!0,headers:[{name:this.textSeries,width:138},{name:this.textType,width:145},{name:this.textSecondary,width:130,style:"text-align: center;"}],template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;" id="chart-recommend-item-<%= seriesIndex %>">','<div class="series-color" id="chart-recommend-series-preview-<%= seriesIndex %>"></div>','<div class="series-value" style="width: 125px;"><%= Common.Utils.String.htmlEncode(value) %></div>','<div class="series-cmb" style="width: 150px;"><div id="chart-recommend-cmb-series-<%= seriesIndex %>" class="input-group-nr" style=""></div></div>','<div class="series-chk"><div id="chart-recommend-chk-series-<%= seriesIndex %>" style=""></div></div>',"</div>"].join("")),tabindex:1}),this.seriesList.createNewItem=function(e){return new t({template:this.itemTemplate,model:e})},this.seriesList.on("item:add",_.bind(this.addControls,this)),this.seriesList.on("item:change",_.bind(this.addControls,this)),this.seriesList.on("item:select",_.bind(this.onSelectSeries,this)),this.seriesList.on("item:deselect",_.bind(this.onDeselectSeries,this)),this.seriesList.on("entervalue",_.bind(this.onPrimary,this)),this.listViewComboEl=this.$window.find("#"+e.panelId+" .preview-combo"),Common.UI.FocusManager.insert(this,this.seriesList,-1*this.getFooterButtons().length)},updateSeriesList:function(t,e){var i=this,s=[],n=this.seriesList.store;this.beforeSeriesReset(n);for(var a=0,o=t.length;a<o;a++){var l=t[a],r=new Common.UI.DataViewModel;r.set({value:l.asc_getSeriesName(),type:l.asc_getChartType(),isSecondary:l.asc_getIsSecondaryAxis(),canChangeSecondary:l.asc_canChangeAxisType(),seriesIndex:a,series:l}),s.push(r)}n.reset(s),s.length>0&&void 0!==e&&(e<s.length&&this.seriesList.selectByIndex(e),setTimeout((function(){i.seriesList.focus()}),10))},addControls:function(t,e,i){if(i){var s=this,n=i.get("seriesIndex"),a=this.seriesList.cmpEl.find("#chart-recommend-item-"+n),o=i.get("series");o.asc_drawPreviewRect("chart-recommend-series-preview-"+n);var l=this.initSeriesType("#chart-recommend-cmb-series-"+n,n,i),r=new Common.UI.CheckBox({el:a.find("#chart-recommend-chk-series-"+n),value:i.get("isSecondary"),disabled:!i.get("canChangeSecondary")});r.on("change",(function(t,e,i,a){o.asc_TryChangeAxisType("checked"===t.getValue())!==Asc.c_oAscError.ID.No?t.setValue("checked"!==t.getValue(),!0):s.updatePreview(n)})),a.on("mousedown",".combobox",(function(){s.seriesList.selectRecord(i)})),i.set("controls",{checkbox:r,combobox:l},{silent:!0})}},initSeriesType:function(t,e,i){var s=this,n=i.get("series"),a=new Common.UI.DataViewStore(s._arrSeriesType),o=a.findWhere({type:i.get("type")}),l=$(t),r=new Common.UI.ComboBoxDataView({el:l,additionalAlign:this.menuAddAlign,cls:"move-focus",menuCls:"menu-absolute",menuStyle:"width: 318px;",dataViewCls:"menu-insertchart",restoreHeight:535,groups:new Common.UI.DataViewGroupStore(s._arrSeriesGroups),store:a,formTemplate:_.template(['<input type="text" class="form-control" spellcheck="false">'].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-chartlist"><svg width="40" height="40" class="icon uni-scale"><use xlink:href="#chart-<%= iconCls %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:function(t){$(this.el).find("input").val(t?t.get("tip"):"")}});return r.selectRecord(o),r.on("item:click",(function(t,a,o,l){var r=i.get("type"),c=n.asc_TryChangeChartType(l.get("type"));if(c===Asc.c_oAscError.ID.No)t.selectRecord(l),s.updatePreview(e);else{var d=a.store.findWhere({type:r});a.selectRecord(d,!0),c===Asc.c_oAscError.ID.SecondaryAxis&&Common.UI.warning({msg:s.errorSecondaryAxis,maxwidth:500})}})),r},onDeselectSeries:function(t,e,i){if(i&&i.get("controls")){var s=i.get("controls");Common.UI.FocusManager.remove(this,s.index,2),s.index=void 0}},onSelectSeries:function(t,e,i,s){if(i&&i.get("controls")){var n=i.get("controls"),a=Common.UI.FocusManager.insert(this,[n.combobox,n.checkbox],-1*this.getFooterButtons().length);void 0!==a&&(n.index=a),s&&setTimeout((function(){t.focus()}),1)}},beforeSeriesReset:function(t){for(var e=0;e<t.length;e++){var i=t.at(e);if(i){var s=i.get("controls");if(s&&void 0!==s.index){Common.UI.FocusManager.remove(this,s.index,2);break}}}},fillPreviews:function(t){this._currentPreviews="rec"===t.groupId?this.options.props.recommended:this.allCharts,this._currentPreviewSize="menu-chart-group-combo"===t.groupId?[280,160]:[430,258],this._currentTabSettings=t},updatePreview:function(t){var e=this._currentPreviews[this._currentChartType];if(void 0===e&&"rec"!==this._currentTabSettings.groupId&&(e=this._currentPreviews[this._currentChartType]=this.api.asc_getChartData(this._currentChartType)),this._currentTabSettings.divErrorEl.toggleClass("hidden","number"!=typeof e),"number"==typeof e){var i="";switch(e){case Asc.c_oAscError.ID.StockChartError:i=this.errorStockChart;break;case Asc.c_oAscError.ID.MaxDataSeriesError:i=this.errorMaxRows;break;case Asc.c_oAscError.ID.ComboSeriesError:i=this.errorComboSeries;break;case Asc.c_oAscError.ID.MaxDataPointsError:i=this.errorMaxPoints}this._currentTabSettings.lblError.text(i),e=null}if(this._currentTabSettings.listViewEl.toggleClass("hidden",!e||e.length<2),this._currentTabSettings.divPreviewEl.toggleClass("hidden",!e||1!==e.length),"menu-chart-group-combo"===this._currentTabSettings.groupId&&this.listViewComboEl.toggleClass("hidden",!e||0===e.length),e){if(1===e.length)this._currentChartSpace=e[0],this._currentChartSpace.updateView(this._currentTabSettings.divPreviewId);else if(e.length>1){for(var s=this._currentTabSettings.listPreview.store,n=void 0!==t?_.indexOf(s.models,this._currentTabSettings.listPreview.getSelectedRec()):0,a=[],o=0;o<e.length;o++)a.push(new Common.UI.DataViewModel({data:e[o],skipRenderOnChange:!0}));s.reset(a),this._currentChartSpace=e[n],this._currentTabSettings.listPreview.selectByIndex(n,!0)}e.length>0&&"menu-chart-group-combo"===this._currentTabSettings.groupId&&this.updateSeriesList(this._currentChartSpace.asc_getSeries(),t)}this.btnOk.setDisabled(!e||0===e.length)},afterRender:function(){this._setDefaults(this.options.props),this.setActiveCategory(this._currentTabIndex)},_setDefaults:function(t){Common.UI.FocusManager.add(this,this.btnsCategory.concat(this.getFooterButtons()))},getSettings:function(){return this._currentChartSpace},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"===t&&this.btnOk.isDisabled())return;this.handler.call(this,t,"ok"===t?this.getSettings():void 0)}this.close()},textTitle:"Insert Chart",textTitleChange:"Change Chart Type",textRecommended:"Recommended",txtSeriesDesc:"Choose the chart type and axis for your data series",textType:"Type",textSeries:"Series",textSecondary:"Secondary Axis",errorSecondaryAxis:"The selected chart type requires the secondary axis that an existing chart is using. Select another chart type.",errorComboSeries:"To create a combination chart, select at least two series of data.",errorStockChart:"Incorrect row order. To build a stock chart place the data on the sheet in the following order: opening price, max price, min price, closing price.",errorMaxRows:"The maximum number of data series per chart is 255.",errorMaxPoints:"The maximum number of points in series per chart is 4096."},SSE.Views.ChartWizardDialog||{}))})),define("spreadsheeteditor/main/app/view/FillSeriesDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.FillSeriesDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:350,separator:!1},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="3" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',e.textSeries,"</label>","</td>",'<td class="padding-small">','<label class="header">',e.textType,"</label>","</td>",'<td class="padding-small">','<label class="header">',e.textDateUnit,"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="fill-radio-rows"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-linear"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-day"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="fill-radio-cols"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-growth"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-weekday"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">',"</td>",'<td class="padding-small">','<div id="fill-radio-date"></div>',"</td>",'<td class="padding-small">','<div id="fill-radio-month"></div>',"</td>","</tr>","<tr>",'<td class="padding-large">',"</td>",'<td class="padding-large">','<div id="fill-radio-autofill"></div>',"</td>",'<td class="padding-large">','<div id="fill-radio-year"></div>',"</td>","</tr>","<tr>",'<td colspan=3 class="padding-small">','<div id="fill-chb-trend"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label className="input-label">',e.textStep,"</label>",'<div id="fill-input-step-value"></div>',"</td>",'<td class="padding-small">','<label className="input-label">',e.textStop,"</label>",'<div id="fill-input-stop-value"></div>',"</td>",'<td class="padding-small">',"</td>","</tr>","</table>","</div></div>"].join(""))()},t),this.handler=t.handler,this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this,e=this.getChild();this.radioCols=new Common.UI.RadioBox({el:e.find("#fill-radio-cols"),name:"asc-radio-series",labelText:this.textCols,value:Asc.c_oAscSeriesInType.columns}),this.radioCols.on("change",_.bind(this.onRadioSeriesChange,this)),this.radioRows=new Common.UI.RadioBox({el:e.find("#fill-radio-rows"),name:"asc-radio-series",labelText:this.textRows,value:Asc.c_oAscSeriesInType.rows}),this.radioRows.on("change",_.bind(this.onRadioSeriesChange,this)),this.radioLinear=new Common.UI.RadioBox({el:e.find("#fill-radio-linear"),name:"asc-radio-type",labelText:this.textLinear,value:Asc.c_oAscSeriesType.linear}),this.radioLinear.on("change",_.bind(this.onRadioTypeChange,this)),this.radioGrowth=new Common.UI.RadioBox({el:e.find("#fill-radio-growth"),name:"asc-radio-type",labelText:this.textGrowth,value:Asc.c_oAscSeriesType.growth}),this.radioGrowth.on("change",_.bind(this.onRadioTypeChange,this)),this.radioDate=new Common.UI.RadioBox({el:e.find("#fill-radio-date"),name:"asc-radio-type",labelText:this.textDate,value:Asc.c_oAscSeriesType.date}),this.radioDate.on("change",_.bind(this.onRadioTypeChange,this)),this.radioAuto=new Common.UI.RadioBox({el:e.find("#fill-radio-autofill"),name:"asc-radio-type",labelText:this.textAuto,value:Asc.c_oAscSeriesType.autoFill}),this.radioAuto.on("change",_.bind(this.onRadioTypeChange,this)),this.radioDay=new Common.UI.RadioBox({el:e.find("#fill-radio-day"),name:"asc-radio-date",labelText:this.textDay,value:Asc.c_oAscDateUnitType.day}),this.radioDay.on("change",_.bind(this.onRadioDateChange,this)),this.radioWeek=new Common.UI.RadioBox({el:e.find("#fill-radio-weekday"),name:"asc-radio-date",labelText:this.textWeek,value:Asc.c_oAscDateUnitType.weekday}),this.radioWeek.on("change",_.bind(this.onRadioDateChange,this)),this.radioMonth=new Common.UI.RadioBox({el:e.find("#fill-radio-month"),name:"asc-radio-date",labelText:this.textMonth,value:Asc.c_oAscDateUnitType.month}),this.radioMonth.on("change",_.bind(this.onRadioDateChange,this)),this.radioYear=new Common.UI.RadioBox({el:e.find("#fill-radio-year"),name:"asc-radio-date",labelText:this.textYear,value:Asc.c_oAscDateUnitType.year}),this.radioYear.on("change",_.bind(this.onRadioDateChange,this)),this.chTrend=new Common.UI.CheckBox({el:e.find("#fill-chb-trend"),labelText:this.textTrend}),this.chTrend.on("change",_.bind(this.onChangeTrend,this)),this.inputStep=new Common.UI.InputField({el:e.find("#fill-input-step-value"),style:"width: 85px;",allowBlank:!0,validateOnBlur:!1}).on("changed:after",(function(){t.isStepChanged=!0})),this.inputStep._input.on("input",(function(e){t.isInputStepFirstChange&&t.inputStep.showError(),t.isInputStepFirstChange=!1})),this.inputStop=new Common.UI.InputField({el:e.find("#fill-input-stop-value"),style:"width: 85px;",allowBlank:!0,validateOnBlur:!1}).on("changed:after",(function(){t.isStopChanged=!0})),this.inputStop._input.on("input",(function(e){t.isInputStopFirstChange&&t.inputStop.showError(),t.isInputStopFirstChange=!1})),this.afterRender()},getFocusedComponents:function(){return[this.radioRows,this.radioCols,this.radioLinear,this.radioGrowth,this.radioDate,this.radioAuto,this.radioDay,this.radioWeek,this.radioMonth,this.radioYear,this.chTrend,this.inputStep,this.inputStop].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.radioRows},afterRender:function(){this._setDefaults(this.props)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){var e=t.asc_getSeriesIn();this.radioCols.setValue(e===Asc.c_oAscSeriesInType.columns,!0),this.radioRows.setValue(e===Asc.c_oAscSeriesInType.rows,!0),e=t.asc_getType(),this.radioLinear.setValue(e===Asc.c_oAscSeriesType.linear),this.radioGrowth.setValue(e===Asc.c_oAscSeriesType.growth),this.radioDate.setValue(e===Asc.c_oAscSeriesType.date),this.radioAuto.setValue(e===Asc.c_oAscSeriesType.autoFill),e=t.asc_getDateUnit(),this.radioDay.setValue(e===Asc.c_oAscDateUnitType.day,!0),this.radioWeek.setValue(e===Asc.c_oAscDateUnitType.weekday,!0),this.radioMonth.setValue(e===Asc.c_oAscDateUnitType.month,!0),this.radioYear.setValue(e===Asc.c_oAscDateUnitType.year,!0),this.chTrend.setValue(!!t.asc_getTrend()),e=t.asc_getStepValue(),this.inputStep.setValue(null!=e?e:""),e=t.asc_getStopValue(),this.inputStop.setValue(null!=e?e:"")}this._changedProps=t||new Asc.asc_CSeriesSettings},getSettings:function(){return this._changedProps},onDlgBtnClick:function(t){this._handleInput("object"==_typeof(t)?t.currentTarget.attributes.result.value:t)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.handler){if("ok"===t&&!this.isValid())return;this.handler.call(this,t,"ok"===t?this.getSettings():void 0)}this.close()},isValid:function(){if(this.isStepChanged){if((t=this._changedProps.asc_isValidStepValue(this.inputStep.getValue()))[0]!==Asc.c_oAscError.ID.No)return this.inputStep.showError([this.txtErrorNumber]),this.inputStep.focus(),this.isInputStepFirstChange=!0,!1;this._changedProps.asc_setStepValue(t[1])}if(this.isStopChanged){var t;if((t=this._changedProps.asc_isValidStopValue(this.inputStop.getValue()))[0]!==Asc.c_oAscError.ID.No)return this.inputStop.showError([this.txtErrorNumber]),this.inputStop.focus(),this.isInputStopFirstChange=!0,!1;this._changedProps.asc_setStopValue(t[1])}return!0},onRadioTypeChange:function(t,e,i){if(e){this._changedProps&&this._changedProps.asc_setType(t.options.value);var s=t.options.value==Asc.c_oAscSeriesType.date,n=t.options.value==Asc.c_oAscSeriesType.autoFill,a="checked"===this.chTrend.getValue();this.radioDay.setDisabled(!s),this.radioMonth.setDisabled(!s),this.radioWeek.setDisabled(!s),this.radioYear.setDisabled(!s),this.inputStep.setDisabled(n||a),this.inputStop.setDisabled(n||a)}},onRadioSeriesChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSeriesIn(t.options.value)},onRadioDateChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setDateUnit(t.options.value)},onChangeTrend:function(t,e,i){var s="checked"===t.getValue(),n=this.radioDate.getValue(),a=this.radioAuto.getValue();this._changedProps&&this._changedProps.asc_setTrend(s),s&&(n||a)&&this.radioLinear.setValue(!0),this.radioDate.setDisabled(s),this.radioAuto.setDisabled(s),this.inputStep.setDisabled(s||a),this.inputStop.setDisabled(s||a)},textTitle:"Series",textSeries:"Series in",textType:"Type",textDateUnit:"Date unit",textStep:"Step value",textStop:"Stop value",textCols:"Columns",textRows:"Rows",textLinear:"Linear",textGrowth:"Growth",textDate:"Date",textAuto:"AutoFill",textDay:"Day",textWeek:"Weekday",textMonth:"Month",textYear:"Year",textTrend:"Trend",txtErrorNumber:"Your entry cannot be used. An integer or decimal number may be required."},SSE.Views.FillSeriesDialog||{}))})),define("spreadsheeteditor/main/app/view/NamedRangeEditDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.NamedRangeEditDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{alias:"NamedRangeEditDlg",contentWidth:380},initialize:function(t){var e=this;_.extend(this.options,{title:this.txtTitleNew,contentStyle:"padding: 5px 0 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="header">',e.textName,"</label>",'<div id="named-range-txt-name" class="input-row" style="width:100%;"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="header">',e.textScope,"</label>",'<div id="named-range-combo-scope" class="input-group-nr" style="width:100%;"></div>',"</td>","</tr>","<tr>","<td>",'<label class="header">',e.textDataRange,"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="named-range-txt-range" class="input-row"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.handler=t.handler,this.isEdit=t.isEdit||!1,this.sheets=t.sheets||[],this.props=t.props,this.dataRangeValid="",this.wrapEvents={onRefreshDefNameList:_.bind(this.onRefreshDefNameList,this),onLockDefNameManager:_.bind(this.onLockDefNameManager,this)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputName=new Common.UI.InputField({el:$("#named-range-txt-name"),allowBlank:!1,placeHolder:this.namePlaceholder,blankError:this.txtEmpty,validateOnChange:!1,validateOnBlur:!1,style:"width: 100%;",validation:function(e){var i=t.api.asc_checkDefinedName(e,-255==t.cmbScope.getValue()?null:t.cmbScope.getValue());if(!0===i.asc_getStatus())return!0;switch(i.asc_getReason()){case Asc.c_oAscDefinedNameReason.IsLocked:return t.textIsLocked;case Asc.c_oAscDefinedNameReason.Existed:return!(!t.isEdit||t.props.asc_getName(!0).toLowerCase()!=e.toLowerCase())||t.textExistName;case Asc.c_oAscDefinedNameReason.NameReserved:return!t.isEdit||t.textReservedName;default:return t.textInvalidName}}}),this.inputName._input.on("input",(function(e,i){t.isInputFirstChange&&t.inputName.showError(),t.isInputFirstChange=!1})),this.cmbScope=new Common.UI.ComboBox({el:$("#named-range-combo-scope"),style:"width: 100%;",menuStyle:"min-width: 100%;max-height: 280px;",editable:!1,cls:"input-group-nr",data:[],takeFocusOnClose:!0}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#named-range-txt-range"),name:"range",style:"width: 100%;",allowBlank:!0,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validation:function(e){return!!_.isEmpty(e)||(!!(t.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,e,!1)!==Asc.c_oAscError.ID.DataRangeError||t.isEdit&&t.props.asc_getRef().toLowerCase()==e.toLowerCase())||t.textInvalidRange)}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputName,this.cmbScope,this.txtDataRange].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.inputName},afterRender:function(){this._setDefaults(this.props),this.setTitle(this.isEdit?this.txtTitleEdit:this.txtTitleNew),this.api.asc_registerCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_registerCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(this.cmbScope.setData([{value:-255,displayValue:this.strWorkbook}].concat(this.sheets)),t){var e=t.asc_getScope();this.cmbScope.setValue(null===e?-255:e),e=t.asc_getName(!0),_.isEmpty(e)||this.inputName.setValue(e),e=t.asc_getRef(),this.txtDataRange.setValue(e||""),this.dataRangeValid=e,this.txtDataRange.setDisabled(this.isEdit&&(t.asc_getType()===Asc.c_oAscDefNameType.table||t.asc_getType()===Asc.c_oAscDefNameType.slicer))}else this.cmbScope.setValue(-255);this.cmbScope.setDisabled(this.isEdit)},onSelectData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.dataRangeValid=e.getSettings(),t.txtDataRange.setValue(t.dataRangeValid),t.txtDataRange.checkValidate())}}).on("close",(function(){t.show(),_.delay((function(){t.txtDataRange.focus()}),1)})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtDataRange.getValue())||1!=t.txtDataRange.checkValidate()?t.dataRangeValid:t.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},getSettings:function(){return new Asc.asc_CDefName(this.inputName.getValue(),this.txtDataRange.getValue(),-255==this.cmbScope.getValue()?null:this.cmbScope.getValue(),this.props.asc_getType(),void 0,void 0,void 0,!0)},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onDlgBtnClick:function(t){var e=this,i="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;if("ok"==i){if(this.locked)return void Common.UI.alert({msg:this.errorCreateDefName,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:function(t){e.close()}});var s=this.inputName.checkValidate(),n=this.txtDataRange.checkValidate();if(!0!==s)return this.inputName.focus(),void(this.isInputFirstChange=!0);if(!0!==n)return void this.txtDataRange.focus();this.handler&&this.handler.call(this,i,"ok"==i?this.getSettings():void 0)}this.close()},onLockDefNameManager:function(t){this.locked=t==Asc.c_oAscDefinedNameReason.LockDefNameManager},onRefreshDefNameList:function(t){var e=this;this.isEdit&&Common.Utils.InternalSettings.get("sse-settings-coauthmode")&&t&&t.asc_getIsLock()&&t.asc_getName(!0).toLowerCase()==this.props.asc_getName(!0).toLowerCase()&&(null===t.asc_getScope()&&null===this.props.asc_getScope()||t.asc_getScope().toLowerCase()==this.props.asc_getScope().toLowerCase())&&!this._listRefreshed&&(this._listRefreshed=!0,Common.UI.alert({closable:!1,msg:this.errorCreateDefName,title:this.notcriticalErrorTitle,iconCls:"warn",buttons:["ok"],callback:function(t){e.close()}}))},close:function(){this.api.asc_unregisterCallback("asc_onLockDefNameManager",this.wrapEvents.onLockDefNameManager),this.api.asc_unregisterCallback("asc_onRefreshDefNameList",this.wrapEvents.onRefreshDefNameList),Common.UI.Window.prototype.close.call(this)},txtTitleNew:"New Name",txtTitleEdit:"Edit Name",textSelectData:"Select Data",textName:"Name",textScope:"Scope",textDataRange:"Data Range",namePlaceholder:"Defined name",strWorkbook:"Workbook",txtEmpty:"This field is required",textInvalidRange:"ERROR! Invalid cells range",textInvalidName:"ERROR! Invalid range name",textExistName:"ERROR! Range with such a name already exists",textIsLocked:"This element is being edited by another user.",errorCreateDefName:"The existing named ranges cannot be edited and the new ones cannot be created<br>at the moment as some of them are being edited.",notcriticalErrorTitle:"Warning",textReservedName:"The name you are trying to use is already referenced in cell formulas. Please use some other name."},SSE.Views.NamedRangeEditDlg||{}))})),define("spreadsheeteditor/main/app/view/CreateSparklineDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.CreateSparklineDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 2px;">','<label class="input-label">'+this.textDataRange+"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="create-spark-input-source" class="input-row" style=""></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="create-spark-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.props=t.props,this.options.handler=function(e,i){if("ok"==e&&!this.isRangeValid())return!0;t.handler&&t.handler.call(this,e,i)},this.dataSourceValid="",this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.txtSourceRange=new Common.UI.InputFieldBtn({el:$("#create-spark-input-source"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtSourceRange.on("button:click",_.bind(this.onSelectData,this,"source")),this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#create-spark-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.afterRender()},getFocusedComponents:function(){return[this.txtSourceRange,this.txtDestRange].concat(this.getFooterButtons())},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){var e=t?t.selectedCells:0,i=this;if(e>0){var s=this.api.asc_getActiveRangeStr(Asc.referenceType.R);this.txtSourceRange.setValue(s),this.dataSourceValid=s,setTimeout((function(){i.txtDestRange.focus()}),100)}else{s=this.api.asc_getActiveRangeStr(Asc.referenceType.A);this.txtDestRange.setValue(s),this.dataDestValid=s,setTimeout((function(){i.txtSourceRange.focus()}),100)}this.txtSourceRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange},this.txtDestRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.FormatTable,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange}},getSettings:function(){return{source:this.txtSourceRange.getValue(),destination:this.txtDestRange.getValue()}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtSourceRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,this.txtSourceRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t?(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.FormatTable,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t||(this.txtDestRange.showError([e]),this.txtDestRange.focus(),t)):(this.txtSourceRange.showError([e]),this.txtSourceRange.focus(),t)},onSelectData:function(t){var e=this,i="source"==t?e.txtSourceRange:e.txtDestRange;if(e.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){if("ok"==n){var a=s.getSettings();"source"==t?e.dataSourceValid=a:e.dataDestValid=a,i.setValue(a),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),n=Common.Utils.getOffset(e.$window);e.hide(),s.show(e.$window,n),s.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?"source"==t?e.dataSourceValid:e.dataDestValid:i.getValue(),type:"source"==t?Asc.c_oAscSelectionDialogType.Chart:Asc.c_oAscSelectionDialogType.FormatTable})}},textTitle:"Create Sparklines",textDataRange:"Source data range",textSelectData:"Select data",textDestination:"Choose, where to place the sparklines",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},SSE.Views.CreateSparklineDialog||{}))})),define("spreadsheeteditor/main/app/view/ImportFromXmlDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.ImportFromXmlDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-small">','<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="import-xml-radio-new"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="import-xml-radio-exist"></div>',"</td>","</tr>","<tr>",'<td class="padding-small padding-left-22">','<div id="import-xml-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.options.handler=function(e,i){if("ok"==e&&!this.isRangeValid())return!0;t.handler&&t.handler.call(this,e,i)},this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#import-xml-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.radioNew=new Common.UI.RadioBox({el:$("#import-xml-radio-new"),labelText:this.textNew,name:"asc-radio-xml-dest"}).on("change",(function(e,i){t.txtDestRange.setDisabled(i),t.txtDestRange.showError()})),this.radioExist=new Common.UI.RadioBox({el:$("#import-xml-radio-exist"),labelText:this.textExist,name:"asc-radio-xml-dest",checked:!0}).on("change",(function(e,i){t.txtDestRange.setDisabled(!i),t.txtDestRange.cmpEl.find("input").focus()})),this.afterRender()},getFocusedComponents:function(){return[this.radioNew,this.radioExist,this.txtDestRange].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtDestRange},afterRender:function(){this._setDefaults()},_setDefaults:function(){var t=this;this.txtDestRange.validation=function(e){return t.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ImportXml,e,!1)!=Asc.c_oAscError.ID.DataRangeError||t.textInvalidRange};var e=this.api.asc_getActiveRangeStr(Asc.referenceType.A);this.txtDestRange.setValue(e),this.dataDestValid=e},getSettings:function(){return{destination:this.radioExist.getValue()?this.txtDestRange.getValue():null}},isRangeValid:function(){var t=!0,e="";return this.radioExist.getValue()&&(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ImportXml,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),!t)?(this.txtDestRange.showError([e]),this.txtDestRange.cmpEl.find("input").focus(),t):t},onSelectData:function(t){var e=this,i=e.txtDestRange;if(e.api){var s=new SSE.Views.CellRangeDialog({handler:function(t,s){if("ok"==s){var n=t.getSettings();e.dataDestValid=n,i.setValue(n),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),n=Common.Utils.getOffset(e.$window);e.hide(),s.show(e.$window,n),s.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?e.dataDestValid:i.getValue(),type:Asc.c_oAscSelectionDialogType.ImportXml})}},textTitle:"Import Data",textSelectData:"Select data",textDestination:"Choose, where to place the data",textNew:"New worksheet",textExist:"Existing worksheet",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},SSE.Views.ImportFromXmlDialog||{}))})),define("spreadsheeteditor/main/app/view/GoalSeekDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.GoalSeekDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:250,separator:!1,id:"window-goal-seek"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>","<td>",'<label class="input-label">'+e.textSetCell+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="goal-seek-formula-cell" class="input-row"></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+e.textToValue+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="goal-seek-expect-val" class="input-row"></div>',"</td>","</tr>","<tr>","<td>",'<label class="input-label">'+e.textChangingCell+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="goal-seek-change-cell" class="input-row"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.props=t.props,this.options.handler=function(e,i){if("ok"==e&&!this.isRangeValid())return!0;t.handler&&t.handler.call(this,e,i)},this.dataFormulaCellValid="",this.dataChangeCellValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.txtFormulaCell=new Common.UI.InputFieldBtn({el:$("#goal-seek-formula-cell"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,validateOnBlur:!1,hideErrorOnInput:!0}),this.txtFormulaCell.on("button:click",_.bind(this.onSelectData,this,"formula")),this.txtChangeCell=new Common.UI.InputFieldBtn({el:$("#goal-seek-change-cell"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,validateOnBlur:!1,hideErrorOnInput:!0}),this.txtChangeCell.on("button:click",_.bind(this.onSelectData,this,"change")),this.txtExpectVal=new Common.UI.InputField({el:$("#goal-seek-expect-val"),style:"width: 100%;",maskExp:/[0-9,\.\-]/,validateOnBlur:!1,hideErrorOnInput:!0}),this.afterRender()},getFocusedComponents:function(){return[this.txtFormulaCell,this.txtExpectVal,this.txtChangeCell].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtFormulaCell},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){this.txtFormulaCell.setValue(this.api.asc_getActiveRangeStr(Asc.referenceType.A))},getSettings:function(){return{formulaCell:this.txtFormulaCell.getValue(),changingCell:this.txtChangeCell.getValue(),expectedValue:this.txtExpectVal.getValue()}},isRangeValid:function(){var t,e=!0,i="";return _.isEmpty(this.txtFormulaCell.getValue())?(e=!1,i=this.txtEmpty):(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.GoalSeek_Cell,this.txtFormulaCell.getValue(),!0))!=Asc.c_oAscError.ID.No&&(t==Asc.c_oAscError.ID.DataRangeError?i=this.textDataRangeError:t==Asc.c_oAscError.ID.MustSingleCell?i=this.textMustSingleCell:t==Asc.c_oAscError.ID.MustContainFormula?i=this.textMustContainFormula:t==Asc.c_oAscError.ID.MustFormulaResultNumber&&(i=this.textMustFormulaResultNumber),e=!1),e?(_.isEmpty(this.txtExpectVal.getValue())?(e=!1,i=this.txtEmpty):Common.UI.isValidNumber(this.txtExpectVal.getValue())||(e=!1,i=this.txtErrorNumber),e?(_.isEmpty(this.txtChangeCell.getValue())?(e=!1,i=this.txtEmpty):(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.GoalSeek_ChangingCell,this.txtChangeCell.getValue(),!0))!=Asc.c_oAscError.ID.No&&(t==Asc.c_oAscError.ID.DataRangeError?i=this.textDataRangeError:t==Asc.c_oAscError.ID.MustSingleCell?i=this.textMustSingleCell:t==Asc.c_oAscError.ID.MustContainValue&&(i=this.textMustContainValue),e=!1),e||(this.txtChangeCell.showError([i]),this.txtChangeCell.cmpEl.find("input").focus(),e)):(this.txtExpectVal.showError([i]),this.txtExpectVal.cmpEl.find("input").focus(),e)):(this.txtFormulaCell.showError([i]),this.txtFormulaCell.cmpEl.find("input").focus(),e)},onSelectData:function(t){var e=this,i="formula"==t?e.txtFormulaCell:e.txtChangeCell;if(e.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){if("ok"==n){var a=s.getSettings();"formula"==t?e.dataFormulaCellValid=a:e.dataChangeCellValid=a,i.setValue(a),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),n=Common.Utils.getOffset(e.$window);e.hide(),s.show(e.$window,n),s.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?"formula"==t?e.dataFormulaCellValid:e.dataChangeCellValid:i.getValue()})}},textTitle:"Goal Seek",textSetCell:"Set cell",textToValue:"To value",textChangingCell:"By changing cell",txtEmpty:"This field is required",textSelectData:"Select data",textDataRangeError:"The formula is missing a range",textMustSingleCell:"Reference must be to a single cell",textMustContainFormula:"The cell must contain a formula",textMustFormulaResultNumber:"Formula in cell must result in a number",textMustContainValue:"Cell must contain a value",txtErrorNumber:"Your entry cannot be used. An integer or decimal number may be required."},SSE.Views.GoalSeekDlg||{}))})),define("spreadsheeteditor/main/app/view/GoalSeekStatusDlg",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.GoalSeekStatusDlg=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:330,separator:!1,id:"window-goal-seek-status"},initialize:function(t){var e=this;_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 10px 10px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<div class="row-1 padding-large" style="width: 100%;">','<div class="cell-1">','<label class="input-label" id="goal-seek-status-label">'+e.textSearchIteration+"</label>","</div>",'<div class="cell-2">','<div id="goal-seek-stop" class="padding-small"></div>','<div id="goal-seek-pause"></div>',"</div>","</div>",'<div class="row-2 padding-small">','<div class="cell-1">','<label class="input-label">'+e.textTargetValue+"</label>","</div>",'<div class="cell-2">','<div id="goal-seek-target-value"></div>',"</div>","</div>",'<div class="row-2 padding-small">','<div class="cell-1">','<label class="input-label">'+e.textCurrentValue+"</label>","</div>",'<div class="cell-2">','<div id="goal-seek-current-value"></div>',"</div","</div>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.props=t.props,this._state={isPause:!1,cellName:void 0},this.options.handler=function(e,i){t.handler&&t.handler.call(this,e,i)},this.api.asc_registerCallback("asc_onGoalSeekStop",_.bind(this.onStopSelection,this)),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);this.$targetValue=$("#goal-seek-target-value"),this.$currentValue=$("#goal-seek-current-value"),this.$statusLabel=$("#goal-seek-status-label"),this.btnStep=new Common.UI.Button({parentEl:$("#goal-seek-stop"),caption:this.textStep,cls:"btn-text-default",disabled:!0}),this.btnStep.on("click",_.bind(this.onBtnStep,this)),this.btnPause=new Common.UI.Button({parentEl:$("#goal-seek-pause"),caption:this.textPause,cls:"btn-text-default"}),this.btnPause.on("click",_.bind(this.onBtnPause,this)),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.getChild().find(".primary")}),this.btnOk.setDisabled(!0),this.afterRender()},getFocusedComponents:function(){return[this.btnStep,this.btnPause].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.btnPause},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){},setSettings:function(t){t&&(void 0===this._state.cellName&&(this._state.cellName=t.cellName),this.$targetValue.text(t.targetValue),this.$currentValue.text(t.currentValue),this.$statusLabel.text(Common.Utils.String.format(this.textSearchIteration,t.cellName,t.iteration)))},onBtnPause:function(){this._state.isPause=!this._state.isPause,this.btnPause.setCaption(this._state.isPause?this.textContinue:this.textPause),this.btnStep.setDisabled(!this._state.isPause),this._state.isPause?this.api.asc_PauseGoalSeek():this.api.asc_ContinueGoalSeek()},onBtnStep:function(){this.api.asc_StepGoalSeek()},onStopSelection:function(t){this.btnPause.setDisabled(!0),this.btnStep.setDisabled(!0),this.btnOk.setDisabled(!1),this.btnOk.focus(),this.$statusLabel.text(Common.Utils.String.format(t?this.textFoundSolution:this.textNotFoundSolution,this._state.cellName))},textTitle:"Goal Seek Status",textFoundSolution:"Goal Seeking with Cell {0} found a solution.",textNotFoundSolution:"Goal Seeking with Cell {0} may not have found a solution.",textSearchIteration:"Goal Seeking with Cell {0} on iteration #{1}.",textTargetValue:"Target value:",textCurrentValue:"Current value:",textStep:"Step",textPause:"Pause",textContinue:"Continue"},SSE.Views.GoalSeekStatusDlg||{}))})),define("text!spreadsheeteditor/main/app/template/DataValidationDialog.template",[],(function(){return'<div id="id-data-validation-settings" class="settings-panel active" style="height: 100%;">\n    <div class="inner-content" style="height: 100%;">\n        <table cols="2" style="width: 100%;height: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small padding-right-5">\n                    <label class="input-label"><%= scope.textAllow %></label>\n                    <div id="data-validation-cmb-allow"></div>\n                </td>\n                <td class="padding-small padding-left-5">\n                    <label class="input-label"><%= scope.textData %></label>\n                    <div id="data-validation-cmb-data"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="data-validation-ch-ignore"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small padding-right-5">\n                    <label id="data-validation-label-min" class="input-label"><%= scope.textMin %></label>\n                    <div id="data-validation-txt-min"></div>\n                </td>\n                <td class="padding-small padding-left-5">\n                    <label id="data-validation-label-max" class="input-label"><%= scope.textMax %></label>\n                    <div id="data-validation-txt-max"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan=2 class="padding-small">\n                    <div id="data-validation-ch-show-dropdown"></div>\n                </td>\n            </tr>\n            <tr class="data-source">\n                <td colspan=2 class="padding-small">\n                    <label id="data-validation-label-source" class="input-label"><%= scope.textSource %></label>\n                    <div id="data-validation-txt-source"></div>\n                </td>\n            </tr>\n            <tr style="height: 100%;vertical-align: bottom;">\n                <td colspan=2 style="padding-bottom: 20px;">\n                    <div id="data-validation-ch-apply"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-data-validation-input" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <div id="data-validation-ch-show-input"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textCellSelected %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label class="input-label"><%= scope.textTitle %></label>\n                    <div id="data-validation-input-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="input-label"><%= scope.textInput %></label>\n                    <div id="data-validation-input-msg"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-data-validation-error" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td class="padding-small">\n                    <div id="data-validation-ch-show-error"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <label><%= scope.textUserEnters %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div class="margin-right-5" style="display: inline-block; vertical-align: bottom;">\n                        <div id="data-validation-img-style" class="icon  error" style="margin-bottom: -1px;"></div>\n                    </div>\n                    <div class="float-right">\n                        <label class="input-label"><%= scope.textTitle %></label>\n                        <div id="data-validation-error-title"></div>\n                    </div>\n                    <div class="float-right margin-right-5">\n                        <label class="input-label"><%= scope.textStyle %></label>\n                        <div id="data-validation-cmb-style"></div>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="input-label"><%= scope.textError %></label>\n                    <div id="data-validation-error-msg"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n'})),define("spreadsheeteditor/main/app/view/DataValidationDialog",["text!spreadsheeteditor/main/app/template/DataValidationDialog.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.DataValidationDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:320,contentHeight:245,toggleGroup:"data-validation-group",storageName:"sse-data-validation-category"},initialize:function(e){_.extend(this.options,{title:this.options.title,items:[{panelId:"id-data-validation-settings",panelCaption:this.strSettings},{panelId:"id-data-validation-input",panelCaption:this.strInput},{panelId:"id-data-validation-error",panelCaption:this.strError}],contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.handler=e.handler,this.props=e.props,this._noApply=!0,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this,e=this.getChild();this.cmbAllow=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-allow"),cls:"input-group-nr",editable:!1,data:[{value:Asc.c_oAscEDataValidationType.None,displayValue:this.txtAny},{value:Asc.c_oAscEDataValidationType.Whole,displayValue:this.txtWhole},{value:Asc.c_oAscEDataValidationType.Decimal,displayValue:this.txtDecimal},{value:Asc.c_oAscEDataValidationType.List,displayValue:this.txtList},{value:Asc.c_oAscEDataValidationType.Date,displayValue:this.txtDate},{value:Asc.c_oAscEDataValidationType.Time,displayValue:this.txtTime},{value:Asc.c_oAscEDataValidationType.TextLength,displayValue:this.txtTextLength},{value:Asc.c_oAscEDataValidationType.Custom,displayValue:this.txtOther}],style:"width: 100%;",menuStyle:"min-width: 100%;",takeFocusOnClose:!0}),this.cmbAllow.setValue(Asc.c_oAscEDataValidationType.None),this.cmbAllow.on("selected",_.bind(this.onAllowSelect,this)),this.cmbData=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-data"),cls:"input-group-nr",editable:!1,data:[{value:Asc.EDataValidationOperator.Between,displayValue:this.txtBetween},{value:Asc.EDataValidationOperator.NotBetween,displayValue:this.txtNotBetween},{value:Asc.EDataValidationOperator.Equal,displayValue:this.txtEqual},{value:Asc.EDataValidationOperator.NotEqual,displayValue:this.txtNotEqual},{value:Asc.EDataValidationOperator.GreaterThan,displayValue:this.txtGreaterThan},{value:Asc.EDataValidationOperator.LessThan,displayValue:this.txtLessThan},{value:Asc.EDataValidationOperator.GreaterThanOrEqual,displayValue:this.txtGreaterThanOrEqual},{value:Asc.EDataValidationOperator.LessThanOrEqual,displayValue:this.txtLessThanOrEqual}],style:"width: 100%;",menuStyle:"min-width: 100%;",takeFocusOnClose:!0}),this.cmbData.setValue(Asc.EDataValidationOperator.Between),this.cmbData.on("selected",_.bind(this.onDataSelect,this)),this.chIgnore=new Common.UI.CheckBox({el:e.find("#data-validation-ch-ignore"),labelText:this.textIgnore,value:!0}),this.chIgnore.on("change",_.bind(this.onIgnoreChange,this)),this.lblRangeMin=e.find("#data-validation-label-min"),this.inputRangeMin=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-min"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,1)).on("button:click",_.bind(this.onSelectData,this,1)),this.lblRangeMax=e.find("#data-validation-label-max"),this.inputRangeMax=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-max"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,2)).on("button:click",_.bind(this.onSelectData,this,2)),this.chShowDropDown=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-dropdown"),labelText:this.textShowDropDown,value:!0}),this.chShowDropDown.on("change",_.bind(this.onDropDownChange,this)),this.lblRangeSource=e.find("#data-validation-label-source"),this.inputRangeSource=new Common.UI.InputFieldBtn({el:e.find("#data-validation-txt-source"),style:"100%",btnHint:this.textSelectData,validateOnBlur:!1}).on("changed:after",_.bind(this.onRangeChange,this,3)).on("button:click",_.bind(this.onSelectData,this,3)),this.chApply=new Common.UI.CheckBox({el:e.find("#data-validation-ch-apply"),labelText:this.textApply,disabled:!0}),this.chApply.on("change",_.bind(this.onApplyChange,this)),this.chShowInput=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-input"),labelText:this.textShowInput,value:!0}),this.chShowInput.on("change",_.bind(this.onShowInputChange,this)),this.inputInputTitle=new Common.UI.InputField({el:e.find("#data-validation-input-title"),allowBlank:!0,validateOnBlur:!1,maxLength:32,style:"width: 100%;"}).on("changed:after",(function(){t.isInputTitleChanged=!0})),this.textareaInput=new Common.UI.TextareaField({el:e.find("#data-validation-input-msg"),style:"width: 100%; height: 70px;",maxLength:255,value:""}),this.textareaInput.on("changed:after",(function(){t.isInputChanged=!0})),this.chShowError=new Common.UI.CheckBox({el:e.find("#data-validation-ch-show-error"),labelText:this.textShowError,value:!0}),this.chShowError.on("change",_.bind(this.onShowErrorChange,this)),this.cmbStyle=new Common.UI.ComboBox({el:e.find("#data-validation-cmb-style"),cls:"input-group-nr",editable:!1,data:[{value:Asc.c_oAscEDataValidationErrorStyle.Stop,clsText:"error",displayValue:this.textStop},{value:Asc.c_oAscEDataValidationErrorStyle.Warning,clsText:"warn",displayValue:this.textAlert},{value:Asc.c_oAscEDataValidationErrorStyle.Information,clsText:"info",displayValue:this.textMessage}],style:"width: 110px;",menuStyle:"min-width: 110px;",takeFocusOnClose:!0}),this.cmbStyle.setValue(Asc.c_oAscEDataValidationErrorStyle.Stop),this.cmbStyle.on("selected",_.bind(this.onStyleSelect,this)),this.inputErrorTitle=new Common.UI.InputField({el:e.find("#data-validation-error-title"),allowBlank:!0,validateOnBlur:!1,maxLength:32,style:"width: 140px;"}).on("changed:after",(function(){t.isErrorTitleChanged=!0})),this.textareaError=new Common.UI.TextareaField({el:e.find("#data-validation-error-msg"),style:"width: 100%; height: 70px;",maxLength:255,value:""}),this.textareaError.on("changed:after",(function(){t.isErrorChanged=!0})),this.minMaxTr=e.find("#data-validation-txt-min").closest("tr"),this.sourceTr=e.find("#data-validation-txt-source").closest("tr"),this.dropdownTr=e.find("#data-validation-ch-show-dropdown").closest("tr"),this.errorIcon=e.find("#data-validation-img-style"),this.afterRender()},afterRender:function(){if(this._setDefaults(this.props),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},getFocusedComponents:function(){return this.btnsCategory.concat([this.cmbAllow,this.cmbData,this.chIgnore,this.chShowDropDown,this.inputRangeSource,this.inputRangeMin,this.inputRangeMax,this.chApply,this.chShowInput,this.inputInputTitle,this.textareaInput,this.chShowError,this.cmbStyle,this.inputErrorTitle,this.textareaError]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.cmbAllow.focus();break;case 1:i.inputInputTitle.isDisabled()?i.chShowInput.focus():i.inputInputTitle.focus();break;case 2:i.cmbStyle.isDisabled()?i.chShowError.focus():i.cmbStyle.focus()}}),10)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},onSelectData:function(t,e){var i=this;if(i.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){if("ok"==n){var a=s.getSettings();e.setValue(a),i.onRangeChange(t,e,a)}}}).on("close",(function(){i.show(),setTimeout((function(){i._noApply=!0,e.focus(),i._noApply=!1}),1)})),n=Common.Utils.getOffset(i.$window);i.hide(),s.show(i.$window,n),s.setSettings({api:i.api,range:e.getValue(),type:Asc.c_oAscSelectionDialogType.DataValidation,validation:function(){return!0}})}},onRangeChange:function(t,e,i,s,n){i!=s&&(this._noApply||(1==t||3==t?(this.props.asc_getFormula1()||this.props.asc_setFormula1(new Asc.CDataFormula),this.props.asc_getFormula1().asc_setValue(i)):2==t&&(this.props.asc_getFormula2()||this.props.asc_setFormula2(new Asc.CDataFormula),this.props.asc_getFormula2().asc_setValue(i))))},onAllowSelect:function(t,e){this.ShowHideElem(),this._noApply||this.props.asc_setType(e.value),this.inputRangeMin.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(this.props.asc_getFormula2()&&this.props.asc_getFormula2().asc_getValue()||"")},onDataSelect:function(t,e){this.ShowHideElem(),this._noApply||this.props.asc_setOperator(e.value),this.inputRangeMin.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(this.props.asc_getFormula1()&&this.props.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(this.props.asc_getFormula2()&&this.props.asc_getFormula2().asc_getValue()||"")},onStyleSelect:function(t,e){this.errorIcon.removeClass("error warn info"),this.errorIcon.addClass(e.clsText),this._noApply||this.props.asc_setErrorStyle(e.value)},onIgnoreChange:function(t,e,i,s){this._noApply||this.props.asc_setAllowBlank("checked"==t.getValue())},onDropDownChange:function(t,e,i,s){this._noApply||this.props.asc_setShowDropDown("checked"!==t.getValue())},onShowInputChange:function(t,e,i,s){var n="checked"==t.getValue();this.inputInputTitle.setDisabled(!n),this.textareaInput.setDisabled(!n),this.api&&!this._noApply&&this.props.asc_setShowInputMessage("checked"==t.getValue())},onShowErrorChange:function(t,e,i,s){var n="checked"==t.getValue();this.inputErrorTitle.setDisabled(!n),this.cmbStyle.setDisabled(!n),this.textareaError.setDisabled(!n),this.api&&!this._noApply&&this.props.asc_setShowErrorMessage("checked"==t.getValue())},onApplyChange:function(t,e,i,s){this.api&&!this._noApply&&this.api.asc_setDataValidation(this.getSettings(),"checked"==t.getValue())},_setDefaults:function(t){if(this._noApply=!0,t){var e=t.asc_getAllowBlank();this.chIgnore.setValue(e,!0),e=t.asc_getShowDropDown(),this.chShowDropDown.setValue(!e,!0),e=t.asc_getType(),this.cmbAllow.setValue(null!==e?e:Asc.c_oAscEDataValidationType.None,!0),this.chApply.setDisabled(e===Asc.c_oAscEDataValidationType.None),e=t.asc_getOperator(),this.cmbData.setValue(null!==e?e:Asc.EDataValidationOperator.Between,!0),this.inputRangeMin.setValue(t.asc_getFormula1()&&t.asc_getFormula1().asc_getValue()||""),this.inputRangeSource.setValue(t.asc_getFormula1()&&t.asc_getFormula1().asc_getValue()||""),this.inputRangeMax.setValue(t.asc_getFormula2()&&t.asc_getFormula2().asc_getValue()||""),this.chShowInput.setValue(!!t.asc_getShowInputMessage()),this.inputInputTitle.setValue(t.asc_getPromptTitle()||""),this.textareaInput.setValue(t.asc_getPrompt()||""),this.chShowError.setValue(!!t.asc_getShowErrorMessage()),this.inputErrorTitle.setValue(t.asc_getErrorTitle()||""),this.textareaError.setValue(t.asc_getError()||""),e=t.asc_getErrorStyle(),this.cmbStyle.setValue(null!==e?e:Asc.EDataValidationErrorStyle.Stop);var i=this.cmbStyle.getSelectedRecord();i&&(this.errorIcon.removeClass("error warn info"),this.errorIcon.addClass(i.clsText))}this.ShowHideElem(),this._noApply=!1},getSettings:function(){return this.isInputTitleChanged&&this.props.asc_setPromptTitle(this.inputInputTitle.getValue()),this.isInputChanged&&this.props.asc_setPrompt(this.textareaInput.getValue()),this.isErrorTitleChanged&&this.props.asc_setErrorTitle(this.inputErrorTitle.getValue()),this.isErrorChanged&&this.props.asc_setError(this.textareaError.getValue()),this.props},onDlgBtnClick:function(t){var e=this,i="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;"ok"==i?this.isRangeValid((function(){e.handler&&e.handler.call(e,i,"ok"==i?e.getSettings():void 0),e.close()})):this.close()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},ShowHideElem:function(){var t=this.cmbAllow.getValue(),e=this.cmbData.getValue(),i=e==Asc.EDataValidationOperator.Between||e==Asc.EDataValidationOperator.NotBetween,s=t==Asc.c_oAscEDataValidationType.Custom||t==Asc.c_oAscEDataValidationType.List;this.minMaxTr.toggleClass("hidden",t==Asc.c_oAscEDataValidationType.None||s||!i),this._isMinMaxVisible=!(t==Asc.c_oAscEDataValidationType.None||s||!i),this.sourceTr.toggleClass("hidden",t==Asc.c_oAscEDataValidationType.None||!s&&i),this.dropdownTr.toggleClass("hidden",t!=Asc.c_oAscEDataValidationType.List),this.chIgnore.setDisabled(t===Asc.c_oAscEDataValidationType.None),this.cmbData.setDisabled(t===Asc.c_oAscEDataValidationType.None||t===Asc.c_oAscEDataValidationType.Custom||t===Asc.c_oAscEDataValidationType.List);var n=this.textSource;t==Asc.c_oAscEDataValidationType.List?n=this.textSource:t==Asc.c_oAscEDataValidationType.Custom?n=this.textFormula:e==Asc.EDataValidationOperator.Equal||e==Asc.EDataValidationOperator.NotEqual?n=t==Asc.c_oAscEDataValidationType.Date?this.txtDate:t==Asc.c_oAscEDataValidationType.TextLength?this.txtLength:t==Asc.c_oAscEDataValidationType.Time?this.txtElTime:this.textCompare:e==Asc.EDataValidationOperator.GreaterThan||e==Asc.EDataValidationOperator.GreaterThanOrEqual?n=t==Asc.c_oAscEDataValidationType.Date?this.txtStartDate:t==Asc.c_oAscEDataValidationType.Time?this.txtStartTime:this.textMin:e!=Asc.EDataValidationOperator.LessThan&&e!=Asc.EDataValidationOperator.LessThanOrEqual||(n=t==Asc.c_oAscEDataValidationType.Date?this.txtEndDate:t==Asc.c_oAscEDataValidationType.Time?this.txtEndTime:this.textMax),this.lblRangeSource.text(n);var a=this.textMin,o=this.textMax;t==Asc.c_oAscEDataValidationType.Date?(a=this.txtStartDate,o=this.txtEndDate):t==Asc.c_oAscEDataValidationType.Time&&(a=this.txtStartTime,o=this.txtEndTime),this.lblRangeMin.text(a),this.lblRangeMax.text(o)},isRangeValid:function(t){var e=this,i=Asc.c_oAscError.ID.No,s=this.cmbAllow.getValue();if(s!==Asc.c_oAscEDataValidationType.None){var n,a,o,l=this._isMinMaxVisible,r=function(i){switch(i===Asc.c_oAscError.ID.No&&(i=e.props.asc_checkValid())!==Asc.c_oAscError.ID.No&&(n=l?e.inputRangeMin:e.inputRangeSource),i){case Asc.c_oAscError.ID.DataValidateNotNumeric:o=Common.Utils.String.format(e.errorNotNumeric,a.text());break;case Asc.c_oAscError.ID.DataValidateNegativeTextLength:o=Common.Utils.String.format(e.errorNegativeTextLength,e.cmbAllow.getDisplayValue(e.cmbAllow.getSelectedRecord()));break;case Asc.c_oAscError.ID.DataValidateMustEnterValue:o=l?Common.Utils.String.format(e.errorMustEnterBothValues,e.lblRangeMin.text(),e.lblRangeMax.text()):Common.Utils.String.format(e.errorMustEnterValue,e.lblRangeSource.text());break;case Asc.c_oAscError.ID.DataValidateMinGreaterMax:o=Common.Utils.String.format(e.errorMinGreaterMax,e.lblRangeMin.text(),e.lblRangeMax.text());break;case Asc.c_oAscError.ID.DataValidateInvalid:o=Common.Utils.String.format(s==Asc.c_oAscEDataValidationType.Time?e.errorInvalidTime:s==Asc.c_oAscEDataValidationType.Date?e.errorInvalidDate:e.errorInvalid,a.text());break;case Asc.c_oAscError.ID.NamedRangeNotFound:o=e.errorNamedRange;break;case Asc.c_oAscError.ID.DataValidateInvalidList:o=e.errorInvalidList}o&&Common.UI.warning({msg:o,maxwidth:600,callback:function(t){n.focus()}}),i===Asc.c_oAscError.ID.No&&t.call(e)},c=function(t){e._isMinMaxVisible&&t===Asc.c_oAscError.ID.No?((t=e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.DataValidation,e.props.asc_getFormula2()?e.props.asc_getFormula2().asc_getValue():null,!0,void 0,s))!==Asc.c_oAscError.ID.No&&(n=e.inputRangeMax,a=e.lblRangeMax),t===Asc.c_oAscError.ID.FormulaEvaluateError?Common.UI.warning({msg:e.errorFormula,maxwidth:600,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t?r(Asc.c_oAscError.ID.No):n.focus()}}):r(t)):r(t)};(i=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.DataValidation,this.props.asc_getFormula1()?this.props.asc_getFormula1().asc_getValue():null,!0,void 0,s))!==Asc.c_oAscError.ID.No&&(n=l?e.inputRangeMin:e.inputRangeSource,a=l?e.lblRangeMin:e.lblRangeSource),i===Asc.c_oAscError.ID.FormulaEvaluateError?Common.UI.warning({msg:this.errorFormula,maxwidth:600,buttons:["yes","no"],primary:"yes",callback:function(t){"yes"==t?c(Asc.c_oAscError.ID.No):n.focus()}}):c(i)}else t.call(e)},strSettings:"Settings",strInput:"Input Message",strError:"Error Alert",textAllow:"Allow",textData:"Data",textMin:"Minimum",textMax:"Maximum",textCompare:"Compare to",textSource:"Source",textStartDate:"Start Date",textEndDate:"End Date",textStartTime:"Start Time",textEndTime:"End Time",textFormula:"Formula",textIgnore:"Ignore blank",textApply:"Apply these changes to all other cells with the same settings",textShowDropDown:"Show drop-down list in cell",textCellSelected:"When cell is selected, show this input message",textTitle:"Title",textInput:"Input Message",textUserEnters:"When user enters invalid data, show this error alert",textStyle:"Style",textError:"Error Message",textShowInput:"Show input message when cell is selected",textShowError:"Show error alert after invalid data is entered",txtBetween:"between",txtNotBetween:"not between",txtEqual:"equals",txtNotEqual:"does not equal",txtLessThan:"less than",txtGreaterThan:"greater than",txtLessThanOrEqual:"less than or equal to",txtGreaterThanOrEqual:"greater than or equal to",txtAny:"Any value",txtWhole:"Whole number",txtDecimal:"Decimal",txtList:"List",txtDate:"Date",txtTime:"Time",txtTextLength:"Text length",txtLength:"Length",txtOther:"Other",txtElTime:"Elapsed time",txtStartDate:"Start date",txtStartTime:"Start time",txtEndDate:"End date",txtEndTime:"End time",textStop:"Stop",textAlert:"Alert",textMessage:"Message",textSelectData:"Select data",errorMustEnterBothValues:'You must enter a value in both field "{0}" and field "{1}".',errorMustEnterValue:'You must enter a value in field "{0}".',errorInvalidDate:'The date you entered for the field "{0}" is invalid.',errorInvalidTime:'The time you entered for the field "{0}" is invalid.',errorInvalid:'The value you entered for the field "{0}" is invalid.',errorNotNumeric:'The field "{0}" must be a numeric value, numeric expression, or refer to a cell containing a numeric value.',errorNegativeTextLength:'Negative values cannot be used in conditions "{0}".',errorMinGreaterMax:'The "{1}" field must be greater than or equal to the "{0}" field.',errorFormula:"The value currently evaluates to an error. Do you want to continue?",errorNamedRange:"A named range you specified cannot be found.",errorInvalidList:"The list source must be a delimited list, or a reference to single row or column."},SSE.Views.DataValidationDialog||{}))})),define("spreadsheeteditor/main/app/view/FormulaWizard",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.FormulaWizard=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:580},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table style="width: 100%;">',"<tr><td>",'<div id="formula-wizard-panel-desc" style="word-break: break-word;">','<label id="formula-wizard-args" style="display: block;margin-bottom: 2px;"></label>','<label id="formula-wizard-desc" style="display: inline;margin-bottom: 8px;opacity: 0.7;" class="margin-right-5"></label>','<label id="formula-wizard-help" style="margin-bottom: 8px;" class="link">'+this.textReadMore+"</label>","</div>",'<div id="formula-wizard-panel-args" style="">','<div style="overflow: hidden;position: relative;padding-top:8px;" class="padding-left-8">','<table cols="3" id="formula-wizard-tbl-args" style="width: 100%;">',"</table>","</div>","</div>",'<div style="margin-top: 8px;">','<div id="formula-wizard-lbl-val-func" class="input-label float-right" style="width: 200px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></div>','<label id="formula-wizard-lbl-func-res" class="float-right margin-right-5">'+this.textFunctionRes+"</label>","</div>","</td></tr>",'<tr><td style="padding-bottom: 8px;padding-top: 8px;">','<div id="formula-wizard-panel-args-desc" style="padding: 8px;">','<label id="formula-wizard-arg-desc" style="min-height:30px; height:30px; overflow: hidden;"></label>',"</div>","</td></tr>","<tr><td>",'<div style="word-break: break-word;">','<label id="formula-wizard-value" style="display: block;margin-bottom: 8px;">Formula result:</label>',"</div>","</td></tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.props=this.options.props,this.funcprops=this.options.funcprops,this.api=this.options.api,this.lang=this.options.lang,this._noApply=!1,this.args=[],this.argsNames=[],this.argsDesc=[],this.repeatedIdx=1,this.repeatedArg=void 0,this.helpUrl=void 0,this.minArgCount=1,this.maxArgCount=1,this.minArgWidth=50,this.itemHeight=30,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this.getChild();t.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.panelArgs=t.find("#formula-wizard-panel-args"),this.tableArgs=t.find("#formula-wizard-tbl-args"),this.lblArgDesc=t.find("#formula-wizard-arg-desc"),this.lblFormulaResult=t.find("#formula-wizard-value"),this.lblFunctionResult=t.find("#formula-wizard-lbl-val-func"),this._preventCloseCellEditor=!1,this.afterRender()},afterRender:function(){this._setDefaults()},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,"ok"==t?this.getSettings():void 0),this._preventCloseCellEditor="ok"==t,this.close()},onDlgBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},onPrimary:function(){return this._handleInput("ok"),!1},_setDefaults:function(){Common.UI.FocusManager.add(this,this.getFooterButtons());var t=this;this.funcprops&&((e=this.funcprops).args?$("#formula-wizard-args").html("<b>"+e.name+"</b>"+e.args):$("#formula-wizard-args").addClass("hidden"),e.desc?$("#formula-wizard-desc").text(e.desc):$("#formula-wizard-desc").addClass("hidden"),e.name?$("#formula-wizard-name").html(this.textFunction+": "+e.name):$("#formula-wizard-name").addClass("hidden"),this.argsDesc=e.argsDesc||[],this.parseArgsDesc(e.args),e.custom?this.$window.find("#formula-wizard-help").css("visibility","hidden"):this.$window.find("#formula-wizard-help").on("click",(function(e){t.showHelp()})));if(this.props){var e=this.props;this.minArgCount=e.asc_getArgumentMin(),this.maxArgCount=e.asc_getArgumentMax(),this.recalcArgTableSize();var i=e.asc_getFunctionResult();this.lblFunctionResult.html("= "+(null!=i?i:"")),i=e.asc_getFormulaResult(),this.lblFormulaResult.html(this.textValue+": "+(null!=i?i:""));var s=e.asc_getArgumentsResult(),n=e.asc_getArgumentsType(),a=e.asc_getArgumentsValue();if(n){for(var o=0;o<n.length;o++){var l=n[o],r=[];"object"==_typeof(l)?(this.repeatedArg=l,this.fillRepeatedNames(),r=l):r.push(l),this.fillArgs(r,a,s)}if(a&&this.args.length<a.length&&this.repeatedArg)for(;this.args.length<a.length;)this.fillArgs(this.repeatedArg,a,s);this.scrollerY.update(),this.scrollerY.scrollTop(0)}}this.args.length<1?(this.panelArgs.addClass("hidden"),this.lblFunctionResult.parent().addClass("hidden"),this.lblArgDesc.text(this.textNoArgs)):(this.argsDesc.length<1&&this.lblArgDesc.parent().addClass("hidden"),1==this.args.length&&this.repeatedArg&&this.repeatedArg.length<this.maxArgCount&&(this.fillArgs(this.repeatedArg),this.scrollerY.update()),this.recalcMaxArgDesc(),_.delay((function(){t._noApply=!0,t.args[0].argInput.focus(),t._noApply=!1}),100))},recalcArgTableSize:function(){this.maxArgCount>5&&this.tableArgs.parent().css("height",5*this.itemHeight+8),this.scrollerY?this.scrollerY.update():this.scrollerY=new Common.UI.Scroller({el:this.tableArgs.parent(),minScrollbarLength:20,alwaysVisibleY:!0})},recalcMaxArgDesc:function(t){var e=this,i=parseInt(this.lblArgDesc.css("min-height")),s=parseInt(this.lblArgDesc.css("height")),n=i,a=this.lblArgDesc.html();this.argsDesc&&this.argsDesc.forEach((function(t,i){var s=e.args[i]&&e.args[i].argName||"";t&&e.lblArgDesc.html("<b>"+s+": </b><span>"+t+"</span>");var a=parseInt(e.lblArgDesc.find("span").height());a>n&&(n=a)})),e.lblArgDesc.html(t?a:""),n>i&&(n+=4),n!=s&&(this.lblArgDesc.css("height",n),this.setInnerHeight())},parseArgsDesc:function(t){"("==t.charAt(0)&&(t=t.substring(1)),")"==t.charAt(t.length-1)&&(t=t.substring(0,t.length-1));var e=t.split(this.api.asc_getFunctionArgumentSeparator());e.forEach((function(t,i){var s=t.trim();"["==s.charAt(0)&&(s=s.substring(1)),"]"==s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),s=s.trim(),e[i]=s.charAt(0).toUpperCase().concat(s.substring(1))})),this.argsNames=e},fillRepeatedNames:function(){if(!(this.argsNames.length<1)&&this.repeatedArg&&this.repeatedArg.length>0&&"..."===this.argsNames[this.argsNames.length-1]){this.argsNames.length,this.repeatedArg.length;for(var t=0;t<this.repeatedArg.length;t++){var e=this.argsNames[this.argsNames.length-2-t],i=e.charAt(e.length-1);"123456789".indexOf(i)>-1&&(this.repeatedIdx=parseInt(i),this.argsNames[this.argsNames.length-2-t]=e.substring(0,e.length-1))}}},getArgumentName:function(t){var e="",i=this.argsNames.length;if((!this.repeatedArg||this.repeatedArg.length<1)&&t<i&&"..."!==this.argsNames[t])""===(e=this.argsNames[t])&&(e=this.textArgument+(this.maxArgCount>1?" "+(t+1):""));else if(this.repeatedArg&&this.repeatedArg.length>0&&"..."===this.argsNames[i-1]){var s=this.repeatedArg.length,n=i-1-s;if(t<n)e=this.argsNames[t];else{var a=s-(t-n)%s,o=Math.floor((t-n)/s)+this.repeatedIdx;e=this.argsNames[i-1-a]+o}}else e=this.textArgument+(this.maxArgCount>1?" "+(t+1):"");return e},getArgumentDesc:function(t){var e=this.textNoArgsDesc,i=this.argsDesc.length;if((!this.repeatedArg||this.repeatedArg.length<1)&&t<i)e=this.argsDesc[t]||this.textNoArgsDesc;else if(this.repeatedArg&&this.repeatedArg.length>0){var s=this.repeatedArg.length,n=i-s;if(t<n)t<i&&(e=this.argsDesc[t]);else{var a=s-(t-n)%s;i-a<i&&(e=this.argsDesc[i-a])}}return e},fillArgs:function(t,e,i){for(var s=this.args.length,n=0;n<t.length;n++)this.setControls(s,t[n],e?e[s]:void 0,i?i[s]:void 0),s++},setControls:function(t,e,i,s){var n=this,a='<tr><td class="padding-right-10" style="padding-bottom: 8px;vertical-align: middle;"><div id="formula-wizard-lbl-name-arg{0}" style="min-width:'+this.minArgWidth+'px;white-space: nowrap;margin-top: 1px;"></div></td><td class="padding-right-5" style="padding-bottom: 8px;width: 100%;vertical-align: middle;"><div id="formula-wizard-txt-arg{0}"></div></td><td style="padding-bottom: 8px;vertical-align: middle;"><div id="formula-wizard-lbl-val-arg{0}" class="input-label" style="margin-top: 1px;width: 200px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></div></td></tr>',o=$(Common.Utils.String.format(a,t));this.tableArgs.append(o);var l=new Common.UI.InputFieldBtn({el:o.find("#formula-wizard-txt-arg"+t),index:t,validateOnChange:!0,validateOnBlur:!1}).on("changed:after",(function(t,e,i,s){$(s.target).parent().find(s.relatedTarget).length<1&&n.onInputChanging(t,!0,e,i)})).on("changing",(function(t,e,i,s){e!=i&&n.onInputChanging(t,!1,e,i)})).on("button:click",_.bind(this.onSelectData,this));l.setValue(null!=i?i:""),l._input.on("focus",_.bind(this.onSelectArgument,this,l)),n.args.push({index:t,lblName:o.find("#formula-wizard-lbl-name-arg"+t),lblValue:o.find("#formula-wizard-lbl-val-arg"+t),argInput:l,argName:n.getArgumentName(t),argDesc:n.getArgumentDesc(t),argType:e,argTypeName:n.getArgType(e)}),t<n.minArgCount?n.args[t].lblName.html("<b>"+n.args[t].argName+"</b>"):n.args[t].lblName.html(n.args[t].argName),n.args[t].lblValue.html("= "+(null!=s?s:'<span style="opacity: 0.6; font-weight: bold;">'+n.args[t].argTypeName+"</span>")),Common.UI.FocusManager.insert(this,l,-1*this.getFooterButtons().length)},onInputChanging:function(t,e,i,s,n){var a=this,o=t.options.index,l=a.args[o],r=a.api.asc_insertArgumentsInFormula(a.getArgumentsValue(),o,l.argType,this.funcprops?this.funcprops.origin:void 0,!!e),c=r?r.asc_getArgumentsResult():void 0;c=c?c[o]:void 0,l.lblValue.html("= "+(null!=c?c:'<span style="opacity: 0.6; font-weight: bold;">'+l.argTypeName+"</span>"));var d=r?r.asc_getFunctionResult():void 0;a.lblFunctionResult.html("= "+(null!=d?d:"")),d=r?r.asc_getFormulaResult():void 0,a.lblFormulaResult.html(a.textValue+":"+(null!=d?d:"")),e&&r&&(c=r.asc_getArguments())&&l.argInput.setValue(c[o])},getArgumentsValue:function(){for(var t=[],e=!0,i=this.args.length-1;i>=0;i--){var s=this.args[i].argInput.getValue();e&&(e=!s),!e&&(t[i]=s)}return t},getArgType:function(t){var e="";switch(t){case Asc.c_oAscFormulaArgumentType.number:e=this.textNumber;break;case Asc.c_oAscFormulaArgumentType.text:e=this.textText;break;case Asc.c_oAscFormulaArgumentType.reference:e=this.textRef;break;case Asc.c_oAscFormulaArgumentType.any:e=this.textAny;break;case Asc.c_oAscFormulaArgumentType.logical:e=this.textLogical}return e},onSelectArgument:function(t){var e=t.options.index,i=this.args[e];this.lblArgDesc.html("<b>"+i.argName+': </b><span style="opacity: 0.7;">'+(i.argDesc||this.textNoArgsDesc)+"</span>"),!this._noApply&&e==this.args.length-1&&this.repeatedArg&&e+this.repeatedArg.length<this.maxArgCount&&(this.fillArgs(this.repeatedArg),this.scrollerY.update())},onSelectData:function(t){this.onSelectArgument(t);var e=this;if(e.api){var i=t.getValue(),s=new SSE.Views.CellRangeDialog({allowBlank:!0,handler:function(t,e){"ok"==e&&(i=t.getSettings())}}).on("close",(function(){t.setValue(i),e.onInputChanging(t),e.show(),_.delay((function(){e._noApply=!0,t.focus(),e._noApply=!1}),1)})),n=Common.Utils.getOffset(e.$window);e.hide(),s.show(e.$window,n),s.setSettings({api:e.api,range:_.isEmpty(t.getValue())?"":t.getValue(),type:Asc.c_oAscSelectionDialogType.Function,selection:{start:t._input[0].selectionStart,end:t._input[0].selectionEnd},argvalues:e.getArgumentsValue(),argindex:t.options.index})}},onThemeChanged:function(){this.recalcMaxArgDesc(!0),Common.Views.AdvancedSettingsWindow.prototype.onThemeChanged.call(this)},showHelp:function(){if(null==this.helpUrl){if(!this.funcprops||!this.funcprops.origin)return void(this.helpUrl=null);var t=Common.Utils.InternalSettings.get("sse-settings-func-help");t||(t=this.lang?this.lang.split(/[\-\_]/)[0]:"en");var e=this,i=this.funcprops.origin.toLocaleLowerCase().replace(/\./g,"-"),s="/Functions/"+i+".htm",n="resources/help/"+t+s;if(Common.Controllers.Desktop.isActive()){if(!Common.Controllers.Desktop.isHelpAvailable()){var a=Common.Utils.InternalSettings.get("url-help-center");if(a){var o=new URL(a);o.searchParams&&o.searchParams.set("function",i),window.open(o.toString(),"_blank")}return void(e.helpUrl=null)}n=Common.Controllers.Desktop.helpUrl()+s}fetch(n).then((function(i){i.ok?(Common.Utils.InternalSettings.set("sse-settings-func-help",t),e.helpUrl=n,e.showHelp()):(n="resources/help/en"+s,fetch(n).then((function(t){t.ok?(Common.Utils.InternalSettings.set("sse-settings-func-help","en"),e.helpUrl=n,e.showHelp()):e.helpUrl=null})))}))}else this.helpUrl&&window.open(this.helpUrl)},getSettings:function(){return{}},close:function(){Common.Views.AdvancedSettingsWindow.prototype.close.call(this),this.api.asc_closeCellEditor(!this._preventCloseCellEditor)},textTitle:"Function Argumens",textValue:"Formula result",textFunctionRes:"Function result",textFunction:"Function",textHelp:"Help on this function",textNoArgs:"This function has no arguments",textArgument:"Argument",textNumber:"number",textText:"text",textRef:"reference",textAny:"any",textLogical:"logical",textNoArgsDesc:"this argument has no description",textReadMore:"Read more"},SSE.Views.FormulaWizard||{}))})),define("text!spreadsheeteditor/main/app/template/ImageSettingsAdvanced.template",[],(function(){return'<div id="id-adv-image-rotate" class="settings-panel active">\n    <div class="inner-content  padding-large">\n        <div style="width: 100%;">\n            <label class="input-label vertical-align-baseline"><%= scope.textAngle %></label>\n            <div id="image-advanced-spin-angle" class="margin-left-5 vertical-align-baseline" style="display: inline-block;"></div>\n        </div>\n    </div>\n    <div class="separator horizontal padding-large"></div>\n    <div class="inner-content  padding-large">\n        <table cols="2" role="presentation">\n            <tr>\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\n                </td>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-hor"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-checkbox-vert"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" role="presentation">\n            <tr>\n                <td class="padding-small" role="radiogroup" aria-owns="image-advanced-radio-onecell image-advanced-radio-absolute">\n                    <div id="image-advanced-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="image-advanced-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-image-alttext" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="image-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="image-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/ImageSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ImageSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.ImageSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:257,toggleGroup:"image-adv-settings-group",properties:null,storageName:"sse-image-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-image-rotate",panelCaption:this.textRotation},{panelId:"id-adv-image-snap",panelCaption:this.textSnap},{panelId:"id-adv-image-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._originalProps=this.options.imageProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.spnAngle=new Common.UI.MetricSpinner({el:$("#image-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#image-advanced-checkbox-vert"),labelText:this.textVertically}),this.radioTwoCell=new Common.UI.RadioBox({el:$("#image-advanced-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#image-advanced-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#image-advanced-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#image-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.spnAngle,this.chFlipHor,this.chFlipVert,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.spnAngle.focus();break;case 1:i.radioTwoCell.focus();break;case 2:i.inputAltTitle.focus()}}),10)},onRadioSnapChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putAnchor(t.options.value)},afterRender:function(){if(this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){var e=t.asc_getTitle();switch(this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),e=t.asc_getRot(),this.spnAngle.setValue(null==e||null===e?"":Math.floor(180*e/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),e=t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}var i=t.asc_getPluginGuid();this.btnsCategory[0].setVisible(null==i),this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){return this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),this._changedProps.asc_putFlipH("checked"==this.chFlipHor.getValue()),this._changedProps.asc_putFlipV("checked"==this.chFlipVert.getValue()),{imageProps:this._changedProps}},textTitle:"Image - Advanced Settings",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textSnap:"Cell Snapping",textAbsolute:"Don't move or size with cells",textOneCell:"Move but don't size with cells",textTwoCell:"Move and size with cells"},SSE.Views.ImageSettingsAdvanced||{}))})),define("text!spreadsheeteditor/main/app/template/SlicerSettingsAdvanced.template",[],(function(){return'<div id="id-adv-slicer-style" class="settings-panel active">\n    <div class="inner-content">\n        <div>\n            <div class="padding-small" style="display: inline-block;">\n                <label class="input-label"><%= scope.textHeader %></label>\n                <div id="sliceradv-text-header"></div>\n            </div>\n        </div>\n        <div class="padding-large" id="sliceradv-checkbox-header"></div>\n        <div class="padding-very-small"><label class="header"><%= scope.strStyle %></label></div>\n        <div class="padding-large">\n            <div id="sliceradv-btn-style" style="width: 100%;height: 52px;"></div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strSize %></label></div>\n        <div class="padding-large">\n            <div class="margin-right-5" style="display: inline-block;">\n                <label class="input-label"><%= scope.strWidth %></label>\n                <div id="sliceradv-spin-width"></div>\n            </div>\n            <div id="sliceradv-button-ratio" class="margin-right-5"></div>\n            <div style="display: inline-block;">\n                <label class="input-label"><%= scope.strHeight %></label>\n                <div id="sliceradv-spin-height"></div>\n            </div>\n        </div>\n        <div class="padding-very-small"><label class="header"><%= scope.strButtons %></label></div>\n        <div>\n            <div class="margin-right-5" style="display: inline-block;">\n                <label class="input-label"><%= scope.strColumns %></label>\n                <div id="sliceradv-spin-columns"></div>\n            </div>\n            <div style="display: inline-block;">\n                <label class="input-label"><%= scope.strHeight %></label>\n                <div id="sliceradv-spin-col-height"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-sorting" class="settings-panel">\n    <div class="inner-content" style="width: 100%;">\n        <div class="padding-small">\n            <label class="header"><%= scope.textSort %></label>\n        </div>\n        <div class="padding-large">\n            <div style="display: inline-block;" role="radiogroup">\n                <div class="padding-small" id="sliceradv-radio-asc"></div>\n                <div class="padding-small" id="sliceradv-radio-desc"></div>\n            </div>\n        </div>\n        <div>\n            <div style="display: inline-block;">\n                <div class="padding-small" id="sliceradv-check-hide-nodata"></div>\n                <div class="padding-small" id="sliceradv-check-indicate-nodata"></div>\n                <div class="padding-small" id="sliceradv-check-show-nodata-last"></div>\n                \x3c!--<div class="padding-small" id="sliceradv-check-show-deleted"></div>--\x3e\n            </div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-references" class="settings-panel">\n    <div class="inner-content">\n        <div class="padding-large">\n            <label class="header" style="display: block;"><%= scope.textSourceName %></label>\n            <label class="input-label" id="sliceradv-lbl-source"></label>\n        </div>\n        <div class="padding-large">\n            <label class="header" style="display: block;"><%= scope.textFormulaName %></label>\n            <label class="input-label" id="sliceradv-lbl-formula"></label>\n        </div>\n        <div class="padding-large">\n            <label class="header"><%= scope.textName %></label>\n            <div id="sliceradv-text-name"></div>\n        </div>\n    </div>\n</div>\n<div id="id-adv-slicer-snap" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" role="presentation">\n            <tr>\n                <td class="padding-small" role="radiogroup" aria-owns="slicer-advanced-radio-onecell slicer-advanced-radio-absolute">\n                    <div id="slicer-advanced-radio-twocell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="slicer-advanced-radio-onecell"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small">\n                    <div id="slicer-advanced-radio-absolute"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-slicer-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="sliceradv-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="sliceradv-alt-description" class="form-control" style="width: 100%; height: 120px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/SlicerSettingsAdvanced",["text!spreadsheeteditor/main/app/template/SlicerSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.SlicerSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:330,contentHeight:350,toggleGroup:"slicer-adv-settings-group",storageName:"sse-slicer-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-slicer-style",panelCaption:this.strStyleSize},{panelId:"id-adv-slicer-sorting",panelCaption:this.strSorting},{panelId:"id-adv-slicer-references",panelCaption:this.strReferences},{panelId:"id-adv-slicer-snap",panelCaption:this.textSnap},{panelId:"id-adv-slicer-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),this.options.handler=function(t,i){if("ok"==t&&!this.isNameValid())return!0;e.handler&&e.handler.call(this,t,i)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._changedProps=null,this._noApply=!0,this.spinners=[],this._nRatio=1,this._originalProps=this.options.imageProps},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputHeader=new Common.UI.InputField({el:$("#sliceradv-text-header"),allowBlank:!0,style:"width: 178px;"}).on("changed:after",(function(){t.isCaptionChanged=!0})),this.chHeader=new Common.UI.CheckBox({el:$("#sliceradv-checkbox-header"),labelText:this.strShowHeader}),this.chHeader.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_setShowCaption("checked"==t.getValue())}),this)),this.btnSlicerStyle=new Common.UI.Button({parentEl:$("#sliceradv-btn-style"),cls:"btn-large-dataview sheet-template-slicer",iconCls:"icon-template-slicer",scaling:!1,menu:new Common.UI.Menu({style:"width: 333px;",additionalAlign:this.menuAddAlign,items:[{template:_.template('<div id="sliceradv-menu-style" class="menu-slicer-template"  style="margin: 5px 5px 5px 10px;"></div>')}]}),takeFocusOnClose:!0}),this.mnuSlicerPicker=new Common.UI.DataView({el:$("#sliceradv-menu-style"),parentMenu:this.btnSlicerStyle.menu,restoreHeight:325,groups:new Common.UI.DataViewGroupStore,store:new Common.UI.DataViewStore,itemTemplate:_.template('<div id="<%= id %>" class="item"><img src="<%= imageUrl %>" height="49" width="36"></div>'),style:"max-height: 325px;"}),this.mnuSlicerPicker.on("item:click",_.bind(this.onSelectSlicerStyle,this,this.btnSlicerStyle)),this.numWidth=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-width"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numWidth.on("change",_.bind((function(t,e,i,s){if(this.btnRatio.pressed){var n=t.getNumberValue(),a=n/this._nRatio;a>this.numHeight.options.maxValue&&(n=(a=this.numHeight.options.maxValue)*this._nRatio,this.numWidth.setValue(n,!0)),this.numHeight.setValue(a,!0)}this._originalProps&&(this._originalProps.put_Width(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._originalProps.put_Height(Common.Utils.Metric.fnRecalcToMM(this.numHeight.getNumberValue())))}),this)),this.spinners.push(this.numWidth),this.numHeight=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-height"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.numWidth.options.maxValue&&(n=(a=this.numWidth.options.maxValue)/this._nRatio,this.numHeight.setValue(n,!0)),this.numWidth.setValue(a,!0)),this._originalProps&&(this._originalProps.put_Width(Common.Utils.Metric.fnRecalcToMM(this.numWidth.getNumberValue())),this._originalProps.put_Height(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.numHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#sliceradv-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.numHeight.getNumberValue()>0&&(this._nRatio=this.numWidth.getNumberValue()/this.numHeight.getNumberValue()),this._originalProps&&this._originalProps.asc_putLockAspect(t.pressed)}),this)),this.numColHeight=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-col-height"),step:.1,width:85,defaultUnit:"cm",defaultValue:0,value:"0 cm",maxValue:5963.9,minValue:0}),this.numColHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue();this._changedProps&&this._changedProps.asc_setRowHeight(36e3*Common.Utils.Metric.fnRecalcToMM(n))}),this)),this.spinners.push(this.numColHeight),this.numCols=new Common.UI.MetricSpinner({el:$("#sliceradv-spin-columns"),step:1,width:85,defaultUnit:"",defaultValue:1,value:"1",allowDecimal:!1,maxValue:2e4,minValue:1}),this.numCols.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue();this._changedProps&&this._changedProps.asc_setColumnCount(n)}),this)),this.radioAsc=new Common.UI.RadioBox({el:$("#sliceradv-radio-asc"),name:"asc-radio-sliceradv-sort",labelText:this.textAsc,checked:!0}),this.radioAsc.on("change",_.bind((function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Ascending)}),this)),this.radioDesc=new Common.UI.RadioBox({el:$("#sliceradv-radio-desc"),name:"asc-radio-sliceradv-sort",labelText:this.textDesc,checked:!1}),this.radioDesc.on("change",_.bind((function(t,e,i){e&&this._changedProps&&this._changedProps.asc_setSortOrder(Asc.ST_tabularSlicerCacheSortOrder.Descending)}),this)),this.chHideNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-hide-nodata"),labelText:this.strHideNoData}),this.chHideNoData.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue();this.chIndNoData.setDisabled(n),this.chShowNoData.setDisabled(n||"checked"!=this.chIndNoData.getValue()),this.chShowDel.setDisabled(n),this._changedProps&&this._changedProps.asc_setHideItemsWithNoData(n)}),this)),this.chIndNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-indicate-nodata"),labelText:this.strIndNoData}),this.chIndNoData.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue();this.chShowNoData.setDisabled(!n),this._changedProps&&this._changedProps.asc_setIndicateItemsWithNoData(n)}),this)),this.chShowNoData=new Common.UI.CheckBox({el:$("#sliceradv-check-show-nodata-last"),disabled:!0,labelText:this.strShowNoData}),this.chShowNoData.on("change",_.bind((function(t,e,i,s){this._changedProps&&this._changedProps.asc_setShowItemsWithNoDataLast("checked"==t.getValue())}),this)),this.chShowDel=new Common.UI.CheckBox({el:$("#sliceradv-check-show-deleted"),labelText:this.strShowDel}),this.chShowDel.on("change",_.bind((function(t,e,i,s){this._changedProps}),this)),this.inputName=new Common.UI.InputField({el:$("#sliceradv-text-name"),allowBlank:!1,blankError:t.txtEmpty,style:"width: 178px;"}).on("changed:after",(function(){t.isNameChanged=!0})),this.lblSource=$("#sliceradv-lbl-source"),this.lblFormula=$("#sliceradv-lbl-formula"),this.radioTwoCell=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#slicer-advanced-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#sliceradv-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputHeader,this.chHeader,this.btnSlicerStyle,this.numWidth,this.btnRatio,this.numHeight,this.numCols,this.numColHeight,this.radioAsc,this.radioDesc,this.chHideNoData,this.chIndNoData,this.chShowNoData,this.inputName,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputHeader.focus();break;case 1:i.chHideNoData.focus();break;case 2:i.inputName.focus();break;case 3:i.radioTwoCell.focus();break;case 4:i.inputAltTitle.focus()}}),10)},getSettings:function(){return this.isCaptionChanged&&this._changedProps.asc_setCaption(this.inputHeader.getValue()),this.isNameChanged&&this._changedProps.asc_setName(this.inputName.getValue()),this.isAltTitleChanged&&this._originalProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._originalProps.asc_putDescription(this.textareaAltDescription.val()),{imageProps:this._originalProps}},_setDefaults:function(t){if(t){var e=t.asc_getWidth();switch(this.numWidth.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),e=t.asc_getHeight(),this.numHeight.setValue(null!==e?Common.Utils.Metric.fnRecalcFromMM(e).toFixed(2):"",!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight()),e=t.asc_getLockAspect(),this.btnRatio.toggle(e),e=t.asc_getTitle(),this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||""),e=t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}var i=t.asc_getSlicerProperties();if(i){this._noApply=!0,this.numCols.setValue(i.asc_getColumnCount(),!0),this.numColHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(i.asc_getRowHeight()/36e3).toFixed(2),!0),this.inputHeader.setValue(i.asc_getCaption(),!0);var s=i.asc_getShowCaption();this.chHeader.setValue(null!=s?s:"indeterminate",!0),this.radioAsc.setCaption(this.textAsc+" ("+this.textAZ+")"),this.radioDesc.setCaption(this.textDesc+" ("+this.textZA+")"),i.asc_getSortOrder()==Asc.ST_tabularSlicerCacheSortOrder.Ascending?this.radioAsc.setValue(!0,!0):this.radioDesc.setValue(!0,!0),s=i.asc_getIndicateItemsWithNoData(),this.chIndNoData.setValue(null!=s?s:"indeterminate",!0),s=i.asc_getShowItemsWithNoDataLast(),this.chShowNoData.setValue(null!=s?s:"indeterminate",!0),s=i.asc_getHideItemsWithNoData(),this.chHideNoData.setValue(null!=s?s:"indeterminate",!0),this.chIndNoData.setDisabled(s),this.chShowNoData.setDisabled(s||"checked"!=this.chIndNoData.getValue()),this.chShowDel.setDisabled(s),e=i.asc_getName(),this.inputName.setValue(null!=e?e:""),this.inputName.setDisabled(null==e),this.lblSource.text(i.asc_getSourceName()),this.lblFormula.text(i.asc_getNameInFormulas()),e=i.asc_getStyle();var n=this.mnuSlicerPicker.store.findWhere({type:e});!n&&this.mnuSlicerPicker.store.length>0&&(n=this.mnuSlicerPicker.store.at(0)),n?(this.btnSlicerStyle.suspendEvents(),this.mnuSlicerPicker.selectRecord(n,!0),this.btnSlicerStyle.resumeEvents(),this.$window.find(".icon-template-slicer").css({"background-image":"url("+n.get("imageUrl")+")",height:"49px",width:"36px","background-position":"center","background-size":"cover"})):this.$window.find(".icon-template-slicer").css({height:"49px",width:"36px","background-position":"center","background-size":"cover"}),this._noApply=!1,this._changedProps=i}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){this.spinners[t].setDefaultUnit(Common.Utils.Metric.getCurrentMetricName())}},afterRender:function(){if(this.updateMetricUnit(),this.onInitStyles(this.options.styles),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},onInitStyles:function(t){var e=[];t&&_.each(t,(function(t){e.push({id:Common.UI.getId(),type:t.asc_getName(),imageUrl:t.asc_getImage(),allowSelected:!0,selected:!1})})),this.mnuSlicerPicker.store.reset(e),this.btnSlicerStyle.setDisabled(this.mnuSlicerPicker.store.length<1)},onSelectSlicerStyle:function(t,e,i,s){this._noApply||(this._changedProps&&this._changedProps.asc_setStyle(s.get("type")),this.$window.find(".icon-template-slicer").css({"background-image":"url("+s.get("imageUrl")+")",height:"49px",width:"36px","background-position":"center","background-size":"cover"}))},onRadioSnapChange:function(t,e,i){e&&this._originalProps&&this._originalProps.asc_putAnchor(t.options.value)},isNameValid:function(){return!this.isNameChanged||!_.isEmpty(this.inputName.getValue())||(this.setActiveCategory(2),this.inputName.cmpEl.find("input").focus(),!1)},textTitle:"Slicer - Advanced Settings",textHeader:"Header",strStyle:"Style",strSize:"Size",strWidth:"Width",strHeight:"Height",strButtons:"Buttons",strColumns:"Columns",textSort:"Sort",textSourceName:"Source name",textFormulaName:"Name to use in formulas",textName:"Name",strStyleSize:"Style & Size",strSorting:"Sorting & Filtering",strReferences:"References",txtEmpty:"This field is required",strShowHeader:"Display header",textAsc:"Ascending",textDesc:"Descending",textAZ:"A to Z",textZA:"Z to A",textOldNew:"oldest to newest",textNewOld:"newest to oldest",textSmallLarge:"smallest to largest",textLargeSmall:"largest to smallest",strHideNoData:"Hide items with no data",strIndNoData:"Visually indicate items with no data",strShowNoData:"Show items with no data last",strShowDel:"Show items deleted from the data source",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",textSnap:"Cell Snapping",textAbsolute:"Don't move or size with cells",textOneCell:"Move but don't size with cells",textTwoCell:"Move and size with cells",textKeepRatio:"Constant Proportions"},SSE.Views.SlicerSettingsAdvanced||{}))})),define("text!spreadsheeteditor/main/app/template/PivotSettingsAdvanced.template",[],(function(){return'<div id="id-adv-pivot-layout" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="2" style="width: 100%;" role="presentation">\n            <tr>\n                <td colspan="2" class="padding-large">\n                    <label class="header"><%= scope.txtName %></label>\n                    <div id="pivot-adv-name"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textGrandTotals %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-show-rows"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-large">\n                    <div id="pivot-adv-chk-show-columns"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <label class="header"><%= scope.textDisplayFields %></label>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small" role="radiogroup" aria-owns="pivot-adv-radio-over">\n                    <div id="pivot-adv-radio-down"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-radio-over"></div>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-large">\n                    <label id="pivot-adv-label-wrap" class="input-label"></label>\n                </td>\n                <td class="padding-large">\n                    <div id="pivot-adv-spin-wrap" class="float-right" style="width: 85px;"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-show-headers"></div>\n                </td>\n            </tr>\n            <tr>\n                <td colspan="2" class="padding-small">\n                    <div id="pivot-adv-chk-autofit-col-width"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-pivot-data" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" style="width: 100%;" role="presentation">\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textDataRange %></label>\n                </td>\n            </tr>\n            <tr>\n                <td class="padding-small" width="220">\n                    <div id="pivot-adv-txt-range" class="input-row"></div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div id="id-adv-pivot-alttext" class="settings-panel">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="pivot-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="pivot-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/PivotSettingsAdvanced",["text!spreadsheeteditor/main/app/template/PivotSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.PivotSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,contentHeight:355,toggleGroup:"pivot-adv-settings-group",storageName:"sse-pivot-adv-settings-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-pivot-layout",panelCaption:this.strLayout},{panelId:"id-adv-pivot-data",panelCaption:this.textDataSource},{panelId:"id-adv-pivot-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),this.api=e.api,this.props=e.props,this.options.handler=function(t,i){if("ok"==t&&!this.isRangeValid())return!0;e.handler&&e.handler.call(this,t,i)},Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputName=new Common.UI.InputField({el:$("#pivot-adv-name"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),this.radioDown=new Common.UI.RadioBox({el:$("#pivot-adv-radio-down"),labelText:this.textDown,name:"asc-radio-display-field",checked:!0}),this.radioDown.on("change",_.bind((function(t,e,i){e&&this.lblPageWrap.html(this.textWrapCol)}),this)),this.radioOver=new Common.UI.RadioBox({el:$("#pivot-adv-radio-over"),labelText:this.textOver,name:"asc-radio-display-field"}),this.radioOver.on("change",_.bind((function(t,e,i){e&&this.lblPageWrap.html(this.textWrapRow)}),this)),this.chRows=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-rows"),labelText:this.textShowRows}),this.chCols=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-columns"),labelText:this.textShowCols}),this.numWrap=new Common.UI.MetricSpinner({el:$("#pivot-adv-spin-wrap"),step:1,width:60,allowDecimal:!1,defaultUnit:"",value:"0",maxValue:255,minValue:0}),this.lblPageWrap=this.$window.find("#pivot-adv-label-wrap"),this.chHeaders=new Common.UI.CheckBox({el:$("#pivot-adv-chk-show-headers"),labelText:this.textShowHeaders}),this.chAutofitColWidth=new Common.UI.CheckBox({el:$("#pivot-adv-chk-autofit-col-width"),labelText:this.textAutofitColWidth}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#pivot-adv-txt-range"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,blankError:this.txtEmpty,validateOnChange:!0}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#pivot-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputName,this.chRows,this.chCols,this.radioDown,this.radioOver,this.numWrap,this.chHeaders,this.chAutofitColWidth,this.txtDataRange,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.inputName.focus();break;case 1:i.txtDataRange.focus();break;case 2:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this._setDefaults(this.props),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},_setDefaults:function(t){if(t){var e=this;this.inputName.setValue(t.asc_getName()),this.chCols.setValue(t.asc_getRowGrandTotals(),!0),this.chRows.setValue(t.asc_getColGrandTotals(),!0),t.asc_getPageOverThenDown()?this.radioOver.setValue(!0):this.radioDown.setValue(!0),this.lblPageWrap.html(t.asc_getPageOverThenDown()?this.textWrapRow:this.textWrapCol),this.numWrap.setValue(t.asc_getPageWrap()),this.chHeaders.setValue(t.asc_getShowHeaders(),!0),this.chAutofitColWidth.setValue(t.asc_getUseAutoFormatting(),!0);var i=t.asc_getDataRef();this.txtDataRange.setValue(i||""),this.dataRangeValid=i,this.txtDataRange.validation=function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange},i=t.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=t.asc_getDescription(),this.textareaAltDescription.val(i||"")}},getSettings:function(){var t=new Asc.CT_pivotTableDefinition;return t.asc_setName(this.inputName.getValue()),t.asc_setRowGrandTotals("checked"==this.chCols.getValue()),t.asc_setColGrandTotals("checked"==this.chRows.getValue()),t.asc_setPageOverThenDown(this.radioOver.getValue()),t.asc_setPageWrap(this.numWrap.getNumberValue()),t.asc_setShowHeaders("checked"==this.chHeaders.getValue()),t.asc_setUseAutoFormatting("checked"==this.chAutofitColWidth.getValue()),t.asc_setDataRef(this.txtDataRange.getValue()),this.isAltTitleChanged&&t.asc_setTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&t.asc_setDescription(this.textareaAltDescription.val()),t},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtDataRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,this.txtDataRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t||(this.setActiveCategory(1),this.txtDataRange.showError([e]),this.txtDataRange.cmpEl.find("input").focus(),t)},onSelectData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.dataRangeValid=e.getSettings(),t.txtDataRange.setValue(t.dataRangeValid),t.txtDataRange.checkValidate())}}).on("close",(function(){t.show()})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtDataRange.getValue())||1!=t.txtDataRange.checkValidate()?t.dataRangeValid:t.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.PivotTableData})}},textTitle:"Pivot Table - Advanced Settings",strLayout:"Name and Layout",txtName:"Name",textGrandTotals:"Grand Totals",textShowRows:"Show for rows",textShowCols:"Show for columns",textDataSource:"Data Source",textDataRange:"Data Range",textSelectData:"Select data",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",txtEmpty:"This field is required",textInvalidRange:"ERROR! Invalid cells range",textDisplayFields:"Display fields in report filter area",textDown:"Down, then over",textOver:"Over, then down",textWrapCol:"Report filter fields per column",textWrapRow:"Report filter fields per row",textHeaders:"Field Headers",textShowHeaders:"Show field headers for rows and columns",textAutofitColWidth:"Autofit column widths on update"},SSE.Views.PivotSettingsAdvanced||{}))})),define("text!spreadsheeteditor/main/app/template/TableSettingsAdvanced.template",[],(function(){return'<div id="id-adv-table-alttext" class="settings-panel active">\n    <div class="inner-content">\n        <table cols="1" width="100%" role="presentation">\n            <tr>\n                <td class="padding-large">\n                    <label class="header"><%= scope.textAltTitle %></label>\n                    <div id="table-advanced-alt-title"></div>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label class="header"><%= scope.textAltDescription %></label>\n                    <textarea id="table-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\n                </td>\n            </tr>\n            <tr>\n                <td>\n                    <label><%= scope.textAltTip %></label>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>'})),define("spreadsheeteditor/main/app/view/TableSettingsAdvanced",["text!spreadsheeteditor/main/app/template/TableSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.TableSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:257,toggleGroup:"table-adv-settings-group",properties:null,storageName:"sse-table-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-table-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this._originalProps=this.options.tableProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.inputAltTitle=new Common.UI.InputField({el:$("#table-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){if(0===e)i.inputAltTitle.focus()}),10)},afterRender:function(){if(this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t){var e=t.asc_getTitle();this.inputAltTitle.setValue(e||""),e=t.asc_getDescription(),this.textareaAltDescription.val(e||"")}},getSettings:function(){if(this.isAltTitleChanged||this.isAltDescChanged){var t=new Asc.AdvancedTableInfoSettings;return t.asc_setTitle(this.inputAltTitle.getValue()),t.asc_setDescription(this.textareaAltDescription.val()),t}},textTitle:"Table - Advanced Settings",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table."},SSE.Views.TableSettingsAdvanced||{}))})),define("text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template",[],(function(){return'<div id="id-adv-shape-width" class="settings-panel active">\r\n    <div class="inner-content">\r\n    <table cols="3" role="presentation">\r\n        <tr>\r\n            <td width="108px">\r\n                <label class="input-label"><%= scope.textWidth %></label>\r\n                <div id="shape-advanced-spin-width"></div>\r\n            </td>\r\n            <td width="28px" style="vertical-align: bottom;">\r\n                <div id="shape-advanced-button-ratio"></div>\r\n            </td>\r\n            <td width="108px">\r\n                <label class="input-label"><%= scope.textHeight %></label>\r\n                <div id="shape-advanced-spin-height"></div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-rotate" class="settings-panel active">\r\n    <div class="inner-content  padding-large">\r\n        <div style="width: 100%;">\r\n            <label class="input-label"><%= scope.textAngle %></label>\r\n            <div id="shape-advanced-spin-angle" class="margin-left-5" style="display: inline-block;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content  padding-large">\r\n        <table cols="2" role="presentation">\r\n            <tr>\r\n                <td rowspan="2" class="padding-small" style="vertical-align: top;">\r\n                    <label class="input-label margin-right-15" style="vertical-align: top;"><%= scope.textFlipped %></label>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <div id="shape-advanced-checkbox-hor"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-advanced-checkbox-vert"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-shape" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textLineStyle %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large" width="125px">\r\n                    <label class="input-label"><%= scope.textCapType %></label>\r\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-large">\r\n                    <label class="input-label"><%= scope.textJoinType %></label>\r\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="separator horizontal padding-large"></div>\r\n    <div class="inner-content">\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.textArrows %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\r\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndStyle %></label>\r\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBeginSize %></label>\r\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textEndSize %></label>\r\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-margins" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="header"><%= scope.textAutofit %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-checkbox-autofit"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <div id="shape-checkbox-overflow"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n        <div class="separator horizontal padding-large"></div>\r\n        <table cols="2" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td colspan=2 class="padding-small">\r\n                    <label class="header"><%= scope.strMargins %></label>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small" width="125px">\r\n                    <label class="input-label"><%= scope.textTop %></label>\r\n                    <div id="shape-margin-top"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textLeft %></label>\r\n                    <div id="shape-margin-left"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textBottom %></label>\r\n                    <div id="shape-margin-bottom"></div>\r\n                </td>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textRight %></label>\r\n                    <div id="shape-margin-right"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-columns" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" style="width: 100%;" role="presentation">\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textColNumber %></label>\r\n                    <div id="shape-columns-number"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <label class="input-label"><%= scope.textSpacing %></label>\r\n                    <div id="shape-columns-spacing"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-snap" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" role="presentation">\r\n            <tr>\r\n                <td class="padding-small" role="radiogroup" aria-owns="shape-radio-onecell shape-radio-absolute">\r\n                    <div id="shape-radio-twocell"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-radio-onecell"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td class="padding-small">\r\n                    <div id="shape-radio-absolute"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n<div id="id-adv-shape-alttext" class="settings-panel">\r\n    <div class="inner-content">\r\n        <table cols="1" width="100%" role="presentation">\r\n            <tr>\r\n                <td class="padding-large">\r\n                    <label class="header"><%= scope.textAltTitle %></label>\r\n                    <div id="shape-advanced-alt-title"></div>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label class="header"><%= scope.textAltDescription %></label>\r\n                    <textarea id="shape-advanced-alt-description" class="form-control" style="width: 100%; height: 70px;"></textarea>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td>\r\n                    <label><%= scope.textAltTip %></label>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'})),define("spreadsheeteditor/main/app/view/ShapeSettingsAdvanced",["text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template","common/main/lib/view/AdvancedSettingsWindow"],(function(t){"use strict";SSE.Views.ShapeSettingsAdvanced=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:300,contentHeight:270,toggleGroup:"shape-adv-settings-group",sizeOriginal:{width:0,height:0},sizeMax:{width:55.88,height:55.88},properties:null,storageName:"sse-shape-settings-adv-category"},initialize:function(e){_.extend(this.options,{title:this.textTitle,items:[{panelId:"id-adv-shape-width",panelCaption:this.textSize},{panelId:"id-adv-shape-rotate",panelCaption:this.textRotation},{panelId:"id-adv-shape-shape",panelCaption:this.textWeightArrows},{panelId:"id-adv-shape-margins",panelCaption:this.textTextBox},{panelId:"id-adv-shape-columns",panelCaption:this.strColumns},{panelId:"id-adv-shape-snap",panelCaption:this.textSnap},{panelId:"id-adv-shape-alttext",panelCaption:this.textAlt}],contentTemplate:_.template(t)({scope:this})},e),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options),this.spinners=[],this.Margins=void 0,this._nRatio=1,this._originalProps=this.options.shapeProps,this._changedProps=null},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.spnWidth=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-width"),step:.1,width:100,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnWidth.on("change",_.bind((function(t,e,i,s){if(this.btnRatio.pressed){var n=t.getNumberValue(),a=n/this._nRatio;a>this.spnHeight.options.maxValue&&(n=(a=this.spnHeight.options.maxValue)*this._nRatio,this.spnWidth.setValue(n,!0)),this.spnHeight.setValue(a,!0)}this._changedProps&&(this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue())))}),this)),this.spinners.push(this.spnWidth),this.spnHeight=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-height"),step:.1,width:100,defaultUnit:"cm",value:"3 cm",maxValue:55.88,minValue:0}),this.spnHeight.on("change",_.bind((function(t,e,i,s){var n=t.getNumberValue(),a=null;this.btnRatio.pressed&&((a=n*this._nRatio)>this.spnWidth.options.maxValue&&(n=(a=this.spnWidth.options.maxValue)/this._nRatio,this.spnHeight.setValue(n,!0)),this.spnWidth.setValue(a,!0)),this._changedProps&&(this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())),this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue())))}),this)),this.spinners.push(this.spnHeight),this.btnRatio=new Common.UI.Button({parentEl:$("#shape-advanced-button-ratio"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-advanced-ratio",style:"margin-bottom: 1px;",enableToggle:!0,hint:this.textKeepRatio}),this.btnRatio.on("click",_.bind((function(t,e){t.pressed&&this.spnHeight.getNumberValue()>0&&(this._nRatio=this.spnWidth.getNumberValue()/this.spnHeight.getNumberValue()),this._changedProps&&this._changedProps.asc_putLockAspect(t.pressed)}),this)),this.spnMarginTop=new Common.UI.MetricSpinner({el:$("#shape-margin-top"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginTop.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putTop(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginTop),this.spnMarginBottom=new Common.UI.MetricSpinner({el:$("#shape-margin-bottom"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:55.87,minValue:0}),this.spnMarginBottom.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putBottom(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginBottom),this.spnMarginLeft=new Common.UI.MetricSpinner({el:$("#shape-margin-left"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginLeft.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putLeft(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginLeft),this.spnMarginRight=new Common.UI.MetricSpinner({el:$("#shape-margin-right"),step:.1,width:100,defaultUnit:"cm",value:"0.19 cm",maxValue:9.34,minValue:0}),this.spnMarginRight.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getPaddings()&&this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings),this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putRight(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnMarginRight),this.chAutofit=new Common.UI.CheckBox({el:$("#shape-checkbox-autofit"),labelText:this.textResizeFit}),this.chAutofit.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putTextFitType("checked"==t.getValue()?AscFormat.text_fit_Auto:AscFormat.text_fit_No))}),this)),this.chOverflow=new Common.UI.CheckBox({el:$("#shape-checkbox-overflow"),labelText:this.textOverflow}),this.chOverflow.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putVertOverflowType("checked"==t.getValue()?AscFormat.nOTOwerflow:AscFormat.nOTClip))}),this)),this.spnAngle=new Common.UI.MetricSpinner({el:$("#shape-advanced-spin-angle"),step:1,width:80,defaultUnit:"",value:"0 ",maxValue:3600,minValue:-3600}),this.chFlipHor=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-hor"),labelText:this.textHorizontally}),this.chFlipVert=new Common.UI.CheckBox({el:$("#shape-advanced-checkbox-vert"),labelText:this.textVertically}),this._arrCapType=[{displayValue:this.textFlat,value:Asc.c_oAscLineCapType.Flat},{displayValue:this.textRound,value:Asc.c_oAscLineCapType.Round},{displayValue:this.textSquare,value:Asc.c_oAscLineCapType.Square}],this.cmbCapType=new Common.UI.ComboBox({el:$("#shape-advanced-cap-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrCapType,takeFocusOnClose:!0}),this.cmbCapType.setValue(Asc.c_oAscLineCapType.Flat),this.cmbCapType.on("selected",_.bind((function(t,e){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinecap(e.value))}),this)),this._arrJoinType=[{displayValue:this.textRound,value:Asc.c_oAscLineJoinType.Round},{displayValue:this.textBevel,value:Asc.c_oAscLineJoinType.Bevel},{displayValue:this.textMiter,value:Asc.c_oAscLineJoinType.Miter}],this.cmbJoinType=new Common.UI.ComboBox({el:$("#shape-advanced-join-type"),cls:"input-group-nr",menuStyle:"min-width: 100px;",editable:!1,data:this._arrJoinType,takeFocusOnClose:!0}),this.cmbJoinType.setValue(Asc.c_oAscLineJoinType.Round),this.cmbJoinType.on("selected",_.bind((function(t,e){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinejoin(e.value))}),this));var e=[],i=[];e.push({type:Asc.c_oAscLineBeginType.None,idsvg:"no-"}),e.push({type:Asc.c_oAscLineBeginType.Triangle,idsvg:""}),e.push({type:Asc.c_oAscLineBeginType.Arrow,idsvg:"open-"}),e.push({type:Asc.c_oAscLineBeginType.Stealth,idsvg:"stealth-"}),e.push({type:Asc.c_oAscLineBeginType.Diamond,idsvg:"dimond-"}),e.push({type:Asc.c_oAscLineBeginType.Oval,idsvg:"oval-"});for(var s=0;s<6;s++)e[s].value=s;for(s=0;s<9;s++)i.push({value:s,typearrow:""});for(i[0].type=Asc.c_oAscLineBeginSize.small_small,i[1].type=Asc.c_oAscLineBeginSize.small_mid,i[2].type=Asc.c_oAscLineBeginSize.small_large,i[3].type=Asc.c_oAscLineBeginSize.mid_small,i[4].type=Asc.c_oAscLineBeginSize.mid_mid,i[5].type=Asc.c_oAscLineBeginSize.mid_large,i[6].type=Asc.c_oAscLineBeginSize.large_small,i[7].type=Asc.c_oAscLineBeginSize.large_mid,i[8].type=Asc.c_oAscLineBeginSize.large_large,this.btnBeginStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href= "#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginStyle.on("item:click",_.bind(this.onSelectBeginStyle,this)),this.mnuBeginStylePicker=this.btnBeginStyle.getPicker(),this.btnBeginStyle.updateFormControl(),this.btnBeginSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-begin-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg><use xlink:href="#<%= typearrow %>arrow-<%= (value+1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnBeginSize.on("item:click",_.bind(this.onSelectBeginSize,this)),this.mnuBeginSizePicker=this.btnBeginSize.getPicker(),this.btnBeginSize.updateFormControl(),s=0;s<e.length;s++)e[s].offsety+=200;for(s=0;s<i.length;s++)i[s].offsety+=200;this.btnEndStyle=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-style"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 105px; margin: 0 5px;",store:new Common.UI.DataViewStore(e),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href="#no-arrow-5"></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= idsvg %>arrow-5"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndStyle.on("item:click",_.bind(this.onSelectEndStyle,this)),this.mnuEndStylePicker=this.btnEndStyle.getPicker(),this.btnEndStyle.updateFormControl(),this.btnEndSize=new Common.UI.ComboBoxDataView({el:$("#shape-advanced-end-size"),additionalAlign:this.menuAddAlign,cls:"combo-arrow-style move-focus",menuStyle:"min-width: 105px;",dataViewStyle:"width: 160px; margin: 0 5px;",store:new Common.UI.DataViewStore(i),formTemplate:_.template(['<div class="form-control" style="width: 100px;">','<i class="img-arrows"><svg class ="svg-mirror"><use xlink:href=""></use></svg></i>',"</div>"].join("")),itemTemplate:_.template('<div id="<%= id %>" class="item-arrow img-arrows"><svg class ="svg-mirror"><use xlink:href="#<%= typearrow %>arrow-<%= (value + 1) %>"></use></svg></div>'),takeFocusOnClose:!0,updateFormControl:this.updateFormControl}),this.btnEndSize.on("item:click",_.bind(this.onSelectEndSize,this)),this.mnuEndSizePicker=this.btnEndSize.getPicker(),this.btnEndSize.updateFormControl(),this.spnColumns=new Common.UI.MetricSpinner({el:$("#shape-columns-number"),step:1,allowDecimal:!1,width:100,defaultUnit:"",value:"1",maxValue:16,minValue:1}),this.spnColumns.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putColumnNumber(t.getNumberValue()))}),this)),this.spnSpacing=new Common.UI.MetricSpinner({el:$("#shape-columns-spacing"),step:.1,width:100,defaultUnit:"cm",value:"0 cm",maxValue:40.64,minValue:0}),this.spnSpacing.on("change",_.bind((function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),this._changedProps.asc_getShapeProperties().asc_putColumnSpace(Common.Utils.Metric.fnRecalcToMM(t.getNumberValue())))}),this)),this.spinners.push(this.spnSpacing),this.radioTwoCell=new Common.UI.RadioBox({el:$("#shape-radio-twocell"),name:"asc-radio-snap",labelText:this.textTwoCell,value:AscCommon.c_oAscCellAnchorType.cellanchorTwoCell}),this.radioTwoCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioOneCell=new Common.UI.RadioBox({el:$("#shape-radio-onecell"),name:"asc-radio-snap",labelText:this.textOneCell,value:AscCommon.c_oAscCellAnchorType.cellanchorOneCell}),this.radioOneCell.on("change",_.bind(this.onRadioSnapChange,this)),this.radioAbsolute=new Common.UI.RadioBox({el:$("#shape-radio-absolute"),name:"asc-radio-snap",labelText:this.textAbsolute,value:AscCommon.c_oAscCellAnchorType.cellanchorAbsolute}),this.radioAbsolute.on("change",_.bind(this.onRadioSnapChange,this)),this.inputAltTitle=new Common.UI.InputField({el:$("#shape-advanced-alt-title"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}).on("changed:after",(function(){t.isAltTitleChanged=!0})),this.textareaAltDescription=this.$window.find("textarea"),this.textareaAltDescription.keydown((function(e){e.keyCode==Common.UI.Keys.RETURN&&e.stopPropagation(),t.isAltDescChanged=!0})),this.afterRender()},getFocusedComponents:function(){return this.btnsCategory.concat([this.spnWidth,this.btnRatio,this.spnHeight,this.spnAngle,this.chFlipHor,this.chFlipVert,this.cmbCapType,this.cmbJoinType,this.btnBeginStyle,this.btnEndStyle,this.btnBeginSize,this.btnEndSize,this.chAutofit,this.chOverflow,this.spnMarginTop,this.spnMarginLeft,this.spnMarginBottom,this.spnMarginRight,this.spnColumns,this.spnSpacing,this.radioTwoCell,this.radioOneCell,this.radioAbsolute,this.inputAltTitle,this.textareaAltDescription]).concat(this.getFooterButtons())},onCategoryClick:function(t,e){Common.Views.AdvancedSettingsWindow.prototype.onCategoryClick.call(this,t,e);var i=this;setTimeout((function(){switch(e){case 0:i.spnWidth.focus();break;case 1:i.spnAngle.focus();break;case 2:i.cmbCapType.focus();break;case 3:i.spnMarginTop.focus();break;case 4:i.spnColumns.focus();break;case 5:i.radioTwoCell.focus();break;case 6:i.inputAltTitle.focus()}}),10)},afterRender:function(){if(this.updateMetricUnit(),this._setDefaults(this._originalProps),this.storageName){var t=Common.localStorage.getItem(this.storageName);this.setActiveCategory(null!==t?parseInt(t):0)}},_setDefaults:function(t){if(t&&t.asc_getShapeProperties()){var e=t.asc_getShapeProperties();e.asc_getFromSmartArt()&&this.btnsCategory[1].setDisabled(!0),e.asc_getFromSmartArtInternal()&&(this.chAutofit.setDisabled(!0),this.chOverflow.setDisabled(!0),this.chFlipHor.setDisabled(!0),this.chFlipVert.setDisabled(!0),this.btnsCategory[0].setDisabled(!0)),this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getWidth()).toFixed(2),!0),this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(t.asc_getHeight()).toFixed(2),!0),t.asc_getHeight()>0&&(this._nRatio=t.asc_getWidth()/t.asc_getHeight());var i=t.asc_getLockAspect();this.btnRatio.toggle(i||e.asc_getFromSmartArt()),this.btnRatio.setDisabled(!!e.asc_getFromSmartArt()),this._setShapeDefaults(e);var s=e.asc_getPaddings();if(s){var n=s.asc_getLeft();this.spnMarginLeft.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.asc_getTop(),this.spnMarginTop.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.asc_getRight(),this.spnMarginRight.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0),n=s.asc_getBottom(),this.spnMarginBottom.setValue(null!=n?Common.Utils.Metric.fnRecalcFromMM(n):"",!0)}this.btnsCategory[3].setDisabled(null===s),this.chAutofit.setValue(e.asc_getTextFitType()==AscFormat.text_fit_Auto),this.chOverflow.setValue(e.asc_getVertOverflowType()==AscFormat.nOTOwerflow);var a=e.asc_getType();switch(this.btnsCategory[4].setDisabled(e.asc_getFromSmartArtInternal()||"line"==a||"bentConnector2"==a||"bentConnector3"==a||"bentConnector4"==a||"bentConnector5"==a||"curvedConnector2"==a||"curvedConnector3"==a||"curvedConnector4"==a||"curvedConnector5"==a||"straightConnector1"==a),i=e.asc_getColumnNumber(),this.spnColumns.setValue(null!=i?i:"",!0),i=e.asc_getColumnSpace(),this.spnSpacing.setValue(null!=i?Common.Utils.Metric.fnRecalcFromMM(i):"",!0),i=t.asc_getTitle(),this.inputAltTitle.setValue(i||""),i=t.asc_getDescription(),this.textareaAltDescription.val(i||""),i=t.asc_getRot(),this.spnAngle.setValue(null==i||null===i?"":Math.floor(180*i/3.14159265358979+.5),!0),this.chFlipHor.setValue(t.asc_getFlipH()),this.chFlipVert.setValue(t.asc_getFlipV()),i=t.asc_getAnchor()){case AscCommon.c_oAscCellAnchorType.cellanchorTwoCell:this.radioTwoCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorOneCell:this.radioOneCell.setValue(!0,!0);break;case AscCommon.c_oAscCellAnchorType.cellanchorAbsolute:this.radioAbsolute.setValue(!0,!0)}this._changedProps=new Asc.asc_CImgProperty}},getSettings:function(){return this.isAltTitleChanged&&this._changedProps.asc_putTitle(this.inputAltTitle.getValue()),this.isAltDescChanged&&this._changedProps.asc_putDescription(this.textareaAltDescription.val()),this._changedProps.asc_putRot(3.14159265358979*this.spnAngle.getNumberValue()/180),this._changedProps.asc_putFlipH("checked"==this.chFlipHor.getValue()),this._changedProps.asc_putFlipV("checked"==this.chFlipVert.getValue()),{shapeProps:this._changedProps}},_setShapeDefaults:function(t){if(t){var e=t.asc_getStroke();if(e){this.btnsCategory[2].setDisabled(e.asc_getType()==Asc.c_oAscStrokeType.STROKE_NONE);for(var i=e.asc_getLinejoin(),s=0;s<this._arrJoinType.length;s++)if(i==this._arrJoinType[s].value){this.cmbJoinType.setValue(i);break}for(i=e.asc_getLinecap(),s=0;s<this._arrCapType.length;s++)if(i==this._arrCapType[s].value){this.cmbCapType.setValue(i);break}var n=e.asc_getCanChangeArrows();if(this.btnBeginStyle.setDisabled(!n),this.btnEndStyle.setDisabled(!n),this.btnBeginSize.setDisabled(!n),this.btnEndSize.setDisabled(!n),n){i=e.asc_getLinebeginsize();var a=this.mnuBeginSizePicker.store.findWhere({type:i});a?this._beginSizeIdx=a.get("value"):(this._beginSizeIdx=null,this.btnBeginSize.updateFormControl()),i=e.asc_getLinebeginstyle(),a=this.mnuBeginStylePicker.store.findWhere({type:i}),this.btnBeginStyle.selectRecord(a),a&&this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,a,this._beginSizeIdx),i=e.asc_getLineendsize(),(a=this.mnuEndSizePicker.store.findWhere({type:i}))?this._endSizeIdx=a.get("value"):(this._endSizeIdx=null,this.btnEndSize.updateFormControl()),i=e.asc_getLineendstyle(),a=this.mnuEndStylePicker.store.findWhere({type:i}),this.btnEndStyle.selectRecord(a),a&&this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,a,this._endSizeIdx)}}}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){var e=this.spinners[t];e.setDefaultUnit(Common.Utils.Metric.getCurrentMetricName()),e.setStep(Common.Utils.Metric.getCurrentMetric()==Common.Utils.Metric.c_MetricUnits.pt?1:.01)}this.sizeMax={width:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.width),height:Common.Utils.Metric.fnRecalcFromMM(10*this.options.sizeMax.height)},this.options.sizeOriginal&&(this.sizeOriginal={width:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),height:Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)})},_updateSizeArr:function(t,e,i,s){i.get("value")>0?(e.store.each((function(t){t.set({typearrow:i.get("idsvg")})}),this),t.setDisabled(!1),t.selectRecord(null!==s?e.store.at(s):null)):(t.updateFormControl(),t.setDisabled(!0))},updateFormControl:function(t){var e=$(this.el).find(".form-control > .img-arrows use");if(e.length){var i="";if(t){var s=t.get("idsvg");i=void 0!==s?s+"arrow-5":t.get("typearrow")+"arrow-"+(t.get("value")+1)}e[0].setAttribute("xlink:href","#"+i)}},onSelectBeginStyle:function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginstyle(s.get("type"))),null!==this._beginSizeIdx&&void 0!==this._beginSizeIdx||(this._beginSizeIdx=4),this._updateSizeArr(this.btnBeginSize,this.mnuBeginSizePicker,s,this._beginSizeIdx)},onSelectBeginSize:function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginsize(s.get("type"))),this._beginSizeIdx=s.get("value")},onSelectEndStyle:function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendstyle(s.get("type"))),null!==this._endSizeIdx&&void 0!==this._endSizeIdx||(this._endSizeIdx=4),this._updateSizeArr(this.btnEndSize,this.mnuEndSizePicker,s,this._endSizeIdx)},onSelectEndSize:function(t,e,i,s){this._changedProps&&(null!==this._changedProps.asc_getShapeProperties()&&void 0!==this._changedProps.asc_getShapeProperties()||this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty),null===this._changedProps.asc_getShapeProperties().asc_getStroke()&&this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke),this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendsize(s.get("type"))),this._endSizeIdx=s.get("value")},onRadioSnapChange:function(t,e,i){e&&this._changedProps&&this._changedProps.asc_putAnchor(t.options.value)},textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textSize:"Size",textWidth:"Width",textHeight:"Height",textKeepRatio:"Constant Proportions",textTitle:"Shape - Advanced Settings",strMargins:"Text Padding",textRound:"Round",textMiter:"Miter",textSquare:"Square",textFlat:"Flat",textBevel:"Bevel",textArrows:"Arrows",textLineStyle:"Line Style",textCapType:"Cap Type",textJoinType:"Join Type",textBeginStyle:"Begin Style",textBeginSize:"Begin Size",textEndStyle:"End Style",textEndSize:"End Size",textWeightArrows:"Weights & Arrows",textAlt:"Alternative Text",textAltTitle:"Title",textAltDescription:"Description",textAltTip:"The alternative text-based representation of the visual object information, which will be read to the people with vision or cognitive impairments to help them better understand what information there is in the image, autoshape, chart or table.",strColumns:"Columns",textSpacing:"Spacing between columns",textColNumber:"Number of columns",textRotation:"Rotation",textAngle:"Angle",textFlipped:"Flipped",textHorizontally:"Horizontally",textVertically:"Vertically",textSnap:"Cell Snapping",textAbsolute:"Don't move or size with cells",textOneCell:"Move but don't size with cells",textTwoCell:"Move and size with cells",textTextBox:"Text Box",textAutofit:"AutoFit",textResizeFit:"Resize shape to fit text",textOverflow:"Allow text to overflow shape"},SSE.Views.ShapeSettingsAdvanced||{}))})),define("spreadsheeteditor/main/app/view/ProtectDialog",[],(function(){"use strict";SSE.Views.ProtectDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{title:t.title?t.title:"sheet"==t.type?this.txtSheetTitle:this.txtWBTitle,cls:"modal-dlg",width:"sheet"==t.type?380:350,height:"auto",buttons:t.buttons?t.buttons:[{value:"ok",caption:this.txtProtect},"cancel"]},t),this.handler=t.handler,this.txtDescription=t.txtDescription||"",this.type=t.type||"workbook",this.props=t.props,this.names=t.names,this.isEdit=t.isEdit,this.api=t.api,this.winId=Common.UI.getId(),this.template=t.template||['<div class="box">','<% if (type=="range") { %>','<div class="input-row">',"<label>"+e.txtRangeName+"</label>","</div>",'<div id="'+e.winId+'-id-range-name-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRange+"</label>","</div>",'<div id="'+e.winId+'-id-range-txt" class="input-row" style="margin-bottom: 10px;"></div>','<% } else if (type=="sheet") { %>','<div class="" style="margin-bottom: 10px;">',"<label>"+e.txtSheetDescription+" "+e.txtAllowDescription+"</label>","</div>",'<button type="button" class="btn btn-text-default auto" id="'+e.winId+'-id-range-btn-allow" style="min-width: 100px;margin-bottom: 15px;">'+e.txtAllowRanges+"</button>","<% } else { %>",'<div class="" style="margin-bottom: 10px;">',"<label>"+e.txtWBDescription+"</label>","</div>","<% } %>",'<% if (type=="sheet") { %>','<table cols="2" style="width: 100%;">',"<tr>",'<td class="padding-right-5" style="width:50%;">','<label class="input-label">'+e.txtPassword+" ("+e.txtOptional+")</label>",'<div id="'+e.winId+'-id-password-txt" class="input-row" style="width: 100%;margin-bottom: 10px;"></div>',"</td>",'<td class="padding-left-5" style="width:50%;">','<label class="input-label">'+e.txtRepeat+"</label>",'<div id="'+e.winId+'-id-repeat-txt" class="input-row" style="width: 100%;margin-bottom: 10px;"></div>',"</td>","</tr>","<tr>",'<td colspan="2" style="padding-bottom: 10px;">','<label class="light">'+e.txtWarning+"</label>","</td>","</tr>","</table>",'<div class="input-row">',"<label>"+e.txtAllow+"</label>","</div>",'<div id="'+e.winId+'-protect-dlg-options" class="" style="width: 100%; height: 116px; overflow: hidden;"></div>',"<% } else { %>",'<div class="input-row">',"<label>"+e.txtPassword+" ("+e.txtOptional+")</label>","</div>",'<div id="'+e.winId+'-id-password-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRepeat+"</label>","</div>",'<div id="'+e.winId+'-id-repeat-txt" class="input-row" style="margin-bottom: 10px;"></div>','<label class="light">'+e.txtWarning+"</label>","<% } %>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.repeatPwd=new Common.UI.InputField({el:$("#"+this.winId+"-id-repeat-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validation:function(e){return t.txtIncorrectPwd}}),this.inputPwd=new Common.UI.InputFieldBtnPassword({el:$("#"+this.winId+"-id-password-txt"),type:"password",allowBlank:!0,style:"width: 100%;",maxLength:255,validateOnBlur:!1,repeatInput:this.repeatPwd,showPwdOnClick:!1}),"sheet"==this.type&&(this.optionsList=new Common.UI.ListView({el:$("#"+this.winId+"-protect-dlg-options",this.$window),store:new Common.UI.DataViewStore,simpleAddMode:!0,scrollAlwaysVisible:!0,template:_.template(['<div class="listview inner protect-sheet-options" style=""></div>'].join("")),itemTemplate:_.template(['<div class="has-checkbox">',Common.UI.CheckBoxTemplate,'<div id="<%= id %>" class="list-item margin-left-20">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>',"</div>","</div>"].join("")),tabindex:1}),this.optionsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.optionsList.onKeyDown=_.bind(this.onListKeyDown,this),this.optionsList.on("entervalue",_.bind(this.onPrimary,this)),this.btnAllowRanges=new Common.UI.Button({el:$("#"+this.winId+"-id-range-btn-allow",this.$window)}),this.btnAllowRanges.on("click",_.bind(this.onAllowRangesClick,this,!1))),"range"==this.type&&(this.inputRangeName=new Common.UI.InputField({el:$("#"+this.winId+"-id-range-name-txt"),allowBlank:!1,blankError:this.txtEmpty,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validateOnChange:!1,validation:function(e){if(""==e)return!0;switch(t.api.asc_checkProtectedRangeName(e)){case Asc.c_oAscDefinedNameReason.WrongName:return t.textInvalidName;case Asc.c_oAscDefinedNameReason.Existed:return!(!t.isEdit||t.props.asc_getName().toLowerCase()!=e.toLowerCase())||t.textExistName;case Asc.c_oAscDefinedNameReason.OK:return!!(t.names.indexOf(e.toLowerCase())<0||t.isEdit&&t.props.asc_getName().toLowerCase()==e.toLowerCase())||t.textExistName;default:return t.textInvalidName}}}),this.txtDataRange=new Common.UI.InputFieldBtn({el:$("#"+this.winId+"-id-range-txt"),name:"range",style:"width: 100%;",allowBlank:!1,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validateOnBlur:!1,validation:function(e){return t.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,e,!0)!==Asc.c_oAscError.ID.DataRangeError||t.textInvalidRange}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this))),this.afterRender()},getFocusedComponents:function(){var t=[];return"range"==this.type&&(t=t.concat([this.inputRangeName,this.txtDataRange])),t=t.concat([this.inputPwd,this.repeatPwd]),"sheet"==this.type&&(t=[this.btnAllowRanges].concat(t).concat([this.optionsList])),t.concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return"range"==this.type?this.inputRangeName:this.inputPwd},afterRender:function(){this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(this.inputRangeName&&!0!==this.inputRangeName.checkValidate())return void this.inputRangeName.focus();if(this.txtDataRange&&!0!==this.txtDataRange.checkValidate())return void this.txtDataRange.focus();if(!0!==this.inputPwd.checkValidate())return void this.inputPwd.focus();if(this.inputPwd.getValue()!==this.repeatPwd.getValue())return this.repeatPwd.checkValidate(),void this.repeatPwd.focus()}this.handler.call(this,t,this.inputPwd.getValue(),"ok"==t?this.getSettings():void 0)}this.close()},_setDefaults:function(t){this.optionsList&&this.updateOptionsList(t),"range"==this.type&&this.updateRangeSettings(t)},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},onCellCheck:function(t,e,i){if(!this.checkCellTrigerBlock){var s="",n=!1,a=null,o=window.event?window.event:window._event;if(o){if((s=$(o.currentTarget).find(".list-item")).length){a=Common.Utils.getBoundingClientRect(s.get(0));var l=o.clientX*Common.Utils.zoom(),r=o.clientY*Common.Utils.zoom();a.left<l&&l<a.right&&a.top<r&&r<a.bottom&&(n=!0)}(n||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay((function(){t.focus()}),100,this))}}},onListKeyDown:function(t,e){var i=this.optionsList;i.disabled||(_.isUndefined(void 0)&&(e=t),e.keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.DataView.prototype.onKeyDown.call(this.optionsList,t,e))},updateCellCheck:function(t,e){e&&t&&(e.set("check",!e.get("check")),"SelectLockedCells"==e.get("optionName")&&e.get("check")&&this.optionsList.store.findWhere({optionName:"SelectUnlockedCells"}).set("check",!0),"SelectUnlockedCells"!=e.get("optionName")||e.get("check")||this.optionsList.store.findWhere({optionName:"SelectLockedCells"}).set("check",!1))},updateRangeSettings:function(t){t&&(this.inputRangeName.setValue(t.asc_getName()),this.txtDataRange.setValue(t.asc_getSqref()))},updateOptionsList:function(t){var e=[{value:this.txtSelLocked,optionName:"SelectLockedCells"},{value:this.txtSelUnLocked,optionName:"SelectUnlockedCells"},{value:this.txtFormatCells,optionName:"FormatCells"},{value:this.txtFormatCols,optionName:"FormatColumns"},{value:this.txtFormatRows,optionName:"FormatRows"},{value:this.txtInsCols,optionName:"InsertColumns"},{value:this.txtInsRows,optionName:"InsertRows"},{value:this.txtInsHyper,optionName:"InsertHyperlinks"},{value:this.txtDelCols,optionName:"DeleteColumns"},{value:this.txtDelRows,optionName:"DeleteRows"},{value:this.txtSort,optionName:"Sort"},{value:this.txtAutofilter,optionName:"AutoFilter"},{value:this.txtPivot,optionName:"PivotTables"},{value:this.txtObjs,optionName:"Objects"},{value:this.txtScen,optionName:"Scenarios"}],i=[];e.forEach((function(e,s){i.push(new Common.UI.DataViewModel({selected:!1,allowSelected:!0,value:e.value,optionName:e.optionName,check:!(!t||!t["asc_get"+e.optionName])&&!t["asc_get"+e.optionName]()}))})),this.optionsList.store.reset(i),this.optionsList.scroller.update({minScrollbarLength:this.optionsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},getSettings:function(){return"sheet"==this.type?this.getSheetSettings():"range"==this.type?this.getRangeSettings():void 0},getSheetSettings:function(){var t=this.props?this.props:new Asc.CSheetProtection;return this.optionsList.store.each((function(e,i){t&&t["asc_set"+e.get("optionName")]&&t["asc_set"+e.get("optionName")](!e.get("check"))})),t},getRangeSettings:function(){var t=this.props?this.props:new Asc.CProtectedRange;return t.asc_setName(this.inputRangeName.getValue()),t.asc_setSqref(this.txtDataRange.getValue()),t},onSelectData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.dataRangeValid=e.getSettings(),t.txtDataRange.setValue(t.dataRangeValid),t.txtDataRange.checkValidate())}}).on("close",(function(){t.show(),_.delay((function(){t.txtDataRange.focus()}),1)})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtDataRange.getValue())||1!=t.txtDataRange.checkValidate()?t.dataRangeValid:t.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.ConditionalFormattingRule,validation:function(){return!0}})}},onAllowRangesClick:function(){var t=this,e=Common.Utils.getOffset(t.$window),i=t.api.asc_getProtectedRanges(),s=new SSE.Views.ProtectRangesDlg({api:t.api,props:i,handler:function(e,i){"ok"==e&&t.api.asc_setProtectedRanges(i.arr,i.deletedArr)}}).on("close",(function(){t.show(),setTimeout((function(){t.getDefaultFocusableComponent().focus()}),100)}));t.hide(),s.show(e.left-65,e.top+45)},txtPassword:"Password",txtRepeat:"Repeat password",txtIncorrectPwd:"Confirmation password is not identical",txtWarning:"Warning: If you lose or forget the password, it cannot be recovered. Please keep it in a safe place.",txtOptional:"optional",txtProtect:"Protect",txtSelLocked:"Select locked cells",txtSelUnLocked:"Select unlocked cells",txtFormatCells:"Format cells",txtFormatCols:"Format columns",txtFormatRows:"Format rows",txtInsCols:"Insert columns",txtInsRows:"Insert rows",txtInsHyper:"Insert hyperlink",txtDelCols:"Delete columns",txtDelRows:"Delete rows",txtSort:"Sort",txtAutofilter:"Use AutoFilter",txtPivot:"Use PivotTable and PivotChart",txtObjs:"Edit objects",txtScen:"Edit scenarios",txtWBDescription:"To prevent other users from viewing hidden worksheets, adding, moving, deleting, or hiding worksheets and renaming worksheets, you can protect the structure of your workbook with a password.",txtWBTitle:"Protect Workbook structure",txtSheetDescription:"Prevent unwanted changes from others by limiting their ability to edit.",txtSheetTitle:"Protect Sheet",txtAllow:"Allow all users of this sheet to",txtRangeName:"Title",txtRange:"Range",txtEmpty:"This field is required",textSelectData:"Select Data",textInvalidRange:"ERROR! Invalid cells range",textInvalidName:"The range title must begin with a letter and may only contain letters, numbers, and spaces.",textExistName:"ERROR! Range with such a title already exists",txtAllowRanges:"Allow edit ranges",txtAllowDescription:"You can unlock specific ranges for editing."},SSE.Views.ProtectDialog||{}))})),define("spreadsheeteditor/main/app/view/ProtectedRangesEditDlg",[],(function(){"use strict";var t=Common.UI.DataViewItem.extend({initialize:function(t){Common.UI.BaseView.prototype.initialize.call(this,t);var e=this;e.template=e.options.template||e.template,e.listenTo(e.model,"change:selected",(function(){(e.$el||$(e.el)).toggleClass("selected",e.model.get("selected")&&e.model.get("allowSelected")),e.onSelectChange(e.model,e.model.get("selected")&&e.model.get("allowSelected"))})),e.listenTo(e.model,"remove",e.remove)}});SSE.Views.ProtectedRangesEditDlg=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{title:t.title,cls:"modal-dlg",width:300,height:"auto",buttons:["ok","cancel"]},t),this.handler=t.handler,this.props=t.props,this.isEdit=t.isEdit,this.api=t.api,this.currentUser=t.currentUser,this.canRequestUsers=t.canRequestUsers,this.template=t.template||['<div class="box">','<div class="input-row">',"<label>"+e.txtRangeName+"</label>","</div>",'<div id="id-protected-range-name-txt" class="input-row" style="margin-bottom: 5px;"></div>','<div class="input-row">',"<label>"+e.txtRange+"</label>","</div>",'<div id="id-protected-range-txt" class="input-row" style="margin-bottom: 8px;"></div>','<div class="input-row">','<label class="font-weight-bold">'+e.txtAccess+"</label>","</div>",'<div id="id-protected-range-cmb-user" class="input-row input-group-nr" style="margin-bottom: 8px;"></div>','<div id="id-protected-range-list-user" class="input-group-nr no-borders" style="height: 143px;"></div>',"</div>"].join(""),i.tpl=_.template(this.template)(i),this._userSearch={str:"",from:0,count:100,total:void 0,requestNext:void 0},this._initSettings=!0,Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this);var e=this;this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.inputRangeName=new Common.UI.InputField({el:this.$window.find("#id-protected-range-name-txt"),allowBlank:!1,blankError:this.txtEmpty,style:"width: 100%;",maxLength:255,validateOnBlur:!1,validateOnChange:!1,validation:function(t){return""==t||(e.api.asc_checkUserProtectedRangeName(t)===Asc.c_oAscDefinedNameReason.OK||e.textInvalidName)}}),this.txtDataRange=new Common.UI.InputFieldBtn({el:this.$window.find("#id-protected-range-txt"),name:"range",style:"width: 100%;",allowBlank:!1,btnHint:this.textSelectData,blankError:this.txtEmpty,validateOnChange:!0,validateOnBlur:!1,validation:function(t){return e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!0)!==Asc.c_oAscError.ID.DataRangeError||e.textInvalidRange}}),this.txtDataRange.on("button:click",_.bind(this.onSelectData,this)),this.cmbUser=new Common.UI.ComboBox({el:this.$window.find("#id-protected-range-cmb-user"),cls:"input-group-nr",menuStyle:"min-width: 100%;max-height: 233px;",editable:!0,data:[],placeHolder:this.txtYouCanEdit,disabled:!0,takeFocusOnClose:!0,itemsTemplate:_.template(["<% _.each(items, function(item) { %>",'<li id="<%= item.id %>" data-value="<%- item.value %>" <% if (item.hasDivider) { %> class="border-top" <% } %>><a tabindex="-1" type="menuitem" style ="display: flex; flex-direction: column;">','<label><%= scope.getDisplayValue(item) %></label><label class="comment-text"><%= Common.Utils.String.htmlEncode(item.value) %></label></a></li>',"<% }); %>"].join(""))}),this.cmbUser.on("selected",this.onUserSelected.bind(this)),this.cmbUser.on("changing",this.onUserChanging.bind(this)),this.cmbUser.on("show:after",_.bind(this.onCmbUserOpen,this)),this.cmbUser.on("show:before",_.bind(this.onCmbUserBeforeOpen,this)),this.cmbUser.on("hide:after",_.bind(this.onCmbUserAfterHide,this)),Common.Utils.isChrome&&this.cmbUser._input&&this.cmbUser._input.attr("autocomplete","1"),this.listUser=new Common.UI.ListView({el:this.$window.find("#id-protected-range-list-user"),store:new Common.UI.DataViewStore,itemTemplate:_.template(['<div id="<%= id %>" class="list-item" style="width: 100%;display:inline-block;">','<div class="color"',"<% if (!!avatar) { %>",'style="background-image: url(<%=avatar%>); <% if (usercolor!==null) { %> border-color:<%=usercolor%>; border-style:solid;<% }%>"',"<% } else { %>",'style="background-color: <% if (usercolor!==null) { %> <%=usercolor%> <% } else { %> #cfcfcf <% }%>;"',"<% } %>","><% if (!avatar) { %><%-initials%><% } %></div>",'<div class="" style="width:190px;display: inline-block;vertical-align: middle;">',"<% if (!!email) { %>",'<div class="font-weight-bold" style="overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(displayName) %></div>','<div style="overflow: hidden; text-overflow: ellipsis;white-space: pre;"><%= Common.Utils.String.htmlEncode(email) %></div>',"<% } else { %>",'<div class="font-weight-bold" style="overflow: hidden; text-overflow: ellipsis;white-space: pre;max-height:30px;"><%=  Common.Utils.String.htmlEncode(displayName) %></div>',"<% } %>","</div>",'<div class="listitem-icon"></div>',"</div>"].join("")),emptyText:"",tabindex:1}),this.listUser.createNewItem=function(e){return new t({template:this.itemTemplate,model:e})},this.listUser.on("item:keydown",_.bind(this.onKeyDown,this)),this.listUser.on("item:add",_.bind(this.addControls,this)),this.listUser.on("item:change",_.bind(this.addControls,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputRangeName,this.txtDataRange,this.cmbUser,this.listUser].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputRangeName},close:function(){this.canRequestUsers&&Common.NotificationCenter.off("mentions:setusers",this.binding.onUserMenuCallback),Common.UI.Window.prototype.close.apply(this,arguments)},afterRender:function(){this.canRequestUsers&&(this.binding||(this.binding={}),this.binding.onUserMenuCallback=_.bind(this.onUserMenuCallback,this),Common.NotificationCenter.on("mentions:setusers",this.binding.onUserMenuCallback)),this._setDefaults(this.props)},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){if(this.handler){if("ok"==t){if(this.inputRangeName&&!0!==this.inputRangeName.checkValidate())return void this.inputRangeName.focus();if(this.txtDataRange&&!0!==this.txtDataRange.checkValidate())return void this.txtDataRange.focus()}this.handler.call(this,t,this.getSettings())}this.close()},_setDefaults:function(t){if(t){this.inputRangeName.setValue(t.asc_getName()),this.txtDataRange.setValue(t.asc_getRef()),this.listUser.store.add({value:this.currentUser.id,name:this.currentUser.name,displayName:this.currentUser.name+" ("+this.textYou+")",initials:Common.Utils.getUserInitials(this.currentUser.name),avatar:Common.UI.ExternalUsers.getImage(this.currentUser.id),usercolor:Common.UI.ExternalUsers.getColor(this.currentUser.id),email:"",type:Asc.c_oSerUserProtectedRangeType.edit,isCurrent:!0}),this.listUser.store.add({value:null,name:this.textAnyone,displayName:this.textAnyone,initials:Common.Utils.getUserInitials(this.textAnyone),avatar:"",usercolor:null,email:"",type:t.asc_getType()||Asc.c_oSerUserProtectedRangeType.notView,isAnyone:!0});var e=this,i=this.props.asc_getUsers();if(i&&i.length>0){var s=e.listUser.store,n=1;i.forEach((function(t){var i=t.asc_getName()||e.textAnonymous;t.asc_getId()!==e.currentUser.id&&s.add({value:t.asc_getId(),name:i,displayName:i+" "+n++,initials:Common.Utils.getUserInitials(i),avatar:Common.UI.ExternalUsers.getImage(t.asc_getId()),usercolor:Common.UI.ExternalUsers.getColor(t.asc_getId()),email:"",type:t.asc_getType(),initSettings:!0})}))}this.onUserMenu("",!0)}},getSettings:function(){var t=new Asc.CUserProtectedRange;t.asc_setName(this.inputRangeName.getValue()),t.asc_setRef(this.txtDataRange.getValue());var e=[];return this.listUser.store.each((function(i){if(i.get("isAnyone"))t.asc_setType(i.get("type"));else{var s=new Asc.CUserProtectedRangeUserInfo;s.asc_setId(i.get("value")),s.asc_setName(i.get("name")),s.asc_setType(i.get("type")),e.push(s)}})),t.asc_setUsers(e),t},onSelectData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){"ok"==i&&(t.dataRangeValid=e.getSettings(),t.txtDataRange.setValue(t.dataRangeValid),t.txtDataRange.checkValidate())}}).on("close",(function(){t.show(),_.delay((function(){t.txtDataRange.focus()}),1)})),i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.txtDataRange.getValue())||1!=t.txtDataRange.checkValidate()?t.dataRangeValid:t.txtDataRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart,validation:function(){return!0}})}},onUserSelected:function(t,e,i){var s=this.listUser.store,n=e.userId;void 0!==n&&""!==n&&(s.findWhere({value:n})||s.add({value:n,name:e.displayValue,displayName:e.displayValue,initials:Common.Utils.getUserInitials(e.displayValue),avatar:Common.UI.ExternalUsers.getImage(n)||e.image||"",usercolor:Common.UI.ExternalUsers.getColor(n),email:e.value,type:Asc.c_oSerUserProtectedRangeType.edit}));this.cmbUser.setRawValue(this._userSearch.str)},onCmbUserAfterHide:function(t,e,i){this._forceOpen=!1},onUserChanging:function(t,e){if(clearTimeout(this.timerUserList),!Common.Utils.isIE||""!==e||this._userSearch.str!==e){this._userSearch.str=e;var i=this;this.timerUserList=setTimeout((function(){i.onUserMenu(e)}),300)}},onCmbUserBeforeOpen:function(t,e,i){t.store.length<1&&(e.preventDefault(),this.onUserMenu(this.cmbUser.getRawValue()))},onCmbUserOpen:function(t,e,i){this.onUserMenu(this.cmbUser.getRawValue())},onUserMenu:function(t,e){this._forceOpen=!e,clearTimeout(this.timerUserList),"string"==typeof t&&(this.userSearch={str:t,from:0,count:100,total:void 0,requestNext:void 0,scrollTop:0},Common.UI.ExternalUsers.get("protect",void 0,this.userSearch.from,this.userSearch.count,this.userSearch.str))},onUserMenuNext:function(){var t=this.userSearch;t&&void 0!==t.total&&t.from+t.count<t.total&&(t.from+=t.count,Common.UI.ExternalUsers.get("protect",void 0,t.from,t.count,t.str))},onUserMenuCallback:function(t,e,i){if("protect"===t){var s=this,n=this.userSearch.from,a=void 0===i;if(this._initSettings&&(e&&_.find(e,(function(t){return void 0!==t.id&&null!==t.id}))&&(s.cmbUser.setDisabled(!1),s.cmbUser._input&&s.cmbUser._input.attr("placeholder",s.userPlaceholder)),!a&&this.cmbUser.cmpEl.find("ul").on("scroll",(function(t){s.userSearch&&s.userSearch.requestNext>0&&s.userSearch.requestNext<$(t.target).scrollTop()&&(s.userSearch.scrollTop=$(t.target).scrollTop(),s.userSearch.requestNext=-1,s.onUserMenuNext())})),this._initSettings=!1),this.listUser.store.findWhere({initSettings:!0})&&e&&e.length>0&&this.listUser.store.each((function(t){if(t.get("value")!==s.currentUser.id&&t.get("initSettings")){var i=_.findWhere(e,{id:t.get("value")});i&&(i.name&&t.set("name",i.name),i.name&&t.set("displayName",i.name),i.email&&t.set("email",i.email),i.image&&t.set("avatar",i.image),t.set("initSettings",!1))}})),this._forceOpen||this.cmbUser.isMenuOpen()){var o=[],l=this.cmbUser.getRawValue();if(this.userSearch.total=i,a&&(this.userSearch=null),e&&e.length>0){if(a){var r=l.toLowerCase();e=_.filter(e,(function(t){if(void 0!==t.id&&null!==t.id&&(!r||t.email&&0===t.email.toLowerCase().indexOf(r)))return!0;for(var e=t.name?t.name.toLowerCase().split(" "):[],i=!1,s=0;s<e.length;s++)if(0===e[s].indexOf(r)){i=!0;break}return void 0!==t.id&&null!==t.id&&i}))}var c=!1;_.each(e,(function(t,e){o.push({value:t.email||"",displayValue:t.name||"",userId:t.id,image:t.image,hasDivider:!t.hasAccess&&!c&&e>0}),t.image&&!Common.UI.ExternalUsers.getImage(t.id)&&Common.UI.ExternalUsers.setImage(t.id,t.image),t.hasAccess||(c=!0)}))}a||0===n?this.cmbUser.setData(o):(this.cmbUser.store.add(o),this.cmbUser.onResetItems(),this.cmbUser.scroller.scrollTop(this.userSearch.scrollTop)),this.cmbUser.setRawValue(l),o.length>0?this.cmbUser.openMenu(0,(function(){a||(s.userSearch.requestNext=s.cmbUser.store.length<s.userSearch.total?(1-10/s.cmbUser.store.length)*s.cmbUser.scroller.cmpEl.get(0).scrollHeight:-1)})):(this.cmbUser.closeMenu(),this.cmbUser.focus())}}},onKeyDown:function(t,e,i){if(i.keyCode===Common.UI.Keys.DELETE)this.onDeleteUser();else if(i.keyCode===Common.UI.Keys.SPACE){var s=this.listUser.getSelectedRec(),n=s&&!s.get("isCurrent")?s.get("btnEdit"):null;n&&$("button",n.cmpEl).click()}},onDeleteUser:function(t){!t&&(t=this.listUser.getSelectedRec()),!t||t.get("isCurrent")||t.get("isAnyone")||this.listUser.store.remove(t);var e=this;setTimeout((function(){e.listUser.focus()}),1)},addControls:function(t,e,i){if(i){var s=this,n=i.get("type"),a=new Common.UI.Button({parentEl:$(".listitem-icon",$(e.el)),cls:"btn-toolbar",iconCls:"toolbar__icon "+(n===Asc.c_oSerUserProtectedRangeType.edit?"btn-edit":n===Asc.c_oSerUserProtectedRangeType.view?"btn-sheet-view":"btn-hide-password"),disabled:!!i.get("isCurrent"),menu:!i.get("isCurrent")&&new Common.UI.Menu({style:"min-width: auto;",additionalAlign:this.menuAddAlign,items:i.get("isAnyone")?[{caption:this.textCanView,value:"view",iconCls:"menu__icon btn-sheet-view"},{caption:this.textCantView,value:"notview",iconCls:"menu__icon btn-hide-password"}]:[{caption:this.textCanEdit,value:"edit",iconCls:"menu__icon btn-edit"},{caption:this.textCanView,value:"view",iconCls:"menu__icon btn-sheet-view"},{caption:"--"},{caption:this.textRemove,value:"remove",iconCls:"menu__icon btn-cc-remove"}]})});a.menu&&(a.menu.on("item:click",(function(t,e){"remove"===e.value?(s.onHideMenu(),s.onDeleteUser(i)):(i.set("type","edit"===e.value?Asc.c_oSerUserProtectedRangeType.edit:"view"===e.value?Asc.c_oSerUserProtectedRangeType.view:Asc.c_oSerUserProtectedRangeType.notView),i.get("btnEdit").setIconCls("toolbar__icon "+("edit"===e.value?"btn-edit":"view"===e.value?"btn-sheet-view":"btn-hide-password")))})),a.menu.on("show:after",_.bind(this.onShowMenu,this)),a.menu.on("hide:after",_.bind(this.onHideMenu,this))),i.set("btnEdit",a,{silent:!0})}},onShowMenu:function(){this.listUser.enableKeyEvents=!1},onHideMenu:function(){this.listUser.enableKeyEvents=!0;var t=this;setTimeout((function(){t.listUser.focus()}),1)},txtProtect:"Protect",txtRangeName:"Title",txtRange:"Range",txtEmpty:"This field is required",textSelectData:"Select Data",textInvalidRange:"ERROR! Invalid cells range",textInvalidName:"The range title must begin with a letter and may only contain letters, numbers, and spaces.",textYou:"you",userPlaceholder:"Start type name or email",txtYouCanEdit:"Only you can edit this range",textAnonymous:"Anonymous",textCanEdit:"Edit",textCanView:"View",textRemove:"Remove",textCantView:"Denied",textAnyone:"Anyone",txtAccess:"Access to range"},SSE.Views.ProtectedRangesEditDlg||{}))})),define("spreadsheeteditor/main/app/view/CreatePivotDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.CreatePivotDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:310,separator:!1,id:"window-create-pivot"},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentStyle:"padding: 5px 5px 0;",contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td style="padding-bottom: 2px;">','<label class="input-label">'+this.textDataRange+"</label>","</td>","</tr>","<tr>",'<td class="padding-large">','<div id="create-pivot-input-source" class="input-row" style=""></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">'+this.textDestination+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="create-pivot-radio-new"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="create-pivot-radio-exist"></div>',"</td>","</tr>","<tr>",'<td class="padding-small padding-left-22">','<div id="create-pivot-input-dest" class="input-row" style=""></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.api=t.api,this.props=t.props,this.options.handler=function(e,i){if("ok"==e&&!this.isRangeValid())return!0;t.handler&&t.handler.call(this,e,i)},this.dataSourceValid="",this.dataDestValid="",Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.txtSourceRange=new Common.UI.InputFieldBtn({el:$("#create-pivot-input-source"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0}),this.txtSourceRange.on("button:click",_.bind(this.onSelectData,this,"source")),this.txtDestRange=new Common.UI.InputFieldBtn({el:$("#create-pivot-input-dest"),name:"range",style:"width: 100%;",btnHint:this.textSelectData,allowBlank:!0,validateOnChange:!0,validateOnBlur:!1,disabled:!0}),this.txtDestRange.on("button:click",_.bind(this.onSelectData,this,"dest")),this.radioNew=new Common.UI.RadioBox({el:$("#create-pivot-radio-new"),labelText:this.textNew,name:"asc-radio-pivot-dest",checked:!0}).on("change",(function(e,i){t.txtDestRange.setDisabled(i),t.txtDestRange.showError()})),this.radioExist=new Common.UI.RadioBox({el:$("#create-pivot-radio-exist"),labelText:this.textExist,name:"asc-radio-pivot-dest"}).on("change",(function(e,i){t.txtDestRange.setDisabled(!i),t.txtDestRange.cmpEl.find("input").focus()})),this.afterRender()},getFocusedComponents:function(){return[this.txtSourceRange,this.radioNew,this.radioExist,this.txtDestRange].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtSourceRange},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){if(t){var e=t.asc_getRange();this.txtSourceRange.setValue(e||""),this.dataSourceValid=e;var i=this;this.txtSourceRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange},this.txtDestRange.validation=function(t){return i.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableReport,t,!1)!=Asc.c_oAscError.ID.DataRangeError||i.textInvalidRange}}},getSettings:function(){return{source:this.txtSourceRange.getValue(),destination:this.radioExist.getValue()?this.txtDestRange.getValue():null}},isRangeValid:function(){var t=!0,e="";return _.isEmpty(this.txtSourceRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableData,this.txtSourceRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),t?this.radioExist.getValue()&&(_.isEmpty(this.txtDestRange.getValue())?(t=!1,e=this.txtEmpty):!(t=(t=this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PivotTableReport,this.txtDestRange.getValue()))==Asc.c_oAscError.ID.No)&&(e=this.textInvalidRange),!t)?(this.txtDestRange.showError([e]),this.txtDestRange.cmpEl.find("input").focus(),t):t:(this.txtSourceRange.showError([e]),this.txtSourceRange.cmpEl.find("input").focus(),t)},onSelectData:function(t){var e=this,i="source"==t?e.txtSourceRange:e.txtDestRange;if(e.api){var s=new SSE.Views.CellRangeDialog({handler:function(s,n){if("ok"==n){var a=s.getSettings();"source"==t?e.dataSourceValid=a:e.dataDestValid=a,i.setValue(a),i.checkValidate()}}}).on("close",(function(){e.show(),_.delay((function(){i.focus()}),1)})),n=Common.Utils.getOffset(e.$window);e.hide(),s.show(e.$window,n),s.setSettings({api:e.api,range:_.isEmpty(i.getValue())||1!=i.checkValidate()?"source"==t?e.dataSourceValid:e.dataDestValid:i.getValue(),type:"source"==t?Asc.c_oAscSelectionDialogType.PivotTableData:Asc.c_oAscSelectionDialogType.PivotTableReport})}},textTitle:"Create Pivot Table",textDataRange:"Source data range",textSelectData:"Select data",textDestination:"Choose, where to place the table",textNew:"New worksheet",textExist:"Existing worksheet",txtEmpty:"This field is required",textInvalidRange:"Invalid cells range"},SSE.Views.CreatePivotDialog||{}))})),define("spreadsheeteditor/main/app/view/SortOptionsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.SortOptionsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:230,separator:!1},initialize:function(t){_.extend(this.options,{title:this.textTitle,contentTemplate:_.template(['<div class="settings-panel active">','<div class="inner-content">','<table cols="1" style="width: 100%;">',"<tr>",'<td class="padding-large">','<div id="sort-options-chk-headers"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<label class="input-label">'+this.textOrientation+"</label>","</td>","</tr>","<tr>",'<td class="padding-small">','<div id="sort-options-radio-row"></div>',"</td>","</tr>","<tr>",'<td class="padding-small">','<div id="sort-options-radio-col"></div>',"</td>","</tr>","</table>","</div></div>"].join(""))({scope:this})},t),this.props=t.props,Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.chHeaders=new Common.UI.CheckBox({el:$("#sort-options-chk-headers"),labelText:this.textHeaders}),this.radioTop=new Common.UI.RadioBox({el:$("#sort-options-radio-row"),labelText:this.textTopBottom,name:"asc-radio-sort-orient"}).on("change",_.bind((function(t,e,i){e&&this.chHeaders.setDisabled(this.props.lockHeaders)}),this)),this.radioLeft=new Common.UI.RadioBox({el:$("#sort-options-radio-col"),labelText:this.textLeftRight,name:"asc-radio-sort-orient"}).on("change",_.bind((function(t,e,i){e&&this.chHeaders.setDisabled(!0)}),this)),this.afterRender()},getFocusedComponents:function(){return[this.chHeaders,this.radioTop,this.radioLeft].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.radioTop},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.chHeaders.setValue(t.headers),t.sortcol||t.lockOrientation?this.radioTop.setValue(!0):this.radioLeft.setValue(!0),this.radioLeft.setDisabled(t.lockOrientation))},getSettings:function(){return{headers:this.radioTop.getValue()&&"checked"==this.chHeaders.getValue(),sortcol:this.radioTop.getValue(),lockHeaders:this.props.lockHeaders,lockOrientation:this.props.lockOrientation}},textTitle:"Sort Options",textHeaders:"My data has headers",textCase:"Case sensitive",textOrientation:"Orientation",textTopBottom:"Sort top to bottom",textLeftRight:"Sort left to right"},SSE.Views.SortOptionsDialog||{}))})),define("spreadsheeteditor/main/app/view/SetValueDialog",[],(function(){"use strict";SSE.Views.SetValueDialog=Common.UI.Window.extend(_.extend({options:{width:214,header:!0,style:"min-width: 214px;",cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div class="input-row">','<div id="id-spin-set-value"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.startvalue=this.options.startvalue,this.maxvalue=this.options.maxvalue,this.defaultUnit=this.options.defaultUnit,this.step=this.options.step,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){if(Common.UI.Window.prototype.render.call(this),this.spnSize=new Common.UI.MetricSpinner({el:$("#id-spin-set-value"),width:182,step:this.step,defaultUnit:this.defaultUnit,minValue:0,maxValue:this.maxvalue}),this.spnSize.setValue(null!==this.startvalue?this.startvalue+" "+this.defaultUnit:""),null!==this.startvalue){var t=this;setTimeout((function(){var e=t.spnSize.$input[0];document.selection?t.spnSize.$input.select():(e.selectionStart=0,e.selectionEnd=t.startvalue.toString().length)}),10)}this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.spnSize.on("entervalue",_.bind(this.onPrimary,this)),this.options.rounding&&this.spnSize.on("change",_.bind(this.onChange,this)),this.spnSize.$el.find("input").focus()},getFocusedComponents:function(){return[this.spnSize].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnSize},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,this,t),this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onChange:function(){var t=this.spnSize.getNumberValue();t=((t/=this.step)|t)*this.step,this.spnSize.setValue(t,!0)},getSettings:function(){return this.spnSize.getNumberValue()},onPrimary:function(){return this._handleInput("ok"),!1},txtMinText:"The minimum value for this field is {0}",txtMaxText:"The maximum value for this field is {0}"},SSE.Views.SetValueDialog||{}))})),define("spreadsheeteditor/main/app/view/ScaleDialog",[],(function(){"use strict";SSE.Views.ScaleDialog=Common.UI.Window.extend(_.extend({options:{width:215,header:!0,style:"min-width: 215px;",cls:"modal-dlg",id:"window-scale",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this._state={width:null,height:null},this.template=['<div class="box">','<div id="radio-fit-to" style="margin-bottom: 4px;"></div>','<div class="padding-left-22">',"<div>",'<label style="width: 55px;padding-top: 4px;display: inline-block;">'+this.textWidth+"</label>",'<div id="scale-width" style="display: inline-block;margin-bottom: 4px;"></div>',"</div>","<div>",'<label style="width: 55px;padding-top: 4px;display: inline-block;">'+this.textHeight+"</label>",'<div id="scale-height" style="display: inline-block;margin-bottom: 16px;"></div>',"</div>","</div>",'<div id="radio-scale-to" style="margin-bottom: 6px;"></div>','<div id="scale" class="padding-left-22" style="margin-bottom: 6px;"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this._originalProps=this.options.props,this.arrDataScale=[{displayValue:this.textAuto,value:0},{displayValue:"1 "+this.textOnePage,value:1},{displayValue:"2 "+this.textFewPages,value:2},{displayValue:"3 "+this.textFewPages,value:3},{displayValue:"4 "+this.textFewPages,value:4},{displayValue:"5 "+this.textManyPages,value:5},{displayValue:"6 "+this.textManyPages,value:6},{displayValue:"7 "+this.textManyPages,value:7},{displayValue:"8 "+this.textManyPages,value:8},{displayValue:"9 "+this.textManyPages,value:9}],Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.radioFitTo=new Common.UI.RadioBox({el:$("#radio-fit-to"),labelText:this.textFitTo,name:"asc-radio-scale"}),this.radioFitTo.on("change",_.bind(this.onRadioScale,this,"fitto")),this.radioScaleTo=new Common.UI.RadioBox({el:$("#radio-scale-to"),labelText:this.textScaleTo,name:"asc-radio-scale"}),this.radioScaleTo.on("change",_.bind(this.onRadioScale,this,"scaleto")),this.cmbScaleWidth=new Common.UI.ComboBox({el:$("#scale-width"),cls:"input-group-nr",style:"width: 90px;",menuStyle:"min-width: 90px;",editable:!0,data:this.arrDataScale,scrollAlwaysVisible:!0,takeFocusOnClose:!0}).on("selected",_.bind(this.changeWidthHeight,this,"width")).on("changed:after",_.bind(this.changeWidthHeight,this,"width")).on("changed:before",_.bind(this.onChangeComboScale,this,"width")),this.cmbScaleHeight=new Common.UI.ComboBox({el:$("#scale-height"),cls:"input-group-nr",style:"width: 90px;",menuStyle:"min-width: 90px;",editable:!0,data:this.arrDataScale,scrollAlwaysVisible:!0,takeFocusOnClose:!0}).on("selected",_.bind(this.changeWidthHeight,this,"height")).on("changed:after",_.bind(this.changeWidthHeight,this,"height")).on("changed:before",_.bind(this.onChangeComboScale,this,"height")),this.spnScale=new Common.UI.MetricSpinner({el:$("#scale"),step:1,width:75,defaultUnit:"%",maxValue:400,minValue:10,defaultValue:"100 %"}).on("change",_.bind((function(t){this.radioScaleTo.setValue(!0,!0),this.cmbScaleHeight.setValue(0,!0),this.cmbScaleWidth.setValue(0,!0),this._state.width=0,this._state.height=0}),this)),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.radioFitTo,this.cmbScaleWidth,this.cmbScaleHeight,this.radioScaleTo,this.spnScale].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.radioScaleTo.getValue()?this.spnScale:this.cmbScaleWidth},afterRender:function(){this._setDefaults(this._originalProps)},_handleInput:function(t){this.options.handler&&"ok"===t&&this.options.handler.call(this,"ok",this.getSettings()),this.close(t)},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(){return this._handleInput("ok"),!1},changeWidthHeight:function(t,e){var i=e.getValue();"string"==typeof i&&(i=parseInt(i),isNaN(i)&&(i=0)),"width"===t?this._state.width=i:this._state.height=i,0!==this._state.width&&null!==this._state.width||0!==this._state.height&&null!==this._state.height?this.radioFitTo.setValue(!0,!0):this.radioScaleTo.setValue(!0,!0)},onRadioScale:function(t,e,i){"scaleto"===t?(this.cmbScaleHeight.setValue(0,!0),this._state.height=0,this.cmbScaleWidth.setValue(0,!0),this._state.width=0):(this.cmbScaleHeight.setValue(0,!0),this._state.height=0,this.cmbScaleWidth.setValue(1,!0),this._state.width=1)},_setDefaults:function(t){if(this.api){var e=(t||this.api.asc_getPageOptions()).asc_getPageSetup(),i=e.asc_getFitToWidth(),s=e.asc_getFitToHeight(),n=e.asc_getScale();this._state.width=null!==i&&0!==i?i:null,this._state.height=null!==s&&0!==s?s:null,s=null!=s?s:0,0===(i=null!=i?i:0)&&0===s?this.radioScaleTo.setValue(!0,!0):this.radioFitTo.setValue(!0,!0),_.findWhere(this.arrDataScale,{value:i})?this.cmbScaleWidth.setValue(i):this.cmbScaleWidth.setRawValue(i.toString()+" "+this.getTextPages(i)),_.findWhere(this.arrDataScale,{value:s})?this.cmbScaleHeight.setValue(s):this.cmbScaleHeight.setRawValue(s.toString()+" "+this.getTextPages(s)),this.spnScale.setValue(null!=n?n:"",!0)}},getSettings:function(){var t={};return t.width=null===this._state.width?null:this._state.width,t.height=null===this._state.height?null:this._state.height,t.scale=this.spnScale.getNumberValue(),t},getTextPages:function(t){var e=t%10;return e>0&&e<1.001?this.textOnePage:e>0&&e<4.001?this.textFewPages:this.textManyPages},onChangeComboScale:function(t,e,i,s){var n,a=this,o=i.value.toLowerCase();new RegExp("^\\s*("+a.textAuto.toLowerCase()+")\\s*$").exec(o)?o=0:(o=parseInt(o),!isNaN(o)&&(n=a.getTextPages(o))),(isNaN(o)||o<0||o>32767)&&(Common.UI.error({msg:a.textError,callback:function(){_.defer((function(t){Common.NotificationCenter.trigger("edit:complete",a)}))}}),o="width"===t?a._state.width:a._state.height,n=a.getTextPages(o)),null===o&&(o=0),"width"===t?(_.findWhere(a.arrDataScale,{value:o})?a.cmbScaleWidth.setValue(o):(a.cmbScaleWidth.setValue(""),a.cmbScaleWidth.setRawValue(o.toString()+" "+n)),a._state.width=o):"height"===t&&(_.findWhere(a.arrDataScale,{value:o})?a.cmbScaleHeight.setValue(o):(a.cmbScaleHeight.setValue(""),a.cmbScaleHeight.setRawValue(o.toString()+" "+n)),a._state.height=o)},close:function(t){this.options.handler&&"ok"!==t&&this.options.handler.call(this,"cancel",void 0),Common.UI.Window.prototype.close.call(this)},textTitle:"Scale Settings",textWidth:"Width",textHeight:"Height",textAuto:"Auto",textOnePage:"page",textFewPages:"pages",textManyPages:"pages",textError:"The entered value is incorrect.",textScaleTo:"Scale To",textFitTo:"Fit To"},SSE.Views.ScaleDialog||{}))})),define("spreadsheeteditor/main/app/view/PrintTitlesDialog",[],(function(){"use strict";SSE.Views.PrintTitlesDialog=Common.UI.Window.extend(_.extend({options:{width:300,header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;margin-bottom: 10px;">',"<tr>",'<td colspan="2" class="padding-right-10">','<label class="input-label">'+this.textTop+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 16px;">','<div id="print-titles-txt-top"></div>',"</td>",'<td style="padding-bottom: 16px;">','<div id="print-titles-presets-top"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-right-10">','<label class="input-label">'+this.textLeft+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10">','<div id="print-titles-txt-left"></div>',"</td>","<td>",'<div id="print-titles-presets-left"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.sheet=this.options.sheet,Common.UI.Window.prototype.initialize.call(this,this.options),this.dataRangeTop="",this.dataRangeLeft=""},render:function(){Common.UI.Window.prototype.render.call(this);var t=this;this.txtRangeTop=new Common.UI.InputFieldBtn({el:$("#print-titles-txt-top"),style:"width: 100%;",btnHint:this.textSelectRange,allowBlank:!0,validateOnChange:!0,validation:function(e){return!!_.isEmpty(e)||(t.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,e,!1)!=Asc.c_oAscError.ID.DataRangeError||t.textInvalidRange)}});var e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!1,this.sheet);this.btnPresetsTop=new Common.UI.Button({parentEl:$("#print-titles-presets-top"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textSelectRange+"...",value:"select"},{caption:this.textFrozenRows,value:"frozen",range:e,disabled:!e},{caption:this.textFirstRow,value:"first",range:this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.first,!1,this.sheet)},{caption:"--"},{caption:this.textNoRepeat,value:"empty",range:""}]}),takeFocusOnClose:!0}),this.btnPresetsTop.menu.on("item:click",_.bind(this.onPresetSelect,this,"top")),this.txtRangeTop.on("button:click",_.bind(this.onPresetSelect,this,"top",this.btnPresetsTop.menu,{value:"select"})),this.txtRangeLeft=new Common.UI.InputFieldBtn({el:$("#print-titles-txt-left"),style:"width: 100%;",btnHint:this.textSelectRange,allowBlank:!0,validateOnChange:!0,validation:function(e){return!!_.isEmpty(e)||(t.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,e,!1)!=Asc.c_oAscError.ID.DataRangeError||t.textInvalidRange)}}),e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.frozen,!0,this.sheet),this.btnPresetsLeft=new Common.UI.Button({parentEl:$("#print-titles-presets-left"),cls:"btn-text-menu-default",caption:this.textRepeat,style:"width: 95px;",menu:new Common.UI.Menu({style:"min-width: 100px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:[{caption:this.textSelectRange+"...",value:"select"},{caption:this.textFrozenCols,value:"frozen",range:e,disabled:!e},{caption:this.textFirstCol,value:"first",range:this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.first,!0,this.sheet)},{caption:"--"},{caption:this.textNoRepeat,value:"empty",range:""}]}),takeFocusOnClose:!0}),this.btnPresetsLeft.menu.on("item:click",_.bind(this.onPresetSelect,this,"left")),this.txtRangeLeft.on("button:click",_.bind(this.onPresetSelect,this,"left",this.btnPresetsLeft.menu,{value:"select"}));var i=this.getChild();i.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),i.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.setSettings()},getFocusedComponents:function(){return[this.txtRangeTop,this.btnPresetsTop,this.txtRangeLeft,this.btnPresetsLeft].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){if(!this._alreadyRendered)return this._alreadyRendered=!0,this.txtRangeTop},isRangeValid:function(){return this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,this.txtRangeTop.getValue(),!1)==Asc.c_oAscError.ID.DataRangeError?(this.txtRangeTop.focus(),!1):this.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.PrintTitles,this.txtRangeLeft.getValue(),!1)!=Asc.c_oAscError.ID.DataRangeError||(this.txtRangeLeft.focus(),!1)},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},setSettings:function(t){if(this.api){var e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.current,!1,this.sheet);this.txtRangeTop.setValue(e||""),this.dataRangeTop=e,e=this.api.asc_getPrintTitlesRange(Asc.c_oAscPrintTitlesRangeType.current,!0,this.sheet),this.txtRangeLeft.setValue(e||""),this.dataRangeLeft=e}},getSettings:function(){return{width:this.txtRangeLeft.getValue(),height:this.txtRangeTop.getValue()}},onPresetSelect:function(t,e,i){var s="top"==t?this.txtRangeTop:this.txtRangeLeft;if("select"==i.value){var n=this;if(n.api){n.btnPresetsTop.menu.options.additionalAlign=n.menuAddAlign,n.btnPresetsLeft.menu.options.additionalAlign=n.menuAddAlign;var a=new SSE.Views.CellRangeDialog({handler:function(e,i){if("ok"==i){var a=e.getSettings();"top"==t?n.dataRangeTop=a:n.dataRangeLeft=a,s.setValue(a),s.checkValidate()}}}).on("close",(function(){n.show(),_.delay((function(){s.focus()}),1)})),o=Common.Utils.getOffset(n.$window);n.hide(),a.show(n.$window,o),a.setSettings({api:n.api,range:_.isEmpty(s.getValue())||1!=s.checkValidate()?"top"==t?n.dataRangeTop:n.dataRangeLeft:s.getValue(),type:Asc.c_oAscSelectionDialogType.PrintTitles})}}else{var l=i.options.range||"";s.setValue(l),s.checkValidate(),"top"==t?this.dataRangeTop=l:this.dataRangeLeft=l}},textTitle:"Print Titles",textTop:"Repeat rows at top",textLeft:"Repeat columns at left",textRepeat:"Repeat...",textNoRepeat:"Not repeat",textSelectRange:"Select range",textFrozenRows:"Frozen rows",textFrozenCols:"Frozen columns",textFirstRow:"First row",textFirstCol:"First column",textInvalidRange:"ERROR! Invalid cells range"},SSE.Views.PrintTitlesDialog||{}))})),void 0===Common)Common={};if(define("spreadsheeteditor/main/app/view/TableOptionsDialog",[],(function(){"use strict";SSE.Views.TableOptionsDialog=Common.UI.Window.extend(_.extend({options:{width:355,cls:"modal-dlg",modal:!1,buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.txtFormat},t),this.template=['<div class="box">','<div id="id-dlg-tableoptions-range" class="input-row"  style="margin-bottom: 5px;"></div>','<div class="input-row hidden" id="id-dlg-tableoptions-title" style="margin-top: 5px;"></div>','<label class="" id="id-dlg-tableoptions-lbl" style="margin-top: 5px;">'+this.txtNote+"</label>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.checkRangeType=Asc.c_oAscSelectionDialogType.FormatTable,this.selectionType=Asc.c_oAscSelectionType.RangeCells,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=this;e.inputRange=new Common.UI.InputField({el:$("#id-dlg-tableoptions-range"),name:"range",style:"width: 100%;",allowBlank:!1,blankError:this.txtEmpty,validateOnChange:!0}),e.cbTitle=new Common.UI.CheckBox({el:$("#id-dlg-tableoptions-title"),labelText:this.txtTitle}),e.lblNote=t.find("#id-dlg-tableoptions-lbl"),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.on("close",_.bind(this.onClose,this))},onPrimary:function(){return this._handleInput("ok"),!1},setSettings:function(t){var e=this;if(t.api){if(e.api=t.api,t.range)e.checkRangeType=Asc.c_oAscSelectionDialogType.FormatTableChangeRange,e.inputRange.setValue(t.range),e.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.FormatTable,t.range);else{e.cbTitle.$el&&e.cbTitle.$el.removeClass("hidden"),e.lblNote.addClass("hidden"),e.setHeight(152);var i=e.api.asc_getAddFormatTableOptions();e.inputRange.setValue(i.asc_getRange()),e.cbTitle.setValue(i.asc_getIsTitle()),e.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.FormatTable,i.asc_getRange())}t.title&&e.setTitle(t.title),t.selectionType&&(e.selectionType=t.selectionType),e.wrapEvents={onApiRangeChanged:_.bind(e.onApiRangeChanged,e)},e.api.asc_registerCallback("asc_onSelectionRangeChanged",e.wrapEvents.onApiRangeChanged),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.FormatTable)}e.inputRange.validation=function(t){return e.api.asc_checkDataRange(e.checkRangeType,t,!1)!=Asc.c_oAscError.ID.DataRangeError||e.txtInvalidRange}},getSettings:function(){if(this.checkRangeType==Asc.c_oAscSelectionDialogType.FormatTable){var t=this.api.asc_getAddFormatTableOptions(this.inputRange.getValue());return t.asc_setIsTitle(this.cbTitle.checked),{selectionType:this.selectionType,range:t}}return{selectionType:this.selectionType,range:this.inputRange.getValue()}},onApiRangeChanged:function(t){this.inputRange.setValue(t),this.inputRange.cmpEl.hasClass("error")&&this.inputRange.cmpEl.removeClass("error")},isRangeValid:function(){var t=this.api.asc_checkDataRange(this.checkRangeType,this.inputRange.getValue(),!0);if(t==Asc.c_oAscError.ID.No)return!0;switch(t){case Asc.c_oAscError.ID.AutoFilterDataRangeError:Common.UI.warning({msg:this.errorAutoFilterDataRange});break;case Asc.c_oAscError.ID.FTChangeTableRangeError:Common.UI.warning({msg:this.errorFTChangeTableRangeError});break;case Asc.c_oAscError.ID.FTRangeIncludedOtherTables:Common.UI.warning({msg:this.errorFTRangeIncludedOtherTables});break;case Asc.c_oAscError.ID.MultiCellsInTablesFormulaArray:Common.UI.warning({msg:this.errorMultiCellFormula});break;case Asc.c_oAscError.ID.LargeRangeWarning:return this.selectionType=Asc.c_oAscSelectionType.RangeMax,!0}return!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onClose:function(t){this.api&&(this.api.asc_setSelectionDialogMode(Asc.c_oAscSelectionDialogType.None),this.api.asc_unregisterCallback("asc_onSelectionRangeChanged",this.wrapEvents.onApiRangeChanged)),Common.NotificationCenter.trigger("cells:range",Asc.c_oAscSelectionDialogType.None),Common.NotificationCenter.trigger("edit:complete",this),SSE.getController("RightMenu").SetDisabled(!1)},_handleInput:function(t){if(this.options.handler){if("ok"==t&&!0!==this.isRangeValid())return;this.options.handler.call(this,this,t)}this.close()},show:function(){Common.UI.Window.prototype.show.call(this),SSE.getController("RightMenu").SetDisabled(!0)},txtTitle:"Title",txtFormat:"Create Table",txtEmpty:"This field is required",txtInvalidRange:"ERROR! Invalid cells range",errorAutoFilterDataRange:"The operation could not be done for the selected range of cells.<br>Select a uniform data range inside or outside the tableand try again.",errorFTChangeTableRangeError:"Operation could not be completed for the selected cell range.<br>Select a range so that the first table row was on the same row<br>and the resulting table overlapped the current one.",errorFTRangeIncludedOtherTables:"Operation could not be completed for the selected cell range.<br>Select a range which does not include other tables.",errorMultiCellFormula:"Multi-cell array formulas are not allowed in tables.",txtNote:"The headers must remain in the same row, and the resulting table range must overlap the original table range."},SSE.Views.TableOptionsDialog||{}))})),define("spreadsheeteditor/main/app/view/PageMarginsDialog",[],(function(){"use strict";SSE.Views.PageMarginsDialog=Common.UI.Window.extend(_.extend({options:{width:215,height:"auto",header:!0,style:"min-width: 216px;",cls:"modal-dlg",id:"window-page-margins",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<table cols="2" style="width: 100%;margin-bottom: 5px;">',"<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;">','<label class="input-label">'+this.textTop+"</label>",'<div id="page-margins-spin-top"></div>',"</td>",'<td style="padding-bottom: 8px;">','<label class="input-label">'+this.textBottom+"</label>",'<div id="page-margins-spin-bottom"></div>',"</td>","</tr>","<tr>",'<td class="padding-small padding-right-10" style="padding-bottom: 16px;">','<label class="input-label">'+this.textLeft+"</label>",'<div id="page-margins-spin-left"></div>',"</td>",'<td class="padding-small" style="padding-bottom: 16px;">','<label class="input-label">'+this.textRight+"</label>",'<div id="page-margins-spin-right"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small" style="padding-bottom: 4px;">','<label class="input-label">'+this.textCenter+"</label>","</td>","</tr>","<tr>",'<td colspan="2" class="padding-small" style="padding-bottom: 8px;">','<div id="page-margins-chk-vert"></div>',"</td>","</tr>","<tr>",'<td colspan="2" class="padding-small">','<div id="page-margins-chk-hor"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.spinners=[],this._noApply=!1,this.maxMarginsW=this.maxMarginsH=0,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild();this.spnTop=new Common.UI.MetricSpinner({el:$("#page-margins-spin-top",t),step:.1,width:86,defaultUnit:"cm",value:"0",maxValue:48.25,minValue:0}),this.spinners.push(this.spnTop),this.spnBottom=new Common.UI.MetricSpinner({el:$("#page-margins-spin-bottom",t),step:.1,width:86,defaultUnit:"cm",value:"0",maxValue:48.25,minValue:0}),this.spinners.push(this.spnBottom),this.spnLeft=new Common.UI.MetricSpinner({el:$("#page-margins-spin-left",t),step:.1,width:86,defaultUnit:"cm",value:"0.19 cm",maxValue:48.25,minValue:0}),this.spinners.push(this.spnLeft),this.spnRight=new Common.UI.MetricSpinner({el:$("#page-margins-spin-right",t),step:.1,width:86,defaultUnit:"cm",value:"0.19 cm",maxValue:48.25,minValue:0}),this.spinners.push(this.spnRight),this.chVert=new Common.UI.CheckBox({el:$("#page-margins-chk-vert",t),labelText:this.textVert}),this.chHor=new Common.UI.CheckBox({el:$("#page-margins-chk-hor",t),labelText:this.textHor}),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),t.find("input").on("keypress",_.bind(this.onKeyPress,this)),this.updateMetricUnit()},getFocusedComponents:function(){return this.spinners.concat([this.chVert,this.chHor]).concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnTop},onPrimary:function(){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=this,i=null,s=this.spnTop.getNumberValue(),n=this.spnBottom.getNumberValue(),a=this.spnLeft.getNumberValue(),o=this.spnRight.getNumberValue();if(a>this.maxMarginsW?i="left":o>this.maxMarginsW-a?i="right":s>this.maxMarginsH?i="top":n>this.maxMarginsH-s&&(i="bottom"),i)return void Common.UI.warning({title:this.textWarning,msg:this.warnCheckMargings,callback:function(){switch(i){case"left":return void e.spnLeft.focus();case"right":return void e.spnRight.focus();case"top":return void e.spnTop.focus();case"bottom":return void e.spnBottom.focus()}}})}this.options.handler.call(this,this,t)}this.close()},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onKeyPress:function(t){t.keyCode==Common.UI.Keys.RETURN&&this._handleInput("ok")},setSettings:function(t){if(t){var e=t.asc_getPageMargins(),i=t.asc_getPageSetup();this.maxMarginsH=Common.Utils.Metric.fnRecalcFromMM(i.asc_getHeight()),this.maxMarginsW=Common.Utils.Metric.fnRecalcFromMM(i.asc_getWidth()),this.spnTop.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getTop()),!0),this.spnBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getBottom()),!0),this.spnLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getLeft()),!0),this.spnRight.setValue(Common.Utils.Metric.fnRecalcFromMM(e.asc_getRight()),!0),this.chVert.setValue(!!t.asc_getVerticalCentered()),this.chHor.setValue(!!t.asc_getHorizontalCentered())}},getSettings:function(){var t=new Asc.asc_CPageMargins;return t.asc_setTop(Common.Utils.Metric.fnRecalcToMM(this.spnTop.getNumberValue())),t.asc_setBottom(Common.Utils.Metric.fnRecalcToMM(this.spnBottom.getNumberValue())),t.asc_setLeft(Common.Utils.Metric.fnRecalcToMM(this.spnLeft.getNumberValue())),t.asc_setRight(Common.Utils.Metric.fnRecalcToMM(this.spnRight.getNumberValue())),{margins:t,vertical:"checked"===this.chVert.getValue(),horizontal:"checked"===this.chHor.getValue()}},updateMetricUnit:function(){if(this.spinners)for(var t=0;t<this.spinners.length;t++){this.spinners[t].setDefaultUnit(Common.Utils.Metric.getCurrentMetricName())}},textTitle:"Margins",textTop:"Top",textLeft:"Left",textBottom:"Bottom",textRight:"Right",textWarning:"Warning",warnCheckMargings:"Margins are incorrect",textCenter:"Center on page",textVert:"Vertically",textHor:"Horizontally"},SSE.Views.PageMarginsDialog||{}))})),void 0===Common)Common={};define("spreadsheeteditor/main/app/view/HyperlinkSettingsDialog",[],(function(){"use strict";SSE.Views.HyperlinkSettingsDialog=Common.UI.Window.extend(_.extend({options:{width:350,style:"min-width: 230px;",cls:"modal-dlg",id:"window-hyperlink",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box" style="height: 330px;">','<div class="margin-bottom-big">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-external">',this.textExternalLink,"</button>",'<button type="button" class="btn btn-text-default auto" id="id-dlg-hyperlink-internal">',this.textInternalLink,"</button>","</div>",'<div id="id-external-link">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>","</div>",'<div id="id-dlg-hyperlink-url" class="input-row margin-bottom"></div>',"</div>",'<div id="id-internal-link" class="hidden">','<div class="input-row">',"<label>"+this.strLinkTo+"</label>",'<div class="get-link float-right">','<label class="link dropdown-toggle float-right" data-toggle="dropdown" id="id-dlg-hyperlink-get-link">'+this.textGetLink+"</label>",'<div id="id-clip-copy-box" class="dropdown-menu">','<div id="id-dlg-clip-copy" class="display-inline-block-middle"></div>','<button id="id-dlg-copy-btn" class="btn btn-text-default margin-left-5 display-inline-block-middle">'+this.textCopy+"</button>","</div>","</div>","</div>",'<div id="id-dlg-hyperlink-list"></div>','<div class="input-row">',"<label>"+this.strRange+"</label>","</div>",'<div id="id-dlg-hyperlink-range" class="input-row margin-bottom"></div>',"</div>",'<div class="input-row">',"<label>"+this.strDisplay+"</label>","</div>",'<div id="id-dlg-hyperlink-display" class="input-row margin-bottom"></div>','<div class="input-row">',"<label>"+this.textTipText+"</label>","</div>",'<div id="id-dlg-hyperlink-tip" class="input-row margin-bottom"></div>',"</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.api=this.options.api,this.appOptions=t.appOptions,this.dataRangeValid="",this.urlType=AscCommon.c_oAscUrlType.Invalid,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this.getChild(),e=this;e.btnExternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-external"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1,pressed:!0}),e.btnExternal.on("click",_.bind(e.onLinkTypeClick,e,Asc.c_oAscHyperlinkType.WebLink)),e.btnInternal=new Common.UI.Button({el:$("#id-dlg-hyperlink-internal"),enableToggle:!0,toggleGroup:"hyperlink-type",allowDepress:!1}),e.btnInternal.on("click",_.bind(e.onLinkTypeClick,e,Asc.c_oAscHyperlinkType.RangeLink)),Common.UI.GroupedButtons([e.btnExternal,e.btnInternal]);var i={el:$("#id-dlg-hyperlink-url"),allowBlank:!1,blankError:e.txtEmpty,validateOnBlur:!1,style:"width: 100%;",iconCls:"toolbar__icon btn-browse",placeHolder:e.appOptions.isDesktopApp?e.txtUrlPlaceholder:"",btnHint:e.textSelectFile,validation:function(t){var i=$.trim(t);return e.api.asc_getFullHyperlinkLength(i)>2083?e.txtSizeLimit:(e.urlType=e.api.asc_getUrlType(i),e.urlType!==AscCommon.c_oAscUrlType.Invalid||e.txtNotUrl)}};if(e.inputUrl=e.appOptions.isDesktopApp?new Common.UI.InputFieldBtn(i):new Common.UI.InputField(i),e.inputUrl._input.on("input",(function(t){e.isInputFirstChange_url&&e.inputUrl.showError(),e.isInputFirstChange_url=!1;var i=$(t.target).val();e.isAutoUpdate&&e.inputDisplay.setValue(i),e.btnOk.setDisabled(""==$.trim(i))})),e.appOptions.isDesktopApp&&e.inputUrl.on("button:click",_.bind(e.onSelectFile,e)),e.inputRange=new Common.UI.InputFieldBtn({el:$("#id-dlg-hyperlink-range"),allowBlank:!1,blankError:e.txtEmpty,style:"width: 100%;",btnHint:e.textSelectData,validateOnChange:!0,validateOnBlur:!1,value:Common.Utils.InternalSettings.get("sse-settings-r1c1")?"R1C1":"A1",validation:function(t){return!!e.inputRange.isDisabled()||(e.api.asc_checkDataRange(Asc.c_oAscSelectionDialogType.Chart,t,!1)==Asc.c_oAscError.ID.No||e.textInvalidRange)}}),e.inputRange._input.on("input",(function(t){e.isInputFirstChange_range&&e.inputRange.showError(),e.isInputFirstChange_range=!1;var i=$(t.target).val();e.isAutoUpdate&&e.inputDisplay.setValue(e.internalList.getSelectedRec().get("name")+(""!==i?"!"+i:"")),e.btnOk.setDisabled(""==$.trim(i))})),e.inputRange.on("button:click",_.bind(e.onSelectData,e)),e.inputDisplay=new Common.UI.InputField({el:$("#id-dlg-hyperlink-display"),allowBlank:!0,validateOnBlur:!1,style:"width: 100%;"}),e.inputDisplay._input.on("input",(function(t){e.isAutoUpdate=""==$(t.target).val()})),e.inputTip=new Common.UI.InputField({el:$("#id-dlg-hyperlink-tip"),style:"width: 100%;",maxLength:Asc.c_oAscMaxTooltipLength}),e.internalList=new Common.UI.TreeView({el:$("#id-dlg-hyperlink-list"),store:new Common.UI.TreeViewStore,tabindex:1,enableKeyEvents:!0}),e.internalList.on("item:select",_.bind(this.onSelectItem,this)),e.appOptions&&e.appOptions.canMakeActionLink){var s=new Common.UI.InputField({el:$("#id-dlg-clip-copy"),editable:!1,style:"width: 176px;"}),n=t.find("#id-clip-copy-box");n.on("click",_.bind((function(){return!1}),this)),n.parent().on({"shown.bs.dropdown":function(){_.delay((function(){s._input.select().focus()}),100)}}),n.find("button").on("click",(function(){s._input.select(),document.execCommand("copy")})),Common.Gateway.on("setactionlink",(function(t){s.setValue(t)}))}e.linkGetLink=$("#id-dlg-hyperlink-get-link"),e.linkGetLink.toggleClass("hidden",!(e.appOptions&&e.appOptions.canMakeActionLink)),e.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:t.find(".primary")}),e.btnOk.setDisabled(!0),t.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),e.internalList.on("entervalue",_.bind(e.onPrimary,e)),t.on("click","#id-dlg-hyperlink-get-link",_.bind(e.getLink,e)),e.externalPanel=t.find("#id-external-link"),e.internalPanel=t.find("#id-internal-link")},getFocusedComponents:function(){return[this.btnExternal,this.btnInternal,this.inputUrl,this.internalList,this.inputRange,this.inputDisplay,this.inputTip].concat(this.getFooterButtons())},show:function(){Common.UI.Window.prototype.show.apply(this,arguments),Common.Utils.InternalSettings.set("sse-dialog-link-visible",!0)},close:function(){Common.Utils.InternalSettings.set("sse-dialog-link-visible",!1),Common.UI.Window.prototype.close.apply(this,arguments)},setSettings:function(t){if(t){var e=this;e.settings=t;var i=t.props?t.props.asc_getType():Common.Utils.InternalSettings.get("sse-settings-link-type")&&t.allowInternal?Asc.c_oAscHyperlinkType.RangeLink:Asc.c_oAscHyperlinkType.WebLink;i==Asc.c_oAscHyperlinkType.WebLink?e.btnExternal.toggle(!0):e.btnInternal.toggle(!0),e.ShowHideElem(i,t.props),e.btnInternal.setDisabled(!t.allowInternal&&i==Asc.c_oAscHyperlinkType.WebLink),e.btnExternal.setDisabled(!t.allowInternal&&i==Asc.c_oAscHyperlinkType.RangeLink);var s="";t.props?(i==Asc.c_oAscHyperlinkType.RangeLink?t.props.asc_getSheet()?(this.inputRange.setValue(t.props.asc_getRange()),this.dataRangeValid=this.inputRange.getValue(),s=t.props.asc_getSheet()+"!"+t.props.asc_getRange()):(this.inputRange.setDisabled(!0),s=t.props.asc_getLocation()):(this.inputUrl.setValue(t.props.asc_getHyperlinkUrl().replace(new RegExp(" ","g"),"%20")),this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()))),this.inputDisplay.setValue(t.isLock?this.textDefault:t.props.asc_getText()),this.inputTip.setValue(t.props.asc_getTooltip())):this.inputDisplay.setValue(t.isLock?this.textDefault:t.text),this.inputDisplay.setDisabled(t.isLock),!t.isLock&&(this.isAutoUpdate=""==this.inputDisplay.getValue()||i==Asc.c_oAscHyperlinkType.WebLink&&e.inputUrl.getValue()==e.inputDisplay.getValue()||i==Asc.c_oAscHyperlinkType.RangeLink&&s==e.inputDisplay.getValue())}},getSettings:function(){var t=new Asc.asc_CHyperlink,e="",i=this.btnInternal.isActive()?Asc.c_oAscHyperlinkType.RangeLink:Asc.c_oAscHyperlinkType.WebLink;if(t.asc_setType(i),i==Asc.c_oAscHyperlinkType.RangeLink){var s=this.internalList.getSelectedRec();s&&s.get("level")>0&&(s.get("type")?(t.asc_setSheet(null),t.asc_setLocation(s.get("name")),e=s.get("name")):(t.asc_setSheet(s.get("name")),t.asc_setRange(this.inputRange.getValue()),e=s.get("name")+"!"+this.inputRange.getValue()))}else{var n=this.inputUrl.getValue().replace(/^\s+|\s+$/g,"");this.urlType===AscCommon.c_oAscUrlType.Unsafe||/(((^https?)|(^ftp)):\/\/)|(^mailto:)/i.test(n)||(n=(this.urlType==AscCommon.c_oAscUrlType.Email?"mailto:":"http://")+n),n=n.replace(new RegExp("%20","g")," "),t.asc_setHyperlinkUrl(n),e=n}return this.inputDisplay.isDisabled()?t.asc_setText(null):((_.isEmpty(this.inputDisplay.getValue())||i==Asc.c_oAscHyperlinkType.WebLink&&this.isAutoUpdate)&&this.inputDisplay.setValue(e),t.asc_setText(this.inputDisplay.getValue())),t.asc_setTooltip(this.inputTip.getValue()),t},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t){var e=!this.btnExternal.isActive()||this.inputUrl.checkValidate(),i=!this.btnInternal.isActive()||this.inputRange.checkValidate(),s=this.inputDisplay.checkValidate();if(!0!==e)return this.inputUrl.focus(),void(this.isInputFirstChange_url=!0);if(!0!==i)return this.inputRange.focus(),void(this.isInputFirstChange_range=!0);if(!0!==s)return void this.inputDisplay.focus();!this.settings.props&&Common.Utils.InternalSettings.set("sse-settings-link-type",this.btnInternal.isActive())}this.options.handler.call(this,this,t)}this.close()},ShowHideElem:function(t,e){this.externalPanel.toggleClass("hidden",t!==Asc.c_oAscHyperlinkType.WebLink),this.internalPanel.toggleClass("hidden",t!==Asc.c_oAscHyperlinkType.RangeLink);var i=this.internalList.store;if(t==Asc.c_oAscHyperlinkType.RangeLink){if(i.length<1&&this.settings){var s=this.settings.sheets,n=s.length,a=[];a.push(new Common.UI.TreeViewModel({name:this.textSheets,level:0,index:0,hasParent:!1,isEmptyItem:!1,isNotHeader:!0,isExpanded:!1,hasSubItems:!0}));for(var o=0;o<n;o++)!s[o].hidden&&a.push(new Common.UI.TreeViewModel({name:s[o].name,level:1,index:o+1,type:0,isVisible:!1,hasParent:!0}));a.push(new Common.UI.TreeViewModel({name:this.textNames,level:0,index:a.length,hasParent:!1,isEmptyItem:!1,isNotHeader:!1,isExpanded:!1,hasSubItems:!1}));var l=a[a.length-1],r=this.settings.ranges,c=0;n=r.length;for(o=0;o<n;o++){var d=r[o],h=d.asc_getScope();d.asc_getIsHidden()||(c<1&&a[a.length-1].set("hasSubItems",!0),a.push(new Common.UI.TreeViewModel({name:(d.asc_getIsXlnm()&&s[h]?s[h].name+"!":"")+d.asc_getName(),level:1,index:a.length,type:1,isVisible:!1,hasParent:!0})),c=1)}i.reset(a);var p=e?e.asc_getSheet()||e.asc_getLocation():this.api.asc_getWorksheetName(this.settings.currentSheet);(u=i.findWhere({name:p}))&&(this.internalList.expandRecord(u.get("type")?l:i.at(0)),this.internalList.scrollToRecord(this.internalList.selectRecord(u)))}var u=this.internalList.getSelectedRec();this.btnOk.setDisabled(!u||0==u.get("level")||0==u.get("type")&&""==$.trim(this.inputRange.getValue()));var m=this;_.delay((function(){m.inputRange.isDisabled()?m.internalList.focus():m.inputRange.focus()}),50)}else{this.btnOk.setDisabled(""==$.trim(this.inputUrl.getValue()));m=this;_.delay((function(){m.inputUrl.focus()}),50)}},onLinkTypeClick:function(t,e,i){if(this.ShowHideElem(t),this.isAutoUpdate)if(t==Asc.c_oAscHyperlinkType.RangeLink){var s=this.internalList.getSelectedRec(),n=s&&s.get("level")?s.get("name"):"";if(s&&1==s.get("type"))this.inputDisplay.setValue(n);else{var a=this.inputRange.getValue();this.inputDisplay.setValue(n+(""!==n&&""!==a?"!":"")+a)}}else this.inputDisplay.setValue(this.inputUrl.getValue())},onSelectItem:function(t,e,i,s){if(this.btnOk.setDisabled(0==i.get("level")||0==i.get("type")&&""==$.trim(this.inputRange.getValue())),this.inputRange.setDisabled(1==i.get("type")||0==i.get("level")),this.isAutoUpdate){var n=i.get("level")?i.get("name"):"";if(1==i.get("type"))this.inputDisplay.setValue(n);else{var a=this.inputRange.getValue();this.inputDisplay.setValue(n+(""!==n&&""!==a?"!":"")+a)}}this.linkGetLink.toggleClass("disabled",0==i.get("level"))},getLink:function(t){if(!t.cmpEl||!t.cmpEl.parent().hasClass("open")){var e=this.internalList.getSelectedRec();if(e&&e.get("level")){var i=e.get("name");if(1==e.get("type"))this.inputDisplay.setValue(i);else{var s=this.inputRange.getValue();i=(i=this.api.asc_getEscapeSheetName(i))+(""!==i&&""!==s?"!":"")+s}i&&Common.Gateway.requestMakeActionLink({action:{type:"internallink",data:i}})}}},onSelectData:function(){var t=this;if(t.api){var e=new SSE.Views.CellRangeDialog({handler:function(e,i){if("ok"==i){t.dataRangeValid=e.getSettings();var s=t.dataRangeValid.indexOf("!");s>=0&&(t.dataRangeValid=t.dataRangeValid.substring(s+1,t.dataRangeValid.length));var n=t.internalList.store.findWhere({name:t.api.asc_getWorksheetName(t.api.asc_getActiveWorksheetIndex())});n&&(t.internalList.expandRecord(t.internalList.store.at(0)),t.internalList.scrollToRecord(t.internalList.selectRecord(n))),t.inputRange.setValue(t.dataRangeValid),t.inputRange.checkValidate(),t.isAutoUpdate&&t.inputDisplay.setValue(t.internalList.getSelectedRec().get("name")+(""!==t.dataRangeValid?"!"+t.dataRangeValid:"")),t.btnOk.setDisabled(""==$.trim(t.dataRangeValid))}}}).on("close",(function(){t.show(),_.delay((function(){t.inputRange.focus()}),1),_.delay((function(){t.api.asc_showWorksheet(t.settings.currentSheet)}),1)}));t.api.asc_showWorksheet(t.internalList.getSelectedRec().get("index")-1);var i=Common.Utils.getOffset(t.$window);t.hide(),e.show(t.$window,i),e.setSettings({api:t.api,range:_.isEmpty(t.inputRange.getValue())||1!=t.inputRange.checkValidate()?t.dataRangeValid:t.inputRange.getValue(),type:Asc.c_oAscSelectionDialogType.Chart})}},onSelectFile:function(){var t=this;if(t.api){t.api.asc_getFilePath((function(e){e&&(t.inputUrl.setValue(e),!0!==t.inputUrl.checkValidate()&&(t.isInputFirstChange_url=!0),t.isAutoUpdate&&t.inputDisplay.setValue(e),t.btnOk.setDisabled(""==$.trim(e)))}))}},textTitle:"Hyperlink Settings",textInternalLink:"Place in Document",textExternalLink:"Web Link",textEmptyLink:"Enter link here",textEmptyDesc:"Enter caption here",textEmptyTooltip:"Enter tooltip here",strSheet:"Sheet",strRange:"Range",strDisplay:"Display",textTipText:"Screen Tip Text",strLinkTo:"Link To",txtEmpty:"This field is required",textInvalidRange:"ERROR! Invalid cells range",txtNotUrl:'This field should be a URL in the format "http://www.example.com"',textDefault:"Selected range",textSheets:"Sheets",textNames:"Defined names",textGetLink:"Get Link",textCopy:"Copy",textSelectData:"Select data",txtSizeLimit:"This field is limited to 2083 characters",txtUrlPlaceholder:"Enter the web address or select a file",textSelectFile:"Select file"},SSE.Views.HyperlinkSettingsDialog||{}))})),define("spreadsheeteditor/main/app/view/HeaderFooterDialog",[],(function(){"use strict";SSE.Views.HeaderFooterDialog=Common.UI.Window.extend(_.extend({options:{width:650,style:"min-width: 350px;",cls:"modal-dlg enable-key-events",animate:{mask:!1},buttons:["ok","cancel"],id:"window-header-footer"},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.api=this.options.api,this.props=this.options.props,this.fontStore=this.options.fontStore,this.pageSetup=this.options.pageSetup,this.isFooter=!1,this.currentCanvas=null,this.headerControls=[],this.footerControls=[],this._state={clrtext:void 0,bold:void 0,italic:void 0,underline:void 0,strikeout:void 0,subscript:void 0,superscript:void 0,fontsize:void 0,fontname:""},this.template=['<div class="box">','<table cols="2" style="width: 450px;margin-bottom: 30px;">',"<tr>",'<td style="padding-bottom: 8px;">','<div id="id-dlg-hf-ch-first"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="id-dlg-hf-ch-scale"></div>',"</td>","</tr>","<tr>","<td>",'<div id="id-dlg-hf-ch-odd"></div>',"</td>","<td>",'<div id="id-dlg-hf-ch-align"></div>',"</td>","</tr>","</table>",'<div style="margin-bottom: 15px;">','<button type="button" class="btn btn-text-default auto" id="id-dlg-hf-btn-all">',this.textAll,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-odd">',this.textOdd,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-even">',this.textEven,"</button>",'<button type="button" class="btn btn-text-default auto hidden" id="id-dlg-hf-btn-first">',this.textFirst,"</button>","</div>",'<table style="width: 100%;">',"<tr>","<td>",'<label style="margin-bottom: 3px;">'+this.textHeader+"</label>","</td>","</tr>","<tr>",'<td class="display-flex-row-center">','<div id="id-dlg-h-presets"></div>','<div id="id-dlg-h-insert" class="margin-left-2"></div>','<div id="id-dlg-h-fonts" class="margin-left-2" style="flex-grow: 1; flex-shrink: 1;"></div>','<div id="id-dlg-h-font-size" class="margin-left-2"></div>','<div id="id-dlg-h-textcolor" class="margin-left-6" style="flex-shrink: 0;"></div>','<div id="id-dlg-h-bold" class="margin-left-2"></div>','<div id="id-dlg-h-italic" class="margin-left-6"></div>','<div id="id-dlg-h-underline" class="margin-left-6"></div>','<div id="id-dlg-h-strikeout" class="margin-left-6"></div>','<div id="id-dlg-h-subscript" class="margin-left-6"></div>','<div id="id-dlg-h-superscript" class="margin-left-6"></div>',"</td>","</tr>","<tr>","<td>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-left-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-center-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="header-right-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>","</td>","</tr>","<tr>","<td>",'<label style="display: block; margin-top: 10px;margin-bottom: 3px;">'+this.textFooter+"</label>","</td>","</tr>","<tr>",'<td class="display-flex-row-center">','<div id="id-dlg-f-presets"></div>','<div id="id-dlg-f-insert" class="margin-left-2"></div>','<div id="id-dlg-f-fonts" class="margin-left-2" style="flex-grow: 1; flex-shrink: 1;"></div>','<div id="id-dlg-f-font-size" class="margin-left-2"></div>','<div id="id-dlg-f-textcolor" class="margin-left-6" style="flex-shrink: 0;"></div>','<div id="id-dlg-f-bold" class="margin-left-2"></div>','<div id="id-dlg-f-italic" class="margin-left-6"></div>','<div id="id-dlg-f-underline" class="margin-left-6"></div>','<div class="margin-left-6" id="id-dlg-f-strikeout"></div>','<div id="id-dlg-f-subscript" class="margin-left-6"></div>','<div id="id-dlg-f-superscript" class="margin-left-6"></div>',"</td>","</tr>","<tr>","<td>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-left-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div class="preview-container" style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-center-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>",'<div style="display: inline-block;margin-top: 7px;vertical-align: middle;">','<div class="preview-canvas-container" style="width: 206px; height: 92px; position:relative; overflow:hidden;">','<div id="footer-right-img" style="width: 190px; height: 100%;"></div>',"</div>","</div>","</td>","</tr>","<tr>","<td>","</table>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this);var t=this,e=this.getChild();this.chFirstPage=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-first"),labelText:this.textDiffFirst}),this.chFirstPage.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue(),a=this.HFObject?this.HFObject.setDifferentFirst(n):null;if(a){var o=this;this.showError((function(){t.setValue(!n,!0),_.delay((function(){o.onCanvasClick(a)}),50)}))}else this.btnFirst.setVisible(n),!n&&this.btnFirst.isActive()&&(this.btnAll.isVisible()?this.btnAll.toggle(!0):this.btnOdd.toggle(!0))}),this)),this.chOddPage=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-odd"),labelText:this.textDiffOdd}),this.chOddPage.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue(),a=this.HFObject?this.HFObject.setDifferentOddEven(n):null;if(a){var o=this;this.showError((function(){t.setValue(!n,!0),_.delay((function(){o.onCanvasClick(a)}),50)}))}else this.btnOdd.setVisible(n),this.btnEven.setVisible(n),this.btnAll.setVisible(!n),n||!this.btnOdd.isActive()&&!this.btnEven.isActive()||this.btnAll.toggle(!0),n&&this.btnAll.isActive()&&this.btnOdd.toggle(!0)}),this)),this.chScale=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-scale"),labelText:this.textScale}),this.chScale.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue();this.HFObject&&this.HFObject.setScaleWithDoc(n)}),this)),this.chAlign=new Common.UI.CheckBox({el:$("#id-dlg-hf-ch-align"),labelText:this.textAlign}),this.chAlign.on("change",_.bind((function(t,e,i,s){var n="checked"==t.getValue();this.HFObject&&this.HFObject.setAlignWithMargins(n)}),this)),this.btnAll=new Common.UI.Button({el:$("#id-dlg-hf-btn-all"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1,pressed:!0}),this.btnAll.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.odd)),this.btnOdd=new Common.UI.Button({el:$("#id-dlg-hf-btn-odd"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnOdd.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.odd)),this.btnEven=new Common.UI.Button({el:$("#id-dlg-hf-btn-even"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnEven.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.even)),this.btnFirst=new Common.UI.Button({el:$("#id-dlg-hf-btn-first"),enableToggle:!0,toggleGroup:"hf-pages",allowDepress:!1}),this.btnFirst.on("toggle",_.bind(this.onPageTypeToggle,this,Asc.c_oAscHeaderFooterType.first)),Common.UI.GroupedButtons([this.btnAll,this.btnOdd,this.btnEven,this.btnFirst],{underline:!0}),this.btnPresetsH=new Common.UI.Button({parentEl:$("#id-dlg-h-presets"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 122px;",menu:!0}),this.btnPresetsF=new Common.UI.Button({parentEl:$("#id-dlg-f-presets"),cls:"btn-text-menu-default",caption:this.textPresets,style:"width: 122px;",menu:!0});var i=[{caption:this.textPageNum,value:Asc.c_oAscHeaderFooterField.pageNumber},{caption:this.textPageCount,value:Asc.c_oAscHeaderFooterField.pageCount},{caption:this.textDate,value:Asc.c_oAscHeaderFooterField.date},{caption:this.textTime,value:Asc.c_oAscHeaderFooterField.time},{caption:this.textFileName,value:Asc.c_oAscHeaderFooterField.fileName},{caption:this.textSheet,value:Asc.c_oAscHeaderFooterField.sheetName},{caption:this.textImage,value:Asc.c_oAscHeaderFooterField.picture}];this.btnInsertH=new Common.UI.Button({parentEl:$("#id-dlg-h-insert"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width: 120px;",menu:new Common.UI.Menu({style:"min-width: 120px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:i})}),this.btnInsertH.menu.on("item:click",_.bind(this.onObjectSelect,this)),this.headerControls.push(this.btnInsertH),this.btnInsertF=new Common.UI.Button({parentEl:$("#id-dlg-f-insert"),cls:"btn-text-menu-default",caption:this.textInsert,style:"width: 120px;",menu:new Common.UI.Menu({style:"min-width: 120px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:i})}),this.btnInsertF.menu.on("item:click",_.bind(this.onObjectSelect,this)),this.footerControls.push(this.btnInsertF),this.cmbFonts=[],this.cmbFonts.push(new Common.UI.ComboBoxFonts({el:$("#id-dlg-h-fonts"),cls:"input-group-nr",style:"min-width: 90px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName})),this.cmbFonts[0].on("selected",_.bind(this.onFontSelect,this)),this.cmbFonts[0].setValue(this._state.fontname),this.headerControls.push(this.cmbFonts[0]),this.cmbFonts.push(new Common.UI.ComboBoxFonts({el:$("#id-dlg-f-fonts"),cls:"input-group-nr",style:"min-width: 90px;",menuCls:"scrollable-menu",menuStyle:"min-width: 100%;max-height: 270px;",store:new Common.Collections.Fonts,recent:0,hint:this.tipFontName})),this.cmbFonts[1].on("selected",_.bind(this.onFontSelect,this)),this.cmbFonts[1].setValue(this._state.fontname),this.footerControls.push(this.cmbFonts[1]),Common.NotificationCenter.on("fonts:change",_.bind(this.onApiChangeFont,this)),i=[{value:8,displayValue:"8"},{value:9,displayValue:"9"},{value:10,displayValue:"10"},{value:11,displayValue:"11"},{value:12,displayValue:"12"},{value:14,displayValue:"14"},{value:16,displayValue:"16"},{value:18,displayValue:"18"},{value:20,displayValue:"20"},{value:22,displayValue:"22"},{value:24,displayValue:"24"},{value:26,displayValue:"26"},{value:28,displayValue:"28"},{value:36,displayValue:"36"},{value:48,displayValue:"48"},{value:72,displayValue:"72"}],this.cmbFontSize=[],this.cmbFontSize.push(new Common.UI.ComboBox({el:$("#id-dlg-h-font-size"),cls:"input-group-nr",style:"width: 45px;",menuCls:"scrollable-menu",menuStyle:"min-width: 45px;max-height: 270px;",hint:this.tipFontSize,data:i})),this.cmbFontSize[0].on("selected",_.bind(this.onFontSizeSelect,this)),this.cmbFontSize[0].on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize[0].on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),this.cmbFontSize[0].setValue(this._state.fontsize),this.headerControls.push(this.cmbFontSize[0]),this.cmbFontSize.push(new Common.UI.ComboBox({el:$("#id-dlg-f-font-size"),cls:"input-group-nr",style:"width: 45px;",menuCls:"scrollable-menu",menuStyle:"min-width: 45px;max-height: 270px;",hint:this.tipFontSize,data:i})),this.cmbFontSize[1].on("selected",_.bind(this.onFontSizeSelect,this)),this.cmbFontSize[1].on("changed:before",_.bind(this.onFontSizeChanged,this,!0)),this.cmbFontSize[1].on("changed:after",_.bind(this.onFontSizeChanged,this,!1)),this.cmbFontSize[1].setValue(this._state.fontsize),this.footerControls.push(this.cmbFontSize[1]),this.btnBold=[],this.btnBold.push(new Common.UI.Button({parentEl:$("#id-dlg-h-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold})),this.btnBold[0].on("click",_.bind(this.onBoldClick,this)),this.headerControls.push(this.btnBold[0]),this.btnBold.push(new Common.UI.Button({parentEl:$("#id-dlg-f-bold"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-bold",enableToggle:!0,hint:this.textBold})),this.btnBold[1].on("click",_.bind(this.onBoldClick,this)),this.footerControls.push(this.btnBold[1]),this.btnItalic=[],this.btnItalic.push(new Common.UI.Button({parentEl:$("#id-dlg-h-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic})),this.btnItalic[0].on("click",_.bind(this.onItalicClick,this)),this.headerControls.push(this.btnItalic[0]),this.btnItalic.push(new Common.UI.Button({parentEl:$("#id-dlg-f-italic"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-italic",enableToggle:!0,hint:this.textItalic})),this.btnItalic[1].on("click",_.bind(this.onItalicClick,this)),this.footerControls.push(this.btnItalic[1]),this.btnUnderline=[],this.btnUnderline.push(new Common.UI.Button({parentEl:$("#id-dlg-h-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline})),this.btnUnderline[0].on("click",_.bind(this.onUnderlineClick,this)),this.headerControls.push(this.btnUnderline[0]),this.btnUnderline.push(new Common.UI.Button({parentEl:$("#id-dlg-f-underline"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-underline",enableToggle:!0,hint:this.textUnderline})),this.btnUnderline[1].on("click",_.bind(this.onUnderlineClick,this)),this.footerControls.push(this.btnUnderline[1]),this.btnStrikeout=[],this.btnStrikeout.push(new Common.UI.Button({parentEl:$("#id-dlg-h-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout})),this.btnStrikeout[0].on("click",_.bind(this.onStrikeoutClick,this)),this.headerControls.push(this.btnStrikeout[0]),this.btnStrikeout.push(new Common.UI.Button({parentEl:$("#id-dlg-f-strikeout"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-strikeout",enableToggle:!0,hint:this.textStrikeout})),this.btnStrikeout[1].on("click",_.bind(this.onStrikeoutClick,this)),this.footerControls.push(this.btnStrikeout[1]),this.btnSuperscript=[],this.btnSuperscript.push(new Common.UI.Button({parentEl:$("#id-dlg-h-superscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSuperscript})),this.btnSuperscript[0].on("click",_.bind(this.onSuperscriptClick,this)),this.headerControls.push(this.btnSuperscript[0]),this.btnSuperscript.push(new Common.UI.Button({parentEl:$("#id-dlg-f-superscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-superscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSuperscript})),this.btnSuperscript[1].on("click",_.bind(this.onSuperscriptClick,this)),this.footerControls.push(this.btnSuperscript[1]),this.btnSubscript=[],this.btnSubscript.push(new Common.UI.Button({parentEl:$("#id-dlg-h-subscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSubscript})),this.btnSubscript[0].on("click",_.bind(this.onSubscriptClick,this)),this.headerControls.push(this.btnSubscript[0]),this.btnSubscript.push(new Common.UI.Button({parentEl:$("#id-dlg-f-subscript"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-subscript",enableToggle:!0,toggleGroup:"superscriptHFGroup",hint:this.textSubscript})),this.btnSubscript[1].on("click",_.bind(this.onSubscriptClick,this)),this.footerControls.push(this.btnSubscript[1]);var s=function(e){e.setMenu(),e.currentColor="000000",e.setColor(e.currentColor);var i=e.getPicker();return i.currentColor=e.currentColor,e.on("color:select",_.bind(t.onColorSelect,t)),i};this.btnTextColor=[],this.btnTextColor.push(new Common.UI.ButtonColored({parentEl:$("#id-dlg-h-textcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,split:!0,additionalAlign:this.menuAddAlign,menu:!0})),this.btnTextColor[0].on("click",_.bind(this.onTextColor,this)),this.mnuTextColorPicker=[],this.mnuTextColorPicker.push(s(this.btnTextColor[0])),this.headerControls.push(this.btnTextColor[0]),this.btnTextColor.push(new Common.UI.ButtonColored({parentEl:$("#id-dlg-f-textcolor"),cls:"btn-toolbar",iconCls:"toolbar__icon btn-fontcolor",hint:this.textColor,split:!0,additionalAlign:this.menuAddAlign,menu:!0})),this.btnTextColor[1].on("click",_.bind(this.onTextColor,this)),this.mnuTextColorPicker.push(s(this.btnTextColor[1])),this.footerControls.push(this.btnTextColor[1]),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:e.find(".primary")}),e.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.scrollers=[],this.initCanvas("#header-left-img"),this.initCanvas("#header-center-img"),this.initCanvas("#header-right-img"),this.initCanvas("#footer-left-img"),this.initCanvas("#footer-center-img"),this.initCanvas("#footer-right-img"),this.wrapEvents={onApiEditorSelectionChanged:_.bind(this.onApiEditorSelectionChanged,this),onApiResizeEditorHeight:_.bind(this.onApiResizeEditorHeight,this),onUpdateEditorCursorPosition:_.bind(this.onUpdateEditorCursorPosition,this)},this.afterRender()},initCanvas:function(t){var e=this.$window.find(t);e.on("click",_.bind(this.onCanvasClick,this,t)),this.canvasBoxHeight=e.height(),this.scrollers[t]=new Common.UI.Scroller({el:e.parent(),minScrollbarLength:20}),this.scrollers[t].update(),this.scrollers[t].scrollTop(0)},show:function(){Common.UI.Window.prototype.show.apply(this,arguments)},close:function(){this.api.asc_unregisterCallback("asc_onEditorSelectionChanged",this.wrapEvents.onApiEditorSelectionChanged),this.api.asc_unregisterCallback("asc_resizeEditorHeight",this.wrapEvents.onApiResizeEditorHeight),this.api.asc_unregisterCallback("asc_updateEditorCursorPosition",this.wrapEvents.onUpdateEditorCursorPosition),Common.UI.Window.prototype.close.apply(this,arguments),this.HFObject&&this.HFObject.destroy(!1,this.pageSetup)},afterRender:function(){this.api.asc_registerCallback("asc_onEditorSelectionChanged",this.wrapEvents.onApiEditorSelectionChanged),this.api.asc_registerCallback("asc_resizeEditorHeight",this.wrapEvents.onApiResizeEditorHeight),this.api.asc_registerCallback("asc_updateEditorCursorPosition",this.wrapEvents.onUpdateEditorCursorPosition),this.cmbFonts[0].fillFonts(this.fontStore),this.cmbFonts[1].fillFonts(this.fontStore),this.updateThemeColors(),this.HFObject=new Asc.asc_CHeaderFooterEditor(["header-left-img","header-center-img","header-right-img","footer-left-img","footer-center-img","footer-right-img"],205,void 0,this.pageSetup),this._setDefaults(this.props),this.editorCanvas=this.$window.find("#ce-canvas-menu");var t=this;_.delay((function(){t.onCanvasClick("#header-left-img")}),500)},_setDefaults:function(t){var e=[];this.HFObject.getTextPresetsArr().forEach((function(t,i){e.push({caption:t,value:i})})),this.btnPresetsH.setMenu(new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:e})),this.btnPresetsH.menu.on("item:click",_.bind(this.onPresetSelect,this,!1)),this.btnPresetsF.setMenu(new Common.UI.Menu({style:"min-width: 115px;",maxHeight:200,additionalAlign:this.menuAddAlign,items:e})),this.btnPresetsF.menu.on("item:click",_.bind(this.onPresetSelect,this,!0)),this.chOddPage.setValue(this.HFObject.getDifferentOddEven()),this.chFirstPage.setValue(this.HFObject.getDifferentFirst()),this.chAlign.setValue(this.HFObject.getAlignWithMargins()),this.chScale.setValue(this.HFObject.getScaleWithDoc());var i="checked"==this.chOddPage.getValue();this.btnOdd.setVisible(i),this.btnEven.setVisible(i),this.btnAll.setVisible(!i),i?this.btnOdd.toggle(!0):this.btnAll.toggle(!0),i="checked"==this.chFirstPage.getValue(),this.btnFirst.setVisible(i)},updateThemeColors:function(){this.mnuTextColorPicker[0].updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors()),this.mnuTextColorPicker[1].updateColors(Common.Utils.ThemeColor.getEffectColors(),Common.Utils.ThemeColor.getStandartColors())},getSettings:function(){return{}},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onPrimary:function(t){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.HFObject){var e=this.HFObject.destroy("ok"==t,this.pageSetup);if(e){var i=this;return void this.showError((function(){_.delay((function(){i.onCanvasClick(e)}),50)}))}this.HFObject=null}this.options.handler&&this.options.handler.call(this,this,t),this.close()},showError:function(t){Common.UI.warning({title:this.notcriticalErrorTitle,msg:this.textMaxError,callback:t})},scrollerUpdate:function(){for(var t in this.scrollers)this.scrollers[t]&&this.scrollers[t].update()},scrollerScrollTop:function(){for(var t in this.scrollers)this.scrollers[t]&&this.scrollers[t].scrollTop(0)},onCanvasClick:function(t,e){if(this.HFObject){t=t||"#header-left-img";var i=this.currentCanvas!==t;if(i){this.currentCanvas=t,this.isFooter="#footer-left-img"==t||"#footer-center-img"==t||"#footer-right-img"==t;var s=this;this.headerControls.forEach((function(t){t.setDisabled(s.isFooter)})),this.footerControls.forEach((function(t){t.setDisabled(!s.isFooter)}))}e?this.HFObject.click(t,e.pageX,e.pageY):this.HFObject.click(t),i&&this.scrollerUpdate()}},onApiResizeEditorHeight:function(t){if(this.editorCanvas){var e=this.editorCanvas.height();e!=this.editorCanvasHeight&&(this.editorCanvasHeight=e,this.scrollers[this.currentCanvas]&&this.scrollers[this.currentCanvas].update())}},onUpdateEditorCursorPosition:function(t,e){if(this.editorCanvas){var i=this.currentCanvas;if(this.scrollers[i]){var s=this.scrollers[i].getScrollTop();t+e>s+this.canvasBoxHeight?this.scrollers[i].scrollTop(t+e-this.canvasBoxHeight):t<s&&this.scrollers[i].scrollTop(t)}}},onPresetSelect:function(t,e,i){this.HFObject&&this.HFObject.applyPreset(i.value,!!t),this.onCanvasClick(t?"#footer-left-img":"#header-left-img")},onObjectSelect:function(t,e){this.HFObject&&this.HFObject.addField(e.value),this.onCanvasClick(this.currentCanvas)},onFontSelect:function(t,e){this.HFObject&&this.HFObject.setFontName(e.name),this.onCanvasClick(this.currentCanvas)},onFontSizeSelect:function(t,e){this.HFObject&&this.HFObject.setFontSize(e.value),this.onCanvasClick(this.currentCanvas)},onFontSizeChanged:function(t,e,i,s){var n;if(t){if(!e.store.findWhere({displayValue:i.value})&&!(n=/^\+?(\d*(\.|,)?\d+)$|^\+?(\d+(\.|,)?\d*)$/.exec(i.value)))return n=e.getValue(),e.setRawValue(n),s.preventDefault(),!1}else n=(n=Common.Utils.String.parseFloat(i.value))>409?409:n<1?1:Math.floor(2*(n+.4))/2,e.setRawValue(n),this.HFObject&&this.HFObject.setFontSize(n)},onBoldClick:function(t,e){this.HFObject&&(this.HFObject.setBold(t.pressed),this.scrollerUpdate())},onItalicClick:function(t,e){this.HFObject&&(this.HFObject.setItalic(t.pressed),this.scrollerUpdate())},onUnderlineClick:function(t,e){this.HFObject&&(this.HFObject.setUnderline(t.pressed),this.scrollerUpdate())},onStrikeoutClick:function(t,e){this.HFObject&&(this.HFObject.setStrikeout(t.pressed),this.scrollerUpdate())},onSuperscriptClick:function(t,e){this.HFObject&&(this.HFObject.setSuperscript(t.pressed),this.scrollerUpdate())},onSubscriptClick:function(t,e){this.HFObject&&(this.HFObject.setSubscript(t.pressed),this.scrollerUpdate())},onTextColor:function(){var t=this.mnuTextColorPicker[this.isFooter?1:0];t.trigger("select",t,t.currentColor,!0)},onColorSelect:function(t,e){t.currentColor=e,t.colorPicker.currentColor=e,this.HFObject&&this.HFObject.setTextColor(Common.Utils.ThemeColor.getRgbColor(e)),this.onCanvasClick(this.currentCanvas)},onPageTypeToggle:function(t,e,i){if(!this._pagetype&&i&&this.HFObject){var s=this.HFObject.getPageType(),n=this.HFObject.switchHeaderFooterType(t);if(n){this._pagetype=!0;var a=this;return void this.showError((function(){switch(s){case Asc.c_oAscHeaderFooterType.odd:a.btnOdd.isVisible()?a.btnOdd.toggle(!0):a.btnAll.toggle(!0);break;case Asc.c_oAscHeaderFooterType.even:a.btnEven.toggle(!0);break;case Asc.c_oAscHeaderFooterType.first:a.btnFirst.toggle(!0)}_.delay((function(){a.onCanvasClick(n)}),50),a._pagetype=!1}))}this.scrollerScrollTop(),this.onCanvasClick(this.currentCanvas,void 0,!0)}},onApiChangeFont:function(t){this.cmbFonts[this.isFooter?1:0].onApiChangeFont(t)},onApiEditorSelectionChanged:function(t){var e,i=this.isFooter?1:0;t.asc_getFontName()!=this.cmbFonts[i].getValue()&&Common.NotificationCenter.trigger("fonts:change",t),e=t.asc_getFontBold(),this.btnBold[i].isActive()!==e&&this.btnBold[i].toggle(!0===e,!0),e=t.asc_getFontItalic(),this.btnItalic[i].isActive()!==e&&this.btnItalic[i].toggle(!0===e,!0),e=t.asc_getFontUnderline(),this.btnUnderline[i].isActive()!==e&&this.btnUnderline[i].toggle(!0===e,!0),e=t.asc_getFontStrikeout(),this.btnStrikeout[i].isActive()!==e&&this.btnStrikeout[i].toggle(!0===e,!0),e=t.asc_getFontSubscript(),this.btnSubscript[i].isActive()!==e&&this.btnSubscript[i].toggle(!0===e,!0),e=t.asc_getFontSuperscript(),this.btnSuperscript[i].isActive()!==e&&this.btnSuperscript[i].toggle(!0===e,!0);var s=t.asc_getFontSize();this.cmbFontSize[i].getValue()!==s&&this.cmbFontSize[i].setValue(void 0!==s?s:"");var n,a,o=this.mnuTextColorPicker[i];(a=t.asc_getFontColor())&&(n=a.get_type()==Asc.c_oAscColor.COLOR_TYPE_SCHEME?{color:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b()),effectValue:a.get_value()}:Common.Utils.ThemeColor.getHexColor(a.get_r(),a.get_g(),a.get_b())),Common.Utils.ThemeColor.selectPickerColorByEffect(n,o)},tipFontName:"Font",tipFontSize:"Font size",textBold:"Bold",textItalic:"Italic",textUnderline:"Underline",textStrikeout:"Strikeout",textSuperscript:"Superscript",textSubscript:"Subscript",textTitle:"Header/Footer Settings",textHeader:"Header",textFooter:"Footer",textLeft:"Left",textCenter:"Center",textRight:"Right",textPageNum:"Page number",textPageCount:"Page count",textDate:"Date",textTime:"Time",textFileName:"File name",textSheet:"Sheet name",textColor:"Text color",textNewColor:"Add New Custom Color",textInsert:"Insert",textPresets:"Presets",textDiffFirst:"Different first page",textDiffOdd:"Different odd and even pages",textScale:"Scale with document",textAlign:"Align with page margins",textFirst:"First page",textOdd:"Odd page",textEven:"Even page",textAll:"All pages",textMaxError:"The text string you entered is too long. Reduce the number of characters used.",textImage:"Picture"},SSE.Views.HeaderFooterDialog||{}))})),define("spreadsheeteditor/main/app/view/AdvancedSeparatorDialog",[],(function(){"use strict";SSE.Views.AdvancedSeparatorDialog=Common.UI.Window.extend(_.extend({options:{width:330,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){_.extend(this.options,{title:this.textTitle},t||{}),this.template=['<div class="box">','<div style="margin-bottom: 8px;">'+this.textLabel+"</div>",'<div style="margin-bottom: 12px;">','<div id="id-adv-separator-decimal" class="display-inline-block-top"></div><label class="input-row margin-left-10" style="padding-top: 4px;">'+this.strDecimalSeparator+"</label>","</div>",'<div style="margin-bottom: 10px;">','<div id="id-adv-separator-thousands" class="display-inline-block-top"></div><label class="input-row margin-left-10" style="padding-top: 4px;">'+this.strThousandsSeparator+"</label>","</div>","<div>","<label>"+this.textQualifier+"</label>","</div>",'<div style="margin-bottom: 10px;">','<div id="id-adv-separator-qualifier" class="input-group-nr"></div>',"</div>","</div>"].join(""),this.options.tpl=_.template(this.template)(this.options),this.props=t.props,Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.inputDecimalSeparator=new Common.UI.InputField({el:$("#id-adv-separator-decimal"),style:"width: 35px;",maxLength:1,validateOnBlur:!1}),this.inputThousandsSeparator=new Common.UI.InputField({el:$("#id-adv-separator-thousands"),style:"width: 35px;",maxLength:1,validateOnBlur:!1}),this.cmbQualifier=new Common.UI.ComboBox({el:$("#id-adv-separator-qualifier"),style:"width: 100px;",menuStyle:"min-width: 100px;",cls:"input-group-nr",data:[{value:'"',displayValue:'"'},{value:"'",displayValue:"'"},{value:null,displayValue:this.txtNone}],editable:!1,takeFocusOnClose:!0}),this.getChild().find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.afterRender()},getFocusedComponents:function(){return[this.inputDecimalSeparator,this.inputThousandsSeparator,this.cmbQualifier].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputDecimalSeparator},afterRender:function(){this._setDefaults(this.props)},_setDefaults:function(t){t&&(this.inputDecimalSeparator.setValue(t.decimal||""),this.inputThousandsSeparator.setValue(t.thousands||""),this.cmbQualifier.setValue(t.qualifier||null))},onPrimary:function(t){return this._handleInput("ok"),!1},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},_handleInput:function(t){this.options.handler&&this.options.handler.call(this,t,{decimal:this.inputDecimalSeparator.getValue(),thousands:this.inputThousandsSeparator.getValue(),qualifier:this.cmbQualifier.getValue()}),this.close()},textTitle:"Advanced Settings",textLabel:"Settings used to recognize numeric data",strDecimalSeparator:"Decimal separator",strThousandsSeparator:"Thousands separator",txtNone:"(none)",textQualifier:"Text qualifier"},SSE.Views.AdvancedSeparatorDialog||{}))})),define("spreadsheeteditor/main/app/view/AutoFilterDialog",[],(function(){"use strict";SSE.Views=SSE.Views||{},SSE.Views.DigitalFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};_.extend(e,{width:"date"===t.type?528:501,contentWidth:180,header:!0,cls:"filter-dlg modal-dlg"+("date"===t.type?" date-filter":""),contentTemplate:"",title:this.txtTitle,items:[],buttons:["ok","cancel"]},t),this.template=t.template||['<div class="box">','<div class="content-panel" >','<label class="header">',this.textShowRows,"</label>",'<div class="combo-container-1">','<div id="id-search-begin-digital-combo" class="input-group-nr"></div>','<div id="id-sd-cell-search-begin" class="margin-left-18"></div>','<% if (type === "date") {%>','<div id="id-btn-date-picker-1" class="margin-left-5"></div>',"<% } %>","</div>","<div>",'<div id="id-and-radio" class="padding-small"></div>','<div id="id-or-radio" class="padding-small margin-left-22"></div>',"</div>",'<div class="combo-container-2">','<div id="id-search-end-digital-combo" class="input-group-nr"></div>','<div id="id-sd-cell-search-end" class="margin-left-18"></div>','<% if (type === "date") {%>','<div id="id-btn-date-picker-2" class="margin-left-5"></div>',"<% } %>","</div>","</div>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.type=t.type||"number","date"===this.type&&(this.datePickers=[]),e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.conditions=[{value:Asc.c_oAscCustomAutoFilter.equals,displayValue:this.capCondition1},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,displayValue:this.capCondition2},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,displayValue:"date"!==this.type?this.capCondition3:this.capCondition30},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,displayValue:"date"!==this.type?this.capCondition4:this.capCondition40},{value:Asc.c_oAscCustomAutoFilter.isLessThan,displayValue:"date"!==this.type?this.capCondition5:this.capCondition50},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,displayValue:"date"!==this.type?this.capCondition6:this.capCondition60}],"text"!=this.type&&"date"!=this.type||(this.conditions=this.conditions.concat([{value:Asc.c_oAscCustomAutoFilter.beginsWith,displayValue:this.capCondition7},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,displayValue:this.capCondition8},{value:Asc.c_oAscCustomAutoFilter.endsWith,displayValue:this.capCondition9},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,displayValue:this.capCondition10},{value:Asc.c_oAscCustomAutoFilter.contains,displayValue:this.capCondition11},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,displayValue:this.capCondition12}])),this.cmbCondition1=new Common.UI.ComboBox({el:$("#id-search-begin-digital-combo",this.$window),menuStyle:"min-width: 225px;max-height: 135px;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition1.setValue(Asc.c_oAscCustomAutoFilter.equals),this.conditions.splice(0,0,{value:0,displayValue:this.textNoFilter}),this.cmbCondition2=new Common.UI.ComboBox({el:$("#id-search-end-digital-combo",this.$window),menuStyle:"min-width: 225px;max-height: 135px;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition2.setValue(0),this.rbAnd=new Common.UI.RadioBox({el:$("#id-and-radio",this.$window),labelText:this.capAnd,name:"asc-radio-filter-tab",checked:!0}),this.rbOr=new Common.UI.RadioBox({el:$("#id-or-radio",this.$window),labelText:this.capOr,name:"asc-radio-filter-tab"}),this.cmbValue1=new Common.UI.ComboBox({el:$("#id-sd-cell-search-begin",this.$window),cls:"input-group-nr",menuStyle:"min-width: 225px;max-height: 135px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}),this.cmbValue2=new Common.UI.ComboBox({el:$("#id-sd-cell-search-end",this.$window),cls:"input-group-nr",menuStyle:"min-width: 225px;max-height: 135px;",scrollAlwaysVisible:!0,data:[],takeFocusOnClose:!0}),"date"===this.type&&(this.btnDatePicker1=new Common.UI.Button({parentEl:$("#id-btn-date-picker-1",this.$window),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon btn-date",hint:this.txtSelectDate}),this.btnDatePicker1.on("click",_.bind(this.showDatePicker,this)),this.btnDatePicker2=new Common.UI.Button({parentEl:$("#id-btn-date-picker-2",this.$window),cls:"btn-toolbar bg-white",iconCls:"toolbar__icon btn-date",hint:this.txtSelectDate}),this.btnDatePicker2.on("click",_.bind(this.showDatePicker,this)));this.cmbValue1.store.comparator=this.cmbValue2.store.comparator=function(t,e){var i=t.get("intval"),s=e.get("intval"),n=void 0!==i;return n!==(void 0!==s)?n?-1:1:(!n&&(i=t.get("value").toLowerCase())&&(s=e.get("value").toLowerCase()),i===s?0:""===s||""!==i&&i<s?-1:1)},this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbCondition1,this.cmbValue1,this.rbAnd,this.rbOr,this.cmbCondition2,this.cmbValue2].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbValue1},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){if(this.properties&&this.rbOr&&this.rbAnd&&this.cmbCondition1&&this.cmbCondition2&&this.cmbValue1&&this.cmbValue2){var t=[];this.properties.asc_getValues().forEach((function(e){var i=e.asc_getText();_.isEmpty(i)||t.push({value:i,displayValue:i,intval:!isNaN(parseFloat(i))&&isFinite(i)?parseFloat(i):void 0})})),this.cmbValue1.setData(t),this.cmbValue2.setData(t);var e=this.properties.asc_getFilterObj();if(e.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters){var i=e.asc_getFilter(),s=i.asc_getCustomFilters();i.asc_getAnd()?this.rbAnd.setValue(!0):this.rbOr.setValue(!0),this.cmbCondition1.setValue(s[0].asc_getOperator()||Asc.c_oAscCustomAutoFilter.equals),this.cmbCondition2.setValue(s.length>1&&s[1].asc_getOperator()||0),this.cmbValue1.setValue(null===s[0].asc_getVal()?"":s[0].asc_getVal()),this.cmbValue2.setValue(s.length>1?null===s[1].asc_getVal()?"":s[1].asc_getVal():"")}}},save:function(){if(this.api&&this.properties&&this.rbOr&&this.rbAnd&&this.cmbCondition1&&this.cmbCondition2&&this.cmbValue1&&this.cmbValue2){var t=this.properties.asc_getFilterObj();t.asc_setFilter(new Asc.CustomFilters),t.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters);var e=t.asc_getFilter();e.asc_setCustomFilters(0==this.cmbCondition2.getValue()?[new Asc.CustomFilter]:[new Asc.CustomFilter,new Asc.CustomFilter]);var i=e.asc_getCustomFilters();e.asc_setAnd(this.rbAnd.getValue()),i[0].asc_setOperator(this.cmbCondition1.getValue()),i[0].asc_setVal(this.cmbValue1.getValue()),0!==this.cmbCondition2.getValue()&&(i[1].asc_setOperator(this.cmbCondition2.getValue()||void 0),i[1].asc_setVal(this.cmbValue2.getValue())),this.api.asc_applyAutoFilter(this.properties)}},onPrimary:function(){return this.save(),this.close(),!1},showDatePicker:function(t){Common.UI.Menu.Manager.hideAll();var e,i=t.$el.attr("id"),s=parseInt(i.slice(-1)),n=1===s?this.cmbValue1:this.cmbValue2;this.datePickers[s]?e=t.$el.find("#date-picker-"+s):(e=$('<div id="date-picker-'+s+'"><div id="date-picker-control'+s+'"></div></div>'),t.$el.append(e),this.datePickers[s]=new Common.UI.Calendar({el:e.find("#date-picker-control"+s),enableKeyEvents:!0,firstday:1}),this.datePickers[s].on("date:click",_.bind((function(t,i){n.setValue(new Date(i).toLocaleString().split(",")[0].replace(/\./g,"/")),e.hide()}),this)),$(document).on("mousedown",(function(t){"canvas"!==t.target.localName&&e.is(":visible")&&0==e.find(t.target).length&&e.hide()}))),e.show()},capAnd:"And",capCondition1:"equals",capCondition10:"does not end with",capCondition11:"contains",capCondition12:"does not contain",capCondition2:"does not equal",capCondition3:"is greater than",capCondition30:"is after",capCondition4:"is greater than or equal to",capCondition40:"is after or equal to",capCondition5:"is less than",capCondition50:"is before",capCondition6:"is less than or equal to",capCondition60:"is before or equal to",capCondition7:"begins with",capCondition8:"does not begin with",capCondition9:"ends with",capOr:"Or",textNoFilter:"no filter",textShowRows:"Show rows where",textUse1:"Use ? to present any single character",textUse2:"Use * to present any series of character",txtTitle:"Custom Filter",txtSelectDate:"Select date"},SSE.Views.DigitalFilterDialog||{})),SSE.Views.Top10FilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};this.type=t.type,_.extend(i,{width:"value"==this.type?450:318,contentWidth:180,header:!0,cls:"filter-dlg modal-dlg",contentTemplate:"",title:e.txtTitle,items:[],buttons:["ok","cancel"]},t),this.template=t.template||['<div class="box">','<div class="content-panel" >',"<label>",e.textType,"</label>","<div>",'<div id="id-top10-type-combo" class="margin-right-10" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-top10-count-spin" class="input-group-nr margin-right-10" style="display: inline-block; vertical-align: middle;"></div>','<div id="id-top10-item-combo" class="input-group-nr" style="display: inline-block; vertical-align: middle;"></div>','<label id="id-top10-lblby" class="input-group-nr" style="min-width: 40px; text-align: center; display: inline-block; vertical-align: middle;">'+e.txtBy+"</label>",'<div id="id-top10-fields-combo" class="input-group-nr" style="width:100px;display: inline-block; vertical-align: middle;"></div>',"</div>","</div>","</div>"].join(""),this.api=t.api,this.handler=t.handler,i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this),this.cmbType=new Common.UI.ComboBox({el:$("#id-top10-type-combo",this.$window),style:"width: 85px;",menuStyle:"min-width: 85px;",cls:"input-group-nr",data:[{value:!0,displayValue:this.txtTop},{value:!1,displayValue:this.txtBottom}],editable:!1,takeFocusOnClose:!0}),this.cmbType.setValue(!0);var t=[{value:!1,displayValue:this.txtItems},{value:!0,displayValue:this.txtPercent}];"value"==this.type&&t.push({value:0,displayValue:this.txtSum}),this.cmbItem=new Common.UI.ComboBox({el:$("#id-top10-item-combo",this.$window),style:"width: 85px;",menuStyle:"min-width: 85px;",cls:"input-group-nr",data:t,editable:!1,takeFocusOnClose:!0}),this.cmbItem.setValue(!1),this.cmbItem.on("selected",_.bind((function(t,e){this.spnCount.setDefaultUnit(e.value?"%":"")}),this)),this.spnCount=new Common.UI.MetricSpinner({el:$("#id-top10-count-spin"),step:1,width:85,defaultUnit:"",value:"10",maxValue:500,minValue:1}),this.cmbFields=new Common.UI.ComboBox({el:$("#id-top10-fields-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFields.setVisible("value"==this.type),"value"!==this.type&&this.$window.find("#id-top10-lblby").addClass("hidden"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbType,this.spnCount,this.cmbItem,this.cmbFields].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.spnCount},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){if(this.properties){var t=!1;if("value"==this.type){var e=this.properties.asc_getPivotObj(),i=e.asc_getDataFieldIndexFilter(),s=e.asc_getDataFields();t=e.asc_getIsTop10Sum(),this.setTitle(this.txtValueTitle+" ("+s[0]+")"),s.shift();var n=[];s&&s.forEach((function(t,e){t&&n.push({value:e,displayValue:t})})),this.cmbFields.setData(n),this.cmbFields.setValue(0!==i?i-1:0)}var a=this.properties.asc_getFilterObj();if(a.asc_getType()==Asc.c_oAscAutoFilterTypes.Top10){var o=a.asc_getFilter(),l=o.asc_getTop(),r=o.asc_getPercent();this.cmbType.setValue(l||null===l),this.cmbItem.setValue(t?0:r||null===r),this.spnCount.setDefaultUnit(!r&&null!==r||t?"":"%"),this.spnCount.setValue(o.asc_getVal())}}},save:function(){if(this.api&&this.properties){var t=this.properties.asc_getFilterObj();t.asc_setFilter(new Asc.Top10),t.asc_setType(Asc.c_oAscAutoFilterTypes.Top10);var e=t.asc_getFilter();if(e.asc_setTop(this.cmbType.getValue()),e.asc_setPercent(!0===this.cmbItem.getValue()),e.asc_setVal(this.spnCount.getNumberValue()),"value"==this.type){var i=this.properties.asc_getPivotObj();i.asc_setIsTop10Sum(0===this.cmbItem.getValue()),i.asc_setDataFieldIndexFilter("value"==this.type?this.cmbFields.getValue()+1:0)}this.api.asc_applyAutoFilter(this.properties)}},onPrimary:function(){return this.save(),this.close(),!1},txtTitle:"Top 10 AutoFilter",textType:"Show",txtTop:"Top",txtBottom:"Bottom",txtItems:"Item",txtPercent:"Percent",txtValueTitle:"Top 10 Filter",txtSum:"Sum",txtBy:"by"},SSE.Views.Top10FilterDialog||{})),SSE.Views.PivotDigitalFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e=this,i={};_.extend(i,{width:501,contentWidth:180,header:!0,cls:"filter-dlg modal-dlg",contentTemplate:"",title:"label"==t.type?e.txtTitleLabel:e.txtTitleValue,items:[],buttons:["ok","cancel"]},t),this.api=t.api,this.handler=t.handler,this.type=t.type||"value",this.template=t.template||['<div class="box">','<div class="content-panel" >','<label class="header">',"label"==e.type?e.textShowLabel:e.textShowValue,"</label>",'<div style="margin-top:15px;">','<div id="id-field-digital-combo" class="input-group-nr margin-right-10" style="vertical-align:middle;width:110px;display:inline-block;"></div>','<div id="id-cond-digital-combo" class="input-group-nr margin-right-10" style="vertical-align:middle;width:'+("label"==e.type?225:110)+'px;display:inline-block;"></div>','<div id="id-input-digital-value1" class="" style="vertical-align: middle; width:225px;display:inline-block;"></div>','<label id="id-label-digital-and" class="margin-left-5" style="vertical-align: middle;">'+this.txtAnd+"</label>",'<div id="id-input-digital-value2" class="margin-left-5" style="vertical-align: middle; width:100px;display:inline-block;"></div>',"</div>",'<div style="margin-top:10px;">','<label style="display:block;">'+e.textUse1+"</label>",'<label style="display:block;">'+e.textUse2+"</label>","</div>","</div>","</div>"].join(""),i.tpl=_.template(this.template)(i),Common.UI.Window.prototype.initialize.call(this,i)},render:function(){Common.UI.Window.prototype.render.call(this),this.conditions=[{value:Asc.c_oAscCustomAutoFilter.equals,displayValue:this.capCondition1},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,displayValue:this.capCondition2},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,displayValue:this.capCondition3},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,displayValue:this.capCondition4},{value:Asc.c_oAscCustomAutoFilter.isLessThan,displayValue:this.capCondition5},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,displayValue:this.capCondition6},{value:-2,displayValue:this.capCondition13},{value:-3,displayValue:this.capCondition14}],"label"==this.type&&(this.conditions=this.conditions.concat([{value:Asc.c_oAscCustomAutoFilter.beginsWith,displayValue:this.capCondition7},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,displayValue:this.capCondition8},{value:Asc.c_oAscCustomAutoFilter.endsWith,displayValue:this.capCondition9},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,displayValue:this.capCondition10},{value:Asc.c_oAscCustomAutoFilter.contains,displayValue:this.capCondition11},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,displayValue:this.capCondition12}])),this.cmbCondition1=new Common.UI.ComboBox({el:$("#id-cond-digital-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:this.conditions,scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbCondition1.setValue(Asc.c_oAscCustomAutoFilter.equals),this.cmbCondition1.on("selected",_.bind((function(t,e){var i=-2==e.value||-3==e.value;this.inputValue2.setVisible(i),this.lblAnd.toggleClass("hidden",!i),this.inputValue.$el.width(i?100:225);var s=this;setTimeout((function(){s.inputValue&&s.inputValue.focus()}),10)}),this)),this.cmbFields=new Common.UI.ComboBox({el:$("#id-field-digital-combo",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFields.setVisible("value"==this.type),this.cmbFields.on("selected",_.bind((function(t,e){var i=this;setTimeout((function(){i.inputValue&&i.inputValue.focus()}),10)}),this)),this.inputValue=new Common.UI.InputField({el:$("#id-input-digital-value1"),allowBlank:!1,style:"width: 100%;",validateOnBlur:!1}),this.inputValue2=new Common.UI.InputField({el:$("#id-input-digital-value2"),allowBlank:!1,style:"width: 100%;",validateOnBlur:!1}),this.lblAnd=this.$window.find("#id-label-digital-and"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.cmbFields,this.cmbCondition1,this.inputValue,this.inputValue2].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputValue},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){if(this.properties&&this.cmbCondition1&&this.cmbFields&&this.inputValue){var t=this.properties.asc_getPivotObj(),e=t.asc_getDataFieldIndexFilter(),i=t.asc_getDataFields();if(this.setTitle(this.options.title+" ("+i[0]+")"),"value"==this.type){i.shift();var s=[];i&&i.forEach((function(t,e){t&&s.push({value:e,displayValue:t})})),this.cmbFields.setData(s),this.cmbFields.setValue(0!==e?e-1:0)}var n=this.properties.asc_getFilterObj();if(n.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters){var a=n.asc_getFilter(),o=a.asc_getCustomFilters(),l=o[0].asc_getOperator();if(o.length>1){var r=a.asc_getAnd(),c=o[0].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&o[1].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,d=o[0].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isLessThan&&o[1].asc_getOperator()==Asc.c_oAscCustomAutoFilter.isGreaterThan;r&&c?l=-2:!r&&d&&(l=-3)}this.cmbCondition1.setValue(l||Asc.c_oAscCustomAutoFilter.equals),this.inputValue.setValue(null===o[0].asc_getVal()?"":o[0].asc_getVal()),this.inputValue.$el.width(-2==l||-3==l?100:225),this.lblAnd.toggleClass("hidden",!(-2==l||-3==l)),this.inputValue2.setVisible(-2==l||-3==l),this.inputValue2.setValue(o.length>1?null===o[1].asc_getVal()?"":o[1].asc_getVal():"")}}},save:function(){if(this.api&&this.properties&&this.cmbCondition1&&this.cmbFields&&this.inputValue){var t=this.properties.asc_getFilterObj();t.asc_setFilter(new Asc.CustomFilters),t.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters);var e=t.asc_getFilter(),i=this.cmbCondition1.getValue();if(-2==i)e.asc_setCustomFilters([new Asc.CustomFilter,new Asc.CustomFilter]),e.asc_setAnd(!0),(s=e.asc_getCustomFilters())[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo),s[0].asc_setVal(this.inputValue.getValue()),s[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),s[1].asc_setVal(this.inputValue2.getValue());else if(-3==i){e.asc_setCustomFilters([new Asc.CustomFilter,new Asc.CustomFilter]),e.asc_setAnd(!1),(s=e.asc_getCustomFilters())[0].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThan),s[0].asc_setVal(this.inputValue.getValue()),s[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThan),s[1].asc_setVal(this.inputValue2.getValue())}else{var s;e.asc_setCustomFilters([new Asc.CustomFilter]),e.asc_setAnd(!0),(s=e.asc_getCustomFilters())[0].asc_setOperator(this.cmbCondition1.getValue()),s[0].asc_setVal(this.inputValue.getValue())}this.properties.asc_getPivotObj().asc_setDataFieldIndexFilter("value"==this.type?this.cmbFields.getValue()+1:0),this.api.asc_applyAutoFilter(this.properties)}},onPrimary:function(){return this.save(),this.close(),!1},capCondition1:"equals",capCondition10:"does not end with",capCondition11:"contains",capCondition12:"does not contain",capCondition2:"does not equal",capCondition3:"is greater than",capCondition4:"is greater than or equal to",capCondition5:"is less than",capCondition6:"is less than or equal to",capCondition7:"begins with",capCondition8:"does not begin with",capCondition9:"ends with",textShowLabel:"Show items for which the label:",textShowValue:"Show items for which:",textUse1:"Use ? to present any single character",textUse2:"Use * to present any series of character",txtTitleValue:"Value Filter",txtTitleLabel:"Label Filter",capCondition13:"between",capCondition14:"not between",txtAnd:"and"},SSE.Views.PivotDigitalFilterDialog||{})),SSE.Views.SortFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={};this.type=t.type,_.extend(e,{width:250,contentWidth:180,header:!0,cls:"filter-dlg modal-dlg",contentTemplate:"",title:this.txtTitle,items:[],buttons:["ok","cancel"]},t),this.template=t.template||['<div class="box">','<div class="content-panel" >','<div id="id-sort-filter-radio-nosort" style="margin-bottom: 4px;"></div>','<div id="id-sort-filter-radio-asc" style="margin-bottom: 4px;"></div>','<div id="id-sort-filter-fields-asc" class="input-group-nr margin-left-22" style="margin-bottom: 10px;"></div>','<div id="id-sort-filter-radio-desc" style="margin-bottom: 4px;"></div>','<div id="id-sort-filter-fields-desc" class="input-group-nr margin-left-22"></div>',"</div>","</div>"].join(""),this.api=t.api,this.handler=t.handler,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e)},render:function(){Common.UI.Window.prototype.render.call(this),this.radioNoSort=new Common.UI.RadioBox({el:$("#id-sort-filter-radio-nosort"),labelText:this.textNoSort,name:"asc-radio-sort"}),this.radioNoSort.on("change",_.bind((function(t,e){e&&this.cmbFieldsAsc.setDisabled(!0),e&&this.cmbFieldsDesc.setDisabled(!0)}),this)),this.radioAsc=new Common.UI.RadioBox({el:$("#id-sort-filter-radio-asc"),labelText:this.textAsc,name:"asc-radio-sort",checked:!0}),this.radioAsc.on("change",_.bind((function(t,e){e&&this.cmbFieldsAsc.setDisabled(!1),e&&this.cmbFieldsDesc.setDisabled(!0)}),this)),this.radioDesc=new Common.UI.RadioBox({el:$("#id-sort-filter-radio-desc"),labelText:this.textDesc,name:"asc-radio-sort"}),this.radioDesc.on("change",_.bind((function(t,e){e&&this.cmbFieldsAsc.setDisabled(!0),e&&this.cmbFieldsDesc.setDisabled(!1)}),this)),this.cmbFieldsAsc=new Common.UI.ComboBox({el:$("#id-sort-filter-fields-asc",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,takeFocusOnClose:!0}),this.cmbFieldsDesc=new Common.UI.ComboBox({el:$("#id-sort-filter-fields-desc",this.$window),menuStyle:"min-width: 100%;max-height: 135px;",style:"width:100%;",cls:"input-group-nr",data:[],scrollAlwaysVisible:!0,editable:!1,disabled:!0,takeFocusOnClose:!0}),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.loadDefaults()},getFocusedComponents:function(){return[this.radioNoSort,this.radioAsc,this.cmbFieldsAsc,this.radioDesc,this.cmbFieldsDesc].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.cmbFieldsAsc.isDisabled()?this.cmbFieldsDesc:this.cmbFieldsAsc},show:function(){Common.UI.Window.prototype.show.call(this)},close:function(){this.api&&this.api.asc_enableKeyEvents(!0),Common.UI.Window.prototype.close.call(this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&("ok"===t.currentTarget.attributes.result.value&&this.save(),this.close())},setSettings:function(t){this.properties=t},loadDefaults:function(){if(this.properties){var t=0,e=Asc.c_oAscSortOptions.Ascending,i=[];if(this.properties.filter){var s=this.properties.filter,n=(a=s.asc_getPivotObj()).asc_getDataFields();t=a.asc_getDataFieldIndexSorting(),e=s.asc_getSortState(),n&&n.forEach((function(t,e){t&&i.push({value:e,displayValue:t,filter:s,indexSorting:e})})),this.setTitle(this.txtTitle+" ("+n[0]+")"),this.radioNoSort.setValue(null==e,!0),this.cmbFieldsAsc.setDisabled(e===Asc.c_oAscSortOptions.Descending||null===e)}else if(this.properties.rowFilter&&this.properties.colFilter){this.radioNoSort.setVisible(!1),this.setTitle(this.txtTitleValue);n=(a=this.properties.rowFilter.asc_getPivotObj()).asc_getDataFields();var a,o=a.asc_getDataFieldIndexSorting();i.push({value:0,displayValue:n[0],filter:this.properties.rowFilter,indexSorting:1}),n=(a=this.properties.colFilter.asc_getPivotObj()).asc_getDataFields();var l=a.asc_getDataFieldIndexSorting();i.push({value:1,displayValue:n[0],filter:this.properties.colFilter,indexSorting:1}),o>0||o===l?(t=0,e=this.properties.rowFilter.asc_getSortState()):(t=1,e=this.properties.colFilter.asc_getSortState()),null==e&&this.radioAsc.setValue(!0,!0),this.cmbFieldsAsc.setDisabled(e===Asc.c_oAscSortOptions.Descending)}this.cmbFieldsAsc.setData(i),this.cmbFieldsAsc.setValue(t>=0?t:0),this.cmbFieldsDesc.setData(i),this.cmbFieldsDesc.setValue(t>=0?t:0),this.radioDesc.setValue(e==Asc.c_oAscSortOptions.Descending,!0),this.cmbFieldsDesc.setDisabled(e!==Asc.c_oAscSortOptions.Descending)}},save:function(){if(this.api&&this.properties)if(this.radioNoSort.getValue()){(t=this.properties.filter)&&(t.asc_setSortState(null),this.api.asc_applyAutoFilter(t))}else{var t,e=(this.radioAsc.getValue()?this.cmbFieldsAsc:this.cmbFieldsDesc).getSelectedRecord();if(e)(t=e.filter).asc_getPivotObj().asc_setDataFieldIndexSorting(e.indexSorting),t.asc_setSortState(this.radioAsc.getValue()?Asc.c_oAscSortOptions.Ascending:Asc.c_oAscSortOptions.Descending),this.api.asc_applyAutoFilter(t)}},onPrimary:function(){return this.save(),this.close(),!1},txtTitle:"Sort",txtTitleValue:"Sort by value",textNoSort:"No sort",textAsc:"Ascenging (A to Z) by",textDesc:"Descending (Z to A) by"},SSE.Views.SortFilterDialog||{})),SSE.Views.AutoFilterDialog=Common.UI.Window.extend(_.extend({initialize:function(t){var e={},i=450,s=void 0;Common.Utils.InternalSettings.get("sse-settings-size-filter-window")&&(i=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[0],s=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[1]),_.extend(e,{width:i||450,height:s||277,contentWidth:i-50||400,header:!1,cls:"filter-dlg  modal-dlg autofilter invisible-borders",contentTemplate:"",title:this.txtTitle,modal:!1,animate:!1,items:[],resizable:!0,minwidth:450,minheight:277},t),this.template=t.template||['<div class="box" style="height: 100%; display: flex; justify-content: space-between;">','<div class="content-panel">','<div class="" style="display: flex; flex-direction: column; justify-content: flex-start; height: calc(100% - 37px);">','<div id="id-sd-cell-search" style="margin-bottom:10px;flex-shrink: 0;"></div>','<div class="border-values" style="overflow: hidden; flex-grow: 1;display: flex;">','<div id="id-dlg-filter-values" class="combo-values" style=""></div>',"</div>","</div>",'<div class="footer center">','<div id="id-apply-filter" style="display: inline-block;"></div>','<button class="btn normal dlg-btn" result="cancel">',this.cancelButtonText,"</button>","</div>","</div>",'<div class="menu-panel">','<div id="menu-container-filters" style=""><div class="dropdown-toggle" data-toggle="dropdown"></div></div>',"</div>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.throughIndexes=[],this.filteredIndexes=[],this.curSize=null,e.tpl=_.template(this.template)(e),Common.UI.Window.prototype.initialize.call(this,e),this.on("resizing",_.bind(this.onWindowResizing,this)),this.on("resize",_.bind(this.onWindowResize,this))},render:function(){var t=this;Common.UI.Window.prototype.render.call(this);var e=this.$window.find(".resize-border");this.$window.find(".resize-border.left, .resize-border.top").css({cursor:"default"}),e.removeClass("left"),e.removeClass("top"),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this)),this.btnOk=new Common.UI.Button({cls:"btn normal dlg-btn primary",caption:this.okButtonText,enableToggle:!1,allowDepress:!1}),this.btnOk&&(this.btnOk.render($("#id-apply-filter",this.$window)),this.btnOk.on("click",_.bind(this.onApplyFilter,this))),this.footerButtons=this.getFooterButtons().concat([this.btnOk]),this.miSortLow2High=new Common.UI.MenuItem({caption:this.txtSortLow2High,iconCls:"menu__icon btn-sort-down",toggleGroup:"menufiltersort",checkable:!0,checkmark:!1,checked:!1}),this.miSortLow2High.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Ascending)),this.miSortHigh2Low=new Common.UI.MenuItem({caption:this.txtSortHigh2Low,iconCls:"menu__icon btn-sort-up",toggleGroup:"menufiltersort",checkable:!0,checkmark:!1,checked:!1}),this.miSortHigh2Low.on("click",_.bind(this.onSortType,this,Asc.c_oAscSortOptions.Descending)),this.miSortOptions=new Common.UI.MenuItem({caption:this.txtSortOption}),this.miSortOptions.on("click",_.bind(this.onSortOptions,this)),this.miSortCellColor=new Common.UI.MenuItem({caption:this.txtSortCellColor,toggleGroup:"menufiltersort",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-sort-cells-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miSortFontColor=new Common.UI.MenuItem({caption:this.txtSortFontColor,toggleGroup:"menufiltersort",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-sort-font-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miNumFilter=new Common.UI.MenuItem({caption:this.txtNumFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.top10,caption:this.txtTop10,checkable:!0,type:Asc.c_oAscAutoFilterTypes.Top10},{value:Asc.c_oAscDynamicAutoFilter.aboveAverage,caption:this.txtAboveAve,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.belowAverage,caption:this.txtBelowAve,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})});for(var i=this.miNumFilter.menu.items,s=0;s<i.length;s++)i[s].on("click",_.bind(i[s].options.type==Asc.c_oAscAutoFilterTypes.CustomFilters?this.onNumCustomFilterItemClick:i[s].options.type==Asc.c_oAscAutoFilterTypes.DynamicFilter?this.onNumDynamicFilterItemClick:this.onTop10FilterItemClick,this));for(this.miTextFilter=new Common.UI.MenuItem({caption:this.txtTextFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.beginsWith,caption:this.txtBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,caption:this.txtNotBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.endsWith,caption:this.txtEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,caption:this.txtNotEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.contains,caption:this.txtContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,caption:this.txtNotContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})}),this.miTextFilter.menu.on("item:click",_.bind(this.onTextFilterMenuClick,this)),this.miDateFilter=new Common.UI.MenuItem({caption:this.txtDateFilter,toggleGroup:"menudatefilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",restoreHeightAndTop:!0,items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtBefore,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtAfter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.tomorrow,caption:this.txtTomorrow,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.today,caption:this.txtToday,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.yesterday,caption:this.txtYesterday,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextWeek,caption:this.txtNextWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisWeek,caption:this.txtThisWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastWeek,caption:this.txtLastWeek,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextMonth,caption:this.txtNextMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisMonth,caption:this.txtThisMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastMonth,caption:this.txtLastMonth,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextQuarter,caption:this.txtNextQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisQuarter,caption:this.txtThisQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastQuarter,caption:this.txtLastQuarter,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.nextYear,caption:this.txtNextYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.thisYear,caption:this.txtThisYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.lastYear,caption:this.txtLastYear,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.yearToDate,caption:this.txtYearToDate,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},this.miDatesInThePeriod=new Common.UI.MenuItem({caption:this.txtAllDatesInThePeriod,toggleGroup:"menudateperiod",checkable:!0,menu:new Common.UI.Menu({menuAlign:"tl-tr",restoreHeightAndTop:!0,items:[{value:Asc.c_oAscDynamicAutoFilter.q1,caption:this.txtQuarter1,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q2,caption:this.txtQuarter2,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q3,caption:this.txtQuarter3,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.q4,caption:this.txtQuarter4,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{caption:"--"},{value:Asc.c_oAscDynamicAutoFilter.m1,caption:this.txtJanuary,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m2,caption:this.txtFebruary,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m3,caption:this.txtMarch,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m4,caption:this.txtApril,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m5,caption:this.txtMay,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m6,caption:this.txtJune,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m7,caption:this.txtJuly,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m8,caption:this.txtAugust,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m9,caption:this.txtSeptember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m10,caption:this.txtOctober,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m11,caption:this.txtNovember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter},{value:Asc.c_oAscDynamicAutoFilter.m12,caption:this.txtDecember,checkable:!0,type:Asc.c_oAscAutoFilterTypes.DynamicFilter}]})}),{caption:"--"},{value:-1,caption:this.btnCustomFilter+"...",checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters}]})}),i=this.miDateFilter.menu.items.concat(this.miDatesInThePeriod.menu.items),s=0;s<i.length;s++)i[s].on("click",_.bind(i[s].options.type===Asc.c_oAscAutoFilterTypes.CustomFilters?this.onDataFilterMenuClick:this.onNumDynamicFilterItemClick,this));this.miFilterCellColor=new Common.UI.MenuItem({caption:this.txtFilterCellColor,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-filter-cells-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miFilterFontColor=new Common.UI.MenuItem({caption:this.txtFilterFontColor,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({style:"min-width: inherit; padding: 0px;",menuAlign:"tl-tr",items:[{template:_.template('<div id="filter-dlg-filter-font-color" style="max-width: 147px; max-height: 120px;"></div>')}]})}),this.miClear=new Common.UI.MenuItem({caption:this.txtClear,iconCls:"menu__icon btn-clear-filter",checkable:!1}),this.miClear.on("click",_.bind(this.onClear,this)),this.miReapply=new Common.UI.MenuItem({caption:this.txtReapply,checkable:!1}),this.miReapply.on("click",_.bind(this.onReapply,this)),this.miReapplySeparator=new Common.UI.MenuItem({caption:"--"}),this.miValueFilter=new Common.UI.MenuItem({caption:this.txtValueFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{value:-3,caption:this.txtNotBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"value"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.top10,caption:this.txtTop10,checkable:!0,type:Asc.c_oAscAutoFilterTypes.Top10,pivottype:"value"}]})}),this.miValueFilter.menu.on("item:click",_.bind(this.onValueFilterMenuClick,this)),this.miLabelFilter=new Common.UI.MenuItem({caption:this.txtLabelFilter,toggleGroup:"menufilterfilter",checkable:!0,checked:!1,menu:new Common.UI.Menu({menuAlign:"tl-tr",items:[{value:Asc.c_oAscCustomAutoFilter.equals,caption:this.txtEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotEqual,caption:this.txtNotEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.beginsWith,caption:this.txtBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotBeginWith,caption:this.txtNotBegins,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.endsWith,caption:this.txtEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotEndWith,caption:this.txtNotEnds,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.contains,caption:this.txtContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.doesNotContain,caption:this.txtNotContains,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{caption:"--"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThan,caption:this.txtGreater,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,caption:this.txtGreaterEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isLessThan,caption:this.txtLess,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo,caption:this.txtLessEquals,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:-2,caption:this.txtBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"},{value:-3,caption:this.txtNotBetween,checkable:!0,type:Asc.c_oAscAutoFilterTypes.CustomFilters,pivottype:"label"}]})}),this.miLabelFilter.menu.on("item:click",_.bind(this.onLabelFilterMenuClick,this)),this.filtersMenu=new Common.UI.Menu({cls:"shifted-right",items:[this.miSortLow2High,this.miSortHigh2Low,this.miSortOptions,this.miSortCellColor,this.miSortFontColor,{caption:"--"},this.miLabelFilter,this.miValueFilter,this.miNumFilter,this.miTextFilter,this.miDateFilter,this.miFilterCellColor,this.miFilterFontColor,this.miClear,this.miReapplySeparator,this.miReapply]});var n=this.$window.find("#menu-container-filters");this.filtersMenu.render(n),this.filtersMenu.cmpEl.attr({tabindex:"-1"}),this.mnuSortColorCellsPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-sort-cells-color"),colors:[]}),this.mnuSortColorCellsPicker.on("select",_.bind(this.onSortColorSelect,this,Asc.c_oAscSortOptions.ByColorFill)),this.mnuSortColorFontPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-sort-font-color"),colors:[]}),this.mnuSortColorFontPicker.on("select",_.bind(this.onSortColorSelect,this,Asc.c_oAscSortOptions.ByColorFont)),this.mnuFilterColorCellsPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-filter-cells-color"),colors:[]}),this.mnuFilterColorCellsPicker.on("select",_.bind(this.onFilterColorSelect,this,!0)),this.mnuFilterColorFontPicker=new Common.UI.ColorPaletteExt({el:$("#filter-dlg-filter-font-color"),colors:[]}),this.mnuFilterColorFontPicker.on("select",_.bind(this.onFilterColorSelect,this,!1)),this.input=new Common.UI.InputField({el:$("#id-sd-cell-search",this.$window),allowBlank:!0,placeHolder:this.txtEmpty,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){i.length?(i=i.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),t.filter=new RegExp(i,"ig")):t.filter=void 0,t.setupDataCells()})),this.cells=new Common.UI.TreeViewStore,this.filterExcludeCells=new Common.UI.TreeViewStore,this.cells&&(this.cellsList=new Common.UI.TreeView({el:$("#id-dlg-filter-values",this.$window),store:this.cells,tabindex:1,enableKeyEvents:!0,template:_.template(['<div class="treeview inner" style="height:auto;"></div>'].join("")),itemTemplate:_.template(['<% if (typeof isDate !=="undefined" && isDate) { %>','<div class="tree-item date <% if (!isVisible) { %>hidden<% } %>" style="display: block;'+(Common.UI.isRTL()?"padding-right":"padding-left")+': <%= level*16 + 22 %>px;">',"<% if (hasSubItems) { %>",'<i class="icon toolbar__icon btn-tree-caret <% if (!isExpanded) { %>up<% } %>" style="'+(Common.UI.isRTL()?"margin-right":"margin-left")+':<%= level*16 %>px;"></i>',"<% } %>",'<div class="name not-header has-checkbox">',Common.UI.CheckBoxTemplate,'<div id="<%= id %>" class="tree-label margin-left-20" style="pointer-events: none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(dateValue) %></div>',"</div>","</div>","</div>","<% } else { %>",'<div class="tree-item">','<div class="name not-header has-checkbox">',Common.UI.CheckBoxTemplate,'<div id="<%= id %>" class="tree-label margin-left-20" style="pointer-events:none; display: flex;">','<div style="flex-grow: 1;"><%= Common.Utils.String.htmlEncode(value) %></div>','<% if (typeof count !=="undefined" && count) { %>','<div class="margin-left-10" style="word-break: normal; color: #afafaf;"><%= count%></div>',"<% } %>","</div>","</div>","</div>","<% } %>"].join(""))}),this.cellsList.store.comparator=function(t,e){if("0"==t.get("groupid"))return-1;if("0"==e.get("groupid"))return 1;if("2"==t.get("groupid"))return-1;if("2"==e.get("groupid"))return 1;if(t.get("isDate")||e.get("isDate"))return 0;var i=t.get("intval"),s=e.get("intval"),n=void 0!==i;return n!==(void 0!==s)?n?-1:1:(!n&&(i=t.get("cellvalue").toLowerCase())&&(s=e.get("cellvalue").toLowerCase()),i===s?0:""===s||""!==i&&i<s?-1:1)},this.cellsList.on({"item:change":this.onItemChanged.bind(this),"item:add":this.onItemChanged.bind(this),"item:select":this.onCellCheck.bind(this)}),this.cellsList.onKeyDown=_.bind(this.onListKeyDown,this)),this.setupDataCells(),this._setDefaults();var a=function(e){t._skipCheckDocumentClick||$(e.target).closest(".filter-dlg").length<=0&&t.close()};this.on("close",(function(){$(document.body).off("mousedown",a)})),_.delay((function(){$(document.body).on("mousedown",a)}),100,this),this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},show:function(t,e){Common.UI.Window.prototype.show.call(this,t,e);var i=this;this.input&&_.delay((function(){i.input.focus()}),500,this)},onBtnClick:function(t){t.currentTarget.attributes&&t.currentTarget.attributes.result&&"cancel"===t.currentTarget.attributes.result.value&&this.close()},onApplyFilter:function(){this.testFilter()&&(this.save(),this.close())},onSortType:function(t){this.api&&this.configTo&&this.api.asc_sortColFilter(t,this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName()),this.close()},onSortOptions:function(){var t=this,e=new SSE.Views.SortFilterDialog({api:this.api}).on({close:function(){t.close()}});this.close(),e.setSettings({filter:this.configTo}),e.show()},onNumCustomFilterItemClick:function(t){var e=this.configTo.asc_getFilterObj(),i="",s="",n=Asc.c_oAscCustomAutoFilter.equals,a=0,o=!0;if(e.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters){var l=e.asc_getFilter(),r=l.asc_getCustomFilters();o=l.asc_getAnd(),n=r[0].asc_getOperator(),a=r.length>1&&r[1].asc_getOperator()||0,i=null===r[0].asc_getVal()?"":r[0].asc_getVal(),s=r.length>1?null===r[1].asc_getVal()?"":r[1].asc_getVal():""}if(-1!==t.value){var c=new Asc.CustomFilters;c.asc_setCustomFilters(-2==t.value||-3==t.value?[new Asc.CustomFilter,new Asc.CustomFilter]:[new Asc.CustomFilter]);var d=c.asc_getCustomFilters();if(d[0].asc_setOperator(-2==t.value?Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:-3==t.value?Asc.c_oAscCustomAutoFilter.isLessThan:t.value),-2==t.value){var h=n==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&a==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo;c.asc_setAnd(!h||o),d[0].asc_setVal(h?i:""),d[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),d[1].asc_setVal(h?s:"")}else if(-3==t.value){var p=n==Asc.c_oAscCustomAutoFilter.isLessThan&&a==Asc.c_oAscCustomAutoFilter.isGreaterThan;c.asc_setAnd(!!p&&o),d[0].asc_setVal(p?i:""),d[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isGreaterThan),d[1].asc_setVal(p?s:"")}else c.asc_setAnd(!0),d[0].asc_setVal(t.value==n?i:"");e.asc_setFilter(c),e.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)}var u,m=this;u="label"==t.options.pivottype||"value"==t.options.pivottype?new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:t.options.pivottype}).on({close:function(){m.close()}}):new SSE.Views.DigitalFilterDialog({api:this.api,type:"number"}).on({close:function(){m.close()}}),this.close(),u.setSettings(this.configTo),u.show()},onTextFilterMenuClick:function(t,e){var i=this.configTo.asc_getFilterObj(),s="",n=Asc.c_oAscCustomAutoFilter.equals;if(i.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters){var a=i.asc_getFilter(),o=a.asc_getCustomFilters();a.asc_getAnd(),n=o[0].asc_getOperator(),o.length>1&&o[1].asc_getOperator()||0,s=null===o[0].asc_getVal()?"":o[0].asc_getVal(),o.length>1?null===o[1].asc_getVal()?"":o[1].asc_getVal():""}if(-1!==e.value){var l=new Asc.CustomFilters;l.asc_setCustomFilters([new Asc.CustomFilter]);var r=l.asc_getCustomFilters();l.asc_setAnd(!0),r[0].asc_setOperator(e.value),r[0].asc_setVal(e.value==n?s:""),i.asc_setFilter(l),i.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)}var c,d=this;c="label"==e.options.pivottype||"value"==e.options.pivottype?new SSE.Views.PivotDigitalFilterDialog({api:this.api,type:e.options.pivottype}).on({close:function(){d.close()}}):new SSE.Views.DigitalFilterDialog({api:this.api,type:"text"}).on({close:function(){d.close()}}),this.close(),c.setSettings(this.configTo),c.show()},onDataFilterMenuClick:function(t){var e=this.configTo.asc_getFilterObj(),i="",s="",n=Asc.c_oAscCustomAutoFilter.equals,a=0,o=!0;if(e.asc_getType()==Asc.c_oAscAutoFilterTypes.CustomFilters){var l=e.asc_getFilter(),r=l.asc_getCustomFilters();o=l.asc_getAnd(),n=r[0].asc_getOperator(),a=r.length>1&&r[1].asc_getOperator()||0,i=null===r[0].asc_getVal()?"":r[0].asc_getVal(),s=r.length>1?null===r[1].asc_getVal()?"":r[1].asc_getVal():""}if(-1!==t.value){var c=new Asc.CustomFilters;c.asc_setCustomFilters(-2==t.value||-3==t.value?[new Asc.CustomFilter,new Asc.CustomFilter]:[new Asc.CustomFilter]);var d=c.asc_getCustomFilters();if(d[0].asc_setOperator(-2==t.value?Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo:-3==t.value?Asc.c_oAscCustomAutoFilter.isLessThan:t.value),-2==t.value){var h=n==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo&&a==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo;c.asc_setAnd(!h||o),d[0].asc_setVal(h?i:""),d[1].asc_setOperator(Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo),d[1].asc_setVal(h?s:"")}else c.asc_setAnd(!0),d[0].asc_setVal(t.value==n?i:"");e.asc_setFilter(c),e.asc_setType(Asc.c_oAscAutoFilterTypes.CustomFilters)}var p=this,u=new SSE.Views.DigitalFilterDialog({api:this.api,type:"date"}).on({close:function(){p.close()}});this.close(),u.setSettings(this.configTo),u.show()},onNumDynamicFilterItemClick:function(t){var e=this.configTo.asc_getFilterObj();e.asc_getType()!==Asc.c_oAscAutoFilterTypes.DynamicFilter&&(e.asc_setFilter(new Asc.DynamicFilter),e.asc_setType(Asc.c_oAscAutoFilterTypes.DynamicFilter)),e.asc_getFilter().asc_setType(t.value),this.api.asc_applyAutoFilter(this.configTo),this.close()},onTop10FilterItemClick:function(t){var e=this,i=new SSE.Views.Top10FilterDialog({api:this.api,type:t.options.pivottype}).on({close:function(){e.close()}});this.close(),i.setSettings(this.configTo),i.show()},onLabelFilterMenuClick:function(t,e){e.value==Asc.c_oAscCustomAutoFilter.isGreaterThan||e.value==Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo||e.value==Asc.c_oAscCustomAutoFilter.isLessThan||e.value==Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo||-2==e.value||-3==e.value?this.onNumCustomFilterItemClick(e):this.onTextFilterMenuClick(t,e)},onValueFilterMenuClick:function(t,e){var i=this;this.configTo.asc_getPivotObj().asc_getDataFields().length<2?Common.UI.warning({title:this.textWarning,msg:this.warnFilterError,callback:function(){_.delay((function(){i.close()}),10)}}):e.options.type==Asc.c_oAscAutoFilterTypes.CustomFilters?this.onNumCustomFilterItemClick(e):this.onTop10FilterItemClick(e)},onFilterColorSelect:function(t,e,i){var s=this.configTo.asc_getFilterObj();s.asc_getType()!==Asc.c_oAscAutoFilterTypes.ColorFilter&&(s.asc_setFilter(new Asc.ColorFilter),s.asc_setType(Asc.c_oAscAutoFilterTypes.ColorFilter));var n=s.asc_getFilter();n.asc_setCellColor(!!t&&null),n.asc_setCColor(t&&"transparent"==i||!t&&"#000000"==i?null:Common.Utils.ThemeColor.getRgbColor(i)),this.api.asc_applyAutoFilter(this.configTo),this.close()},onSortColorSelect:function(t,e,i){if(this.api&&this.configTo){var s=t==Asc.c_oAscSortOptions.ByColorFill;this.api.asc_sortColFilter(t,this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName(),s&&"transparent"==i||!s&&"#000000"==i?null:Common.Utils.ThemeColor.getRgbColor(i))}this.close()},onCellCheck:function(t,e,i){if(!this.checkCellTrigerBlock){var s="",n=!1,a=null,o=window.event?window.event:window._event;if(o){if((s=$(o.currentTarget).find(".tree-label")).length){a=Common.Utils.getBoundingClientRect(s.get(0));var l=o.clientX*Common.Utils.zoom(),r=o.clientY*Common.Utils.zoom();a.left<l&&l<a.right&&a.top<r&&r<a.bottom&&(n=!0)}(n||o.target.className.match("checkbox")&&"input"!==o.target.localName)&&(this.updateCellCheck(t,i),_.delay((function(){t.focus()}),100,this))}}},onListKeyDown:function(t,e){var i=this.cellsList;i.disabled||(_.isUndefined(void 0)&&(e=t),e.keyCode==Common.UI.Keys.SPACE?(e.preventDefault(),e.stopPropagation(),this.updateCellCheck(i,i.getSelectedRec())):Common.UI.TreeView.prototype.onKeyDown.call(this.cellsList,t,e))},updateDateLevelCheck:function(t){var e,i,s=t||this.cells.at(this.cells.length-1).get("check"),n=[],a=-1,o=[];for(this.dateTimeGroup=[],e=this.cells.length-1;e>=0;e--)if((i=this.cells.at(e)).get("isDate")){if(0===a)n=[n[a]];var l=i.get("level"),r=i.get("check"),c=i.get("throughIndex");if(l>a)a>0&&(n=n.slice(0,a+1)),n[l]=r,o.push(c);else if(l===a)o.push(c),r!==n[l]&&(n[l]="indeterminate");else if(l<a){if(o.length>0&&("indeterminate"===n[a]||0===l)){for(var d="indeterminate"===n[a]?a:0,h=0;h<o.length;h++)this.dateTimeGroup[o[h]]=d;o.length=0}i.set("check",n[a]),void 0!==n[l]&&n[a]!==n[l]?n[l]="indeterminate":void 0===n[l]&&(n[l]=n[a])}a=l}else"0"===i.get("groupid")&&"indeterminate"!==s?s=n[0]:"1"===i.get("groupid")&&i.get("check")!==s&&(s="indeterminate");this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",s),this.checkCellTrigerBlock=void 0},updateCellCheck:function(t,e){if(e&&t){var i=!e.get("check"),s=this,n=s.filter?s.filteredIndexes:s.throughIndexes;if("0"==e.get("groupid"))this.cells.each((function(t){"2"!==t.get("groupid")&&(t.set("check",i),t.get("throughIndex")>1&&(n[parseInt(t.get("throughIndex"))]=i))}));else{e.set("check",i);var a,o,l=i;if(n[parseInt(e.get("throughIndex"))]=i,e.get("isDate")){var r=e.get("level"),c=e.get("fullDate").slice(0,r+1);for(a=0;a<this.cells.length;a++)"1"==(o=this.cells.at(a)).get("groupid")&&o.get("isDate")&&o.get("level")>r&&c.toString()===o.get("fullDate").slice(0,r+1).toString()&&(o.set("check",i),n[parseInt(o.get("throughIndex"))]=i);this.updateDateLevelCheck(i)}else{for(a=0;a<this.cells.length;a++)if("1"==(o=this.cells.at(a)).get("groupid")&&o.get("check")!==i){l="indeterminate";break}this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",l),this.checkCellTrigerBlock=void 0}}this.btnOk.setDisabled(!1),this.configTo.asc_getFilterObj().asc_setType(Asc.c_oAscAutoFilterTypes.Filters),t.scroller.update({minScrollbarLength:t.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})}},onClear:function(){this.api&&this.configTo&&this.api.asc_clearFilterColumn(this.configTo.asc_getCellId(),this.configTo.asc_getDisplayName()),this.close()},onReapply:function(){this.api&&this.configTo&&this.api.asc_reapplyAutoFilter(this.config.asc_getDisplayName()),this.close()},setSettings:function(t){this.config=t,this.configTo=t},_setDefaults:function(){this.initialFilterType=this.configTo.asc_getFilterObj().asc_getType();var t=this.$window.find(".menu-panel"),e=this.configTo.asc_getPivotObj(),i=!!e,s=!1;this.miValueFilter.setVisible(i),this.miLabelFilter.setVisible(i),this.miSortOptions.setVisible(i),i&&(this.miReapplySeparator.setVisible(!1),this.miReapply.setVisible(!1),s=0!==e.asc_getDataFieldIndexFilter());var n=this.configTo.asc_getFilterObj(),a=this.initialFilterType===Asc.c_oAscAutoFilterTypes.CustomFilters,o=this.initialFilterType===Asc.c_oAscAutoFilterTypes.DynamicFilter,l=this.initialFilterType===Asc.c_oAscAutoFilterTypes.Top10,r=this.configTo.asc_getIsTextFilter(),c=this.configTo.asc_getIsDateFilter(),d=this.configTo.asc_getColorsFill(),h=this.configTo.asc_getColorsFont(),p=this.configTo.asc_getSortState(),u=this.configTo.asc_getSortColor();u&&(u=Common.Utils.ThemeColor.getHexColor(u.get_r(),u.get_g(),u.get_b()).toLocaleUpperCase()),this.miTextFilter.setVisible(!i&&r),this.miDateFilter.setVisible(!i&&c),this.miNumFilter.setVisible(!i&&!r&&!c),this.miTextFilter.setChecked(a&&r,!0),this.miNumFilter.setChecked((a||o||l)&&!r,!0),this.miDateFilter.setChecked((o||a)&&c,!0),this.miValueFilter.setChecked(i&&s,!0),this.miLabelFilter.setChecked(i&&!s&&(a||l),!0),this.miSortLow2High.setChecked(p==Asc.c_oAscSortOptions.Ascending,!0),this.miSortHigh2Low.setChecked(p==Asc.c_oAscSortOptions.Descending,!0);var m=h&&h.length>0;if(this.miSortFontColor.setVisible(m),this.miFilterFontColor.setVisible(!i&&m),m){var g=[];h.forEach((function(t,e){t?g.push(Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase()):g.push("000000")})),this.mnuSortColorFontPicker.updateColors(g),this.mnuFilterColorFontPicker.updateColors(g),this.miFilterFontColor.setChecked(!1,!0),this.miSortFontColor.setChecked(p==Asc.c_oAscSortOptions.ByColorFont,!0),p==Asc.c_oAscSortOptions.ByColorFont&&this.mnuSortColorFontPicker.select(u||"000000",!0)}if(m=d&&d.length>0,this.miSortCellColor.setVisible(m),this.miFilterCellColor.setVisible(!i&&m),m){g=[];d.forEach((function(t,e){t?g.push(Common.Utils.ThemeColor.getHexColor(t.get_r(),t.get_g(),t.get_b()).toLocaleUpperCase()):g.push("transparent")})),this.mnuSortColorCellsPicker.updateColors(g),this.mnuFilterColorCellsPicker.updateColors(g),this.miFilterCellColor.setChecked(!1,!0),this.miSortCellColor.setChecked(p==Asc.c_oAscSortOptions.ByColorFill,!0),p==Asc.c_oAscSortOptions.ByColorFill&&this.mnuSortColorCellsPicker.select(u||"transparent",!0)}if(a){var b=n.asc_getFilter(),f=b.asc_getCustomFilters(),v=(b.asc_getAnd(),f[0].asc_getOperator()),C=f.length>1&&f[1].asc_getOperator()||0,x=i?s?this.miValueFilter.menu.items:this.miLabelFilter.menu.items:r?this.miTextFilter.menu.items:c?this.miDateFilter.menu.items:this.miNumFilter.menu.items,y=!0;1==f.length?x.forEach((function(t){var e=t.options.type==Asc.c_oAscAutoFilterTypes.CustomFilters&&t.value==v;t.setChecked(e,!0),e&&(y=!1)})):!i&&r||v!=Asc.c_oAscCustomAutoFilter.isGreaterThanOrEqualTo||C!=Asc.c_oAscCustomAutoFilter.isLessThanOrEqualTo?i&&v==Asc.c_oAscCustomAutoFilter.isLessThan&&C==Asc.c_oAscCustomAutoFilter.isGreaterThan&&(x[s?7:14].setChecked(!0,!0),y=!1):(x[c?3:i&&!s?13:6].setChecked(!0,!0),y=!1),y&&x[x.length-1].setChecked(!0,!0)}else if(this.initialFilterType===Asc.c_oAscAutoFilterTypes.ColorFilter){var _=n.asc_getFilter(),A=_.asc_getCColor();A&&(A=Common.Utils.ThemeColor.getHexColor(A.get_r(),A.get_g(),A.get_b()).toLocaleUpperCase()),null===_.asc_getCellColor()?(this.miFilterCellColor.setChecked(!0,!0),this.mnuFilterColorCellsPicker.select(A||"transparent",!0)):!1===_.asc_getCellColor()&&(this.miFilterFontColor.setChecked(!0,!0),this.mnuFilterColorFontPicker.select(A||"000000",!0))}else if(o||l){var w=o?n.asc_getFilter().asc_getType():null;if((x=i?this.miValueFilter.menu.items:c?this.miDateFilter.menu.items:this.miNumFilter.menu.items).forEach((function(t){t.setChecked(o&&t.options.type==Asc.c_oAscAutoFilterTypes.DynamicFilter&&t.value==w||l&&t.options.type==Asc.c_oAscAutoFilterTypes.Top10,!0)})),c)if(!this.miDateFilter.menu.getChecked()){var S=!1;(x=this.miDatesInThePeriod.menu.items).forEach((function(t){var e=t.value==w;t.setChecked(e,!0),e&&(S=!0)})),S&&this.miDateFilter.menu.items[20].setChecked(S,!0)}}this.miClear.setDisabled(this.initialFilterType===Asc.c_oAscAutoFilterTypes.None),this.miReapply.setDisabled(this.initialFilterType===Asc.c_oAscAutoFilterTypes.None),this.btnOk.setDisabled(this.initialFilterType!==Asc.c_oAscAutoFilterTypes.Filters&&this.initialFilterType!==Asc.c_oAscAutoFilterTypes.None),this.menuPanelWidth=t.innerWidth();var k=this.getWidth();k-this.menuPanelWidth<260&&(k=Math.ceil(this.menuPanelWidth+260),this.setResizable(!0,[k,this.initConfig.minheight])),Common.Utils.InternalSettings.get("sse-settings-size-filter-window")&&(k=Common.Utils.InternalSettings.get("sse-settings-size-filter-window")[0]+this.menuPanelWidth),i&&e.asc_getIsPageFilter()&&(this.setResizable(!0,[this.initConfig.minwidth-this.menuPanelWidth,this.initConfig.minheight]),t.addClass("hidden"),k-=this.menuPanelWidth,this.menuPanelWidth=0),this.setSize(k,this.getHeight())},setupDataCells:function(){var t,e,i,s,n,a=this,o=0,l=2,r=!0,c=!1,d=0,h=[],p=[],u=a.filter?a.filteredIndexes:a.throughIndexes,m=a.configTo.asc_getTimeFormat(),g=[this.txtJanuary,this.txtFebruary,this.txtMarch,this.txtApril,this.txtMay,this.txtJune,this.txtJuly,this.txtAugust,this.txtSeptember,this.txtOctober,this.txtNovember,this.txtDecember],b=0,f=0;this.configTo.asc_getValues().forEach((function(c){e=c.asc_getText(),t=function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(e),r=!0,i=c.asc_getRepeats?c.asc_getRepeats():void 0;var v,C,x,y,_=c.asc_getIsDateFormat(),A="";if(_){s=!0,a.filter&&0===o&&(o+=1);var w=c.asc_getYear(),S=c.asc_getMonth(),k=c.asc_getDay(),T=c.asc_getHour(),I=c.asc_getMinute(),D=c.asc_getSecond();m?(v=[w,S,k,T,I,D],C=[w,S,k,T||"00",":"+(I||"00"),":"+(D||"00")]):C=(v=[w,S,k]).slice(),C.forEach((function(t,e){A+=1===e?g[t]:t})),x=function(t,e){var i=0;if(t)for(var s=0;s<t.length;s++)if(t[s]!==e[s]){i=s;break}return i}(n,v),y=v.length-1}a.filter?(null===(_?A:e).match(a.filter)&&(r=!1),u[l]=r):null==u[l]&&(u[l]=c.asc_getVisible());if(r)if(_){0===x?(b+=1,f+=1):1===x&&(f+=1);for(var V=x;V<=y;V++)o+=1,h.push(new Common.UI.TreeViewModel({id:o,selected:!1,allowSelected:!0,cellvalue:e,value:e,groupid:"1",check:u[l],throughIndex:l,count:i?i.toString():"",isDate:!0,fullDate:v,dateValue:1===V?g[C[V]]:C[V],level:V,index:o,hasParent:V>0,hasSubItems:V<y,isVisible:0===V,isExpanded:!1})),u[l]&&d++;n=v}else h.push(new Common.UI.TreeViewModel({id:++o,selected:!1,allowSelected:!0,cellvalue:e,value:t||e.length>0?e:a.textEmptyItem,intval:t?parseFloat(e):void 0,strval:t?"":e,groupid:"1",check:u[l],throughIndex:l,count:i?i.toString():""})),u[l]&&d++;else p.push(new Common.UI.TreeViewModel({cellvalue:e}));++l})),1===b&&h.forEach((function(t){if(t.get("isDate")){var e=t.get("level");f>1?(t.set("isVisible",e<2),t.set("isExpanded",0===e)):(t.set("isVisible",e<3),t.set("isExpanded",e<2))}})),a.cellsList.cmpEl[b>0?"addClass":"removeClass"]("shifted-right"),d==h.length?c=!0:d>0&&(c="indeterminate"),(a.filter||null==u[0])&&(u[0]=!0),(!a.filter||h.length>0)&&h.unshift(new Common.UI.TreeViewModel({id:++o,selected:!1,allowSelected:!0,value:a.filter?this.textSelectAllResults:this.textSelectAll,groupid:"0",check:u[0],throughIndex:0})),a.filter&&h.length>1&&(null==u[1]&&(u[1]=!1),h.splice(1,0,new Common.UI.TreeViewModel({id:++o,selected:!1,allowSelected:!0,value:this.textAddSelection,groupid:"2",check:u[1],throughIndex:1}))),this.cells.reset(h),this.filterExcludeCells.reset(p),this.cells.length&&(s&&d!==h.length?this.updateDateLevelCheck():(this.checkCellTrigerBlock=!0,this.cells.at(0).set("check",c),this.checkCellTrigerBlock=void 0)),this.btnOk.setDisabled(this.cells.length<1),this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})},testFilter:function(){var t=this,e=!1;return this.cells&&(this.filter&&this.filteredIndexes[1]?e=!0:this.cells.forEach((function(t){if("1"==t.get("groupid")&&t.get("check"))return e=!0,!0}))),e||(t._skipCheckDocumentClick=!0,Common.UI.warning({title:this.textWarning,msg:this.warnNoSelected,callback:function(){t._skipCheckDocumentClick=!1,_.delay((function(){t.input.focus()}),100,this)}})),e},save:function(){if(this.api&&this.configTo&&this.cells&&this.filterExcludeCells){var t=this.configTo.asc_getValues(),e=!1,i=this;if(this.filter&&this.filteredIndexes[1])this.initialFilterType===Asc.c_oAscAutoFilterTypes.CustomFilters&&t.forEach((function(t,e){t.asc_setVisible(!0)})),this.cells.each((function(e){"1"==e.get("groupid")&&t[parseInt(e.get("throughIndex"))-2].asc_setVisible(e.get("check"))})),t.forEach((function(t,i){if(t.asc_getVisible())return e=!0,!0}));else{var s=this.filter?this.filteredIndexes:this.throughIndexes;t.forEach((function(t,e){if(t.asc_setVisible(s[e+2]),t.asc_getIsDateFormat()){var n;switch(i.dateTimeGroup[e+2]){case 0:n=Asc.EDateTimeGroup.datetimegroupYear;break;case 1:n=Asc.EDateTimeGroup.datetimegroupMonth;break;case 2:n=Asc.EDateTimeGroup.datetimegroupDay;break;case 3:n=Asc.EDateTimeGroup.datetimegroupHour;break;case 4:n=Asc.EDateTimeGroup.datetimegroupMinute;break;case 5:n=Asc.EDateTimeGroup.datetimegroupSecond}t.asc_setDateTimeGrouping(n)}})),e=!0}if(e){var n=this.configTo.asc_getPivotObj();n&&n.asc_getIsPageFilter()&&n.asc_setIsMultipleItemSelectionAllowed(!0),this.configTo.asc_getFilterObj().asc_setType(Asc.c_oAscAutoFilterTypes.Filters),this.api.asc_applyAutoFilter(this.configTo)}}},onPrimary:function(){return this.save(),this.close(),!1},onWindowResize:function(t){if(t&&"start"==t[1])this.curSize={resize:!1,height:this.getSize()[1]};else if(this.curSize.resize){this.getSize();this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!0,suppressScrollX:!0})}},onWindowResizing:function(){if(this.curSize){var t=this.getSize();t[1]!==this.curSize.height&&(this.curSize.resize||(this.curSize.resize=!0,this.cellsList.scroller.update({minScrollbarLength:this.cellsList.minScrollbarLength,alwaysVisibleY:!1,suppressScrollX:!0})),this.curSize.height=t[1]),t[0]-=this.menuPanelWidth,Common.Utils.InternalSettings.set("sse-settings-size-filter-window",t)}},onItemChanged:function(t,e){var i=e.model.get("check");"indeterminate"==i?$("input[type=checkbox]",e.$el).prop("indeterminate",!0):$("input[type=checkbox]",e.$el).prop({checked:i,indeterminate:!1})},btnCustomFilter:"Custom Filter",textSelectAll:"Select All",txtTitle:"Filter",warnNoSelected:"You must choose at least one value",textWarning:"Warning",textEmptyItem:"{Blanks}",txtEmpty:"Enter cell's filter",txtSortLow2High:"Sort Lowest to Highest",txtSortHigh2Low:"Sort Highest to Lowest",txtSortCellColor:"Sort by cells color",txtSortFontColor:"Sort by font color",txtNumFilter:"Number filter",txtTextFilter:"Text filter",txtDateFilter:"Date Filter",txtFilterCellColor:"Filter by cells color",txtFilterFontColor:"Filter by font color",txtClear:"Clear",txtReapply:"Reapply",txtEquals:"Equals...",txtNotEquals:"Does not equal...",txtGreater:"Greater than...",txtGreaterEquals:"Greater than or equal to...",txtLess:"Less than...",txtLessEquals:"Less than or equal to...",txtBetween:"Between...",txtTop10:"Top 10",txtAboveAve:"Above average",txtBelowAve:"Below average",txtBegins:"Begins with...",txtNotBegins:"Does not begin with...",txtEnds:"Ends with...",txtNotEnds:"Does not end with...",txtContains:"Contains...",txtNotContains:"Does not contain...",textSelectAllResults:"Select All Search Results",textAddSelection:"Add current selection to filter",txtValueFilter:"Value filter",txtLabelFilter:"Label filter",warnFilterError:"You need at least one field in the Values area in order to apply a value filter.",txtNotBetween:"Not between...",txtSortOption:"More sort options...",txtBefore:"Before...",txtAfter:"After...",txtTomorrow:"Tomorrow",txtToday:"Today",txtYesterday:"Yesterday",txtNextWeek:"Next Week",txtThisWeek:"This Week",txtLastWeek:"Last Week",txtNextMonth:"Next Month",txtThisMonth:"This Month",txtLastMonth:"Last Month",txtNextQuarter:"Next Quarter",txtThisQuarter:"This Quarter",txtLastQuarter:"Last Quarter",txtNextYear:"Next Year",txtThisYear:"This Year",txtLastYear:"Last Year",txtYearToDate:"Year to Date",txtAllDatesInThePeriod:"All Dates in the Period",txtQuarter1:"Quarter 1",txtQuarter2:"Quarter 1",txtQuarter3:"Quarter 1",txtQuarter4:"Quarter 1",txtJanuary:"January",txtFebruary:"February",txtMarch:"March",txtApril:"April",txtMay:"May",txtJune:"June",txtJuly:"July",txtAugust:"August",txtSeptember:"September",txtOctober:"October",txtNovember:"November",txtDecember:"December"},SSE.Views.AutoFilterDialog||{}))})),define("spreadsheeteditor/main/app/view/PivotGroupDialog",[],(function(){"use strict";SSE.Views.PivotGroupDialog=Common.UI.Window.extend(_.extend({options:{width:250,header:!0,cls:"modal-dlg",buttons:["ok","cancel"]},initialize:function(t){var e=t.date?250:110;_.extend(this.options,{title:this.txtTitle},t||{}),this.template=t.template||['<div class="box" style="height:'+e+'px;">','<table cols="2" style="width: 100%;">',"<tr>",'<td colspan="2" style="padding-bottom: 4px;">','<label class="font-weight-bold">'+this.textAuto+"</label>","</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<div id="pivot-group-dlg-chk-start" style="margin-top: 2px;"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-start"></div>',"</td>","</tr>","<tr>",'<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<div id="pivot-group-dlg-chk-end" style="margin-top: 2px;"></div>',"</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-end"></div>',"</td>","</tr>",'<tr class="group-number">','<td class="padding-right-10" style="padding-bottom: 8px;width: 100%;">','<label class="margin-left-22" style="margin-top:2px;">'+this.textBy+"</label>","</td>",'<td style="padding-bottom: 8px;">','<div id="pivot-group-dlg-txt-by"></div>',"</td>","</tr>",'<tr class="group-date">','<td colspan="2" style="padding-bottom: 4px;">','<label class="font-weight-bold">'+this.textBy+"</label>","</td>","</tr>",'<tr class="group-date">','<td colspan="2" style="padding-bottom: 8px;">','<div id="pivot-group-dlg-list" style="height:116px;"></div>',"</td>","</tr>",'<tr class="group-date">','<td class="padding-right-10" style="width: 100%;">','<label style="margin-top:2px;">'+this.textNumDays+"</label>","</td>","<td>",'<div id="pivot-group-dlg-spn-days"></div>',"</td>","</tr>","</table>","</div>"].join(""),this.api=t.api,this.handler=t.handler,this.options.tpl=_.template(this.template)(this.options),Common.UI.Window.prototype.initialize.call(this,this.options)},render:function(){Common.UI.Window.prototype.render.call(this),this.$window.find(".dlg-btn").on("click",_.bind(this.onBtnClick,this));var t=this;this.chStart=new Common.UI.CheckBox({el:$("#pivot-group-dlg-chk-start",this.$window),labelText:this.textStart}),this.chStart.on("change",(function(e,i,s,n){"checked"==i&&t.defRangePr&&t.inputStart.setValue(t.defRangePr.start)})),this.chEnd=new Common.UI.CheckBox({el:$("#pivot-group-dlg-chk-end",this.$window),labelText:this.textEnd}),this.chEnd.on("change",(function(e,i,s,n){"checked"==i&&t.defRangePr&&t.inputEnd.setValue(t.defRangePr.end)})),this.inputStart=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-start",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){t.chStart.setValue(!1,!0)})),this.inputEnd=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-end",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(e,i){t.chEnd.setValue(!1,!0)})),this.inputBy=new Common.UI.InputField({el:$("#pivot-group-dlg-txt-by",this.$window),style:"width: 100px;",allowBlank:!0,validateOnChange:!0,validation:function(){return!0}}).on("changing",(function(t,e){e.length})),this.spnDays=new Common.UI.MetricSpinner({el:$("#pivot-group-dlg-spn-days",this.$window),step:1,width:100,defaultUnit:"",value:"1",maxValue:32767,minValue:1}),this.spnDays.on("change",_.bind((function(t,e,i,s){}),this));var e=[{value:this.textSec,type:Asc.c_oAscGroupBy.Seconds},{value:this.textMin,type:Asc.c_oAscGroupBy.Minutes},{value:this.textHour,type:Asc.c_oAscGroupBy.Hours},{value:this.textDays,type:Asc.c_oAscGroupBy.Days},{value:this.textMonth,type:Asc.c_oAscGroupBy.Months},{value:this.textQuart,type:Asc.c_oAscGroupBy.Quarters},{value:this.textYear,type:Asc.c_oAscGroupBy.Years}];this.listDate=new Common.UI.ListView({el:$("#pivot-group-dlg-list",this.$window),store:new Common.UI.DataViewStore(e),multiSelect:!0,tabindex:1,itemTemplate:_.template('<div id="<%= id %>" class="list-item" style="pointer-events:none;"><%= value %></div>')}),this.listDate.on("item:select",_.bind(this.onSelectDate,this)),this.listDate.on("item:deselect",_.bind(this.onSelectDate,this)),this.listDate.on("entervalue",_.bind(this.onPrimary,this)),this.btnOk=_.find(this.getFooterButtons(),(function(t){return t.$el&&t.$el.find(".primary").addBack().filter(".primary").length>0}))||new Common.UI.Button({el:this.$window.find(".primary")})},getFocusedComponents:function(){return[this.chStart,this.inputStart,this.chEnd,this.inputEnd,this.inputBy,this.listDate,this.spnDays].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.inputStart},onBtnClick:function(t){this._handleInput(t.currentTarget.attributes.result.value)},onSelectDate:function(t,e,i){if(i&&!(i.length<1)){i.get("type")==Asc.c_oAscGroupBy.Days&&(this.isDays=i.get("selected"));var s=this.listDate.getSelectedRec().length;this.spnDays.setDisabled(!this.isDays||s>1),this.btnOk.setDisabled(s<1)}},setSettings:function(t,e,i){if(this.$window.find(".group-number").toggleClass("hidden",!!e),this.$window.find(".group-date").toggleClass("hidden",!e),t){this.chStart.setValue(t.asc_getAutoStart(),!0),this.chEnd.setValue(t.asc_getAutoEnd(),!0);var s=e?t.asc_getStartDateText():t.asc_getStartNum();this.inputStart.setValue(null!=s?s:""),s=e?t.asc_getEndDateText():t.asc_getEndNum(),this.inputEnd.setValue(null!=s?s:""),!e&&this.inputBy.setValue(t.asc_getGroupInterval()),this.rangePr=t,i&&(this.defRangePr={start:e?i.asc_getStartDateText():i.asc_getStartNum(),end:e?i.asc_getEndDateText():i.asc_getEndNum()})}if(e){var n,a=this;this.listDate.setMultiselectMode(e.length>1),_.each(e,(function(t){var e=a.listDate.store.findWhere({type:t});e&&a.listDate.selectRecord(e),t==Asc.c_oAscGroupBy.Days&&(n=!0)})),this.listDate.setMultiselectMode(!1),this.spnDays.setValue(t.asc_getGroupInterval()),this.spnDays.setDisabled(!n||e.length>1),this.btnOk.setDisabled(e.length<1),this.dateTypes=e,this.isDays=n}},getSettings:function(){return this.rangePr&&(this.rangePr.asc_setAutoStart("checked"==this.chStart.getValue()),this.rangePr.asc_setAutoEnd("checked"==this.chEnd.getValue()),this.dateTypes?(this.dateTypes=this.listDate.getSelectedRec().map((function(t){return t.get("type")})),this.rangePr.asc_setGroupInterval(this.spnDays.getNumberValue()),this.rangePr.asc_setStartDateText(this.inputStart.getValue()),this.rangePr.asc_setEndDateText(this.inputEnd.getValue())):(this.rangePr.asc_setStartNum(parseFloat(this.inputStart.getValue().toString().replace(",","."))),this.rangePr.asc_setEndNum(parseFloat(this.inputEnd.getValue().toString().replace(",","."))),this.rangePr.asc_setGroupInterval(parseFloat(this.inputBy.getValue().toString().replace(",","."))))),[this.rangePr,this.dateTypes]},isRangeValid:function(){if(this.dateTypes){if(this.rangePr){this.rangePr.asc_setStartDateText(this.inputStart.getValue());var t=this.rangePr.asc_getStartDate();if(isNaN(t))return this.inputStart.showError([this.textError]),this.inputStart.focus(),!1;this.rangePr.asc_setEndDateText(this.inputEnd.getValue());var e=this.rangePr.asc_getEndDate();if(isNaN(e))return this.inputEnd.showError([this.textError]),this.inputEnd.focus(),!1;if(e<t)return Common.UI.warning({msg:this.textGreaterError,maxwidth:600}),this.inputEnd.focus(),!1}}else{var i=new RegExp("^s*[-]?[0-9]+[,.]?[0-9]*s*$");t=this.inputStart.getValue().toString();if(!i.test(t))return this.inputStart.showError([this.textError]),this.inputStart.focus(),!1;e=this.inputEnd.getValue().toString();if(!i.test(e))return this.inputEnd.showError([this.textError]),this.inputEnd.focus(),!1;if(parseFloat(e.replace(",","."))<parseFloat(t.replace(",",".")))return Common.UI.warning({msg:this.textGreaterError,maxwidth:600}),this.inputEnd.focus(),!1;if(!i.test(this.inputBy.getValue().toString()))return this.inputBy.showError([this.textError]),this.inputBy.focus(),!1}return!0},onPrimary:function(t,e,i){return this._handleInput("ok"),!1},_handleInput:function(t){if(this.options.handler){if("ok"==t&&(this.btnOk.isDisabled()||!this.isRangeValid()))return;this.options.handler.call(this,this,t)}this.close()},txtTitle:"Grouping",textAuto:"Auto",textBy:"By",textStart:"Starting at",textEnd:"Ending at",textNumDays:"Number of days",textSec:"Seconds",textMin:"Minutes",textHour:"Hours",textDays:"Days",textMonth:"Months",textQuart:"Quarters",textYear:"Years",textError:"This field must be a numeric value",textGreaterError:"The end number must be greater than the start number"},SSE.Views.PivotGroupDialog||{}))})),define("spreadsheeteditor/main/app/view/PivotCalculatedItemsDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.PivotCalculatedItemsDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:410,contentHeight:270,separator:!1,buttons:["close"],id:"pivot-calculated-dialog"},initialize:function(t){this.api=t.api,this.handlerWarning=t.handlerWarning,this.getWarningMessage=t.getWarningMessage,_.extend(this.options,{contentStyle:"padding: 10px 10px 0 10px;",contentTemplate:_.template(['<div id="pivot-calculated-btns-group">',"<div>",'<button type="button" class="btn btn-text-default margin-right-8" id="pivot-calculated-btn-new"><%= scope.txtNew %></button>','<button type="button" class="btn btn-text-default margin-right-8" id="pivot-calculated-btn-duplicate"><%= scope.txtDuplicate %></button>','<button type="button" class="btn btn-text-default" id="pivot-calculated-btn-edit"><%= scope.txtEdit %></button>',"</div>",'<button type="button" class="btn btn-text-default" id="pivot-calculated-btn-delete"><%= scope.txtDelete %></button>',"</div>",'<div style="position: relative;">','<div id="pivot-calculated-items-list"></div>',"</div>"].join(""))({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this);var t=this;this.btnNew=new Common.UI.Button({el:$("#pivot-calculated-btn-new")}).on("click",_.bind(this.onEditItem,this,!1,!1)),this.btnDuplicate=new Common.UI.Button({el:$("#pivot-calculated-btn-duplicate"),disabled:!0}).on("click",_.bind(this.onDuplicateItem,this)),this.btnEdit=new Common.UI.Button({el:$("#pivot-calculated-btn-edit"),disabled:!0}).on("click",_.bind(this.onEditItem,this,!0,!1)),this.btnDelete=new Common.UI.Button({el:$("#pivot-calculated-btn-delete"),disabled:!0}).on("click",_.bind(this.onDeleteItem,this)),this.itemsList=new Common.UI.ListView({el:$("#pivot-calculated-items-list",this.$window),store:new Common.UI.DataViewStore,emptyText:"",headers:[{name:this.txtItemsName,width:135},{name:this.txtFormula}],isRTL:!0,template:_.template(['<div class="listview inner" style=""></div>'].join("")),itemTemplate:_.template(['<div class="list-item" style="width: 100%;display:inline-block;">','<div class="calculated-item calculated-item-name"><%= Common.Utils.String.htmlEncode(name) %></div>','<div class="calculated-item calculated-item-formula"><%= Common.Utils.String.htmlEncode(formula) %></div>',"</div>"].join("")),tabindex:1}),this.itemsList.on("item:select",_.bind(this.onSelectItemsList,this)),this.updateItemsListStore(!1),this.itemsList.store.length?this.itemsList.selectRecord(this.itemsList.store.at(0)):setTimeout((function(){t.onEditItem(!1,!0)}),0)},getFocusedComponents:function(){return[this.btnNew,this.btnDuplicate,this.btnEdit,this.btnDelete,this.itemsList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.itemsList},setSettings:function(){this.pivotInfo=this.api.asc_getCellInfo().asc_getPivotTableInfo(),this.pivotFieldIndex=this.pivotInfo.asc_getFieldIndexByActiveCell(),this.itemsObject=this.pivotInfo.asc_getItemsObjectWithFormulas(this.pivotFieldIndex);var t=this.pivotInfo.asc_getCacheFields()[this.pivotFieldIndex].asc_getName();this.setTitle(this.txtTitle+" "+t+"")},updateItemsListStore:function(t){var e=!1;t&&!(e=!this.pivotInfo.asc_canChangeCalculatedItemByActiveCell())&&(e=this.pivotInfo.asc_hasTablesErrorForCalculatedItems(this.pivotFieldIndex)),e?(this.btnNew.setDisabled(!0),this.btnDuplicate.setDisabled(!0),this.btnEdit.setDisabled(!0),this.btnDelete.setDisabled(!0),this.itemsList.setDisabled(!0),this.handlerWarning&&this.handlerWarning(e)):(this.setSettings(),this.itemsObject=this.pivotInfo.asc_getItemsObjectWithFormulas(this.pivotFieldIndex),this.itemsList.store.reset(this.itemsObject.filter((function(t){var e=!!t.formula;return e&&(t.formula="= "+t.formula),e}))))},generateUniqueName:function(t,e){var i=t;if(-1!==e.indexOf(t)){for(var s=1;-1!==e.indexOf(t+" ("+s+")");)s++;i=t+" ("+s+")"}return i},selectLastItem:function(){var t=this.itemsList.store.at(-1);this.itemsList.selectRecord(t),this.itemsList.scrollToRecord(t)},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},onSelectItemsList:function(t,e,i){this.btnDuplicate.setDisabled(!1),this.btnEdit.setDisabled(!1),this.btnDelete.setDisabled(!1)},onEditItem:function(t,e){var i,s=this,n=Common.Utils.getOffset(s.$window),a=this.itemsList.getSelectedRec();t&&a&&(i={item:a.get("item"),name:a.get("name"),formula:a.get("formula")});var o=new SSE.Views.PivotInsertCalculatedItemDialog({api:this.api,isEdit:t,editableItem:i,getWarningMessage:this.getWarningMessage,handler:function(e,i){if("ok"==e){if(t)s.pivotInfo.asc_modifyCalculatedItem(s.api,s.pivotFieldIndex,i.name,i.formula);else{var n=s.generateUniqueName(i.name,s.itemsObject.map((function(t){return t.name})));s.pivotInfo.asc_addCalculatedItem(s.api,s.pivotFieldIndex,n,i.formula)}s.updateItemsListStore(!0)}}}).on("close",(function(){s.itemsList.store.length?s.show():s.close(),t?s.itemsList.selectRecord(a):s.selectLastItem()}));s.hide(),e?o.show():o.show(n.left,n.top)},onDuplicateItem:function(){var t=this.itemsList.getSelectedRec();if(t){var e=this.generateUniqueName(t.get("name"),this.itemsObject.map((function(t){return t.name}))),i=this.pivotInfo.asc_convertCalculatedFormula(t.get("formula").replace("=",""),this.pivotFieldIndex);"number"==typeof i?this.handlerWarning&&this.handlerWarning(i):(this.pivotInfo.asc_addCalculatedItem(this.api,this.pivotFieldIndex,e,i),this.updateItemsListStore(!0),this.selectLastItem())}},onDeleteItem:function(){var t=this.itemsList.getSelectedRec();if(t){var e=this.itemsList.store.indexOf(t);if(this.pivotInfo.asc_removeCalculatedItem(this.api,this.pivotFieldIndex,t.get("name")),this.itemsList.store.remove(t),this.itemsList.store.length>0){var i=e<this.itemsList.store.length?e:this.itemsList.store.length-1;this.itemsList.selectByIndex(i)}else this.btnDuplicate.setDisabled(!0),this.btnEdit.setDisabled(!0),this.btnDelete.setDisabled(!0);this.updateItemsListStore(!0)}},txtTitle:"Calculated Items in",txtNew:"New",txtDuplicate:"Duplicate",txtEdit:"Edit",txtDelete:"Delete",txtItemsName:"Items Name",txtFormula:"Formula"},SSE.Views.PivotCalculatedItemsDialog||{}))})),define("spreadsheeteditor/main/app/view/PivotInsertCalculatedItemDialog",["common/main/lib/view/AdvancedSettingsWindow"],(function(){"use strict";SSE.Views.PivotInsertCalculatedItemDialog=Common.Views.AdvancedSettingsWindow.extend(_.extend({options:{contentWidth:290,contentHeight:350,separator:!1,id:"pivot-insert-calculated-dialog"},initialize:function(t){this.api=t.api,this.isEdit=t.isEdit,this.editableItem=t.editableItem,this.handler=t.handler,this.getWarningMessage=t.getWarningMessage,this.helpUrl=null,this.pivotInfo=this.api.asc_getCellInfo().asc_getPivotTableInfo(),this.pivotFieldIndex=this.pivotInfo.asc_getFieldIndexByActiveCell();var e=this.pivotInfo.asc_getCacheFields()[this.pivotFieldIndex].asc_getName();_.extend(this.options,{title:this.txtTitle+" "+e+"",contentStyle:"padding: 10px 10px 0 10px;",contentTemplate:_.template(['<div class="pivot-insert-calculated-row">',"<label><%= scope.txtItemName %></label>",'<div id="pivot-insert-calculated-input-name"></div>',"</div>",'<div class="pivot-insert-calculated-row">',"<label><%= scope.txtFormula %></label>",'<div id="pivot-insert-calculated-input-formula"></div>',"</div>",'<div class="pivot-insert-calculated-row">',"<label><%= scope.txtItems %></label>",'<div id="pivot-insert-calculated-items-list"></div>',"</div>",'<div id="pivot-insert-calculated-description">',"<label><%= scope.txtDescription %> </label>",'<label id="pivot-insert-calculated-help" class="link"><%= scope.txtReadMore %></label>',"</div>"].join(""))({scope:this})},t),Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this,this.options)},render:function(){Common.Views.AdvancedSettingsWindow.prototype.render.call(this),this.itemsList=new Common.UI.ListView({el:$("#pivot-insert-calculated-items-list"),store:new Common.UI.DataViewStore(this.pivotInfo.asc_getItemsObjectWithFormulas(this.pivotFieldIndex)),simpleAddMode:!1,cls:"dbl-clickable",itemTemplate:_.template(['<div id="<%= id %>" class="list-item">',"<div><%=name%></div>",'<div class="list-item-icon toolbar__icon btn-zoomup"></div>',"</div>"].join("")),tabindex:1}),this.itemsList.on("entervalue",_.bind(this.onEnterValueItemsList,this)),this.itemsList.on("item:click",_.bind(this.onClickItemsList,this)),this.itemsList.on("item:dblclick",_.bind(this.onDblClickItemsList,this)),this.addTooltipItemsList(),this.inputName=new Common.UI.InputField({el:$("#pivot-insert-calculated-input-name"),value:this.editableItem?this.editableItem.name:this.getNewItemName(),disabled:!!this.editableItem,allowBlank:!1,validateOnBlur:!1,hideErrorOnInput:!0}),this.inputFormula=new Common.UI.InputField({el:$("#pivot-insert-calculated-input-formula"),value:this.editableItem?this.editableItem.formula:"= 0",validateOnBlur:!1,hideErrorOnInput:!0}),this.$window.find("#pivot-insert-calculated-help").on("click",_.bind(this.showHelp,this))},getNewItemName:function(){var t=0,e=this.txtItem;return this.itemsList.store.each((function(i){var s=i.get("name");if(0==s.indexOf(e)){var n=parseInt(s.substr(e.length));!isNaN(n)&&t<n&&(t=n)}})),t++,e+" "+t},getFocusedComponents:function(){return[this.inputName,this.inputFormula,this.itemsList].concat(this.getFooterButtons())},getDefaultFocusableComponent:function(){return this.isEdit?this.inputFormula:this.inputName},show:function(){Common.Views.AdvancedSettingsWindow.prototype.show.apply(this,arguments)},onEnterValueItemsList:function(t,e,i){this.onAddItemInFormula(e.get("name"))},onClickItemsList:function(t,e,i,s){$(s.target).hasClass("list-item-icon")&&this.onAddItemInFormula(i.get("name"))},onDblClickItemsList:function(t,e,i){this.onAddItemInFormula(i.get("name"))},onAddItemInFormula:function(t){var e=this.inputFormula.getValue(),i=e.trim().replaceAll(" ","");"=0"!=i&&"="!=i&&""!=i||(e="="),e+=" "+this.pivotInfo.asc_convertNameToFormula(t),this.inputFormula.setValue(e),this.inputFormula.focus()},onPrimary:function(){return this.onDlgBtnClick("ok"),!1},onDlgBtnClick:function(t){var e="object"==_typeof(t)?t.currentTarget.attributes.result.value:t;if(this.handler)if("ok"==e){var i={name:this.inputName.getValue(),formula:this.inputFormula.getValue()};if(!0!==this.inputName.checkValidate())return void this.inputName.focus();var s=this.getConvertedFormula(i.formula);if(s.error)return this.inputFormula.showError([this.getWarningMessage(s.error)]),void this.inputFormula.focus();i.formula=s.value,this.handler.call(this,e,i)}else this.handler.call(this,e);this.close()},addTooltipItemsList:function(){var t=this;this.itemsList.dataViewItems.forEach((function(e){e.tipsArray&&view.tipsArray.forEach((function(t){t.remove()}));var i=[],s=$(e.el).find(".list-item-icon");s.tooltip({title:t.txtInsertIntoFormula,placement:"cursor",zIndex:t.itemsList.tipZIndex}),s.each((function(t,e){i.push($(e).data("bs.tooltip").tip())})),e.tipsArray=i}))},showHelp:function(){if(null==this.helpUrl){var t=Common.Locale.getCurrentLanguage();t=t?t.split(/[\-\_]/)[0]:"en";var e=this,i="/UsageInstructions/PivotTables.htm",s="resources/help/"+t+i;if(Common.Controllers.Desktop.isActive()){if(!Common.Controllers.Desktop.isHelpAvailable()){var n=Common.Utils.InternalSettings.get("url-help-center");if(n){var a=new URL(n);a.searchParams&&a.searchParams.set("function",func),window.open(a.toString(),"_blank")}return void(e.helpUrl=null)}s=Common.Controllers.Desktop.helpUrl()+i}fetch(s).then((function(t){t.ok?(e.helpUrl=s,e.showHelp()):(s="resources/help/en"+i,fetch(s).then((function(t){t.ok?(e.helpUrl=s,e.showHelp()):e.helpUrl=null})))}))}else this.helpUrl&&window.open(this.helpUrl)},getConvertedFormula:function(t){var e,i=t.trim();return"number"==typeof(e="="!=i[0]?Asc.c_oAscError.ID.PivotItemNameNotFound:this.pivotInfo.asc_convertCalculatedFormula(i.slice(1),this.pivotFieldIndex))?{error:e,value:i}:{error:null,value:e}},txtTitle:"Insert Calculated Item in",txtItemName:"Item name",txtItem:"Item",txtFormula:"Formula",txtItems:"Items",txtDescription:"You can use Calculated Items for basic calculations between different items within a single field",txtReadMore:"Read more",txtInsertIntoFormula:"Insert into formula"},SSE.Views.PivotInsertCalculatedItemDialog||{}))})),require(["common/main/lib/util/define","common/main/lib/controller/ScreenReaderFocus","common/main/lib/component/ColorPaletteExt","common/main/lib/component/ComboBoxDataView","common/main/lib/view/AdvancedSettingsWindow","common/main/lib/view/OptionsDialog","common/main/lib/view/AutoCorrectDialog","common/main/lib/view/DocumentAccessDialog","common/main/lib/view/SaveAsDlg","common/main/lib/view/CopyWarningDialog","common/main/lib/view/SelectFileDlg","common/main/lib/view/SymbolTableDialog","common/main/lib/view/ListSettingsDialog","common/main/lib/view/ExternalEditor","common/main/lib/view/ExternalOleEditor","common/main/lib/view/RenameDialog","common/main/lib/view/PasswordDialog","common/main/lib/view/PluginDlg","common/main/lib/view/PluginPanel","common/main/lib/view/ShapeShadowDialog","common/main/lib/view/CustomizeQuickAccessDialog","common/main/lib/view/TextInputDialog","common/main/lib/view/DocumentHolderExt","common/main/lib/view/SignDialog","common/main/lib/view/SignSettingsDialog","common/main/lib/view/DocumentPropertyDialog","common/main/lib/view/MacrosDialog","common/main/lib/view/MacrosAiDialog","common/main/lib/component/MonacoEditor","spreadsheeteditor/main/app/controller/DocumentHolderExt","spreadsheeteditor/main/app/view/FileMenuPanels","spreadsheeteditor/main/app/view/DocumentHolderExt","spreadsheeteditor/main/app/view/PivotShowDetailDialog","spreadsheeteditor/main/app/view/ChartDataDialog","spreadsheeteditor/main/app/view/SortDialog","spreadsheeteditor/main/app/view/ViewManagerDlg","spreadsheeteditor/main/app/view/ChartDataDialog","spreadsheeteditor/main/app/view/ChartTypeDialog","spreadsheeteditor/main/app/view/ExternalLinksDlg","spreadsheeteditor/main/app/view/FormatRulesEditDlg","spreadsheeteditor/main/app/view/FormatRulesManagerDlg","spreadsheeteditor/main/app/view/MacroDialog","spreadsheeteditor/main/app/view/NameManagerDlg","spreadsheeteditor/main/app/view/NamedRangePasteDlg","spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced","spreadsheeteditor/main/app/view/PrintSettings","spreadsheeteditor/main/app/view/ProtectRangesDlg","spreadsheeteditor/main/app/view/ProtectedRangesManagerDlg","spreadsheeteditor/main/app/view/RemoveDuplicatesDialog","spreadsheeteditor/main/app/view/SlicerAddDialog","spreadsheeteditor/main/app/view/Spellcheck","spreadsheeteditor/main/app/view/WatchDialog","spreadsheeteditor/main/app/view/FormatSettingsDialog","spreadsheeteditor/main/app/view/ValueFieldSettingsDialog","spreadsheeteditor/main/app/view/SpecialPasteDialog","spreadsheeteditor/main/app/view/FieldSettingsDialog","spreadsheeteditor/main/app/view/ChartSettingsDlg","spreadsheeteditor/main/app/view/CellRangeDialog","spreadsheeteditor/main/app/view/ChartDataRangeDialog","spreadsheeteditor/main/app/view/ChartWizardDialog","spreadsheeteditor/main/app/view/FillSeriesDialog","spreadsheeteditor/main/app/view/NamedRangeEditDlg","spreadsheeteditor/main/app/view/CreateSparklineDialog","spreadsheeteditor/main/app/view/ImportFromXmlDialog","spreadsheeteditor/main/app/view/GoalSeekDlg","spreadsheeteditor/main/app/view/GoalSeekStatusDlg","spreadsheeteditor/main/app/view/DataValidationDialog","spreadsheeteditor/main/app/view/FormulaWizard","spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced","spreadsheeteditor/main/app/view/ImageSettingsAdvanced","spreadsheeteditor/main/app/view/SlicerSettingsAdvanced","spreadsheeteditor/main/app/view/PivotSettingsAdvanced","spreadsheeteditor/main/app/view/TableSettingsAdvanced","spreadsheeteditor/main/app/view/ShapeSettingsAdvanced","spreadsheeteditor/main/app/view/ProtectDialog","spreadsheeteditor/main/app/view/ProtectedRangesEditDlg","spreadsheeteditor/main/app/view/CreatePivotDialog","spreadsheeteditor/main/app/view/SortOptionsDialog","spreadsheeteditor/main/app/view/SetValueDialog","spreadsheeteditor/main/app/view/ScaleDialog","spreadsheeteditor/main/app/view/PrintTitlesDialog","spreadsheeteditor/main/app/view/TableOptionsDialog","spreadsheeteditor/main/app/view/PageMarginsDialog","spreadsheeteditor/main/app/view/HyperlinkSettingsDialog","spreadsheeteditor/main/app/view/HeaderFooterDialog","spreadsheeteditor/main/app/view/AdvancedSeparatorDialog","spreadsheeteditor/main/app/view/AutoFilterDialog","spreadsheeteditor/main/app/view/PivotGroupDialog","spreadsheeteditor/main/app/view/PivotCalculatedItemsDialog","spreadsheeteditor/main/app/view/PivotInsertCalculatedItemDialog"],(function(){Common.NotificationCenter.trigger("app-pack:loaded")})),define("../apps/spreadsheeteditor/main/app_pack.js",(function(){}));